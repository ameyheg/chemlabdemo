(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();var w9=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fS(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Xb={exports:{}},rg={};var rw;function YC(){if(rw)return rg;rw=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,r,s){var l=null;if(s!==void 0&&(l=""+s),r.key!==void 0&&(l=""+r.key),"key"in r){s={};for(var c in r)c!=="key"&&(s[c]=r[c])}else s=r;return r=s.ref,{$$typeof:i,type:n,key:l,ref:r!==void 0?r:null,props:s}}return rg.Fragment=e,rg.jsx=t,rg.jsxs=t,rg}var sw;function ZC(){return sw||(sw=1,Xb.exports=YC()),Xb.exports}var _=ZC(),Yb={exports:{}},bi={};var aw;function $C(){if(aw)return bi;aw=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),y=Symbol.iterator;function v(ee){return ee===null||typeof ee!="object"?null:(ee=y&&ee[y]||ee["@@iterator"],typeof ee=="function"?ee:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,A={};function w(ee,F,$){this.props=ee,this.context=F,this.refs=A,this.updater=$||S}w.prototype.isReactComponent={},w.prototype.setState=function(ee,F){if(typeof ee!="object"&&typeof ee!="function"&&ee!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ee,F,"setState")},w.prototype.forceUpdate=function(ee){this.updater.enqueueForceUpdate(this,ee,"forceUpdate")};function R(){}R.prototype=w.prototype;function D(ee,F,$){this.props=ee,this.context=F,this.refs=A,this.updater=$||S}var I=D.prototype=new R;I.constructor=D,T(I,w.prototype),I.isPureReactComponent=!0;var z=Array.isArray;function j(){}var X={H:null,A:null,T:null,S:null},G=Object.prototype.hasOwnProperty;function L(ee,F,$){var re=$.ref;return{$$typeof:i,type:ee,key:F,ref:re!==void 0?re:null,props:$}}function k(ee,F){return L(ee.type,F,ee.props)}function U(ee){return typeof ee=="object"&&ee!==null&&ee.$$typeof===i}function q(ee){var F={"=":"=0",":":"=2"};return"$"+ee.replace(/[=:]/g,function($){return F[$]})}var W=/\/+/g;function J(ee,F){return typeof ee=="object"&&ee!==null&&ee.key!=null?q(""+ee.key):F.toString(36)}function ce(ee){switch(ee.status){case"fulfilled":return ee.value;case"rejected":throw ee.reason;default:switch(typeof ee.status=="string"?ee.then(j,j):(ee.status="pending",ee.then(function(F){ee.status==="pending"&&(ee.status="fulfilled",ee.value=F)},function(F){ee.status==="pending"&&(ee.status="rejected",ee.reason=F)})),ee.status){case"fulfilled":return ee.value;case"rejected":throw ee.reason}}throw ee}function K(ee,F,$,re,Ae){var ie=typeof ee;(ie==="undefined"||ie==="boolean")&&(ee=null);var _e=!1;if(ee===null)_e=!0;else switch(ie){case"bigint":case"string":case"number":_e=!0;break;case"object":switch(ee.$$typeof){case i:case e:_e=!0;break;case m:return _e=ee._init,K(_e(ee._payload),F,$,re,Ae)}}if(_e)return Ae=Ae(ee),_e=re===""?"."+J(ee,0):re,z(Ae)?($="",_e!=null&&($=_e.replace(W,"$&/")+"/"),K(Ae,F,$,"",function(We){return We})):Ae!=null&&(U(Ae)&&(Ae=k(Ae,$+(Ae.key==null||ee&&ee.key===Ae.key?"":(""+Ae.key).replace(W,"$&/")+"/")+_e)),F.push(Ae)),1;_e=0;var ke=re===""?".":re+":";if(z(ee))for(var Fe=0;Fe<ee.length;Fe++)re=ee[Fe],ie=ke+J(re,Fe),_e+=K(re,F,$,ie,Ae);else if(Fe=v(ee),typeof Fe=="function")for(ee=Fe.call(ee),Fe=0;!(re=ee.next()).done;)re=re.value,ie=ke+J(re,Fe++),_e+=K(re,F,$,ie,Ae);else if(ie==="object"){if(typeof ee.then=="function")return K(ce(ee),F,$,re,Ae);throw F=String(ee),Error("Objects are not valid as a React child (found: "+(F==="[object Object]"?"object with keys {"+Object.keys(ee).join(", ")+"}":F)+"). If you meant to render a collection of children, use an array instead.")}return _e}function ne(ee,F,$){if(ee==null)return ee;var re=[],Ae=0;return K(ee,re,"","",function(ie){return F.call($,ie,Ae++)}),re}function pe(ee){if(ee._status===-1){var F=ee._result;F=F(),F.then(function($){(ee._status===0||ee._status===-1)&&(ee._status=1,ee._result=$)},function($){(ee._status===0||ee._status===-1)&&(ee._status=2,ee._result=$)}),ee._status===-1&&(ee._status=0,ee._result=F)}if(ee._status===1)return ee._result.default;throw ee._result}var Re=typeof reportError=="function"?reportError:function(ee){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var F=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ee=="object"&&ee!==null&&typeof ee.message=="string"?String(ee.message):String(ee),error:ee});if(!window.dispatchEvent(F))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ee);return}console.error(ee)},Te={map:ne,forEach:function(ee,F,$){ne(ee,function(){F.apply(this,arguments)},$)},count:function(ee){var F=0;return ne(ee,function(){F++}),F},toArray:function(ee){return ne(ee,function(F){return F})||[]},only:function(ee){if(!U(ee))throw Error("React.Children.only expected to receive a single React element child.");return ee}};return bi.Activity=g,bi.Children=Te,bi.Component=w,bi.Fragment=t,bi.Profiler=r,bi.PureComponent=D,bi.StrictMode=n,bi.Suspense=f,bi.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=X,bi.__COMPILER_RUNTIME={__proto__:null,c:function(ee){return X.H.useMemoCache(ee)}},bi.cache=function(ee){return function(){return ee.apply(null,arguments)}},bi.cacheSignal=function(){return null},bi.cloneElement=function(ee,F,$){if(ee==null)throw Error("The argument must be a React element, but you passed "+ee+".");var re=T({},ee.props),Ae=ee.key;if(F!=null)for(ie in F.key!==void 0&&(Ae=""+F.key),F)!G.call(F,ie)||ie==="key"||ie==="__self"||ie==="__source"||ie==="ref"&&F.ref===void 0||(re[ie]=F[ie]);var ie=arguments.length-2;if(ie===1)re.children=$;else if(1<ie){for(var _e=Array(ie),ke=0;ke<ie;ke++)_e[ke]=arguments[ke+2];re.children=_e}return L(ee.type,Ae,re)},bi.createContext=function(ee){return ee={$$typeof:l,_currentValue:ee,_currentValue2:ee,_threadCount:0,Provider:null,Consumer:null},ee.Provider=ee,ee.Consumer={$$typeof:s,_context:ee},ee},bi.createElement=function(ee,F,$){var re,Ae={},ie=null;if(F!=null)for(re in F.key!==void 0&&(ie=""+F.key),F)G.call(F,re)&&re!=="key"&&re!=="__self"&&re!=="__source"&&(Ae[re]=F[re]);var _e=arguments.length-2;if(_e===1)Ae.children=$;else if(1<_e){for(var ke=Array(_e),Fe=0;Fe<_e;Fe++)ke[Fe]=arguments[Fe+2];Ae.children=ke}if(ee&&ee.defaultProps)for(re in _e=ee.defaultProps,_e)Ae[re]===void 0&&(Ae[re]=_e[re]);return L(ee,ie,Ae)},bi.createRef=function(){return{current:null}},bi.forwardRef=function(ee){return{$$typeof:c,render:ee}},bi.isValidElement=U,bi.lazy=function(ee){return{$$typeof:m,_payload:{_status:-1,_result:ee},_init:pe}},bi.memo=function(ee,F){return{$$typeof:d,type:ee,compare:F===void 0?null:F}},bi.startTransition=function(ee){var F=X.T,$={};X.T=$;try{var re=ee(),Ae=X.S;Ae!==null&&Ae($,re),typeof re=="object"&&re!==null&&typeof re.then=="function"&&re.then(j,Re)}catch(ie){Re(ie)}finally{F!==null&&$.types!==null&&(F.types=$.types),X.T=F}},bi.unstable_useCacheRefresh=function(){return X.H.useCacheRefresh()},bi.use=function(ee){return X.H.use(ee)},bi.useActionState=function(ee,F,$){return X.H.useActionState(ee,F,$)},bi.useCallback=function(ee,F){return X.H.useCallback(ee,F)},bi.useContext=function(ee){return X.H.useContext(ee)},bi.useDebugValue=function(){},bi.useDeferredValue=function(ee,F){return X.H.useDeferredValue(ee,F)},bi.useEffect=function(ee,F){return X.H.useEffect(ee,F)},bi.useEffectEvent=function(ee){return X.H.useEffectEvent(ee)},bi.useId=function(){return X.H.useId()},bi.useImperativeHandle=function(ee,F,$){return X.H.useImperativeHandle(ee,F,$)},bi.useInsertionEffect=function(ee,F){return X.H.useInsertionEffect(ee,F)},bi.useLayoutEffect=function(ee,F){return X.H.useLayoutEffect(ee,F)},bi.useMemo=function(ee,F){return X.H.useMemo(ee,F)},bi.useOptimistic=function(ee,F){return X.H.useOptimistic(ee,F)},bi.useReducer=function(ee,F,$){return X.H.useReducer(ee,F,$)},bi.useRef=function(ee){return X.H.useRef(ee)},bi.useState=function(ee){return X.H.useState(ee)},bi.useSyncExternalStore=function(ee,F,$){return X.H.useSyncExternalStore(ee,F,$)},bi.useTransition=function(){return X.H.useTransition()},bi.version="19.2.3",bi}var ow;function o1(){return ow||(ow=1,Yb.exports=$C()),Yb.exports}var ge=o1();const Wm=fS(ge);var Zb={exports:{}},sg={},$b={exports:{}},Jb={};var lw;function JC(){return lw||(lw=1,(function(i){function e(K,ne){var pe=K.length;K.push(ne);e:for(;0<pe;){var Re=pe-1>>>1,Te=K[Re];if(0<r(Te,ne))K[Re]=ne,K[pe]=Te,pe=Re;else break e}}function t(K){return K.length===0?null:K[0]}function n(K){if(K.length===0)return null;var ne=K[0],pe=K.pop();if(pe!==ne){K[0]=pe;e:for(var Re=0,Te=K.length,ee=Te>>>1;Re<ee;){var F=2*(Re+1)-1,$=K[F],re=F+1,Ae=K[re];if(0>r($,pe))re<Te&&0>r(Ae,$)?(K[Re]=Ae,K[re]=pe,Re=re):(K[Re]=$,K[F]=pe,Re=F);else if(re<Te&&0>r(Ae,pe))K[Re]=Ae,K[re]=pe,Re=re;else break e}}return ne}function r(K,ne){var pe=K.sortIndex-ne.sortIndex;return pe!==0?pe:K.id-ne.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var l=Date,c=l.now();i.unstable_now=function(){return l.now()-c}}var f=[],d=[],m=1,g=null,y=3,v=!1,S=!1,T=!1,A=!1,w=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function I(K){for(var ne=t(d);ne!==null;){if(ne.callback===null)n(d);else if(ne.startTime<=K)n(d),ne.sortIndex=ne.expirationTime,e(f,ne);else break;ne=t(d)}}function z(K){if(T=!1,I(K),!S)if(t(f)!==null)S=!0,j||(j=!0,q());else{var ne=t(d);ne!==null&&ce(z,ne.startTime-K)}}var j=!1,X=-1,G=5,L=-1;function k(){return A?!0:!(i.unstable_now()-L<G)}function U(){if(A=!1,j){var K=i.unstable_now();L=K;var ne=!0;try{e:{S=!1,T&&(T=!1,R(X),X=-1),v=!0;var pe=y;try{t:{for(I(K),g=t(f);g!==null&&!(g.expirationTime>K&&k());){var Re=g.callback;if(typeof Re=="function"){g.callback=null,y=g.priorityLevel;var Te=Re(g.expirationTime<=K);if(K=i.unstable_now(),typeof Te=="function"){g.callback=Te,I(K),ne=!0;break t}g===t(f)&&n(f),I(K)}else n(f);g=t(f)}if(g!==null)ne=!0;else{var ee=t(d);ee!==null&&ce(z,ee.startTime-K),ne=!1}}break e}finally{g=null,y=pe,v=!1}ne=void 0}}finally{ne?q():j=!1}}}var q;if(typeof D=="function")q=function(){D(U)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,J=W.port2;W.port1.onmessage=U,q=function(){J.postMessage(null)}}else q=function(){w(U,0)};function ce(K,ne){X=w(function(){K(i.unstable_now())},ne)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(K){K.callback=null},i.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<K?Math.floor(1e3/K):5},i.unstable_getCurrentPriorityLevel=function(){return y},i.unstable_next=function(K){switch(y){case 1:case 2:case 3:var ne=3;break;default:ne=y}var pe=y;y=ne;try{return K()}finally{y=pe}},i.unstable_requestPaint=function(){A=!0},i.unstable_runWithPriority=function(K,ne){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var pe=y;y=K;try{return ne()}finally{y=pe}},i.unstable_scheduleCallback=function(K,ne,pe){var Re=i.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?Re+pe:Re):pe=Re,K){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=pe+Te,K={id:m++,callback:ne,priorityLevel:K,startTime:pe,expirationTime:Te,sortIndex:-1},pe>Re?(K.sortIndex=pe,e(d,K),t(f)===null&&K===t(d)&&(T?(R(X),X=-1):T=!0,ce(z,pe-Re))):(K.sortIndex=Te,e(f,K),S||v||(S=!0,j||(j=!0,q()))),K},i.unstable_shouldYield=k,i.unstable_wrapCallback=function(K){var ne=y;return function(){var pe=y;y=ne;try{return K.apply(this,arguments)}finally{y=pe}}}})(Jb)),Jb}var cw;function qA(){return cw||(cw=1,$b.exports=JC()),$b.exports}var Kb={exports:{}},Ro={};var uw;function KC(){if(uw)return Ro;uw=1;var i=o1();function e(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function s(f,d,m){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:g==null?null:""+g,children:f,containerInfo:d,implementation:m}}var l=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Ro.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Ro.createPortal=function(f,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return s(f,d,null,m)},Ro.flushSync=function(f){var d=l.T,m=n.p;try{if(l.T=null,n.p=2,f)return f()}finally{l.T=d,n.p=m,n.d.f()}},Ro.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(f,d))},Ro.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},Ro.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var m=d.as,g=c(m,d.crossOrigin),y=typeof d.integrity=="string"?d.integrity:void 0,v=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;m==="style"?n.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:g,integrity:y,fetchPriority:v}):m==="script"&&n.d.X(f,{crossOrigin:g,integrity:y,fetchPriority:v,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Ro.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var m=c(d.as,d.crossOrigin);n.d.M(f,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(f)},Ro.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var m=d.as,g=c(m,d.crossOrigin);n.d.L(f,m,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Ro.preloadModule=function(f,d){if(typeof f=="string")if(d){var m=c(d.as,d.crossOrigin);n.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(f)},Ro.requestFormReset=function(f){n.d.r(f)},Ro.unstable_batchedUpdates=function(f,d){return f(d)},Ro.useFormState=function(f,d,m){return l.H.useFormState(f,d,m)},Ro.useFormStatus=function(){return l.H.useHostTransitionStatus()},Ro.version="19.2.3",Ro}var fw;function QC(){if(fw)return Kb.exports;fw=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),Kb.exports=KC(),Kb.exports}var hw;function eN(){if(hw)return sg;hw=1;var i=qA(),e=o1(),t=QC();function n(a){var o="https://react.dev/errors/"+a;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)o+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+a+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function s(a){var o=a,p=a;if(a.alternate)for(;o.return;)o=o.return;else{a=o;do o=a,(o.flags&4098)!==0&&(p=o.return),a=o.return;while(a)}return o.tag===3?p:null}function l(a){if(a.tag===13){var o=a.memoizedState;if(o===null&&(a=a.alternate,a!==null&&(o=a.memoizedState)),o!==null)return o.dehydrated}return null}function c(a){if(a.tag===31){var o=a.memoizedState;if(o===null&&(a=a.alternate,a!==null&&(o=a.memoizedState)),o!==null)return o.dehydrated}return null}function f(a){if(s(a)!==a)throw Error(n(188))}function d(a){var o=a.alternate;if(!o){if(o=s(a),o===null)throw Error(n(188));return o!==a?null:a}for(var p=a,x=o;;){var C=p.return;if(C===null)break;var P=C.alternate;if(P===null){if(x=C.return,x!==null){p=x;continue}break}if(C.child===P.child){for(P=C.child;P;){if(P===p)return f(C),a;if(P===x)return f(C),o;P=P.sibling}throw Error(n(188))}if(p.return!==x.return)p=C,x=P;else{for(var Z=!1,ye=C.child;ye;){if(ye===p){Z=!0,p=C,x=P;break}if(ye===x){Z=!0,x=C,p=P;break}ye=ye.sibling}if(!Z){for(ye=P.child;ye;){if(ye===p){Z=!0,p=P,x=C;break}if(ye===x){Z=!0,x=P,p=C;break}ye=ye.sibling}if(!Z)throw Error(n(189))}}if(p.alternate!==x)throw Error(n(190))}if(p.tag!==3)throw Error(n(188));return p.stateNode.current===p?a:o}function m(a){var o=a.tag;if(o===5||o===26||o===27||o===6)return a;for(a=a.child;a!==null;){if(o=m(a),o!==null)return o;a=a.sibling}return null}var g=Object.assign,y=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),D=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),X=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),k=Symbol.for("react.memo_cache_sentinel"),U=Symbol.iterator;function q(a){return a===null||typeof a!="object"?null:(a=U&&a[U]||a["@@iterator"],typeof a=="function"?a:null)}var W=Symbol.for("react.client.reference");function J(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===W?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case T:return"Fragment";case w:return"Profiler";case A:return"StrictMode";case z:return"Suspense";case j:return"SuspenseList";case L:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case S:return"Portal";case D:return a.displayName||"Context";case R:return(a._context.displayName||"Context")+".Consumer";case I:var o=a.render;return a=a.displayName,a||(a=o.displayName||o.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case X:return o=a.displayName||null,o!==null?o:J(a.type)||"Memo";case G:o=a._payload,a=a._init;try{return J(a(o))}catch{}}return null}var ce=Array.isArray,K=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,pe={pending:!1,data:null,method:null,action:null},Re=[],Te=-1;function ee(a){return{current:a}}function F(a){0>Te||(a.current=Re[Te],Re[Te]=null,Te--)}function $(a,o){Te++,Re[Te]=a.current,a.current=o}var re=ee(null),Ae=ee(null),ie=ee(null),_e=ee(null);function ke(a,o){switch($(ie,o),$(Ae,a),$(re,null),o.nodeType){case 9:case 11:a=(a=o.documentElement)&&(a=a.namespaceURI)?E2(a):0;break;default:if(a=o.tagName,o=o.namespaceURI)o=E2(o),a=C2(o,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}F(re),$(re,a)}function Fe(){F(re),F(Ae),F(ie)}function We(a){a.memoizedState!==null&&$(_e,a);var o=re.current,p=C2(o,a.type);o!==p&&($(Ae,a),$(re,p))}function nt(a){Ae.current===a&&(F(re),F(Ae)),_e.current===a&&(F(_e),eg._currentValue=pe)}var It,wt;function Je(a){if(It===void 0)try{throw Error()}catch(p){var o=p.stack.trim().match(/\n( *(at )?)/);It=o&&o[1]||"",wt=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+It+a+wt}var le=!1;function Qe(a,o){if(!a||le)return"";le=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(o){var Zt=function(){throw Error()};if(Object.defineProperty(Zt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Zt,[])}catch(Ot){var Nt=Ot}Reflect.construct(a,[],Zt)}else{try{Zt.call()}catch(Ot){Nt=Ot}a.call(Zt.prototype)}}else{try{throw Error()}catch(Ot){Nt=Ot}(Zt=a())&&typeof Zt.catch=="function"&&Zt.catch(function(){})}}catch(Ot){if(Ot&&Nt&&typeof Ot.stack=="string")return[Ot.stack,Nt.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var C=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");C&&C.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var P=x.DetermineComponentFrameRoot(),Z=P[0],ye=P[1];if(Z&&ye){var He=Z.split(`
`),_t=ye.split(`
`);for(C=x=0;x<He.length&&!He[x].includes("DetermineComponentFrameRoot");)x++;for(;C<_t.length&&!_t[C].includes("DetermineComponentFrameRoot");)C++;if(x===He.length||C===_t.length)for(x=He.length-1,C=_t.length-1;1<=x&&0<=C&&He[x]!==_t[C];)C--;for(;1<=x&&0<=C;x--,C--)if(He[x]!==_t[C]){if(x!==1||C!==1)do if(x--,C--,0>C||He[x]!==_t[C]){var Ht=`
`+He[x].replace(" at new "," at ");return a.displayName&&Ht.includes("<anonymous>")&&(Ht=Ht.replace("<anonymous>",a.displayName)),Ht}while(1<=x&&0<=C);break}}}finally{le=!1,Error.prepareStackTrace=p}return(p=a?a.displayName||a.name:"")?Je(p):""}function Et(a,o){switch(a.tag){case 26:case 27:case 5:return Je(a.type);case 16:return Je("Lazy");case 13:return a.child!==o&&o!==null?Je("Suspense Fallback"):Je("Suspense");case 19:return Je("SuspenseList");case 0:case 15:return Qe(a.type,!1);case 11:return Qe(a.type.render,!1);case 1:return Qe(a.type,!0);case 31:return Je("Activity");default:return""}}function we(a){try{var o="",p=null;do o+=Et(a,p),p=a,a=a.return;while(a);return o}catch(x){return`
Error generating stack: `+x.message+`
`+x.stack}}var ot=Object.prototype.hasOwnProperty,Ct=i.unstable_scheduleCallback,ht=i.unstable_cancelCallback,xt=i.unstable_shouldYield,he=i.unstable_requestPaint,Q=i.unstable_now,Be=i.unstable_getCurrentPriorityLevel,ue=i.unstable_ImmediatePriority,je=i.unstable_UserBlockingPriority,Ye=i.unstable_NormalPriority,ft=i.unstable_LowPriority,gt=i.unstable_IdlePriority,Lt=i.log,un=i.unstable_setDisableYieldValue,bt=null,dt=null;function Ge(a){if(typeof Lt=="function"&&un(a),dt&&typeof dt.setStrictMode=="function")try{dt.setStrictMode(bt,a)}catch{}}var xe=Math.clz32?Math.clz32:Me,Pe=Math.log,rt=Math.LN2;function Me(a){return a>>>=0,a===0?32:31-(Pe(a)/rt|0)|0}var ze=256,Mt=262144,Rt=4194304;function se(a){var o=a&42;if(o!==0)return o;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Ve(a,o,p){var x=a.pendingLanes;if(x===0)return 0;var C=0,P=a.suspendedLanes,Z=a.pingedLanes;a=a.warmLanes;var ye=x&134217727;return ye!==0?(x=ye&~P,x!==0?C=se(x):(Z&=ye,Z!==0?C=se(Z):p||(p=ye&~a,p!==0&&(C=se(p))))):(ye=x&~P,ye!==0?C=se(ye):Z!==0?C=se(Z):p||(p=x&~a,p!==0&&(C=se(p)))),C===0?0:o!==0&&o!==C&&(o&P)===0&&(P=C&-C,p=o&-o,P>=p||P===32&&(p&4194048)!==0)?o:C}function vt(a,o){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&o)===0}function Dt(a,o){switch(a){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bn(){var a=Rt;return Rt<<=1,(Rt&62914560)===0&&(Rt=4194304),a}function dn(a){for(var o=[],p=0;31>p;p++)o.push(a);return o}function tn(a,o){a.pendingLanes|=o,o!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function gn(a,o,p,x,C,P){var Z=a.pendingLanes;a.pendingLanes=p,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=p,a.entangledLanes&=p,a.errorRecoveryDisabledLanes&=p,a.shellSuspendCounter=0;var ye=a.entanglements,He=a.expirationTimes,_t=a.hiddenUpdates;for(p=Z&~p;0<p;){var Ht=31-xe(p),Zt=1<<Ht;ye[Ht]=0,He[Ht]=-1;var Nt=_t[Ht];if(Nt!==null)for(_t[Ht]=null,Ht=0;Ht<Nt.length;Ht++){var Ot=Nt[Ht];Ot!==null&&(Ot.lane&=-536870913)}p&=~Zt}x!==0&&Pn(a,x,0),P!==0&&C===0&&a.tag!==0&&(a.suspendedLanes|=P&~(Z&~o))}function Pn(a,o,p){a.pendingLanes|=o,a.suspendedLanes&=~o;var x=31-xe(o);a.entangledLanes|=o,a.entanglements[x]=a.entanglements[x]|1073741824|p&261930}function Bi(a,o){var p=a.entangledLanes|=o;for(a=a.entanglements;p;){var x=31-xe(p),C=1<<x;C&o|a[x]&o&&(a[x]|=o),p&=~C}}function xi(a,o){var p=o&-o;return p=(p&42)!==0?1:$n(p),(p&(a.suspendedLanes|o))!==0?0:p}function $n(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function ii(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function wi(){var a=ne.p;return a!==0?a:(a=window.event,a===void 0?32:J2(a.type))}function Rn(a,o){var p=ne.p;try{return ne.p=a,o()}finally{ne.p=p}}var ir=Math.random().toString(36).slice(2),Mi="__reactFiber$"+ir,te="__reactProps$"+ir,be="__reactContainer$"+ir,Ue="__reactEvents$"+ir,lt="__reactListeners$"+ir,Tt="__reactHandles$"+ir,St="__reactResources$"+ir,Xt="__reactMarker$"+ir;function qt(a){delete a[Mi],delete a[te],delete a[Ue],delete a[lt],delete a[Tt]}function an(a){var o=a[Mi];if(o)return o;for(var p=a.parentNode;p;){if(o=p[be]||p[Mi]){if(p=o.alternate,o.child!==null||p!==null&&p.child!==null)for(a=k2(a);a!==null;){if(p=a[Mi])return p;a=k2(a)}return o}a=p,p=a.parentNode}return null}function sn(a){if(a=a[Mi]||a[be]){var o=a.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return a}return null}function ln(a){var o=a.tag;if(o===5||o===26||o===27||o===6)return a.stateNode;throw Error(n(33))}function rn(a){var o=a[St];return o||(o=a[St]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function fe(a){a[Xt]=!0}var Oe=new Set,$e={};function et(a,o){Ze(a,o),Ze(a+"Capture",o)}function Ze(a,o){for($e[a]=o,a=0;a<o.length;a++)Oe.add(o[a])}var Vt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),en={},Gt={};function vn(a){return ot.call(Gt,a)?!0:ot.call(en,a)?!1:Vt.test(a)?Gt[a]=!0:(en[a]=!0,!1)}function nn(a,o,p){if(vn(o))if(p===null)a.removeAttribute(o);else{switch(typeof p){case"undefined":case"function":case"symbol":a.removeAttribute(o);return;case"boolean":var x=o.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){a.removeAttribute(o);return}}a.setAttribute(o,""+p)}}function Tn(a,o,p){if(p===null)a.removeAttribute(o);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(o);return}a.setAttribute(o,""+p)}}function cn(a,o,p,x){if(x===null)a.removeAttribute(p);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(p);return}a.setAttributeNS(o,p,""+x)}}function hn(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function si(a){var o=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function pi(a,o,p){var x=Object.getOwnPropertyDescriptor(a.constructor.prototype,o);if(!a.hasOwnProperty(o)&&typeof x<"u"&&typeof x.get=="function"&&typeof x.set=="function"){var C=x.get,P=x.set;return Object.defineProperty(a,o,{configurable:!0,get:function(){return C.call(this)},set:function(Z){p=""+Z,P.call(this,Z)}}),Object.defineProperty(a,o,{enumerable:x.enumerable}),{getValue:function(){return p},setValue:function(Z){p=""+Z},stopTracking:function(){a._valueTracker=null,delete a[o]}}}}function ai(a){if(!a._valueTracker){var o=si(a)?"checked":"value";a._valueTracker=pi(a,o,""+a[o])}}function Sn(a){if(!a)return!1;var o=a._valueTracker;if(!o)return!0;var p=o.getValue(),x="";return a&&(x=si(a)?a.checked?"true":"false":a.value),a=x,a!==p?(o.setValue(a),!0):!1}function Jt(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var _n=/[\n"\\]/g;function mn(a){return a.replace(_n,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Ui(a,o,p,x,C,P,Z,ye){a.name="",Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"?a.type=Z:a.removeAttribute("type"),o!=null?Z==="number"?(o===0&&a.value===""||a.value!=o)&&(a.value=""+hn(o)):a.value!==""+hn(o)&&(a.value=""+hn(o)):Z!=="submit"&&Z!=="reset"||a.removeAttribute("value"),o!=null?mi(a,Z,hn(o)):p!=null?mi(a,Z,hn(p)):x!=null&&a.removeAttribute("value"),C==null&&P!=null&&(a.defaultChecked=!!P),C!=null&&(a.checked=C&&typeof C!="function"&&typeof C!="symbol"),ye!=null&&typeof ye!="function"&&typeof ye!="symbol"&&typeof ye!="boolean"?a.name=""+hn(ye):a.removeAttribute("name")}function ss(a,o,p,x,C,P,Z,ye){if(P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"&&(a.type=P),o!=null||p!=null){if(!(P!=="submit"&&P!=="reset"||o!=null)){ai(a);return}p=p!=null?""+hn(p):"",o=o!=null?""+hn(o):p,ye||o===a.value||(a.value=o),a.defaultValue=o}x=x??C,x=typeof x!="function"&&typeof x!="symbol"&&!!x,a.checked=ye?a.checked:!!x,a.defaultChecked=!!x,Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"&&(a.name=Z),ai(a)}function mi(a,o,p){o==="number"&&Jt(a.ownerDocument)===a||a.defaultValue===""+p||(a.defaultValue=""+p)}function Yi(a,o,p,x){if(a=a.options,o){o={};for(var C=0;C<p.length;C++)o["$"+p[C]]=!0;for(p=0;p<a.length;p++)C=o.hasOwnProperty("$"+a[p].value),a[p].selected!==C&&(a[p].selected=C),C&&x&&(a[p].defaultSelected=!0)}else{for(p=""+hn(p),o=null,C=0;C<a.length;C++){if(a[C].value===p){a[C].selected=!0,x&&(a[C].defaultSelected=!0);return}o!==null||a[C].disabled||(o=a[C])}o!==null&&(o.selected=!0)}}function Xi(a,o,p){if(o!=null&&(o=""+hn(o),o!==a.value&&(a.value=o),p==null)){a.defaultValue!==o&&(a.defaultValue=o);return}a.defaultValue=p!=null?""+hn(p):""}function Zr(a,o,p,x){if(o==null){if(x!=null){if(p!=null)throw Error(n(92));if(ce(x)){if(1<x.length)throw Error(n(93));x=x[0]}p=x}p==null&&(p=""),o=p}p=hn(o),a.defaultValue=p,x=a.textContent,x===p&&x!==""&&x!==null&&(a.value=x),ai(a)}function Tr(a,o){if(o){var p=a.firstChild;if(p&&p===a.lastChild&&p.nodeType===3){p.nodeValue=o;return}}a.textContent=o}var Pr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function gs(a,o,p){var x=o.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?x?a.setProperty(o,""):o==="float"?a.cssFloat="":a[o]="":x?a.setProperty(o,p):typeof p!="number"||p===0||Pr.has(o)?o==="float"?a.cssFloat=p:a[o]=(""+p).trim():a[o]=p+"px"}function Zl(a,o,p){if(o!=null&&typeof o!="object")throw Error(n(62));if(a=a.style,p!=null){for(var x in p)!p.hasOwnProperty(x)||o!=null&&o.hasOwnProperty(x)||(x.indexOf("--")===0?a.setProperty(x,""):x==="float"?a.cssFloat="":a[x]="");for(var C in o)x=o[C],o.hasOwnProperty(C)&&p[C]!==x&&gs(a,C,x)}else for(var P in o)o.hasOwnProperty(P)&&gs(a,P,o[P])}function Oa(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Gu=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ea(a){return Gu.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function jo(){}var pl=null;function Nc(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var $l=null,qn=null;function Uf(a){var o=sn(a);if(o&&(a=o.stateNode)){var p=a[te]||null;e:switch(a=o.stateNode,o.type){case"input":if(Ui(a,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),o=p.name,p.type==="radio"&&o!=null){for(p=a;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+mn(""+o)+'"][type="radio"]'),o=0;o<p.length;o++){var x=p[o];if(x!==a&&x.form===a.form){var C=x[te]||null;if(!C)throw Error(n(90));Ui(x,C.value,C.defaultValue,C.defaultValue,C.checked,C.defaultChecked,C.type,C.name)}}for(o=0;o<p.length;o++)x=p[o],x.form===a.form&&Sn(x)}break e;case"textarea":Xi(a,p.value,p.defaultValue);break e;case"select":o=p.value,o!=null&&Yi(a,!!p.multiple,o,!1)}}}var qu=!1;function Ff(a,o,p){if(qu)return a(o,p);qu=!0;try{var x=a(o);return x}finally{if(qu=!1,($l!==null||qn!==null)&&(yc(),$l&&(o=$l,a=qn,qn=$l=null,Uf(o),a)))for(o=0;o<a.length;o++)Uf(a[o])}}function Ba(a,o){var p=a.stateNode;if(p===null)return null;var x=p[te]||null;if(x===null)return null;p=x[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(a=a.type,x=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!x;break e;default:a=!1}if(a)return null;if(p&&typeof p!="function")throw Error(n(231,o,typeof p));return p}var Vs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zf=!1;if(Vs)try{var Rc={};Object.defineProperty(Rc,"passive",{get:function(){zf=!0}}),window.addEventListener("test",Rc,Rc),window.removeEventListener("test",Rc,Rc)}catch{zf=!1}var Hs=null,Lc=null,Ja=null;function cu(){if(Ja)return Ja;var a,o=Lc,p=o.length,x,C="value"in Hs?Hs.value:Hs.textContent,P=C.length;for(a=0;a<p&&o[a]===C[a];a++);var Z=p-a;for(x=1;x<=Z&&o[p-x]===C[P-x];x++);return Ja=C.slice(a,1<x?1-x:void 0)}function Ka(a){var o=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&o===13&&(a=13)):a=o,a===10&&(a=13),32<=a||a===13?a:0}function Pc(){return!0}function Wu(){return!1}function Ns(a){function o(p,x,C,P,Z){this._reactName=p,this._targetInst=C,this.type=x,this.nativeEvent=P,this.target=Z,this.currentTarget=null;for(var ye in a)a.hasOwnProperty(ye)&&(p=a[ye],this[ye]=p?p(P):P[ye]);return this.isDefaultPrevented=(P.defaultPrevented!=null?P.defaultPrevented:P.returnValue===!1)?Pc:Wu,this.isPropagationStopped=Wu,this}return g(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Pc)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Pc)},persist:function(){},isPersistent:Pc}),o}var Vo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qa=Ns(Vo),ml=g({},Vo,{view:0,detail:0}),uu=Ns(ml),Jl,gl,vl,Kl=g({},ml,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jn,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==vl&&(vl&&a.type==="mousemove"?(Jl=a.screenX-vl.screenX,gl=a.screenY-vl.screenY):gl=Jl=0,vl=a),Jl)},movementY:function(a){return"movementY"in a?a.movementY:gl}}),Xu=Ns(Kl),xl=g({},Kl,{dataTransfer:0}),yl=Ns(xl),Yu=g({},ml,{relatedTarget:0}),bl=Ns(Yu),jf=g({},Vo,{animationName:0,elapsedTime:0,pseudoElement:0}),B=Ns(jf),ae=g({},Vo,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Ie=Ns(ae),qe=g({},Vo,{data:0}),at=Ns(qe),jt={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$t={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},In={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function On(a){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(a):(a=In[a])?!!o[a]:!1}function Jn(){return On}var fi=g({},ml,{key:function(a){if(a.key){var o=jt[a.key]||a.key;if(o!=="Unidentified")return o}return a.type==="keypress"?(a=Ka(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?$t[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jn,charCode:function(a){return a.type==="keypress"?Ka(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Ka(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Ai=Ns(fi),yr=g({},Kl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$r=Ns(yr),ur=g({},ml,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jn}),vs=Ns(ur),as=g({},Vo,{propertyName:0,elapsedTime:0,pseudoElement:0}),ea=Ns(as),Er=g({},Kl,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),yo=Ns(Er),_l=g({},Vo,{newState:0,oldState:0}),Zu=Ns(_l),fu=[9,13,27,32],Ua=Vs&&"CompositionEvent"in window,bo=null;Vs&&"documentMode"in document&&(bo=document.documentMode);var Sl=Vs&&"TextEvent"in window&&!bo,wl=Vs&&(!Ua||bo&&8<bo&&11>=bo),Gs=" ",Ho=!1;function Ml(a,o){switch(a){case"keyup":return fu.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hu(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Go=!1;function ya(a,o){switch(a){case"compositionend":return hu(o);case"keypress":return o.which!==32?null:(Ho=!0,Gs);case"textInput":return a=o.data,a===Gs&&Ho?null:a;default:return null}}function qo(a,o){if(Go)return a==="compositionend"||!Ua&&Ml(a,o)?(a=cu(),Ja=Lc=Hs=null,Go=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return wl&&o.locale!=="ko"?null:o.data;default:return null}}var Ic={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $u(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o==="input"?!!Ic[a.type]:o==="textarea"}function Ca(a,o,p,x){$l?qn?qn.push(x):qn=[x]:$l=x,o=ev(o,"onChange"),0<o.length&&(p=new Qa("onChange","change",null,p,x),a.push({event:p,listeners:o}))}var Fa=null,Wo=null;function Ju(a){_2(a,0)}function eo(a){var o=ln(a);if(Sn(o))return a}function Ql(a,o){if(a==="change")return o}var Jr=!1;if(Vs){var ta;if(Vs){var Al="oninput"in document;if(!Al){var Xo=document.createElement("div");Xo.setAttribute("oninput","return;"),Al=typeof Xo.oninput=="function"}ta=Al}else ta=!1;Jr=ta&&(!document.documentMode||9<document.documentMode)}function Rs(){Fa&&(Fa.detachEvent("onpropertychange",ec),Wo=Fa=null)}function ec(a){if(a.propertyName==="value"&&eo(Wo)){var o=[];Ca(o,Wo,a,Nc(a)),Ff(Ju,o)}}function du(a,o,p){a==="focusin"?(Rs(),Fa=o,Wo=p,Fa.attachEvent("onpropertychange",ec)):a==="focusout"&&Rs()}function jr(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return eo(Wo)}function Vf(a,o){if(a==="click")return eo(o)}function Yo(a,o){if(a==="input"||a==="change")return eo(o)}function _o(a,o){return a===o&&(a!==0||1/a===1/o)||a!==a&&o!==o}var Ls=typeof Object.is=="function"?Object.is:_o;function Tl(a,o){if(Ls(a,o))return!0;if(typeof a!="object"||a===null||typeof o!="object"||o===null)return!1;var p=Object.keys(a),x=Object.keys(o);if(p.length!==x.length)return!1;for(x=0;x<p.length;x++){var C=p[x];if(!ot.call(o,C)||!Ls(a[C],o[C]))return!1}return!0}function tc(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function El(a,o){var p=tc(a);a=0;for(var x;p;){if(p.nodeType===3){if(x=a+p.textContent.length,a<=o&&x>=o)return{node:p,offset:o-a};a=x}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=tc(p)}}function Zi(a,o){return a&&o?a===o?!0:a&&a.nodeType===3?!1:o&&o.nodeType===3?Zi(a,o.parentNode):"contains"in a?a.contains(o):a.compareDocumentPosition?!!(a.compareDocumentPosition(o)&16):!1:!1}function nc(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var o=Jt(a.document);o instanceof a.HTMLIFrameElement;){try{var p=typeof o.contentWindow.location.href=="string"}catch{p=!1}if(p)a=o.contentWindow;else break;o=Jt(a.document)}return o}function Cl(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o&&(o==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||o==="textarea"||a.contentEditable==="true")}var Dc=Vs&&"documentMode"in document&&11>=document.documentMode,na=null,ba=null,ia=null,to=!1;function Vi(a,o,p){var x=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;to||na==null||na!==Jt(x)||(x=na,"selectionStart"in x&&Cl(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),ia&&Tl(ia,x)||(ia=x,x=ev(ba,"onSelect"),0<x.length&&(o=new Qa("onSelect","select",null,o,p),a.push({event:o,listeners:x}),o.target=na)))}function di(a,o){var p={};return p[a.toLowerCase()]=o.toLowerCase(),p["Webkit"+a]="webkit"+o,p["Moz"+a]="moz"+o,p}var dr={animationend:di("Animation","AnimationEnd"),animationiteration:di("Animation","AnimationIteration"),animationstart:di("Animation","AnimationStart"),transitionrun:di("Transition","TransitionRun"),transitionstart:di("Transition","TransitionStart"),transitioncancel:di("Transition","TransitionCancel"),transitionend:di("Transition","TransitionEnd")},Vr={},Zo={};Vs&&(Zo=document.createElement("div").style,"AnimationEvent"in window||(delete dr.animationend.animation,delete dr.animationiteration.animation,delete dr.animationstart.animation),"TransitionEvent"in window||delete dr.transitionend.transition);function no(a){if(Vr[a])return Vr[a];if(!dr[a])return a;var o=dr[a],p;for(p in o)if(o.hasOwnProperty(p)&&p in Zo)return Vr[a]=o[p];return a}var ic=no("animationend"),kc=no("animationiteration"),Sh=no("animationstart"),wd=no("transitionrun"),Fp=no("transitionstart"),Md=no("transitioncancel"),wh=no("transitionend"),io=new Map,rc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");rc.push("scrollEnd");function ro(a,o){io.set(a,o),et(o,[a])}var Ku=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},so=[],Nl=0,Ps=0;function Qu(){for(var a=Nl,o=Ps=Nl=0;o<a;){var p=so[o];so[o++]=null;var x=so[o];so[o++]=null;var C=so[o];so[o++]=null;var P=so[o];if(so[o++]=null,x!==null&&C!==null){var Z=x.pending;Z===null?C.next=C:(C.next=Z.next,Z.next=C),x.pending=C}P!==0&&$o(p,C,P)}}function Is(a,o,p,x){so[Nl++]=a,so[Nl++]=o,so[Nl++]=p,so[Nl++]=x,Ps|=x,a.lanes|=x,a=a.alternate,a!==null&&(a.lanes|=x)}function Hf(a,o,p,x){return Is(a,o,p,x),Ir(a)}function ra(a,o){return Is(a,null,null,o),Ir(a)}function $o(a,o,p){a.lanes|=p;var x=a.alternate;x!==null&&(x.lanes|=p);for(var C=!1,P=a.return;P!==null;)P.childLanes|=p,x=P.alternate,x!==null&&(x.childLanes|=p),P.tag===22&&(a=P.stateNode,a===null||a._visibility&1||(C=!0)),a=P,P=P.return;return a.tag===3?(P=a.stateNode,C&&o!==null&&(C=31-xe(p),a=P.hiddenUpdates,x=a[C],x===null?a[C]=[o]:x.push(o),o.lane=p|536870912),P):null}function Ir(a){if(50<xf)throw xf=0,sh=null,Error(n(185));for(var o=a.return;o!==null;)a=o,o=a.return;return a.tag===3?a.stateNode:null}var Ds={};function ef(a,o,p,x){this.tag=a,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function br(a,o,p,x){return new ef(a,o,p,x)}function Gf(a){return a=a.prototype,!(!a||!a.isReactComponent)}function sa(a,o){var p=a.alternate;return p===null?(p=br(a.tag,o,a.key,a.mode),p.elementType=a.elementType,p.type=a.type,p.stateNode=a.stateNode,p.alternate=a,a.alternate=p):(p.pendingProps=o,p.type=a.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=a.flags&65011712,p.childLanes=a.childLanes,p.lanes=a.lanes,p.child=a.child,p.memoizedProps=a.memoizedProps,p.memoizedState=a.memoizedState,p.updateQueue=a.updateQueue,o=a.dependencies,p.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},p.sibling=a.sibling,p.index=a.index,p.ref=a.ref,p.refCleanup=a.refCleanup,p}function sc(a,o){a.flags&=65011714;var p=a.alternate;return p===null?(a.childLanes=0,a.lanes=o,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=p.childLanes,a.lanes=p.lanes,a.child=p.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=p.memoizedProps,a.memoizedState=p.memoizedState,a.updateQueue=p.updateQueue,a.type=p.type,o=p.dependencies,a.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),a}function So(a,o,p,x,C,P){var Z=0;if(x=a,typeof a=="function")Gf(a)&&(Z=1);else if(typeof a=="string")Z=OC(a,p,re.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case L:return a=br(31,p,o,C),a.elementType=L,a.lanes=P,a;case T:return ac(p.children,C,P,o);case A:Z=8,C|=24;break;case w:return a=br(12,p,o,C|2),a.elementType=w,a.lanes=P,a;case z:return a=br(13,p,o,C),a.elementType=z,a.lanes=P,a;case j:return a=br(19,p,o,C),a.elementType=j,a.lanes=P,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case D:Z=10;break e;case R:Z=9;break e;case I:Z=11;break e;case X:Z=14;break e;case G:Z=16,x=null;break e}Z=29,p=Error(n(130,a===null?"null":typeof a,"")),x=null}return o=br(Z,p,o,C),o.elementType=a,o.type=x,o.lanes=P,o}function ac(a,o,p,x){return a=br(7,a,x,o),a.lanes=p,a}function tf(a,o,p){return a=br(6,a,null,o),a.lanes=p,a}function Oc(a){var o=br(18,null,null,0);return o.stateNode=a,o}function pu(a,o,p){return o=br(4,a.children!==null?a.children:[],a.key,o),o.lanes=p,o.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},o}var mu=new WeakMap;function ao(a,o){if(typeof a=="object"&&a!==null){var p=mu.get(a);return p!==void 0?p:(o={value:a,source:o,stack:we(o)},mu.set(a,o),o)}return{value:a,source:o,stack:we(o)}}var Bc=[],oc=0,nf=null,rf=0,za=[],Dr=0,lc=null,Cr=1,oo="";function ja(a,o){Bc[oc++]=rf,Bc[oc++]=nf,nf=a,rf=o}function zp(a,o,p){za[Dr++]=Cr,za[Dr++]=oo,za[Dr++]=lc,lc=a;var x=Cr;a=oo;var C=32-xe(x)-1;x&=~(1<<C),p+=1;var P=32-xe(o)+C;if(30<P){var Z=C-C%5;P=(x&(1<<Z)-1).toString(32),x>>=Z,C-=Z,Cr=1<<32-xe(o)+C|p<<C|x,oo=P+a}else Cr=1<<P|p<<C|x,oo=a}function Rl(a){a.return!==null&&(ja(a,1),zp(a,1,0))}function qf(a){for(;a===nf;)nf=Bc[--oc],Bc[oc]=null,rf=Bc[--oc],Bc[oc]=null;for(;a===lc;)lc=za[--Dr],za[Dr]=null,oo=za[--Dr],za[Dr]=null,Cr=za[--Dr],za[Dr]=null}function Mh(a,o){za[Dr++]=Cr,za[Dr++]=oo,za[Dr++]=lc,Cr=o.id,oo=o.overflow,lc=a}var Kr=null,_r=null,Fi=!1,_a=null,Hr=!1,Va=Error(n(519));function Ll(a){var o=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Jo(ao(o,a)),Va}function Ad(a){var o=a.stateNode,p=a.type,x=a.memoizedProps;switch(o[Mi]=a,o[te]=x,p){case"dialog":Ji("cancel",o),Ji("close",o);break;case"iframe":case"object":case"embed":Ji("load",o);break;case"video":case"audio":for(p=0;p<Gl.length;p++)Ji(Gl[p],o);break;case"source":Ji("error",o);break;case"img":case"image":case"link":Ji("error",o),Ji("load",o);break;case"details":Ji("toggle",o);break;case"input":Ji("invalid",o),ss(o,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0);break;case"select":Ji("invalid",o);break;case"textarea":Ji("invalid",o),Zr(o,x.value,x.defaultValue,x.children)}p=x.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||o.textContent===""+p||x.suppressHydrationWarning===!0||A2(o.textContent,p)?(x.popover!=null&&(Ji("beforetoggle",o),Ji("toggle",o)),x.onScroll!=null&&Ji("scroll",o),x.onScrollEnd!=null&&Ji("scrollend",o),x.onClick!=null&&(o.onclick=jo),o=!0):o=!1,o||Ll(a,!0)}function cc(a){for(Kr=a.return;Kr;)switch(Kr.tag){case 5:case 31:case 13:Hr=!1;return;case 27:case 3:Hr=!0;return;default:Kr=Kr.return}}function aa(a){if(a!==Kr)return!1;if(!Fi)return cc(a),Fi=!0,!1;var o=a.tag,p;if((p=o!==3&&o!==27)&&((p=o===5)&&(p=a.type,p=!(p!=="form"&&p!=="button")||Pb(a.type,a.memoizedProps)),p=!p),p&&_r&&Ll(a),cc(a),o===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));_r=D2(a)}else if(o===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));_r=D2(a)}else o===27?(o=_r,qh(a.type)?(a=Bb,Bb=null,_r=a):_r=o):_r=Kr?Qc(a.stateNode.nextSibling):null;return!0}function Uc(){_r=Kr=null,Fi=!1}function Ah(){var a=_a;return a!==null&&(ws===null?ws=a:ws.push.apply(ws,a),_a=null),a}function Jo(a){_a===null?_a=[a]:_a.push(a)}var gu=ee(null),uc=null,Ko=null;function fc(a,o,p){$(gu,o._currentValue),o._currentValue=p}function lo(a){a._currentValue=gu.current,F(gu)}function vu(a,o,p){for(;a!==null;){var x=a.alternate;if((a.childLanes&o)!==o?(a.childLanes|=o,x!==null&&(x.childLanes|=o)):x!==null&&(x.childLanes&o)!==o&&(x.childLanes|=o),a===p)break;a=a.return}}function Fc(a,o,p,x){var C=a.child;for(C!==null&&(C.return=a);C!==null;){var P=C.dependencies;if(P!==null){var Z=C.child;P=P.firstContext;e:for(;P!==null;){var ye=P;P=C;for(var He=0;He<o.length;He++)if(ye.context===o[He]){P.lanes|=p,ye=P.alternate,ye!==null&&(ye.lanes|=p),vu(P.return,p,a),x||(Z=null);break e}P=ye.next}}else if(C.tag===18){if(Z=C.return,Z===null)throw Error(n(341));Z.lanes|=p,P=Z.alternate,P!==null&&(P.lanes|=p),vu(Z,p,a),Z=null}else Z=C.child;if(Z!==null)Z.return=C;else for(Z=C;Z!==null;){if(Z===a){Z=null;break}if(C=Z.sibling,C!==null){C.return=Z.return,Z=C;break}Z=Z.return}C=Z}}function wo(a,o,p,x){a=null;for(var C=o,P=!1;C!==null;){if(!P){if((C.flags&524288)!==0)P=!0;else if((C.flags&262144)!==0)break}if(C.tag===10){var Z=C.alternate;if(Z===null)throw Error(n(387));if(Z=Z.memoizedProps,Z!==null){var ye=C.type;Ls(C.pendingProps.value,Z.value)||(a!==null?a.push(ye):a=[ye])}}else if(C===_e.current){if(Z=C.alternate,Z===null)throw Error(n(387));Z.memoizedState.memoizedState!==C.memoizedState.memoizedState&&(a!==null?a.push(eg):a=[eg])}C=C.return}a!==null&&Fc(o,a,p,x),o.flags|=262144}function Wf(a){for(a=a.firstContext;a!==null;){if(!Ls(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function hc(a){uc=a,Ko=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Qn(a){return jp(uc,a)}function sf(a,o){return uc===null&&hc(a),jp(a,o)}function jp(a,o){var p=o._currentValue;if(o={context:o,memoizedValue:p,next:null},Ko===null){if(a===null)throw Error(n(308));Ko=o,a.dependencies={lanes:0,firstContext:o},a.flags|=524288}else Ko=Ko.next=o;return p}var Vp=typeof AbortController<"u"?AbortController:function(){var a=[],o=this.signal={aborted:!1,addEventListener:function(p,x){a.push(x)}};this.abort=function(){o.aborted=!0,a.forEach(function(p){return p()})}},T0=i.unstable_scheduleCallback,E0=i.unstable_NormalPriority,os={$$typeof:D,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function af(){return{controller:new Vp,data:new Map,refCount:0}}function xu(a){a.refCount--,a.refCount===0&&T0(E0,function(){a.controller.abort()})}var co=null,Xf=0,M=0,N=null;function V(a,o){if(co===null){var p=co=[];Xf=0,M=Pt(),N={status:"pending",value:void 0,then:function(x){p.push(x)}}}return Xf++,o.then(Y,Y),o}function Y(){if(--Xf===0&&co!==null){N!==null&&(N.status="fulfilled");var a=co;co=null,M=0,N=null;for(var o=0;o<a.length;o++)(0,a[o])()}}function oe(a,o){var p=[],x={status:"pending",value:null,reason:null,then:function(C){p.push(C)}};return a.then(function(){x.status="fulfilled",x.value=o;for(var C=0;C<p.length;C++)(0,p[C])(o)},function(C){for(x.status="rejected",x.reason=C,C=0;C<p.length;C++)(0,p[C])(void 0)}),x}var de=K.S;K.S=function(a,o){Y0=Q(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&V(a,o),de!==null&&de(a,o)};var me=ee(null);function Se(){var a=me.current;return a!==null?a:ci.pooledCache}function Ne(a,o){o===null?$(me,me.current):$(me,o.pool)}function Le(){var a=Se();return a===null?null:{parent:os._currentValue,pool:a}}var Ke=Error(n(460)),mt=Error(n(474)),Ce=Error(n(542)),it={then:function(){}};function st(a){return a=a.status,a==="fulfilled"||a==="rejected"}function Ut(a,o,p){switch(p=a[p],p===void 0?a.push(o):p!==o&&(o.then(jo,jo),o=p),o.status){case"fulfilled":return o.value;case"rejected":throw a=o.reason,Kt(a),a;default:if(typeof o.status=="string")o.then(jo,jo);else{if(a=ci,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=o,a.status="pending",a.then(function(x){if(o.status==="pending"){var C=o;C.status="fulfilled",C.value=x}},function(x){if(o.status==="pending"){var C=o;C.status="rejected",C.reason=x}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw a=o.reason,Kt(a),a}throw Bt=o,Ke}}function pt(a){try{var o=a._init;return o(a._payload)}catch(p){throw p!==null&&typeof p=="object"&&typeof p.then=="function"?(Bt=p,Ke):p}}var Bt=null;function Ft(){if(Bt===null)throw Error(n(459));var a=Bt;return Bt=null,a}function Kt(a){if(a===Ke||a===Ce)throw Error(n(483))}var Yt=null,Dn=0;function En(a){var o=Dn;return Dn+=1,Yt===null&&(Yt=[]),Ut(Yt,a,o)}function Wn(a,o){o=o.props.ref,a.ref=o!==void 0?o:null}function Ln(a,o){throw o.$$typeof===y?Error(n(525)):(a=Object.prototype.toString.call(o),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":a)))}function Ci(a){function o(ct,tt){if(a){var yt=ct.deletions;yt===null?(ct.deletions=[tt],ct.flags|=16):yt.push(tt)}}function p(ct,tt){if(!a)return null;for(;tt!==null;)o(ct,tt),tt=tt.sibling;return null}function x(ct){for(var tt=new Map;ct!==null;)ct.key!==null?tt.set(ct.key,ct):tt.set(ct.index,ct),ct=ct.sibling;return tt}function C(ct,tt){return ct=sa(ct,tt),ct.index=0,ct.sibling=null,ct}function P(ct,tt,yt){return ct.index=yt,a?(yt=ct.alternate,yt!==null?(yt=yt.index,yt<tt?(ct.flags|=67108866,tt):yt):(ct.flags|=67108866,tt)):(ct.flags|=1048576,tt)}function Z(ct){return a&&ct.alternate===null&&(ct.flags|=67108866),ct}function ye(ct,tt,yt,Wt){return tt===null||tt.tag!==6?(tt=tf(yt,ct.mode,Wt),tt.return=ct,tt):(tt=C(tt,yt),tt.return=ct,tt)}function He(ct,tt,yt,Wt){var Yn=yt.type;return Yn===T?Ht(ct,tt,yt.props.children,Wt,yt.key):tt!==null&&(tt.elementType===Yn||typeof Yn=="object"&&Yn!==null&&Yn.$$typeof===G&&pt(Yn)===tt.type)?(tt=C(tt,yt.props),Wn(tt,yt),tt.return=ct,tt):(tt=So(yt.type,yt.key,yt.props,null,ct.mode,Wt),Wn(tt,yt),tt.return=ct,tt)}function _t(ct,tt,yt,Wt){return tt===null||tt.tag!==4||tt.stateNode.containerInfo!==yt.containerInfo||tt.stateNode.implementation!==yt.implementation?(tt=pu(yt,ct.mode,Wt),tt.return=ct,tt):(tt=C(tt,yt.children||[]),tt.return=ct,tt)}function Ht(ct,tt,yt,Wt,Yn){return tt===null||tt.tag!==7?(tt=ac(yt,ct.mode,Wt,Yn),tt.return=ct,tt):(tt=C(tt,yt),tt.return=ct,tt)}function Zt(ct,tt,yt){if(typeof tt=="string"&&tt!==""||typeof tt=="number"||typeof tt=="bigint")return tt=tf(""+tt,ct.mode,yt),tt.return=ct,tt;if(typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case v:return yt=So(tt.type,tt.key,tt.props,null,ct.mode,yt),Wn(yt,tt),yt.return=ct,yt;case S:return tt=pu(tt,ct.mode,yt),tt.return=ct,tt;case G:return tt=pt(tt),Zt(ct,tt,yt)}if(ce(tt)||q(tt))return tt=ac(tt,ct.mode,yt,null),tt.return=ct,tt;if(typeof tt.then=="function")return Zt(ct,En(tt),yt);if(tt.$$typeof===D)return Zt(ct,sf(ct,tt),yt);Ln(ct,tt)}return null}function Nt(ct,tt,yt,Wt){var Yn=tt!==null?tt.key:null;if(typeof yt=="string"&&yt!==""||typeof yt=="number"||typeof yt=="bigint")return Yn!==null?null:ye(ct,tt,""+yt,Wt);if(typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case v:return yt.key===Yn?He(ct,tt,yt,Wt):null;case S:return yt.key===Yn?_t(ct,tt,yt,Wt):null;case G:return yt=pt(yt),Nt(ct,tt,yt,Wt)}if(ce(yt)||q(yt))return Yn!==null?null:Ht(ct,tt,yt,Wt,null);if(typeof yt.then=="function")return Nt(ct,tt,En(yt),Wt);if(yt.$$typeof===D)return Nt(ct,tt,sf(ct,yt),Wt);Ln(ct,yt)}return null}function Ot(ct,tt,yt,Wt,Yn){if(typeof Wt=="string"&&Wt!==""||typeof Wt=="number"||typeof Wt=="bigint")return ct=ct.get(yt)||null,ye(tt,ct,""+Wt,Yn);if(typeof Wt=="object"&&Wt!==null){switch(Wt.$$typeof){case v:return ct=ct.get(Wt.key===null?yt:Wt.key)||null,He(tt,ct,Wt,Yn);case S:return ct=ct.get(Wt.key===null?yt:Wt.key)||null,_t(tt,ct,Wt,Yn);case G:return Wt=pt(Wt),Ot(ct,tt,yt,Wt,Yn)}if(ce(Wt)||q(Wt))return ct=ct.get(yt)||null,Ht(tt,ct,Wt,Yn,null);if(typeof Wt.then=="function")return Ot(ct,tt,yt,En(Wt),Yn);if(Wt.$$typeof===D)return Ot(ct,tt,yt,sf(tt,Wt),Yn);Ln(tt,Wt)}return null}function Bn(ct,tt,yt,Wt){for(var Yn=null,fr=null,Fn=tt,Di=tt=0,tr=null;Fn!==null&&Di<yt.length;Di++){Fn.index>Di?(tr=Fn,Fn=null):tr=Fn.sibling;var hr=Nt(ct,Fn,yt[Di],Wt);if(hr===null){Fn===null&&(Fn=tr);break}a&&Fn&&hr.alternate===null&&o(ct,Fn),tt=P(hr,tt,Di),fr===null?Yn=hr:fr.sibling=hr,fr=hr,Fn=tr}if(Di===yt.length)return p(ct,Fn),Fi&&ja(ct,Di),Yn;if(Fn===null){for(;Di<yt.length;Di++)Fn=Zt(ct,yt[Di],Wt),Fn!==null&&(tt=P(Fn,tt,Di),fr===null?Yn=Fn:fr.sibling=Fn,fr=Fn);return Fi&&ja(ct,Di),Yn}for(Fn=x(Fn);Di<yt.length;Di++)tr=Ot(Fn,ct,Di,yt[Di],Wt),tr!==null&&(a&&tr.alternate!==null&&Fn.delete(tr.key===null?Di:tr.key),tt=P(tr,tt,Di),fr===null?Yn=tr:fr.sibling=tr,fr=tr);return a&&Fn.forEach(function($h){return o(ct,$h)}),Fi&&ja(ct,Di),Yn}function ri(ct,tt,yt,Wt){if(yt==null)throw Error(n(151));for(var Yn=null,fr=null,Fn=tt,Di=tt=0,tr=null,hr=yt.next();Fn!==null&&!hr.done;Di++,hr=yt.next()){Fn.index>Di?(tr=Fn,Fn=null):tr=Fn.sibling;var $h=Nt(ct,Fn,hr.value,Wt);if($h===null){Fn===null&&(Fn=tr);break}a&&Fn&&$h.alternate===null&&o(ct,Fn),tt=P($h,tt,Di),fr===null?Yn=$h:fr.sibling=$h,fr=$h,Fn=tr}if(hr.done)return p(ct,Fn),Fi&&ja(ct,Di),Yn;if(Fn===null){for(;!hr.done;Di++,hr=yt.next())hr=Zt(ct,hr.value,Wt),hr!==null&&(tt=P(hr,tt,Di),fr===null?Yn=hr:fr.sibling=hr,fr=hr);return Fi&&ja(ct,Di),Yn}for(Fn=x(Fn);!hr.done;Di++,hr=yt.next())hr=Ot(Fn,ct,Di,hr.value,Wt),hr!==null&&(a&&hr.alternate!==null&&Fn.delete(hr.key===null?Di:hr.key),tt=P(hr,tt,Di),fr===null?Yn=hr:fr.sibling=hr,fr=hr);return a&&Fn.forEach(function(XC){return o(ct,XC)}),Fi&&ja(ct,Di),Yn}function Ur(ct,tt,yt,Wt){if(typeof yt=="object"&&yt!==null&&yt.type===T&&yt.key===null&&(yt=yt.props.children),typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case v:e:{for(var Yn=yt.key;tt!==null;){if(tt.key===Yn){if(Yn=yt.type,Yn===T){if(tt.tag===7){p(ct,tt.sibling),Wt=C(tt,yt.props.children),Wt.return=ct,ct=Wt;break e}}else if(tt.elementType===Yn||typeof Yn=="object"&&Yn!==null&&Yn.$$typeof===G&&pt(Yn)===tt.type){p(ct,tt.sibling),Wt=C(tt,yt.props),Wn(Wt,yt),Wt.return=ct,ct=Wt;break e}p(ct,tt);break}else o(ct,tt);tt=tt.sibling}yt.type===T?(Wt=ac(yt.props.children,ct.mode,Wt,yt.key),Wt.return=ct,ct=Wt):(Wt=So(yt.type,yt.key,yt.props,null,ct.mode,Wt),Wn(Wt,yt),Wt.return=ct,ct=Wt)}return Z(ct);case S:e:{for(Yn=yt.key;tt!==null;){if(tt.key===Yn)if(tt.tag===4&&tt.stateNode.containerInfo===yt.containerInfo&&tt.stateNode.implementation===yt.implementation){p(ct,tt.sibling),Wt=C(tt,yt.children||[]),Wt.return=ct,ct=Wt;break e}else{p(ct,tt);break}else o(ct,tt);tt=tt.sibling}Wt=pu(yt,ct.mode,Wt),Wt.return=ct,ct=Wt}return Z(ct);case G:return yt=pt(yt),Ur(ct,tt,yt,Wt)}if(ce(yt))return Bn(ct,tt,yt,Wt);if(q(yt)){if(Yn=q(yt),typeof Yn!="function")throw Error(n(150));return yt=Yn.call(yt),ri(ct,tt,yt,Wt)}if(typeof yt.then=="function")return Ur(ct,tt,En(yt),Wt);if(yt.$$typeof===D)return Ur(ct,tt,sf(ct,yt),Wt);Ln(ct,yt)}return typeof yt=="string"&&yt!==""||typeof yt=="number"||typeof yt=="bigint"?(yt=""+yt,tt!==null&&tt.tag===6?(p(ct,tt.sibling),Wt=C(tt,yt),Wt.return=ct,ct=Wt):(p(ct,tt),Wt=tf(yt,ct.mode,Wt),Wt.return=ct,ct=Wt),Z(ct)):p(ct,tt)}return function(ct,tt,yt,Wt){try{Dn=0;var Yn=Ur(ct,tt,yt,Wt);return Yt=null,Yn}catch(Fn){if(Fn===Ke||Fn===Ce)throw Fn;var fr=br(29,Fn,null,ct.mode);return fr.lanes=Wt,fr.return=ct,fr}}}var pr=Ci(!0),li=Ci(!1),wn=!1;function yn(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Gr(a,o){a=a.updateQueue,o.updateQueue===a&&(o.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Xn(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function gi(a,o,p){var x=a.updateQueue;if(x===null)return null;if(x=x.shared,(zn&2)!==0){var C=x.pending;return C===null?o.next=o:(o.next=C.next,C.next=o),x.pending=o,o=Ir(a),$o(a,null,p),o}return Is(a,x,o,p),Ir(a)}function Ki(a,o,p){if(o=o.updateQueue,o!==null&&(o=o.shared,(p&4194048)!==0)){var x=o.lanes;x&=a.pendingLanes,p|=x,o.lanes=p,Bi(a,p)}}function Cn(a,o){var p=a.updateQueue,x=a.alternate;if(x!==null&&(x=x.updateQueue,p===x)){var C=null,P=null;if(p=p.firstBaseUpdate,p!==null){do{var Z={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};P===null?C=P=Z:P=P.next=Z,p=p.next}while(p!==null);P===null?C=P=o:P=P.next=o}else C=P=o;p={baseState:x.baseState,firstBaseUpdate:C,lastBaseUpdate:P,shared:x.shared,callbacks:x.callbacks},a.updateQueue=p;return}a=p.lastBaseUpdate,a===null?p.firstBaseUpdate=o:a.next=o,p.lastBaseUpdate=o}var oa=!1;function Sr(){if(oa){var a=N;if(a!==null)throw a}}function ls(a,o,p,x){oa=!1;var C=a.updateQueue;wn=!1;var P=C.firstBaseUpdate,Z=C.lastBaseUpdate,ye=C.shared.pending;if(ye!==null){C.shared.pending=null;var He=ye,_t=He.next;He.next=null,Z===null?P=_t:Z.next=_t,Z=He;var Ht=a.alternate;Ht!==null&&(Ht=Ht.updateQueue,ye=Ht.lastBaseUpdate,ye!==Z&&(ye===null?Ht.firstBaseUpdate=_t:ye.next=_t,Ht.lastBaseUpdate=He))}if(P!==null){var Zt=C.baseState;Z=0,Ht=_t=He=null,ye=P;do{var Nt=ye.lane&-536870913,Ot=Nt!==ye.lane;if(Ot?(Ti&Nt)===Nt:(x&Nt)===Nt){Nt!==0&&Nt===M&&(oa=!0),Ht!==null&&(Ht=Ht.next={lane:0,tag:ye.tag,payload:ye.payload,callback:null,next:null});e:{var Bn=a,ri=ye;Nt=o;var Ur=p;switch(ri.tag){case 1:if(Bn=ri.payload,typeof Bn=="function"){Zt=Bn.call(Ur,Zt,Nt);break e}Zt=Bn;break e;case 3:Bn.flags=Bn.flags&-65537|128;case 0:if(Bn=ri.payload,Nt=typeof Bn=="function"?Bn.call(Ur,Zt,Nt):Bn,Nt==null)break e;Zt=g({},Zt,Nt);break e;case 2:wn=!0}}Nt=ye.callback,Nt!==null&&(a.flags|=64,Ot&&(a.flags|=8192),Ot=C.callbacks,Ot===null?C.callbacks=[Nt]:Ot.push(Nt))}else Ot={lane:Nt,tag:ye.tag,payload:ye.payload,callback:ye.callback,next:null},Ht===null?(_t=Ht=Ot,He=Zt):Ht=Ht.next=Ot,Z|=Nt;if(ye=ye.next,ye===null){if(ye=C.shared.pending,ye===null)break;Ot=ye,ye=Ot.next,Ot.next=null,C.lastBaseUpdate=Ot,C.shared.pending=null}}while(!0);Ht===null&&(He=Zt),C.baseState=He,C.firstBaseUpdate=_t,C.lastBaseUpdate=Ht,P===null&&(C.shared.lanes=0),$c|=Z,a.lanes=Z,a.memoizedState=Zt}}function xs(a,o){if(typeof a!="function")throw Error(n(191,a));a.call(o)}function ys(a,o){var p=a.callbacks;if(p!==null)for(a.callbacks=null,a=0;a<p.length;a++)xs(p[a],o)}var Ni=ee(null),Qi=ee(0);function qr(a,o){a=nl,$(Qi,a),$(Ni,o),nl=a|o.baseLanes}function rr(){$(Qi,nl),$(Ni,Ni.current)}function cs(){nl=Qi.current,F(Ni),F(Qi)}var kr=ee(null),Hi=null;function Qr(a){var o=a.alternate;$(ei,ei.current&1),$(kr,a),Hi===null&&(o===null||Ni.current!==null||o.memoizedState!==null)&&(Hi=a)}function lr(a){$(ei,ei.current),$(kr,a),Hi===null&&(Hi=a)}function bs(a){a.tag===22?($(ei,ei.current),$(kr,a),Hi===null&&(Hi=a)):wr()}function wr(){$(ei,ei.current),$(kr,kr.current)}function Gi(a){F(kr),Hi===a&&(Hi=null),F(ei)}var ei=ee(0);function Nr(a){for(var o=a;o!==null;){if(o.tag===13){var p=o.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||kb(p)||Ob(p)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Ii=0,Vn=null,Gn=null,Kn=null,es=!1,Mo=!1,Na=!1,_s=0,zc=0,jc=null,of=0;function mr(){throw Error(n(321))}function Td(a,o){if(o===null)return!1;for(var p=0;p<o.length&&p<a.length;p++)if(!Ls(a[p],o[p]))return!1;return!0}function Th(a,o,p,x,C,P){return Ii=P,Vn=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,K.H=a===null||a.memoizedState===null?G1:D0,Na=!1,P=p(x,C),Na=!1,Mo&&(P=Ha(o,p,x,C)),Eh(a),P}function Eh(a){K.H=Dh;var o=Gn!==null&&Gn.next!==null;if(Ii=0,Kn=Gn=Vn=null,es=!1,zc=0,jc=null,o)throw Error(n(300));a===null||qs||(a=a.dependencies,a!==null&&Wf(a)&&(qs=!0))}function Ha(a,o,p,x){Vn=a;var C=0;do{if(Mo&&(jc=null),zc=0,Mo=!1,25<=C)throw Error(n(301));if(C+=1,Kn=Gn=null,a.updateQueue!=null){var P=a.updateQueue;P.lastEffect=null,P.events=null,P.stores=null,P.memoCache!=null&&(P.memoCache.index=0)}K.H=kl,P=o(p,x)}while(Mo);return P}function yu(){var a=K.H,o=a.useState()[0];return o=typeof o.then=="function"?Vc(o):o,a=a.useState()[0],(Gn!==null?Gn.memoizedState:null)!==a&&(Vn.flags|=1024),o}function Ed(){var a=_s!==0;return _s=0,a}function Cd(a,o,p){o.updateQueue=a.updateQueue,o.flags&=-2053,a.lanes&=~p}function Ch(a){if(es){for(a=a.memoizedState;a!==null;){var o=a.queue;o!==null&&(o.pending=null),a=a.next}es=!1}Ii=0,Kn=Gn=Vn=null,Mo=!1,zc=_s=0,jc=null}function ts(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kn===null?Vn.memoizedState=Kn=a:Kn=Kn.next=a,Kn}function ns(){if(Gn===null){var a=Vn.alternate;a=a!==null?a.memoizedState:null}else a=Gn.next;var o=Kn===null?Vn.memoizedState:Kn.next;if(o!==null)Kn=o,Gn=a;else{if(a===null)throw Vn.alternate===null?Error(n(467)):Error(n(310));Gn=a,a={memoizedState:Gn.memoizedState,baseState:Gn.baseState,baseQueue:Gn.baseQueue,queue:Gn.queue,next:null},Kn===null?Vn.memoizedState=Kn=a:Kn=Kn.next=a}return Kn}function Yf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Vc(a){var o=zc;return zc+=1,jc===null&&(jc=[]),a=Ut(jc,a,o),o=Vn,(Kn===null?o.memoizedState:Kn.next)===null&&(o=o.alternate,K.H=o===null||o.memoizedState===null?G1:D0),a}function Pl(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Vc(a);if(a.$$typeof===D)return Qn(a)}throw Error(n(438,String(a)))}function bu(a){var o=null,p=Vn.updateQueue;if(p!==null&&(o=p.memoCache),o==null){var x=Vn.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(o={data:x.data.map(function(C){return C.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),p===null&&(p=Yf(),Vn.updateQueue=p),p.memoCache=o,p=o.data[o.index],p===void 0)for(p=o.data[o.index]=Array(a),x=0;x<a;x++)p[x]=k;return o.index++,p}function Il(a,o){return typeof o=="function"?o(a):o}function Nh(a){var o=ns();return lf(o,Gn,a)}function lf(a,o,p){var x=a.queue;if(x===null)throw Error(n(311));x.lastRenderedReducer=p;var C=a.baseQueue,P=x.pending;if(P!==null){if(C!==null){var Z=C.next;C.next=P.next,P.next=Z}o.baseQueue=C=P,x.pending=null}if(P=a.baseState,C===null)a.memoizedState=P;else{o=C.next;var ye=Z=null,He=null,_t=o,Ht=!1;do{var Zt=_t.lane&-536870913;if(Zt!==_t.lane?(Ti&Zt)===Zt:(Ii&Zt)===Zt){var Nt=_t.revertLane;if(Nt===0)He!==null&&(He=He.next={lane:0,revertLane:0,gesture:null,action:_t.action,hasEagerState:_t.hasEagerState,eagerState:_t.eagerState,next:null}),Zt===M&&(Ht=!0);else if((Ii&Nt)===Nt){_t=_t.next,Nt===M&&(Ht=!0);continue}else Zt={lane:0,revertLane:_t.revertLane,gesture:null,action:_t.action,hasEagerState:_t.hasEagerState,eagerState:_t.eagerState,next:null},He===null?(ye=He=Zt,Z=P):He=He.next=Zt,Vn.lanes|=Nt,$c|=Nt;Zt=_t.action,Na&&p(P,Zt),P=_t.hasEagerState?_t.eagerState:p(P,Zt)}else Nt={lane:Zt,revertLane:_t.revertLane,gesture:_t.gesture,action:_t.action,hasEagerState:_t.hasEagerState,eagerState:_t.eagerState,next:null},He===null?(ye=He=Nt,Z=P):He=He.next=Nt,Vn.lanes|=Zt,$c|=Zt;_t=_t.next}while(_t!==null&&_t!==o);if(He===null?Z=P:He.next=ye,!Ls(P,a.memoizedState)&&(qs=!0,Ht&&(p=N,p!==null)))throw p;a.memoizedState=P,a.baseState=Z,a.baseQueue=He,x.lastRenderedState=P}return C===null&&(x.lanes=0),[a.memoizedState,x.dispatch]}function Rh(a){var o=ns(),p=o.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=a;var x=p.dispatch,C=p.pending,P=o.memoizedState;if(C!==null){p.pending=null;var Z=C=C.next;do P=a(P,Z.action),Z=Z.next;while(Z!==C);Ls(P,o.memoizedState)||(qs=!0),o.memoizedState=P,o.baseQueue===null&&(o.baseState=P),p.lastRenderedState=P}return[P,x]}function Lh(a,o,p){var x=Vn,C=ns(),P=Fi;if(P){if(p===void 0)throw Error(n(407));p=p()}else p=o();var Z=!Ls((Gn||C).memoizedState,p);if(Z&&(C.memoizedState=p,qs=!0),C=C.queue,C0(Rd.bind(null,x,C,a),[a]),C.getSnapshot!==o||Z||Kn!==null&&Kn.memoizedState.tag&1){if(x.flags|=2048,mc(9,{destroy:void 0},Nd.bind(null,x,C,p,o),null),ci===null)throw Error(n(349));P||(Ii&127)!==0||dc(x,o,p)}return p}function dc(a,o,p){a.flags|=16384,a={getSnapshot:o,value:p},o=Vn.updateQueue,o===null?(o=Yf(),Vn.updateQueue=o,o.stores=[a]):(p=o.stores,p===null?o.stores=[a]:p.push(a))}function Nd(a,o,p,x){o.value=p,o.getSnapshot=x,Hp(o)&&Ld(a)}function Rd(a,o,p){return p(function(){Hp(o)&&Ld(a)})}function Hp(a){var o=a.getSnapshot;a=a.value;try{var p=o();return!Ls(a,p)}catch{return!0}}function Ld(a){var o=ra(a,2);o!==null&&Li(o,a,2)}function Hc(a){var o=ts();if(typeof a=="function"){var p=a;if(a=p(),Na){Ge(!0);try{p()}finally{Ge(!1)}}}return o.memoizedState=o.baseState=a,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Il,lastRenderedState:a},o}function Pd(a,o,p,x){return a.baseState=p,lf(a,Gn,typeof x=="function"?x:Il)}function Gp(a,o,p,x,C){if(Xp(a))throw Error(n(485));if(a=o.action,a!==null){var P={payload:C,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Z){P.listeners.push(Z)}};K.T!==null?p(!0):P.isTransition=!1,x(P),p=o.pending,p===null?(P.next=o.pending=P,qp(o,P)):(P.next=p.next,o.pending=p.next=P)}}function qp(a,o){var p=o.action,x=o.payload,C=a.state;if(o.isTransition){var P=K.T,Z={};K.T=Z;try{var ye=p(C,x),He=K.S;He!==null&&He(Z,ye),Id(a,o,ye)}catch(_t){_u(a,o,_t)}finally{P!==null&&Z.types!==null&&(P.types=Z.types),K.T=P}}else try{P=p(C,x),Id(a,o,P)}catch(_t){_u(a,o,_t)}}function Id(a,o,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(x){Wp(a,o,x)},function(x){return _u(a,o,x)}):Wp(a,o,p)}function Wp(a,o,p){o.status="fulfilled",o.value=p,Ph(o),a.state=p,o=a.pending,o!==null&&(p=o.next,p===o?a.pending=null:(p=p.next,o.next=p,qp(a,p)))}function _u(a,o,p){var x=a.pending;if(a.pending=null,x!==null){x=x.next;do o.status="rejected",o.reason=p,Ph(o),o=o.next;while(o!==x)}a.action=null}function Ph(a){a=a.listeners;for(var o=0;o<a.length;o++)(0,a[o])()}function cf(a,o){return o}function Qo(a,o){if(Fi){var p=ci.formState;if(p!==null){e:{var x=Vn;if(Fi){if(_r){t:{for(var C=_r,P=Hr;C.nodeType!==8;){if(!P){C=null;break t}if(C=Qc(C.nextSibling),C===null){C=null;break t}}P=C.data,C=P==="F!"||P==="F"?C:null}if(C){_r=Qc(C.nextSibling),x=C.data==="F!";break e}}Ll(x)}x=!1}x&&(o=p[0])}}return p=ts(),p.memoizedState=p.baseState=o,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:cf,lastRenderedState:o},p.queue=x,p=j1.bind(null,Vn,x),x.dispatch=p,x=Hc(!1),P=I0.bind(null,Vn,!1,x.queue),x=ts(),C={state:o,dispatch:null,action:a,pending:null},x.queue=C,p=Gp.bind(null,Vn,C,P,p),C.dispatch=p,x.memoizedState=a,[o,p,!1]}function pc(a){var o=ns();return Dl(o,Gn,a)}function Dl(a,o,p){if(o=lf(a,o,cf)[0],a=Nh(Il)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var x=Vc(o)}catch(Z){throw Z===Ke?Ce:Z}else x=o;o=ns();var C=o.queue,P=C.dispatch;return p!==o.memoizedState&&(Vn.flags|=2048,mc(9,{destroy:void 0},Zf.bind(null,C,p),null)),[x,P,a]}function Zf(a,o){a.action=o}function $f(a){var o=ns(),p=Gn;if(p!==null)return Dl(o,p,a);ns(),o=o.memoizedState,p=ns();var x=p.queue.dispatch;return p.memoizedState=a,[o,x,!1]}function mc(a,o,p,x){return a={tag:a,create:p,deps:x,inst:o,next:null},o=Vn.updateQueue,o===null&&(o=Yf(),Vn.updateQueue=o),p=o.lastEffect,p===null?o.lastEffect=a.next=a:(x=p.next,p.next=a,a.next=x,o.lastEffect=a),a}function Ih(){return ns().memoizedState}function uf(a,o,p,x){var C=ts();Vn.flags|=a,C.memoizedState=mc(1|o,{destroy:void 0},p,x===void 0?null:x)}function ff(a,o,p,x){var C=ns();x=x===void 0?null:x;var P=C.memoizedState.inst;Gn!==null&&x!==null&&Td(x,Gn.memoizedState.deps)?C.memoizedState=mc(o,P,p,x):(Vn.flags|=a,C.memoizedState=mc(1|o,P,p,x))}function T1(a,o){uf(8390656,8,a,o)}function C0(a,o){ff(2048,8,a,o)}function E1(a){Vn.flags|=4;var o=Vn.updateQueue;if(o===null)o=Yf(),Vn.updateQueue=o,o.events=[a];else{var p=o.events;p===null?o.events=[a]:p.push(a)}}function C1(a){var o=ns().memoizedState;return E1({ref:o,nextImpl:a}),function(){if((zn&2)!==0)throw Error(n(440));return o.impl.apply(void 0,arguments)}}function N1(a,o){return ff(4,2,a,o)}function R1(a,o){return ff(4,4,a,o)}function L1(a,o){if(typeof o=="function"){a=a();var p=o(a);return function(){typeof p=="function"?p():o(null)}}if(o!=null)return a=a(),o.current=a,function(){o.current=null}}function P1(a,o,p){p=p!=null?p.concat([a]):null,ff(4,4,L1.bind(null,o,a),p)}function N0(){}function I1(a,o){var p=ns();o=o===void 0?null:o;var x=p.memoizedState;return o!==null&&Td(o,x[1])?x[0]:(p.memoizedState=[a,o],a)}function D1(a,o){var p=ns();o=o===void 0?null:o;var x=p.memoizedState;if(o!==null&&Td(o,x[1]))return x[0];if(x=a(),Na){Ge(!0);try{a()}finally{Ge(!1)}}return p.memoizedState=[x,o],x}function R0(a,o,p){return p===void 0||(Ii&1073741824)!==0&&(Ti&261930)===0?a.memoizedState=o:(a.memoizedState=p,a=zi(),Vn.lanes|=a,$c|=a,p)}function k1(a,o,p,x){return Ls(p,o)?p:Ni.current!==null?(a=R0(a,p,x),Ls(a,o)||(qs=!0),a):(Ii&42)===0||(Ii&1073741824)!==0&&(Ti&261930)===0?(qs=!0,a.memoizedState=p):(a=zi(),Vn.lanes|=a,$c|=a,o)}function O1(a,o,p,x,C){var P=ne.p;ne.p=P!==0&&8>P?P:8;var Z=K.T,ye={};K.T=ye,I0(a,!1,o,p);try{var He=C(),_t=K.S;if(_t!==null&&_t(ye,He),He!==null&&typeof He=="object"&&typeof He.then=="function"){var Ht=oe(He,x);Dd(a,o,Ht,rl(a))}else Dd(a,o,x,rl(a))}catch(Zt){Dd(a,o,{then:function(){},status:"rejected",reason:Zt},rl())}finally{ne.p=P,Z!==null&&ye.types!==null&&(Z.types=ye.types),K.T=Z}}function bb(){}function L0(a,o,p,x){if(a.tag!==5)throw Error(n(476));var C=B1(a).queue;O1(a,C,o,pe,p===null?bb:function(){return U1(a),p(x)})}function B1(a){var o=a.memoizedState;if(o!==null)return o;o={memoizedState:pe,baseState:pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Il,lastRenderedState:pe},next:null};var p={};return o.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Il,lastRenderedState:p},next:null},a.memoizedState=o,a=a.alternate,a!==null&&(a.memoizedState=o),o}function U1(a){var o=B1(a);o.next===null&&(o=a.alternate.memoizedState),Dd(a,o.next.queue,{},rl())}function P0(){return Qn(eg)}function F1(){return ns().memoizedState}function z1(){return ns().memoizedState}function _b(a){for(var o=a.return;o!==null;){switch(o.tag){case 24:case 3:var p=rl();a=Xn(p);var x=gi(o,a,p);x!==null&&(Li(x,o,p),Ki(x,o,p)),o={cache:af()},a.payload=o;return}o=o.return}}function Sb(a,o,p){var x=rl();p={lane:x,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},Xp(a)?V1(o,p):(p=Hf(a,o,p,x),p!==null&&(Li(p,a,x),H1(p,o,x)))}function j1(a,o,p){var x=rl();Dd(a,o,p,x)}function Dd(a,o,p,x){var C={lane:x,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null};if(Xp(a))V1(o,C);else{var P=a.alternate;if(a.lanes===0&&(P===null||P.lanes===0)&&(P=o.lastRenderedReducer,P!==null))try{var Z=o.lastRenderedState,ye=P(Z,p);if(C.hasEagerState=!0,C.eagerState=ye,Ls(ye,Z))return Is(a,o,C,0),ci===null&&Qu(),!1}catch{}if(p=Hf(a,o,C,x),p!==null)return Li(p,a,x),H1(p,o,x),!0}return!1}function I0(a,o,p,x){if(x={lane:2,revertLane:Pt(),gesture:null,action:x,hasEagerState:!1,eagerState:null,next:null},Xp(a)){if(o)throw Error(n(479))}else o=Hf(a,p,x,2),o!==null&&Li(o,a,2)}function Xp(a){var o=a.alternate;return a===Vn||o!==null&&o===Vn}function V1(a,o){Mo=es=!0;var p=a.pending;p===null?o.next=o:(o.next=p.next,p.next=o),a.pending=o}function H1(a,o,p){if((p&4194048)!==0){var x=o.lanes;x&=a.pendingLanes,p|=x,o.lanes=p,Bi(a,p)}}var Dh={readContext:Qn,use:Pl,useCallback:mr,useContext:mr,useEffect:mr,useImperativeHandle:mr,useLayoutEffect:mr,useInsertionEffect:mr,useMemo:mr,useReducer:mr,useRef:mr,useState:mr,useDebugValue:mr,useDeferredValue:mr,useTransition:mr,useSyncExternalStore:mr,useId:mr,useHostTransitionStatus:mr,useFormState:mr,useActionState:mr,useOptimistic:mr,useMemoCache:mr,useCacheRefresh:mr};Dh.useEffectEvent=mr;var G1={readContext:Qn,use:Pl,useCallback:function(a,o){return ts().memoizedState=[a,o===void 0?null:o],a},useContext:Qn,useEffect:T1,useImperativeHandle:function(a,o,p){p=p!=null?p.concat([a]):null,uf(4194308,4,L1.bind(null,o,a),p)},useLayoutEffect:function(a,o){return uf(4194308,4,a,o)},useInsertionEffect:function(a,o){uf(4,2,a,o)},useMemo:function(a,o){var p=ts();o=o===void 0?null:o;var x=a();if(Na){Ge(!0);try{a()}finally{Ge(!1)}}return p.memoizedState=[x,o],x},useReducer:function(a,o,p){var x=ts();if(p!==void 0){var C=p(o);if(Na){Ge(!0);try{p(o)}finally{Ge(!1)}}}else C=o;return x.memoizedState=x.baseState=C,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:C},x.queue=a,a=a.dispatch=Sb.bind(null,Vn,a),[x.memoizedState,a]},useRef:function(a){var o=ts();return a={current:a},o.memoizedState=a},useState:function(a){a=Hc(a);var o=a.queue,p=j1.bind(null,Vn,o);return o.dispatch=p,[a.memoizedState,p]},useDebugValue:N0,useDeferredValue:function(a,o){var p=ts();return R0(p,a,o)},useTransition:function(){var a=Hc(!1);return a=O1.bind(null,Vn,a.queue,!0,!1),ts().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,o,p){var x=Vn,C=ts();if(Fi){if(p===void 0)throw Error(n(407));p=p()}else{if(p=o(),ci===null)throw Error(n(349));(Ti&127)!==0||dc(x,o,p)}C.memoizedState=p;var P={value:p,getSnapshot:o};return C.queue=P,T1(Rd.bind(null,x,P,a),[a]),x.flags|=2048,mc(9,{destroy:void 0},Nd.bind(null,x,P,p,o),null),p},useId:function(){var a=ts(),o=ci.identifierPrefix;if(Fi){var p=oo,x=Cr;p=(x&~(1<<32-xe(x)-1)).toString(32)+p,o="_"+o+"R_"+p,p=_s++,0<p&&(o+="H"+p.toString(32)),o+="_"}else p=of++,o="_"+o+"r_"+p.toString(32)+"_";return a.memoizedState=o},useHostTransitionStatus:P0,useFormState:Qo,useActionState:Qo,useOptimistic:function(a){var o=ts();o.memoizedState=o.baseState=a;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=p,o=I0.bind(null,Vn,!0,p),p.dispatch=o,[a,o]},useMemoCache:bu,useCacheRefresh:function(){return ts().memoizedState=_b.bind(null,Vn)},useEffectEvent:function(a){var o=ts(),p={impl:a};return o.memoizedState=p,function(){if((zn&2)!==0)throw Error(n(440));return p.impl.apply(void 0,arguments)}}},D0={readContext:Qn,use:Pl,useCallback:I1,useContext:Qn,useEffect:C0,useImperativeHandle:P1,useInsertionEffect:N1,useLayoutEffect:R1,useMemo:D1,useReducer:Nh,useRef:Ih,useState:function(){return Nh(Il)},useDebugValue:N0,useDeferredValue:function(a,o){var p=ns();return k1(p,Gn.memoizedState,a,o)},useTransition:function(){var a=Nh(Il)[0],o=ns().memoizedState;return[typeof a=="boolean"?a:Vc(a),o]},useSyncExternalStore:Lh,useId:F1,useHostTransitionStatus:P0,useFormState:pc,useActionState:pc,useOptimistic:function(a,o){var p=ns();return Pd(p,Gn,a,o)},useMemoCache:bu,useCacheRefresh:z1};D0.useEffectEvent=C1;var kl={readContext:Qn,use:Pl,useCallback:I1,useContext:Qn,useEffect:C0,useImperativeHandle:P1,useInsertionEffect:N1,useLayoutEffect:R1,useMemo:D1,useReducer:Rh,useRef:Ih,useState:function(){return Rh(Il)},useDebugValue:N0,useDeferredValue:function(a,o){var p=ns();return Gn===null?R0(p,a,o):k1(p,Gn.memoizedState,a,o)},useTransition:function(){var a=Rh(Il)[0],o=ns().memoizedState;return[typeof a=="boolean"?a:Vc(a),o]},useSyncExternalStore:Lh,useId:F1,useHostTransitionStatus:P0,useFormState:$f,useActionState:$f,useOptimistic:function(a,o){var p=ns();return Gn!==null?Pd(p,Gn,a,o):(p.baseState=a,[a,p.queue.dispatch])},useMemoCache:bu,useCacheRefresh:z1};kl.useEffectEvent=C1;function Yp(a,o,p,x){o=a.memoizedState,p=p(x,o),p=p==null?o:g({},o,p),a.memoizedState=p,a.lanes===0&&(a.updateQueue.baseState=p)}var kd={enqueueSetState:function(a,o,p){a=a._reactInternals;var x=rl(),C=Xn(x);C.payload=o,p!=null&&(C.callback=p),o=gi(a,C,x),o!==null&&(Li(o,a,x),Ki(o,a,x))},enqueueReplaceState:function(a,o,p){a=a._reactInternals;var x=rl(),C=Xn(x);C.tag=1,C.payload=o,p!=null&&(C.callback=p),o=gi(a,C,x),o!==null&&(Li(o,a,x),Ki(o,a,x))},enqueueForceUpdate:function(a,o){a=a._reactInternals;var p=rl(),x=Xn(p);x.tag=2,o!=null&&(x.callback=o),o=gi(a,x,p),o!==null&&(Li(o,a,p),Ki(o,a,p))}};function k0(a,o,p,x,C,P,Z){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(x,P,Z):o.prototype&&o.prototype.isPureReactComponent?!Tl(p,x)||!Tl(C,P):!0}function O0(a,o,p,x){a=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(p,x),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(p,x),o.state!==a&&kd.enqueueReplaceState(o,o.state,null)}function hf(a,o){var p=o;if("ref"in o){p={};for(var x in o)x!=="ref"&&(p[x]=o[x])}if(a=a.defaultProps){p===o&&(p=g({},p));for(var C in a)p[C]===void 0&&(p[C]=a[C])}return p}function q1(a){Ku(a)}function B0(a){console.error(a)}function U0(a){Ku(a)}function Zp(a,o){try{var p=a.onUncaughtError;p(o.value,{componentStack:o.stack})}catch(x){setTimeout(function(){throw x})}}function W1(a,o,p){try{var x=a.onCaughtError;x(p.value,{componentStack:p.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(C){setTimeout(function(){throw C})}}function F0(a,o,p){return p=Xn(p),p.tag=3,p.payload={element:null},p.callback=function(){Zp(a,o)},p}function z0(a){return a=Xn(a),a.tag=3,a}function X1(a,o,p,x){var C=p.type.getDerivedStateFromError;if(typeof C=="function"){var P=x.value;a.payload=function(){return C(P)},a.callback=function(){W1(o,p,x)}}var Z=p.stateNode;Z!==null&&typeof Z.componentDidCatch=="function"&&(a.callback=function(){W1(o,p,x),typeof C!="function"&&(Bs===null?Bs=new Set([this]):Bs.add(this));var ye=x.stack;this.componentDidCatch(x.value,{componentStack:ye!==null?ye:""})})}function la(a,o,p,x,C){if(p.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(o=p.alternate,o!==null&&wo(o,p,C,!0),p=kr.current,p!==null){switch(p.tag){case 31:case 13:return Hi===null?jh():p.alternate===null&&us===0&&(us=3),p.flags&=-257,p.flags|=65536,p.lanes=C,x===it?p.flags|=16384:(o=p.updateQueue,o===null?p.updateQueue=new Set([x]):o.add(x),Xd(a,x,C)),!1;case 22:return p.flags|=65536,x===it?p.flags|=16384:(o=p.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([x])},p.updateQueue=o):(p=o.retryQueue,p===null?o.retryQueue=new Set([x]):p.add(x)),Xd(a,x,C)),!1}throw Error(n(435,p.tag))}return Xd(a,x,C),jh(),!1}if(Fi)return o=kr.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=C,x!==Va&&(a=Error(n(422),{cause:x}),Jo(ao(a,p)))):(x!==Va&&(o=Error(n(423),{cause:x}),Jo(ao(o,p))),a=a.current.alternate,a.flags|=65536,C&=-C,a.lanes|=C,x=ao(x,p),C=F0(a.stateNode,x,C),Cn(a,C),us!==4&&(us=2)),!1;var P=Error(n(520),{cause:x});if(P=ao(P,p),rh===null?rh=[P]:rh.push(P),us!==4&&(us=2),o===null)return!0;x=ao(x,p),p=o;do{switch(p.tag){case 3:return p.flags|=65536,a=C&-C,p.lanes|=a,a=F0(p.stateNode,x,a),Cn(p,a),!1;case 1:if(o=p.type,P=p.stateNode,(p.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(Bs===null||!Bs.has(P))))return p.flags|=65536,C&=-C,p.lanes|=C,C=z0(C),X1(C,a,p,x),Cn(p,C),!1}p=p.return}while(p!==null);return!1}var $p=Error(n(461)),qs=!1;function Sa(a,o,p,x){o.child=a===null?li(o,null,p,x):pr(o,a.child,p,x)}function j0(a,o,p,x,C){p=p.render;var P=o.ref;if("ref"in x){var Z={};for(var ye in x)ye!=="ref"&&(Z[ye]=x[ye])}else Z=x;return hc(o),x=Th(a,o,p,Z,P,C),ye=Ed(),a!==null&&!qs?(Cd(a,o,C),ks(a,o,C)):(Fi&&ye&&Rl(o),o.flags|=1,Sa(a,o,x,C),o.child)}function Jf(a,o,p,x,C){if(a===null){var P=p.type;return typeof P=="function"&&!Gf(P)&&P.defaultProps===void 0&&p.compare===null?(o.tag=15,o.type=P,Jp(a,o,P,x,C)):(a=So(p.type,null,x,o,o.mode,C),a.ref=o.ref,a.return=o,o.child=a)}if(P=a.child,!im(a,C)){var Z=P.memoizedProps;if(p=p.compare,p=p!==null?p:Tl,p(Z,x)&&a.ref===o.ref)return ks(a,o,C)}return o.flags|=1,a=sa(P,x),a.ref=o.ref,a.return=o,o.child=a}function Jp(a,o,p,x,C){if(a!==null){var P=a.memoizedProps;if(Tl(P,x)&&a.ref===o.ref)if(qs=!1,o.pendingProps=x=P,im(a,C))(a.flags&131072)!==0&&(qs=!0);else return o.lanes=a.lanes,ks(a,o,C)}return kh(a,o,p,x,C)}function Kf(a,o,p,x){var C=x.children,P=a!==null?a.memoizedState:null;if(a===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),x.mode==="hidden"){if((o.flags&128)!==0){if(P=P!==null?P.baseLanes|p:p,a!==null){for(x=o.child=a.child,C=0;x!==null;)C=C|x.lanes|x.childLanes,x=x.sibling;x=C&~P}else x=0,o.child=null;return Ao(a,o,P,p,x)}if((p&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},a!==null&&Ne(o,P!==null?P.cachePool:null),P!==null?qr(o,P):rr(),bs(o);else return x=o.lanes=536870912,Ao(a,o,P!==null?P.baseLanes|p:p,p,x)}else P!==null?(Ne(o,P.cachePool),qr(o,P),wr(),o.memoizedState=null):(a!==null&&Ne(o,null),rr(),wr());return Sa(a,o,C,p),o.child}function Gc(a,o){return a!==null&&a.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function Ao(a,o,p,x,C){var P=Se();return P=P===null?null:{parent:os._currentValue,pool:P},o.memoizedState={baseLanes:p,cachePool:P},a!==null&&Ne(o,null),rr(),bs(o),a!==null&&wo(a,o,x,!0),o.childLanes=C,null}function Kp(a,o){return o=nm({mode:o.mode,children:o.children},a.mode),o.ref=a.ref,a.child=o,o.return=a,o}function Y1(a,o,p){return pr(o,a.child,null,p),a=Kp(o,o.pendingProps),a.flags|=2,Gi(o),o.memoizedState=null,a}function Qp(a,o,p){var x=o.pendingProps,C=(o.flags&128)!==0;if(o.flags&=-129,a===null){if(Fi){if(x.mode==="hidden")return a=Kp(o,x),o.lanes=536870912,Gc(null,a);if(lr(o),(a=_r)?(a=I2(a,Hr),a=a!==null&&a.data==="&"?a:null,a!==null&&(o.memoizedState={dehydrated:a,treeContext:lc!==null?{id:Cr,overflow:oo}:null,retryLane:536870912,hydrationErrors:null},p=Oc(a),p.return=o,o.child=p,Kr=o,_r=null)):a=null,a===null)throw Ll(o);return o.lanes=536870912,null}return Kp(o,x)}var P=a.memoizedState;if(P!==null){var Z=P.dehydrated;if(lr(o),C)if(o.flags&256)o.flags&=-257,o=Y1(a,o,p);else if(o.memoizedState!==null)o.child=a.child,o.flags|=128,o=null;else throw Error(n(558));else if(qs||wo(a,o,p,!1),C=(p&a.childLanes)!==0,qs||C){if(x=ci,x!==null&&(Z=xi(x,p),Z!==0&&Z!==P.retryLane))throw P.retryLane=Z,ra(a,Z),Li(x,a,Z),$p;jh(),o=Y1(a,o,p)}else a=P.treeContext,_r=Qc(Z.nextSibling),Kr=o,Fi=!0,_a=null,Hr=!1,a!==null&&Mh(o,a),o=Kp(o,x),o.flags|=4096;return o}return a=sa(a.child,{mode:x.mode,children:x.children}),a.ref=o.ref,o.child=a,a.return=o,a}function Qf(a,o){var p=o.ref;if(p===null)a!==null&&a.ref!==null&&(o.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(n(284));(a===null||a.ref!==p)&&(o.flags|=4194816)}}function kh(a,o,p,x,C){return hc(o),p=Th(a,o,p,x,void 0,C),x=Ed(),a!==null&&!qs?(Cd(a,o,C),ks(a,o,C)):(Fi&&x&&Rl(o),o.flags|=1,Sa(a,o,p,C),o.child)}function Od(a,o,p,x,C,P){return hc(o),o.updateQueue=null,p=Ha(o,x,p,C),Eh(a),x=Ed(),a!==null&&!qs?(Cd(a,o,P),ks(a,o,P)):(Fi&&x&&Rl(o),o.flags|=1,Sa(a,o,p,P),o.child)}function em(a,o,p,x,C){if(hc(o),o.stateNode===null){var P=Ds,Z=p.contextType;typeof Z=="object"&&Z!==null&&(P=Qn(Z)),P=new p(x,P),o.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,P.updater=kd,o.stateNode=P,P._reactInternals=o,P=o.stateNode,P.props=x,P.state=o.memoizedState,P.refs={},yn(o),Z=p.contextType,P.context=typeof Z=="object"&&Z!==null?Qn(Z):Ds,P.state=o.memoizedState,Z=p.getDerivedStateFromProps,typeof Z=="function"&&(Yp(o,p,Z,x),P.state=o.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(Z=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),Z!==P.state&&kd.enqueueReplaceState(P,P.state,null),ls(o,x,P,C),Sr(),P.state=o.memoizedState),typeof P.componentDidMount=="function"&&(o.flags|=4194308),x=!0}else if(a===null){P=o.stateNode;var ye=o.memoizedProps,He=hf(p,ye);P.props=He;var _t=P.context,Ht=p.contextType;Z=Ds,typeof Ht=="object"&&Ht!==null&&(Z=Qn(Ht));var Zt=p.getDerivedStateFromProps;Ht=typeof Zt=="function"||typeof P.getSnapshotBeforeUpdate=="function",ye=o.pendingProps!==ye,Ht||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(ye||_t!==Z)&&O0(o,P,x,Z),wn=!1;var Nt=o.memoizedState;P.state=Nt,ls(o,x,P,C),Sr(),_t=o.memoizedState,ye||Nt!==_t||wn?(typeof Zt=="function"&&(Yp(o,p,Zt,x),_t=o.memoizedState),(He=wn||k0(o,p,He,x,Nt,_t,Z))?(Ht||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(o.flags|=4194308)):(typeof P.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=x,o.memoizedState=_t),P.props=x,P.state=_t,P.context=Z,x=He):(typeof P.componentDidMount=="function"&&(o.flags|=4194308),x=!1)}else{P=o.stateNode,Gr(a,o),Z=o.memoizedProps,Ht=hf(p,Z),P.props=Ht,Zt=o.pendingProps,Nt=P.context,_t=p.contextType,He=Ds,typeof _t=="object"&&_t!==null&&(He=Qn(_t)),ye=p.getDerivedStateFromProps,(_t=typeof ye=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(Z!==Zt||Nt!==He)&&O0(o,P,x,He),wn=!1,Nt=o.memoizedState,P.state=Nt,ls(o,x,P,C),Sr();var Ot=o.memoizedState;Z!==Zt||Nt!==Ot||wn||a!==null&&a.dependencies!==null&&Wf(a.dependencies)?(typeof ye=="function"&&(Yp(o,p,ye,x),Ot=o.memoizedState),(Ht=wn||k0(o,p,Ht,x,Nt,Ot,He)||a!==null&&a.dependencies!==null&&Wf(a.dependencies))?(_t||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(x,Ot,He),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(x,Ot,He)),typeof P.componentDidUpdate=="function"&&(o.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof P.componentDidUpdate!="function"||Z===a.memoizedProps&&Nt===a.memoizedState||(o.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||Z===a.memoizedProps&&Nt===a.memoizedState||(o.flags|=1024),o.memoizedProps=x,o.memoizedState=Ot),P.props=x,P.state=Ot,P.context=He,x=Ht):(typeof P.componentDidUpdate!="function"||Z===a.memoizedProps&&Nt===a.memoizedState||(o.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||Z===a.memoizedProps&&Nt===a.memoizedState||(o.flags|=1024),x=!1)}return P=x,Qf(a,o),x=(o.flags&128)!==0,P||x?(P=o.stateNode,p=x&&typeof p.getDerivedStateFromError!="function"?null:P.render(),o.flags|=1,a!==null&&x?(o.child=pr(o,a.child,null,C),o.child=pr(o,null,p,C)):Sa(a,o,p,C),o.memoizedState=P.state,a=o.child):a=ks(a,o,C),a}function Z1(a,o,p,x){return Uc(),o.flags|=256,Sa(a,o,p,x),o.child}var V0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ga(a){return{baseLanes:a,cachePool:Le()}}function tm(a,o,p){return a=a!==null?a.childLanes&~p:0,o&&(a|=ho),a}function $1(a,o,p){var x=o.pendingProps,C=!1,P=(o.flags&128)!==0,Z;if((Z=P)||(Z=a!==null&&a.memoizedState===null?!1:(ei.current&2)!==0),Z&&(C=!0,o.flags&=-129),Z=(o.flags&32)!==0,o.flags&=-33,a===null){if(Fi){if(C?Qr(o):wr(),(a=_r)?(a=I2(a,Hr),a=a!==null&&a.data!=="&"?a:null,a!==null&&(o.memoizedState={dehydrated:a,treeContext:lc!==null?{id:Cr,overflow:oo}:null,retryLane:536870912,hydrationErrors:null},p=Oc(a),p.return=o,o.child=p,Kr=o,_r=null)):a=null,a===null)throw Ll(o);return Ob(a)?o.lanes=32:o.lanes=536870912,null}var ye=x.children;return x=x.fallback,C?(wr(),C=o.mode,ye=nm({mode:"hidden",children:ye},C),x=ac(x,C,p,null),ye.return=o,x.return=o,ye.sibling=x,o.child=ye,x=o.child,x.memoizedState=Ga(p),x.childLanes=tm(a,Z,p),o.memoizedState=V0,Gc(null,x)):(Qr(o),Bd(o,ye))}var He=a.memoizedState;if(He!==null&&(ye=He.dehydrated,ye!==null)){if(P)o.flags&256?(Qr(o),o.flags&=-257,o=H0(a,o,p)):o.memoizedState!==null?(wr(),o.child=a.child,o.flags|=128,o=null):(wr(),ye=x.fallback,C=o.mode,x=nm({mode:"visible",children:x.children},C),ye=ac(ye,C,p,null),ye.flags|=2,x.return=o,ye.return=o,x.sibling=ye,o.child=x,pr(o,a.child,null,p),x=o.child,x.memoizedState=Ga(p),x.childLanes=tm(a,Z,p),o.memoizedState=V0,o=Gc(null,x));else if(Qr(o),Ob(ye)){if(Z=ye.nextSibling&&ye.nextSibling.dataset,Z)var _t=Z.dgst;Z=_t,x=Error(n(419)),x.stack="",x.digest=Z,Jo({value:x,source:null,stack:null}),o=H0(a,o,p)}else if(qs||wo(a,o,p,!1),Z=(p&a.childLanes)!==0,qs||Z){if(Z=ci,Z!==null&&(x=xi(Z,p),x!==0&&x!==He.retryLane))throw He.retryLane=x,ra(a,x),Li(Z,a,x),$p;kb(ye)||jh(),o=H0(a,o,p)}else kb(ye)?(o.flags|=192,o.child=a.child,o=null):(a=He.treeContext,_r=Qc(ye.nextSibling),Kr=o,Fi=!0,_a=null,Hr=!1,a!==null&&Mh(o,a),o=Bd(o,x.children),o.flags|=4096);return o}return C?(wr(),ye=x.fallback,C=o.mode,He=a.child,_t=He.sibling,x=sa(He,{mode:"hidden",children:x.children}),x.subtreeFlags=He.subtreeFlags&65011712,_t!==null?ye=sa(_t,ye):(ye=ac(ye,C,p,null),ye.flags|=2),ye.return=o,x.return=o,x.sibling=ye,o.child=x,Gc(null,x),x=o.child,ye=a.child.memoizedState,ye===null?ye=Ga(p):(C=ye.cachePool,C!==null?(He=os._currentValue,C=C.parent!==He?{parent:He,pool:He}:C):C=Le(),ye={baseLanes:ye.baseLanes|p,cachePool:C}),x.memoizedState=ye,x.childLanes=tm(a,Z,p),o.memoizedState=V0,Gc(a.child,x)):(Qr(o),p=a.child,a=p.sibling,p=sa(p,{mode:"visible",children:x.children}),p.return=o,p.sibling=null,a!==null&&(Z=o.deletions,Z===null?(o.deletions=[a],o.flags|=16):Z.push(a)),o.child=p,o.memoizedState=null,p)}function Bd(a,o){return o=nm({mode:"visible",children:o},a.mode),o.return=a,a.child=o}function nm(a,o){return a=br(22,a,null,o),a.lanes=0,a}function H0(a,o,p){return pr(o,a.child,null,p),a=Bd(o,o.pendingProps.children),a.flags|=2,o.memoizedState=null,a}function J1(a,o,p){a.lanes|=o;var x=a.alternate;x!==null&&(x.lanes|=o),vu(a.return,o,p)}function eh(a,o,p,x,C,P){var Z=a.memoizedState;Z===null?a.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:x,tail:p,tailMode:C,treeForkCount:P}:(Z.isBackwards=o,Z.rendering=null,Z.renderingStartTime=0,Z.last=x,Z.tail=p,Z.tailMode=C,Z.treeForkCount=P)}function To(a,o,p){var x=o.pendingProps,C=x.revealOrder,P=x.tail;x=x.children;var Z=ei.current,ye=(Z&2)!==0;if(ye?(Z=Z&1|2,o.flags|=128):Z&=1,$(ei,Z),Sa(a,o,x,p),x=Fi?rf:0,!ye&&a!==null&&(a.flags&128)!==0)e:for(a=o.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&J1(a,p,o);else if(a.tag===19)J1(a,p,o);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break e;for(;a.sibling===null;){if(a.return===null||a.return===o)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(C){case"forwards":for(p=o.child,C=null;p!==null;)a=p.alternate,a!==null&&Nr(a)===null&&(C=p),p=p.sibling;p=C,p===null?(C=o.child,o.child=null):(C=p.sibling,p.sibling=null),eh(o,!1,C,p,P,x);break;case"backwards":case"unstable_legacy-backwards":for(p=null,C=o.child,o.child=null;C!==null;){if(a=C.alternate,a!==null&&Nr(a)===null){o.child=C;break}a=C.sibling,C.sibling=p,p=C,C=a}eh(o,!0,p,null,P,x);break;case"together":eh(o,!1,null,null,void 0,x);break;default:o.memoizedState=null}return o.child}function ks(a,o,p){if(a!==null&&(o.dependencies=a.dependencies),$c|=o.lanes,(p&o.childLanes)===0)if(a!==null){if(wo(a,o,p,!1),(p&o.childLanes)===0)return null}else return null;if(a!==null&&o.child!==a.child)throw Error(n(153));if(o.child!==null){for(a=o.child,p=sa(a,a.pendingProps),o.child=p,p.return=o;a.sibling!==null;)a=a.sibling,p=p.sibling=sa(a,a.pendingProps),p.return=o;p.sibling=null}return o.child}function im(a,o){return(a.lanes&o)!==0?!0:(a=a.dependencies,!!(a!==null&&Wf(a)))}function wb(a,o,p){switch(o.tag){case 3:ke(o,o.stateNode.containerInfo),fc(o,os,a.memoizedState.cache),Uc();break;case 27:case 5:We(o);break;case 4:ke(o,o.stateNode.containerInfo);break;case 10:fc(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,lr(o),null;break;case 13:var x=o.memoizedState;if(x!==null)return x.dehydrated!==null?(Qr(o),o.flags|=128,null):(p&o.child.childLanes)!==0?$1(a,o,p):(Qr(o),a=ks(a,o,p),a!==null?a.sibling:null);Qr(o);break;case 19:var C=(a.flags&128)!==0;if(x=(p&o.childLanes)!==0,x||(wo(a,o,p,!1),x=(p&o.childLanes)!==0),C){if(x)return To(a,o,p);o.flags|=128}if(C=o.memoizedState,C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),$(ei,ei.current),x)break;return null;case 22:return o.lanes=0,Kf(a,o,p,o.pendingProps);case 24:fc(o,os,a.memoizedState.cache)}return ks(a,o,p)}function rm(a,o,p){if(a!==null)if(a.memoizedProps!==o.pendingProps)qs=!0;else{if(!im(a,p)&&(o.flags&128)===0)return qs=!1,wb(a,o,p);qs=(a.flags&131072)!==0}else qs=!1,Fi&&(o.flags&1048576)!==0&&zp(o,rf,o.index);switch(o.lanes=0,o.tag){case 16:e:{var x=o.pendingProps;if(a=pt(o.elementType),o.type=a,typeof a=="function")Gf(a)?(x=hf(a,x),o.tag=1,o=em(null,o,a,x,p)):(o.tag=0,o=kh(null,o,a,x,p));else{if(a!=null){var C=a.$$typeof;if(C===I){o.tag=11,o=j0(null,o,a,x,p);break e}else if(C===X){o.tag=14,o=Jf(null,o,a,x,p);break e}}throw o=J(a)||a,Error(n(306,o,""))}}return o;case 0:return kh(a,o,o.type,o.pendingProps,p);case 1:return x=o.type,C=hf(x,o.pendingProps),em(a,o,x,C,p);case 3:e:{if(ke(o,o.stateNode.containerInfo),a===null)throw Error(n(387));x=o.pendingProps;var P=o.memoizedState;C=P.element,Gr(a,o),ls(o,x,null,p);var Z=o.memoizedState;if(x=Z.cache,fc(o,os,x),x!==P.cache&&Fc(o,[os],p,!0),Sr(),x=Z.element,P.isDehydrated)if(P={element:x,isDehydrated:!1,cache:Z.cache},o.updateQueue.baseState=P,o.memoizedState=P,o.flags&256){o=Z1(a,o,x,p);break e}else if(x!==C){C=ao(Error(n(424)),o),Jo(C),o=Z1(a,o,x,p);break e}else for(a=o.stateNode.containerInfo,a.nodeType===9?a=a.body:a=a.nodeName==="HTML"?a.ownerDocument.body:a,_r=Qc(a.firstChild),Kr=o,Fi=!0,_a=null,Hr=!0,p=li(o,null,x,p),o.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(Uc(),x===C){o=ks(a,o,p);break e}Sa(a,o,x,p)}o=o.child}return o;case 26:return Qf(a,o),a===null?(p=F2(o.type,null,o.pendingProps,null))?o.memoizedState=p:Fi||(p=o.type,a=o.pendingProps,x=tv(ie.current).createElement(p),x[Mi]=o,x[te]=a,mo(x,p,a),fe(x),o.stateNode=x):o.memoizedState=F2(o.type,a.memoizedProps,o.pendingProps,a.memoizedState),null;case 27:return We(o),a===null&&Fi&&(x=o.stateNode=O2(o.type,o.pendingProps,ie.current),Kr=o,Hr=!0,C=_r,qh(o.type)?(Bb=C,_r=Qc(x.firstChild)):_r=C),Sa(a,o,o.pendingProps.children,p),Qf(a,o),a===null&&(o.flags|=4194304),o.child;case 5:return a===null&&Fi&&((C=x=_r)&&(x=wC(x,o.type,o.pendingProps,Hr),x!==null?(o.stateNode=x,Kr=o,_r=Qc(x.firstChild),Hr=!1,C=!0):C=!1),C||Ll(o)),We(o),C=o.type,P=o.pendingProps,Z=a!==null?a.memoizedProps:null,x=P.children,Pb(C,P)?x=null:Z!==null&&Pb(C,Z)&&(o.flags|=32),o.memoizedState!==null&&(C=Th(a,o,yu,null,null,p),eg._currentValue=C),Qf(a,o),Sa(a,o,x,p),o.child;case 6:return a===null&&Fi&&((a=p=_r)&&(p=MC(p,o.pendingProps,Hr),p!==null?(o.stateNode=p,Kr=o,_r=null,a=!0):a=!1),a||Ll(o)),null;case 13:return $1(a,o,p);case 4:return ke(o,o.stateNode.containerInfo),x=o.pendingProps,a===null?o.child=pr(o,null,x,p):Sa(a,o,x,p),o.child;case 11:return j0(a,o,o.type,o.pendingProps,p);case 7:return Sa(a,o,o.pendingProps,p),o.child;case 8:return Sa(a,o,o.pendingProps.children,p),o.child;case 12:return Sa(a,o,o.pendingProps.children,p),o.child;case 10:return x=o.pendingProps,fc(o,o.type,x.value),Sa(a,o,x.children,p),o.child;case 9:return C=o.type._context,x=o.pendingProps.children,hc(o),C=Qn(C),x=x(C),o.flags|=1,Sa(a,o,x,p),o.child;case 14:return Jf(a,o,o.type,o.pendingProps,p);case 15:return Jp(a,o,o.type,o.pendingProps,p);case 19:return To(a,o,p);case 31:return Qp(a,o,p);case 22:return Kf(a,o,p,o.pendingProps);case 24:return hc(o),x=Qn(os),a===null?(C=Se(),C===null&&(C=ci,P=af(),C.pooledCache=P,P.refCount++,P!==null&&(C.pooledCacheLanes|=p),C=P),o.memoizedState={parent:x,cache:C},yn(o),fc(o,os,C)):((a.lanes&p)!==0&&(Gr(a,o),ls(o,null,null,p),Sr()),C=a.memoizedState,P=o.memoizedState,C.parent!==x?(C={parent:x,cache:x},o.memoizedState=C,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=C),fc(o,os,x)):(x=P.cache,fc(o,os,x),x!==C.cache&&Fc(o,[os],p,!0))),Sa(a,o,o.pendingProps.children,p),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function qc(a){a.flags|=4}function Ud(a,o,p,x,C){if((o=(a.mode&32)!==0)&&(o=!1),o){if(a.flags|=16777216,(C&335544128)===C)if(a.stateNode.complete)a.flags|=8192;else if(hs())a.flags|=8192;else throw Bt=it,mt}else a.flags&=-16777217}function G0(a,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!G2(o))if(hs())a.flags|=8192;else throw Bt=it,mt}function Su(a,o){o!==null&&(a.flags|=4),a.flags&16384&&(o=a.tag!==22?bn():536870912,a.lanes|=o,Wr|=o)}function Wc(a,o){if(!Fi)switch(a.tailMode){case"hidden":o=a.tail;for(var p=null;o!==null;)o.alternate!==null&&(p=o),o=o.sibling;p===null?a.tail=null:p.sibling=null;break;case"collapsed":p=a.tail;for(var x=null;p!==null;)p.alternate!==null&&(x=p),p=p.sibling;x===null?o||a.tail===null?a.tail=null:a.tail.sibling=null:x.sibling=null}}function Mr(a){var o=a.alternate!==null&&a.alternate.child===a.child,p=0,x=0;if(o)for(var C=a.child;C!==null;)p|=C.lanes|C.childLanes,x|=C.subtreeFlags&65011712,x|=C.flags&65011712,C.return=a,C=C.sibling;else for(C=a.child;C!==null;)p|=C.lanes|C.childLanes,x|=C.subtreeFlags,x|=C.flags,C.return=a,C=C.sibling;return a.subtreeFlags|=x,a.childLanes=p,o}function Fd(a,o,p){var x=o.pendingProps;switch(qf(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mr(o),null;case 1:return Mr(o),null;case 3:return p=o.stateNode,x=null,a!==null&&(x=a.memoizedState.cache),o.memoizedState.cache!==x&&(o.flags|=2048),lo(os),Fe(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(a===null||a.child===null)&&(aa(o)?qc(o):a===null||a.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Ah())),Mr(o),null;case 26:var C=o.type,P=o.memoizedState;return a===null?(qc(o),P!==null?(Mr(o),G0(o,P)):(Mr(o),Ud(o,C,null,x,p))):P?P!==a.memoizedState?(qc(o),Mr(o),G0(o,P)):(Mr(o),o.flags&=-16777217):(a=a.memoizedProps,a!==x&&qc(o),Mr(o),Ud(o,C,a,x,p)),null;case 27:if(nt(o),p=ie.current,C=o.type,a!==null&&o.stateNode!=null)a.memoizedProps!==x&&qc(o);else{if(!x){if(o.stateNode===null)throw Error(n(166));return Mr(o),null}a=re.current,aa(o)?Ad(o):(a=O2(C,x,p),o.stateNode=a,qc(o))}return Mr(o),null;case 5:if(nt(o),C=o.type,a!==null&&o.stateNode!=null)a.memoizedProps!==x&&qc(o);else{if(!x){if(o.stateNode===null)throw Error(n(166));return Mr(o),null}if(P=re.current,aa(o))Ad(o);else{var Z=tv(ie.current);switch(P){case 1:P=Z.createElementNS("http://www.w3.org/2000/svg",C);break;case 2:P=Z.createElementNS("http://www.w3.org/1998/Math/MathML",C);break;default:switch(C){case"svg":P=Z.createElementNS("http://www.w3.org/2000/svg",C);break;case"math":P=Z.createElementNS("http://www.w3.org/1998/Math/MathML",C);break;case"script":P=Z.createElement("div"),P.innerHTML="<script><\/script>",P=P.removeChild(P.firstChild);break;case"select":P=typeof x.is=="string"?Z.createElement("select",{is:x.is}):Z.createElement("select"),x.multiple?P.multiple=!0:x.size&&(P.size=x.size);break;default:P=typeof x.is=="string"?Z.createElement(C,{is:x.is}):Z.createElement(C)}}P[Mi]=o,P[te]=x;e:for(Z=o.child;Z!==null;){if(Z.tag===5||Z.tag===6)P.appendChild(Z.stateNode);else if(Z.tag!==4&&Z.tag!==27&&Z.child!==null){Z.child.return=Z,Z=Z.child;continue}if(Z===o)break e;for(;Z.sibling===null;){if(Z.return===null||Z.return===o)break e;Z=Z.return}Z.sibling.return=Z.return,Z=Z.sibling}o.stateNode=P;e:switch(mo(P,C,x),C){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}x&&qc(o)}}return Mr(o),Ud(o,o.type,a===null?null:a.memoizedProps,o.pendingProps,p),null;case 6:if(a&&o.stateNode!=null)a.memoizedProps!==x&&qc(o);else{if(typeof x!="string"&&o.stateNode===null)throw Error(n(166));if(a=ie.current,aa(o)){if(a=o.stateNode,p=o.memoizedProps,x=null,C=Kr,C!==null)switch(C.tag){case 27:case 5:x=C.memoizedProps}a[Mi]=o,a=!!(a.nodeValue===p||x!==null&&x.suppressHydrationWarning===!0||A2(a.nodeValue,p)),a||Ll(o,!0)}else a=tv(a).createTextNode(x),a[Mi]=o,o.stateNode=a}return Mr(o),null;case 31:if(p=o.memoizedState,a===null||a.memoizedState!==null){if(x=aa(o),p!==null){if(a===null){if(!x)throw Error(n(318));if(a=o.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(557));a[Mi]=o}else Uc(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Mr(o),a=!1}else p=Ah(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=p),a=!0;if(!a)return o.flags&256?(Gi(o),o):(Gi(o),null);if((o.flags&128)!==0)throw Error(n(558))}return Mr(o),null;case 13:if(x=o.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(C=aa(o),x!==null&&x.dehydrated!==null){if(a===null){if(!C)throw Error(n(318));if(C=o.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(n(317));C[Mi]=o}else Uc(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Mr(o),C=!1}else C=Ah(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=C),C=!0;if(!C)return o.flags&256?(Gi(o),o):(Gi(o),null)}return Gi(o),(o.flags&128)!==0?(o.lanes=p,o):(p=x!==null,a=a!==null&&a.memoizedState!==null,p&&(x=o.child,C=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(C=x.alternate.memoizedState.cachePool.pool),P=null,x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(P=x.memoizedState.cachePool.pool),P!==C&&(x.flags|=2048)),p!==a&&p&&(o.child.flags|=8192),Su(o,o.updateQueue),Mr(o),null);case 4:return Fe(),a===null&&Eb(o.stateNode.containerInfo),Mr(o),null;case 10:return lo(o.type),Mr(o),null;case 19:if(F(ei),x=o.memoizedState,x===null)return Mr(o),null;if(C=(o.flags&128)!==0,P=x.rendering,P===null)if(C)Wc(x,!1);else{if(us!==0||a!==null&&(a.flags&128)!==0)for(a=o.child;a!==null;){if(P=Nr(a),P!==null){for(o.flags|=128,Wc(x,!1),a=P.updateQueue,o.updateQueue=a,Su(o,a),o.subtreeFlags=0,a=p,p=o.child;p!==null;)sc(p,a),p=p.sibling;return $(ei,ei.current&1|2),Fi&&ja(o,x.treeForkCount),o.child}a=a.sibling}x.tail!==null&&Q()>Os&&(o.flags|=128,C=!0,Wc(x,!1),o.lanes=4194304)}else{if(!C)if(a=Nr(P),a!==null){if(o.flags|=128,C=!0,a=a.updateQueue,o.updateQueue=a,Su(o,a),Wc(x,!0),x.tail===null&&x.tailMode==="hidden"&&!P.alternate&&!Fi)return Mr(o),null}else 2*Q()-x.renderingStartTime>Os&&p!==536870912&&(o.flags|=128,C=!0,Wc(x,!1),o.lanes=4194304);x.isBackwards?(P.sibling=o.child,o.child=P):(a=x.last,a!==null?a.sibling=P:o.child=P,x.last=P)}return x.tail!==null?(a=x.tail,x.rendering=a,x.tail=a.sibling,x.renderingStartTime=Q(),a.sibling=null,p=ei.current,$(ei,C?p&1|2:p&1),Fi&&ja(o,x.treeForkCount),a):(Mr(o),null);case 22:case 23:return Gi(o),cs(),x=o.memoizedState!==null,a!==null?a.memoizedState!==null!==x&&(o.flags|=8192):x&&(o.flags|=8192),x?(p&536870912)!==0&&(o.flags&128)===0&&(Mr(o),o.subtreeFlags&6&&(o.flags|=8192)):Mr(o),p=o.updateQueue,p!==null&&Su(o,p.retryQueue),p=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(p=a.memoizedState.cachePool.pool),x=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(x=o.memoizedState.cachePool.pool),x!==p&&(o.flags|=2048),a!==null&&F(me),null;case 24:return p=null,a!==null&&(p=a.memoizedState.cache),o.memoizedState.cache!==p&&(o.flags|=2048),lo(os),Mr(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function Ol(a,o){switch(qf(o),o.tag){case 1:return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 3:return lo(os),Fe(),a=o.flags,(a&65536)!==0&&(a&128)===0?(o.flags=a&-65537|128,o):null;case 26:case 27:case 5:return nt(o),null;case 31:if(o.memoizedState!==null){if(Gi(o),o.alternate===null)throw Error(n(340));Uc()}return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 13:if(Gi(o),a=o.memoizedState,a!==null&&a.dehydrated!==null){if(o.alternate===null)throw Error(n(340));Uc()}return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 19:return F(ei),null;case 4:return Fe(),null;case 10:return lo(o.type),null;case 22:case 23:return Gi(o),cs(),a!==null&&F(me),a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 24:return lo(os),null;case 25:return null;default:return null}}function el(a,o){switch(qf(o),o.tag){case 3:lo(os),Fe();break;case 26:case 27:case 5:nt(o);break;case 4:Fe();break;case 31:o.memoizedState!==null&&Gi(o);break;case 13:Gi(o);break;case 19:F(ei);break;case 10:lo(o.type);break;case 22:case 23:Gi(o),cs(),a!==null&&F(me);break;case 24:lo(os)}}function Bl(a,o){try{var p=o.updateQueue,x=p!==null?p.lastEffect:null;if(x!==null){var C=x.next;p=C;do{if((p.tag&a)===a){x=void 0;var P=p.create,Z=p.inst;x=P(),Z.destroy=x}p=p.next}while(p!==C)}}catch(ye){sr(o,o.return,ye)}}function Ra(a,o,p){try{var x=o.updateQueue,C=x!==null?x.lastEffect:null;if(C!==null){var P=C.next;x=P;do{if((x.tag&a)===a){var Z=x.inst,ye=Z.destroy;if(ye!==void 0){Z.destroy=void 0,C=o;var He=p,_t=ye;try{_t()}catch(Ht){sr(C,He,Ht)}}}x=x.next}while(x!==P)}}catch(Ht){sr(o,o.return,Ht)}}function gc(a){var o=a.updateQueue;if(o!==null){var p=a.stateNode;try{ys(o,p)}catch(x){sr(a,a.return,x)}}}function wa(a,o,p){p.props=hf(a.type,a.memoizedProps),p.state=a.memoizedState;try{p.componentWillUnmount()}catch(x){sr(a,o,x)}}function wu(a,o){try{var p=a.ref;if(p!==null){switch(a.tag){case 26:case 27:case 5:var x=a.stateNode;break;case 30:x=a.stateNode;break;default:x=a.stateNode}typeof p=="function"?a.refCleanup=p(x):p.current=x}}catch(C){sr(a,o,C)}}function La(a,o){var p=a.ref,x=a.refCleanup;if(p!==null)if(typeof x=="function")try{x()}catch(C){sr(a,o,C)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(C){sr(a,o,C)}else p.current=null}function zd(a){var o=a.type,p=a.memoizedProps,x=a.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":p.autoFocus&&x.focus();break e;case"img":p.src?x.src=p.src:p.srcSet&&(x.srcset=p.srcSet)}}catch(C){sr(a,a.return,C)}}function ca(a,o,p){try{var x=a.stateNode;vC(x,a.type,p,o),x[te]=o}catch(C){sr(a,a.return,C)}}function is(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&qh(a.type)||a.tag===4}function qi(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||is(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&qh(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Xc(a,o,p){var x=a.tag;if(x===5||x===6)a=a.stateNode,o?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(a,o):(o=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,o.appendChild(a),p=p._reactRootContainer,p!=null||o.onclick!==null||(o.onclick=jo));else if(x!==4&&(x===27&&qh(a.type)&&(p=a.stateNode,o=null),a=a.child,a!==null))for(Xc(a,o,p),a=a.sibling;a!==null;)Xc(a,o,p),a=a.sibling}function uo(a,o,p){var x=a.tag;if(x===5||x===6)a=a.stateNode,o?p.insertBefore(a,o):p.appendChild(a);else if(x!==4&&(x===27&&qh(a.type)&&(p=a.stateNode),a=a.child,a!==null))for(uo(a,o,p),a=a.sibling;a!==null;)uo(a,o,p),a=a.sibling}function sm(a){var o=a.stateNode,p=a.memoizedProps;try{for(var x=a.type,C=o.attributes;C.length;)o.removeAttributeNode(C[0]);mo(o,x,p),o[Mi]=a,o[te]=p}catch(P){sr(a,a.return,P)}}var Ul=!1,Or=!1,vc=!1,K1=typeof WeakSet=="function"?WeakSet:Set,Ma=null;function Mb(a,o){if(a=a.containerInfo,Rb=lv,a=nc(a),Cl(a)){if("selectionStart"in a)var p={start:a.selectionStart,end:a.selectionEnd};else e:{p=(p=a.ownerDocument)&&p.defaultView||window;var x=p.getSelection&&p.getSelection();if(x&&x.rangeCount!==0){p=x.anchorNode;var C=x.anchorOffset,P=x.focusNode;x=x.focusOffset;try{p.nodeType,P.nodeType}catch{p=null;break e}var Z=0,ye=-1,He=-1,_t=0,Ht=0,Zt=a,Nt=null;t:for(;;){for(var Ot;Zt!==p||C!==0&&Zt.nodeType!==3||(ye=Z+C),Zt!==P||x!==0&&Zt.nodeType!==3||(He=Z+x),Zt.nodeType===3&&(Z+=Zt.nodeValue.length),(Ot=Zt.firstChild)!==null;)Nt=Zt,Zt=Ot;for(;;){if(Zt===a)break t;if(Nt===p&&++_t===C&&(ye=Z),Nt===P&&++Ht===x&&(He=Z),(Ot=Zt.nextSibling)!==null)break;Zt=Nt,Nt=Zt.parentNode}Zt=Ot}p=ye===-1||He===-1?null:{start:ye,end:He}}else p=null}p=p||{start:0,end:0}}else p=null;for(Lb={focusedElem:a,selectionRange:p},lv=!1,Ma=o;Ma!==null;)if(o=Ma,a=o.child,(o.subtreeFlags&1028)!==0&&a!==null)a.return=o,Ma=a;else for(;Ma!==null;){switch(o=Ma,P=o.alternate,a=o.flags,o.tag){case 0:if((a&4)!==0&&(a=o.updateQueue,a=a!==null?a.events:null,a!==null))for(p=0;p<a.length;p++)C=a[p],C.ref.impl=C.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&P!==null){a=void 0,p=o,C=P.memoizedProps,P=P.memoizedState,x=p.stateNode;try{var Bn=hf(p.type,C);a=x.getSnapshotBeforeUpdate(Bn,P),x.__reactInternalSnapshotBeforeUpdate=a}catch(ri){sr(p,p.return,ri)}}break;case 3:if((a&1024)!==0){if(a=o.stateNode.containerInfo,p=a.nodeType,p===9)Db(a);else if(p===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":Db(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=o.sibling,a!==null){a.return=o.return,Ma=a;break}Ma=o.return}}function rs(a,o,p){var x=p.flags;switch(p.tag){case 0:case 11:case 15:jl(a,p),x&4&&Bl(5,p);break;case 1:if(jl(a,p),x&4)if(a=p.stateNode,o===null)try{a.componentDidMount()}catch(Z){sr(p,p.return,Z)}else{var C=hf(p.type,o.memoizedProps);o=o.memoizedState;try{a.componentDidUpdate(C,o,a.__reactInternalSnapshotBeforeUpdate)}catch(Z){sr(p,p.return,Z)}}x&64&&gc(p),x&512&&wu(p,p.return);break;case 3:if(jl(a,p),x&64&&(a=p.updateQueue,a!==null)){if(o=null,p.child!==null)switch(p.child.tag){case 27:case 5:o=p.child.stateNode;break;case 1:o=p.child.stateNode}try{ys(a,o)}catch(Z){sr(p,p.return,Z)}}break;case 27:o===null&&x&4&&sm(p);case 26:case 5:jl(a,p),o===null&&x&4&&zd(p),x&512&&wu(p,p.return);break;case 12:jl(a,p);break;case 31:jl(a,p),x&4&&df(a,p);break;case 13:jl(a,p),x&4&&Oh(a,p),x&64&&(a=p.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(p=b.bind(null,p),AC(a,p))));break;case 22:if(x=p.memoizedState!==null||Ul,!x){o=o!==null&&o.memoizedState!==null||Or,C=Ul;var P=Or;Ul=x,(Or=o)&&!P?fo(a,p,(p.subtreeFlags&8772)!==0):jl(a,p),Ul=C,Or=P}break;case 30:break;default:jl(a,p)}}function jd(a){var o=a.alternate;o!==null&&(a.alternate=null,jd(o)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(o=a.stateNode,o!==null&&qt(o)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var gr=null,qa=!1;function Fl(a,o,p){for(p=p.child;p!==null;)am(a,o,p),p=p.sibling}function am(a,o,p){if(dt&&typeof dt.onCommitFiberUnmount=="function")try{dt.onCommitFiberUnmount(bt,p)}catch{}switch(p.tag){case 26:Or||La(p,o),Fl(a,o,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:Or||La(p,o);var x=gr,C=qa;qh(p.type)&&(gr=p.stateNode,qa=!1),Fl(a,o,p),J0(p.stateNode),gr=x,qa=C;break;case 5:Or||La(p,o);case 6:if(x=gr,C=qa,gr=null,Fl(a,o,p),gr=x,qa=C,gr!==null)if(qa)try{(gr.nodeType===9?gr.body:gr.nodeName==="HTML"?gr.ownerDocument.body:gr).removeChild(p.stateNode)}catch(P){sr(p,o,P)}else try{gr.removeChild(p.stateNode)}catch(P){sr(p,o,P)}break;case 18:gr!==null&&(qa?(a=gr,L2(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,p.stateNode),pm(a)):L2(gr,p.stateNode));break;case 4:x=gr,C=qa,gr=p.stateNode.containerInfo,qa=!0,Fl(a,o,p),gr=x,qa=C;break;case 0:case 11:case 14:case 15:Ra(2,p,o),Or||Ra(4,p,o),Fl(a,o,p);break;case 1:Or||(La(p,o),x=p.stateNode,typeof x.componentWillUnmount=="function"&&wa(p,o,x)),Fl(a,o,p);break;case 21:Fl(a,o,p);break;case 22:Or=(x=Or)||p.memoizedState!==null,Fl(a,o,p),Or=x;break;default:Fl(a,o,p)}}function df(a,o){if(o.memoizedState===null&&(a=o.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{pm(a)}catch(p){sr(o,o.return,p)}}}function Oh(a,o){if(o.memoizedState===null&&(a=o.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{pm(a)}catch(p){sr(o,o.return,p)}}function q0(a){switch(a.tag){case 31:case 13:case 19:var o=a.stateNode;return o===null&&(o=a.stateNode=new K1),o;case 22:return a=a.stateNode,o=a._retryCache,o===null&&(o=a._retryCache=new K1),o;default:throw Error(n(435,a.tag))}}function Mu(a,o){var p=q0(a);o.forEach(function(x){if(!p.has(x)){p.add(x);var C=E.bind(null,a,x);x.then(C,C)}})}function ua(a,o){var p=o.deletions;if(p!==null)for(var x=0;x<p.length;x++){var C=p[x],P=a,Z=o,ye=Z;e:for(;ye!==null;){switch(ye.tag){case 27:if(qh(ye.type)){gr=ye.stateNode,qa=!1;break e}break;case 5:gr=ye.stateNode,qa=!1;break e;case 3:case 4:gr=ye.stateNode.containerInfo,qa=!0;break e}ye=ye.return}if(gr===null)throw Error(n(160));am(P,Z,C),gr=null,qa=!1,P=C.alternate,P!==null&&(P.return=null),C.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)pf(o,a),o=o.sibling}var zl=null;function pf(a,o){var p=a.alternate,x=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:ua(o,a),fa(a),x&4&&(Ra(3,a,a.return),Bl(3,a),Ra(5,a,a.return));break;case 1:ua(o,a),fa(a),x&512&&(Or||p===null||La(p,p.return)),x&64&&Ul&&(a=a.updateQueue,a!==null&&(x=a.callbacks,x!==null&&(p=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=p===null?x:p.concat(x))));break;case 26:var C=zl;if(ua(o,a),fa(a),x&512&&(Or||p===null||La(p,p.return)),x&4){var P=p!==null?p.memoizedState:null;if(x=a.memoizedState,p===null)if(x===null)if(a.stateNode===null){e:{x=a.type,p=a.memoizedProps,C=C.ownerDocument||C;t:switch(x){case"title":P=C.getElementsByTagName("title")[0],(!P||P[Xt]||P[Mi]||P.namespaceURI==="http://www.w3.org/2000/svg"||P.hasAttribute("itemprop"))&&(P=C.createElement(x),C.head.insertBefore(P,C.querySelector("head > title"))),mo(P,x,p),P[Mi]=a,fe(P),x=P;break e;case"link":var Z=V2("link","href",C).get(x+(p.href||""));if(Z){for(var ye=0;ye<Z.length;ye++)if(P=Z[ye],P.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&P.getAttribute("rel")===(p.rel==null?null:p.rel)&&P.getAttribute("title")===(p.title==null?null:p.title)&&P.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){Z.splice(ye,1);break t}}P=C.createElement(x),mo(P,x,p),C.head.appendChild(P);break;case"meta":if(Z=V2("meta","content",C).get(x+(p.content||""))){for(ye=0;ye<Z.length;ye++)if(P=Z[ye],P.getAttribute("content")===(p.content==null?null:""+p.content)&&P.getAttribute("name")===(p.name==null?null:p.name)&&P.getAttribute("property")===(p.property==null?null:p.property)&&P.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&P.getAttribute("charset")===(p.charSet==null?null:p.charSet)){Z.splice(ye,1);break t}}P=C.createElement(x),mo(P,x,p),C.head.appendChild(P);break;default:throw Error(n(468,x))}P[Mi]=a,fe(P),x=P}a.stateNode=x}else H2(C,a.type,a.stateNode);else a.stateNode=j2(C,x,a.memoizedProps);else P!==x?(P===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):P.count--,x===null?H2(C,a.type,a.stateNode):j2(C,x,a.memoizedProps)):x===null&&a.stateNode!==null&&ca(a,a.memoizedProps,p.memoizedProps)}break;case 27:ua(o,a),fa(a),x&512&&(Or||p===null||La(p,p.return)),p!==null&&x&4&&ca(a,a.memoizedProps,p.memoizedProps);break;case 5:if(ua(o,a),fa(a),x&512&&(Or||p===null||La(p,p.return)),a.flags&32){C=a.stateNode;try{Tr(C,"")}catch(Bn){sr(a,a.return,Bn)}}x&4&&a.stateNode!=null&&(C=a.memoizedProps,ca(a,C,p!==null?p.memoizedProps:C)),x&1024&&(vc=!0);break;case 6:if(ua(o,a),fa(a),x&4){if(a.stateNode===null)throw Error(n(162));x=a.memoizedProps,p=a.stateNode;try{p.nodeValue=x}catch(Bn){sr(a,a.return,Bn)}}break;case 3:if(rv=null,C=zl,zl=nv(o.containerInfo),ua(o,a),zl=C,fa(a),x&4&&p!==null&&p.memoizedState.isDehydrated)try{pm(o.containerInfo)}catch(Bn){sr(a,a.return,Bn)}vc&&(vc=!1,om(a));break;case 4:x=zl,zl=nv(a.stateNode.containerInfo),ua(o,a),fa(a),zl=x;break;case 12:ua(o,a),fa(a);break;case 31:ua(o,a),fa(a),x&4&&(x=a.updateQueue,x!==null&&(a.updateQueue=null,Mu(a,x)));break;case 13:ua(o,a),fa(a),a.child.flags&8192&&a.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(Bh=Q()),x&4&&(x=a.updateQueue,x!==null&&(a.updateQueue=null,Mu(a,x)));break;case 22:C=a.memoizedState!==null;var He=p!==null&&p.memoizedState!==null,_t=Ul,Ht=Or;if(Ul=_t||C,Or=Ht||He,ua(o,a),Or=Ht,Ul=_t,fa(a),x&8192)e:for(o=a.stateNode,o._visibility=C?o._visibility&-2:o._visibility|1,C&&(p===null||He||Ul||Or||Yc(a)),p=null,o=a;;){if(o.tag===5||o.tag===26){if(p===null){He=p=o;try{if(P=He.stateNode,C)Z=P.style,typeof Z.setProperty=="function"?Z.setProperty("display","none","important"):Z.display="none";else{ye=He.stateNode;var Zt=He.memoizedProps.style,Nt=Zt!=null&&Zt.hasOwnProperty("display")?Zt.display:null;ye.style.display=Nt==null||typeof Nt=="boolean"?"":(""+Nt).trim()}}catch(Bn){sr(He,He.return,Bn)}}}else if(o.tag===6){if(p===null){He=o;try{He.stateNode.nodeValue=C?"":He.memoizedProps}catch(Bn){sr(He,He.return,Bn)}}}else if(o.tag===18){if(p===null){He=o;try{var Ot=He.stateNode;C?P2(Ot,!0):P2(He.stateNode,!1)}catch(Bn){sr(He,He.return,Bn)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===a)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break e;for(;o.sibling===null;){if(o.return===null||o.return===a)break e;p===o&&(p=null),o=o.return}p===o&&(p=null),o.sibling.return=o.return,o=o.sibling}x&4&&(x=a.updateQueue,x!==null&&(p=x.retryQueue,p!==null&&(x.retryQueue=null,Mu(a,p))));break;case 19:ua(o,a),fa(a),x&4&&(x=a.updateQueue,x!==null&&(a.updateQueue=null,Mu(a,x)));break;case 30:break;case 21:break;default:ua(o,a),fa(a)}}function fa(a){var o=a.flags;if(o&2){try{for(var p,x=a.return;x!==null;){if(is(x)){p=x;break}x=x.return}if(p==null)throw Error(n(160));switch(p.tag){case 27:var C=p.stateNode,P=qi(a);uo(a,P,C);break;case 5:var Z=p.stateNode;p.flags&32&&(Tr(Z,""),p.flags&=-33);var ye=qi(a);uo(a,ye,Z);break;case 3:case 4:var He=p.stateNode.containerInfo,_t=qi(a);Xc(a,_t,He);break;default:throw Error(n(161))}}catch(Ht){sr(a,a.return,Ht)}a.flags&=-3}o&4096&&(a.flags&=-4097)}function om(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var o=a;om(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),a=a.sibling}}function jl(a,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)rs(a,o.alternate,o),o=o.sibling}function Yc(a){for(a=a.child;a!==null;){var o=a;switch(o.tag){case 0:case 11:case 14:case 15:Ra(4,o,o.return),Yc(o);break;case 1:La(o,o.return);var p=o.stateNode;typeof p.componentWillUnmount=="function"&&wa(o,o.return,p),Yc(o);break;case 27:J0(o.stateNode);case 26:case 5:La(o,o.return),Yc(o);break;case 22:o.memoizedState===null&&Yc(o);break;case 30:Yc(o);break;default:Yc(o)}a=a.sibling}}function fo(a,o,p){for(p=p&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var x=o.alternate,C=a,P=o,Z=P.flags;switch(P.tag){case 0:case 11:case 15:fo(C,P,p),Bl(4,P);break;case 1:if(fo(C,P,p),x=P,C=x.stateNode,typeof C.componentDidMount=="function")try{C.componentDidMount()}catch(_t){sr(x,x.return,_t)}if(x=P,C=x.updateQueue,C!==null){var ye=x.stateNode;try{var He=C.shared.hiddenCallbacks;if(He!==null)for(C.shared.hiddenCallbacks=null,C=0;C<He.length;C++)xs(He[C],ye)}catch(_t){sr(x,x.return,_t)}}p&&Z&64&&gc(P),wu(P,P.return);break;case 27:sm(P);case 26:case 5:fo(C,P,p),p&&x===null&&Z&4&&zd(P),wu(P,P.return);break;case 12:fo(C,P,p);break;case 31:fo(C,P,p),p&&Z&4&&df(C,P);break;case 13:fo(C,P,p),p&&Z&4&&Oh(C,P);break;case 22:P.memoizedState===null&&fo(C,P,p),wu(P,P.return);break;case 30:break;default:fo(C,P,p)}o=o.sibling}}function mf(a,o){var p=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(p=a.memoizedState.cachePool.pool),a=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(a=o.memoizedState.cachePool.pool),a!==p&&(a!=null&&a.refCount++,p!=null&&xu(p))}function th(a,o){a=null,o.alternate!==null&&(a=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==a&&(o.refCount++,a!=null&&xu(a))}function Pa(a,o,p,x){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)W0(a,o,p,x),o=o.sibling}function W0(a,o,p,x){var C=o.flags;switch(o.tag){case 0:case 11:case 15:Pa(a,o,p,x),C&2048&&Bl(9,o);break;case 1:Pa(a,o,p,x);break;case 3:Pa(a,o,p,x),C&2048&&(a=null,o.alternate!==null&&(a=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==a&&(o.refCount++,a!=null&&xu(a)));break;case 12:if(C&2048){Pa(a,o,p,x),a=o.stateNode;try{var P=o.memoizedProps,Z=P.id,ye=P.onPostCommit;typeof ye=="function"&&ye(Z,o.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(He){sr(o,o.return,He)}}else Pa(a,o,p,x);break;case 31:Pa(a,o,p,x);break;case 13:Pa(a,o,p,x);break;case 23:break;case 22:P=o.stateNode,Z=o.alternate,o.memoizedState!==null?P._visibility&2?Pa(a,o,p,x):Zc(a,o):P._visibility&2?Pa(a,o,p,x):(P._visibility|=2,Ia(a,o,p,x,(o.subtreeFlags&10256)!==0||!1)),C&2048&&mf(Z,o);break;case 24:Pa(a,o,p,x),C&2048&&th(o.alternate,o);break;default:Pa(a,o,p,x)}}function Ia(a,o,p,x,C){for(C=C&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var P=a,Z=o,ye=p,He=x,_t=Z.flags;switch(Z.tag){case 0:case 11:case 15:Ia(P,Z,ye,He,C),Bl(8,Z);break;case 23:break;case 22:var Ht=Z.stateNode;Z.memoizedState!==null?Ht._visibility&2?Ia(P,Z,ye,He,C):Zc(P,Z):(Ht._visibility|=2,Ia(P,Z,ye,He,C)),C&&_t&2048&&mf(Z.alternate,Z);break;case 24:Ia(P,Z,ye,He,C),C&&_t&2048&&th(Z.alternate,Z);break;default:Ia(P,Z,ye,He,C)}o=o.sibling}}function Zc(a,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var p=a,x=o,C=x.flags;switch(x.tag){case 22:Zc(p,x),C&2048&&mf(x.alternate,x);break;case 24:Zc(p,x),C&2048&&th(x.alternate,x);break;default:Zc(p,x)}o=o.sibling}}var nh=8192;function tl(a,o,p){if(a.subtreeFlags&nh)for(a=a.child;a!==null;)lm(a,o,p),a=a.sibling}function lm(a,o,p){switch(a.tag){case 26:tl(a,o,p),a.flags&nh&&a.memoizedState!==null&&BC(p,zl,a.memoizedState,a.memoizedProps);break;case 5:tl(a,o,p);break;case 3:case 4:var x=zl;zl=nv(a.stateNode.containerInfo),tl(a,o,p),zl=x;break;case 22:a.memoizedState===null&&(x=a.alternate,x!==null&&x.memoizedState!==null?(x=nh,nh=16777216,tl(a,o,p),nh=x):tl(a,o,p));break;default:tl(a,o,p)}}function ih(a){var o=a.alternate;if(o!==null&&(a=o.child,a!==null)){o.child=null;do o=a.sibling,a.sibling=null,a=o;while(a!==null)}}function gf(a){var o=a.deletions;if((a.flags&16)!==0){if(o!==null)for(var p=0;p<o.length;p++){var x=o[p];Ma=x,Ss(x,a)}ih(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Eo(a),a=a.sibling}function Eo(a){switch(a.tag){case 0:case 11:case 15:gf(a),a.flags&2048&&Ra(9,a,a.return);break;case 3:gf(a);break;case 12:gf(a);break;case 22:var o=a.stateNode;a.memoizedState!==null&&o._visibility&2&&(a.return===null||a.return.tag!==13)?(o._visibility&=-3,Co(a)):gf(a);break;default:gf(a)}}function Co(a){var o=a.deletions;if((a.flags&16)!==0){if(o!==null)for(var p=0;p<o.length;p++){var x=o[p];Ma=x,Ss(x,a)}ih(a)}for(a=a.child;a!==null;){switch(o=a,o.tag){case 0:case 11:case 15:Ra(8,o,o.return),Co(o);break;case 22:p=o.stateNode,p._visibility&2&&(p._visibility&=-3,Co(o));break;default:Co(o)}a=a.sibling}}function Ss(a,o){for(;Ma!==null;){var p=Ma;switch(p.tag){case 0:case 11:case 15:Ra(8,p,o);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var x=p.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:xu(p.memoizedState.cache)}if(x=p.child,x!==null)x.return=p,Ma=x;else e:for(p=a;Ma!==null;){x=Ma;var C=x.sibling,P=x.return;if(jd(x),x===p){Ma=null;break e}if(C!==null){C.return=P,Ma=C;break e}Ma=P}}}var Au={getCacheForType:function(a){var o=Qn(os),p=o.data.get(a);return p===void 0&&(p=a(),o.data.set(a,p)),p},cacheSignal:function(){return Qn(os).controller.signal}},yi=typeof WeakMap=="function"?WeakMap:Map,zn=0,ci=null,Ri=null,Ti=0,$i=0,Wa=null,Vl=!1,xc=!1,X0=!1,nl=0,us=0,$c=0,vf=0,Vd=0,ho=0,Wr=0,rh=null,ws=null,Ms=!1,Bh=0,Y0=0,Os=1/0,fs=null,Bs=null,vr=0,il=null,Uh=null,Hl=0,Fh=0,zh=null,Hd=null,xf=0,sh=null;function rl(){return(zn&2)!==0&&Ti!==0?Ti&-Ti:K.T!==null?Pt():wi()}function zi(){if(ho===0)if((Ti&536870912)===0||Fi){var a=Mt;Mt<<=1,(Mt&3932160)===0&&(Mt=262144),ho=a}else ho=536870912;return a=kr.current,a!==null&&(a.flags|=32),ho}function Li(a,o,p){(a===ci&&($i===2||$i===9)||a.cancelPendingCommit!==null)&&(bf(a,0),Ws(a,Ti,ho,!1)),tn(a,p),((zn&2)===0||a!==ci)&&(a===ci&&((zn&2)===0&&(vf|=p),us===4&&Ws(a,Ti,ho,!1)),on(a))}function ji(a,o,p){if((zn&6)!==0)throw Error(n(327));var x=!p&&(o&127)===0&&(o&a.expiredLanes)===0||vt(a,o),C=x?Gd(a,o):po(a,o,!0),P=x;do{if(C===0){xc&&!x&&Ws(a,o,0,!1);break}else{if(p=a.current.alternate,P&&!xr(p)){C=po(a,o,!1),P=!1;continue}if(C===2){if(P=o,a.errorRecoveryDisabledLanes&P)var Z=0;else Z=a.pendingLanes&-536870913,Z=Z!==0?Z:Z&536870912?536870912:0;if(Z!==0){o=Z;e:{var ye=a;C=rh;var He=ye.current.memoizedState.isDehydrated;if(He&&(bf(ye,Z).flags|=256),Z=po(ye,Z,!1),Z!==2){if(X0&&!He){ye.errorRecoveryDisabledLanes|=P,vf|=P,C=4;break e}P=ws,ws=C,P!==null&&(ws===null?ws=P:ws.push.apply(ws,P))}C=Z}if(P=!1,C!==2)continue}}if(C===1){bf(a,0),Ws(a,o,0,!0);break}e:{switch(x=a,P=C,P){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:Ws(x,o,ho,!Vl);break e;case 2:ws=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(C=Bh+300-Q(),10<C)){if(Ws(x,o,ho,!Vl),Ve(x,0,!0)!==0)break e;Hl=o,x.timeoutHandle=N2(Wi.bind(null,x,p,ws,fs,Ms,o,ho,vf,Wr,Vl,P,"Throttled",-0,0),C);break e}Wi(x,p,ws,fs,Ms,o,ho,vf,Wr,Vl,P,null,-0,0)}}break}while(!0);on(a)}function Wi(a,o,p,x,C,P,Z,ye,He,_t,Ht,Zt,Nt,Ot){if(a.timeoutHandle=-1,Zt=o.subtreeFlags,Zt&8192||(Zt&16785408)===16785408){Zt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:jo},lm(o,P,Zt);var Bn=(P&62914560)===P?Bh-Q():(P&4194048)===P?Y0-Q():0;if(Bn=UC(Zt,Bn),Bn!==null){Hl=P,a.cancelPendingCommit=Bn(Eu.bind(null,a,o,P,p,x,C,Z,ye,He,Ht,Zt,null,Nt,Ot)),Ws(a,P,Z,!_t);return}}Eu(a,o,P,p,x,C,Z,ye,He)}function xr(a){for(var o=a;;){var p=o.tag;if((p===0||p===11||p===15)&&o.flags&16384&&(p=o.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var x=0;x<p.length;x++){var C=p[x],P=C.getSnapshot;C=C.value;try{if(!Ls(P(),C))return!1}catch{return!1}}if(p=o.child,o.subtreeFlags&16384&&p!==null)p.return=o,o=p;else{if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Ws(a,o,p,x){o&=~Vd,o&=~vf,a.suspendedLanes|=o,a.pingedLanes&=~o,x&&(a.warmLanes|=o),x=a.expirationTimes;for(var C=o;0<C;){var P=31-xe(C),Z=1<<P;x[P]=-1,C&=~Z}p!==0&&Pn(a,p,o)}function yc(){return(zn&6)===0?(Nn(0),!1):!0}function yf(){if(Ri!==null){if($i===0)var a=Ri.return;else a=Ri,Ko=uc=null,Ch(a),Yt=null,Dn=0,a=Ri;for(;a!==null;)el(a.alternate,a),a=a.return;Ri=null}}function bf(a,o){var p=a.timeoutHandle;p!==-1&&(a.timeoutHandle=-1,bC(p)),p=a.cancelPendingCommit,p!==null&&(a.cancelPendingCommit=null,p()),Hl=0,yf(),ci=a,Ri=p=sa(a.current,null),Ti=o,$i=0,Wa=null,Vl=!1,xc=vt(a,o),X0=!1,Wr=ho=Vd=vf=$c=us=0,ws=rh=null,Ms=!1,(o&8)!==0&&(o|=o&32);var x=a.entangledLanes;if(x!==0)for(a=a.entanglements,x&=o;0<x;){var C=31-xe(x),P=1<<C;o|=a[C],x&=~P}return nl=o,Qu(),p}function Jc(a,o){Vn=null,K.H=Dh,o===Ke||o===Ce?(o=Ft(),$i=3):o===mt?(o=Ft(),$i=4):$i=o===$p?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Wa=o,Ri===null&&(us=1,Zp(a,ao(o,a.current)))}function hs(){var a=kr.current;return a===null?!0:(Ti&4194048)===Ti?Hi===null:(Ti&62914560)===Ti||(Ti&536870912)!==0?a===Hi:!1}function Tu(){var a=K.H;return K.H=Dh,a===null?Dh:a}function _f(){var a=K.A;return K.A=Au,a}function jh(){us=4,Vl||(Ti&4194048)!==Ti&&kr.current!==null||(xc=!0),($c&134217727)===0&&(vf&134217727)===0||ci===null||Ws(ci,Ti,ho,!1)}function po(a,o,p){var x=zn;zn|=2;var C=Tu(),P=_f();(ci!==a||Ti!==o)&&(fs=null,bf(a,o)),o=!1;var Z=us;e:do try{if($i!==0&&Ri!==null){var ye=Ri,He=Wa;switch($i){case 8:yf(),Z=6;break e;case 3:case 2:case 9:case 6:kr.current===null&&(o=!0);var _t=$i;if($i=0,Wa=null,ah(a,ye,He,_t),p&&xc){Z=0;break e}break;default:_t=$i,$i=0,Wa=null,ah(a,ye,He,_t)}}Vh(),Z=us;break}catch(Ht){Jc(a,Ht)}while(!0);return o&&a.shellSuspendCounter++,Ko=uc=null,zn=x,K.H=C,K.A=P,Ri===null&&(ci=null,Ti=0,Qu()),Z}function Vh(){for(;Ri!==null;)cm(Ri)}function Gd(a,o){var p=zn;zn|=2;var x=Tu(),C=_f();ci!==a||Ti!==o?(fs=null,Os=Q()+500,bf(a,o)):xc=vt(a,o);e:do try{if($i!==0&&Ri!==null){o=Ri;var P=Wa;t:switch($i){case 1:$i=0,Wa=null,ah(a,o,P,1);break;case 2:case 9:if(st(P)){$i=0,Wa=null,qd(o);break}o=function(){$i!==2&&$i!==9||ci!==a||($i=7),on(a)},P.then(o,o);break e;case 3:$i=7;break e;case 4:$i=5;break e;case 7:st(P)?($i=0,Wa=null,qd(o)):($i=0,Wa=null,ah(a,o,P,7));break;case 5:var Z=null;switch(Ri.tag){case 26:Z=Ri.memoizedState;case 5:case 27:var ye=Ri;if(Z?G2(Z):ye.stateNode.complete){$i=0,Wa=null;var He=ye.sibling;if(He!==null)Ri=He;else{var _t=ye.return;_t!==null?(Ri=_t,Sf(_t)):Ri=null}break t}}$i=0,Wa=null,ah(a,o,P,5);break;case 6:$i=0,Wa=null,ah(a,o,P,6);break;case 8:yf(),us=6;break e;default:throw Error(n(462))}}No();break}catch(Ht){Jc(a,Ht)}while(!0);return Ko=uc=null,K.H=x,K.A=C,zn=p,Ri!==null?0:(ci=null,Ti=0,Qu(),us)}function No(){for(;Ri!==null&&!xt();)cm(Ri)}function cm(a){var o=rm(a.alternate,a,nl);a.memoizedProps=a.pendingProps,o===null?Sf(a):Ri=o}function qd(a){var o=a,p=o.alternate;switch(o.tag){case 15:case 0:o=Od(p,o,o.pendingProps,o.type,void 0,Ti);break;case 11:o=Od(p,o,o.pendingProps,o.type.render,o.ref,Ti);break;case 5:Ch(o);default:el(p,o),o=Ri=sc(o,nl),o=rm(p,o,nl)}a.memoizedProps=a.pendingProps,o===null?Sf(a):Ri=o}function ah(a,o,p,x){Ko=uc=null,Ch(o),Yt=null,Dn=0;var C=o.return;try{if(la(a,C,o,p,Ti)){us=1,Zp(a,ao(p,a.current)),Ri=null;return}}catch(P){if(C!==null)throw Ri=C,P;us=1,Zp(a,ao(p,a.current)),Ri=null;return}o.flags&32768?(Fi||x===1?a=!0:xc||(Ti&536870912)!==0?a=!1:(Vl=a=!0,(x===2||x===9||x===3||x===6)&&(x=kr.current,x!==null&&x.tag===13&&(x.flags|=16384))),Wd(o,a)):Sf(o)}function Sf(a){var o=a;do{if((o.flags&32768)!==0){Wd(o,Vl);return}a=o.return;var p=Fd(o.alternate,o,nl);if(p!==null){Ri=p;return}if(o=o.sibling,o!==null){Ri=o;return}Ri=o=a}while(o!==null);us===0&&(us=5)}function Wd(a,o){do{var p=Ol(a.alternate,a);if(p!==null){p.flags&=32767,Ri=p;return}if(p=a.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!o&&(a=a.sibling,a!==null)){Ri=a;return}Ri=a=p}while(a!==null);us=6,Ri=null}function Eu(a,o,p,x,C,P,Z,ye,He){a.cancelPendingCommit=null;do Hh();while(vr!==0);if((zn&6)!==0)throw Error(n(327));if(o!==null){if(o===a.current)throw Error(n(177));if(P=o.lanes|o.childLanes,P|=Ps,gn(a,p,P,Z,ye,He),a===ci&&(Ri=ci=null,Ti=0),Uh=o,il=a,Hl=p,Fh=P,zh=C,Hd=x,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,O(Ye,function(){return um(),null})):(a.callbackNode=null,a.callbackPriority=0),x=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||x){x=K.T,K.T=null,C=ne.p,ne.p=2,Z=zn,zn|=4;try{Mb(a,o,p)}finally{zn=Z,ne.p=C,K.T=x}}vr=1,Xs(),Cu(),oh()}}function Xs(){if(vr===1){vr=0;var a=il,o=Uh,p=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||p){p=K.T,K.T=null;var x=ne.p;ne.p=2;var C=zn;zn|=4;try{pf(o,a);var P=Lb,Z=nc(a.containerInfo),ye=P.focusedElem,He=P.selectionRange;if(Z!==ye&&ye&&ye.ownerDocument&&Zi(ye.ownerDocument.documentElement,ye)){if(He!==null&&Cl(ye)){var _t=He.start,Ht=He.end;if(Ht===void 0&&(Ht=_t),"selectionStart"in ye)ye.selectionStart=_t,ye.selectionEnd=Math.min(Ht,ye.value.length);else{var Zt=ye.ownerDocument||document,Nt=Zt&&Zt.defaultView||window;if(Nt.getSelection){var Ot=Nt.getSelection(),Bn=ye.textContent.length,ri=Math.min(He.start,Bn),Ur=He.end===void 0?ri:Math.min(He.end,Bn);!Ot.extend&&ri>Ur&&(Z=Ur,Ur=ri,ri=Z);var ct=El(ye,ri),tt=El(ye,Ur);if(ct&&tt&&(Ot.rangeCount!==1||Ot.anchorNode!==ct.node||Ot.anchorOffset!==ct.offset||Ot.focusNode!==tt.node||Ot.focusOffset!==tt.offset)){var yt=Zt.createRange();yt.setStart(ct.node,ct.offset),Ot.removeAllRanges(),ri>Ur?(Ot.addRange(yt),Ot.extend(tt.node,tt.offset)):(yt.setEnd(tt.node,tt.offset),Ot.addRange(yt))}}}}for(Zt=[],Ot=ye;Ot=Ot.parentNode;)Ot.nodeType===1&&Zt.push({element:Ot,left:Ot.scrollLeft,top:Ot.scrollTop});for(typeof ye.focus=="function"&&ye.focus(),ye=0;ye<Zt.length;ye++){var Wt=Zt[ye];Wt.element.scrollLeft=Wt.left,Wt.element.scrollTop=Wt.top}}lv=!!Rb,Lb=Rb=null}finally{zn=C,ne.p=x,K.T=p}}a.current=o,vr=2}}function Cu(){if(vr===2){vr=0;var a=il,o=Uh,p=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||p){p=K.T,K.T=null;var x=ne.p;ne.p=2;var C=zn;zn|=4;try{rs(a,o.alternate,o)}finally{zn=C,ne.p=x,K.T=p}}vr=3}}function oh(){if(vr===4||vr===3){vr=0,he();var a=il,o=Uh,p=Hl,x=Hd;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?vr=5:(vr=0,Uh=il=null,Kc(a,a.pendingLanes));var C=a.pendingLanes;if(C===0&&(Bs=null),ii(p),o=o.stateNode,dt&&typeof dt.onCommitFiberRoot=="function")try{dt.onCommitFiberRoot(bt,o,void 0,(o.current.flags&128)===128)}catch{}if(x!==null){o=K.T,C=ne.p,ne.p=2,K.T=null;try{for(var P=a.onRecoverableError,Z=0;Z<x.length;Z++){var ye=x[Z];P(ye.value,{componentStack:ye.stack})}}finally{K.T=o,ne.p=C}}(Hl&3)!==0&&Hh(),on(a),C=a.pendingLanes,(p&261930)!==0&&(C&42)!==0?a===sh?xf++:(xf=0,sh=a):xf=0,Nn(0)}}function Kc(a,o){(a.pooledCacheLanes&=o)===0&&(o=a.pooledCache,o!=null&&(a.pooledCache=null,xu(o)))}function Hh(){return Xs(),Cu(),oh(),um()}function um(){if(vr!==5)return!1;var a=il,o=Fh;Fh=0;var p=ii(Hl),x=K.T,C=ne.p;try{ne.p=32>p?32:p,K.T=null,p=zh,zh=null;var P=il,Z=Hl;if(vr=0,Uh=il=null,Hl=0,(zn&6)!==0)throw Error(n(331));var ye=zn;if(zn|=4,Eo(P.current),W0(P,P.current,Z,p),zn=ye,Nn(0,!1),dt&&typeof dt.onPostCommitFiberRoot=="function")try{dt.onPostCommitFiberRoot(bt,P)}catch{}return!0}finally{ne.p=C,K.T=x,Kc(a,o)}}function Z0(a,o,p){o=ao(p,o),o=F0(a.stateNode,o,2),a=gi(a,o,2),a!==null&&(tn(a,2),on(a))}function sr(a,o,p){if(a.tag===3)Z0(a,a,p);else for(;o!==null;){if(o.tag===3){Z0(o,a,p);break}else if(o.tag===1){var x=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Bs===null||!Bs.has(x))){a=ao(p,a),p=z0(2),x=gi(o,p,2),x!==null&&(X1(p,x,o,a),tn(x,2),on(x));break}}o=o.return}}function Xd(a,o,p){var x=a.pingCache;if(x===null){x=a.pingCache=new yi;var C=new Set;x.set(o,C)}else C=x.get(o),C===void 0&&(C=new Set,x.set(o,C));C.has(p)||(X0=!0,C.add(p),a=u.bind(null,a,o,p),o.then(a,a))}function u(a,o,p){var x=a.pingCache;x!==null&&x.delete(o),a.pingedLanes|=a.suspendedLanes&p,a.warmLanes&=~p,ci===a&&(Ti&p)===p&&(us===4||us===3&&(Ti&62914560)===Ti&&300>Q()-Bh?(zn&2)===0&&bf(a,0):Vd|=p,Wr===Ti&&(Wr=0)),on(a)}function h(a,o){o===0&&(o=bn()),a=ra(a,o),a!==null&&(tn(a,o),on(a))}function b(a){var o=a.memoizedState,p=0;o!==null&&(p=o.retryLane),h(a,p)}function E(a,o){var p=0;switch(a.tag){case 31:case 13:var x=a.stateNode,C=a.memoizedState;C!==null&&(p=C.retryLane);break;case 19:x=a.stateNode;break;case 22:x=a.stateNode._retryCache;break;default:throw Error(n(314))}x!==null&&x.delete(o),h(a,p)}function O(a,o){return Ct(a,o)}var H=null,ve=null,Xe=!1,kt=!1,Qt=!1,xn=0;function on(a){a!==ve&&a.next===null&&(ve===null?H=ve=a:ve=ve.next=a),kt=!0,Xe||(Xe=!0,ut())}function Nn(a,o){if(!Qt&&kt){Qt=!0;do for(var p=!1,x=H;x!==null;){if(a!==0){var C=x.pendingLanes;if(C===0)var P=0;else{var Z=x.suspendedLanes,ye=x.pingedLanes;P=(1<<31-xe(42|a)+1)-1,P&=C&~(Z&~ye),P=P&201326741?P&201326741|1:P?P|2:0}P!==0&&(p=!0,At(x,P))}else P=Ti,P=Ve(x,x===ci?P:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(P&3)===0||vt(x,P)||(p=!0,At(x,P));x=x.next}while(p);Qt=!1}}function vi(){Us()}function Us(){kt=Xe=!1;var a=0;xn!==0&&yC()&&(a=xn);for(var o=Q(),p=null,x=H;x!==null;){var C=x.next,P=Gh(x,o);P===0?(x.next=null,p===null?H=C:p.next=C,C===null&&(ve=p)):(p=x,(a!==0||(P&3)!==0)&&(kt=!0)),x=C}vr!==0&&vr!==5||Nn(a),xn!==0&&(xn=0)}function Gh(a,o){for(var p=a.suspendedLanes,x=a.pingedLanes,C=a.expirationTimes,P=a.pendingLanes&-62914561;0<P;){var Z=31-xe(P),ye=1<<Z,He=C[Z];He===-1?((ye&p)===0||(ye&x)!==0)&&(C[Z]=Dt(ye,o)):He<=o&&(a.expiredLanes|=ye),P&=~ye}if(o=ci,p=Ti,p=Ve(a,a===o?p:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),x=a.callbackNode,p===0||a===o&&($i===2||$i===9)||a.cancelPendingCommit!==null)return x!==null&&x!==null&&ht(x),a.callbackNode=null,a.callbackPriority=0;if((p&3)===0||vt(a,p)){if(o=p&-p,o===a.callbackPriority)return o;switch(x!==null&&ht(x),ii(p)){case 2:case 8:p=je;break;case 32:p=Ye;break;case 268435456:p=gt;break;default:p=Ye}return x=wf.bind(null,a),p=Ct(p,x),a.callbackPriority=o,a.callbackNode=p,o}return x!==null&&x!==null&&ht(x),a.callbackPriority=2,a.callbackNode=null,2}function wf(a,o){if(vr!==0&&vr!==5)return a.callbackNode=null,a.callbackPriority=0,null;var p=a.callbackNode;if(Hh()&&a.callbackNode!==p)return null;var x=Ti;return x=Ve(a,a===ci?x:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),x===0?null:(ji(a,x,o),Gh(a,Q()),a.callbackNode!=null&&a.callbackNode===p?wf.bind(null,a):null)}function At(a,o){if(Hh())return null;ji(a,o,!0)}function ut(){_C(function(){(zn&6)!==0?Ct(ue,vi):Us()})}function Pt(){if(xn===0){var a=M;a===0&&(a=ze,ze<<=1,(ze&261888)===0&&(ze=256)),xn=a}return xn}function pn(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:Ea(""+a)}function Zn(a,o){var p=o.ownerDocument.createElement("input");return p.name=o.name,p.value=o.value,a.id&&p.setAttribute("form",a.id),o.parentNode.insertBefore(p,o),a=new FormData(a),p.parentNode.removeChild(p),a}function ds(a,o,p,x,C){if(o==="submit"&&p&&p.stateNode===C){var P=pn((C[te]||null).action),Z=x.submitter;Z&&(o=(o=Z[te]||null)?pn(o.formAction):Z.getAttribute("formAction"),o!==null&&(P=o,Z=null));var ye=new Qa("action","action",null,x,C);a.push({event:ye,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(xn!==0){var He=Z?Zn(C,Z):new FormData(C);L0(p,{pending:!0,data:He,method:C.method,action:P},null,He)}}else typeof P=="function"&&(ye.preventDefault(),He=Z?Zn(C,Z):new FormData(C),L0(p,{pending:!0,data:He,method:C.method,action:P},P,He))},currentTarget:C}]})}}for(var ti=0;ti<rc.length;ti++){var er=rc[ti],Aa=er.toLowerCase(),or=er[0].toUpperCase()+er.slice(1);ro(Aa,"on"+or)}ro(ic,"onAnimationEnd"),ro(kc,"onAnimationIteration"),ro(Sh,"onAnimationStart"),ro("dblclick","onDoubleClick"),ro("focusin","onFocus"),ro("focusout","onBlur"),ro(wd,"onTransitionRun"),ro(Fp,"onTransitionStart"),ro(Md,"onTransitionCancel"),ro(wh,"onTransitionEnd"),Ze("onMouseEnter",["mouseout","mouseover"]),Ze("onMouseLeave",["mouseout","mouseover"]),Ze("onPointerEnter",["pointerout","pointerover"]),Ze("onPointerLeave",["pointerout","pointerover"]),et("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),et("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),et("onBeforeInput",["compositionend","keypress","textInput","paste"]),et("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),et("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),et("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ab=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Gl));function _2(a,o){o=(o&4)!==0;for(var p=0;p<a.length;p++){var x=a[p],C=x.event;x=x.listeners;e:{var P=void 0;if(o)for(var Z=x.length-1;0<=Z;Z--){var ye=x[Z],He=ye.instance,_t=ye.currentTarget;if(ye=ye.listener,He!==P&&C.isPropagationStopped())break e;P=ye,C.currentTarget=_t;try{P(C)}catch(Ht){Ku(Ht)}C.currentTarget=null,P=He}else for(Z=0;Z<x.length;Z++){if(ye=x[Z],He=ye.instance,_t=ye.currentTarget,ye=ye.listener,He!==P&&C.isPropagationStopped())break e;P=ye,C.currentTarget=_t;try{P(C)}catch(Ht){Ku(Ht)}C.currentTarget=null,P=He}}}}function Ji(a,o){var p=o[Ue];p===void 0&&(p=o[Ue]=new Set);var x=a+"__bubble";p.has(x)||(S2(o,a,2,!1),p.add(x))}function Tb(a,o,p){var x=0;o&&(x|=4),S2(p,a,x,o)}var Q1="_reactListening"+Math.random().toString(36).slice(2);function Eb(a){if(!a[Q1]){a[Q1]=!0,Oe.forEach(function(p){p!=="selectionchange"&&(Ab.has(p)||Tb(p,!1,a),Tb(p,!0,a))});var o=a.nodeType===9?a:a.ownerDocument;o===null||o[Q1]||(o[Q1]=!0,Tb("selectionchange",!1,o))}}function S2(a,o,p,x){switch(J2(o)){case 2:var C=jC;break;case 8:C=VC;break;default:C=Vb}p=C.bind(null,o,p,a),C=void 0,!zf||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(C=!0),x?C!==void 0?a.addEventListener(o,p,{capture:!0,passive:C}):a.addEventListener(o,p,!0):C!==void 0?a.addEventListener(o,p,{passive:C}):a.addEventListener(o,p,!1)}function Cb(a,o,p,x,C){var P=x;if((o&1)===0&&(o&2)===0&&x!==null)e:for(;;){if(x===null)return;var Z=x.tag;if(Z===3||Z===4){var ye=x.stateNode.containerInfo;if(ye===C)break;if(Z===4)for(Z=x.return;Z!==null;){var He=Z.tag;if((He===3||He===4)&&Z.stateNode.containerInfo===C)return;Z=Z.return}for(;ye!==null;){if(Z=an(ye),Z===null)return;if(He=Z.tag,He===5||He===6||He===26||He===27){x=P=Z;continue e}ye=ye.parentNode}}x=x.return}Ff(function(){var _t=P,Ht=Nc(p),Zt=[];e:{var Nt=io.get(a);if(Nt!==void 0){var Ot=Qa,Bn=a;switch(a){case"keypress":if(Ka(p)===0)break e;case"keydown":case"keyup":Ot=Ai;break;case"focusin":Bn="focus",Ot=bl;break;case"focusout":Bn="blur",Ot=bl;break;case"beforeblur":case"afterblur":Ot=bl;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ot=Xu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ot=yl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ot=vs;break;case ic:case kc:case Sh:Ot=B;break;case wh:Ot=ea;break;case"scroll":case"scrollend":Ot=uu;break;case"wheel":Ot=yo;break;case"copy":case"cut":case"paste":Ot=Ie;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ot=$r;break;case"toggle":case"beforetoggle":Ot=Zu}var ri=(o&4)!==0,Ur=!ri&&(a==="scroll"||a==="scrollend"),ct=ri?Nt!==null?Nt+"Capture":null:Nt;ri=[];for(var tt=_t,yt;tt!==null;){var Wt=tt;if(yt=Wt.stateNode,Wt=Wt.tag,Wt!==5&&Wt!==26&&Wt!==27||yt===null||ct===null||(Wt=Ba(tt,ct),Wt!=null&&ri.push($0(tt,Wt,yt))),Ur)break;tt=tt.return}0<ri.length&&(Nt=new Ot(Nt,Bn,null,p,Ht),Zt.push({event:Nt,listeners:ri}))}}if((o&7)===0){e:{if(Nt=a==="mouseover"||a==="pointerover",Ot=a==="mouseout"||a==="pointerout",Nt&&p!==pl&&(Bn=p.relatedTarget||p.fromElement)&&(an(Bn)||Bn[be]))break e;if((Ot||Nt)&&(Nt=Ht.window===Ht?Ht:(Nt=Ht.ownerDocument)?Nt.defaultView||Nt.parentWindow:window,Ot?(Bn=p.relatedTarget||p.toElement,Ot=_t,Bn=Bn?an(Bn):null,Bn!==null&&(Ur=s(Bn),ri=Bn.tag,Bn!==Ur||ri!==5&&ri!==27&&ri!==6)&&(Bn=null)):(Ot=null,Bn=_t),Ot!==Bn)){if(ri=Xu,Wt="onMouseLeave",ct="onMouseEnter",tt="mouse",(a==="pointerout"||a==="pointerover")&&(ri=$r,Wt="onPointerLeave",ct="onPointerEnter",tt="pointer"),Ur=Ot==null?Nt:ln(Ot),yt=Bn==null?Nt:ln(Bn),Nt=new ri(Wt,tt+"leave",Ot,p,Ht),Nt.target=Ur,Nt.relatedTarget=yt,Wt=null,an(Ht)===_t&&(ri=new ri(ct,tt+"enter",Bn,p,Ht),ri.target=yt,ri.relatedTarget=Ur,Wt=ri),Ur=Wt,Ot&&Bn)t:{for(ri=pC,ct=Ot,tt=Bn,yt=0,Wt=ct;Wt;Wt=ri(Wt))yt++;Wt=0;for(var Yn=tt;Yn;Yn=ri(Yn))Wt++;for(;0<yt-Wt;)ct=ri(ct),yt--;for(;0<Wt-yt;)tt=ri(tt),Wt--;for(;yt--;){if(ct===tt||tt!==null&&ct===tt.alternate){ri=ct;break t}ct=ri(ct),tt=ri(tt)}ri=null}else ri=null;Ot!==null&&w2(Zt,Nt,Ot,ri,!1),Bn!==null&&Ur!==null&&w2(Zt,Ur,Bn,ri,!0)}}e:{if(Nt=_t?ln(_t):window,Ot=Nt.nodeName&&Nt.nodeName.toLowerCase(),Ot==="select"||Ot==="input"&&Nt.type==="file")var fr=Ql;else if($u(Nt))if(Jr)fr=Yo;else{fr=jr;var Fn=du}else Ot=Nt.nodeName,!Ot||Ot.toLowerCase()!=="input"||Nt.type!=="checkbox"&&Nt.type!=="radio"?_t&&Oa(_t.elementType)&&(fr=Ql):fr=Vf;if(fr&&(fr=fr(a,_t))){Ca(Zt,fr,p,Ht);break e}Fn&&Fn(a,Nt,_t),a==="focusout"&&_t&&Nt.type==="number"&&_t.memoizedProps.value!=null&&mi(Nt,"number",Nt.value)}switch(Fn=_t?ln(_t):window,a){case"focusin":($u(Fn)||Fn.contentEditable==="true")&&(na=Fn,ba=_t,ia=null);break;case"focusout":ia=ba=na=null;break;case"mousedown":to=!0;break;case"contextmenu":case"mouseup":case"dragend":to=!1,Vi(Zt,p,Ht);break;case"selectionchange":if(Dc)break;case"keydown":case"keyup":Vi(Zt,p,Ht)}var Di;if(Ua)e:{switch(a){case"compositionstart":var tr="onCompositionStart";break e;case"compositionend":tr="onCompositionEnd";break e;case"compositionupdate":tr="onCompositionUpdate";break e}tr=void 0}else Go?Ml(a,p)&&(tr="onCompositionEnd"):a==="keydown"&&p.keyCode===229&&(tr="onCompositionStart");tr&&(wl&&p.locale!=="ko"&&(Go||tr!=="onCompositionStart"?tr==="onCompositionEnd"&&Go&&(Di=cu()):(Hs=Ht,Lc="value"in Hs?Hs.value:Hs.textContent,Go=!0)),Fn=ev(_t,tr),0<Fn.length&&(tr=new at(tr,a,null,p,Ht),Zt.push({event:tr,listeners:Fn}),Di?tr.data=Di:(Di=hu(p),Di!==null&&(tr.data=Di)))),(Di=Sl?ya(a,p):qo(a,p))&&(tr=ev(_t,"onBeforeInput"),0<tr.length&&(Fn=new at("onBeforeInput","beforeinput",null,p,Ht),Zt.push({event:Fn,listeners:tr}),Fn.data=Di)),ds(Zt,a,_t,p,Ht)}_2(Zt,o)})}function $0(a,o,p){return{instance:a,listener:o,currentTarget:p}}function ev(a,o){for(var p=o+"Capture",x=[];a!==null;){var C=a,P=C.stateNode;if(C=C.tag,C!==5&&C!==26&&C!==27||P===null||(C=Ba(a,p),C!=null&&x.unshift($0(a,C,P)),C=Ba(a,o),C!=null&&x.push($0(a,C,P))),a.tag===3)return x;a=a.return}return[]}function pC(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function w2(a,o,p,x,C){for(var P=o._reactName,Z=[];p!==null&&p!==x;){var ye=p,He=ye.alternate,_t=ye.stateNode;if(ye=ye.tag,He!==null&&He===x)break;ye!==5&&ye!==26&&ye!==27||_t===null||(He=_t,C?(_t=Ba(p,P),_t!=null&&Z.unshift($0(p,_t,He))):C||(_t=Ba(p,P),_t!=null&&Z.push($0(p,_t,He)))),p=p.return}Z.length!==0&&a.push({event:o,listeners:Z})}var mC=/\r\n?/g,gC=/\u0000|\uFFFD/g;function M2(a){return(typeof a=="string"?a:""+a).replace(mC,`
`).replace(gC,"")}function A2(a,o){return o=M2(o),M2(a)===o}function Br(a,o,p,x,C,P){switch(p){case"children":typeof x=="string"?o==="body"||o==="textarea"&&x===""||Tr(a,x):(typeof x=="number"||typeof x=="bigint")&&o!=="body"&&Tr(a,""+x);break;case"className":Tn(a,"class",x);break;case"tabIndex":Tn(a,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":Tn(a,p,x);break;case"style":Zl(a,x,P);break;case"data":if(o!=="object"){Tn(a,"data",x);break}case"src":case"href":if(x===""&&(o!=="a"||p!=="href")){a.removeAttribute(p);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){a.removeAttribute(p);break}x=Ea(""+x),a.setAttribute(p,x);break;case"action":case"formAction":if(typeof x=="function"){a.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof P=="function"&&(p==="formAction"?(o!=="input"&&Br(a,o,"name",C.name,C,null),Br(a,o,"formEncType",C.formEncType,C,null),Br(a,o,"formMethod",C.formMethod,C,null),Br(a,o,"formTarget",C.formTarget,C,null)):(Br(a,o,"encType",C.encType,C,null),Br(a,o,"method",C.method,C,null),Br(a,o,"target",C.target,C,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){a.removeAttribute(p);break}x=Ea(""+x),a.setAttribute(p,x);break;case"onClick":x!=null&&(a.onclick=jo);break;case"onScroll":x!=null&&Ji("scroll",a);break;case"onScrollEnd":x!=null&&Ji("scrollend",a);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(n(61));if(p=x.__html,p!=null){if(C.children!=null)throw Error(n(60));a.innerHTML=p}}break;case"multiple":a.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":a.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){a.removeAttribute("xlink:href");break}p=Ea(""+x),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?a.setAttribute(p,""+x):a.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?a.setAttribute(p,""):a.removeAttribute(p);break;case"capture":case"download":x===!0?a.setAttribute(p,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?a.setAttribute(p,x):a.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?a.setAttribute(p,x):a.removeAttribute(p);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?a.removeAttribute(p):a.setAttribute(p,x);break;case"popover":Ji("beforetoggle",a),Ji("toggle",a),nn(a,"popover",x);break;case"xlinkActuate":cn(a,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":cn(a,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":cn(a,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":cn(a,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":cn(a,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":cn(a,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":cn(a,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":cn(a,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":cn(a,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":nn(a,"is",x);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=Hu.get(p)||p,nn(a,p,x))}}function Nb(a,o,p,x,C,P){switch(p){case"style":Zl(a,x,P);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(n(61));if(p=x.__html,p!=null){if(C.children!=null)throw Error(n(60));a.innerHTML=p}}break;case"children":typeof x=="string"?Tr(a,x):(typeof x=="number"||typeof x=="bigint")&&Tr(a,""+x);break;case"onScroll":x!=null&&Ji("scroll",a);break;case"onScrollEnd":x!=null&&Ji("scrollend",a);break;case"onClick":x!=null&&(a.onclick=jo);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!$e.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(C=p.endsWith("Capture"),o=p.slice(2,C?p.length-7:void 0),P=a[te]||null,P=P!=null?P[p]:null,typeof P=="function"&&a.removeEventListener(o,P,C),typeof x=="function")){typeof P!="function"&&P!==null&&(p in a?a[p]=null:a.hasAttribute(p)&&a.removeAttribute(p)),a.addEventListener(o,x,C);break e}p in a?a[p]=x:x===!0?a.setAttribute(p,""):nn(a,p,x)}}}function mo(a,o,p){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ji("error",a),Ji("load",a);var x=!1,C=!1,P;for(P in p)if(p.hasOwnProperty(P)){var Z=p[P];if(Z!=null)switch(P){case"src":x=!0;break;case"srcSet":C=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:Br(a,o,P,Z,p,null)}}C&&Br(a,o,"srcSet",p.srcSet,p,null),x&&Br(a,o,"src",p.src,p,null);return;case"input":Ji("invalid",a);var ye=P=Z=C=null,He=null,_t=null;for(x in p)if(p.hasOwnProperty(x)){var Ht=p[x];if(Ht!=null)switch(x){case"name":C=Ht;break;case"type":Z=Ht;break;case"checked":He=Ht;break;case"defaultChecked":_t=Ht;break;case"value":P=Ht;break;case"defaultValue":ye=Ht;break;case"children":case"dangerouslySetInnerHTML":if(Ht!=null)throw Error(n(137,o));break;default:Br(a,o,x,Ht,p,null)}}ss(a,P,ye,He,_t,Z,C,!1);return;case"select":Ji("invalid",a),x=Z=P=null;for(C in p)if(p.hasOwnProperty(C)&&(ye=p[C],ye!=null))switch(C){case"value":P=ye;break;case"defaultValue":Z=ye;break;case"multiple":x=ye;default:Br(a,o,C,ye,p,null)}o=P,p=Z,a.multiple=!!x,o!=null?Yi(a,!!x,o,!1):p!=null&&Yi(a,!!x,p,!0);return;case"textarea":Ji("invalid",a),P=C=x=null;for(Z in p)if(p.hasOwnProperty(Z)&&(ye=p[Z],ye!=null))switch(Z){case"value":x=ye;break;case"defaultValue":C=ye;break;case"children":P=ye;break;case"dangerouslySetInnerHTML":if(ye!=null)throw Error(n(91));break;default:Br(a,o,Z,ye,p,null)}Zr(a,x,C,P);return;case"option":for(He in p)p.hasOwnProperty(He)&&(x=p[He],x!=null)&&(He==="selected"?a.selected=x&&typeof x!="function"&&typeof x!="symbol":Br(a,o,He,x,p,null));return;case"dialog":Ji("beforetoggle",a),Ji("toggle",a),Ji("cancel",a),Ji("close",a);break;case"iframe":case"object":Ji("load",a);break;case"video":case"audio":for(x=0;x<Gl.length;x++)Ji(Gl[x],a);break;case"image":Ji("error",a),Ji("load",a);break;case"details":Ji("toggle",a);break;case"embed":case"source":case"link":Ji("error",a),Ji("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(_t in p)if(p.hasOwnProperty(_t)&&(x=p[_t],x!=null))switch(_t){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:Br(a,o,_t,x,p,null)}return;default:if(Oa(o)){for(Ht in p)p.hasOwnProperty(Ht)&&(x=p[Ht],x!==void 0&&Nb(a,o,Ht,x,p,void 0));return}}for(ye in p)p.hasOwnProperty(ye)&&(x=p[ye],x!=null&&Br(a,o,ye,x,p,null))}function vC(a,o,p,x){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var C=null,P=null,Z=null,ye=null,He=null,_t=null,Ht=null;for(Ot in p){var Zt=p[Ot];if(p.hasOwnProperty(Ot)&&Zt!=null)switch(Ot){case"checked":break;case"value":break;case"defaultValue":He=Zt;default:x.hasOwnProperty(Ot)||Br(a,o,Ot,null,x,Zt)}}for(var Nt in x){var Ot=x[Nt];if(Zt=p[Nt],x.hasOwnProperty(Nt)&&(Ot!=null||Zt!=null))switch(Nt){case"type":P=Ot;break;case"name":C=Ot;break;case"checked":_t=Ot;break;case"defaultChecked":Ht=Ot;break;case"value":Z=Ot;break;case"defaultValue":ye=Ot;break;case"children":case"dangerouslySetInnerHTML":if(Ot!=null)throw Error(n(137,o));break;default:Ot!==Zt&&Br(a,o,Nt,Ot,x,Zt)}}Ui(a,Z,ye,He,_t,Ht,P,C);return;case"select":Ot=Z=ye=Nt=null;for(P in p)if(He=p[P],p.hasOwnProperty(P)&&He!=null)switch(P){case"value":break;case"multiple":Ot=He;default:x.hasOwnProperty(P)||Br(a,o,P,null,x,He)}for(C in x)if(P=x[C],He=p[C],x.hasOwnProperty(C)&&(P!=null||He!=null))switch(C){case"value":Nt=P;break;case"defaultValue":ye=P;break;case"multiple":Z=P;default:P!==He&&Br(a,o,C,P,x,He)}o=ye,p=Z,x=Ot,Nt!=null?Yi(a,!!p,Nt,!1):!!x!=!!p&&(o!=null?Yi(a,!!p,o,!0):Yi(a,!!p,p?[]:"",!1));return;case"textarea":Ot=Nt=null;for(ye in p)if(C=p[ye],p.hasOwnProperty(ye)&&C!=null&&!x.hasOwnProperty(ye))switch(ye){case"value":break;case"children":break;default:Br(a,o,ye,null,x,C)}for(Z in x)if(C=x[Z],P=p[Z],x.hasOwnProperty(Z)&&(C!=null||P!=null))switch(Z){case"value":Nt=C;break;case"defaultValue":Ot=C;break;case"children":break;case"dangerouslySetInnerHTML":if(C!=null)throw Error(n(91));break;default:C!==P&&Br(a,o,Z,C,x,P)}Xi(a,Nt,Ot);return;case"option":for(var Bn in p)Nt=p[Bn],p.hasOwnProperty(Bn)&&Nt!=null&&!x.hasOwnProperty(Bn)&&(Bn==="selected"?a.selected=!1:Br(a,o,Bn,null,x,Nt));for(He in x)Nt=x[He],Ot=p[He],x.hasOwnProperty(He)&&Nt!==Ot&&(Nt!=null||Ot!=null)&&(He==="selected"?a.selected=Nt&&typeof Nt!="function"&&typeof Nt!="symbol":Br(a,o,He,Nt,x,Ot));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ri in p)Nt=p[ri],p.hasOwnProperty(ri)&&Nt!=null&&!x.hasOwnProperty(ri)&&Br(a,o,ri,null,x,Nt);for(_t in x)if(Nt=x[_t],Ot=p[_t],x.hasOwnProperty(_t)&&Nt!==Ot&&(Nt!=null||Ot!=null))switch(_t){case"children":case"dangerouslySetInnerHTML":if(Nt!=null)throw Error(n(137,o));break;default:Br(a,o,_t,Nt,x,Ot)}return;default:if(Oa(o)){for(var Ur in p)Nt=p[Ur],p.hasOwnProperty(Ur)&&Nt!==void 0&&!x.hasOwnProperty(Ur)&&Nb(a,o,Ur,void 0,x,Nt);for(Ht in x)Nt=x[Ht],Ot=p[Ht],!x.hasOwnProperty(Ht)||Nt===Ot||Nt===void 0&&Ot===void 0||Nb(a,o,Ht,Nt,x,Ot);return}}for(var ct in p)Nt=p[ct],p.hasOwnProperty(ct)&&Nt!=null&&!x.hasOwnProperty(ct)&&Br(a,o,ct,null,x,Nt);for(Zt in x)Nt=x[Zt],Ot=p[Zt],!x.hasOwnProperty(Zt)||Nt===Ot||Nt==null&&Ot==null||Br(a,o,Zt,Nt,x,Ot)}function T2(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function xC(){if(typeof performance.getEntriesByType=="function"){for(var a=0,o=0,p=performance.getEntriesByType("resource"),x=0;x<p.length;x++){var C=p[x],P=C.transferSize,Z=C.initiatorType,ye=C.duration;if(P&&ye&&T2(Z)){for(Z=0,ye=C.responseEnd,x+=1;x<p.length;x++){var He=p[x],_t=He.startTime;if(_t>ye)break;var Ht=He.transferSize,Zt=He.initiatorType;Ht&&T2(Zt)&&(He=He.responseEnd,Z+=Ht*(He<ye?1:(ye-_t)/(He-_t)))}if(--x,o+=8*(P+Z)/(C.duration/1e3),a++,10<a)break}}if(0<a)return o/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var Rb=null,Lb=null;function tv(a){return a.nodeType===9?a:a.ownerDocument}function E2(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function C2(a,o){if(a===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&o==="foreignObject"?0:a}function Pb(a,o){return a==="textarea"||a==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Ib=null;function yC(){var a=window.event;return a&&a.type==="popstate"?a===Ib?!1:(Ib=a,!0):(Ib=null,!1)}var N2=typeof setTimeout=="function"?setTimeout:void 0,bC=typeof clearTimeout=="function"?clearTimeout:void 0,R2=typeof Promise=="function"?Promise:void 0,_C=typeof queueMicrotask=="function"?queueMicrotask:typeof R2<"u"?function(a){return R2.resolve(null).then(a).catch(SC)}:N2;function SC(a){setTimeout(function(){throw a})}function qh(a){return a==="head"}function L2(a,o){var p=o,x=0;do{var C=p.nextSibling;if(a.removeChild(p),C&&C.nodeType===8)if(p=C.data,p==="/$"||p==="/&"){if(x===0){a.removeChild(C),pm(o);return}x--}else if(p==="$"||p==="$?"||p==="$~"||p==="$!"||p==="&")x++;else if(p==="html")J0(a.ownerDocument.documentElement);else if(p==="head"){p=a.ownerDocument.head,J0(p);for(var P=p.firstChild;P;){var Z=P.nextSibling,ye=P.nodeName;P[Xt]||ye==="SCRIPT"||ye==="STYLE"||ye==="LINK"&&P.rel.toLowerCase()==="stylesheet"||p.removeChild(P),P=Z}}else p==="body"&&J0(a.ownerDocument.body);p=C}while(p);pm(o)}function P2(a,o){var p=a;a=0;do{var x=p.nextSibling;if(p.nodeType===1?o?(p._stashedDisplay=p.style.display,p.style.display="none"):(p.style.display=p._stashedDisplay||"",p.getAttribute("style")===""&&p.removeAttribute("style")):p.nodeType===3&&(o?(p._stashedText=p.nodeValue,p.nodeValue=""):p.nodeValue=p._stashedText||""),x&&x.nodeType===8)if(p=x.data,p==="/$"){if(a===0)break;a--}else p!=="$"&&p!=="$?"&&p!=="$~"&&p!=="$!"||a++;p=x}while(p)}function Db(a){var o=a.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var p=o;switch(o=o.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":Db(p),qt(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}a.removeChild(p)}}function wC(a,o,p,x){for(;a.nodeType===1;){var C=p;if(a.nodeName.toLowerCase()!==o.toLowerCase()){if(!x&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(x){if(!a[Xt])switch(o){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(P=a.getAttribute("rel"),P==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(P!==C.rel||a.getAttribute("href")!==(C.href==null||C.href===""?null:C.href)||a.getAttribute("crossorigin")!==(C.crossOrigin==null?null:C.crossOrigin)||a.getAttribute("title")!==(C.title==null?null:C.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(P=a.getAttribute("src"),(P!==(C.src==null?null:C.src)||a.getAttribute("type")!==(C.type==null?null:C.type)||a.getAttribute("crossorigin")!==(C.crossOrigin==null?null:C.crossOrigin))&&P&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(o==="input"&&a.type==="hidden"){var P=C.name==null?null:""+C.name;if(C.type==="hidden"&&a.getAttribute("name")===P)return a}else return a;if(a=Qc(a.nextSibling),a===null)break}return null}function MC(a,o,p){if(o==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!p||(a=Qc(a.nextSibling),a===null))return null;return a}function I2(a,o){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!o||(a=Qc(a.nextSibling),a===null))return null;return a}function kb(a){return a.data==="$?"||a.data==="$~"}function Ob(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function AC(a,o){var p=a.ownerDocument;if(a.data==="$~")a._reactRetry=o;else if(a.data!=="$?"||p.readyState!=="loading")o();else{var x=function(){o(),p.removeEventListener("DOMContentLoaded",x)};p.addEventListener("DOMContentLoaded",x),a._reactRetry=x}}function Qc(a){for(;a!=null;a=a.nextSibling){var o=a.nodeType;if(o===1||o===3)break;if(o===8){if(o=a.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return a}var Bb=null;function D2(a){a=a.nextSibling;for(var o=0;a;){if(a.nodeType===8){var p=a.data;if(p==="/$"||p==="/&"){if(o===0)return Qc(a.nextSibling);o--}else p!=="$"&&p!=="$!"&&p!=="$?"&&p!=="$~"&&p!=="&"||o++}a=a.nextSibling}return null}function k2(a){a=a.previousSibling;for(var o=0;a;){if(a.nodeType===8){var p=a.data;if(p==="$"||p==="$!"||p==="$?"||p==="$~"||p==="&"){if(o===0)return a;o--}else p!=="/$"&&p!=="/&"||o++}a=a.previousSibling}return null}function O2(a,o,p){switch(o=tv(p),a){case"html":if(a=o.documentElement,!a)throw Error(n(452));return a;case"head":if(a=o.head,!a)throw Error(n(453));return a;case"body":if(a=o.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function J0(a){for(var o=a.attributes;o.length;)a.removeAttributeNode(o[0]);qt(a)}var eu=new Map,B2=new Set;function nv(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var lh=ne.d;ne.d={f:TC,r:EC,D:CC,C:NC,L:RC,m:LC,X:IC,S:PC,M:DC};function TC(){var a=lh.f(),o=yc();return a||o}function EC(a){var o=sn(a);o!==null&&o.tag===5&&o.type==="form"?U1(o):lh.r(a)}var fm=typeof document>"u"?null:document;function U2(a,o,p){var x=fm;if(x&&typeof o=="string"&&o){var C=mn(o);C='link[rel="'+a+'"][href="'+C+'"]',typeof p=="string"&&(C+='[crossorigin="'+p+'"]'),B2.has(C)||(B2.add(C),a={rel:a,crossOrigin:p,href:o},x.querySelector(C)===null&&(o=x.createElement("link"),mo(o,"link",a),fe(o),x.head.appendChild(o)))}}function CC(a){lh.D(a),U2("dns-prefetch",a,null)}function NC(a,o){lh.C(a,o),U2("preconnect",a,o)}function RC(a,o,p){lh.L(a,o,p);var x=fm;if(x&&a&&o){var C='link[rel="preload"][as="'+mn(o)+'"]';o==="image"&&p&&p.imageSrcSet?(C+='[imagesrcset="'+mn(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(C+='[imagesizes="'+mn(p.imageSizes)+'"]')):C+='[href="'+mn(a)+'"]';var P=C;switch(o){case"style":P=hm(a);break;case"script":P=dm(a)}eu.has(P)||(a=g({rel:"preload",href:o==="image"&&p&&p.imageSrcSet?void 0:a,as:o},p),eu.set(P,a),x.querySelector(C)!==null||o==="style"&&x.querySelector(K0(P))||o==="script"&&x.querySelector(Q0(P))||(o=x.createElement("link"),mo(o,"link",a),fe(o),x.head.appendChild(o)))}}function LC(a,o){lh.m(a,o);var p=fm;if(p&&a){var x=o&&typeof o.as=="string"?o.as:"script",C='link[rel="modulepreload"][as="'+mn(x)+'"][href="'+mn(a)+'"]',P=C;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":P=dm(a)}if(!eu.has(P)&&(a=g({rel:"modulepreload",href:a},o),eu.set(P,a),p.querySelector(C)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(Q0(P)))return}x=p.createElement("link"),mo(x,"link",a),fe(x),p.head.appendChild(x)}}}function PC(a,o,p){lh.S(a,o,p);var x=fm;if(x&&a){var C=rn(x).hoistableStyles,P=hm(a);o=o||"default";var Z=C.get(P);if(!Z){var ye={loading:0,preload:null};if(Z=x.querySelector(K0(P)))ye.loading=5;else{a=g({rel:"stylesheet",href:a,"data-precedence":o},p),(p=eu.get(P))&&Ub(a,p);var He=Z=x.createElement("link");fe(He),mo(He,"link",a),He._p=new Promise(function(_t,Ht){He.onload=_t,He.onerror=Ht}),He.addEventListener("load",function(){ye.loading|=1}),He.addEventListener("error",function(){ye.loading|=2}),ye.loading|=4,iv(Z,o,x)}Z={type:"stylesheet",instance:Z,count:1,state:ye},C.set(P,Z)}}}function IC(a,o){lh.X(a,o);var p=fm;if(p&&a){var x=rn(p).hoistableScripts,C=dm(a),P=x.get(C);P||(P=p.querySelector(Q0(C)),P||(a=g({src:a,async:!0},o),(o=eu.get(C))&&Fb(a,o),P=p.createElement("script"),fe(P),mo(P,"link",a),p.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},x.set(C,P))}}function DC(a,o){lh.M(a,o);var p=fm;if(p&&a){var x=rn(p).hoistableScripts,C=dm(a),P=x.get(C);P||(P=p.querySelector(Q0(C)),P||(a=g({src:a,async:!0,type:"module"},o),(o=eu.get(C))&&Fb(a,o),P=p.createElement("script"),fe(P),mo(P,"link",a),p.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},x.set(C,P))}}function F2(a,o,p,x){var C=(C=ie.current)?nv(C):null;if(!C)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(o=hm(p.href),p=rn(C).hoistableStyles,x=p.get(o),x||(x={type:"style",instance:null,count:0,state:null},p.set(o,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){a=hm(p.href);var P=rn(C).hoistableStyles,Z=P.get(a);if(Z||(C=C.ownerDocument||C,Z={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},P.set(a,Z),(P=C.querySelector(K0(a)))&&!P._p&&(Z.instance=P,Z.state.loading=5),eu.has(a)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},eu.set(a,p),P||kC(C,a,p,Z.state))),o&&x===null)throw Error(n(528,""));return Z}if(o&&x!==null)throw Error(n(529,""));return null;case"script":return o=p.async,p=p.src,typeof p=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=dm(p),p=rn(C).hoistableScripts,x=p.get(o),x||(x={type:"script",instance:null,count:0,state:null},p.set(o,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function hm(a){return'href="'+mn(a)+'"'}function K0(a){return'link[rel="stylesheet"]['+a+"]"}function z2(a){return g({},a,{"data-precedence":a.precedence,precedence:null})}function kC(a,o,p,x){a.querySelector('link[rel="preload"][as="style"]['+o+"]")?x.loading=1:(o=a.createElement("link"),x.preload=o,o.addEventListener("load",function(){return x.loading|=1}),o.addEventListener("error",function(){return x.loading|=2}),mo(o,"link",p),fe(o),a.head.appendChild(o))}function dm(a){return'[src="'+mn(a)+'"]'}function Q0(a){return"script[async]"+a}function j2(a,o,p){if(o.count++,o.instance===null)switch(o.type){case"style":var x=a.querySelector('style[data-href~="'+mn(p.href)+'"]');if(x)return o.instance=x,fe(x),x;var C=g({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return x=(a.ownerDocument||a).createElement("style"),fe(x),mo(x,"style",C),iv(x,p.precedence,a),o.instance=x;case"stylesheet":C=hm(p.href);var P=a.querySelector(K0(C));if(P)return o.state.loading|=4,o.instance=P,fe(P),P;x=z2(p),(C=eu.get(C))&&Ub(x,C),P=(a.ownerDocument||a).createElement("link"),fe(P);var Z=P;return Z._p=new Promise(function(ye,He){Z.onload=ye,Z.onerror=He}),mo(P,"link",x),o.state.loading|=4,iv(P,p.precedence,a),o.instance=P;case"script":return P=dm(p.src),(C=a.querySelector(Q0(P)))?(o.instance=C,fe(C),C):(x=p,(C=eu.get(P))&&(x=g({},p),Fb(x,C)),a=a.ownerDocument||a,C=a.createElement("script"),fe(C),mo(C,"link",x),a.head.appendChild(C),o.instance=C);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(x=o.instance,o.state.loading|=4,iv(x,p.precedence,a));return o.instance}function iv(a,o,p){for(var x=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),C=x.length?x[x.length-1]:null,P=C,Z=0;Z<x.length;Z++){var ye=x[Z];if(ye.dataset.precedence===o)P=ye;else if(P!==C)break}P?P.parentNode.insertBefore(a,P.nextSibling):(o=p.nodeType===9?p.head:p,o.insertBefore(a,o.firstChild))}function Ub(a,o){a.crossOrigin==null&&(a.crossOrigin=o.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=o.referrerPolicy),a.title==null&&(a.title=o.title)}function Fb(a,o){a.crossOrigin==null&&(a.crossOrigin=o.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=o.referrerPolicy),a.integrity==null&&(a.integrity=o.integrity)}var rv=null;function V2(a,o,p){if(rv===null){var x=new Map,C=rv=new Map;C.set(p,x)}else C=rv,x=C.get(p),x||(x=new Map,C.set(p,x));if(x.has(a))return x;for(x.set(a,null),p=p.getElementsByTagName(a),C=0;C<p.length;C++){var P=p[C];if(!(P[Xt]||P[Mi]||a==="link"&&P.getAttribute("rel")==="stylesheet")&&P.namespaceURI!=="http://www.w3.org/2000/svg"){var Z=P.getAttribute(o)||"";Z=a+Z;var ye=x.get(Z);ye?ye.push(P):x.set(Z,[P])}}return x}function H2(a,o,p){a=a.ownerDocument||a,a.head.insertBefore(p,o==="title"?a.querySelector("head > title"):null)}function OC(a,o,p){if(p===1||o.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;return o.rel==="stylesheet"?(a=o.disabled,typeof o.precedence=="string"&&a==null):!0;case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function G2(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function BC(a,o,p,x){if(p.type==="stylesheet"&&(typeof x.media!="string"||matchMedia(x.media).matches!==!1)&&(p.state.loading&4)===0){if(p.instance===null){var C=hm(x.href),P=o.querySelector(K0(C));if(P){o=P._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(a.count++,a=sv.bind(a),o.then(a,a)),p.state.loading|=4,p.instance=P,fe(P);return}P=o.ownerDocument||o,x=z2(x),(C=eu.get(C))&&Ub(x,C),P=P.createElement("link"),fe(P);var Z=P;Z._p=new Promise(function(ye,He){Z.onload=ye,Z.onerror=He}),mo(P,"link",x),p.instance=P}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(p,o),(o=p.state.preload)&&(p.state.loading&3)===0&&(a.count++,p=sv.bind(a),o.addEventListener("load",p),o.addEventListener("error",p))}}var zb=0;function UC(a,o){return a.stylesheets&&a.count===0&&ov(a,a.stylesheets),0<a.count||0<a.imgCount?function(p){var x=setTimeout(function(){if(a.stylesheets&&ov(a,a.stylesheets),a.unsuspend){var P=a.unsuspend;a.unsuspend=null,P()}},6e4+o);0<a.imgBytes&&zb===0&&(zb=62500*xC());var C=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&ov(a,a.stylesheets),a.unsuspend)){var P=a.unsuspend;a.unsuspend=null,P()}},(a.imgBytes>zb?50:800)+o);return a.unsuspend=p,function(){a.unsuspend=null,clearTimeout(x),clearTimeout(C)}}:null}function sv(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ov(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var av=null;function ov(a,o){a.stylesheets=null,a.unsuspend!==null&&(a.count++,av=new Map,o.forEach(FC,a),av=null,sv.call(a))}function FC(a,o){if(!(o.state.loading&4)){var p=av.get(a);if(p)var x=p.get(null);else{p=new Map,av.set(a,p);for(var C=a.querySelectorAll("link[data-precedence],style[data-precedence]"),P=0;P<C.length;P++){var Z=C[P];(Z.nodeName==="LINK"||Z.getAttribute("media")!=="not all")&&(p.set(Z.dataset.precedence,Z),x=Z)}x&&p.set(null,x)}C=o.instance,Z=C.getAttribute("data-precedence"),P=p.get(Z)||x,P===x&&p.set(null,C),p.set(Z,C),this.count++,x=sv.bind(this),C.addEventListener("load",x),C.addEventListener("error",x),P?P.parentNode.insertBefore(C,P.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(C,a.firstChild)),o.state.loading|=4}}var eg={$$typeof:D,Provider:null,Consumer:null,_currentValue:pe,_currentValue2:pe,_threadCount:0};function zC(a,o,p,x,C,P,Z,ye,He){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=dn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dn(0),this.hiddenUpdates=dn(null),this.identifierPrefix=x,this.onUncaughtError=C,this.onCaughtError=P,this.onRecoverableError=Z,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=He,this.incompleteTransitions=new Map}function q2(a,o,p,x,C,P,Z,ye,He,_t,Ht,Zt){return a=new zC(a,o,p,Z,He,_t,Ht,Zt,ye),o=1,P===!0&&(o|=24),P=br(3,null,null,o),a.current=P,P.stateNode=a,o=af(),o.refCount++,a.pooledCache=o,o.refCount++,P.memoizedState={element:x,isDehydrated:p,cache:o},yn(P),a}function W2(a){return a?(a=Ds,a):Ds}function X2(a,o,p,x,C,P){C=W2(C),x.context===null?x.context=C:x.pendingContext=C,x=Xn(o),x.payload={element:p},P=P===void 0?null:P,P!==null&&(x.callback=P),p=gi(a,x,o),p!==null&&(Li(p,a,o),Ki(p,a,o))}function Y2(a,o){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var p=a.retryLane;a.retryLane=p!==0&&p<o?p:o}}function jb(a,o){Y2(a,o),(a=a.alternate)&&Y2(a,o)}function Z2(a){if(a.tag===13||a.tag===31){var o=ra(a,67108864);o!==null&&Li(o,a,67108864),jb(a,67108864)}}function $2(a){if(a.tag===13||a.tag===31){var o=rl();o=$n(o);var p=ra(a,o);p!==null&&Li(p,a,o),jb(a,o)}}var lv=!0;function jC(a,o,p,x){var C=K.T;K.T=null;var P=ne.p;try{ne.p=2,Vb(a,o,p,x)}finally{ne.p=P,K.T=C}}function VC(a,o,p,x){var C=K.T;K.T=null;var P=ne.p;try{ne.p=8,Vb(a,o,p,x)}finally{ne.p=P,K.T=C}}function Vb(a,o,p,x){if(lv){var C=Hb(x);if(C===null)Cb(a,o,x,cv,p),K2(a,x);else if(GC(C,a,o,p,x))x.stopPropagation();else if(K2(a,x),o&4&&-1<HC.indexOf(a)){for(;C!==null;){var P=sn(C);if(P!==null)switch(P.tag){case 3:if(P=P.stateNode,P.current.memoizedState.isDehydrated){var Z=se(P.pendingLanes);if(Z!==0){var ye=P;for(ye.pendingLanes|=2,ye.entangledLanes|=2;Z;){var He=1<<31-xe(Z);ye.entanglements[1]|=He,Z&=~He}on(P),(zn&6)===0&&(Os=Q()+500,Nn(0))}}break;case 31:case 13:ye=ra(P,2),ye!==null&&Li(ye,P,2),yc(),jb(P,2)}if(P=Hb(x),P===null&&Cb(a,o,x,cv,p),P===C)break;C=P}C!==null&&x.stopPropagation()}else Cb(a,o,x,null,p)}}function Hb(a){return a=Nc(a),Gb(a)}var cv=null;function Gb(a){if(cv=null,a=an(a),a!==null){var o=s(a);if(o===null)a=null;else{var p=o.tag;if(p===13){if(a=l(o),a!==null)return a;a=null}else if(p===31){if(a=c(o),a!==null)return a;a=null}else if(p===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;a=null}else o!==a&&(a=null)}}return cv=a,null}function J2(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Be()){case ue:return 2;case je:return 8;case Ye:case ft:return 32;case gt:return 268435456;default:return 32}default:return 32}}var qb=!1,Wh=null,Xh=null,Yh=null,tg=new Map,ng=new Map,Zh=[],HC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function K2(a,o){switch(a){case"focusin":case"focusout":Wh=null;break;case"dragenter":case"dragleave":Xh=null;break;case"mouseover":case"mouseout":Yh=null;break;case"pointerover":case"pointerout":tg.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":ng.delete(o.pointerId)}}function ig(a,o,p,x,C,P){return a===null||a.nativeEvent!==P?(a={blockedOn:o,domEventName:p,eventSystemFlags:x,nativeEvent:P,targetContainers:[C]},o!==null&&(o=sn(o),o!==null&&Z2(o)),a):(a.eventSystemFlags|=x,o=a.targetContainers,C!==null&&o.indexOf(C)===-1&&o.push(C),a)}function GC(a,o,p,x,C){switch(o){case"focusin":return Wh=ig(Wh,a,o,p,x,C),!0;case"dragenter":return Xh=ig(Xh,a,o,p,x,C),!0;case"mouseover":return Yh=ig(Yh,a,o,p,x,C),!0;case"pointerover":var P=C.pointerId;return tg.set(P,ig(tg.get(P)||null,a,o,p,x,C)),!0;case"gotpointercapture":return P=C.pointerId,ng.set(P,ig(ng.get(P)||null,a,o,p,x,C)),!0}return!1}function Q2(a){var o=an(a.target);if(o!==null){var p=s(o);if(p!==null){if(o=p.tag,o===13){if(o=l(p),o!==null){a.blockedOn=o,Rn(a.priority,function(){$2(p)});return}}else if(o===31){if(o=c(p),o!==null){a.blockedOn=o,Rn(a.priority,function(){$2(p)});return}}else if(o===3&&p.stateNode.current.memoizedState.isDehydrated){a.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}a.blockedOn=null}function uv(a){if(a.blockedOn!==null)return!1;for(var o=a.targetContainers;0<o.length;){var p=Hb(a.nativeEvent);if(p===null){p=a.nativeEvent;var x=new p.constructor(p.type,p);pl=x,p.target.dispatchEvent(x),pl=null}else return o=sn(p),o!==null&&Z2(o),a.blockedOn=p,!1;o.shift()}return!0}function ew(a,o,p){uv(a)&&p.delete(o)}function qC(){qb=!1,Wh!==null&&uv(Wh)&&(Wh=null),Xh!==null&&uv(Xh)&&(Xh=null),Yh!==null&&uv(Yh)&&(Yh=null),tg.forEach(ew),ng.forEach(ew)}function fv(a,o){a.blockedOn===o&&(a.blockedOn=null,qb||(qb=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,qC)))}var hv=null;function tw(a){hv!==a&&(hv=a,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){hv===a&&(hv=null);for(var o=0;o<a.length;o+=3){var p=a[o],x=a[o+1],C=a[o+2];if(typeof x!="function"){if(Gb(x||p)===null)continue;break}var P=sn(p);P!==null&&(a.splice(o,3),o-=3,L0(P,{pending:!0,data:C,method:p.method,action:x},x,C))}}))}function pm(a){function o(He){return fv(He,a)}Wh!==null&&fv(Wh,a),Xh!==null&&fv(Xh,a),Yh!==null&&fv(Yh,a),tg.forEach(o),ng.forEach(o);for(var p=0;p<Zh.length;p++){var x=Zh[p];x.blockedOn===a&&(x.blockedOn=null)}for(;0<Zh.length&&(p=Zh[0],p.blockedOn===null);)Q2(p),p.blockedOn===null&&Zh.shift();if(p=(a.ownerDocument||a).$$reactFormReplay,p!=null)for(x=0;x<p.length;x+=3){var C=p[x],P=p[x+1],Z=C[te]||null;if(typeof P=="function")Z||tw(p);else if(Z){var ye=null;if(P&&P.hasAttribute("formAction")){if(C=P,Z=P[te]||null)ye=Z.formAction;else if(Gb(C)!==null)continue}else ye=Z.action;typeof ye=="function"?p[x+1]=ye:(p.splice(x,3),x-=3),tw(p)}}}function nw(){function a(P){P.canIntercept&&P.info==="react-transition"&&P.intercept({handler:function(){return new Promise(function(Z){return C=Z})},focusReset:"manual",scroll:"manual"})}function o(){C!==null&&(C(),C=null),x||setTimeout(p,20)}function p(){if(!x&&!navigation.transition){var P=navigation.currentEntry;P&&P.url!=null&&navigation.navigate(P.url,{state:P.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var x=!1,C=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(p,100),function(){x=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),C!==null&&(C(),C=null)}}}function Wb(a){this._internalRoot=a}dv.prototype.render=Wb.prototype.render=function(a){var o=this._internalRoot;if(o===null)throw Error(n(409));var p=o.current,x=rl();X2(p,x,a,o,null,null)},dv.prototype.unmount=Wb.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var o=a.containerInfo;X2(a.current,2,null,a,null,null),yc(),o[be]=null}};function dv(a){this._internalRoot=a}dv.prototype.unstable_scheduleHydration=function(a){if(a){var o=wi();a={blockedOn:null,target:a,priority:o};for(var p=0;p<Zh.length&&o!==0&&o<Zh[p].priority;p++);Zh.splice(p,0,a),p===0&&Q2(a)}};var iw=e.version;if(iw!=="19.2.3")throw Error(n(527,iw,"19.2.3"));ne.findDOMNode=function(a){var o=a._reactInternals;if(o===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=d(o),a=a!==null?m(a):null,a=a===null?null:a.stateNode,a};var WC={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:K,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var pv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!pv.isDisabled&&pv.supportsFiber)try{bt=pv.inject(WC),dt=pv}catch{}}return sg.createRoot=function(a,o){if(!r(a))throw Error(n(299));var p=!1,x="",C=q1,P=B0,Z=U0;return o!=null&&(o.unstable_strictMode===!0&&(p=!0),o.identifierPrefix!==void 0&&(x=o.identifierPrefix),o.onUncaughtError!==void 0&&(C=o.onUncaughtError),o.onCaughtError!==void 0&&(P=o.onCaughtError),o.onRecoverableError!==void 0&&(Z=o.onRecoverableError)),o=q2(a,1,!1,null,null,p,x,null,C,P,Z,nw),a[be]=o.current,Eb(a),new Wb(o)},sg.hydrateRoot=function(a,o,p){if(!r(a))throw Error(n(299));var x=!1,C="",P=q1,Z=B0,ye=U0,He=null;return p!=null&&(p.unstable_strictMode===!0&&(x=!0),p.identifierPrefix!==void 0&&(C=p.identifierPrefix),p.onUncaughtError!==void 0&&(P=p.onUncaughtError),p.onCaughtError!==void 0&&(Z=p.onCaughtError),p.onRecoverableError!==void 0&&(ye=p.onRecoverableError),p.formState!==void 0&&(He=p.formState)),o=q2(a,1,!0,o,p??null,x,C,He,P,Z,ye,nw),o.context=W2(null),p=o.current,x=rl(),x=$n(x),C=Xn(x),C.callback=null,gi(p,C,x),p=x,o.current.lanes=p,tn(o,p),on(o),a[be]=o.current,Eb(a),new dv(o)},sg.version="19.2.3",sg}var dw;function tN(){if(dw)return Zb.exports;dw=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),Zb.exports=eN(),Zb.exports}var WA=tN();const l1="182",cp={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},up={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},XA=0,M_=1,YA=2,nN=3,ZA=0,Jm=1,Tg=2,mp=3,_h=0,cl=1,Es=2,Ou=0,Sp=1,A_=2,T_=3,E_=4,$A=5,od=100,JA=101,KA=102,QA=103,eT=104,tT=200,nT=201,iT=202,rT=203,Rx=204,Lx=205,sT=206,aT=207,oT=208,lT=209,cT=210,uT=211,fT=212,hT=213,dT=214,Px=0,Ix=1,Dx=2,Tp=3,kx=4,Ox=5,Bx=6,Ux=7,c1=0,pT=1,mT=2,ru=0,hS=1,dS=2,pS=3,Iy=4,mS=5,gS=6,vS=7,C_="attached",gT="detached",pd=300,Bu=301,md=302,s0=303,Fg=304,b0=306,zg=1e3,Js=1001,jg=1002,va=1003,xS=1004,iN=1004,Xm=1005,rN=1005,ar=1006,Eg=1007,sN=1007,Rf=1008,N_=1008,$a=1009,Dy=1010,ky=1011,a0=1012,u1=1013,Ec=1014,Cs=1015,Ks=1016,Oy=1017,By=1018,o0=1020,yS=35902,bS=35899,_S=1021,SS=1022,xa=1023,If=1026,ld=1027,f1=1028,h1=1029,Ep=1030,Uy=1031,aN=1032,Fy=1033,Cg=33776,Ng=33777,Rg=33778,Lg=33779,Fx=35840,zx=35841,jx=35842,Vx=35843,Hx=36196,Gx=37492,qx=37496,Wx=37488,Xx=37489,Yx=37490,Zx=37491,$x=37808,Jx=37809,Kx=37810,Qx=37811,ey=37812,ty=37813,ny=37814,iy=37815,ry=37816,sy=37817,ay=37818,oy=37819,ly=37820,cy=37821,uy=36492,fy=36494,hy=36495,dy=36283,py=36284,my=36285,gy=36286,vT=2200,xT=2201,yT=2202,Vg=2300,vy=2301,yx=2302,gp=2400,vp=2401,Hg=2402,zy=2500,wS=2501,oN=0,lN=1,cN=2,bT=3200,uN=3201,fN=3202,hN=3203,yd=0,_T=1,xh="",vo="srgb",Uu="srgb-linear",Gg="linear",Ar="srgb",dN="",pN="rg",mN="ga",gN=0,fp=7680,vN=7681,xN=7682,yN=7683,bN=34055,_N=34056,SN=5386,wN=512,MN=513,AN=514,TN=515,EN=516,CN=517,NN=518,R_=519,ST=512,wT=513,MT=514,jy=515,AT=516,TT=517,Vy=518,ET=519,qg=35044,RN=35048,LN=35040,PN=35045,IN=35049,DN=35041,kN=35046,ON=35050,BN=35042,UN="100",L_="300 es",wc=2e3,l0=2001,FN={COMPUTE:"compute",RENDER:"render"},zN={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},jN={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};function CT(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}const VN={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Ym(i,e){return new VN[i](e)}function NT(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function Wg(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function RT(){const i=Wg("canvas");return i.style.display="block",i}const pw={};let gd=null;function HN(i){gd=i}function GN(){return gd}function Xg(...i){const e="THREE."+i.shift();gd?gd("log",e,...i):console.log(e,...i)}function Mn(...i){const e="THREE."+i.shift();gd?gd("warn",e,...i):console.warn(e,...i)}function Hn(...i){const e="THREE."+i.shift();gd?gd("error",e,...i):console.error(e,...i)}function c0(...i){const e=i.join(" ");e in pw||(pw[e]=!0,Mn(...i))}function qN(i,e,t){return new Promise(function(n,r){function s(){switch(i.clientWaitSync(e,i.SYNC_FLUSH_COMMANDS_BIT,0)){case i.WAIT_FAILED:r();break;case i.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:n()}}setTimeout(s,t)})}let Df=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const r=n[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let s=0,l=r.length;s<l;s++)r[s].call(this,e);e.target=null}}};const Lo=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let mw=1234567;const wp=Math.PI/180,u0=180/Math.PI;function Ac(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Lo[i&255]+Lo[i>>8&255]+Lo[i>>16&255]+Lo[i>>24&255]+"-"+Lo[e&255]+Lo[e>>8&255]+"-"+Lo[e>>16&15|64]+Lo[e>>24&255]+"-"+Lo[t&63|128]+Lo[t>>8&255]+"-"+Lo[t>>16&255]+Lo[t>>24&255]+Lo[n&255]+Lo[n>>8&255]+Lo[n>>16&255]+Lo[n>>24&255]).toLowerCase()}function oi(i,e,t){return Math.max(e,Math.min(t,i))}function MS(i,e){return(i%e+e)%e}function WN(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)}function XN(i,e,t){return i!==e?(t-i)/(e-i):0}function Pg(i,e,t){return(1-t)*i+t*e}function YN(i,e,t,n){return Pg(i,e,1-Math.exp(-t*n))}function ZN(i,e=1){return e-Math.abs(MS(i,e*2)-e)}function $N(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function JN(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function KN(i,e){return i+Math.floor(Math.random()*(e-i+1))}function QN(i,e){return i+Math.random()*(e-i)}function eR(i){return i*(.5-Math.random())}function tR(i){i!==void 0&&(mw=i);let e=mw+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function nR(i){return i*wp}function iR(i){return i*u0}function rR(i){return(i&i-1)===0&&i!==0}function sR(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function aR(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function oR(i,e,t,n,r){const s=Math.cos,l=Math.sin,c=s(t/2),f=l(t/2),d=s((e+n)/2),m=l((e+n)/2),g=s((e-n)/2),y=l((e-n)/2),v=s((n-e)/2),S=l((n-e)/2);switch(r){case"XYX":i.set(c*m,f*g,f*y,c*d);break;case"YZY":i.set(f*y,c*m,f*g,c*d);break;case"ZXZ":i.set(f*g,f*y,c*m,c*d);break;case"XZX":i.set(c*m,f*S,f*v,c*d);break;case"YXY":i.set(f*v,c*m,f*S,c*d);break;case"ZYZ":i.set(f*S,f*v,c*m,c*d);break;default:Mn("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function ll(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function Pi(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const xp={DEG2RAD:wp,RAD2DEG:u0,generateUUID:Ac,clamp:oi,euclideanModulo:MS,mapLinear:WN,inverseLerp:XN,lerp:Pg,damp:YN,pingpong:ZN,smoothstep:$N,smootherstep:JN,randInt:KN,randFloat:QN,randFloatSpread:eR,seededRandom:tR,degToRad:nR,radToDeg:iR,isPowerOfTwo:rR,ceilPowerOfTwo:sR,floorPowerOfTwo:aR,setQuaternionFromProperEuler:oR,normalize:Pi,denormalize:ll};class zt{constructor(e=0,t=0){zt.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=oi(this.x,e.x,t.x),this.y=oi(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=oi(this.x,e,t),this.y=oi(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(oi(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(oi(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,l=this.y-e.y;return this.x=s*n-l*r+e.x,this.y=s*r+l*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Uo{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,s,l,c){let f=n[r+0],d=n[r+1],m=n[r+2],g=n[r+3],y=s[l+0],v=s[l+1],S=s[l+2],T=s[l+3];if(c<=0){e[t+0]=f,e[t+1]=d,e[t+2]=m,e[t+3]=g;return}if(c>=1){e[t+0]=y,e[t+1]=v,e[t+2]=S,e[t+3]=T;return}if(g!==T||f!==y||d!==v||m!==S){let A=f*y+d*v+m*S+g*T;A<0&&(y=-y,v=-v,S=-S,T=-T,A=-A);let w=1-c;if(A<.9995){const R=Math.acos(A),D=Math.sin(R);w=Math.sin(w*R)/D,c=Math.sin(c*R)/D,f=f*w+y*c,d=d*w+v*c,m=m*w+S*c,g=g*w+T*c}else{f=f*w+y*c,d=d*w+v*c,m=m*w+S*c,g=g*w+T*c;const R=1/Math.sqrt(f*f+d*d+m*m+g*g);f*=R,d*=R,m*=R,g*=R}}e[t]=f,e[t+1]=d,e[t+2]=m,e[t+3]=g}static multiplyQuaternionsFlat(e,t,n,r,s,l){const c=n[r],f=n[r+1],d=n[r+2],m=n[r+3],g=s[l],y=s[l+1],v=s[l+2],S=s[l+3];return e[t]=c*S+m*g+f*v-d*y,e[t+1]=f*S+m*y+d*g-c*v,e[t+2]=d*S+m*v+c*y-f*g,e[t+3]=m*S-c*g-f*y-d*v,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,s=e._z,l=e._order,c=Math.cos,f=Math.sin,d=c(n/2),m=c(r/2),g=c(s/2),y=f(n/2),v=f(r/2),S=f(s/2);switch(l){case"XYZ":this._x=y*m*g+d*v*S,this._y=d*v*g-y*m*S,this._z=d*m*S+y*v*g,this._w=d*m*g-y*v*S;break;case"YXZ":this._x=y*m*g+d*v*S,this._y=d*v*g-y*m*S,this._z=d*m*S-y*v*g,this._w=d*m*g+y*v*S;break;case"ZXY":this._x=y*m*g-d*v*S,this._y=d*v*g+y*m*S,this._z=d*m*S+y*v*g,this._w=d*m*g-y*v*S;break;case"ZYX":this._x=y*m*g-d*v*S,this._y=d*v*g+y*m*S,this._z=d*m*S-y*v*g,this._w=d*m*g+y*v*S;break;case"YZX":this._x=y*m*g+d*v*S,this._y=d*v*g+y*m*S,this._z=d*m*S-y*v*g,this._w=d*m*g-y*v*S;break;case"XZY":this._x=y*m*g-d*v*S,this._y=d*v*g-y*m*S,this._z=d*m*S+y*v*g,this._w=d*m*g+y*v*S;break;default:Mn("Quaternion: .setFromEuler() encountered an unknown order: "+l)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],l=t[1],c=t[5],f=t[9],d=t[2],m=t[6],g=t[10],y=n+c+g;if(y>0){const v=.5/Math.sqrt(y+1);this._w=.25/v,this._x=(m-f)*v,this._y=(s-d)*v,this._z=(l-r)*v}else if(n>c&&n>g){const v=2*Math.sqrt(1+n-c-g);this._w=(m-f)/v,this._x=.25*v,this._y=(r+l)/v,this._z=(s+d)/v}else if(c>g){const v=2*Math.sqrt(1+c-n-g);this._w=(s-d)/v,this._x=(r+l)/v,this._y=.25*v,this._z=(f+m)/v}else{const v=2*Math.sqrt(1+g-n-c);this._w=(l-r)/v,this._x=(s+d)/v,this._y=(f+m)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(oi(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,l=e._w,c=t._x,f=t._y,d=t._z,m=t._w;return this._x=n*m+l*c+r*d-s*f,this._y=r*m+l*f+s*c-n*d,this._z=s*m+l*d+n*f-r*c,this._w=l*m-n*c-r*f-s*d,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let n=e._x,r=e._y,s=e._z,l=e._w,c=this.dot(e);c<0&&(n=-n,r=-r,s=-s,l=-l,c=-c);let f=1-t;if(c<.9995){const d=Math.acos(c),m=Math.sin(d);f=Math.sin(f*d)/m,t=Math.sin(t*d)/m,this._x=this._x*f+n*t,this._y=this._y*f+r*t,this._z=this._z*f+s*t,this._w=this._w*f+l*t,this._onChangeCallback()}else this._x=this._x*f+n*t,this._y=this._y*f+r*t,this._z=this._z*f+s*t,this._w=this._w*f+l*t,this.normalize();return this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),s=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Ee{constructor(e=0,t=0,n=0){Ee.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(gw.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(gw.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,l=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*l,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*l,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*l,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,s=e.x,l=e.y,c=e.z,f=e.w,d=2*(l*r-c*n),m=2*(c*t-s*r),g=2*(s*n-l*t);return this.x=t+f*d+l*g-c*m,this.y=n+f*m+c*d-s*g,this.z=r+f*g+s*m-l*d,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=oi(this.x,e.x,t.x),this.y=oi(this.y,e.y,t.y),this.z=oi(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=oi(this.x,e,t),this.y=oi(this.y,e,t),this.z=oi(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(oi(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,l=t.x,c=t.y,f=t.z;return this.x=r*f-s*c,this.y=s*l-n*f,this.z=n*c-r*l,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Qb.copy(this).projectOnVector(e),this.sub(Qb)}reflect(e){return this.sub(Qb.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(oi(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Qb=new Ee,gw=new Uo;class Ei{constructor(e,t,n,r,s,l,c,f,d){Ei.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,l,c,f,d)}set(e,t,n,r,s,l,c,f,d){const m=this.elements;return m[0]=e,m[1]=r,m[2]=c,m[3]=t,m[4]=s,m[5]=f,m[6]=n,m[7]=l,m[8]=d,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,l=n[0],c=n[3],f=n[6],d=n[1],m=n[4],g=n[7],y=n[2],v=n[5],S=n[8],T=r[0],A=r[3],w=r[6],R=r[1],D=r[4],I=r[7],z=r[2],j=r[5],X=r[8];return s[0]=l*T+c*R+f*z,s[3]=l*A+c*D+f*j,s[6]=l*w+c*I+f*X,s[1]=d*T+m*R+g*z,s[4]=d*A+m*D+g*j,s[7]=d*w+m*I+g*X,s[2]=y*T+v*R+S*z,s[5]=y*A+v*D+S*j,s[8]=y*w+v*I+S*X,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],l=e[4],c=e[5],f=e[6],d=e[7],m=e[8];return t*l*m-t*c*d-n*s*m+n*c*f+r*s*d-r*l*f}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],l=e[4],c=e[5],f=e[6],d=e[7],m=e[8],g=m*l-c*d,y=c*f-m*s,v=d*s-l*f,S=t*g+n*y+r*v;if(S===0)return this.set(0,0,0,0,0,0,0,0,0);const T=1/S;return e[0]=g*T,e[1]=(r*d-m*n)*T,e[2]=(c*n-r*l)*T,e[3]=y*T,e[4]=(m*t-r*f)*T,e[5]=(r*s-c*t)*T,e[6]=v*T,e[7]=(n*f-d*t)*T,e[8]=(l*t-n*s)*T,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,l,c){const f=Math.cos(s),d=Math.sin(s);return this.set(n*f,n*d,-n*(f*l+d*c)+l+e,-r*d,r*f,-r*(-d*l+f*c)+c+t,0,0,1),this}scale(e,t){return this.premultiply(e5.makeScale(e,t)),this}rotate(e){return this.premultiply(e5.makeRotation(-e)),this}translate(e,t){return this.premultiply(e5.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const e5=new Ei,vw=new Ei().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),xw=new Ei().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function lR(){const i={enabled:!0,workingColorSpace:Uu,spaces:{},convert:function(r,s,l){return this.enabled===!1||s===l||!s||!l||(this.spaces[s].transfer===Ar&&(r.r=bh(r.r),r.g=bh(r.g),r.b=bh(r.b)),this.spaces[s].primaries!==this.spaces[l].primaries&&(r.applyMatrix3(this.spaces[s].toXYZ),r.applyMatrix3(this.spaces[l].fromXYZ)),this.spaces[l].transfer===Ar&&(r.r=Km(r.r),r.g=Km(r.g),r.b=Km(r.b))),r},workingToColorSpace:function(r,s){return this.convert(r,this.workingColorSpace,s)},colorSpaceToWorking:function(r,s){return this.convert(r,s,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===xh?Gg:this.spaces[r].transfer},getToneMappingMode:function(r){return this.spaces[r].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(r,s=this.workingColorSpace){return r.fromArray(this.spaces[s].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,s,l){return r.copy(this.spaces[s].toXYZ).multiply(this.spaces[l].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(r,s){return c0("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),i.workingToColorSpace(r,s)},toWorkingColorSpace:function(r,s){return c0("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),i.colorSpaceToWorking(r,s)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return i.define({[Uu]:{primaries:e,whitePoint:n,transfer:Gg,toXYZ:vw,fromXYZ:xw,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:vo},outputColorSpaceConfig:{drawingBufferColorSpace:vo}},[vo]:{primaries:e,whitePoint:n,transfer:Ar,toXYZ:vw,fromXYZ:xw,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:vo}}}),i}const nr=lR();function bh(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function Km(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}let mm;class LT{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{mm===void 0&&(mm=Wg("canvas")),mm.width=e.width,mm.height=e.height;const r=mm.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),n=mm}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Wg("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let l=0;l<s.length;l++)s[l]=bh(s[l]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(bh(t[n]/255)*255):t[n]=bh(t[n]);return{data:t,width:e.width,height:e.height}}else return Mn("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let cR=0;class cd{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:cR++}),this.uuid=Ac(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):typeof VideoFrame<"u"&&t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let l=0,c=r.length;l<c;l++)r[l].isDataTexture?s.push(t5(r[l].image)):s.push(t5(r[l]))}else s=t5(r);n.url=s}return t||(e.images[this.uuid]=n),n}}function t5(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?LT.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(Mn("Texture: Unable to serialize Texture."),{})}let uR=0;const n5=new Ee;class Fr extends Df{constructor(e=Fr.DEFAULT_IMAGE,t=Fr.DEFAULT_MAPPING,n=Js,r=Js,s=ar,l=Rf,c=xa,f=$a,d=Fr.DEFAULT_ANISOTROPY,m=xh){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:uR++}),this.uuid=Ac(),this.name="",this.source=new cd(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=s,this.minFilter=l,this.anisotropy=d,this.format=c,this.internalFormat=null,this.type=f,this.offset=new zt(0,0),this.repeat=new zt(1,1),this.center=new zt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ei,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=m,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(n5).x}get height(){return this.source.getSize(n5).y}get depth(){return this.source.getSize(n5).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){Mn(`Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){Mn(`Texture.setValues(): property '${t}' does not exist.`);continue}r&&n&&r.isVector2&&n.isVector2||r&&n&&r.isVector3&&n.isVector3||r&&n&&r.isMatrix3&&n.isMatrix3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==pd)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case zg:e.x=e.x-Math.floor(e.x);break;case Js:e.x=e.x<0?0:1;break;case jg:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case zg:e.y=e.y-Math.floor(e.y);break;case Js:e.y=e.y<0?0:1;break;case jg:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Fr.DEFAULT_IMAGE=null;Fr.DEFAULT_MAPPING=pd;Fr.DEFAULT_ANISOTROPY=1;class Yr{constructor(e=0,t=0,n=0,r=1){Yr.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=this.w,l=e.elements;return this.x=l[0]*t+l[4]*n+l[8]*r+l[12]*s,this.y=l[1]*t+l[5]*n+l[9]*r+l[13]*s,this.z=l[2]*t+l[6]*n+l[10]*r+l[14]*s,this.w=l[3]*t+l[7]*n+l[11]*r+l[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s;const f=e.elements,d=f[0],m=f[4],g=f[8],y=f[1],v=f[5],S=f[9],T=f[2],A=f[6],w=f[10];if(Math.abs(m-y)<.01&&Math.abs(g-T)<.01&&Math.abs(S-A)<.01){if(Math.abs(m+y)<.1&&Math.abs(g+T)<.1&&Math.abs(S+A)<.1&&Math.abs(d+v+w-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const D=(d+1)/2,I=(v+1)/2,z=(w+1)/2,j=(m+y)/4,X=(g+T)/4,G=(S+A)/4;return D>I&&D>z?D<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(D),r=j/n,s=X/n):I>z?I<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(I),n=j/r,s=G/r):z<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(z),n=X/s,r=G/s),this.set(n,r,s,t),this}let R=Math.sqrt((A-S)*(A-S)+(g-T)*(g-T)+(y-m)*(y-m));return Math.abs(R)<.001&&(R=1),this.x=(A-S)/R,this.y=(g-T)/R,this.z=(y-m)/R,this.w=Math.acos((d+v+w-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=oi(this.x,e.x,t.x),this.y=oi(this.y,e.y,t.y),this.z=oi(this.z,e.z,t.z),this.w=oi(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=oi(this.x,e,t),this.y=oi(this.y,e,t),this.z=oi(this.z,e,t),this.w=oi(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(oi(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class AS extends Df{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:ar,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new Yr(0,0,e,t),this.scissorTest=!1,this.viewport=new Yr(0,0,e,t);const r={width:e,height:t,depth:n.depth},s=new Fr(r);this.textures=[];const l=n.count;for(let c=0;c<l;c++)this.textures[c]=s.clone(),this.textures[c].isRenderTargetTexture=!0,this.textures[c].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:ar,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n,this.textures[r].isData3DTexture!==!0&&(this.textures[r].isArrayTexture=this.textures[r].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const r=Object.assign({},e.textures[t].image);this.textures[t].source=new cd(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class ul extends AS{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class Hy extends Fr{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=va,this.minFilter=va,this.wrapR=Js,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class fR extends ul{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new Hy(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class Gy extends Fr{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=va,this.minFilter=va,this.wrapR=Js,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class hR extends ul{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new Gy(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class Fo{constructor(e=new Ee(1/0,1/0,1/0),t=new Ee(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Nu.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Nu.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Nu.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const s=n.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let l=0,c=s.count;l<c;l++)e.isMesh===!0?e.getVertexPosition(l,Nu):Nu.fromBufferAttribute(s,l),Nu.applyMatrix4(e.matrixWorld),this.expandByPoint(Nu);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),mv.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),mv.copy(n.boundingBox)),mv.applyMatrix4(e.matrixWorld),this.union(mv)}const r=e.children;for(let s=0,l=r.length;s<l;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Nu),Nu.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(ag),gv.subVectors(this.max,ag),gm.subVectors(e.a,ag),vm.subVectors(e.b,ag),xm.subVectors(e.c,ag),Jh.subVectors(vm,gm),Kh.subVectors(xm,vm),Yd.subVectors(gm,xm);let t=[0,-Jh.z,Jh.y,0,-Kh.z,Kh.y,0,-Yd.z,Yd.y,Jh.z,0,-Jh.x,Kh.z,0,-Kh.x,Yd.z,0,-Yd.x,-Jh.y,Jh.x,0,-Kh.y,Kh.x,0,-Yd.y,Yd.x,0];return!i5(t,gm,vm,xm,gv)||(t=[1,0,0,0,1,0,0,0,1],!i5(t,gm,vm,xm,gv))?!1:(vv.crossVectors(Jh,Kh),t=[vv.x,vv.y,vv.z],i5(t,gm,vm,xm,gv))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Nu).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Nu).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(ch[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ch[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ch[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ch[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ch[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ch[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ch[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ch[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ch),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const ch=[new Ee,new Ee,new Ee,new Ee,new Ee,new Ee,new Ee,new Ee],Nu=new Ee,mv=new Fo,gm=new Ee,vm=new Ee,xm=new Ee,Jh=new Ee,Kh=new Ee,Yd=new Ee,ag=new Ee,gv=new Ee,vv=new Ee,Zd=new Ee;function i5(i,e,t,n,r){for(let s=0,l=i.length-3;s<=l;s+=3){Zd.fromArray(i,s);const c=r.x*Math.abs(Zd.x)+r.y*Math.abs(Zd.y)+r.z*Math.abs(Zd.z),f=e.dot(Zd),d=t.dot(Zd),m=n.dot(Zd);if(Math.max(-Math.max(f,d,m),Math.min(f,d,m))>c)return!1}return!0}const dR=new Fo,og=new Ee,r5=new Ee;class xo{constructor(e=new Ee,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):dR.setFromPoints(e).getCenter(n);let r=0;for(let s=0,l=e.length;s<l;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;og.subVectors(e,this.center);const t=og.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(og,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(r5.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(og.copy(e.center).add(r5)),this.expandByPoint(og.copy(e.center).sub(r5))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const uh=new Ee,s5=new Ee,xv=new Ee,Qh=new Ee,a5=new Ee,yv=new Ee,o5=new Ee;class Ip{constructor(e=new Ee,t=new Ee(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,uh)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=uh.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(uh.copy(this.origin).addScaledVector(this.direction,t),uh.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){s5.copy(e).add(t).multiplyScalar(.5),xv.copy(t).sub(e).normalize(),Qh.copy(this.origin).sub(s5);const s=e.distanceTo(t)*.5,l=-this.direction.dot(xv),c=Qh.dot(this.direction),f=-Qh.dot(xv),d=Qh.lengthSq(),m=Math.abs(1-l*l);let g,y,v,S;if(m>0)if(g=l*f-c,y=l*c-f,S=s*m,g>=0)if(y>=-S)if(y<=S){const T=1/m;g*=T,y*=T,v=g*(g+l*y+2*c)+y*(l*g+y+2*f)+d}else y=s,g=Math.max(0,-(l*y+c)),v=-g*g+y*(y+2*f)+d;else y=-s,g=Math.max(0,-(l*y+c)),v=-g*g+y*(y+2*f)+d;else y<=-S?(g=Math.max(0,-(-l*s+c)),y=g>0?-s:Math.min(Math.max(-s,-f),s),v=-g*g+y*(y+2*f)+d):y<=S?(g=0,y=Math.min(Math.max(-s,-f),s),v=y*(y+2*f)+d):(g=Math.max(0,-(l*s+c)),y=g>0?s:Math.min(Math.max(-s,-f),s),v=-g*g+y*(y+2*f)+d);else y=l>0?-s:s,g=Math.max(0,-(l*y+c)),v=-g*g+y*(y+2*f)+d;return n&&n.copy(this.origin).addScaledVector(this.direction,g),r&&r.copy(s5).addScaledVector(xv,y),v}intersectSphere(e,t){uh.subVectors(e.center,this.origin);const n=uh.dot(this.direction),r=uh.dot(uh)-n*n,s=e.radius*e.radius;if(r>s)return null;const l=Math.sqrt(s-r),c=n-l,f=n+l;return f<0?null:c<0?this.at(f,t):this.at(c,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,l,c,f;const d=1/this.direction.x,m=1/this.direction.y,g=1/this.direction.z,y=this.origin;return d>=0?(n=(e.min.x-y.x)*d,r=(e.max.x-y.x)*d):(n=(e.max.x-y.x)*d,r=(e.min.x-y.x)*d),m>=0?(s=(e.min.y-y.y)*m,l=(e.max.y-y.y)*m):(s=(e.max.y-y.y)*m,l=(e.min.y-y.y)*m),n>l||s>r||((s>n||isNaN(n))&&(n=s),(l<r||isNaN(r))&&(r=l),g>=0?(c=(e.min.z-y.z)*g,f=(e.max.z-y.z)*g):(c=(e.max.z-y.z)*g,f=(e.min.z-y.z)*g),n>f||c>r)||((c>n||n!==n)&&(n=c),(f<r||r!==r)&&(r=f),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,uh)!==null}intersectTriangle(e,t,n,r,s){a5.subVectors(t,e),yv.subVectors(n,e),o5.crossVectors(a5,yv);let l=this.direction.dot(o5),c;if(l>0){if(r)return null;c=1}else if(l<0)c=-1,l=-l;else return null;Qh.subVectors(this.origin,e);const f=c*this.direction.dot(yv.crossVectors(Qh,yv));if(f<0)return null;const d=c*this.direction.dot(a5.cross(Qh));if(d<0||f+d>l)return null;const m=-c*Qh.dot(o5);return m<0?null:this.at(m/l,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class ui{constructor(e,t,n,r,s,l,c,f,d,m,g,y,v,S,T,A){ui.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,l,c,f,d,m,g,y,v,S,T,A)}set(e,t,n,r,s,l,c,f,d,m,g,y,v,S,T,A){const w=this.elements;return w[0]=e,w[4]=t,w[8]=n,w[12]=r,w[1]=s,w[5]=l,w[9]=c,w[13]=f,w[2]=d,w[6]=m,w[10]=g,w[14]=y,w[3]=v,w[7]=S,w[11]=T,w[15]=A,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ui().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return this.determinant()===0?(e.set(1,0,0),t.set(0,1,0),n.set(0,0,1),this):(e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this)}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){if(e.determinant()===0)return this.identity();const t=this.elements,n=e.elements,r=1/ym.setFromMatrixColumn(e,0).length(),s=1/ym.setFromMatrixColumn(e,1).length(),l=1/ym.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*l,t[9]=n[9]*l,t[10]=n[10]*l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,s=e.z,l=Math.cos(n),c=Math.sin(n),f=Math.cos(r),d=Math.sin(r),m=Math.cos(s),g=Math.sin(s);if(e.order==="XYZ"){const y=l*m,v=l*g,S=c*m,T=c*g;t[0]=f*m,t[4]=-f*g,t[8]=d,t[1]=v+S*d,t[5]=y-T*d,t[9]=-c*f,t[2]=T-y*d,t[6]=S+v*d,t[10]=l*f}else if(e.order==="YXZ"){const y=f*m,v=f*g,S=d*m,T=d*g;t[0]=y+T*c,t[4]=S*c-v,t[8]=l*d,t[1]=l*g,t[5]=l*m,t[9]=-c,t[2]=v*c-S,t[6]=T+y*c,t[10]=l*f}else if(e.order==="ZXY"){const y=f*m,v=f*g,S=d*m,T=d*g;t[0]=y-T*c,t[4]=-l*g,t[8]=S+v*c,t[1]=v+S*c,t[5]=l*m,t[9]=T-y*c,t[2]=-l*d,t[6]=c,t[10]=l*f}else if(e.order==="ZYX"){const y=l*m,v=l*g,S=c*m,T=c*g;t[0]=f*m,t[4]=S*d-v,t[8]=y*d+T,t[1]=f*g,t[5]=T*d+y,t[9]=v*d-S,t[2]=-d,t[6]=c*f,t[10]=l*f}else if(e.order==="YZX"){const y=l*f,v=l*d,S=c*f,T=c*d;t[0]=f*m,t[4]=T-y*g,t[8]=S*g+v,t[1]=g,t[5]=l*m,t[9]=-c*m,t[2]=-d*m,t[6]=v*g+S,t[10]=y-T*g}else if(e.order==="XZY"){const y=l*f,v=l*d,S=c*f,T=c*d;t[0]=f*m,t[4]=-g,t[8]=d*m,t[1]=y*g+T,t[5]=l*m,t[9]=v*g-S,t[2]=S*g-v,t[6]=c*m,t[10]=T*g+y}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(pR,e,mR)}lookAt(e,t,n){const r=this.elements;return bc.subVectors(e,t),bc.lengthSq()===0&&(bc.z=1),bc.normalize(),ed.crossVectors(n,bc),ed.lengthSq()===0&&(Math.abs(n.z)===1?bc.x+=1e-4:bc.z+=1e-4,bc.normalize(),ed.crossVectors(n,bc)),ed.normalize(),bv.crossVectors(bc,ed),r[0]=ed.x,r[4]=bv.x,r[8]=bc.x,r[1]=ed.y,r[5]=bv.y,r[9]=bc.y,r[2]=ed.z,r[6]=bv.z,r[10]=bc.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,l=n[0],c=n[4],f=n[8],d=n[12],m=n[1],g=n[5],y=n[9],v=n[13],S=n[2],T=n[6],A=n[10],w=n[14],R=n[3],D=n[7],I=n[11],z=n[15],j=r[0],X=r[4],G=r[8],L=r[12],k=r[1],U=r[5],q=r[9],W=r[13],J=r[2],ce=r[6],K=r[10],ne=r[14],pe=r[3],Re=r[7],Te=r[11],ee=r[15];return s[0]=l*j+c*k+f*J+d*pe,s[4]=l*X+c*U+f*ce+d*Re,s[8]=l*G+c*q+f*K+d*Te,s[12]=l*L+c*W+f*ne+d*ee,s[1]=m*j+g*k+y*J+v*pe,s[5]=m*X+g*U+y*ce+v*Re,s[9]=m*G+g*q+y*K+v*Te,s[13]=m*L+g*W+y*ne+v*ee,s[2]=S*j+T*k+A*J+w*pe,s[6]=S*X+T*U+A*ce+w*Re,s[10]=S*G+T*q+A*K+w*Te,s[14]=S*L+T*W+A*ne+w*ee,s[3]=R*j+D*k+I*J+z*pe,s[7]=R*X+D*U+I*ce+z*Re,s[11]=R*G+D*q+I*K+z*Te,s[15]=R*L+D*W+I*ne+z*ee,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],l=e[1],c=e[5],f=e[9],d=e[13],m=e[2],g=e[6],y=e[10],v=e[14],S=e[3],T=e[7],A=e[11],w=e[15],R=f*v-d*y,D=c*v-d*g,I=c*y-f*g,z=l*v-d*m,j=l*y-f*m,X=l*g-c*m;return t*(T*R-A*D+w*I)-n*(S*R-A*z+w*j)+r*(S*D-T*z+w*X)-s*(S*I-T*j+A*X)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],l=e[4],c=e[5],f=e[6],d=e[7],m=e[8],g=e[9],y=e[10],v=e[11],S=e[12],T=e[13],A=e[14],w=e[15],R=g*A*d-T*y*d+T*f*v-c*A*v-g*f*w+c*y*w,D=S*y*d-m*A*d-S*f*v+l*A*v+m*f*w-l*y*w,I=m*T*d-S*g*d+S*c*v-l*T*v-m*c*w+l*g*w,z=S*g*f-m*T*f-S*c*y+l*T*y+m*c*A-l*g*A,j=t*R+n*D+r*I+s*z;if(j===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const X=1/j;return e[0]=R*X,e[1]=(T*y*s-g*A*s-T*r*v+n*A*v+g*r*w-n*y*w)*X,e[2]=(c*A*s-T*f*s+T*r*d-n*A*d-c*r*w+n*f*w)*X,e[3]=(g*f*s-c*y*s-g*r*d+n*y*d+c*r*v-n*f*v)*X,e[4]=D*X,e[5]=(m*A*s-S*y*s+S*r*v-t*A*v-m*r*w+t*y*w)*X,e[6]=(S*f*s-l*A*s-S*r*d+t*A*d+l*r*w-t*f*w)*X,e[7]=(l*y*s-m*f*s+m*r*d-t*y*d-l*r*v+t*f*v)*X,e[8]=I*X,e[9]=(S*g*s-m*T*s-S*n*v+t*T*v+m*n*w-t*g*w)*X,e[10]=(l*T*s-S*c*s+S*n*d-t*T*d-l*n*w+t*c*w)*X,e[11]=(m*c*s-l*g*s-m*n*d+t*g*d+l*n*v-t*c*v)*X,e[12]=z*X,e[13]=(m*T*r-S*g*r+S*n*y-t*T*y-m*n*A+t*g*A)*X,e[14]=(S*c*r-l*T*r-S*n*f+t*T*f+l*n*A-t*c*A)*X,e[15]=(l*g*r-m*c*r+m*n*f-t*g*f-l*n*y+t*c*y)*X,this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),s=1-n,l=e.x,c=e.y,f=e.z,d=s*l,m=s*c;return this.set(d*l+n,d*c-r*f,d*f+r*c,0,d*c+r*f,m*c+n,m*f-r*l,0,d*f-r*c,m*f+r*l,s*f*f+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,l){return this.set(1,n,s,0,e,1,l,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,s=t._x,l=t._y,c=t._z,f=t._w,d=s+s,m=l+l,g=c+c,y=s*d,v=s*m,S=s*g,T=l*m,A=l*g,w=c*g,R=f*d,D=f*m,I=f*g,z=n.x,j=n.y,X=n.z;return r[0]=(1-(T+w))*z,r[1]=(v+I)*z,r[2]=(S-D)*z,r[3]=0,r[4]=(v-I)*j,r[5]=(1-(y+w))*j,r[6]=(A+R)*j,r[7]=0,r[8]=(S+D)*X,r[9]=(A-R)*X,r[10]=(1-(y+T))*X,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;if(e.x=r[12],e.y=r[13],e.z=r[14],this.determinant()===0)return n.set(1,1,1),t.identity(),this;let s=ym.set(r[0],r[1],r[2]).length();const l=ym.set(r[4],r[5],r[6]).length(),c=ym.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),Ru.copy(this);const d=1/s,m=1/l,g=1/c;return Ru.elements[0]*=d,Ru.elements[1]*=d,Ru.elements[2]*=d,Ru.elements[4]*=m,Ru.elements[5]*=m,Ru.elements[6]*=m,Ru.elements[8]*=g,Ru.elements[9]*=g,Ru.elements[10]*=g,t.setFromRotationMatrix(Ru),n.x=s,n.y=l,n.z=c,this}makePerspective(e,t,n,r,s,l,c=wc,f=!1){const d=this.elements,m=2*s/(t-e),g=2*s/(n-r),y=(t+e)/(t-e),v=(n+r)/(n-r);let S,T;if(f)S=s/(l-s),T=l*s/(l-s);else if(c===wc)S=-(l+s)/(l-s),T=-2*l*s/(l-s);else if(c===l0)S=-l/(l-s),T=-l*s/(l-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+c);return d[0]=m,d[4]=0,d[8]=y,d[12]=0,d[1]=0,d[5]=g,d[9]=v,d[13]=0,d[2]=0,d[6]=0,d[10]=S,d[14]=T,d[3]=0,d[7]=0,d[11]=-1,d[15]=0,this}makeOrthographic(e,t,n,r,s,l,c=wc,f=!1){const d=this.elements,m=2/(t-e),g=2/(n-r),y=-(t+e)/(t-e),v=-(n+r)/(n-r);let S,T;if(f)S=1/(l-s),T=l/(l-s);else if(c===wc)S=-2/(l-s),T=-(l+s)/(l-s);else if(c===l0)S=-1/(l-s),T=-s/(l-s);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+c);return d[0]=m,d[4]=0,d[8]=0,d[12]=y,d[1]=0,d[5]=g,d[9]=0,d[13]=v,d[2]=0,d[6]=0,d[10]=S,d[14]=T,d[3]=0,d[7]=0,d[11]=0,d[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const ym=new Ee,Ru=new ui,pR=new Ee(0,0,0),mR=new Ee(1,1,1),ed=new Ee,bv=new Ee,bc=new Ee,yw=new ui,bw=new Uo;class Cc{constructor(e=0,t=0,n=0,r=Cc.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,s=r[0],l=r[4],c=r[8],f=r[1],d=r[5],m=r[9],g=r[2],y=r[6],v=r[10];switch(t){case"XYZ":this._y=Math.asin(oi(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-m,v),this._z=Math.atan2(-l,s)):(this._x=Math.atan2(y,d),this._z=0);break;case"YXZ":this._x=Math.asin(-oi(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(c,v),this._z=Math.atan2(f,d)):(this._y=Math.atan2(-g,s),this._z=0);break;case"ZXY":this._x=Math.asin(oi(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(-g,v),this._z=Math.atan2(-l,d)):(this._y=0,this._z=Math.atan2(f,s));break;case"ZYX":this._y=Math.asin(-oi(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(y,v),this._z=Math.atan2(f,s)):(this._x=0,this._z=Math.atan2(-l,d));break;case"YZX":this._z=Math.asin(oi(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-m,d),this._y=Math.atan2(-g,s)):(this._x=0,this._y=Math.atan2(c,v));break;case"XZY":this._z=Math.asin(-oi(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(y,d),this._y=Math.atan2(c,s)):(this._x=Math.atan2(-m,v),this._y=0);break;default:Mn("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return yw.makeRotationFromQuaternion(e),this.setFromRotationMatrix(yw,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return bw.setFromEuler(this),this.setFromQuaternion(bw,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Cc.DEFAULT_ORDER="XYZ";class f0{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let gR=0;const _w=new Ee,bm=new Uo,fh=new ui,_v=new Ee,lg=new Ee,vR=new Ee,xR=new Uo,Sw=new Ee(1,0,0),ww=new Ee(0,1,0),Mw=new Ee(0,0,1),Aw={type:"added"},yR={type:"removed"},_m={type:"childadded",child:null},l5={type:"childremoved",child:null};class Oi extends Df{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:gR++}),this.uuid=Ac(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Oi.DEFAULT_UP.clone();const e=new Ee,t=new Cc,n=new Uo,r=new Ee(1,1,1);function s(){n.setFromEuler(t,!1)}function l(){t.setFromQuaternion(n,void 0,!1)}t._onChange(s),n._onChange(l),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new ui},normalMatrix:{value:new Ei}}),this.matrix=new ui,this.matrixWorld=new ui,this.matrixAutoUpdate=Oi.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Oi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new f0,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return bm.setFromAxisAngle(e,t),this.quaternion.multiply(bm),this}rotateOnWorldAxis(e,t){return bm.setFromAxisAngle(e,t),this.quaternion.premultiply(bm),this}rotateX(e){return this.rotateOnAxis(Sw,e)}rotateY(e){return this.rotateOnAxis(ww,e)}rotateZ(e){return this.rotateOnAxis(Mw,e)}translateOnAxis(e,t){return _w.copy(e).applyQuaternion(this.quaternion),this.position.add(_w.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Sw,e)}translateY(e){return this.translateOnAxis(ww,e)}translateZ(e){return this.translateOnAxis(Mw,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(fh.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?_v.copy(e):_v.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),lg.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?fh.lookAt(lg,_v,this.up):fh.lookAt(_v,lg,this.up),this.quaternion.setFromRotationMatrix(fh),r&&(fh.extractRotation(r.matrixWorld),bm.setFromRotationMatrix(fh),this.quaternion.premultiply(bm.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(Hn("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Aw),_m.child=e,this.dispatchEvent(_m),_m.child=null):Hn("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(yR),l5.child=e,this.dispatchEvent(l5),l5.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),fh.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),fh.multiply(e.parent.matrixWorld)),e.applyMatrix4(fh),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Aw),_m.child=e,this.dispatchEvent(_m),_m.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const l=this.children[n].getObjectByProperty(e,t);if(l!==void 0)return l}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let s=0,l=r.length;s<l;s++)r[s].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(lg,e,vR),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(lg,xR,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let s=0,l=r.length;s<l;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(c=>({...c,boundingBox:c.boundingBox?c.boundingBox.toJSON():void 0,boundingSphere:c.boundingSphere?c.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(c=>({...c})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(r.boundingBox=this.boundingBox.toJSON()));function s(c,f){return c[f.uuid]===void 0&&(c[f.uuid]=f.toJSON(e)),f.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){const f=c.shapes;if(Array.isArray(f))for(let d=0,m=f.length;d<m;d++){const g=f[d];s(e.shapes,g)}else s(e.shapes,f)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const c=[];for(let f=0,d=this.material.length;f<d;f++)c.push(s(e.materials,this.material[f]));r.material=c}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let c=0;c<this.children.length;c++)r.children.push(this.children[c].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let c=0;c<this.animations.length;c++){const f=this.animations[c];r.animations.push(s(e.animations,f))}}if(t){const c=l(e.geometries),f=l(e.materials),d=l(e.textures),m=l(e.images),g=l(e.shapes),y=l(e.skeletons),v=l(e.animations),S=l(e.nodes);c.length>0&&(n.geometries=c),f.length>0&&(n.materials=f),d.length>0&&(n.textures=d),m.length>0&&(n.images=m),g.length>0&&(n.shapes=g),y.length>0&&(n.skeletons=y),v.length>0&&(n.animations=v),S.length>0&&(n.nodes=S)}return n.object=r,n;function l(c){const f=[];for(const d in c){const m=c[d];delete m.metadata,f.push(m)}return f}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}}Oi.DEFAULT_UP=new Ee(0,1,0);Oi.DEFAULT_MATRIX_AUTO_UPDATE=!0;Oi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Lu=new Ee,hh=new Ee,c5=new Ee,dh=new Ee,Sm=new Ee,wm=new Ee,Tw=new Ee,u5=new Ee,f5=new Ee,h5=new Ee,d5=new Yr,p5=new Yr,m5=new Yr;class Xl{constructor(e=new Ee,t=new Ee,n=new Ee){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Lu.subVectors(e,t),r.cross(Lu);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){Lu.subVectors(r,t),hh.subVectors(n,t),c5.subVectors(e,t);const l=Lu.dot(Lu),c=Lu.dot(hh),f=Lu.dot(c5),d=hh.dot(hh),m=hh.dot(c5),g=l*d-c*c;if(g===0)return s.set(0,0,0),null;const y=1/g,v=(d*f-c*m)*y,S=(l*m-c*f)*y;return s.set(1-v-S,S,v)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,dh)===null?!1:dh.x>=0&&dh.y>=0&&dh.x+dh.y<=1}static getInterpolation(e,t,n,r,s,l,c,f){return this.getBarycoord(e,t,n,r,dh)===null?(f.x=0,f.y=0,"z"in f&&(f.z=0),"w"in f&&(f.w=0),null):(f.setScalar(0),f.addScaledVector(s,dh.x),f.addScaledVector(l,dh.y),f.addScaledVector(c,dh.z),f)}static getInterpolatedAttribute(e,t,n,r,s,l){return d5.setScalar(0),p5.setScalar(0),m5.setScalar(0),d5.fromBufferAttribute(e,t),p5.fromBufferAttribute(e,n),m5.fromBufferAttribute(e,r),l.setScalar(0),l.addScaledVector(d5,s.x),l.addScaledVector(p5,s.y),l.addScaledVector(m5,s.z),l}static isFrontFacing(e,t,n,r){return Lu.subVectors(n,t),hh.subVectors(e,t),Lu.cross(hh).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Lu.subVectors(this.c,this.b),hh.subVectors(this.a,this.b),Lu.cross(hh).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Xl.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Xl.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,s){return Xl.getInterpolation(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return Xl.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Xl.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,s=this.c;let l,c;Sm.subVectors(r,n),wm.subVectors(s,n),u5.subVectors(e,n);const f=Sm.dot(u5),d=wm.dot(u5);if(f<=0&&d<=0)return t.copy(n);f5.subVectors(e,r);const m=Sm.dot(f5),g=wm.dot(f5);if(m>=0&&g<=m)return t.copy(r);const y=f*g-m*d;if(y<=0&&f>=0&&m<=0)return l=f/(f-m),t.copy(n).addScaledVector(Sm,l);h5.subVectors(e,s);const v=Sm.dot(h5),S=wm.dot(h5);if(S>=0&&v<=S)return t.copy(s);const T=v*d-f*S;if(T<=0&&d>=0&&S<=0)return c=d/(d-S),t.copy(n).addScaledVector(wm,c);const A=m*S-v*g;if(A<=0&&g-m>=0&&v-S>=0)return Tw.subVectors(s,r),c=(g-m)/(g-m+(v-S)),t.copy(r).addScaledVector(Tw,c);const w=1/(A+T+y);return l=T*w,c=y*w,t.copy(n).addScaledVector(Sm,l).addScaledVector(wm,c)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const PT={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},td={h:0,s:0,l:0},Sv={h:0,s:0,l:0};function g5(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}class fn{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=vo){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,nr.colorSpaceToWorking(this,t),this}setRGB(e,t,n,r=nr.workingColorSpace){return this.r=e,this.g=t,this.b=n,nr.colorSpaceToWorking(this,r),this}setHSL(e,t,n,r=nr.workingColorSpace){if(e=MS(e,1),t=oi(t,0,1),n=oi(n,0,1),t===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+t):n+t-n*t,l=2*n-s;this.r=g5(l,s,e+1/3),this.g=g5(l,s,e),this.b=g5(l,s,e-1/3)}return nr.colorSpaceToWorking(this,r),this}setStyle(e,t=vo){function n(s){s!==void 0&&parseFloat(s)<1&&Mn("Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const l=r[1],c=r[2];switch(l){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:Mn("Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],l=s.length;if(l===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(l===6)return this.setHex(parseInt(s,16),t);Mn("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=vo){const n=PT[e.toLowerCase()];return n!==void 0?this.setHex(n,t):Mn("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=bh(e.r),this.g=bh(e.g),this.b=bh(e.b),this}copyLinearToSRGB(e){return this.r=Km(e.r),this.g=Km(e.g),this.b=Km(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=vo){return nr.workingToColorSpace(Po.copy(this),e),Math.round(oi(Po.r*255,0,255))*65536+Math.round(oi(Po.g*255,0,255))*256+Math.round(oi(Po.b*255,0,255))}getHexString(e=vo){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=nr.workingColorSpace){nr.workingToColorSpace(Po.copy(this),t);const n=Po.r,r=Po.g,s=Po.b,l=Math.max(n,r,s),c=Math.min(n,r,s);let f,d;const m=(c+l)/2;if(c===l)f=0,d=0;else{const g=l-c;switch(d=m<=.5?g/(l+c):g/(2-l-c),l){case n:f=(r-s)/g+(r<s?6:0);break;case r:f=(s-n)/g+2;break;case s:f=(n-r)/g+4;break}f/=6}return e.h=f,e.s=d,e.l=m,e}getRGB(e,t=nr.workingColorSpace){return nr.workingToColorSpace(Po.copy(this),t),e.r=Po.r,e.g=Po.g,e.b=Po.b,e}getStyle(e=vo){nr.workingToColorSpace(Po.copy(this),e);const t=Po.r,n=Po.g,r=Po.b;return e!==vo?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(td),this.setHSL(td.h+e,td.s+t,td.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(td),e.getHSL(Sv);const n=Pg(td.h,Sv.h,t),r=Pg(td.s,Sv.s,t),s=Pg(td.l,Sv.l,t);return this.setHSL(n,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*n+s[6]*r,this.g=s[1]*t+s[4]*n+s[7]*r,this.b=s[2]*t+s[5]*n+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Po=new fn;fn.NAMES=PT;let bR=0;class zo extends Df{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:bR++}),this.uuid=Ac(),this.name="",this.type="Material",this.blending=Sp,this.side=_h,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Rx,this.blendDst=Lx,this.blendEquation=od,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new fn(0,0,0),this.blendAlpha=0,this.depthFunc=Tp,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=R_,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=fp,this.stencilZFail=fp,this.stencilZPass=fp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){Mn(`Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){Mn(`Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Sp&&(n.blending=this.blending),this.side!==_h&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==Rx&&(n.blendSrc=this.blendSrc),this.blendDst!==Lx&&(n.blendDst=this.blendDst),this.blendEquation!==od&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==Tp&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==R_&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==fp&&(n.stencilFail=this.stencilFail),this.stencilZFail!==fp&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==fp&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.allowOverride===!1&&(n.allowOverride=!1),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(s){const l=[];for(const c in s){const f=s[c];delete f.metadata,l.push(f)}return l}if(t){const s=r(e.textures),l=r(e.images);s.length>0&&(n.textures=s),l.length>0&&(n.images=l)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const r=t.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class kf extends zo{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new fn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Cc,this.combine=c1,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const yh=_R();function _R(){const i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),r=new Uint32Array(512);for(let f=0;f<256;++f){const d=f-127;d<-27?(n[f]=0,n[f|256]=32768,r[f]=24,r[f|256]=24):d<-14?(n[f]=1024>>-d-14,n[f|256]=1024>>-d-14|32768,r[f]=-d-1,r[f|256]=-d-1):d<=15?(n[f]=d+15<<10,n[f|256]=d+15<<10|32768,r[f]=13,r[f|256]=13):d<128?(n[f]=31744,n[f|256]=64512,r[f]=24,r[f|256]=24):(n[f]=31744,n[f|256]=64512,r[f]=13,r[f|256]=13)}const s=new Uint32Array(2048),l=new Uint32Array(64),c=new Uint32Array(64);for(let f=1;f<1024;++f){let d=f<<13,m=0;for(;(d&8388608)===0;)d<<=1,m-=8388608;d&=-8388609,m+=947912704,s[f]=d|m}for(let f=1024;f<2048;++f)s[f]=939524096+(f-1024<<13);for(let f=1;f<31;++f)l[f]=f<<23;l[31]=1199570944,l[32]=2147483648;for(let f=33;f<63;++f)l[f]=2147483648+(f-32<<23);l[63]=3347054592;for(let f=1;f<64;++f)f!==32&&(c[f]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:s,exponentTable:l,offsetTable:c}}function Wl(i){Math.abs(i)>65504&&Mn("DataUtils.toHalfFloat(): Value out of range."),i=oi(i,-65504,65504),yh.floatView[0]=i;const e=yh.uint32View[0],t=e>>23&511;return yh.baseTable[t]+((e&8388607)>>yh.shiftTable[t])}function wg(i){const e=i>>10;return yh.uint32View[0]=yh.mantissaTable[yh.offsetTable[e]+(i&1023)]+yh.exponentTable[e],yh.floatView[0]}class yp{static toHalfFloat(e){return Wl(e)}static fromHalfFloat(e){return wg(e)}}const Ta=new Ee,wv=new zt;let SR=0;class zr{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:SR++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=qg,this.updateRanges=[],this.gpuType=Cs,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)wv.fromBufferAttribute(this,t),wv.applyMatrix3(e),this.setXY(t,wv.x,wv.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)Ta.fromBufferAttribute(this,t),Ta.applyMatrix3(e),this.setXYZ(t,Ta.x,Ta.y,Ta.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Ta.fromBufferAttribute(this,t),Ta.applyMatrix4(e),this.setXYZ(t,Ta.x,Ta.y,Ta.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Ta.fromBufferAttribute(this,t),Ta.applyNormalMatrix(e),this.setXYZ(t,Ta.x,Ta.y,Ta.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Ta.fromBufferAttribute(this,t),Ta.transformDirection(e),this.setXYZ(t,Ta.x,Ta.y,Ta.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=ll(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Pi(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=ll(t,this.array)),t}setX(e,t){return this.normalized&&(t=Pi(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=ll(t,this.array)),t}setY(e,t){return this.normalized&&(t=Pi(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=ll(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Pi(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=ll(t,this.array)),t}setW(e,t){return this.normalized&&(t=Pi(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Pi(t,this.array),n=Pi(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Pi(t,this.array),n=Pi(n,this.array),r=Pi(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=Pi(t,this.array),n=Pi(n,this.array),r=Pi(r,this.array),s=Pi(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==qg&&(e.usage=this.usage),e}}class wR extends zr{constructor(e,t,n){super(new Int8Array(e),t,n)}}class MR extends zr{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class AR extends zr{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class TR extends zr{constructor(e,t,n){super(new Int16Array(e),t,n)}}class TS extends zr{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class ER extends zr{constructor(e,t,n){super(new Int32Array(e),t,n)}}class ES extends zr{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class CR extends zr{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=wg(this.array[e*this.itemSize]);return this.normalized&&(t=ll(t,this.array)),t}setX(e,t){return this.normalized&&(t=Pi(t,this.array)),this.array[e*this.itemSize]=Wl(t),this}getY(e){let t=wg(this.array[e*this.itemSize+1]);return this.normalized&&(t=ll(t,this.array)),t}setY(e,t){return this.normalized&&(t=Pi(t,this.array)),this.array[e*this.itemSize+1]=Wl(t),this}getZ(e){let t=wg(this.array[e*this.itemSize+2]);return this.normalized&&(t=ll(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Pi(t,this.array)),this.array[e*this.itemSize+2]=Wl(t),this}getW(e){let t=wg(this.array[e*this.itemSize+3]);return this.normalized&&(t=ll(t,this.array)),t}setW(e,t){return this.normalized&&(t=Pi(t,this.array)),this.array[e*this.itemSize+3]=Wl(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Pi(t,this.array),n=Pi(n,this.array)),this.array[e+0]=Wl(t),this.array[e+1]=Wl(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Pi(t,this.array),n=Pi(n,this.array),r=Pi(r,this.array)),this.array[e+0]=Wl(t),this.array[e+1]=Wl(n),this.array[e+2]=Wl(r),this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=Pi(t,this.array),n=Pi(n,this.array),r=Pi(r,this.array),s=Pi(s,this.array)),this.array[e+0]=Wl(t),this.array[e+1]=Wl(n),this.array[e+2]=Wl(r),this.array[e+3]=Wl(s),this}}class kn extends zr{constructor(e,t,n){super(new Float32Array(e),t,n)}}let NR=0;const tu=new ui,v5=new Oi,Mm=new Ee,_c=new Fo,cg=new Fo,Xa=new Ee;class Si extends Df{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:NR++}),this.uuid=Ac(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(CT(e)?ES:TS)(e,1):this.index=e,this}setIndirect(e,t=0){return this.indirect=e,this.indirectOffset=t,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new Ei().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return tu.makeRotationFromQuaternion(e),this.applyMatrix4(tu),this}rotateX(e){return tu.makeRotationX(e),this.applyMatrix4(tu),this}rotateY(e){return tu.makeRotationY(e),this.applyMatrix4(tu),this}rotateZ(e){return tu.makeRotationZ(e),this.applyMatrix4(tu),this}translate(e,t,n){return tu.makeTranslation(e,t,n),this.applyMatrix4(tu),this}scale(e,t,n){return tu.makeScale(e,t,n),this.applyMatrix4(tu),this}lookAt(e){return v5.lookAt(e),v5.updateMatrix(),this.applyMatrix4(v5.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Mm).negate(),this.translate(Mm.x,Mm.y,Mm.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let r=0,s=e.length;r<s;r++){const l=e[r];n.push(l.x,l.y,l.z||0)}this.setAttribute("position",new kn(n,3))}else{const n=Math.min(e.length,t.count);for(let r=0;r<n;r++){const s=e[r];t.setXYZ(r,s.x,s.y,s.z||0)}e.length>t.count&&Mn("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Fo);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Hn("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Ee(-1/0,-1/0,-1/0),new Ee(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const s=t[n];_c.setFromBufferAttribute(s),this.morphTargetsRelative?(Xa.addVectors(this.boundingBox.min,_c.min),this.boundingBox.expandByPoint(Xa),Xa.addVectors(this.boundingBox.max,_c.max),this.boundingBox.expandByPoint(Xa)):(this.boundingBox.expandByPoint(_c.min),this.boundingBox.expandByPoint(_c.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&Hn('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new xo);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Hn("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Ee,1/0);return}if(e){const n=this.boundingSphere.center;if(_c.setFromBufferAttribute(e),t)for(let s=0,l=t.length;s<l;s++){const c=t[s];cg.setFromBufferAttribute(c),this.morphTargetsRelative?(Xa.addVectors(_c.min,cg.min),_c.expandByPoint(Xa),Xa.addVectors(_c.max,cg.max),_c.expandByPoint(Xa)):(_c.expandByPoint(cg.min),_c.expandByPoint(cg.max))}_c.getCenter(n);let r=0;for(let s=0,l=e.count;s<l;s++)Xa.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(Xa));if(t)for(let s=0,l=t.length;s<l;s++){const c=t[s],f=this.morphTargetsRelative;for(let d=0,m=c.count;d<m;d++)Xa.fromBufferAttribute(c,d),f&&(Mm.fromBufferAttribute(e,d),Xa.add(Mm)),r=Math.max(r,n.distanceToSquared(Xa))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&Hn('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){Hn("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,r=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new zr(new Float32Array(4*n.count),4));const l=this.getAttribute("tangent"),c=[],f=[];for(let G=0;G<n.count;G++)c[G]=new Ee,f[G]=new Ee;const d=new Ee,m=new Ee,g=new Ee,y=new zt,v=new zt,S=new zt,T=new Ee,A=new Ee;function w(G,L,k){d.fromBufferAttribute(n,G),m.fromBufferAttribute(n,L),g.fromBufferAttribute(n,k),y.fromBufferAttribute(s,G),v.fromBufferAttribute(s,L),S.fromBufferAttribute(s,k),m.sub(d),g.sub(d),v.sub(y),S.sub(y);const U=1/(v.x*S.y-S.x*v.y);isFinite(U)&&(T.copy(m).multiplyScalar(S.y).addScaledVector(g,-v.y).multiplyScalar(U),A.copy(g).multiplyScalar(v.x).addScaledVector(m,-S.x).multiplyScalar(U),c[G].add(T),c[L].add(T),c[k].add(T),f[G].add(A),f[L].add(A),f[k].add(A))}let R=this.groups;R.length===0&&(R=[{start:0,count:e.count}]);for(let G=0,L=R.length;G<L;++G){const k=R[G],U=k.start,q=k.count;for(let W=U,J=U+q;W<J;W+=3)w(e.getX(W+0),e.getX(W+1),e.getX(W+2))}const D=new Ee,I=new Ee,z=new Ee,j=new Ee;function X(G){z.fromBufferAttribute(r,G),j.copy(z);const L=c[G];D.copy(L),D.sub(z.multiplyScalar(z.dot(L))).normalize(),I.crossVectors(j,L);const U=I.dot(f[G])<0?-1:1;l.setXYZW(G,D.x,D.y,D.z,U)}for(let G=0,L=R.length;G<L;++G){const k=R[G],U=k.start,q=k.count;for(let W=U,J=U+q;W<J;W+=3)X(e.getX(W+0)),X(e.getX(W+1)),X(e.getX(W+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new zr(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let y=0,v=n.count;y<v;y++)n.setXYZ(y,0,0,0);const r=new Ee,s=new Ee,l=new Ee,c=new Ee,f=new Ee,d=new Ee,m=new Ee,g=new Ee;if(e)for(let y=0,v=e.count;y<v;y+=3){const S=e.getX(y+0),T=e.getX(y+1),A=e.getX(y+2);r.fromBufferAttribute(t,S),s.fromBufferAttribute(t,T),l.fromBufferAttribute(t,A),m.subVectors(l,s),g.subVectors(r,s),m.cross(g),c.fromBufferAttribute(n,S),f.fromBufferAttribute(n,T),d.fromBufferAttribute(n,A),c.add(m),f.add(m),d.add(m),n.setXYZ(S,c.x,c.y,c.z),n.setXYZ(T,f.x,f.y,f.z),n.setXYZ(A,d.x,d.y,d.z)}else for(let y=0,v=t.count;y<v;y+=3)r.fromBufferAttribute(t,y+0),s.fromBufferAttribute(t,y+1),l.fromBufferAttribute(t,y+2),m.subVectors(l,s),g.subVectors(r,s),m.cross(g),n.setXYZ(y+0,m.x,m.y,m.z),n.setXYZ(y+1,m.x,m.y,m.z),n.setXYZ(y+2,m.x,m.y,m.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Xa.fromBufferAttribute(e,t),Xa.normalize(),e.setXYZ(t,Xa.x,Xa.y,Xa.z)}toNonIndexed(){function e(c,f){const d=c.array,m=c.itemSize,g=c.normalized,y=new d.constructor(f.length*m);let v=0,S=0;for(let T=0,A=f.length;T<A;T++){c.isInterleavedBufferAttribute?v=f[T]*c.data.stride+c.offset:v=f[T]*m;for(let w=0;w<m;w++)y[S++]=d[v++]}return new zr(y,m,g)}if(this.index===null)return Mn("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Si,n=this.index.array,r=this.attributes;for(const c in r){const f=r[c],d=e(f,n);t.setAttribute(c,d)}const s=this.morphAttributes;for(const c in s){const f=[],d=s[c];for(let m=0,g=d.length;m<g;m++){const y=d[m],v=e(y,n);f.push(v)}t.morphAttributes[c]=f}t.morphTargetsRelative=this.morphTargetsRelative;const l=this.groups;for(let c=0,f=l.length;c<f;c++){const d=l[c];t.addGroup(d.start,d.count,d.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const f=this.parameters;for(const d in f)f[d]!==void 0&&(e[d]=f[d]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const f in n){const d=n[f];e.data.attributes[f]=d.toJSON(e.data)}const r={};let s=!1;for(const f in this.morphAttributes){const d=this.morphAttributes[f],m=[];for(let g=0,y=d.length;g<y;g++){const v=d[g];m.push(v.toJSON(e.data))}m.length>0&&(r[f]=m,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const l=this.groups;l.length>0&&(e.data.groups=JSON.parse(JSON.stringify(l)));const c=this.boundingSphere;return c!==null&&(e.data.boundingSphere=c.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const r=e.attributes;for(const d in r){const m=r[d];this.setAttribute(d,m.clone(t))}const s=e.morphAttributes;for(const d in s){const m=[],g=s[d];for(let y=0,v=g.length;y<v;y++)m.push(g[y].clone(t));this.morphAttributes[d]=m}this.morphTargetsRelative=e.morphTargetsRelative;const l=e.groups;for(let d=0,m=l.length;d<m;d++){const g=l[d];this.addGroup(g.start,g.count,g.materialIndex)}const c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());const f=e.boundingSphere;return f!==null&&(this.boundingSphere=f.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Ew=new ui,$d=new Ip,Mv=new xo,Cw=new Ee,Av=new Ee,Tv=new Ee,Ev=new Ee,x5=new Ee,Cv=new Ee,Nw=new Ee,Nv=new Ee;class js extends Oi{constructor(e=new Si,t=new kf){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,l=r.length;s<l;s++){const c=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=s}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,s=n.morphAttributes.position,l=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const c=this.morphTargetInfluences;if(s&&c){Cv.set(0,0,0);for(let f=0,d=s.length;f<d;f++){const m=c[f],g=s[f];m!==0&&(x5.fromBufferAttribute(g,e),l?Cv.addScaledVector(x5,m):Cv.addScaledVector(x5.sub(t),m))}t.add(Cv)}return t}raycast(e,t){const n=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),Mv.copy(n.boundingSphere),Mv.applyMatrix4(s),$d.copy(e.ray).recast(e.near),!(Mv.containsPoint($d.origin)===!1&&($d.intersectSphere(Mv,Cw)===null||$d.origin.distanceToSquared(Cw)>(e.far-e.near)**2))&&(Ew.copy(s).invert(),$d.copy(e.ray).applyMatrix4(Ew),!(n.boundingBox!==null&&$d.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,$d)))}_computeIntersections(e,t,n){let r;const s=this.geometry,l=this.material,c=s.index,f=s.attributes.position,d=s.attributes.uv,m=s.attributes.uv1,g=s.attributes.normal,y=s.groups,v=s.drawRange;if(c!==null)if(Array.isArray(l))for(let S=0,T=y.length;S<T;S++){const A=y[S],w=l[A.materialIndex],R=Math.max(A.start,v.start),D=Math.min(c.count,Math.min(A.start+A.count,v.start+v.count));for(let I=R,z=D;I<z;I+=3){const j=c.getX(I),X=c.getX(I+1),G=c.getX(I+2);r=Rv(this,w,e,n,d,m,g,j,X,G),r&&(r.faceIndex=Math.floor(I/3),r.face.materialIndex=A.materialIndex,t.push(r))}}else{const S=Math.max(0,v.start),T=Math.min(c.count,v.start+v.count);for(let A=S,w=T;A<w;A+=3){const R=c.getX(A),D=c.getX(A+1),I=c.getX(A+2);r=Rv(this,l,e,n,d,m,g,R,D,I),r&&(r.faceIndex=Math.floor(A/3),t.push(r))}}else if(f!==void 0)if(Array.isArray(l))for(let S=0,T=y.length;S<T;S++){const A=y[S],w=l[A.materialIndex],R=Math.max(A.start,v.start),D=Math.min(f.count,Math.min(A.start+A.count,v.start+v.count));for(let I=R,z=D;I<z;I+=3){const j=I,X=I+1,G=I+2;r=Rv(this,w,e,n,d,m,g,j,X,G),r&&(r.faceIndex=Math.floor(I/3),r.face.materialIndex=A.materialIndex,t.push(r))}}else{const S=Math.max(0,v.start),T=Math.min(f.count,v.start+v.count);for(let A=S,w=T;A<w;A+=3){const R=A,D=A+1,I=A+2;r=Rv(this,l,e,n,d,m,g,R,D,I),r&&(r.faceIndex=Math.floor(A/3),t.push(r))}}}}function RR(i,e,t,n,r,s,l,c){let f;if(e.side===cl?f=n.intersectTriangle(l,s,r,!0,c):f=n.intersectTriangle(r,s,l,e.side===_h,c),f===null)return null;Nv.copy(c),Nv.applyMatrix4(i.matrixWorld);const d=t.ray.origin.distanceTo(Nv);return d<t.near||d>t.far?null:{distance:d,point:Nv.clone(),object:i}}function Rv(i,e,t,n,r,s,l,c,f,d){i.getVertexPosition(c,Av),i.getVertexPosition(f,Tv),i.getVertexPosition(d,Ev);const m=RR(i,e,t,n,Av,Tv,Ev,Nw);if(m){const g=new Ee;Xl.getBarycoord(Nw,Av,Tv,Ev,g),r&&(m.uv=Xl.getInterpolatedAttribute(r,c,f,d,g,new zt)),s&&(m.uv1=Xl.getInterpolatedAttribute(s,c,f,d,g,new zt)),l&&(m.normal=Xl.getInterpolatedAttribute(l,c,f,d,g,new Ee),m.normal.dot(n.direction)>0&&m.normal.multiplyScalar(-1));const y={a:c,b:f,c:d,normal:new Ee,materialIndex:0};Xl.getNormal(Av,Tv,Ev,y.normal),m.face=y,m.barycoord=g}return m}class Dp extends Si{constructor(e=1,t=1,n=1,r=1,s=1,l=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:l};const c=this;r=Math.floor(r),s=Math.floor(s),l=Math.floor(l);const f=[],d=[],m=[],g=[];let y=0,v=0;S("z","y","x",-1,-1,n,t,e,l,s,0),S("z","y","x",1,-1,n,t,-e,l,s,1),S("x","z","y",1,1,e,n,t,r,l,2),S("x","z","y",1,-1,e,n,-t,r,l,3),S("x","y","z",1,-1,e,t,n,r,s,4),S("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(f),this.setAttribute("position",new kn(d,3)),this.setAttribute("normal",new kn(m,3)),this.setAttribute("uv",new kn(g,2));function S(T,A,w,R,D,I,z,j,X,G,L){const k=I/X,U=z/G,q=I/2,W=z/2,J=j/2,ce=X+1,K=G+1;let ne=0,pe=0;const Re=new Ee;for(let Te=0;Te<K;Te++){const ee=Te*U-W;for(let F=0;F<ce;F++){const $=F*k-q;Re[T]=$*R,Re[A]=ee*D,Re[w]=J,d.push(Re.x,Re.y,Re.z),Re[T]=0,Re[A]=0,Re[w]=j>0?1:-1,m.push(Re.x,Re.y,Re.z),g.push(F/X),g.push(1-Te/G),ne+=1}}for(let Te=0;Te<G;Te++)for(let ee=0;ee<X;ee++){const F=y+ee+ce*Te,$=y+ee+ce*(Te+1),re=y+(ee+1)+ce*(Te+1),Ae=y+(ee+1)+ce*Te;f.push(F,$,Ae),f.push($,re,Ae),pe+=6}c.addGroup(v,pe,L),v+=pe,y+=ne}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Dp(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function h0(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const r=i[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(Mn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function al(i){const e={};for(let t=0;t<i.length;t++){const n=h0(i[t]);for(const r in n)e[r]=n[r]}return e}function LR(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function IT(i){const e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:nr.workingColorSpace}const DT={clone:h0,merge:al};var PR=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,IR=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class fl extends zo{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=PR,this.fragmentShader=IR,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=h0(e.uniforms),this.uniformsGroups=LR(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const l=this.uniforms[r].value;l&&l.isTexture?t.uniforms[r]={type:"t",value:l.toJSON(e).uuid}:l&&l.isColor?t.uniforms[r]={type:"c",value:l.getHex()}:l&&l.isVector2?t.uniforms[r]={type:"v2",value:l.toArray()}:l&&l.isVector3?t.uniforms[r]={type:"v3",value:l.toArray()}:l&&l.isVector4?t.uniforms[r]={type:"v4",value:l.toArray()}:l&&l.isMatrix3?t.uniforms[r]={type:"m3",value:l.toArray()}:l&&l.isMatrix4?t.uniforms[r]={type:"m4",value:l.toArray()}:t.uniforms[r]={value:l}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class qy extends Oi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ui,this.projectionMatrix=new ui,this.projectionMatrixInverse=new ui,this.coordinateSystem=wc,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const nd=new Ee,Rw=new zt,Lw=new zt;class Fs extends qy{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=u0*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(wp*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return u0*2*Math.atan(Math.tan(wp*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){nd.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(nd.x,nd.y).multiplyScalar(-e/nd.z),nd.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(nd.x,nd.y).multiplyScalar(-e/nd.z)}getViewSize(e,t){return this.getViewBounds(e,Rw,Lw),t.subVectors(Lw,Rw)}setViewOffset(e,t,n,r,s,l){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(wp*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r;const l=this.view;if(this.view!==null&&this.view.enabled){const f=l.fullWidth,d=l.fullHeight;s+=l.offsetX*r/f,t-=l.offsetY*n/d,r*=l.width/f,n*=l.height/d}const c=this.filmOffset;c!==0&&(s+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Am=-90,Tm=1;class kT extends Oi{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Fs(Am,Tm,e,t);r.layers=this.layers,this.add(r);const s=new Fs(Am,Tm,e,t);s.layers=this.layers,this.add(s);const l=new Fs(Am,Tm,e,t);l.layers=this.layers,this.add(l);const c=new Fs(Am,Tm,e,t);c.layers=this.layers,this.add(c);const f=new Fs(Am,Tm,e,t);f.layers=this.layers,this.add(f);const d=new Fs(Am,Tm,e,t);d.layers=this.layers,this.add(d)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,s,l,c,f]=t;for(const d of t)this.remove(d);if(e===wc)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),l.up.set(0,0,1),l.lookAt(0,-1,0),c.up.set(0,1,0),c.lookAt(0,0,1),f.up.set(0,1,0),f.lookAt(0,0,-1);else if(e===l0)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),l.up.set(0,0,-1),l.lookAt(0,-1,0),c.up.set(0,-1,0),c.lookAt(0,0,1),f.up.set(0,-1,0),f.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const d of t)this.add(d),d.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,l,c,f,d,m]=this.children,g=e.getRenderTarget(),y=e.getActiveCubeFace(),v=e.getActiveMipmapLevel(),S=e.xr.enabled;e.xr.enabled=!1;const T=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,s),e.setRenderTarget(n,1,r),e.render(t,l),e.setRenderTarget(n,2,r),e.render(t,c),e.setRenderTarget(n,3,r),e.render(t,f),e.setRenderTarget(n,4,r),e.render(t,d),n.texture.generateMipmaps=T,e.setRenderTarget(n,5,r),e.render(t,m),e.setRenderTarget(g,y,v),e.xr.enabled=S,n.texture.needsPMREMUpdate=!0}}class d1 extends Fr{constructor(e=[],t=Bu,n,r,s,l,c,f,d,m){super(e,t,n,r,s,l,c,f,d,m),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Wy extends ul{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new d1(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Dp(5,5,5),s=new fl({name:"CubemapFromEquirect",uniforms:h0(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:cl,blending:Ou});s.uniforms.tEquirect.value=t;const l=new js(r,s),c=t.minFilter;return t.minFilter===Rf&&(t.minFilter=ar),new kT(1,10,this).update(e,l),t.minFilter=c,l.geometry.dispose(),l.material.dispose(),this}clear(e,t=!0,n=!0,r=!0){const s=e.getRenderTarget();for(let l=0;l<6;l++)e.setRenderTarget(this,l),e.clear(t,n,r);e.setRenderTarget(s)}}class Zm extends Oi{constructor(){super(),this.isGroup=!0,this.type="Group"}}const DR={type:"move"};class bx{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Zm,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Zm,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ee,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ee),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Zm,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ee,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ee),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,l=null;const c=this._targetRay,f=this._grip,d=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(d&&e.hand){l=!0;for(const T of e.hand.values()){const A=t.getJointPose(T,n),w=this._getHandJoint(d,T);A!==null&&(w.matrix.fromArray(A.transform.matrix),w.matrix.decompose(w.position,w.rotation,w.scale),w.matrixWorldNeedsUpdate=!0,w.jointRadius=A.radius),w.visible=A!==null}const m=d.joints["index-finger-tip"],g=d.joints["thumb-tip"],y=m.position.distanceTo(g.position),v=.02,S=.005;d.inputState.pinching&&y>v+S?(d.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!d.inputState.pinching&&y<=v-S&&(d.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else f!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),s!==null&&(f.matrix.fromArray(s.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.matrixWorldNeedsUpdate=!0,s.linearVelocity?(f.hasLinearVelocity=!0,f.linearVelocity.copy(s.linearVelocity)):f.hasLinearVelocity=!1,s.angularVelocity?(f.hasAngularVelocity=!0,f.angularVelocity.copy(s.angularVelocity)):f.hasAngularVelocity=!1));c!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&s!==null&&(r=s),r!==null&&(c.matrix.fromArray(r.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,r.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(r.linearVelocity)):c.hasLinearVelocity=!1,r.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(r.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent(DR)))}return c!==null&&(c.visible=r!==null),f!==null&&(f.visible=s!==null),d!==null&&(d.visible=l!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new Zm;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class Xy{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new fn(e),this.density=t}clone(){return new Xy(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Yy{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new fn(e),this.near=t,this.far=n}clone(){return new Yy(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}let p1=class extends Oi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Cc,this.environmentIntensity=1,this.environmentRotation=new Cc,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}};class Zy{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=qg,this.updateRanges=[],this.version=0,this.uuid=Ac()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ac()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ac()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const sl=new Ee;class Cp{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)sl.fromBufferAttribute(this,t),sl.applyMatrix4(e),this.setXYZ(t,sl.x,sl.y,sl.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)sl.fromBufferAttribute(this,t),sl.applyNormalMatrix(e),this.setXYZ(t,sl.x,sl.y,sl.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)sl.fromBufferAttribute(this,t),sl.transformDirection(e),this.setXYZ(t,sl.x,sl.y,sl.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=ll(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Pi(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=Pi(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Pi(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Pi(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Pi(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=ll(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=ll(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=ll(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=ll(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Pi(t,this.array),n=Pi(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Pi(t,this.array),n=Pi(n,this.array),r=Pi(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Pi(t,this.array),n=Pi(n,this.array),r=Pi(r,this.array),s=Pi(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){Xg("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new zr(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Cp(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){Xg("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class CS extends zo{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new fn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Em;const ug=new Ee,Cm=new Ee,Nm=new Ee,Rm=new zt,fg=new zt,OT=new ui,Lv=new Ee,hg=new Ee,Pv=new Ee,Pw=new zt,y5=new zt,Iw=new zt;class BT extends Oi{constructor(e=new CS){if(super(),this.isSprite=!0,this.type="Sprite",Em===void 0){Em=new Si;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new Zy(t,5);Em.setIndex([0,1,2,0,2,3]),Em.setAttribute("position",new Cp(n,3,0,!1)),Em.setAttribute("uv",new Cp(n,2,3,!1))}this.geometry=Em,this.material=e,this.center=new zt(.5,.5),this.count=1}raycast(e,t){e.camera===null&&Hn('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Cm.setFromMatrixScale(this.matrixWorld),OT.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Nm.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Cm.multiplyScalar(-Nm.z);const n=this.material.rotation;let r,s;n!==0&&(s=Math.cos(n),r=Math.sin(n));const l=this.center;Iv(Lv.set(-.5,-.5,0),Nm,l,Cm,r,s),Iv(hg.set(.5,-.5,0),Nm,l,Cm,r,s),Iv(Pv.set(.5,.5,0),Nm,l,Cm,r,s),Pw.set(0,0),y5.set(1,0),Iw.set(1,1);let c=e.ray.intersectTriangle(Lv,hg,Pv,!1,ug);if(c===null&&(Iv(hg.set(-.5,.5,0),Nm,l,Cm,r,s),y5.set(0,1),c=e.ray.intersectTriangle(Lv,Pv,hg,!1,ug),c===null))return;const f=e.ray.origin.distanceTo(ug);f<e.near||f>e.far||t.push({distance:f,point:ug.clone(),uv:Xl.getInterpolation(ug,Lv,hg,Pv,Pw,y5,Iw,new zt),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Iv(i,e,t,n,r,s){Rm.subVectors(i,t).addScalar(.5).multiply(n),r!==void 0?(fg.x=s*Rm.x-r*Rm.y,fg.y=r*Rm.x+s*Rm.y):fg.copy(Rm),i.copy(e),i.x+=fg.x,i.y+=fg.y,i.applyMatrix4(OT)}const Dv=new Ee,Dw=new Ee;class UT extends Oi{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,r=t.length;n<r;n++){const s=t[n];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const r=this.levels;let s;for(s=0;s<r.length&&!(t<r[s].distance);s++);return r.splice(s,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const r=t.splice(n,1);return this.remove(r[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r;n++){let s=t[n].distance;if(t[n].object.visible&&(s-=s*t[n].hysteresis),e<s)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){Dv.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(Dv);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Dv.setFromMatrixPosition(e.matrixWorld),Dw.setFromMatrixPosition(this.matrixWorld);const n=Dv.distanceTo(Dw)/e.zoom;t[0].object.visible=!0;let r,s;for(r=1,s=t.length;r<s;r++){let l=t[r].distance;if(t[r].object.visible&&(l-=l*t[r].hysteresis),n>=l)t[r-1].object.visible=!1,t[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let r=0,s=n.length;r<s;r++){const l=n[r];t.object.levels.push({object:l.object.uuid,distance:l.distance,hysteresis:l.hysteresis})}return t}}const kw=new Ee,Ow=new Yr,Bw=new Yr,kR=new Ee,Uw=new ui,kv=new Ee,b5=new xo,Fw=new ui,_5=new Ip;class FT extends js{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=C_,this.bindMatrix=new ui,this.bindMatrixInverse=new ui,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Fo),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,kv),this.boundingBox.expandByPoint(kv)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new xo),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,kv),this.boundingSphere.expandByPoint(kv)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,r=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),b5.copy(this.boundingSphere),b5.applyMatrix4(r),e.ray.intersectsSphere(b5)!==!1&&(Fw.copy(r).invert(),_5.copy(e.ray).applyMatrix4(Fw),!(this.boundingBox!==null&&_5.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,_5)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Yr,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===C_?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===gT?this.bindMatrixInverse.copy(this.bindMatrix).invert():Mn("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,r=this.geometry;Ow.fromBufferAttribute(r.attributes.skinIndex,e),Bw.fromBufferAttribute(r.attributes.skinWeight,e),kw.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const l=Bw.getComponent(s);if(l!==0){const c=Ow.getComponent(s);Uw.multiplyMatrices(n.bones[c].matrixWorld,n.boneInverses[c]),t.addScaledVector(kR.copy(kw).applyMatrix4(Uw),l)}}return t.applyMatrix4(this.bindMatrixInverse)}}class NS extends Oi{constructor(){super(),this.isBone=!0,this.type="Bone"}}class su extends Fr{constructor(e=null,t=1,n=1,r,s,l,c,f,d=va,m=va,g,y){super(null,l,c,f,d,m,r,s,g,y),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const zw=new ui,OR=new ui;class $y{constructor(e=[],t=[]){this.uuid=Ac(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.previousBoneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){Mn("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new ui)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new ui;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,l=e.length;s<l;s++){const c=e[s]?e[s].matrixWorld:OR;zw.multiplyMatrices(c,t[s]),zw.toArray(n,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new $y(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new su(t,e,e,xa,Cs);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const s=e.bones[n];let l=t[s];l===void 0&&(Mn("Skeleton: No bone found with UUID:",s),l=new NS),this.bones.push(l),this.boneInverses.push(new ui().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,s=t.length;r<s;r++){const l=t[r];e.bones.push(l.uuid);const c=n[r];e.boneInverses.push(c.toArray())}return e}}class d0 extends zr{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Lm=new ui,jw=new ui,Ov=[],Vw=new Fo,BR=new ui,dg=new js,pg=new xo;class zT extends js{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new d0(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,BR)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Fo),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Lm),Vw.copy(e.boundingBox).applyMatrix4(Lm),this.boundingBox.union(Vw)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new xo),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Lm),pg.copy(e.boundingSphere).applyMatrix4(Lm),this.boundingSphere.union(pg)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences,r=this.morphTexture.source.data.data,s=n.length+1,l=e*s+1;for(let c=0;c<n.length;c++)n[c]=r[l+c]}raycast(e,t){const n=this.matrixWorld,r=this.count;if(dg.geometry=this.geometry,dg.material=this.material,dg.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),pg.copy(this.boundingSphere),pg.applyMatrix4(n),e.ray.intersectsSphere(pg)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,Lm),jw.multiplyMatrices(n,Lm),dg.matrixWorld=jw,dg.raycast(e,Ov);for(let l=0,c=Ov.length;l<c;l++){const f=Ov[l];f.instanceId=s,f.object=this,t.push(f)}Ov.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new d0(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences,r=n.length+1;this.morphTexture===null&&(this.morphTexture=new su(new Float32Array(r*this.count),r,this.count,f1,Cs));const s=this.morphTexture.source.data.data;let l=0;for(let d=0;d<n.length;d++)l+=n[d];const c=this.geometry.morphTargetsRelative?1:1-l,f=r*e;s[f]=c,s.set(n,f+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const S5=new Ee,UR=new Ee,FR=new Ei;class nu{constructor(e=new Ee(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=S5.subVectors(n,t).cross(UR.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(S5),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(n,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||FR.getNormalMatrix(e),r=this.coplanarPoint(S5).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Jd=new xo,zR=new zt(.5,.5),Bv=new Ee;class _0{constructor(e=new nu,t=new nu,n=new nu,r=new nu,s=new nu,l=new nu){this.planes=[e,t,n,r,s,l]}set(e,t,n,r,s,l){const c=this.planes;return c[0].copy(e),c[1].copy(t),c[2].copy(n),c[3].copy(r),c[4].copy(s),c[5].copy(l),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=wc,n=!1){const r=this.planes,s=e.elements,l=s[0],c=s[1],f=s[2],d=s[3],m=s[4],g=s[5],y=s[6],v=s[7],S=s[8],T=s[9],A=s[10],w=s[11],R=s[12],D=s[13],I=s[14],z=s[15];if(r[0].setComponents(d-l,v-m,w-S,z-R).normalize(),r[1].setComponents(d+l,v+m,w+S,z+R).normalize(),r[2].setComponents(d+c,v+g,w+T,z+D).normalize(),r[3].setComponents(d-c,v-g,w-T,z-D).normalize(),n)r[4].setComponents(f,y,A,I).normalize(),r[5].setComponents(d-f,v-y,w-A,z-I).normalize();else if(r[4].setComponents(d-f,v-y,w-A,z-I).normalize(),t===wc)r[5].setComponents(d+f,v+y,w+A,z+I).normalize();else if(t===l0)r[5].setComponents(f,y,A,I).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Jd.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Jd.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Jd)}intersectsSprite(e){Jd.center.set(0,0,0);const t=zR.distanceTo(e.center);return Jd.radius=.7071067811865476+t,Jd.applyMatrix4(e.matrixWorld),this.intersectsSphere(Jd)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(Bv.x=r.normal.x>0?e.max.x:e.min.x,Bv.y=r.normal.y>0?e.max.y:e.min.y,Bv.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Bv)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const Mf=new ui,Af=new _0;class Jy{constructor(){this.coordinateSystem=wc}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Mf.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Af.setFromProjectionMatrix(Mf,r.coordinateSystem,r.reversedDepth),Af.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Mf.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Af.setFromProjectionMatrix(Mf,r.coordinateSystem,r.reversedDepth),Af.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Mf.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Af.setFromProjectionMatrix(Mf,r.coordinateSystem,r.reversedDepth),Af.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Mf.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Af.setFromProjectionMatrix(Mf,r.coordinateSystem,r.reversedDepth),Af.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Mf.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Af.setFromProjectionMatrix(Mf,r.coordinateSystem,r.reversedDepth),Af.containsPoint(e))return!0}return!1}clone(){return new Jy}}function w5(i,e){return i-e}function jR(i,e){return i.z-e.z}function VR(i,e){return e.z-i.z}class HR{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,r){const s=this.pool,l=this.list;this.index>=s.length&&s.push({start:-1,count:-1,z:-1,index:-1});const c=s[this.index];l.push(c),this.index++,c.start=e,c.count=t,c.z=n,c.index=r}reset(){this.list.length=0,this.index=0}}const ql=new ui,GR=new fn(1,1,1),Hw=new _0,qR=new Jy,Uv=new Fo,Kd=new xo,mg=new Ee,Gw=new Ee,WR=new Ee,M5=new HR,Io=new js,Fv=[];function XR(i,e,t=0){const n=e.itemSize;if(i.isInterleavedBufferAttribute||i.array.constructor!==e.array.constructor){const r=i.count;for(let s=0;s<r;s++)for(let l=0;l<n;l++)e.setComponent(s+t,l,i.getComponent(s,l))}else e.array.set(i.array,t*n);e.needsUpdate=!0}function Qd(i,e){if(i.constructor!==e.constructor){const t=Math.min(i.length,e.length);for(let n=0;n<t;n++)e[n]=i[n]}else{const t=Math.min(i.length,e.length);e.set(new i.constructor(i.buffer,0,t))}}class jT extends js{constructor(e,t,n=t*2,r){super(new Si,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new su(t,e,e,xa,Cs);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new su(t,e,e,h1,Ec);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new su(t,e,e,xa,Cs);n.colorSpace=nr.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,r=this._maxIndexCount;if(this._geometryInitialized===!1){for(const s in e.attributes){const l=e.getAttribute(s),{array:c,itemSize:f,normalized:d}=l,m=new c.constructor(n*f),g=new zr(m,f,d);t.setAttribute(s,g)}if(e.getIndex()!==null){const s=n>65535?new Uint32Array(r):new Uint16Array(r);t.setIndex(new zr(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const r=e.getAttribute(n),s=t.getAttribute(n);if(r.itemSize!==s.itemSize||r.normalized!==s.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Fo);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(t[n].active===!1)continue;const s=t[n].geometryIndex;this.getMatrixAt(n,ql),this.getBoundingBoxAt(s,Uv).applyMatrix4(ql),e.union(Uv)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new xo);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(t[n].active===!1)continue;const s=t[n].geometryIndex;this.getMatrixAt(n,ql),this.getBoundingSphereAt(s,Kd).applyMatrix4(ql),e.union(Kd)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const n={visible:!0,active:!0,geometryIndex:e};let r=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(w5),r=this._availableInstanceIds.shift(),this._instanceInfo[r]=n):(r=this._instanceInfo.length,this._instanceInfo.push(n));const s=this._matricesTexture;ql.identity().toArray(s.image.data,r*16),s.needsUpdate=!0;const l=this._colorsTexture;return l&&(GR.toArray(l.image.data,r*4),l.needsUpdate=!0),this._visibilityChanged=!0,r}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);const r={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},s=this._geometryInfo;r.vertexStart=this._nextVertexStart,r.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const l=e.getIndex();if(l!==null&&(r.indexStart=this._nextIndexStart,r.reservedIndexCount=n===-1?l.count:n),r.indexStart!==-1&&r.indexStart+r.reservedIndexCount>this._maxIndexCount||r.vertexStart+r.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let f;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(w5),f=this._availableGeometryIds.shift(),s[f]=r):(f=this._geometryCount,this._geometryCount++,s.push(r)),this.setGeometryAt(f,e),this._nextIndexStart=r.indexStart+r.reservedIndexCount,this._nextVertexStart=r.vertexStart+r.reservedVertexCount,f}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,r=n.getIndex()!==null,s=n.getIndex(),l=t.getIndex(),c=this._geometryInfo[e];if(r&&l.count>c.reservedIndexCount||t.attributes.position.count>c.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const f=c.vertexStart,d=c.reservedVertexCount;c.vertexCount=t.getAttribute("position").count;for(const m in n.attributes){const g=t.getAttribute(m),y=n.getAttribute(m);XR(g,y,f);const v=g.itemSize;for(let S=g.count,T=d;S<T;S++){const A=f+S;for(let w=0;w<v;w++)y.setComponent(A,w,0)}y.needsUpdate=!0,y.addUpdateRange(f*v,d*v)}if(r){const m=c.indexStart,g=c.reservedIndexCount;c.indexCount=t.getIndex().count;for(let y=0;y<l.count;y++)s.setX(m+y,f+l.getX(y));for(let y=l.count,v=g;y<v;y++)s.setX(m+y,f);s.needsUpdate=!0,s.addUpdateRange(m,c.reservedIndexCount)}return c.start=r?c.indexStart:c.vertexStart,c.count=r?c.indexCount:c.vertexCount,c.boundingBox=null,t.boundingBox!==null&&(c.boundingBox=t.boundingBox.clone()),c.boundingSphere=null,t.boundingSphere!==null&&(c.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const n=this._instanceInfo;for(let r=0,s=n.length;r<s;r++)n[r].active&&n[r].geometryIndex===e&&this.deleteInstance(r);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,r=n.map((l,c)=>c).sort((l,c)=>n[l].vertexStart-n[c].vertexStart),s=this.geometry;for(let l=0,c=n.length;l<c;l++){const f=r[l],d=n[f];if(d.active!==!1){if(s.index!==null){if(d.indexStart!==t){const{indexStart:m,vertexStart:g,reservedIndexCount:y}=d,v=s.index,S=v.array,T=e-g;for(let A=m;A<m+y;A++)S[A]=S[A]+T;v.array.copyWithin(t,m,m+y),v.addUpdateRange(t,y),v.needsUpdate=!0,d.indexStart=t}t+=d.reservedIndexCount}if(d.vertexStart!==e){const{vertexStart:m,reservedVertexCount:g}=d,y=s.attributes;for(const v in y){const S=y[v],{array:T,itemSize:A}=S;T.copyWithin(e*A,m*A,(m+g)*A),S.addUpdateRange(e*A,g*A),S.needsUpdate=!0}d.vertexStart=e}e+=d.reservedVertexCount,d.start=s.index?d.indexStart:d.vertexStart,this._nextIndexStart=s.index?d.indexStart+d.reservedIndexCount:0,this._nextVertexStart=d.vertexStart+d.reservedVertexCount}}return this._visibilityChanged=!0,this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,r=this._geometryInfo[e];if(r.boundingBox===null){const s=new Fo,l=n.index,c=n.attributes.position;for(let f=r.start,d=r.start+r.count;f<d;f++){let m=f;l&&(m=l.getX(m)),s.expandByPoint(mg.fromBufferAttribute(c,m))}r.boundingBox=s}return t.copy(r.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,r=this._geometryInfo[e];if(r.boundingSphere===null){const s=new xo;this.getBoundingBoxAt(e,Uv),Uv.getCenter(s.center);const l=n.index,c=n.attributes.position;let f=0;for(let d=r.start,m=r.start+r.count;d<m;d++){let g=d;l&&(g=l.getX(g)),mg.fromBufferAttribute(c,g),f=Math.max(f,s.center.distanceToSquared(mg))}s.radius=Math.sqrt(f),r.boundingSphere=s}return t.copy(r.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,r=this._matricesTexture.image.data;return t.toArray(r,e*16),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(w5);t[t.length-1]===n.length-1;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const r=new Int32Array(e),s=new Int32Array(e);Qd(this._multiDrawCounts,r),Qd(this._multiDrawStarts,s),this._multiDrawCounts=r,this._multiDrawStarts=s,this._maxInstanceCount=e;const l=this._indirectTexture,c=this._matricesTexture,f=this._colorsTexture;l.dispose(),this._initIndirectTexture(),Qd(l.image.data,this._indirectTexture.image.data),c.dispose(),this._initMatricesTexture(),Qd(c.image.data,this._matricesTexture.image.data),f&&(f.dispose(),this._initColorsTexture(),Qd(f.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter(c=>c.active);if(Math.max(...n.map(c=>c.vertexStart+c.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...n.map(f=>f.indexStart+f.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const s=this.geometry;s.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new Si,this._initializeGeometry(s));const l=this.geometry;s.index&&Qd(s.index.array,l.index.array);for(const c in s.attributes)Qd(s.attributes[c].array,l.attributes[c].array)}raycast(e,t){const n=this._instanceInfo,r=this._geometryInfo,s=this.matrixWorld,l=this.geometry;Io.material=this.material,Io.geometry.index=l.index,Io.geometry.attributes=l.attributes,Io.geometry.boundingBox===null&&(Io.geometry.boundingBox=new Fo),Io.geometry.boundingSphere===null&&(Io.geometry.boundingSphere=new xo);for(let c=0,f=n.length;c<f;c++){if(!n[c].visible||!n[c].active)continue;const d=n[c].geometryIndex,m=r[d];Io.geometry.setDrawRange(m.start,m.count),this.getMatrixAt(c,Io.matrixWorld).premultiply(s),this.getBoundingBoxAt(d,Io.geometry.boundingBox),this.getBoundingSphereAt(d,Io.geometry.boundingSphere),Io.raycast(e,Fv);for(let g=0,y=Fv.length;g<y;g++){const v=Fv[g];v.object=this,v.batchId=c,t.push(v)}Fv.length=0}Io.material=null,Io.geometry.index=null,Io.geometry.attributes={},Io.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,r,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const l=r.getIndex(),c=l===null?1:l.array.BYTES_PER_ELEMENT,f=this._instanceInfo,d=this._multiDrawStarts,m=this._multiDrawCounts,g=this._geometryInfo,y=this.perObjectFrustumCulled,v=this._indirectTexture,S=v.image.data,T=n.isArrayCamera?qR:Hw;y&&!n.isArrayCamera&&(ql.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),Hw.setFromProjectionMatrix(ql,n.coordinateSystem,n.reversedDepth));let A=0;if(this.sortObjects){ql.copy(this.matrixWorld).invert(),mg.setFromMatrixPosition(n.matrixWorld).applyMatrix4(ql),Gw.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(ql);for(let D=0,I=f.length;D<I;D++)if(f[D].visible&&f[D].active){const z=f[D].geometryIndex;this.getMatrixAt(D,ql),this.getBoundingSphereAt(z,Kd).applyMatrix4(ql);let j=!1;if(y&&(j=!T.intersectsSphere(Kd,n)),!j){const X=g[z],G=WR.subVectors(Kd.center,mg).dot(Gw);M5.push(X.start,X.count,G,D)}}const w=M5.list,R=this.customSort;R===null?w.sort(s.transparent?VR:jR):R.call(this,w,n);for(let D=0,I=w.length;D<I;D++){const z=w[D];d[A]=z.start*c,m[A]=z.count,S[A]=z.index,A++}M5.reset()}else for(let w=0,R=f.length;w<R;w++)if(f[w].visible&&f[w].active){const D=f[w].geometryIndex;let I=!1;if(y&&(this.getMatrixAt(w,ql),this.getBoundingSphereAt(D,Kd).applyMatrix4(ql),I=!T.intersectsSphere(Kd,n)),!I){const z=g[D];d[A]=z.start*c,m[A]=z.count,S[A]=w,A++}}v.needsUpdate=!0,this._multiDrawCount=A,this._visibilityChanged=!1}onBeforeShadow(e,t,n,r,s,l){this.onBeforeRender(e,null,r,s,l)}}class hl extends zo{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new fn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const xy=new Ee,yy=new Ee,qw=new ui,gg=new Ip,zv=new xo,A5=new Ee,Ww=new Ee;class vd extends Oi{constructor(e=new Si,t=new hl){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let r=1,s=t.count;r<s;r++)xy.fromBufferAttribute(t,r-1),yy.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=xy.distanceTo(yy);e.setAttribute("lineDistance",new kn(n,1))}else Mn("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,l=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),zv.copy(n.boundingSphere),zv.applyMatrix4(r),zv.radius+=s,e.ray.intersectsSphere(zv)===!1)return;qw.copy(r).invert(),gg.copy(e.ray).applyMatrix4(qw);const c=s/((this.scale.x+this.scale.y+this.scale.z)/3),f=c*c,d=this.isLineSegments?2:1,m=n.index,y=n.attributes.position;if(m!==null){const v=Math.max(0,l.start),S=Math.min(m.count,l.start+l.count);for(let T=v,A=S-1;T<A;T+=d){const w=m.getX(T),R=m.getX(T+1),D=jv(this,e,gg,f,w,R,T);D&&t.push(D)}if(this.isLineLoop){const T=m.getX(S-1),A=m.getX(v),w=jv(this,e,gg,f,T,A,S-1);w&&t.push(w)}}else{const v=Math.max(0,l.start),S=Math.min(y.count,l.start+l.count);for(let T=v,A=S-1;T<A;T+=d){const w=jv(this,e,gg,f,T,T+1,T);w&&t.push(w)}if(this.isLineLoop){const T=jv(this,e,gg,f,S-1,v,S-1);T&&t.push(T)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,l=r.length;s<l;s++){const c=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=s}}}}}function jv(i,e,t,n,r,s,l){const c=i.geometry.attributes.position;if(xy.fromBufferAttribute(c,r),yy.fromBufferAttribute(c,s),t.distanceSqToSegment(xy,yy,A5,Ww)>n)return;A5.applyMatrix4(i.matrixWorld);const d=e.ray.origin.distanceTo(A5);if(!(d<e.near||d>e.far))return{distance:d,point:Ww.clone().applyMatrix4(i.matrixWorld),index:l,face:null,faceIndex:null,barycoord:null,object:i}}const Xw=new Ee,Yw=new Ee;class Of extends vd{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let r=0,s=t.count;r<s;r+=2)Xw.fromBufferAttribute(t,r),Yw.fromBufferAttribute(t,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+Xw.distanceTo(Yw);e.setAttribute("lineDistance",new kn(n,1))}else Mn("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class VT extends vd{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class RS extends zo{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new fn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const Zw=new ui,P_=new Ip,Vv=new xo,Hv=new Ee;class HT extends Oi{constructor(e=new Si,t=new RS){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,l=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Vv.copy(n.boundingSphere),Vv.applyMatrix4(r),Vv.radius+=s,e.ray.intersectsSphere(Vv)===!1)return;Zw.copy(r).invert(),P_.copy(e.ray).applyMatrix4(Zw);const c=s/((this.scale.x+this.scale.y+this.scale.z)/3),f=c*c,d=n.index,g=n.attributes.position;if(d!==null){const y=Math.max(0,l.start),v=Math.min(d.count,l.start+l.count);for(let S=y,T=v;S<T;S++){const A=d.getX(S);Hv.fromBufferAttribute(g,A),$w(Hv,A,f,r,e,t,this)}}else{const y=Math.max(0,l.start),v=Math.min(g.count,l.start+l.count);for(let S=y,T=v;S<T;S++)Hv.fromBufferAttribute(g,S),$w(Hv,S,f,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,l=r.length;s<l;s++){const c=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=s}}}}}function $w(i,e,t,n,r,s,l){const c=P_.distanceSqToPoint(i);if(c<t){const f=new Ee;P_.closestPointToPoint(i,f),f.applyMatrix4(n);const d=r.ray.origin.distanceTo(f);if(d<r.near||d>r.far)return;s.push({distance:d,distanceToRay:Math.sqrt(c),point:f,index:e,face:null,faceIndex:null,barycoord:null,object:l})}}class GT extends Fr{constructor(e,t,n,r,s=ar,l=ar,c,f,d){super(e,t,n,r,s,l,c,f,d),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const m=this;function g(){m.needsUpdate=!0,m._requestVideoFrameCallbackId=e.requestVideoFrameCallback(g)}"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(g))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){this._requestVideoFrameCallbackId!==0&&(this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),this._requestVideoFrameCallbackId=0),super.dispose()}}class YR extends GT{constructor(e,t,n,r,s,l,c,f){super({},e,t,n,r,s,l,c,f),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class ZR extends Fr{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=va,this.minFilter=va,this.generateMipmaps=!1,this.needsUpdate=!0}}class Ky extends Fr{constructor(e,t,n,r,s,l,c,f,d,m,g,y){super(null,l,c,f,d,m,r,s,g,y),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class $R extends Ky{constructor(e,t,n,r,s,l){super(e,t,n,s,l),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=Js,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class JR extends Ky{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,Bu),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class KR extends Fr{constructor(e,t,n,r,s,l,c,f,d){super(e,t,n,r,s,l,c,f,d),this.isCanvasTexture=!0,this.needsUpdate=!0}}class p0 extends Fr{constructor(e,t,n=Ec,r,s,l,c=va,f=va,d,m=If,g=1){if(m!==If&&m!==ld)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const y={width:e,height:t,depth:g};super(y,r,s,l,c,f,m,n,d),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new cd(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class qT extends p0{constructor(e,t=Ec,n=Bu,r,s,l=va,c=va,f,d=If){const m={width:e,height:e,depth:1},g=[m,m,m,m,m,m];super(e,e,t,n,r,s,l,c,f,d),this.image=g,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}}class LS extends Fr{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class Qy extends Si{constructor(e=1,t=1,n=4,r=8,s=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:r,heightSegments:s},t=Math.max(0,t),n=Math.max(1,Math.floor(n)),r=Math.max(3,Math.floor(r)),s=Math.max(1,Math.floor(s));const l=[],c=[],f=[],d=[],m=t/2,g=Math.PI/2*e,y=t,v=2*g+y,S=n*2+s,T=r+1,A=new Ee,w=new Ee;for(let R=0;R<=S;R++){let D=0,I=0,z=0,j=0;if(R<=n){const L=R/n,k=L*Math.PI/2;I=-m-e*Math.cos(k),z=e*Math.sin(k),j=-e*Math.cos(k),D=L*g}else if(R<=n+s){const L=(R-n)/s;I=-m+L*t,z=e,j=0,D=g+L*y}else{const L=(R-n-s)/n,k=L*Math.PI/2;I=m+e*Math.sin(k),z=e*Math.cos(k),j=e*Math.sin(k),D=g+y+L*g}const X=Math.max(0,Math.min(1,D/v));let G=0;R===0?G=.5/r:R===S&&(G=-.5/r);for(let L=0;L<=r;L++){const k=L/r,U=k*Math.PI*2,q=Math.sin(U),W=Math.cos(U);w.x=-z*W,w.y=I,w.z=z*q,c.push(w.x,w.y,w.z),A.set(-z*W,j,z*q),A.normalize(),f.push(A.x,A.y,A.z),d.push(k+G,X)}if(R>0){const L=(R-1)*T;for(let k=0;k<r;k++){const U=L+k,q=L+k+1,W=R*T+k,J=R*T+k+1;l.push(U,q,W),l.push(q,J,W)}}}this.setIndex(l),this.setAttribute("position",new kn(c,3)),this.setAttribute("normal",new kn(f,3)),this.setAttribute("uv",new kn(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Qy(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class eb extends Si{constructor(e=1,t=32,n=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const s=[],l=[],c=[],f=[],d=new Ee,m=new zt;l.push(0,0,0),c.push(0,0,1),f.push(.5,.5);for(let g=0,y=3;g<=t;g++,y+=3){const v=n+g/t*r;d.x=e*Math.cos(v),d.y=e*Math.sin(v),l.push(d.x,d.y,d.z),c.push(0,0,1),m.x=(l[y]/e+1)/2,m.y=(l[y+1]/e+1)/2,f.push(m.x,m.y)}for(let g=1;g<=t;g++)s.push(g,g+1,0);this.setIndex(s),this.setAttribute("position",new kn(l,3)),this.setAttribute("normal",new kn(c,3)),this.setAttribute("uv",new kn(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new eb(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class m1 extends Si{constructor(e=1,t=1,n=1,r=32,s=1,l=!1,c=0,f=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:s,openEnded:l,thetaStart:c,thetaLength:f};const d=this;r=Math.floor(r),s=Math.floor(s);const m=[],g=[],y=[],v=[];let S=0;const T=[],A=n/2;let w=0;R(),l===!1&&(e>0&&D(!0),t>0&&D(!1)),this.setIndex(m),this.setAttribute("position",new kn(g,3)),this.setAttribute("normal",new kn(y,3)),this.setAttribute("uv",new kn(v,2));function R(){const I=new Ee,z=new Ee;let j=0;const X=(t-e)/n;for(let G=0;G<=s;G++){const L=[],k=G/s,U=k*(t-e)+e;for(let q=0;q<=r;q++){const W=q/r,J=W*f+c,ce=Math.sin(J),K=Math.cos(J);z.x=U*ce,z.y=-k*n+A,z.z=U*K,g.push(z.x,z.y,z.z),I.set(ce,X,K).normalize(),y.push(I.x,I.y,I.z),v.push(W,1-k),L.push(S++)}T.push(L)}for(let G=0;G<r;G++)for(let L=0;L<s;L++){const k=T[L][G],U=T[L+1][G],q=T[L+1][G+1],W=T[L][G+1];(e>0||L!==0)&&(m.push(k,U,W),j+=3),(t>0||L!==s-1)&&(m.push(U,q,W),j+=3)}d.addGroup(w,j,0),w+=j}function D(I){const z=S,j=new zt,X=new Ee;let G=0;const L=I===!0?e:t,k=I===!0?1:-1;for(let q=1;q<=r;q++)g.push(0,A*k,0),y.push(0,k,0),v.push(.5,.5),S++;const U=S;for(let q=0;q<=r;q++){const J=q/r*f+c,ce=Math.cos(J),K=Math.sin(J);X.x=L*K,X.y=A*k,X.z=L*ce,g.push(X.x,X.y,X.z),y.push(0,k,0),j.x=ce*.5+.5,j.y=K*.5*k+.5,v.push(j.x,j.y),S++}for(let q=0;q<r;q++){const W=z+q,J=U+q;I===!0?m.push(J,J+1,W):m.push(J+1,J,W),G+=3}d.addGroup(w,G,I===!0?1:2),w+=G}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new m1(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class g1 extends m1{constructor(e=1,t=1,n=32,r=1,s=!1,l=0,c=Math.PI*2){super(0,e,t,n,r,s,l,c),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:l,thetaLength:c}}static fromJSON(e){return new g1(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class bd extends Si{constructor(e=[],t=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const s=[],l=[];c(r),d(n),m(),this.setAttribute("position",new kn(s,3)),this.setAttribute("normal",new kn(s.slice(),3)),this.setAttribute("uv",new kn(l,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function c(R){const D=new Ee,I=new Ee,z=new Ee;for(let j=0;j<t.length;j+=3)v(t[j+0],D),v(t[j+1],I),v(t[j+2],z),f(D,I,z,R)}function f(R,D,I,z){const j=z+1,X=[];for(let G=0;G<=j;G++){X[G]=[];const L=R.clone().lerp(I,G/j),k=D.clone().lerp(I,G/j),U=j-G;for(let q=0;q<=U;q++)q===0&&G===j?X[G][q]=L:X[G][q]=L.clone().lerp(k,q/U)}for(let G=0;G<j;G++)for(let L=0;L<2*(j-G)-1;L++){const k=Math.floor(L/2);L%2===0?(y(X[G][k+1]),y(X[G+1][k]),y(X[G][k])):(y(X[G][k+1]),y(X[G+1][k+1]),y(X[G+1][k]))}}function d(R){const D=new Ee;for(let I=0;I<s.length;I+=3)D.x=s[I+0],D.y=s[I+1],D.z=s[I+2],D.normalize().multiplyScalar(R),s[I+0]=D.x,s[I+1]=D.y,s[I+2]=D.z}function m(){const R=new Ee;for(let D=0;D<s.length;D+=3){R.x=s[D+0],R.y=s[D+1],R.z=s[D+2];const I=A(R)/2/Math.PI+.5,z=w(R)/Math.PI+.5;l.push(I,1-z)}S(),g()}function g(){for(let R=0;R<l.length;R+=6){const D=l[R+0],I=l[R+2],z=l[R+4],j=Math.max(D,I,z),X=Math.min(D,I,z);j>.9&&X<.1&&(D<.2&&(l[R+0]+=1),I<.2&&(l[R+2]+=1),z<.2&&(l[R+4]+=1))}}function y(R){s.push(R.x,R.y,R.z)}function v(R,D){const I=R*3;D.x=e[I+0],D.y=e[I+1],D.z=e[I+2]}function S(){const R=new Ee,D=new Ee,I=new Ee,z=new Ee,j=new zt,X=new zt,G=new zt;for(let L=0,k=0;L<s.length;L+=9,k+=6){R.set(s[L+0],s[L+1],s[L+2]),D.set(s[L+3],s[L+4],s[L+5]),I.set(s[L+6],s[L+7],s[L+8]),j.set(l[k+0],l[k+1]),X.set(l[k+2],l[k+3]),G.set(l[k+4],l[k+5]),z.copy(R).add(D).add(I).divideScalar(3);const U=A(z);T(j,k+0,R,U),T(X,k+2,D,U),T(G,k+4,I,U)}}function T(R,D,I,z){z<0&&R.x===1&&(l[D]=R.x-1),I.x===0&&I.z===0&&(l[D]=z/2/Math.PI+.5)}function A(R){return Math.atan2(R.z,-R.x)}function w(R){return Math.atan2(-R.y,Math.sqrt(R.x*R.x+R.z*R.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new bd(e.vertices,e.indices,e.radius,e.detail)}}class tb extends bd{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=1/n,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],l=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,l,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new tb(e.radius,e.detail)}}const Gv=new Ee,qv=new Ee,T5=new Ee,Wv=new Xl;class WT extends Si{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const r=Math.pow(10,4),s=Math.cos(wp*t),l=e.getIndex(),c=e.getAttribute("position"),f=l?l.count:c.count,d=[0,0,0],m=["a","b","c"],g=new Array(3),y={},v=[];for(let S=0;S<f;S+=3){l?(d[0]=l.getX(S),d[1]=l.getX(S+1),d[2]=l.getX(S+2)):(d[0]=S,d[1]=S+1,d[2]=S+2);const{a:T,b:A,c:w}=Wv;if(T.fromBufferAttribute(c,d[0]),A.fromBufferAttribute(c,d[1]),w.fromBufferAttribute(c,d[2]),Wv.getNormal(T5),g[0]=`${Math.round(T.x*r)},${Math.round(T.y*r)},${Math.round(T.z*r)}`,g[1]=`${Math.round(A.x*r)},${Math.round(A.y*r)},${Math.round(A.z*r)}`,g[2]=`${Math.round(w.x*r)},${Math.round(w.y*r)},${Math.round(w.z*r)}`,!(g[0]===g[1]||g[1]===g[2]||g[2]===g[0]))for(let R=0;R<3;R++){const D=(R+1)%3,I=g[R],z=g[D],j=Wv[m[R]],X=Wv[m[D]],G=`${I}_${z}`,L=`${z}_${I}`;L in y&&y[L]?(T5.dot(y[L].normal)<=s&&(v.push(j.x,j.y,j.z),v.push(X.x,X.y,X.z)),y[L]=null):G in y||(y[G]={index0:d[R],index1:d[D],normal:T5.clone()})}}for(const S in y)if(y[S]){const{index0:T,index1:A}=y[S];Gv.fromBufferAttribute(c,T),qv.fromBufferAttribute(c,A),v.push(Gv.x,Gv.y,Gv.z),v.push(qv.x,qv.y,qv.z)}this.setAttribute("position",new kn(v,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class zu{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){Mn("Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),s=0;t.push(0);for(let l=1;l<=e;l++)n=this.getPoint(l/e),s+=n.distanceTo(r),t.push(s),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let r=0;const s=n.length;let l;t?l=t:l=e*n[s-1];let c=0,f=s-1,d;for(;c<=f;)if(r=Math.floor(c+(f-c)/2),d=n[r]-l,d<0)c=r+1;else if(d>0)f=r-1;else{f=r;break}if(r=f,n[r]===l)return r/(s-1);const m=n[r],y=n[r+1]-m,v=(l-m)/y;return(r+v)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const l=this.getPoint(r),c=this.getPoint(s),f=t||(l.isVector2?new zt:new Ee);return f.copy(c).sub(l).normalize(),f}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new Ee,r=[],s=[],l=[],c=new Ee,f=new ui;for(let v=0;v<=e;v++){const S=v/e;r[v]=this.getTangentAt(S,new Ee)}s[0]=new Ee,l[0]=new Ee;let d=Number.MAX_VALUE;const m=Math.abs(r[0].x),g=Math.abs(r[0].y),y=Math.abs(r[0].z);m<=d&&(d=m,n.set(1,0,0)),g<=d&&(d=g,n.set(0,1,0)),y<=d&&n.set(0,0,1),c.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],c),l[0].crossVectors(r[0],s[0]);for(let v=1;v<=e;v++){if(s[v]=s[v-1].clone(),l[v]=l[v-1].clone(),c.crossVectors(r[v-1],r[v]),c.length()>Number.EPSILON){c.normalize();const S=Math.acos(oi(r[v-1].dot(r[v]),-1,1));s[v].applyMatrix4(f.makeRotationAxis(c,S))}l[v].crossVectors(r[v],s[v])}if(t===!0){let v=Math.acos(oi(s[0].dot(s[e]),-1,1));v/=e,r[0].dot(c.crossVectors(s[0],s[e]))>0&&(v=-v);for(let S=1;S<=e;S++)s[S].applyMatrix4(f.makeRotationAxis(r[S],v*S)),l[S].crossVectors(r[S],s[S])}return{tangents:r,normals:s,binormals:l}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class nb extends zu{constructor(e=0,t=0,n=1,r=1,s=0,l=Math.PI*2,c=!1,f=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=l,this.aClockwise=c,this.aRotation=f}getPoint(e,t=new zt){const n=t,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const l=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(l?s=0:s=r),this.aClockwise===!0&&!l&&(s===r?s=-r:s=s-r);const c=this.aStartAngle+e*s;let f=this.aX+this.xRadius*Math.cos(c),d=this.aY+this.yRadius*Math.sin(c);if(this.aRotation!==0){const m=Math.cos(this.aRotation),g=Math.sin(this.aRotation),y=f-this.aX,v=d-this.aY;f=y*m-v*g+this.aX,d=y*g+v*m+this.aY}return n.set(f,d)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class XT extends nb{constructor(e,t,n,r,s,l){super(e,t,n,n,r,s,l),this.isArcCurve=!0,this.type="ArcCurve"}}function PS(){let i=0,e=0,t=0,n=0;function r(s,l,c,f){i=s,e=c,t=-3*s+3*l-2*c-f,n=2*s-2*l+c+f}return{initCatmullRom:function(s,l,c,f,d){r(l,c,d*(c-s),d*(f-l))},initNonuniformCatmullRom:function(s,l,c,f,d,m,g){let y=(l-s)/d-(c-s)/(d+m)+(c-l)/m,v=(c-l)/m-(f-l)/(m+g)+(f-c)/g;y*=m,v*=m,r(l,c,y,v)},calc:function(s){const l=s*s,c=l*s;return i+e*s+t*l+n*c}}}const Xv=new Ee,E5=new PS,C5=new PS,N5=new PS;class YT extends zu{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new Ee){const n=t,r=this.points,s=r.length,l=(s-(this.closed?0:1))*e;let c=Math.floor(l),f=l-c;this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/s)+1)*s:f===0&&c===s-1&&(c=s-2,f=1);let d,m;this.closed||c>0?d=r[(c-1)%s]:(Xv.subVectors(r[0],r[1]).add(r[0]),d=Xv);const g=r[c%s],y=r[(c+1)%s];if(this.closed||c+2<s?m=r[(c+2)%s]:(Xv.subVectors(r[s-1],r[s-2]).add(r[s-1]),m=Xv),this.curveType==="centripetal"||this.curveType==="chordal"){const v=this.curveType==="chordal"?.5:.25;let S=Math.pow(d.distanceToSquared(g),v),T=Math.pow(g.distanceToSquared(y),v),A=Math.pow(y.distanceToSquared(m),v);T<1e-4&&(T=1),S<1e-4&&(S=T),A<1e-4&&(A=T),E5.initNonuniformCatmullRom(d.x,g.x,y.x,m.x,S,T,A),C5.initNonuniformCatmullRom(d.y,g.y,y.y,m.y,S,T,A),N5.initNonuniformCatmullRom(d.z,g.z,y.z,m.z,S,T,A)}else this.curveType==="catmullrom"&&(E5.initCatmullRom(d.x,g.x,y.x,m.x,this.tension),C5.initCatmullRom(d.y,g.y,y.y,m.y,this.tension),N5.initCatmullRom(d.z,g.z,y.z,m.z,this.tension));return n.set(E5.calc(f),C5.calc(f),N5.calc(f)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new Ee().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Jw(i,e,t,n,r){const s=(n-e)*.5,l=(r-t)*.5,c=i*i,f=i*c;return(2*t-2*n+s+l)*f+(-3*t+3*n-2*s-l)*c+s*i+t}function QR(i,e){const t=1-i;return t*t*e}function e6(i,e){return 2*(1-i)*i*e}function t6(i,e){return i*i*e}function Ig(i,e,t,n){return QR(i,e)+e6(i,t)+t6(i,n)}function n6(i,e){const t=1-i;return t*t*t*e}function i6(i,e){const t=1-i;return 3*t*t*i*e}function r6(i,e){return 3*(1-i)*i*i*e}function s6(i,e){return i*i*i*e}function Dg(i,e,t,n,r){return n6(i,e)+i6(i,t)+r6(i,n)+s6(i,r)}class IS extends zu{constructor(e=new zt,t=new zt,n=new zt,r=new zt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new zt){const n=t,r=this.v0,s=this.v1,l=this.v2,c=this.v3;return n.set(Dg(e,r.x,s.x,l.x,c.x),Dg(e,r.y,s.y,l.y,c.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class ZT extends zu{constructor(e=new Ee,t=new Ee,n=new Ee,r=new Ee){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new Ee){const n=t,r=this.v0,s=this.v1,l=this.v2,c=this.v3;return n.set(Dg(e,r.x,s.x,l.x,c.x),Dg(e,r.y,s.y,l.y,c.y),Dg(e,r.z,s.z,l.z,c.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class DS extends zu{constructor(e=new zt,t=new zt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new zt){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new zt){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class $T extends zu{constructor(e=new Ee,t=new Ee){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new Ee){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Ee){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class kS extends zu{constructor(e=new zt,t=new zt,n=new zt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new zt){const n=t,r=this.v0,s=this.v1,l=this.v2;return n.set(Ig(e,r.x,s.x,l.x),Ig(e,r.y,s.y,l.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class OS extends zu{constructor(e=new Ee,t=new Ee,n=new Ee){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Ee){const n=t,r=this.v0,s=this.v1,l=this.v2;return n.set(Ig(e,r.x,s.x,l.x),Ig(e,r.y,s.y,l.y),Ig(e,r.z,s.z,l.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class BS extends zu{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new zt){const n=t,r=this.points,s=(r.length-1)*e,l=Math.floor(s),c=s-l,f=r[l===0?l:l-1],d=r[l],m=r[l>r.length-2?r.length-1:l+1],g=r[l>r.length-3?r.length-1:l+2];return n.set(Jw(c,f.x,d.x,m.x,g.x),Jw(c,f.y,d.y,m.y,g.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new zt().fromArray(r))}return this}}var by=Object.freeze({__proto__:null,ArcCurve:XT,CatmullRomCurve3:YT,CubicBezierCurve:IS,CubicBezierCurve3:ZT,EllipseCurve:nb,LineCurve:DS,LineCurve3:$T,QuadraticBezierCurve:kS,QuadraticBezierCurve3:OS,SplineCurve:BS});class JT extends zu{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new by[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=n){const l=r[s]-n,c=this.curves[s],f=c.getLength(),d=f===0?0:1-l/f;return c.getPointAt(d,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let r=0,s=this.curves;r<s.length;r++){const l=s[r],c=l.isEllipseCurve?e*2:l.isLineCurve||l.isLineCurve3?1:l.isSplineCurve?e*l.points.length:e,f=l.getPoints(c);for(let d=0;d<f.length;d++){const m=f[d];n&&n.equals(m)||(t.push(m),n=m)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push(new by[r.type]().fromJSON(r))}return this}}class _y extends JT{constructor(e){super(),this.type="Path",this.currentPoint=new zt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new DS(this.currentPoint.clone(),new zt(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){const s=new kS(this.currentPoint.clone(),new zt(e,t),new zt(n,r));return this.curves.push(s),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,s,l){const c=new IS(this.currentPoint.clone(),new zt(e,t),new zt(n,r),new zt(s,l));return this.curves.push(c),this.currentPoint.set(s,l),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new BS(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,s,l){const c=this.currentPoint.x,f=this.currentPoint.y;return this.absarc(e+c,t+f,n,r,s,l),this}absarc(e,t,n,r,s,l){return this.absellipse(e,t,n,n,r,s,l),this}ellipse(e,t,n,r,s,l,c,f){const d=this.currentPoint.x,m=this.currentPoint.y;return this.absellipse(e+d,t+m,n,r,s,l,c,f),this}absellipse(e,t,n,r,s,l,c,f){const d=new nb(e,t,n,r,s,l,c,f);if(this.curves.length>0){const g=d.getPoint(0);g.equals(this.currentPoint)||this.lineTo(g.x,g.y)}this.curves.push(d);const m=d.getPoint(1);return this.currentPoint.copy(m),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Mp extends _y{constructor(e){super(e),this.uuid=Ac(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push(new _y().fromJSON(r))}return this}}function a6(i,e,t=2){const n=e&&e.length,r=n?e[0]*t:i.length;let s=KT(i,0,r,t,!0);const l=[];if(!s||s.next===s.prev)return l;let c,f,d;if(n&&(s=f6(i,e,s,t)),i.length>80*t){c=i[0],f=i[1];let m=c,g=f;for(let y=t;y<r;y+=t){const v=i[y],S=i[y+1];v<c&&(c=v),S<f&&(f=S),v>m&&(m=v),S>g&&(g=S)}d=Math.max(m-c,g-f),d=d!==0?32767/d:0}return Yg(s,l,t,c,f,d,0),l}function KT(i,e,t,n,r){let s;if(r===S6(i,e,t,n)>0)for(let l=e;l<t;l+=n)s=Kw(l/n|0,i[l],i[l+1],s);else for(let l=t-n;l>=e;l-=n)s=Kw(l/n|0,i[l],i[l+1],s);return s&&m0(s,s.next)&&($g(s),s=s.next),s}function Np(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(m0(t,t.next)||zs(t.prev,t,t.next)===0)){if($g(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function Yg(i,e,t,n,r,s,l){if(!i)return;!l&&s&&g6(i,n,r,s);let c=i;for(;i.prev!==i.next;){const f=i.prev,d=i.next;if(s?l6(i,n,r,s):o6(i)){e.push(f.i,i.i,d.i),$g(i),i=d.next,c=d.next;continue}if(i=d,i===c){l?l===1?(i=c6(Np(i),e),Yg(i,e,t,n,r,s,2)):l===2&&u6(i,e,t,n,r,s):Yg(Np(i),e,t,n,r,s,1);break}}}function o6(i){const e=i.prev,t=i,n=i.next;if(zs(e,t,n)>=0)return!1;const r=e.x,s=t.x,l=n.x,c=e.y,f=t.y,d=n.y,m=Math.min(r,s,l),g=Math.min(c,f,d),y=Math.max(r,s,l),v=Math.max(c,f,d);let S=n.next;for(;S!==e;){if(S.x>=m&&S.x<=y&&S.y>=g&&S.y<=v&&Mg(r,c,s,f,l,d,S.x,S.y)&&zs(S.prev,S,S.next)>=0)return!1;S=S.next}return!0}function l6(i,e,t,n){const r=i.prev,s=i,l=i.next;if(zs(r,s,l)>=0)return!1;const c=r.x,f=s.x,d=l.x,m=r.y,g=s.y,y=l.y,v=Math.min(c,f,d),S=Math.min(m,g,y),T=Math.max(c,f,d),A=Math.max(m,g,y),w=I_(v,S,e,t,n),R=I_(T,A,e,t,n);let D=i.prevZ,I=i.nextZ;for(;D&&D.z>=w&&I&&I.z<=R;){if(D.x>=v&&D.x<=T&&D.y>=S&&D.y<=A&&D!==r&&D!==l&&Mg(c,m,f,g,d,y,D.x,D.y)&&zs(D.prev,D,D.next)>=0||(D=D.prevZ,I.x>=v&&I.x<=T&&I.y>=S&&I.y<=A&&I!==r&&I!==l&&Mg(c,m,f,g,d,y,I.x,I.y)&&zs(I.prev,I,I.next)>=0))return!1;I=I.nextZ}for(;D&&D.z>=w;){if(D.x>=v&&D.x<=T&&D.y>=S&&D.y<=A&&D!==r&&D!==l&&Mg(c,m,f,g,d,y,D.x,D.y)&&zs(D.prev,D,D.next)>=0)return!1;D=D.prevZ}for(;I&&I.z<=R;){if(I.x>=v&&I.x<=T&&I.y>=S&&I.y<=A&&I!==r&&I!==l&&Mg(c,m,f,g,d,y,I.x,I.y)&&zs(I.prev,I,I.next)>=0)return!1;I=I.nextZ}return!0}function c6(i,e){let t=i;do{const n=t.prev,r=t.next.next;!m0(n,r)&&eE(n,t,t.next,r)&&Zg(n,r)&&Zg(r,n)&&(e.push(n.i,t.i,r.i),$g(t),$g(t.next),t=i=r),t=t.next}while(t!==i);return Np(t)}function u6(i,e,t,n,r,s){let l=i;do{let c=l.next.next;for(;c!==l.prev;){if(l.i!==c.i&&y6(l,c)){let f=tE(l,c);l=Np(l,l.next),f=Np(f,f.next),Yg(l,e,t,n,r,s,0),Yg(f,e,t,n,r,s,0);return}c=c.next}l=l.next}while(l!==i)}function f6(i,e,t,n){const r=[];for(let s=0,l=e.length;s<l;s++){const c=e[s]*n,f=s<l-1?e[s+1]*n:i.length,d=KT(i,c,f,n,!1);d===d.next&&(d.steiner=!0),r.push(x6(d))}r.sort(h6);for(let s=0;s<r.length;s++)t=d6(r[s],t);return t}function h6(i,e){let t=i.x-e.x;if(t===0&&(t=i.y-e.y,t===0)){const n=(i.next.y-i.y)/(i.next.x-i.x),r=(e.next.y-e.y)/(e.next.x-e.x);t=n-r}return t}function d6(i,e){const t=p6(i,e);if(!t)return e;const n=tE(t,i);return Np(n,n.next),Np(t,t.next)}function p6(i,e){let t=e;const n=i.x,r=i.y;let s=-1/0,l;if(m0(i,t))return t;do{if(m0(i,t.next))return t.next;if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const g=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(g<=n&&g>s&&(s=g,l=t.x<t.next.x?t:t.next,g===n))return l}t=t.next}while(t!==e);if(!l)return null;const c=l,f=l.x,d=l.y;let m=1/0;t=l;do{if(n>=t.x&&t.x>=f&&n!==t.x&&QT(r<d?n:s,r,f,d,r<d?s:n,r,t.x,t.y)){const g=Math.abs(r-t.y)/(n-t.x);Zg(t,i)&&(g<m||g===m&&(t.x>l.x||t.x===l.x&&m6(l,t)))&&(l=t,m=g)}t=t.next}while(t!==c);return l}function m6(i,e){return zs(i.prev,i,e.prev)<0&&zs(e.next,i,i.next)<0}function g6(i,e,t,n){let r=i;do r.z===0&&(r.z=I_(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,v6(r)}function v6(i){let e,t=1;do{let n=i,r;i=null;let s=null;for(e=0;n;){e++;let l=n,c=0;for(let d=0;d<t&&(c++,l=l.nextZ,!!l);d++);let f=t;for(;c>0||f>0&&l;)c!==0&&(f===0||!l||n.z<=l.z)?(r=n,n=n.nextZ,c--):(r=l,l=l.nextZ,f--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;n=l}s.nextZ=null,t*=2}while(e>1);return i}function I_(i,e,t,n,r){return i=(i-t)*r|0,e=(e-n)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function x6(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function QT(i,e,t,n,r,s,l,c){return(r-l)*(e-c)>=(i-l)*(s-c)&&(i-l)*(n-c)>=(t-l)*(e-c)&&(t-l)*(s-c)>=(r-l)*(n-c)}function Mg(i,e,t,n,r,s,l,c){return!(i===l&&e===c)&&QT(i,e,t,n,r,s,l,c)}function y6(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!b6(i,e)&&(Zg(i,e)&&Zg(e,i)&&_6(i,e)&&(zs(i.prev,i,e.prev)||zs(i,e.prev,e))||m0(i,e)&&zs(i.prev,i,i.next)>0&&zs(e.prev,e,e.next)>0)}function zs(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function m0(i,e){return i.x===e.x&&i.y===e.y}function eE(i,e,t,n){const r=Zv(zs(i,e,t)),s=Zv(zs(i,e,n)),l=Zv(zs(t,n,i)),c=Zv(zs(t,n,e));return!!(r!==s&&l!==c||r===0&&Yv(i,t,e)||s===0&&Yv(i,n,e)||l===0&&Yv(t,i,n)||c===0&&Yv(t,e,n))}function Yv(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function Zv(i){return i>0?1:i<0?-1:0}function b6(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&eE(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function Zg(i,e){return zs(i.prev,i,i.next)<0?zs(i,e,i.next)>=0&&zs(i,i.prev,e)>=0:zs(i,e,i.prev)<0||zs(i,i.next,e)<0}function _6(i,e){let t=i,n=!1;const r=(i.x+e.x)/2,s=(i.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function tE(i,e){const t=D_(i.i,i.x,i.y),n=D_(e.i,e.x,e.y),r=i.next,s=e.prev;return i.next=e,e.prev=i,t.next=r,r.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function Kw(i,e,t,n){const r=D_(i,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function $g(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function D_(i,e,t){return{i,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function S6(i,e,t,n){let r=0;for(let s=e,l=t-n;s<t;s+=n)r+=(i[l]-i[s])*(i[s+1]+i[l+1]),l=s;return r}class w6{static triangulate(e,t,n=2){return a6(e,t,n)}}class ku{static area(e){const t=e.length;let n=0;for(let r=t-1,s=0;s<t;r=s++)n+=e[r].x*e[s].y-e[s].x*e[r].y;return n*.5}static isClockWise(e){return ku.area(e)<0}static triangulateShape(e,t){const n=[],r=[],s=[];Qw(e),e3(n,e);let l=e.length;t.forEach(Qw);for(let f=0;f<t.length;f++)r.push(l),l+=t[f].length,e3(n,t[f]);const c=w6.triangulate(n,r);for(let f=0;f<c.length;f+=3)s.push(c.slice(f,f+3));return s}}function Qw(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function e3(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}class ib extends Si{constructor(e=new Mp([new zt(.5,.5),new zt(-.5,.5),new zt(-.5,-.5),new zt(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],s=[];for(let c=0,f=e.length;c<f;c++){const d=e[c];l(d)}this.setAttribute("position",new kn(r,3)),this.setAttribute("uv",new kn(s,2)),this.computeVertexNormals();function l(c){const f=[],d=t.curveSegments!==void 0?t.curveSegments:12,m=t.steps!==void 0?t.steps:1,g=t.depth!==void 0?t.depth:1;let y=t.bevelEnabled!==void 0?t.bevelEnabled:!0,v=t.bevelThickness!==void 0?t.bevelThickness:.2,S=t.bevelSize!==void 0?t.bevelSize:v-.1,T=t.bevelOffset!==void 0?t.bevelOffset:0,A=t.bevelSegments!==void 0?t.bevelSegments:3;const w=t.extrudePath,R=t.UVGenerator!==void 0?t.UVGenerator:M6;let D,I=!1,z,j,X,G;if(w){D=w.getSpacedPoints(m),I=!0,y=!1;const Je=w.isCatmullRomCurve3?w.closed:!1;z=w.computeFrenetFrames(m,Je),j=new Ee,X=new Ee,G=new Ee}y||(A=0,v=0,S=0,T=0);const L=c.extractPoints(d);let k=L.shape;const U=L.holes;if(!ku.isClockWise(k)){k=k.reverse();for(let Je=0,le=U.length;Je<le;Je++){const Qe=U[Je];ku.isClockWise(Qe)&&(U[Je]=Qe.reverse())}}function W(Je){const Qe=10000000000000001e-36;let Et=Je[0];for(let we=1;we<=Je.length;we++){const ot=we%Je.length,Ct=Je[ot],ht=Ct.x-Et.x,xt=Ct.y-Et.y,he=ht*ht+xt*xt,Q=Math.max(Math.abs(Ct.x),Math.abs(Ct.y),Math.abs(Et.x),Math.abs(Et.y)),Be=Qe*Q*Q;if(he<=Be){Je.splice(ot,1),we--;continue}Et=Ct}}W(k),U.forEach(W);const J=U.length,ce=k;for(let Je=0;Je<J;Je++){const le=U[Je];k=k.concat(le)}function K(Je,le,Qe){return le||Hn("ExtrudeGeometry: vec does not exist"),Je.clone().addScaledVector(le,Qe)}const ne=k.length;function pe(Je,le,Qe){let Et,we,ot;const Ct=Je.x-le.x,ht=Je.y-le.y,xt=Qe.x-Je.x,he=Qe.y-Je.y,Q=Ct*Ct+ht*ht,Be=Ct*he-ht*xt;if(Math.abs(Be)>Number.EPSILON){const ue=Math.sqrt(Q),je=Math.sqrt(xt*xt+he*he),Ye=le.x-ht/ue,ft=le.y+Ct/ue,gt=Qe.x-he/je,Lt=Qe.y+xt/je,un=((gt-Ye)*he-(Lt-ft)*xt)/(Ct*he-ht*xt);Et=Ye+Ct*un-Je.x,we=ft+ht*un-Je.y;const bt=Et*Et+we*we;if(bt<=2)return new zt(Et,we);ot=Math.sqrt(bt/2)}else{let ue=!1;Ct>Number.EPSILON?xt>Number.EPSILON&&(ue=!0):Ct<-Number.EPSILON?xt<-Number.EPSILON&&(ue=!0):Math.sign(ht)===Math.sign(he)&&(ue=!0),ue?(Et=-ht,we=Ct,ot=Math.sqrt(Q)):(Et=Ct,we=ht,ot=Math.sqrt(Q/2))}return new zt(Et/ot,we/ot)}const Re=[];for(let Je=0,le=ce.length,Qe=le-1,Et=Je+1;Je<le;Je++,Qe++,Et++)Qe===le&&(Qe=0),Et===le&&(Et=0),Re[Je]=pe(ce[Je],ce[Qe],ce[Et]);const Te=[];let ee,F=Re.concat();for(let Je=0,le=J;Je<le;Je++){const Qe=U[Je];ee=[];for(let Et=0,we=Qe.length,ot=we-1,Ct=Et+1;Et<we;Et++,ot++,Ct++)ot===we&&(ot=0),Ct===we&&(Ct=0),ee[Et]=pe(Qe[Et],Qe[ot],Qe[Ct]);Te.push(ee),F=F.concat(ee)}let $;if(A===0)$=ku.triangulateShape(ce,U);else{const Je=[],le=[];for(let Qe=0;Qe<A;Qe++){const Et=Qe/A,we=v*Math.cos(Et*Math.PI/2),ot=S*Math.sin(Et*Math.PI/2)+T;for(let Ct=0,ht=ce.length;Ct<ht;Ct++){const xt=K(ce[Ct],Re[Ct],ot);Fe(xt.x,xt.y,-we),Et===0&&Je.push(xt)}for(let Ct=0,ht=J;Ct<ht;Ct++){const xt=U[Ct];ee=Te[Ct];const he=[];for(let Q=0,Be=xt.length;Q<Be;Q++){const ue=K(xt[Q],ee[Q],ot);Fe(ue.x,ue.y,-we),Et===0&&he.push(ue)}Et===0&&le.push(he)}}$=ku.triangulateShape(Je,le)}const re=$.length,Ae=S+T;for(let Je=0;Je<ne;Je++){const le=y?K(k[Je],F[Je],Ae):k[Je];I?(X.copy(z.normals[0]).multiplyScalar(le.x),j.copy(z.binormals[0]).multiplyScalar(le.y),G.copy(D[0]).add(X).add(j),Fe(G.x,G.y,G.z)):Fe(le.x,le.y,0)}for(let Je=1;Je<=m;Je++)for(let le=0;le<ne;le++){const Qe=y?K(k[le],F[le],Ae):k[le];I?(X.copy(z.normals[Je]).multiplyScalar(Qe.x),j.copy(z.binormals[Je]).multiplyScalar(Qe.y),G.copy(D[Je]).add(X).add(j),Fe(G.x,G.y,G.z)):Fe(Qe.x,Qe.y,g/m*Je)}for(let Je=A-1;Je>=0;Je--){const le=Je/A,Qe=v*Math.cos(le*Math.PI/2),Et=S*Math.sin(le*Math.PI/2)+T;for(let we=0,ot=ce.length;we<ot;we++){const Ct=K(ce[we],Re[we],Et);Fe(Ct.x,Ct.y,g+Qe)}for(let we=0,ot=U.length;we<ot;we++){const Ct=U[we];ee=Te[we];for(let ht=0,xt=Ct.length;ht<xt;ht++){const he=K(Ct[ht],ee[ht],Et);I?Fe(he.x,he.y+D[m-1].y,D[m-1].x+Qe):Fe(he.x,he.y,g+Qe)}}}ie(),_e();function ie(){const Je=r.length/3;if(y){let le=0,Qe=ne*le;for(let Et=0;Et<re;Et++){const we=$[Et];We(we[2]+Qe,we[1]+Qe,we[0]+Qe)}le=m+A*2,Qe=ne*le;for(let Et=0;Et<re;Et++){const we=$[Et];We(we[0]+Qe,we[1]+Qe,we[2]+Qe)}}else{for(let le=0;le<re;le++){const Qe=$[le];We(Qe[2],Qe[1],Qe[0])}for(let le=0;le<re;le++){const Qe=$[le];We(Qe[0]+ne*m,Qe[1]+ne*m,Qe[2]+ne*m)}}n.addGroup(Je,r.length/3-Je,0)}function _e(){const Je=r.length/3;let le=0;ke(ce,le),le+=ce.length;for(let Qe=0,Et=U.length;Qe<Et;Qe++){const we=U[Qe];ke(we,le),le+=we.length}n.addGroup(Je,r.length/3-Je,1)}function ke(Je,le){let Qe=Je.length;for(;--Qe>=0;){const Et=Qe;let we=Qe-1;we<0&&(we=Je.length-1);for(let ot=0,Ct=m+A*2;ot<Ct;ot++){const ht=ne*ot,xt=ne*(ot+1),he=le+Et+ht,Q=le+we+ht,Be=le+we+xt,ue=le+Et+xt;nt(he,Q,Be,ue)}}}function Fe(Je,le,Qe){f.push(Je),f.push(le),f.push(Qe)}function We(Je,le,Qe){It(Je),It(le),It(Qe);const Et=r.length/3,we=R.generateTopUV(n,r,Et-3,Et-2,Et-1);wt(we[0]),wt(we[1]),wt(we[2])}function nt(Je,le,Qe,Et){It(Je),It(le),It(Et),It(le),It(Qe),It(Et);const we=r.length/3,ot=R.generateSideWallUV(n,r,we-6,we-3,we-2,we-1);wt(ot[0]),wt(ot[1]),wt(ot[3]),wt(ot[1]),wt(ot[2]),wt(ot[3])}function It(Je){r.push(f[Je*3+0]),r.push(f[Je*3+1]),r.push(f[Je*3+2])}function wt(Je){s.push(Je.x),s.push(Je.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return A6(t,n,e)}static fromJSON(e,t){const n=[];for(let s=0,l=e.shapes.length;s<l;s++){const c=t[e.shapes[s]];n.push(c)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new by[r.type]().fromJSON(r)),new ib(n,e.options)}}const M6={generateTopUV:function(i,e,t,n,r){const s=e[t*3],l=e[t*3+1],c=e[n*3],f=e[n*3+1],d=e[r*3],m=e[r*3+1];return[new zt(s,l),new zt(c,f),new zt(d,m)]},generateSideWallUV:function(i,e,t,n,r,s){const l=e[t*3],c=e[t*3+1],f=e[t*3+2],d=e[n*3],m=e[n*3+1],g=e[n*3+2],y=e[r*3],v=e[r*3+1],S=e[r*3+2],T=e[s*3],A=e[s*3+1],w=e[s*3+2];return Math.abs(c-m)<Math.abs(l-d)?[new zt(l,1-f),new zt(d,1-g),new zt(y,1-S),new zt(T,1-w)]:[new zt(c,1-f),new zt(m,1-g),new zt(v,1-S),new zt(A,1-w)]}};function A6(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,r=i.length;n<r;n++){const s=i[n];t.shapes.push(s.uuid)}else t.shapes.push(i.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class v1 extends bd{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new v1(e.radius,e.detail)}}class rb extends Si{constructor(e=[new zt(0,-.5),new zt(.5,0),new zt(0,.5)],t=12,n=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=oi(r,0,Math.PI*2);const s=[],l=[],c=[],f=[],d=[],m=1/t,g=new Ee,y=new zt,v=new Ee,S=new Ee,T=new Ee;let A=0,w=0;for(let R=0;R<=e.length-1;R++)switch(R){case 0:A=e[R+1].x-e[R].x,w=e[R+1].y-e[R].y,v.x=w*1,v.y=-A,v.z=w*0,T.copy(v),v.normalize(),f.push(v.x,v.y,v.z);break;case e.length-1:f.push(T.x,T.y,T.z);break;default:A=e[R+1].x-e[R].x,w=e[R+1].y-e[R].y,v.x=w*1,v.y=-A,v.z=w*0,S.copy(v),v.x+=T.x,v.y+=T.y,v.z+=T.z,v.normalize(),f.push(v.x,v.y,v.z),T.copy(S)}for(let R=0;R<=t;R++){const D=n+R*m*r,I=Math.sin(D),z=Math.cos(D);for(let j=0;j<=e.length-1;j++){g.x=e[j].x*I,g.y=e[j].y,g.z=e[j].x*z,l.push(g.x,g.y,g.z),y.x=R/t,y.y=j/(e.length-1),c.push(y.x,y.y);const X=f[3*j+0]*I,G=f[3*j+1],L=f[3*j+0]*z;d.push(X,G,L)}}for(let R=0;R<t;R++)for(let D=0;D<e.length-1;D++){const I=D+R*e.length,z=I,j=I+e.length,X=I+e.length+1,G=I+1;s.push(z,j,G),s.push(X,G,j)}this.setIndex(s),this.setAttribute("position",new kn(l,3)),this.setAttribute("uv",new kn(c,2)),this.setAttribute("normal",new kn(d,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new rb(e.points,e.segments,e.phiStart,e.phiLength)}}class x1 extends bd{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,r,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new x1(e.radius,e.detail)}}class _d extends Si{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const s=e/2,l=t/2,c=Math.floor(n),f=Math.floor(r),d=c+1,m=f+1,g=e/c,y=t/f,v=[],S=[],T=[],A=[];for(let w=0;w<m;w++){const R=w*y-l;for(let D=0;D<d;D++){const I=D*g-s;S.push(I,-R,0),T.push(0,0,1),A.push(D/c),A.push(1-w/f)}}for(let w=0;w<f;w++)for(let R=0;R<c;R++){const D=R+d*w,I=R+d*(w+1),z=R+1+d*(w+1),j=R+1+d*w;v.push(D,I,j),v.push(I,z,j)}this.setIndex(v),this.setAttribute("position",new kn(S,3)),this.setAttribute("normal",new kn(T,3)),this.setAttribute("uv",new kn(A,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _d(e.width,e.height,e.widthSegments,e.heightSegments)}}class sb extends Si{constructor(e=.5,t=1,n=32,r=1,s=0,l=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:s,thetaLength:l},n=Math.max(3,n),r=Math.max(1,r);const c=[],f=[],d=[],m=[];let g=e;const y=(t-e)/r,v=new Ee,S=new zt;for(let T=0;T<=r;T++){for(let A=0;A<=n;A++){const w=s+A/n*l;v.x=g*Math.cos(w),v.y=g*Math.sin(w),f.push(v.x,v.y,v.z),d.push(0,0,1),S.x=(v.x/t+1)/2,S.y=(v.y/t+1)/2,m.push(S.x,S.y)}g+=y}for(let T=0;T<r;T++){const A=T*(n+1);for(let w=0;w<n;w++){const R=w+A,D=R,I=R+n+1,z=R+n+2,j=R+1;c.push(D,I,j),c.push(I,z,j)}}this.setIndex(c),this.setAttribute("position",new kn(f,3)),this.setAttribute("normal",new kn(d,3)),this.setAttribute("uv",new kn(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sb(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class ab extends Si{constructor(e=new Mp([new zt(0,.5),new zt(-.5,-.5),new zt(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],r=[],s=[],l=[];let c=0,f=0;if(Array.isArray(e)===!1)d(e);else for(let m=0;m<e.length;m++)d(e[m]),this.addGroup(c,f,m),c+=f,f=0;this.setIndex(n),this.setAttribute("position",new kn(r,3)),this.setAttribute("normal",new kn(s,3)),this.setAttribute("uv",new kn(l,2));function d(m){const g=r.length/3,y=m.extractPoints(t);let v=y.shape;const S=y.holes;ku.isClockWise(v)===!1&&(v=v.reverse());for(let A=0,w=S.length;A<w;A++){const R=S[A];ku.isClockWise(R)===!0&&(S[A]=R.reverse())}const T=ku.triangulateShape(v,S);for(let A=0,w=S.length;A<w;A++){const R=S[A];v=v.concat(R)}for(let A=0,w=v.length;A<w;A++){const R=v[A];r.push(R.x,R.y,0),s.push(0,0,1),l.push(R.x,R.y)}for(let A=0,w=T.length;A<w;A++){const R=T[A],D=R[0]+g,I=R[1]+g,z=R[2]+g;n.push(D,I,z),f+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return T6(t,e)}static fromJSON(e,t){const n=[];for(let r=0,s=e.shapes.length;r<s;r++){const l=t[e.shapes[r]];n.push(l)}return new ab(n,e.curveSegments)}}function T6(i,e){if(e.shapes=[],Array.isArray(i))for(let t=0,n=i.length;t<n;t++){const r=i[t];e.shapes.push(r.uuid)}else e.shapes.push(i.uuid);return e}class y1 extends Si{constructor(e=1,t=32,n=16,r=0,s=Math.PI*2,l=0,c=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:s,thetaStart:l,thetaLength:c},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const f=Math.min(l+c,Math.PI);let d=0;const m=[],g=new Ee,y=new Ee,v=[],S=[],T=[],A=[];for(let w=0;w<=n;w++){const R=[],D=w/n;let I=0;w===0&&l===0?I=.5/t:w===n&&f===Math.PI&&(I=-.5/t);for(let z=0;z<=t;z++){const j=z/t;g.x=-e*Math.cos(r+j*s)*Math.sin(l+D*c),g.y=e*Math.cos(l+D*c),g.z=e*Math.sin(r+j*s)*Math.sin(l+D*c),S.push(g.x,g.y,g.z),y.copy(g).normalize(),T.push(y.x,y.y,y.z),A.push(j+I,1-D),R.push(d++)}m.push(R)}for(let w=0;w<n;w++)for(let R=0;R<t;R++){const D=m[w][R+1],I=m[w][R],z=m[w+1][R],j=m[w+1][R+1];(w!==0||l>0)&&v.push(D,I,j),(w!==n-1||f<Math.PI)&&v.push(I,z,j)}this.setIndex(v),this.setAttribute("position",new kn(S,3)),this.setAttribute("normal",new kn(T,3)),this.setAttribute("uv",new kn(A,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new y1(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class ob extends bd{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,r,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new ob(e.radius,e.detail)}}class lb extends Si{constructor(e=1,t=.4,n=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:s},n=Math.floor(n),r=Math.floor(r);const l=[],c=[],f=[],d=[],m=new Ee,g=new Ee,y=new Ee;for(let v=0;v<=n;v++)for(let S=0;S<=r;S++){const T=S/r*s,A=v/n*Math.PI*2;g.x=(e+t*Math.cos(A))*Math.cos(T),g.y=(e+t*Math.cos(A))*Math.sin(T),g.z=t*Math.sin(A),c.push(g.x,g.y,g.z),m.x=e*Math.cos(T),m.y=e*Math.sin(T),y.subVectors(g,m).normalize(),f.push(y.x,y.y,y.z),d.push(S/r),d.push(v/n)}for(let v=1;v<=n;v++)for(let S=1;S<=r;S++){const T=(r+1)*v+S-1,A=(r+1)*(v-1)+S-1,w=(r+1)*(v-1)+S,R=(r+1)*v+S;l.push(T,A,R),l.push(A,w,R)}this.setIndex(l),this.setAttribute("position",new kn(c,3)),this.setAttribute("normal",new kn(f,3)),this.setAttribute("uv",new kn(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new lb(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class cb extends Si{constructor(e=1,t=.4,n=64,r=8,s=2,l=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:s,q:l},n=Math.floor(n),r=Math.floor(r);const c=[],f=[],d=[],m=[],g=new Ee,y=new Ee,v=new Ee,S=new Ee,T=new Ee,A=new Ee,w=new Ee;for(let D=0;D<=n;++D){const I=D/n*s*Math.PI*2;R(I,s,l,e,v),R(I+.01,s,l,e,S),A.subVectors(S,v),w.addVectors(S,v),T.crossVectors(A,w),w.crossVectors(T,A),T.normalize(),w.normalize();for(let z=0;z<=r;++z){const j=z/r*Math.PI*2,X=-t*Math.cos(j),G=t*Math.sin(j);g.x=v.x+(X*w.x+G*T.x),g.y=v.y+(X*w.y+G*T.y),g.z=v.z+(X*w.z+G*T.z),f.push(g.x,g.y,g.z),y.subVectors(g,v).normalize(),d.push(y.x,y.y,y.z),m.push(D/n),m.push(z/r)}}for(let D=1;D<=n;D++)for(let I=1;I<=r;I++){const z=(r+1)*(D-1)+(I-1),j=(r+1)*D+(I-1),X=(r+1)*D+I,G=(r+1)*(D-1)+I;c.push(z,j,G),c.push(j,X,G)}this.setIndex(c),this.setAttribute("position",new kn(f,3)),this.setAttribute("normal",new kn(d,3)),this.setAttribute("uv",new kn(m,2));function R(D,I,z,j,X){const G=Math.cos(D),L=Math.sin(D),k=z/I*D,U=Math.cos(k);X.x=j*(2+U)*.5*G,X.y=j*(2+U)*L*.5,X.z=j*Math.sin(k)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new cb(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class ub extends Si{constructor(e=new OS(new Ee(-1,-1,0),new Ee(-1,1,0),new Ee(1,1,0)),t=64,n=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:s};const l=e.computeFrenetFrames(t,s);this.tangents=l.tangents,this.normals=l.normals,this.binormals=l.binormals;const c=new Ee,f=new Ee,d=new zt;let m=new Ee;const g=[],y=[],v=[],S=[];T(),this.setIndex(S),this.setAttribute("position",new kn(g,3)),this.setAttribute("normal",new kn(y,3)),this.setAttribute("uv",new kn(v,2));function T(){for(let D=0;D<t;D++)A(D);A(s===!1?t:0),R(),w()}function A(D){m=e.getPointAt(D/t,m);const I=l.normals[D],z=l.binormals[D];for(let j=0;j<=r;j++){const X=j/r*Math.PI*2,G=Math.sin(X),L=-Math.cos(X);f.x=L*I.x+G*z.x,f.y=L*I.y+G*z.y,f.z=L*I.z+G*z.z,f.normalize(),y.push(f.x,f.y,f.z),c.x=m.x+n*f.x,c.y=m.y+n*f.y,c.z=m.z+n*f.z,g.push(c.x,c.y,c.z)}}function w(){for(let D=1;D<=t;D++)for(let I=1;I<=r;I++){const z=(r+1)*(D-1)+(I-1),j=(r+1)*D+(I-1),X=(r+1)*D+I,G=(r+1)*(D-1)+I;S.push(z,j,G),S.push(j,X,G)}}function R(){for(let D=0;D<=t;D++)for(let I=0;I<=r;I++)d.x=D/t,d.y=I/r,v.push(d.x,d.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new ub(new by[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class nE extends Si{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,r=new Ee,s=new Ee;if(e.index!==null){const l=e.attributes.position,c=e.index;let f=e.groups;f.length===0&&(f=[{start:0,count:c.count,materialIndex:0}]);for(let d=0,m=f.length;d<m;++d){const g=f[d],y=g.start,v=g.count;for(let S=y,T=y+v;S<T;S+=3)for(let A=0;A<3;A++){const w=c.getX(S+A),R=c.getX(S+(A+1)%3);r.fromBufferAttribute(l,w),s.fromBufferAttribute(l,R),t3(r,s,n)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const l=e.attributes.position;for(let c=0,f=l.count/3;c<f;c++)for(let d=0;d<3;d++){const m=3*c+d,g=3*c+(d+1)%3;r.fromBufferAttribute(l,m),s.fromBufferAttribute(l,g),t3(r,s,n)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new kn(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function t3(i,e,t){const n=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return t.has(n)===!0||t.has(r)===!0?!1:(t.add(n),t.add(r),!0)}var n3=Object.freeze({__proto__:null,BoxGeometry:Dp,CapsuleGeometry:Qy,CircleGeometry:eb,ConeGeometry:g1,CylinderGeometry:m1,DodecahedronGeometry:tb,EdgesGeometry:WT,ExtrudeGeometry:ib,IcosahedronGeometry:v1,LatheGeometry:rb,OctahedronGeometry:x1,PlaneGeometry:_d,PolyhedronGeometry:bd,RingGeometry:sb,ShapeGeometry:ab,SphereGeometry:y1,TetrahedronGeometry:ob,TorusGeometry:lb,TorusKnotGeometry:cb,TubeGeometry:ub,WireframeGeometry:nE});class iE extends zo{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new fn(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class US extends fl{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class g0 extends zo{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new fn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=yd,this.normalScale=new zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Cc,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Sy extends g0{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new zt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return oi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new fn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new fn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new fn(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class rE extends zo{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new fn(16777215),this.specular=new fn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=yd,this.normalScale=new zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Cc,this.combine=c1,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class sE extends zo{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new fn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=yd,this.normalScale=new zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class aE extends zo{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=yd,this.normalScale=new zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class oE extends zo{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new fn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=yd,this.normalScale=new zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Cc,this.combine=c1,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class FS extends zo{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=bT,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class zS extends zo{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class lE extends zo{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new fn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=yd,this.normalScale=new zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}}class cE extends hl{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function bp(i,e){return!i||i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}function uE(i){function e(r,s){return i[r]-i[s]}const t=i.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(e),n}function k_(i,e,t){const n=i.length,r=new i.constructor(n);for(let s=0,l=0;l!==n;++s){const c=t[s]*e;for(let f=0;f!==e;++f)r[l++]=i[c+f]}return r}function jS(i,e,t,n){let r=1,s=i[0];for(;s!==void 0&&s[n]===void 0;)s=i[r++];if(s===void 0)return;let l=s[n];if(l!==void 0)if(Array.isArray(l))do l=s[n],l!==void 0&&(e.push(s.time),t.push(...l)),s=i[r++];while(s!==void 0);else if(l.toArray!==void 0)do l=s[n],l!==void 0&&(e.push(s.time),l.toArray(t,t.length)),s=i[r++];while(s!==void 0);else do l=s[n],l!==void 0&&(e.push(s.time),t.push(l)),s=i[r++];while(s!==void 0)}function E6(i,e,t,n,r=30){const s=i.clone();s.name=e;const l=[];for(let f=0;f<s.tracks.length;++f){const d=s.tracks[f],m=d.getValueSize(),g=[],y=[];for(let v=0;v<d.times.length;++v){const S=d.times[v]*r;if(!(S<t||S>=n)){g.push(d.times[v]);for(let T=0;T<m;++T)y.push(d.values[v*m+T])}}g.length!==0&&(d.times=bp(g,d.times.constructor),d.values=bp(y,d.values.constructor),l.push(d))}s.tracks=l;let c=1/0;for(let f=0;f<s.tracks.length;++f)c>s.tracks[f].times[0]&&(c=s.tracks[f].times[0]);for(let f=0;f<s.tracks.length;++f)s.tracks[f].shift(-1*c);return s.resetDuration(),s}function C6(i,e=0,t=i,n=30){n<=0&&(n=30);const r=t.tracks.length,s=e/n;for(let l=0;l<r;++l){const c=t.tracks[l],f=c.ValueTypeName;if(f==="bool"||f==="string")continue;const d=i.tracks.find(function(w){return w.name===c.name&&w.ValueTypeName===f});if(d===void 0)continue;let m=0;const g=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=g/3);let y=0;const v=d.getValueSize();d.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(y=v/3);const S=c.times.length-1;let T;if(s<=c.times[0]){const w=m,R=g-m;T=c.values.slice(w,R)}else if(s>=c.times[S]){const w=S*g+m,R=w+g-m;T=c.values.slice(w,R)}else{const w=c.createInterpolant(),R=m,D=g-m;w.evaluate(s),T=w.resultBuffer.slice(R,D)}f==="quaternion"&&new Uo().fromArray(T).normalize().conjugate().toArray(T);const A=d.times.length;for(let w=0;w<A;++w){const R=w*v+y;if(f==="quaternion")Uo.multiplyQuaternionsFlat(d.values,R,T,0,d.values,R);else{const D=v-y*2;for(let I=0;I<D;++I)d.values[R+I]-=T[I]}}}return i.blendMode=wS,i}class N6{static convertArray(e,t){return bp(e,t)}static isTypedArray(e){return NT(e)}static getKeyframeOrder(e){return uE(e)}static sortedArray(e,t,n){return k_(e,t,n)}static flattenJSON(e,t,n,r){jS(e,t,n,r)}static subclip(e,t,n,r,s=30){return E6(e,t,n,r,s)}static makeClipAdditive(e,t=0,n=e,r=30){return C6(e,t,n,r)}}class b1{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],s=t[n-1];e:{t:{let l;n:{r:if(!(e<r)){for(let c=n+2;;){if(r===void 0){if(e<s)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===c)break;if(s=r,r=t[++n],e<r)break t}l=t.length;break n}if(!(e>=s)){const c=t[1];e<c&&(n=2,s=c);for(let f=n-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===f)break;if(r=s,s=t[--n-1],e>=s)break t}l=n,n=0;break n}break e}for(;n<l;){const c=n+l>>>1;e<t[c]?l=c:n=c+1}if(r=t[n],s=t[n-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let l=0;l!==r;++l)t[l]=n[s+l];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class fE extends b1{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:gp,endingEnd:gp}}intervalChanged_(e,t,n){const r=this.parameterPositions;let s=e-2,l=e+1,c=r[s],f=r[l];if(c===void 0)switch(this.getSettings_().endingStart){case vp:s=e,c=2*t-n;break;case Hg:s=r.length-2,c=t+r[s]-r[s+1];break;default:s=e,c=n}if(f===void 0)switch(this.getSettings_().endingEnd){case vp:l=e,f=2*n-t;break;case Hg:l=1,f=n+r[1]-r[0];break;default:l=e-1,f=t}const d=(n-t)*.5,m=this.valueSize;this._weightPrev=d/(t-c),this._weightNext=d/(f-n),this._offsetPrev=s*m,this._offsetNext=l*m}interpolate_(e,t,n,r){const s=this.resultBuffer,l=this.sampleValues,c=this.valueSize,f=e*c,d=f-c,m=this._offsetPrev,g=this._offsetNext,y=this._weightPrev,v=this._weightNext,S=(n-t)/(r-t),T=S*S,A=T*S,w=-y*A+2*y*T-y*S,R=(1+y)*A+(-1.5-2*y)*T+(-.5+y)*S+1,D=(-1-v)*A+(1.5+v)*T+.5*S,I=v*A-v*T;for(let z=0;z!==c;++z)s[z]=w*l[m+z]+R*l[d+z]+D*l[f+z]+I*l[g+z];return s}}class VS extends b1{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,l=this.sampleValues,c=this.valueSize,f=e*c,d=f-c,m=(n-t)/(r-t),g=1-m;for(let y=0;y!==c;++y)s[y]=l[d+y]*g+l[f+y]*m;return s}}class hE extends b1{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class lu{constructor(e,t,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=bp(t,this.TimeBufferType),this.values=bp(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:bp(e.times,Array),values:bp(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new hE(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new VS(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new fE(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Vg:t=this.InterpolantFactoryMethodDiscrete;break;case vy:t=this.InterpolantFactoryMethodLinear;break;case yx:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return Mn("KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Vg;case this.InterpolantFactoryMethodLinear:return vy;case this.InterpolantFactoryMethodSmooth:return yx}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let s=0,l=r-1;for(;s!==r&&n[s]<e;)++s;for(;l!==-1&&n[l]>t;)--l;if(++l,s!==0||l!==r){s>=l&&(l=Math.max(l,1),s=l-1);const c=this.getValueSize();this.times=n.slice(s,l),this.values=this.values.slice(s*c,l*c)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(Hn("KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,s=n.length;s===0&&(Hn("KeyframeTrack: Track is empty.",this),e=!1);let l=null;for(let c=0;c!==s;c++){const f=n[c];if(typeof f=="number"&&isNaN(f)){Hn("KeyframeTrack: Time is not a valid number.",this,c,f),e=!1;break}if(l!==null&&l>f){Hn("KeyframeTrack: Out of order keys.",this,c,f,l),e=!1;break}l=f}if(r!==void 0&&NT(r))for(let c=0,f=r.length;c!==f;++c){const d=r[c];if(isNaN(d)){Hn("KeyframeTrack: Value is not a valid number.",this,c,d),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===yx,s=e.length-1;let l=1;for(let c=1;c<s;++c){let f=!1;const d=e[c],m=e[c+1];if(d!==m&&(c!==1||d!==e[0]))if(r)f=!0;else{const g=c*n,y=g-n,v=g+n;for(let S=0;S!==n;++S){const T=t[g+S];if(T!==t[y+S]||T!==t[v+S]){f=!0;break}}}if(f){if(c!==l){e[l]=e[c];const g=c*n,y=l*n;for(let v=0;v!==n;++v)t[y+v]=t[g+v]}++l}}if(s>0){e[l]=e[s];for(let c=s*n,f=l*n,d=0;d!==n;++d)t[f+d]=t[c+d];++l}return l!==e.length?(this.times=e.slice(0,l),this.values=t.slice(0,l*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,r=new n(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}lu.prototype.ValueTypeName="";lu.prototype.TimeBufferType=Float32Array;lu.prototype.ValueBufferType=Float32Array;lu.prototype.DefaultInterpolation=vy;class kp extends lu{constructor(e,t,n){super(e,t,n)}}kp.prototype.ValueTypeName="bool";kp.prototype.ValueBufferType=Array;kp.prototype.DefaultInterpolation=Vg;kp.prototype.InterpolantFactoryMethodLinear=void 0;kp.prototype.InterpolantFactoryMethodSmooth=void 0;class HS extends lu{constructor(e,t,n,r){super(e,t,n,r)}}HS.prototype.ValueTypeName="color";class Jg extends lu{constructor(e,t,n,r){super(e,t,n,r)}}Jg.prototype.ValueTypeName="number";class dE extends b1{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,l=this.sampleValues,c=this.valueSize,f=(n-t)/(r-t);let d=e*c;for(let m=d+c;d!==m;d+=4)Uo.slerpFlat(s,0,l,d-c,l,d,f);return s}}class _1 extends lu{constructor(e,t,n,r){super(e,t,n,r)}InterpolantFactoryMethodLinear(e){return new dE(this.times,this.values,this.getValueSize(),e)}}_1.prototype.ValueTypeName="quaternion";_1.prototype.InterpolantFactoryMethodSmooth=void 0;class Op extends lu{constructor(e,t,n){super(e,t,n)}}Op.prototype.ValueTypeName="string";Op.prototype.ValueBufferType=Array;Op.prototype.DefaultInterpolation=Vg;Op.prototype.InterpolantFactoryMethodLinear=void 0;Op.prototype.InterpolantFactoryMethodSmooth=void 0;class Kg extends lu{constructor(e,t,n,r){super(e,t,n,r)}}Kg.prototype.ValueTypeName="vector";class Qg{constructor(e="",t=-1,n=[],r=zy){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=Ac(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let l=0,c=n.length;l!==c;++l)t.push(L6(n[l]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s.userData=JSON.parse(e.userData||"{}"),s}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let s=0,l=n.length;s!==l;++s)t.push(lu.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const s=t.length,l=[];for(let c=0;c<s;c++){let f=[],d=[];f.push((c+s-1)%s,c,(c+1)%s),d.push(0,1,0);const m=uE(f);f=k_(f,1,m),d=k_(d,1,m),!r&&f[0]===0&&(f.push(s),d.push(d[0])),l.push(new Jg(".morphTargetInfluences["+t[c].name+"]",f,d).scale(1/n))}return new this(e,-1,l)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},s=/^([\w-]*?)([\d]+)$/;for(let c=0,f=e.length;c<f;c++){const d=e[c],m=d.name.match(s);if(m&&m.length>1){const g=m[1];let y=r[g];y||(r[g]=y=[]),y.push(d)}}const l=[];for(const c in r)l.push(this.CreateFromMorphTargetSequence(c,r[c],t,n));return l}static parseAnimation(e,t){if(Mn("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return Hn("AnimationClip: No animation in JSONLoader data."),null;const n=function(g,y,v,S,T){if(v.length!==0){const A=[],w=[];jS(v,A,w,S),A.length!==0&&T.push(new g(y,A,w))}},r=[],s=e.name||"default",l=e.fps||30,c=e.blendMode;let f=e.length||-1;const d=e.hierarchy||[];for(let g=0;g<d.length;g++){const y=d[g].keys;if(!(!y||y.length===0))if(y[0].morphTargets){const v={};let S;for(S=0;S<y.length;S++)if(y[S].morphTargets)for(let T=0;T<y[S].morphTargets.length;T++)v[y[S].morphTargets[T]]=-1;for(const T in v){const A=[],w=[];for(let R=0;R!==y[S].morphTargets.length;++R){const D=y[S];A.push(D.time),w.push(D.morphTarget===T?1:0)}r.push(new Jg(".morphTargetInfluence["+T+"]",A,w))}f=v.length*l}else{const v=".bones["+t[g].name+"]";n(Kg,v+".position",y,"pos",r),n(_1,v+".quaternion",y,"rot",r),n(Kg,v+".scale",y,"scl",r)}}return r.length===0?null:new this(s,f,r,c)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,r=e.length;n!==r;++n){const s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function R6(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Jg;case"vector":case"vector2":case"vector3":case"vector4":return Kg;case"color":return HS;case"quaternion":return _1;case"bool":case"boolean":return kp;case"string":return Op}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function L6(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=R6(i.type);if(i.times===void 0){const t=[],n=[];jS(i.keys,t,n,"value"),i.times=t,i.values=n}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const Lf={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class fb{constructor(e,t,n){const r=this;let s=!1,l=0,c=0,f;const d=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this._abortController=null,this.itemStart=function(m){c++,s===!1&&r.onStart!==void 0&&r.onStart(m,l,c),s=!0},this.itemEnd=function(m){l++,r.onProgress!==void 0&&r.onProgress(m,l,c),l===c&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(m){r.onError!==void 0&&r.onError(m)},this.resolveURL=function(m){return f?f(m):m},this.setURLModifier=function(m){return f=m,this},this.addHandler=function(m,g){return d.push(m,g),this},this.removeHandler=function(m){const g=d.indexOf(m);return g!==-1&&d.splice(g,2),this},this.getHandler=function(m){for(let g=0,y=d.length;g<y;g+=2){const v=d[g],S=d[g+1];if(v.global&&(v.lastIndex=0),v.test(m))return S}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const pE=new fb;class dl{constructor(e){this.manager=e!==void 0?e:pE,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,s){n.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}dl.DEFAULT_MATERIAL_NAME="__DEFAULT";const ph={};class P6 extends Error{constructor(e,t){super(e),this.response=t}}class Tc extends dl{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Lf.get(`file:${e}`);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(ph[e]!==void 0){ph[e].push({onLoad:t,onProgress:n,onError:r});return}ph[e]=[],ph[e].push({onLoad:t,onProgress:n,onError:r});const l=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),c=this.mimeType,f=this.responseType;fetch(l).then(d=>{if(d.status===200||d.status===0){if(d.status===0&&Mn("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||d.body===void 0||d.body.getReader===void 0)return d;const m=ph[e],g=d.body.getReader(),y=d.headers.get("X-File-Size")||d.headers.get("Content-Length"),v=y?parseInt(y):0,S=v!==0;let T=0;const A=new ReadableStream({start(w){R();function R(){g.read().then(({done:D,value:I})=>{if(D)w.close();else{T+=I.byteLength;const z=new ProgressEvent("progress",{lengthComputable:S,loaded:T,total:v});for(let j=0,X=m.length;j<X;j++){const G=m[j];G.onProgress&&G.onProgress(z)}w.enqueue(I),R()}},D=>{w.error(D)})}}});return new Response(A)}else throw new P6(`fetch for "${d.url}" responded with ${d.status}: ${d.statusText}`,d)}).then(d=>{switch(f){case"arraybuffer":return d.arrayBuffer();case"blob":return d.blob();case"document":return d.text().then(m=>new DOMParser().parseFromString(m,c));case"json":return d.json();default:if(c==="")return d.text();{const g=/charset="?([^;"\s]*)"?/i.exec(c),y=g&&g[1]?g[1].toLowerCase():void 0,v=new TextDecoder(y);return d.arrayBuffer().then(S=>v.decode(S))}}}).then(d=>{Lf.add(`file:${e}`,d);const m=ph[e];delete ph[e];for(let g=0,y=m.length;g<y;g++){const v=m[g];v.onLoad&&v.onLoad(d)}}).catch(d=>{const m=ph[e];if(m===void 0)throw this.manager.itemError(e),d;delete ph[e];for(let g=0,y=m.length;g<y;g++){const v=m[g];v.onError&&v.onError(d)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class I6 extends dl{constructor(e){super(e)}load(e,t,n,r){const s=this,l=new Tc(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{t(s.parse(JSON.parse(c)))}catch(f){r?r(f):Hn(f),s.manager.itemError(e)}},n,r)}parse(e){const t=[];for(let n=0;n<e.length;n++){const r=Qg.parse(e[n]);t.push(r)}return t}}class D6 extends dl{constructor(e){super(e)}load(e,t,n,r){const s=this,l=[],c=new Ky,f=new Tc(this.manager);f.setPath(this.path),f.setResponseType("arraybuffer"),f.setRequestHeader(this.requestHeader),f.setWithCredentials(s.withCredentials);let d=0;function m(g){f.load(e[g],function(y){const v=s.parse(y,!0);l[g]={width:v.width,height:v.height,format:v.format,mipmaps:v.mipmaps},d+=1,d===6&&(v.mipmapCount===1&&(c.minFilter=ar),c.image=l,c.format=v.format,c.needsUpdate=!0,t&&t(c))},n,r)}if(Array.isArray(e))for(let g=0,y=e.length;g<y;++g)m(g);else f.load(e,function(g){const y=s.parse(g,!0);if(y.isCubemap){const v=y.mipmaps.length/y.mipmapCount;for(let S=0;S<v;S++){l[S]={mipmaps:[]};for(let T=0;T<y.mipmapCount;T++)l[S].mipmaps.push(y.mipmaps[S*y.mipmapCount+T]),l[S].format=y.format,l[S].width=y.width,l[S].height=y.height}c.image=l}else c.image.width=y.width,c.image.height=y.height,c.mipmaps=y.mipmaps;y.mipmapCount===1&&(c.minFilter=ar),c.format=y.format,c.needsUpdate=!0,t&&t(c)},n,r);return c}}const Pm=new WeakMap;class e1 extends dl{constructor(e){super(e)}load(e,t,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,l=Lf.get(`image:${e}`);if(l!==void 0){if(l.complete===!0)s.manager.itemStart(e),setTimeout(function(){t&&t(l),s.manager.itemEnd(e)},0);else{let g=Pm.get(l);g===void 0&&(g=[],Pm.set(l,g)),g.push({onLoad:t,onError:r})}return l}const c=Wg("img");function f(){m(),t&&t(this);const g=Pm.get(this)||[];for(let y=0;y<g.length;y++){const v=g[y];v.onLoad&&v.onLoad(this)}Pm.delete(this),s.manager.itemEnd(e)}function d(g){m(),r&&r(g),Lf.remove(`image:${e}`);const y=Pm.get(this)||[];for(let v=0;v<y.length;v++){const S=y[v];S.onError&&S.onError(g)}Pm.delete(this),s.manager.itemError(e),s.manager.itemEnd(e)}function m(){c.removeEventListener("load",f,!1),c.removeEventListener("error",d,!1)}return c.addEventListener("load",f,!1),c.addEventListener("error",d,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(c.crossOrigin=this.crossOrigin),Lf.add(`image:${e}`,c),s.manager.itemStart(e),c.src=e,c}}class mE extends dl{constructor(e){super(e)}load(e,t,n,r){const s=new d1;s.colorSpace=vo;const l=new e1(this.manager);l.setCrossOrigin(this.crossOrigin),l.setPath(this.path);let c=0;function f(d){l.load(e[d],function(m){s.images[d]=m,c++,c===6&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let d=0;d<e.length;++d)f(d);return s}}class GS extends dl{constructor(e){super(e)}load(e,t,n,r){const s=this,l=new su,c=new Tc(this.manager);return c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setPath(this.path),c.setWithCredentials(s.withCredentials),c.load(e,function(f){let d;try{d=s.parse(f)}catch(m){if(r!==void 0)r(m);else{m(m);return}}d.image!==void 0?l.image=d.image:d.data!==void 0&&(l.image.width=d.width,l.image.height=d.height,l.image.data=d.data),l.wrapS=d.wrapS!==void 0?d.wrapS:Js,l.wrapT=d.wrapT!==void 0?d.wrapT:Js,l.magFilter=d.magFilter!==void 0?d.magFilter:ar,l.minFilter=d.minFilter!==void 0?d.minFilter:ar,l.anisotropy=d.anisotropy!==void 0?d.anisotropy:1,d.colorSpace!==void 0&&(l.colorSpace=d.colorSpace),d.flipY!==void 0&&(l.flipY=d.flipY),d.format!==void 0&&(l.format=d.format),d.type!==void 0&&(l.type=d.type),d.mipmaps!==void 0&&(l.mipmaps=d.mipmaps,l.minFilter=Rf),d.mipmapCount===1&&(l.minFilter=ar),d.generateMipmaps!==void 0&&(l.generateMipmaps=d.generateMipmaps),l.needsUpdate=!0,t&&t(l,d)},n,r),l}}class k6 extends dl{constructor(e){super(e)}load(e,t,n,r){const s=new Fr,l=new e1(this.manager);return l.setCrossOrigin(this.crossOrigin),l.setPath(this.path),l.load(e,function(c){s.image=c,s.needsUpdate=!0,t!==void 0&&t(s)},n,r),s}}class Sd extends Oi{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new fn(e),this.intensity=t}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t}}class gE extends Sd{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Oi.DEFAULT_UP),this.updateMatrix(),this.groundColor=new fn(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}toJSON(e){const t=super.toJSON(e);return t.object.groundColor=this.groundColor.getHex(),t}}const R5=new ui,i3=new Ee,r3=new Ee;class qS{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new zt(512,512),this.mapType=$a,this.map=null,this.mapPass=null,this.matrix=new ui,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new _0,this._frameExtents=new zt(1,1),this._viewportCount=1,this._viewports=[new Yr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;i3.setFromMatrixPosition(e.matrixWorld),t.position.copy(i3),r3.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(r3),t.updateMatrixWorld(),R5.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(R5,t.coordinateSystem,t.reversedDepth),t.reversedDepth?n.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(R5)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class O6 extends qS{constructor(){super(new Fs(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=u0*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,s=e.distance||t.far;(n!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class vE extends Sd{constructor(e,t,n=0,r=Math.PI/3,s=0,l=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Oi.DEFAULT_UP),this.updateMatrix(),this.target=new Oi,this.distance=n,this.angle=r,this.penumbra=s,this.decay=l,this.map=null,this.shadow=new O6}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.map=e.map,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.angle=this.angle,t.object.decay=this.decay,t.object.penumbra=this.penumbra,t.object.target=this.target.uuid,this.map&&this.map.isTexture&&(t.object.map=this.map.toJSON(e).uuid),t.object.shadow=this.shadow.toJSON(),t}}class B6 extends qS{constructor(){super(new Fs(90,1,.5,500)),this.isPointLightShadow=!0}}class xE extends Sd{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new B6}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.decay=this.decay,t.object.shadow=this.shadow.toJSON(),t}}class au extends qy{constructor(e=-1,t=1,n=1,r=-1,s=.1,l=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=l,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,l){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,l=n+e,c=r+t,f=r-t;if(this.view!==null&&this.view.enabled){const d=(this.right-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=d*this.view.offsetX,l=s+d*this.view.width,c-=m*this.view.offsetY,f=c-m*this.view.height}this.projectionMatrix.makeOrthographic(s,l,c,f,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class U6 extends qS{constructor(){super(new au(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class yE extends Sd{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Oi.DEFAULT_UP),this.updateMatrix(),this.target=new Oi,this.shadow=new U6}dispose(){super.dispose(),this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.shadow=this.shadow.toJSON(),t.object.target=this.target.uuid,t}}class bE extends Sd{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class _E extends Sd{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class WS{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Ee)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,s=e.z,l=this.coefficients;return t.copy(l[0]).multiplyScalar(.282095),t.addScaledVector(l[1],.488603*r),t.addScaledVector(l[2],.488603*s),t.addScaledVector(l[3],.488603*n),t.addScaledVector(l[4],1.092548*(n*r)),t.addScaledVector(l[5],1.092548*(r*s)),t.addScaledVector(l[6],.315392*(3*s*s-1)),t.addScaledVector(l[7],1.092548*(n*s)),t.addScaledVector(l[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,s=e.z,l=this.coefficients;return t.copy(l[0]).multiplyScalar(.886227),t.addScaledVector(l[1],2*.511664*r),t.addScaledVector(l[2],2*.511664*s),t.addScaledVector(l[3],2*.511664*n),t.addScaledVector(l[4],2*.429043*n*r),t.addScaledVector(l[5],2*.429043*r*s),t.addScaledVector(l[6],.743125*s*s-.247708),t.addScaledVector(l[7],2*.429043*n*s),t.addScaledVector(l[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const n=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*n*s,t[8]=.546274*(n*n-r*r)}}class SE extends Sd{constructor(e=new WS,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class hb extends dl{constructor(e){super(e),this.textures={}}load(e,t,n,r){const s=this,l=new Tc(s.manager);l.setPath(s.path),l.setRequestHeader(s.requestHeader),l.setWithCredentials(s.withCredentials),l.load(e,function(c){try{t(s.parse(JSON.parse(c)))}catch(f){r?r(f):Hn(f),s.manager.itemError(e)}},n,r)}parse(e){const t=this.textures;function n(s){return t[s]===void 0&&Mn("MaterialLoader: Undefined texture",s),t[s]}const r=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new fn().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(r.dispersion=e.dispersion),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.allowOverride!==void 0&&(r.allowOverride=e.allowOverride),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const l=e.uniforms[s];switch(r.uniforms[s]={},l.type){case"t":r.uniforms[s].value=n(l.value);break;case"c":r.uniforms[s].value=new fn().setHex(l.value);break;case"v2":r.uniforms[s].value=new zt().fromArray(l.value);break;case"v3":r.uniforms[s].value=new Ee().fromArray(l.value);break;case"v4":r.uniforms[s].value=new Yr().fromArray(l.value);break;case"m3":r.uniforms[s].value=new Ei().fromArray(l.value);break;case"m4":r.uniforms[s].value=new ui().fromArray(l.value);break;default:r.uniforms[s].value=l.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=n(e.map)),e.matcap!==void 0&&(r.matcap=n(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new zt().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=n(e.envMap)),e.envMapRotation!==void 0&&r.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new zt().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return hb.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:iE,SpriteMaterial:CS,RawShaderMaterial:US,ShaderMaterial:fl,PointsMaterial:RS,MeshPhysicalMaterial:Sy,MeshStandardMaterial:g0,MeshPhongMaterial:rE,MeshToonMaterial:sE,MeshNormalMaterial:aE,MeshLambertMaterial:oE,MeshDepthMaterial:FS,MeshDistanceMaterial:zS,MeshBasicMaterial:kf,MeshMatcapMaterial:lE,LineDashedMaterial:cE,LineBasicMaterial:hl,Material:zo};return new t[e]}}class O_{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class wE extends Si{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class ME extends dl{constructor(e){super(e)}load(e,t,n,r){const s=this,l=new Tc(s.manager);l.setPath(s.path),l.setRequestHeader(s.requestHeader),l.setWithCredentials(s.withCredentials),l.load(e,function(c){try{t(s.parse(JSON.parse(c)))}catch(f){r?r(f):Hn(f),s.manager.itemError(e)}},n,r)}parse(e){const t={},n={};function r(v,S){if(t[S]!==void 0)return t[S];const A=v.interleavedBuffers[S],w=s(v,A.buffer),R=Ym(A.type,w),D=new Zy(R,A.stride);return D.uuid=A.uuid,t[S]=D,D}function s(v,S){if(n[S]!==void 0)return n[S];const A=v.arrayBuffers[S],w=new Uint32Array(A).buffer;return n[S]=w,w}const l=e.isInstancedBufferGeometry?new wE:new Si,c=e.data.index;if(c!==void 0){const v=Ym(c.type,c.array);l.setIndex(new zr(v,1))}const f=e.data.attributes;for(const v in f){const S=f[v];let T;if(S.isInterleavedBufferAttribute){const A=r(e.data,S.data);T=new Cp(A,S.itemSize,S.offset,S.normalized)}else{const A=Ym(S.type,S.array),w=S.isInstancedBufferAttribute?d0:zr;T=new w(A,S.itemSize,S.normalized)}S.name!==void 0&&(T.name=S.name),S.usage!==void 0&&T.setUsage(S.usage),l.setAttribute(v,T)}const d=e.data.morphAttributes;if(d)for(const v in d){const S=d[v],T=[];for(let A=0,w=S.length;A<w;A++){const R=S[A];let D;if(R.isInterleavedBufferAttribute){const I=r(e.data,R.data);D=new Cp(I,R.itemSize,R.offset,R.normalized)}else{const I=Ym(R.type,R.array);D=new zr(I,R.itemSize,R.normalized)}R.name!==void 0&&(D.name=R.name),T.push(D)}l.morphAttributes[v]=T}e.data.morphTargetsRelative&&(l.morphTargetsRelative=!0);const g=e.data.groups||e.data.drawcalls||e.data.offsets;if(g!==void 0)for(let v=0,S=g.length;v!==S;++v){const T=g[v];l.addGroup(T.start,T.count,T.materialIndex)}const y=e.data.boundingSphere;return y!==void 0&&(l.boundingSphere=new xo().fromJSON(y)),e.name&&(l.name=e.name),e.userData&&(l.userData=e.userData),l}}class F6 extends dl{constructor(e){super(e)}load(e,t,n,r){const s=this,l=this.path===""?O_.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||l;const c=new Tc(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(f){let d=null;try{d=JSON.parse(f)}catch(g){r!==void 0&&r(g),g("ObjectLoader: Can't parse "+e+".",g.message);return}const m=d.metadata;if(m===void 0||m.type===void 0||m.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),Hn("ObjectLoader: Can't load "+e);return}s.parse(d,t)},n,r)}async loadAsync(e,t){const n=this,r=this.path===""?O_.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new Tc(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const l=await s.loadAsync(e,t),c=JSON.parse(l),f=c.metadata;if(f===void 0||f.type===void 0||f.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(c)}parse(e,t){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),l=this.parseImages(e.images,function(){t!==void 0&&t(d)}),c=this.parseTextures(e.textures,l),f=this.parseMaterials(e.materials,c),d=this.parseObject(e.object,s,f,c,n),m=this.parseSkeletons(e.skeletons,d);if(this.bindSkeletons(d,m),this.bindLightTargets(d),t!==void 0){let g=!1;for(const y in l)if(l[y].data instanceof HTMLImageElement){g=!0;break}g===!1&&t(d)}return d}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),s=await this.parseImagesAsync(e.images),l=this.parseTextures(e.textures,s),c=this.parseMaterials(e.materials,l),f=this.parseObject(e.object,r,c,l,t),d=this.parseSkeletons(e.skeletons,f);return this.bindSkeletons(f,d),this.bindLightTargets(f),f}parseShapes(e){const t={};if(e!==void 0)for(let n=0,r=e.length;n<r;n++){const s=new Mp().fromJSON(e[n]);t[s.uuid]=s}return t}parseSkeletons(e,t){const n={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,l=e.length;s<l;s++){const c=new $y().fromJSON(e[s],r);n[c.uuid]=c}return n}parseGeometries(e,t){const n={};if(e!==void 0){const r=new ME;for(let s=0,l=e.length;s<l;s++){let c;const f=e[s];switch(f.type){case"BufferGeometry":case"InstancedBufferGeometry":c=r.parse(f);break;default:f.type in n3?c=n3[f.type].fromJSON(f,t):Mn(`ObjectLoader: Unsupported geometry type "${f.type}"`)}c.uuid=f.uuid,f.name!==void 0&&(c.name=f.name),f.userData!==void 0&&(c.userData=f.userData),n[f.uuid]=c}}return n}parseMaterials(e,t){const n={},r={};if(e!==void 0){const s=new hb;s.setTextures(t);for(let l=0,c=e.length;l<c;l++){const f=e[l];n[f.uuid]===void 0&&(n[f.uuid]=s.parse(f)),r[f.uuid]=n[f.uuid]}}return r}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const r=e[n],s=Qg.parse(r);t[s.uuid]=s}return t}parseImages(e,t){const n=this,r={};let s;function l(f){return n.manager.itemStart(f),s.load(f,function(){n.manager.itemEnd(f)},void 0,function(){n.manager.itemError(f),n.manager.itemEnd(f)})}function c(f){if(typeof f=="string"){const d=f,m=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)?d:n.resourcePath+d;return l(m)}else return f.data?{data:Ym(f.type,f.data),width:f.width,height:f.height}:null}if(e!==void 0&&e.length>0){const f=new fb(t);s=new e1(f),s.setCrossOrigin(this.crossOrigin);for(let d=0,m=e.length;d<m;d++){const g=e[d],y=g.url;if(Array.isArray(y)){const v=[];for(let S=0,T=y.length;S<T;S++){const A=y[S],w=c(A);w!==null&&(w instanceof HTMLImageElement?v.push(w):v.push(new su(w.data,w.width,w.height)))}r[g.uuid]=new cd(v)}else{const v=c(g.url);r[g.uuid]=new cd(v)}}}return r}async parseImagesAsync(e){const t=this,n={};let r;async function s(l){if(typeof l=="string"){const c=l,f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:t.resourcePath+c;return await r.loadAsync(f)}else return l.data?{data:Ym(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){r=new e1(this.manager),r.setCrossOrigin(this.crossOrigin);for(let l=0,c=e.length;l<c;l++){const f=e[l],d=f.url;if(Array.isArray(d)){const m=[];for(let g=0,y=d.length;g<y;g++){const v=d[g],S=await s(v);S!==null&&(S instanceof HTMLImageElement?m.push(S):m.push(new su(S.data,S.width,S.height)))}n[f.uuid]=new cd(m)}else{const m=await s(f.url);n[f.uuid]=new cd(m)}}}return n}parseTextures(e,t){function n(s,l){return typeof s=="number"?s:(Mn("ObjectLoader.parseTexture: Constant should be in numeric form.",s),l[s])}const r={};if(e!==void 0)for(let s=0,l=e.length;s<l;s++){const c=e[s];c.image===void 0&&Mn('ObjectLoader: No "image" specified for',c.uuid),t[c.image]===void 0&&Mn("ObjectLoader: Undefined image",c.image);const f=t[c.image],d=f.data;let m;Array.isArray(d)?(m=new d1,d.length===6&&(m.needsUpdate=!0)):(d&&d.data?m=new su:m=new Fr,d&&(m.needsUpdate=!0)),m.source=f,m.uuid=c.uuid,c.name!==void 0&&(m.name=c.name),c.mapping!==void 0&&(m.mapping=n(c.mapping,z6)),c.channel!==void 0&&(m.channel=c.channel),c.offset!==void 0&&m.offset.fromArray(c.offset),c.repeat!==void 0&&m.repeat.fromArray(c.repeat),c.center!==void 0&&m.center.fromArray(c.center),c.rotation!==void 0&&(m.rotation=c.rotation),c.wrap!==void 0&&(m.wrapS=n(c.wrap[0],s3),m.wrapT=n(c.wrap[1],s3)),c.format!==void 0&&(m.format=c.format),c.internalFormat!==void 0&&(m.internalFormat=c.internalFormat),c.type!==void 0&&(m.type=c.type),c.colorSpace!==void 0&&(m.colorSpace=c.colorSpace),c.minFilter!==void 0&&(m.minFilter=n(c.minFilter,a3)),c.magFilter!==void 0&&(m.magFilter=n(c.magFilter,a3)),c.anisotropy!==void 0&&(m.anisotropy=c.anisotropy),c.flipY!==void 0&&(m.flipY=c.flipY),c.generateMipmaps!==void 0&&(m.generateMipmaps=c.generateMipmaps),c.premultiplyAlpha!==void 0&&(m.premultiplyAlpha=c.premultiplyAlpha),c.unpackAlignment!==void 0&&(m.unpackAlignment=c.unpackAlignment),c.compareFunction!==void 0&&(m.compareFunction=c.compareFunction),c.userData!==void 0&&(m.userData=c.userData),r[c.uuid]=m}return r}parseObject(e,t,n,r,s){let l;function c(y){return t[y]===void 0&&Mn("ObjectLoader: Undefined geometry",y),t[y]}function f(y){if(y!==void 0){if(Array.isArray(y)){const v=[];for(let S=0,T=y.length;S<T;S++){const A=y[S];n[A]===void 0&&Mn("ObjectLoader: Undefined material",A),v.push(n[A])}return v}return n[y]===void 0&&Mn("ObjectLoader: Undefined material",y),n[y]}}function d(y){return r[y]===void 0&&Mn("ObjectLoader: Undefined texture",y),r[y]}let m,g;switch(e.type){case"Scene":l=new p1,e.background!==void 0&&(Number.isInteger(e.background)?l.background=new fn(e.background):l.background=d(e.background)),e.environment!==void 0&&(l.environment=d(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?l.fog=new Yy(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(l.fog=new Xy(e.fog.color,e.fog.density)),e.fog.name!==""&&(l.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(l.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(l.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&l.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(l.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&l.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":l=new Fs(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(l.focus=e.focus),e.zoom!==void 0&&(l.zoom=e.zoom),e.filmGauge!==void 0&&(l.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(l.filmOffset=e.filmOffset),e.view!==void 0&&(l.view=Object.assign({},e.view));break;case"OrthographicCamera":l=new au(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(l.zoom=e.zoom),e.view!==void 0&&(l.view=Object.assign({},e.view));break;case"AmbientLight":l=new bE(e.color,e.intensity);break;case"DirectionalLight":l=new yE(e.color,e.intensity),l.target=e.target||"";break;case"PointLight":l=new xE(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":l=new _E(e.color,e.intensity,e.width,e.height);break;case"SpotLight":l=new vE(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),l.target=e.target||"";break;case"HemisphereLight":l=new gE(e.color,e.groundColor,e.intensity);break;case"LightProbe":const y=new WS().fromArray(e.sh);l=new SE(y,e.intensity);break;case"SkinnedMesh":m=c(e.geometry),g=f(e.material),l=new FT(m,g),e.bindMode!==void 0&&(l.bindMode=e.bindMode),e.bindMatrix!==void 0&&l.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(l.skeleton=e.skeleton);break;case"Mesh":m=c(e.geometry),g=f(e.material),l=new js(m,g);break;case"InstancedMesh":m=c(e.geometry),g=f(e.material);const v=e.count,S=e.instanceMatrix,T=e.instanceColor;l=new zT(m,g,v),l.instanceMatrix=new d0(new Float32Array(S.array),16),T!==void 0&&(l.instanceColor=new d0(new Float32Array(T.array),T.itemSize));break;case"BatchedMesh":m=c(e.geometry),g=f(e.material),l=new jT(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,g),l.geometry=m,l.perObjectFrustumCulled=e.perObjectFrustumCulled,l.sortObjects=e.sortObjects,l._drawRanges=e.drawRanges,l._reservedRanges=e.reservedRanges,l._geometryInfo=e.geometryInfo.map(A=>{let w=null,R=null;return A.boundingBox!==void 0&&(w=new Fo().fromJSON(A.boundingBox)),A.boundingSphere!==void 0&&(R=new xo().fromJSON(A.boundingSphere)),{...A,boundingBox:w,boundingSphere:R}}),l._instanceInfo=e.instanceInfo,l._availableInstanceIds=e._availableInstanceIds,l._availableGeometryIds=e._availableGeometryIds,l._nextIndexStart=e.nextIndexStart,l._nextVertexStart=e.nextVertexStart,l._geometryCount=e.geometryCount,l._maxInstanceCount=e.maxInstanceCount,l._maxVertexCount=e.maxVertexCount,l._maxIndexCount=e.maxIndexCount,l._geometryInitialized=e.geometryInitialized,l._matricesTexture=d(e.matricesTexture.uuid),l._indirectTexture=d(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(l._colorsTexture=d(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(l.boundingSphere=new xo().fromJSON(e.boundingSphere)),e.boundingBox!==void 0&&(l.boundingBox=new Fo().fromJSON(e.boundingBox));break;case"LOD":l=new UT;break;case"Line":l=new vd(c(e.geometry),f(e.material));break;case"LineLoop":l=new VT(c(e.geometry),f(e.material));break;case"LineSegments":l=new Of(c(e.geometry),f(e.material));break;case"PointCloud":case"Points":l=new HT(c(e.geometry),f(e.material));break;case"Sprite":l=new BT(f(e.material));break;case"Group":l=new Zm;break;case"Bone":l=new NS;break;default:l=new Oi}if(l.uuid=e.uuid,e.name!==void 0&&(l.name=e.name),e.matrix!==void 0?(l.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(l.matrixAutoUpdate=e.matrixAutoUpdate),l.matrixAutoUpdate&&l.matrix.decompose(l.position,l.quaternion,l.scale)):(e.position!==void 0&&l.position.fromArray(e.position),e.rotation!==void 0&&l.rotation.fromArray(e.rotation),e.quaternion!==void 0&&l.quaternion.fromArray(e.quaternion),e.scale!==void 0&&l.scale.fromArray(e.scale)),e.up!==void 0&&l.up.fromArray(e.up),e.castShadow!==void 0&&(l.castShadow=e.castShadow),e.receiveShadow!==void 0&&(l.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(l.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(l.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(l.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(l.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&l.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(l.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(l.visible=e.visible),e.frustumCulled!==void 0&&(l.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(l.renderOrder=e.renderOrder),e.userData!==void 0&&(l.userData=e.userData),e.layers!==void 0&&(l.layers.mask=e.layers),e.children!==void 0){const y=e.children;for(let v=0;v<y.length;v++)l.add(this.parseObject(y[v],t,n,r,s))}if(e.animations!==void 0){const y=e.animations;for(let v=0;v<y.length;v++){const S=y[v];l.animations.push(s[S])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(l.autoUpdate=e.autoUpdate);const y=e.levels;for(let v=0;v<y.length;v++){const S=y[v],T=l.getObjectByProperty("uuid",S.object);T!==void 0&&l.addLevel(T,S.distance,S.hysteresis)}}return l}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const r=t[n.skeleton];r===void 0?Mn("ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(r,n.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,r=e.getObjectByProperty("uuid",n);r!==void 0?t.target=r:t.target=new Oi}})}}const z6={UVMapping:pd,CubeReflectionMapping:Bu,CubeRefractionMapping:md,EquirectangularReflectionMapping:s0,EquirectangularRefractionMapping:Fg,CubeUVReflectionMapping:b0},s3={RepeatWrapping:zg,ClampToEdgeWrapping:Js,MirroredRepeatWrapping:jg},a3={NearestFilter:va,NearestMipmapNearestFilter:xS,NearestMipmapLinearFilter:Xm,LinearFilter:ar,LinearMipmapNearestFilter:Eg,LinearMipmapLinearFilter:Rf},L5=new WeakMap;class j6 extends dl{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&Mn("ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&Mn("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,l=Lf.get(`image-bitmap:${e}`);if(l!==void 0){if(s.manager.itemStart(e),l.then){l.then(d=>{if(L5.has(l)===!0)r&&r(L5.get(l)),s.manager.itemError(e),s.manager.itemEnd(e);else return t&&t(d),s.manager.itemEnd(e),d});return}return setTimeout(function(){t&&t(l),s.manager.itemEnd(e)},0),l}const c={};c.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",c.headers=this.requestHeader,c.signal=typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const f=fetch(e,c).then(function(d){return d.blob()}).then(function(d){return createImageBitmap(d,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(d){return Lf.add(`image-bitmap:${e}`,d),t&&t(d),s.manager.itemEnd(e),d}).catch(function(d){r&&r(d),L5.set(f,d),Lf.remove(`image-bitmap:${e}`),s.manager.itemError(e),s.manager.itemEnd(e)});Lf.add(`image-bitmap:${e}`,f),s.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}let $v,XS=class{static getContext(){return $v===void 0&&($v=new(window.AudioContext||window.webkitAudioContext)),$v}static setContext(e){$v=e}};class V6 extends dl{constructor(e){super(e)}load(e,t,n,r){const s=this,l=new Tc(this.manager);l.setResponseType("arraybuffer"),l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(f){try{const d=f.slice(0);XS.getContext().decodeAudioData(d,function(g){t(g)}).catch(c)}catch(d){c(d)}},n,r);function c(f){r?r(f):Hn(f),s.manager.itemError(e)}}}const o3=new ui,l3=new ui,ep=new ui;class H6{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Fs,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Fs,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,ep.copy(e.projectionMatrix);const r=t.eyeSep/2,s=r*t.near/t.focus,l=t.near*Math.tan(wp*t.fov*.5)/t.zoom;let c,f;l3.elements[12]=-r,o3.elements[12]=r,c=-l*t.aspect+s,f=l*t.aspect+s,ep.elements[0]=2*t.near/(f-c),ep.elements[8]=(f+c)/(f-c),this.cameraL.projectionMatrix.copy(ep),c=-l*t.aspect-s,f=l*t.aspect-s,ep.elements[0]=2*t.near/(f-c),ep.elements[8]=(f+c)/(f-c),this.cameraR.projectionMatrix.copy(ep)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(l3),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(o3)}}class AE extends Fs{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class YS{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}const tp=new Ee,P5=new Uo,G6=new Ee,np=new Ee,ip=new Ee;class q6 extends Oi{constructor(){super(),this.type="AudioListener",this.context=XS.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new YS}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(tp,P5,G6),np.set(0,0,-1).applyQuaternion(P5),ip.set(0,1,0).applyQuaternion(P5),t.positionX){const n=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(tp.x,n),t.positionY.linearRampToValueAtTime(tp.y,n),t.positionZ.linearRampToValueAtTime(tp.z,n),t.forwardX.linearRampToValueAtTime(np.x,n),t.forwardY.linearRampToValueAtTime(np.y,n),t.forwardZ.linearRampToValueAtTime(np.z,n),t.upX.linearRampToValueAtTime(ip.x,n),t.upY.linearRampToValueAtTime(ip.y,n),t.upZ.linearRampToValueAtTime(ip.z,n)}else t.setPosition(tp.x,tp.y,tp.z),t.setOrientation(np.x,np.y,np.z,ip.x,ip.y,ip.z)}}class TE extends Oi{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){Mn("Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){Mn("Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){Mn("Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){Mn("Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){Mn("Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(Mn("Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){Mn("Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(Mn("Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const rp=new Ee,c3=new Uo,W6=new Ee,sp=new Ee;class X6 extends TE{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(rp,c3,W6),sp.set(0,0,1).applyQuaternion(c3);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(rp.x,n),t.positionY.linearRampToValueAtTime(rp.y,n),t.positionZ.linearRampToValueAtTime(rp.z,n),t.orientationX.linearRampToValueAtTime(sp.x,n),t.orientationY.linearRampToValueAtTime(sp.y,n),t.orientationZ.linearRampToValueAtTime(sp.z,n)}else t.setPosition(rp.x,rp.y,rp.z),t.setOrientation(sp.x,sp.y,sp.z)}}class Y6{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class EE{constructor(e,t,n){this.binding=e,this.valueSize=n;let r,s,l;switch(t){case"quaternion":r=this._slerp,s=this._slerpAdditive,l=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,l=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:r=this._lerp,s=this._lerpAdditive,l=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=l,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,s=e*r+r;let l=this.cumulativeWeight;if(l===0){for(let c=0;c!==r;++c)n[s+c]=n[c];l=t}else{l+=t;const c=t/l;this._mixBufferRegion(n,s,0,c,r)}this.cumulativeWeight=l}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,s=this.cumulativeWeight,l=this.cumulativeWeightAdditive,c=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const f=t*this._origIndex;this._mixBufferRegion(n,r,f,1-s,t)}l>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let f=t,d=t+t;f!==d;++f)if(n[f]!==n[f+t]){c.setValue(n,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let s=n,l=r;s!==l;++s)t[s]=t[r+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,s){if(r>=.5)for(let l=0;l!==s;++l)e[t+l]=e[n+l]}_slerp(e,t,n,r){Uo.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,s){const l=this._workIndex*s;Uo.multiplyQuaternionsFlat(e,l,e,t,e,n),Uo.slerpFlat(e,t,e,t,e,l,r)}_lerp(e,t,n,r,s){const l=1-r;for(let c=0;c!==s;++c){const f=t+c;e[f]=e[f]*l+e[n+c]*r}}_lerpAdditive(e,t,n,r,s){for(let l=0;l!==s;++l){const c=t+l;e[c]=e[c]+e[n+l]*r}}}const ZS="\\[\\]\\.:\\/",Z6=new RegExp("["+ZS+"]","g"),$S="[^"+ZS+"]",$6="[^"+ZS.replace("\\.","")+"]",J6=/((?:WC+[\/:])*)/.source.replace("WC",$S),K6=/(WCOD+)?/.source.replace("WCOD",$6),Q6=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",$S),eL=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",$S),tL=new RegExp("^"+J6+K6+Q6+eL+"$"),nL=["material","materials","bones","map"];class iL{constructor(e,t,n){const r=n||cr.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class cr{constructor(e,t,n){this.path=t,this.parsedPath=n||cr.parseTrackName(t),this.node=cr.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new cr.Composite(e,t,n):new cr(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Z6,"")}static parseTrackName(e){const t=tL.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=n.nodeName.substring(r+1);nL.indexOf(s)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=s)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(s){for(let l=0;l<s.length;l++){const c=s[l];if(c.name===t||c.uuid===t)return c;const f=n(c.children);if(f)return f}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let s=t.propertyIndex;if(e||(e=cr.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){Mn("PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let d=t.objectIndex;switch(n){case"materials":if(!e.material){Hn("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){Hn("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){Hn("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let m=0;m<e.length;m++)if(e[m].name===d){d=m;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){Hn("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){Hn("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){Hn("PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(d!==void 0){if(e[d]===void 0){Hn("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[d]}}const l=e[r];if(l===void 0){const d=t.nodeName;Hn("PropertyBinding: Trying to update property for track: "+d+"."+r+" but it wasn't found.",e);return}let c=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?c=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(c=this.Versioning.MatrixWorldNeedsUpdate);let f=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){Hn("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){Hn("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}f=this.BindingType.ArrayElement,this.resolvedProperty=l,this.propertyIndex=s}else l.fromArray!==void 0&&l.toArray!==void 0?(f=this.BindingType.HasFromToArray,this.resolvedProperty=l):Array.isArray(l)?(f=this.BindingType.EntireArray,this.resolvedProperty=l):this.propertyName=r;this.getValue=this.GetterByBindingType[f],this.setValue=this.SetterByBindingTypeAndVersioning[f][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}cr.Composite=iL;cr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};cr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};cr.prototype.GetterByBindingType=[cr.prototype._getValue_direct,cr.prototype._getValue_array,cr.prototype._getValue_arrayElement,cr.prototype._getValue_toArray];cr.prototype.SetterByBindingTypeAndVersioning=[[cr.prototype._setValue_direct,cr.prototype._setValue_direct_setNeedsUpdate,cr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[cr.prototype._setValue_array,cr.prototype._setValue_array_setNeedsUpdate,cr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[cr.prototype._setValue_arrayElement,cr.prototype._setValue_arrayElement_setNeedsUpdate,cr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[cr.prototype._setValue_fromArray,cr.prototype._setValue_fromArray_setNeedsUpdate,cr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class rL{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Ac(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,s=this._bindings,l=s.length;let c,f=e.length,d=this.nCachedObjects_;for(let m=0,g=arguments.length;m!==g;++m){const y=arguments[m],v=y.uuid;let S=t[v];if(S===void 0){S=f++,t[v]=S,e.push(y);for(let T=0,A=l;T!==A;++T)s[T].push(new cr(y,n[T],r[T]))}else if(S<d){c=e[S];const T=--d,A=e[T];t[A.uuid]=S,e[S]=A,t[v]=T,e[T]=y;for(let w=0,R=l;w!==R;++w){const D=s[w],I=D[T];let z=D[S];D[S]=I,z===void 0&&(z=new cr(y,n[w],r[w])),D[T]=z}}else e[S]!==c&&Hn("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=d}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_;for(let l=0,c=arguments.length;l!==c;++l){const f=arguments[l],d=f.uuid,m=t[d];if(m!==void 0&&m>=s){const g=s++,y=e[g];t[y.uuid]=m,e[m]=y,t[d]=g,e[g]=f;for(let v=0,S=r;v!==S;++v){const T=n[v],A=T[g],w=T[m];T[m]=A,T[g]=w}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_,l=e.length;for(let c=0,f=arguments.length;c!==f;++c){const d=arguments[c],m=d.uuid,g=t[m];if(g!==void 0)if(delete t[m],g<s){const y=--s,v=e[y],S=--l,T=e[S];t[v.uuid]=g,e[g]=v,t[T.uuid]=y,e[y]=T,e.pop();for(let A=0,w=r;A!==w;++A){const R=n[A],D=R[y],I=R[S];R[g]=D,R[y]=I,R.pop()}}else{const y=--l,v=e[y];y>0&&(t[v.uuid]=g),e[g]=v,e.pop();for(let S=0,T=r;S!==T;++S){const A=n[S];A[g]=A[y],A.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const n=this._bindingsIndicesByPath;let r=n[e];const s=this._bindings;if(r!==void 0)return s[r];const l=this._paths,c=this._parsedPaths,f=this._objects,d=f.length,m=this.nCachedObjects_,g=new Array(d);r=s.length,n[e]=r,l.push(e),c.push(t),s.push(g);for(let y=m,v=f.length;y!==v;++y){const S=f[y];g[y]=new cr(S,e,t)}return g}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const r=this._paths,s=this._parsedPaths,l=this._bindings,c=l.length-1,f=l[c],d=e[c];t[d]=n,l[n]=f,l.pop(),s[n]=s[c],s.pop(),r[n]=r[c],r.pop()}}}class CE{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const s=t.tracks,l=s.length,c=new Array(l),f={endingStart:gp,endingEnd:gp};for(let d=0;d!==l;++d){const m=s[d].createInterpolant(null);c[d]=m,m.settings=f}this._interpolantSettings=f,this._interpolants=c,this._propertyBindings=new Array(l),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=xT,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n=!1){if(e.fadeOut(t),this.fadeIn(t),n===!0){const r=this._clip.duration,s=e._clip.duration,l=s/r,c=r/s;e.warp(1,l,t),this.warp(c,1,t)}return this}crossFadeTo(e,t,n=!1){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,s=r.time,l=this.timeScale;let c=this._timeScaleInterpolant;c===null&&(c=r._lendControlInterpolant(),this._timeScaleInterpolant=c);const f=c.parameterPositions,d=c.sampleValues;return f[0]=s,f[1]=s+n,d[0]=e/l,d[1]=t/l,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const f=(e-s)*n;f<0||n===0?t=0:(this._startTime=null,t=n*f)}t*=this._updateTimeScale(e);const l=this._updateTime(t),c=this._updateWeight(e);if(c>0){const f=this._interpolants,d=this._propertyBindings;switch(this.blendMode){case wS:for(let m=0,g=f.length;m!==g;++m)f[m].evaluate(l),d[m].accumulateAdditive(c);break;case zy:default:for(let m=0,g=f.length;m!==g;++m)f[m].evaluate(l),d[m].accumulate(r,c)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,s=this._loopCount;const l=n===yT;if(e===0)return s===-1?r:l&&(s&1)===1?t-r:r;if(n===vT){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,l)):this._setEndings(this.repetitions===0,!0,l)),r>=t||r<0){const c=Math.floor(r/t);r-=t*c,s+=Math.abs(c);const f=this.repetitions-s;if(f<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(f===1){const d=e<0;this._setEndings(d,!d,l)}else this._setEndings(!1,!1,l);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:c})}}else this.time=r;if(l&&(s&1)===1)return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=vp,r.endingEnd=vp):(e?r.endingStart=this.zeroSlopeAtStart?vp:gp:r.endingStart=Hg,t?r.endingEnd=this.zeroSlopeAtEnd?vp:gp:r.endingEnd=Hg)}_scheduleFading(e,t,n){const r=this._mixer,s=r.time;let l=this._weightInterpolant;l===null&&(l=r._lendControlInterpolant(),this._weightInterpolant=l);const c=l.parameterPositions,f=l.sampleValues;return c[0]=s,f[0]=t,c[1]=s+e,f[1]=n,this}}const sL=new Float32Array(1);class aL extends Df{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,s=r.length,l=e._propertyBindings,c=e._interpolants,f=n.uuid,d=this._bindingsByRootAndName;let m=d[f];m===void 0&&(m={},d[f]=m);for(let g=0;g!==s;++g){const y=r[g],v=y.name;let S=m[v];if(S!==void 0)++S.referenceCount,l[g]=S;else{if(S=l[g],S!==void 0){S._cacheIndex===null&&(++S.referenceCount,this._addInactiveBinding(S,f,v));continue}const T=t&&t._propertyBindings[g].binding.parsedPath;S=new EE(cr.create(n,v,T),y.ValueTypeName,y.getValueSize()),++S.referenceCount,this._addInactiveBinding(S,f,v),l[g]=S}c[g].resultBuffer=S.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,n)}const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,s=this._actionsByClip;let l=s[t];if(l===void 0)l={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=l;else{const c=l.knownActions;e._byClipCacheIndex=c.length,c.push(e)}e._cacheIndex=r.length,r.push(e),l.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,l=this._actionsByClip,c=l[s],f=c.knownActions,d=f[f.length-1],m=e._byClipCacheIndex;d._byClipCacheIndex=m,f[m]=d,f.pop(),e._byClipCacheIndex=null;const g=c.actionByRoot,y=(e._localRoot||this._root).uuid;delete g[y],f.length===0&&delete l[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,s=this._bindings;let l=r[t];l===void 0&&(l={},r[t]=l),l[n]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,s=n.path,l=this._bindingsByRootAndName,c=l[r],f=t[t.length-1],d=e._cacheIndex;f._cacheIndex=d,t[d]=f,t.pop(),delete c[s],Object.keys(c).length===0&&delete l[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new VS(new Float32Array(2),new Float32Array(2),1,sL),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=n,t[n]=s}clipAction(e,t,n){const r=t||this._root,s=r.uuid;let l=typeof e=="string"?Qg.findByName(r,e):e;const c=l!==null?l.uuid:e,f=this._actionsByClip[c];let d=null;if(n===void 0&&(l!==null?n=l.blendMode:n=zy),f!==void 0){const g=f.actionByRoot[s];if(g!==void 0&&g.blendMode===n)return g;d=f.knownActions[0],l===null&&(l=d._clip)}if(l===null)return null;const m=new CE(this,l,t,n);return this._bindAction(m,d),this._addInactiveAction(m,c,s),m}existingAction(e,t){const n=t||this._root,r=n.uuid,s=typeof e=="string"?Qg.findByName(n,e):e,l=s?s.uuid:e,c=this._actionsByClip[l];return c!==void 0&&c.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,s=Math.sign(e),l=this._accuIndex^=1;for(let d=0;d!==n;++d)t[d]._update(r,e,s,l);const c=this._bindings,f=this._nActiveBindings;for(let d=0;d!==f;++d)c[d].apply(l);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,s=r[n];if(s!==void 0){const l=s.knownActions;for(let c=0,f=l.length;c!==f;++c){const d=l[c];this._deactivateAction(d);const m=d._cacheIndex,g=t[t.length-1];d._cacheIndex=null,d._byClipCacheIndex=null,g._cacheIndex=m,t[m]=g,t.pop(),this._removeInactiveBindingsForAction(d)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const l in n){const c=n[l].actionByRoot,f=c[t];f!==void 0&&(this._deactivateAction(f),this._removeInactiveAction(f))}const r=this._bindingsByRootAndName,s=r[t];if(s!==void 0)for(const l in s){const c=s[l];c.restoreOriginalState(),this._removeInactiveBinding(c)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class oL extends AS{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isRenderTarget3D=!0,this.depth=n,this.texture=new Gy(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class JS{constructor(e){this.value=e}clone(){return new JS(this.value.clone===void 0?this.value:this.value.clone())}}let lL=0;class cL extends Df{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:lL++}),this.name="",this.usage=qg,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,r=t.length;n<r;n++){const s=Array.isArray(t[n])?t[n]:[t[n]];for(let l=0;l<s.length;l++)this.uniforms.push(s[l].clone())}return this}clone(){return new this.constructor().copy(this)}}class uL extends Zy{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class fL{constructor(e,t,n,r,s,l=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=s,this.normalized=l,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const u3=new ui;class S0{constructor(e,t,n=0,r=1/0){this.ray=new Ip(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new f0,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):Hn("Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return u3.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(u3),this}intersectObject(e,t=!0,n=[]){return B_(e,this,n,t),n.sort(f3),n}intersectObjects(e,t=!0,n=[]){for(let r=0,s=e.length;r<s;r++)B_(e[r],this,n,t);return n.sort(f3),n}}function f3(i,e){return i.distance-e.distance}function B_(i,e,t,n){let r=!0;if(i.layers.test(e.layers)&&i.raycast(e,t)===!1&&(r=!1),r===!0&&n===!0){const s=i.children;for(let l=0,c=s.length;l<c;l++)B_(s[l],e,t,!0)}}class hL{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,e.hidden!==void 0&&(this._pageVisibilityHandler=dL.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){this._pageVisibilityHandler!==null&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return this._pageVisibilityHandler!==null&&this._document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(e!==void 0?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}}function dL(){this._document.hidden===!1&&this.reset()}class U_{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=oi(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(oi(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class pL{constructor(e=1,t=0,n=0){this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}class KS{constructor(e,t,n,r){KS.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,r){const s=this.elements;return s[0]=e,s[2]=t,s[1]=n,s[3]=r,this}}const h3=new zt;class mL{constructor(e=new zt(1/0,1/0),t=new zt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=h3.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,h3).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const d3=new Ee,Jv=new Ee,Im=new Ee,Dm=new Ee,I5=new Ee,gL=new Ee,vL=new Ee;class xL{constructor(e=new Ee,t=new Ee){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){d3.subVectors(e,this.start),Jv.subVectors(this.end,this.start);const n=Jv.dot(Jv);let s=Jv.dot(d3)/n;return t&&(s=oi(s,0,1)),s}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}distanceSqToLine3(e,t=gL,n=vL){const r=10000000000000001e-32;let s,l;const c=this.start,f=e.start,d=this.end,m=e.end;Im.subVectors(d,c),Dm.subVectors(m,f),I5.subVectors(c,f);const g=Im.dot(Im),y=Dm.dot(Dm),v=Dm.dot(I5);if(g<=r&&y<=r)return t.copy(c),n.copy(f),t.sub(n),t.dot(t);if(g<=r)s=0,l=v/y,l=oi(l,0,1);else{const S=Im.dot(I5);if(y<=r)l=0,s=oi(-S/g,0,1);else{const T=Im.dot(Dm),A=g*y-T*T;A!==0?s=oi((T*v-S*y)/A,0,1):s=0,l=(T*s+v)/y,l<0?(l=0,s=oi(-S/g,0,1)):l>1&&(l=1,s=oi((T-S)/g,0,1))}}return t.copy(c).add(Im.multiplyScalar(s)),n.copy(f).add(Dm.multiplyScalar(l)),t.sub(n),t.dot(t)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const p3=new Ee;class yL extends Oi{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new Si,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let l=0,c=1,f=32;l<f;l++,c++){const d=l/f*Math.PI*2,m=c/f*Math.PI*2;r.push(Math.cos(d),Math.sin(d),1,Math.cos(m),Math.sin(m),1)}n.setAttribute("position",new kn(r,3));const s=new hl({fog:!1,toneMapped:!1});this.cone=new Of(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),p3.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(p3),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const id=new Ee,Kv=new ui,D5=new ui;class bL extends Of{constructor(e){const t=NE(e),n=new Si,r=[],s=[];for(let d=0;d<t.length;d++){const m=t[d];m.parent&&m.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(0,0,0),s.push(0,0,0))}n.setAttribute("position",new kn(r,3)),n.setAttribute("color",new kn(s,3));const l=new hl({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const c=new fn(255),f=new fn(65280);this.setColors(c,f)}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");D5.copy(this.root.matrixWorld).invert();for(let s=0,l=0;s<t.length;s++){const c=t[s];c.parent&&c.parent.isBone&&(Kv.multiplyMatrices(D5,c.matrixWorld),id.setFromMatrixPosition(Kv),r.setXYZ(l,id.x,id.y,id.z),Kv.multiplyMatrices(D5,c.parent.matrixWorld),id.setFromMatrixPosition(Kv),r.setXYZ(l+1,id.x,id.y,id.z),l+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){const r=this.geometry.getAttribute("color");for(let s=0;s<r.count;s+=2)r.setXYZ(s,e.r,e.g,e.b),r.setXYZ(s+1,t.r,t.g,t.b);return r.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function NE(i){const e=[];i.isBone===!0&&e.push(i);for(let t=0;t<i.children.length;t++)e.push(...NE(i.children[t]));return e}class _L extends js{constructor(e,t,n){const r=new y1(t,4,2),s=new kf({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const SL=new Ee,m3=new fn,g3=new fn;class wL extends Oi{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new x1(t);r.rotateY(Math.PI*.5),this.material=new kf({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),l=new Float32Array(s.count*3);r.setAttribute("color",new zr(l,3)),this.add(new js(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");m3.copy(this.light.color),g3.copy(this.light.groundColor);for(let n=0,r=t.count;n<r;n++){const s=n<r/2?m3:g3;t.setXYZ(n,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(SL.setFromMatrixPosition(this.light.matrixWorld).negate())}}class ML extends Of{constructor(e=10,t=10,n=4473924,r=8947848){n=new fn(n),r=new fn(r);const s=t/2,l=e/t,c=e/2,f=[],d=[];for(let y=0,v=0,S=-c;y<=t;y++,S+=l){f.push(-c,0,S,c,0,S),f.push(S,0,-c,S,0,c);const T=y===s?n:r;T.toArray(d,v),v+=3,T.toArray(d,v),v+=3,T.toArray(d,v),v+=3,T.toArray(d,v),v+=3}const m=new Si;m.setAttribute("position",new kn(f,3)),m.setAttribute("color",new kn(d,3));const g=new hl({vertexColors:!0,toneMapped:!1});super(m,g),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class AL extends Of{constructor(e=10,t=16,n=8,r=64,s=4473924,l=8947848){s=new fn(s),l=new fn(l);const c=[],f=[];if(t>1)for(let g=0;g<t;g++){const y=g/t*(Math.PI*2),v=Math.sin(y)*e,S=Math.cos(y)*e;c.push(0,0,0),c.push(v,0,S);const T=g&1?s:l;f.push(T.r,T.g,T.b),f.push(T.r,T.g,T.b)}for(let g=0;g<n;g++){const y=g&1?s:l,v=e-e/n*g;for(let S=0;S<r;S++){let T=S/r*(Math.PI*2),A=Math.sin(T)*v,w=Math.cos(T)*v;c.push(A,0,w),f.push(y.r,y.g,y.b),T=(S+1)/r*(Math.PI*2),A=Math.sin(T)*v,w=Math.cos(T)*v,c.push(A,0,w),f.push(y.r,y.g,y.b)}}const d=new Si;d.setAttribute("position",new kn(c,3)),d.setAttribute("color",new kn(f,3));const m=new hl({vertexColors:!0,toneMapped:!1});super(d,m),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const v3=new Ee,Qv=new Ee,x3=new Ee;class TL extends Oi{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new Si;r.setAttribute("position",new kn([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new hl({fog:!1,toneMapped:!1});this.lightPlane=new vd(r,s),this.add(this.lightPlane),r=new Si,r.setAttribute("position",new kn([0,0,0,0,0,1],3)),this.targetLine=new vd(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),v3.setFromMatrixPosition(this.light.matrixWorld),Qv.setFromMatrixPosition(this.light.target.matrixWorld),x3.subVectors(Qv,v3),this.lightPlane.lookAt(Qv),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Qv),this.targetLine.scale.z=x3.length()}}const ex=new Ee,Ys=new qy;class EL extends Of{constructor(e){const t=new Si,n=new hl({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],l={};c("n1","n2"),c("n2","n4"),c("n4","n3"),c("n3","n1"),c("f1","f2"),c("f2","f4"),c("f4","f3"),c("f3","f1"),c("n1","f1"),c("n2","f2"),c("n3","f3"),c("n4","f4"),c("p","n1"),c("p","n2"),c("p","n3"),c("p","n4"),c("u1","u2"),c("u2","u3"),c("u3","u1"),c("c","t"),c("p","c"),c("cn1","cn2"),c("cn3","cn4"),c("cf1","cf2"),c("cf3","cf4");function c(S,T){f(S),f(T)}function f(S){r.push(0,0,0),s.push(0,0,0),l[S]===void 0&&(l[S]=[]),l[S].push(r.length/3-1)}t.setAttribute("position",new kn(r,3)),t.setAttribute("color",new kn(s,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=l,this.update();const d=new fn(16755200),m=new fn(16711680),g=new fn(43775),y=new fn(16777215),v=new fn(3355443);this.setColors(d,m,g,y,v)}setColors(e,t,n,r,s){const c=this.geometry.getAttribute("color");return c.setXYZ(0,e.r,e.g,e.b),c.setXYZ(1,e.r,e.g,e.b),c.setXYZ(2,e.r,e.g,e.b),c.setXYZ(3,e.r,e.g,e.b),c.setXYZ(4,e.r,e.g,e.b),c.setXYZ(5,e.r,e.g,e.b),c.setXYZ(6,e.r,e.g,e.b),c.setXYZ(7,e.r,e.g,e.b),c.setXYZ(8,e.r,e.g,e.b),c.setXYZ(9,e.r,e.g,e.b),c.setXYZ(10,e.r,e.g,e.b),c.setXYZ(11,e.r,e.g,e.b),c.setXYZ(12,e.r,e.g,e.b),c.setXYZ(13,e.r,e.g,e.b),c.setXYZ(14,e.r,e.g,e.b),c.setXYZ(15,e.r,e.g,e.b),c.setXYZ(16,e.r,e.g,e.b),c.setXYZ(17,e.r,e.g,e.b),c.setXYZ(18,e.r,e.g,e.b),c.setXYZ(19,e.r,e.g,e.b),c.setXYZ(20,e.r,e.g,e.b),c.setXYZ(21,e.r,e.g,e.b),c.setXYZ(22,e.r,e.g,e.b),c.setXYZ(23,e.r,e.g,e.b),c.setXYZ(24,t.r,t.g,t.b),c.setXYZ(25,t.r,t.g,t.b),c.setXYZ(26,t.r,t.g,t.b),c.setXYZ(27,t.r,t.g,t.b),c.setXYZ(28,t.r,t.g,t.b),c.setXYZ(29,t.r,t.g,t.b),c.setXYZ(30,t.r,t.g,t.b),c.setXYZ(31,t.r,t.g,t.b),c.setXYZ(32,n.r,n.g,n.b),c.setXYZ(33,n.r,n.g,n.b),c.setXYZ(34,n.r,n.g,n.b),c.setXYZ(35,n.r,n.g,n.b),c.setXYZ(36,n.r,n.g,n.b),c.setXYZ(37,n.r,n.g,n.b),c.setXYZ(38,r.r,r.g,r.b),c.setXYZ(39,r.r,r.g,r.b),c.setXYZ(40,s.r,s.g,s.b),c.setXYZ(41,s.r,s.g,s.b),c.setXYZ(42,s.r,s.g,s.b),c.setXYZ(43,s.r,s.g,s.b),c.setXYZ(44,s.r,s.g,s.b),c.setXYZ(45,s.r,s.g,s.b),c.setXYZ(46,s.r,s.g,s.b),c.setXYZ(47,s.r,s.g,s.b),c.setXYZ(48,s.r,s.g,s.b),c.setXYZ(49,s.r,s.g,s.b),c.needsUpdate=!0,this}update(){const e=this.geometry,t=this.pointMap,n=1,r=1;let s,l;if(Ys.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),this.camera.reversedDepth===!0)s=1,l=0;else if(this.camera.coordinateSystem===wc)s=-1,l=1;else if(this.camera.coordinateSystem===l0)s=0,l=1;else throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);ha("c",t,e,Ys,0,0,s),ha("t",t,e,Ys,0,0,l),ha("n1",t,e,Ys,-n,-r,s),ha("n2",t,e,Ys,n,-r,s),ha("n3",t,e,Ys,-n,r,s),ha("n4",t,e,Ys,n,r,s),ha("f1",t,e,Ys,-n,-r,l),ha("f2",t,e,Ys,n,-r,l),ha("f3",t,e,Ys,-n,r,l),ha("f4",t,e,Ys,n,r,l),ha("u1",t,e,Ys,n*.7,r*1.1,s),ha("u2",t,e,Ys,-n*.7,r*1.1,s),ha("u3",t,e,Ys,0,r*2,s),ha("cf1",t,e,Ys,-n,0,l),ha("cf2",t,e,Ys,n,0,l),ha("cf3",t,e,Ys,0,-r,l),ha("cf4",t,e,Ys,0,r,l),ha("cn1",t,e,Ys,-n,0,s),ha("cn2",t,e,Ys,n,0,s),ha("cn3",t,e,Ys,0,-r,s),ha("cn4",t,e,Ys,0,r,s),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function ha(i,e,t,n,r,s,l){ex.set(r,s,l).unproject(n);const c=e[i];if(c!==void 0){const f=t.getAttribute("position");for(let d=0,m=c.length;d<m;d++)f.setXYZ(c[d],ex.x,ex.y,ex.z)}}const tx=new Fo;class CL extends Of{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),s=new Si;s.setIndex(new zr(n,1)),s.setAttribute("position",new zr(r,3)),super(s,new hl({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&tx.setFromObject(this.object),tx.isEmpty())return;const e=tx.min,t=tx.max,n=this.geometry.attributes.position,r=n.array;r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=e.x,r[4]=t.y,r[5]=t.z,r[6]=e.x,r[7]=e.y,r[8]=t.z,r[9]=t.x,r[10]=e.y,r[11]=t.z,r[12]=t.x,r[13]=t.y,r[14]=e.z,r[15]=e.x,r[16]=t.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=t.x,r[22]=e.y,r[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class NL extends Of{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Si;s.setIndex(new zr(n,1)),s.setAttribute("position",new kn(r,3)),super(s,new hl({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class RL extends vd{constructor(e,t=1,n=16776960){const r=n,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],l=new Si;l.setAttribute("position",new kn(s,3)),l.computeBoundingSphere(),super(l,new hl({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const c=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],f=new Si;f.setAttribute("position",new kn(c,3)),f.computeBoundingSphere(),this.add(new js(f,new kf({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const y3=new Ee;let nx,k5;class LL extends Oi{constructor(e=new Ee(0,0,1),t=new Ee(0,0,0),n=1,r=16776960,s=n*.2,l=s*.2){super(),this.type="ArrowHelper",nx===void 0&&(nx=new Si,nx.setAttribute("position",new kn([0,0,0,0,1,0],3)),k5=new g1(.5,1,5,1),k5.translate(0,-.5,0)),this.position.copy(t),this.line=new vd(nx,new hl({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new js(k5,new kf({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,s,l)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{y3.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(y3,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class PL extends Of{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Si;r.setAttribute("position",new kn(t,3)),r.setAttribute("color",new kn(n,3));const s=new hl({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,t,n){const r=new fn,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(n),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class IL{constructor(){this.type="ShapePath",this.color=new fn,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new _y,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,s,l){return this.currentPath.bezierCurveTo(e,t,n,r,s,l),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(w){const R=[];for(let D=0,I=w.length;D<I;D++){const z=w[D],j=new Mp;j.curves=z.curves,R.push(j)}return R}function n(w,R){const D=R.length;let I=!1;for(let z=D-1,j=0;j<D;z=j++){let X=R[z],G=R[j],L=G.x-X.x,k=G.y-X.y;if(Math.abs(k)>Number.EPSILON){if(k<0&&(X=R[j],L=-L,G=R[z],k=-k),w.y<X.y||w.y>G.y)continue;if(w.y===X.y){if(w.x===X.x)return!0}else{const U=k*(w.x-X.x)-L*(w.y-X.y);if(U===0)return!0;if(U<0)continue;I=!I}}else{if(w.y!==X.y)continue;if(G.x<=w.x&&w.x<=X.x||X.x<=w.x&&w.x<=G.x)return!0}}return I}const r=ku.isClockWise,s=this.subPaths;if(s.length===0)return[];let l,c,f;const d=[];if(s.length===1)return c=s[0],f=new Mp,f.curves=c.curves,d.push(f),d;let m=!r(s[0].getPoints());m=e?!m:m;const g=[],y=[];let v=[],S=0,T;y[S]=void 0,v[S]=[];for(let w=0,R=s.length;w<R;w++)c=s[w],T=c.getPoints(),l=r(T),l=e?!l:l,l?(!m&&y[S]&&S++,y[S]={s:new Mp,p:T},y[S].s.curves=c.curves,m&&S++,v[S]=[]):v[S].push({h:c,p:T[0]});if(!y[0])return t(s);if(y.length>1){let w=!1,R=0;for(let D=0,I=y.length;D<I;D++)g[D]=[];for(let D=0,I=y.length;D<I;D++){const z=v[D];for(let j=0;j<z.length;j++){const X=z[j];let G=!0;for(let L=0;L<y.length;L++)n(X.p,y[L].p)&&(D!==L&&R++,G?(G=!1,g[L].push(X)):w=!0);G&&g[D].push(X)}}R>0&&w===!1&&(v=g)}let A;for(let w=0,R=y.length;w<R;w++){f=y[w].s,d.push(f),A=v[w];for(let D=0,I=A.length;D<I;D++)f.holes.push(A[D].h)}return d}}class DL extends Df{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){Mn("Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function kL(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2):(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0),i}function OL(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0):(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2),i}function BL(i){return i.repeat.x=1,i.repeat.y=1,i.offset.x=0,i.offset.y=0,i}function F_(i,e,t,n){const r=UL(n);switch(t){case _S:return i*e;case f1:return i*e/r.components*r.byteLength;case h1:return i*e/r.components*r.byteLength;case Ep:return i*e*2/r.components*r.byteLength;case Uy:return i*e*2/r.components*r.byteLength;case SS:return i*e*3/r.components*r.byteLength;case xa:return i*e*4/r.components*r.byteLength;case Fy:return i*e*4/r.components*r.byteLength;case Cg:case Ng:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case Rg:case Lg:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case zx:case Vx:return Math.max(i,16)*Math.max(e,8)/4;case Fx:case jx:return Math.max(i,8)*Math.max(e,8)/2;case Hx:case Gx:case Wx:case Xx:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case qx:case Yx:case Zx:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case $x:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case Jx:return Math.floor((i+4)/5)*Math.floor((e+3)/4)*16;case Kx:return Math.floor((i+4)/5)*Math.floor((e+4)/5)*16;case Qx:return Math.floor((i+5)/6)*Math.floor((e+4)/5)*16;case ey:return Math.floor((i+5)/6)*Math.floor((e+5)/6)*16;case ty:return Math.floor((i+7)/8)*Math.floor((e+4)/5)*16;case ny:return Math.floor((i+7)/8)*Math.floor((e+5)/6)*16;case iy:return Math.floor((i+7)/8)*Math.floor((e+7)/8)*16;case ry:return Math.floor((i+9)/10)*Math.floor((e+4)/5)*16;case sy:return Math.floor((i+9)/10)*Math.floor((e+5)/6)*16;case ay:return Math.floor((i+9)/10)*Math.floor((e+7)/8)*16;case oy:return Math.floor((i+9)/10)*Math.floor((e+9)/10)*16;case ly:return Math.floor((i+11)/12)*Math.floor((e+9)/10)*16;case cy:return Math.floor((i+11)/12)*Math.floor((e+11)/12)*16;case uy:case fy:case hy:return Math.ceil(i/4)*Math.ceil(e/4)*16;case dy:case py:return Math.ceil(i/4)*Math.ceil(e/4)*8;case my:case gy:return Math.ceil(i/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function UL(i){switch(i){case $a:case Dy:return{byteLength:1,components:1};case a0:case ky:case Ks:return{byteLength:2,components:1};case Oy:case By:return{byteLength:2,components:4};case Ec:case u1:case Cs:return{byteLength:4,components:1};case yS:case bS:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${i}.`)}class FL{static contain(e,t){return kL(e,t)}static cover(e,t){return OL(e,t)}static fill(e){return BL(e)}static getByteLength(e,t,n,r){return F_(e,t,n,r)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:l1}}));typeof window<"u"&&(window.__THREE__?Mn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=l1);function RE(){let i=null,e=!1,t=null,n=null;function r(s,l){t(s,l),n=i.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function zL(i){const e=new WeakMap;function t(c,f){const d=c.array,m=c.usage,g=d.byteLength,y=i.createBuffer();i.bindBuffer(f,y),i.bufferData(f,d,m),c.onUploadCallback();let v;if(d instanceof Float32Array)v=i.FLOAT;else if(typeof Float16Array<"u"&&d instanceof Float16Array)v=i.HALF_FLOAT;else if(d instanceof Uint16Array)c.isFloat16BufferAttribute?v=i.HALF_FLOAT:v=i.UNSIGNED_SHORT;else if(d instanceof Int16Array)v=i.SHORT;else if(d instanceof Uint32Array)v=i.UNSIGNED_INT;else if(d instanceof Int32Array)v=i.INT;else if(d instanceof Int8Array)v=i.BYTE;else if(d instanceof Uint8Array)v=i.UNSIGNED_BYTE;else if(d instanceof Uint8ClampedArray)v=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);return{buffer:y,type:v,bytesPerElement:d.BYTES_PER_ELEMENT,version:c.version,size:g}}function n(c,f,d){const m=f.array,g=f.updateRanges;if(i.bindBuffer(d,c),g.length===0)i.bufferSubData(d,0,m);else{g.sort((v,S)=>v.start-S.start);let y=0;for(let v=1;v<g.length;v++){const S=g[y],T=g[v];T.start<=S.start+S.count+1?S.count=Math.max(S.count,T.start+T.count-S.start):(++y,g[y]=T)}g.length=y+1;for(let v=0,S=g.length;v<S;v++){const T=g[v];i.bufferSubData(d,T.start*m.BYTES_PER_ELEMENT,m,T.start,T.count)}f.clearUpdateRanges()}f.onUploadCallback()}function r(c){return c.isInterleavedBufferAttribute&&(c=c.data),e.get(c)}function s(c){c.isInterleavedBufferAttribute&&(c=c.data);const f=e.get(c);f&&(i.deleteBuffer(f.buffer),e.delete(c))}function l(c,f){if(c.isInterleavedBufferAttribute&&(c=c.data),c.isGLBufferAttribute){const m=e.get(c);(!m||m.version<c.version)&&e.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}const d=e.get(c);if(d===void 0)e.set(c,t(c,f));else if(d.version<c.version){if(d.size!==c.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(d.buffer,c,f),d.version=c.version}}return{get:r,remove:s,update:l}}var jL=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,VL=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,HL=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,GL=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,qL=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,WL=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,XL=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,YL=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,ZL=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,$L=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,JL=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,KL=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,QL=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,e8=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,t8=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,n8=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,i8=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,r8=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,s8=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,a8=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,o8=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,l8=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,c8=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,u8=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,f8=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,h8=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,d8=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,p8=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,m8=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,g8=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,v8="gl_FragColor = linearToOutputTexel( gl_FragColor );",x8=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,y8=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,b8=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,_8=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,S8=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,w8=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,M8=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,A8=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,T8=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,E8=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,C8=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,N8=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,R8=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,L8=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,P8=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,I8=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,D8=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,k8=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,O8=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,B8=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,U8=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.metalness = metalnessFactor;
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = vec3( 0.04 );
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,F8=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	vec3 diffuseContribution;
	vec3 specularColor;
	vec3 specularColorBlended;
	float roughness;
	float metalness;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
		vec3 iridescenceFresnelDielectric;
		vec3 iridescenceFresnelMetallic;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return v;
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColorBlended;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float rInv = 1.0 / ( roughness + 0.1 );
	float a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;
	float b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;
	float DG = exp( a * dotNV + b );
	return saturate( DG );
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;
	vec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;
	vec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
 
 		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
 
 		float sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
 		float sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );
 
 		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );
 
 		irradiance *= sheenEnergyComp;
 
 	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		diffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectDiffuse += diffuse;
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;
 	#endif
	vec3 singleScatteringDielectric = vec3( 0.0 );
	vec3 multiScatteringDielectric = vec3( 0.0 );
	vec3 singleScatteringMetallic = vec3( 0.0 );
	vec3 multiScatteringMetallic = vec3( 0.0 );
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#endif
	vec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );
	vec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );
	vec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;
	vec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	vec3 indirectSpecular = radiance * singleScattering;
	indirectSpecular += multiScattering * cosineWeightedIrradiance;
	vec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		indirectSpecular *= sheenEnergyComp;
		indirectDiffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectSpecular += indirectSpecular;
	reflectedLight.indirectDiffuse += indirectDiffuse;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,z8=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );
		material.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,j8=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,V8=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,H8=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,G8=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,q8=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,W8=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,X8=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Y8=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Z8=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,$8=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,J8=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,K8=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Q8=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,eP=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,tP=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,nP=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,iP=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,rP=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,sP=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,aP=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,oP=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,lP=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,cP=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,uP=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,fP=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,hP=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,dP=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,pP=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,mP=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,gP=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,vP=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,xP=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,yP=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,bP=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,_P=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,SP=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#else
			uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#endif
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#else
			uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#endif
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#elif defined( SHADOWMAP_TYPE_BASIC )
			uniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#endif
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float interleavedGradientNoise( vec2 position ) {
			return fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );
		}
		vec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {
			const float goldenAngle = 2.399963229728653;
			float r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );
			float theta = float( sampleIndex ) * goldenAngle + phi;
			return vec2( cos( theta ), sin( theta ) ) * r;
		}
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
				float radius = shadowRadius * texelSize.x;
				float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
				shadow = (
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )
				) * 0.2;
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#elif defined( SHADOWMAP_TYPE_VSM )
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;
				float mean = distribution.x;
				float variance = distribution.y * distribution.y;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					float hard_shadow = step( mean, shadowCoord.z );
				#else
					float hard_shadow = step( shadowCoord.z, mean );
				#endif
				if ( hard_shadow == 1.0 ) {
					shadow = 1.0;
				} else {
					variance = max( variance, 0.0000001 );
					float d = shadowCoord.z - mean;
					float p_max = variance / ( variance + d * d );
					p_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );
					shadow = max( hard_shadow, p_max );
				}
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#else
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				float depth = texture2D( shadowMap, shadowCoord.xy ).r;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					shadow = step( depth, shadowCoord.z );
				#else
					shadow = step( shadowCoord.z, depth );
				#endif
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#if defined( SHADOWMAP_TYPE_PCF )
	float getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float texelSize = shadowRadius / shadowMapSize.x;
			vec3 absDir = abs( bd3D );
			vec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );
			tangent = normalize( cross( bd3D, tangent ) );
			vec3 bitangent = cross( bd3D, tangent );
			float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
			shadow = (
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )
			) * 0.2;
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#elif defined( SHADOWMAP_TYPE_BASIC )
	float getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float depth = textureCube( shadowMap, bd3D ).r;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				shadow = step( depth, dp );
			#else
				shadow = step( dp, depth );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#endif
	#endif
#endif`,wP=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,MP=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,AP=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,TP=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,EP=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,CP=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,NP=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,RP=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,LP=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,PP=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,IP=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,DP=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,kP=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,OP=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,BP=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,UP=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,FP=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const zP=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,jP=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,VP=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,HP=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,GP=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,qP=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,WP=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,XP=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,YP=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,ZP=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );
}`,$P=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,JP=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,KP=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,QP=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,eI=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,tI=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,nI=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,iI=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,rI=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,sI=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,aI=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,oI=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,lI=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,cI=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,uI=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,fI=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
 
		outgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;
 
 	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,hI=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,dI=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,pI=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,mI=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,gI=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,vI=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,xI=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,yI=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ki={alphahash_fragment:jL,alphahash_pars_fragment:VL,alphamap_fragment:HL,alphamap_pars_fragment:GL,alphatest_fragment:qL,alphatest_pars_fragment:WL,aomap_fragment:XL,aomap_pars_fragment:YL,batching_pars_vertex:ZL,batching_vertex:$L,begin_vertex:JL,beginnormal_vertex:KL,bsdfs:QL,iridescence_fragment:e8,bumpmap_pars_fragment:t8,clipping_planes_fragment:n8,clipping_planes_pars_fragment:i8,clipping_planes_pars_vertex:r8,clipping_planes_vertex:s8,color_fragment:a8,color_pars_fragment:o8,color_pars_vertex:l8,color_vertex:c8,common:u8,cube_uv_reflection_fragment:f8,defaultnormal_vertex:h8,displacementmap_pars_vertex:d8,displacementmap_vertex:p8,emissivemap_fragment:m8,emissivemap_pars_fragment:g8,colorspace_fragment:v8,colorspace_pars_fragment:x8,envmap_fragment:y8,envmap_common_pars_fragment:b8,envmap_pars_fragment:_8,envmap_pars_vertex:S8,envmap_physical_pars_fragment:I8,envmap_vertex:w8,fog_vertex:M8,fog_pars_vertex:A8,fog_fragment:T8,fog_pars_fragment:E8,gradientmap_pars_fragment:C8,lightmap_pars_fragment:N8,lights_lambert_fragment:R8,lights_lambert_pars_fragment:L8,lights_pars_begin:P8,lights_toon_fragment:D8,lights_toon_pars_fragment:k8,lights_phong_fragment:O8,lights_phong_pars_fragment:B8,lights_physical_fragment:U8,lights_physical_pars_fragment:F8,lights_fragment_begin:z8,lights_fragment_maps:j8,lights_fragment_end:V8,logdepthbuf_fragment:H8,logdepthbuf_pars_fragment:G8,logdepthbuf_pars_vertex:q8,logdepthbuf_vertex:W8,map_fragment:X8,map_pars_fragment:Y8,map_particle_fragment:Z8,map_particle_pars_fragment:$8,metalnessmap_fragment:J8,metalnessmap_pars_fragment:K8,morphinstance_vertex:Q8,morphcolor_vertex:eP,morphnormal_vertex:tP,morphtarget_pars_vertex:nP,morphtarget_vertex:iP,normal_fragment_begin:rP,normal_fragment_maps:sP,normal_pars_fragment:aP,normal_pars_vertex:oP,normal_vertex:lP,normalmap_pars_fragment:cP,clearcoat_normal_fragment_begin:uP,clearcoat_normal_fragment_maps:fP,clearcoat_pars_fragment:hP,iridescence_pars_fragment:dP,opaque_fragment:pP,packing:mP,premultiplied_alpha_fragment:gP,project_vertex:vP,dithering_fragment:xP,dithering_pars_fragment:yP,roughnessmap_fragment:bP,roughnessmap_pars_fragment:_P,shadowmap_pars_fragment:SP,shadowmap_pars_vertex:wP,shadowmap_vertex:MP,shadowmask_pars_fragment:AP,skinbase_vertex:TP,skinning_pars_vertex:EP,skinning_vertex:CP,skinnormal_vertex:NP,specularmap_fragment:RP,specularmap_pars_fragment:LP,tonemapping_fragment:PP,tonemapping_pars_fragment:IP,transmission_fragment:DP,transmission_pars_fragment:kP,uv_pars_fragment:OP,uv_pars_vertex:BP,uv_vertex:UP,worldpos_vertex:FP,background_vert:zP,background_frag:jP,backgroundCube_vert:VP,backgroundCube_frag:HP,cube_vert:GP,cube_frag:qP,depth_vert:WP,depth_frag:XP,distance_vert:YP,distance_frag:ZP,equirect_vert:$P,equirect_frag:JP,linedashed_vert:KP,linedashed_frag:QP,meshbasic_vert:eI,meshbasic_frag:tI,meshlambert_vert:nI,meshlambert_frag:iI,meshmatcap_vert:rI,meshmatcap_frag:sI,meshnormal_vert:aI,meshnormal_frag:oI,meshphong_vert:lI,meshphong_frag:cI,meshphysical_vert:uI,meshphysical_frag:fI,meshtoon_vert:hI,meshtoon_frag:dI,points_vert:pI,points_frag:mI,shadow_vert:gI,shadow_frag:vI,sprite_vert:xI,sprite_frag:yI},An={common:{diffuse:{value:new fn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Ei},alphaMap:{value:null},alphaMapTransform:{value:new Ei},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Ei}},envmap:{envMap:{value:null},envMapRotation:{value:new Ei},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Ei}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Ei}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Ei},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Ei},normalScale:{value:new zt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Ei},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Ei}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Ei}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Ei}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new fn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new fn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Ei},alphaTest:{value:0},uvTransform:{value:new Ei}},sprite:{diffuse:{value:new fn(16777215)},opacity:{value:1},center:{value:new zt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Ei},alphaMap:{value:null},alphaMapTransform:{value:new Ei},alphaTest:{value:0}}},Du={basic:{uniforms:al([An.common,An.specularmap,An.envmap,An.aomap,An.lightmap,An.fog]),vertexShader:ki.meshbasic_vert,fragmentShader:ki.meshbasic_frag},lambert:{uniforms:al([An.common,An.specularmap,An.envmap,An.aomap,An.lightmap,An.emissivemap,An.bumpmap,An.normalmap,An.displacementmap,An.fog,An.lights,{emissive:{value:new fn(0)}}]),vertexShader:ki.meshlambert_vert,fragmentShader:ki.meshlambert_frag},phong:{uniforms:al([An.common,An.specularmap,An.envmap,An.aomap,An.lightmap,An.emissivemap,An.bumpmap,An.normalmap,An.displacementmap,An.fog,An.lights,{emissive:{value:new fn(0)},specular:{value:new fn(1118481)},shininess:{value:30}}]),vertexShader:ki.meshphong_vert,fragmentShader:ki.meshphong_frag},standard:{uniforms:al([An.common,An.envmap,An.aomap,An.lightmap,An.emissivemap,An.bumpmap,An.normalmap,An.displacementmap,An.roughnessmap,An.metalnessmap,An.fog,An.lights,{emissive:{value:new fn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ki.meshphysical_vert,fragmentShader:ki.meshphysical_frag},toon:{uniforms:al([An.common,An.aomap,An.lightmap,An.emissivemap,An.bumpmap,An.normalmap,An.displacementmap,An.gradientmap,An.fog,An.lights,{emissive:{value:new fn(0)}}]),vertexShader:ki.meshtoon_vert,fragmentShader:ki.meshtoon_frag},matcap:{uniforms:al([An.common,An.bumpmap,An.normalmap,An.displacementmap,An.fog,{matcap:{value:null}}]),vertexShader:ki.meshmatcap_vert,fragmentShader:ki.meshmatcap_frag},points:{uniforms:al([An.points,An.fog]),vertexShader:ki.points_vert,fragmentShader:ki.points_frag},dashed:{uniforms:al([An.common,An.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ki.linedashed_vert,fragmentShader:ki.linedashed_frag},depth:{uniforms:al([An.common,An.displacementmap]),vertexShader:ki.depth_vert,fragmentShader:ki.depth_frag},normal:{uniforms:al([An.common,An.bumpmap,An.normalmap,An.displacementmap,{opacity:{value:1}}]),vertexShader:ki.meshnormal_vert,fragmentShader:ki.meshnormal_frag},sprite:{uniforms:al([An.sprite,An.fog]),vertexShader:ki.sprite_vert,fragmentShader:ki.sprite_frag},background:{uniforms:{uvTransform:{value:new Ei},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ki.background_vert,fragmentShader:ki.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Ei}},vertexShader:ki.backgroundCube_vert,fragmentShader:ki.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ki.cube_vert,fragmentShader:ki.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ki.equirect_vert,fragmentShader:ki.equirect_frag},distance:{uniforms:al([An.common,An.displacementmap,{referencePosition:{value:new Ee},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ki.distance_vert,fragmentShader:ki.distance_frag},shadow:{uniforms:al([An.lights,An.fog,{color:{value:new fn(0)},opacity:{value:1}}]),vertexShader:ki.shadow_vert,fragmentShader:ki.shadow_frag}};Du.physical={uniforms:al([Du.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Ei},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Ei},clearcoatNormalScale:{value:new zt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Ei},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Ei},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Ei},sheen:{value:0},sheenColor:{value:new fn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Ei},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Ei},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Ei},transmissionSamplerSize:{value:new zt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Ei},attenuationDistance:{value:0},attenuationColor:{value:new fn(0)},specularColor:{value:new fn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Ei},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Ei},anisotropyVector:{value:new zt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Ei}}]),vertexShader:ki.meshphysical_vert,fragmentShader:ki.meshphysical_frag};const ix={r:0,b:0,g:0},ap=new Cc,bI=new ui;function _I(i,e,t,n,r,s,l){const c=new fn(0);let f=s===!0?0:1,d,m,g=null,y=0,v=null;function S(D){let I=D.isScene===!0?D.background:null;return I&&I.isTexture&&(I=(D.backgroundBlurriness>0?t:e).get(I)),I}function T(D){let I=!1;const z=S(D);z===null?w(c,f):z&&z.isColor&&(w(z,1),I=!0);const j=i.xr.getEnvironmentBlendMode();j==="additive"?n.buffers.color.setClear(0,0,0,1,l):j==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,l),(i.autoClear||I)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil))}function A(D,I){const z=S(I);z&&(z.isCubeTexture||z.mapping===b0)?(m===void 0&&(m=new js(new Dp(1,1,1),new fl({name:"BackgroundCubeMaterial",uniforms:h0(Du.backgroundCube.uniforms),vertexShader:Du.backgroundCube.vertexShader,fragmentShader:Du.backgroundCube.fragmentShader,side:cl,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),m.geometry.deleteAttribute("normal"),m.geometry.deleteAttribute("uv"),m.onBeforeRender=function(j,X,G){this.matrixWorld.copyPosition(G.matrixWorld)},Object.defineProperty(m.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(m)),ap.copy(I.backgroundRotation),ap.x*=-1,ap.y*=-1,ap.z*=-1,z.isCubeTexture&&z.isRenderTargetTexture===!1&&(ap.y*=-1,ap.z*=-1),m.material.uniforms.envMap.value=z,m.material.uniforms.flipEnvMap.value=z.isCubeTexture&&z.isRenderTargetTexture===!1?-1:1,m.material.uniforms.backgroundBlurriness.value=I.backgroundBlurriness,m.material.uniforms.backgroundIntensity.value=I.backgroundIntensity,m.material.uniforms.backgroundRotation.value.setFromMatrix4(bI.makeRotationFromEuler(ap)),m.material.toneMapped=nr.getTransfer(z.colorSpace)!==Ar,(g!==z||y!==z.version||v!==i.toneMapping)&&(m.material.needsUpdate=!0,g=z,y=z.version,v=i.toneMapping),m.layers.enableAll(),D.unshift(m,m.geometry,m.material,0,0,null)):z&&z.isTexture&&(d===void 0&&(d=new js(new _d(2,2),new fl({name:"BackgroundMaterial",uniforms:h0(Du.background.uniforms),vertexShader:Du.background.vertexShader,fragmentShader:Du.background.fragmentShader,side:_h,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),d.geometry.deleteAttribute("normal"),Object.defineProperty(d.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(d)),d.material.uniforms.t2D.value=z,d.material.uniforms.backgroundIntensity.value=I.backgroundIntensity,d.material.toneMapped=nr.getTransfer(z.colorSpace)!==Ar,z.matrixAutoUpdate===!0&&z.updateMatrix(),d.material.uniforms.uvTransform.value.copy(z.matrix),(g!==z||y!==z.version||v!==i.toneMapping)&&(d.material.needsUpdate=!0,g=z,y=z.version,v=i.toneMapping),d.layers.enableAll(),D.unshift(d,d.geometry,d.material,0,0,null))}function w(D,I){D.getRGB(ix,IT(i)),n.buffers.color.setClear(ix.r,ix.g,ix.b,I,l)}function R(){m!==void 0&&(m.geometry.dispose(),m.material.dispose(),m=void 0),d!==void 0&&(d.geometry.dispose(),d.material.dispose(),d=void 0)}return{getClearColor:function(){return c},setClearColor:function(D,I=1){c.set(D),f=I,w(c,f)},getClearAlpha:function(){return f},setClearAlpha:function(D){f=D,w(c,f)},render:T,addToRenderList:A,dispose:R}}function SI(i,e){const t=i.getParameter(i.MAX_VERTEX_ATTRIBS),n={},r=y(null);let s=r,l=!1;function c(k,U,q,W,J){let ce=!1;const K=g(W,q,U);s!==K&&(s=K,d(s.object)),ce=v(k,W,q,J),ce&&S(k,W,q,J),J!==null&&e.update(J,i.ELEMENT_ARRAY_BUFFER),(ce||l)&&(l=!1,I(k,U,q,W),J!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(J).buffer))}function f(){return i.createVertexArray()}function d(k){return i.bindVertexArray(k)}function m(k){return i.deleteVertexArray(k)}function g(k,U,q){const W=q.wireframe===!0;let J=n[k.id];J===void 0&&(J={},n[k.id]=J);let ce=J[U.id];ce===void 0&&(ce={},J[U.id]=ce);let K=ce[W];return K===void 0&&(K=y(f()),ce[W]=K),K}function y(k){const U=[],q=[],W=[];for(let J=0;J<t;J++)U[J]=0,q[J]=0,W[J]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:U,enabledAttributes:q,attributeDivisors:W,object:k,attributes:{},index:null}}function v(k,U,q,W){const J=s.attributes,ce=U.attributes;let K=0;const ne=q.getAttributes();for(const pe in ne)if(ne[pe].location>=0){const Te=J[pe];let ee=ce[pe];if(ee===void 0&&(pe==="instanceMatrix"&&k.instanceMatrix&&(ee=k.instanceMatrix),pe==="instanceColor"&&k.instanceColor&&(ee=k.instanceColor)),Te===void 0||Te.attribute!==ee||ee&&Te.data!==ee.data)return!0;K++}return s.attributesNum!==K||s.index!==W}function S(k,U,q,W){const J={},ce=U.attributes;let K=0;const ne=q.getAttributes();for(const pe in ne)if(ne[pe].location>=0){let Te=ce[pe];Te===void 0&&(pe==="instanceMatrix"&&k.instanceMatrix&&(Te=k.instanceMatrix),pe==="instanceColor"&&k.instanceColor&&(Te=k.instanceColor));const ee={};ee.attribute=Te,Te&&Te.data&&(ee.data=Te.data),J[pe]=ee,K++}s.attributes=J,s.attributesNum=K,s.index=W}function T(){const k=s.newAttributes;for(let U=0,q=k.length;U<q;U++)k[U]=0}function A(k){w(k,0)}function w(k,U){const q=s.newAttributes,W=s.enabledAttributes,J=s.attributeDivisors;q[k]=1,W[k]===0&&(i.enableVertexAttribArray(k),W[k]=1),J[k]!==U&&(i.vertexAttribDivisor(k,U),J[k]=U)}function R(){const k=s.newAttributes,U=s.enabledAttributes;for(let q=0,W=U.length;q<W;q++)U[q]!==k[q]&&(i.disableVertexAttribArray(q),U[q]=0)}function D(k,U,q,W,J,ce,K){K===!0?i.vertexAttribIPointer(k,U,q,J,ce):i.vertexAttribPointer(k,U,q,W,J,ce)}function I(k,U,q,W){T();const J=W.attributes,ce=q.getAttributes(),K=U.defaultAttributeValues;for(const ne in ce){const pe=ce[ne];if(pe.location>=0){let Re=J[ne];if(Re===void 0&&(ne==="instanceMatrix"&&k.instanceMatrix&&(Re=k.instanceMatrix),ne==="instanceColor"&&k.instanceColor&&(Re=k.instanceColor)),Re!==void 0){const Te=Re.normalized,ee=Re.itemSize,F=e.get(Re);if(F===void 0)continue;const $=F.buffer,re=F.type,Ae=F.bytesPerElement,ie=re===i.INT||re===i.UNSIGNED_INT||Re.gpuType===u1;if(Re.isInterleavedBufferAttribute){const _e=Re.data,ke=_e.stride,Fe=Re.offset;if(_e.isInstancedInterleavedBuffer){for(let We=0;We<pe.locationSize;We++)w(pe.location+We,_e.meshPerAttribute);k.isInstancedMesh!==!0&&W._maxInstanceCount===void 0&&(W._maxInstanceCount=_e.meshPerAttribute*_e.count)}else for(let We=0;We<pe.locationSize;We++)A(pe.location+We);i.bindBuffer(i.ARRAY_BUFFER,$);for(let We=0;We<pe.locationSize;We++)D(pe.location+We,ee/pe.locationSize,re,Te,ke*Ae,(Fe+ee/pe.locationSize*We)*Ae,ie)}else{if(Re.isInstancedBufferAttribute){for(let _e=0;_e<pe.locationSize;_e++)w(pe.location+_e,Re.meshPerAttribute);k.isInstancedMesh!==!0&&W._maxInstanceCount===void 0&&(W._maxInstanceCount=Re.meshPerAttribute*Re.count)}else for(let _e=0;_e<pe.locationSize;_e++)A(pe.location+_e);i.bindBuffer(i.ARRAY_BUFFER,$);for(let _e=0;_e<pe.locationSize;_e++)D(pe.location+_e,ee/pe.locationSize,re,Te,ee*Ae,ee/pe.locationSize*_e*Ae,ie)}}else if(K!==void 0){const Te=K[ne];if(Te!==void 0)switch(Te.length){case 2:i.vertexAttrib2fv(pe.location,Te);break;case 3:i.vertexAttrib3fv(pe.location,Te);break;case 4:i.vertexAttrib4fv(pe.location,Te);break;default:i.vertexAttrib1fv(pe.location,Te)}}}}R()}function z(){G();for(const k in n){const U=n[k];for(const q in U){const W=U[q];for(const J in W)m(W[J].object),delete W[J];delete U[q]}delete n[k]}}function j(k){if(n[k.id]===void 0)return;const U=n[k.id];for(const q in U){const W=U[q];for(const J in W)m(W[J].object),delete W[J];delete U[q]}delete n[k.id]}function X(k){for(const U in n){const q=n[U];if(q[k.id]===void 0)continue;const W=q[k.id];for(const J in W)m(W[J].object),delete W[J];delete q[k.id]}}function G(){L(),l=!0,s!==r&&(s=r,d(s.object))}function L(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:c,reset:G,resetDefaultState:L,dispose:z,releaseStatesOfGeometry:j,releaseStatesOfProgram:X,initAttributes:T,enableAttribute:A,disableUnusedAttributes:R}}function wI(i,e,t){let n;function r(d){n=d}function s(d,m){i.drawArrays(n,d,m),t.update(m,n,1)}function l(d,m,g){g!==0&&(i.drawArraysInstanced(n,d,m,g),t.update(m,n,g))}function c(d,m,g){if(g===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,d,0,m,0,g);let v=0;for(let S=0;S<g;S++)v+=m[S];t.update(v,n,1)}function f(d,m,g,y){if(g===0)return;const v=e.get("WEBGL_multi_draw");if(v===null)for(let S=0;S<d.length;S++)l(d[S],m[S],y[S]);else{v.multiDrawArraysInstancedWEBGL(n,d,0,m,0,y,0,g);let S=0;for(let T=0;T<g;T++)S+=m[T]*y[T];t.update(S,n,1)}}this.setMode=r,this.render=s,this.renderInstances=l,this.renderMultiDraw=c,this.renderMultiDrawInstances=f}function MI(i,e,t,n){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const X=e.get("EXT_texture_filter_anisotropic");r=i.getParameter(X.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function l(X){return!(X!==xa&&n.convert(X)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}function c(X){const G=X===Ks&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(X!==$a&&n.convert(X)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&X!==Cs&&!G)}function f(X){if(X==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";X="mediump"}return X==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let d=t.precision!==void 0?t.precision:"highp";const m=f(d);m!==d&&(Mn("WebGLRenderer:",d,"not supported, using",m,"instead."),d=m);const g=t.logarithmicDepthBuffer===!0,y=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),v=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),S=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),T=i.getParameter(i.MAX_TEXTURE_SIZE),A=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),w=i.getParameter(i.MAX_VERTEX_ATTRIBS),R=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),D=i.getParameter(i.MAX_VARYING_VECTORS),I=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),z=i.getParameter(i.MAX_SAMPLES),j=i.getParameter(i.SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:f,textureFormatReadable:l,textureTypeReadable:c,precision:d,logarithmicDepthBuffer:g,reversedDepthBuffer:y,maxTextures:v,maxVertexTextures:S,maxTextureSize:T,maxCubemapSize:A,maxAttributes:w,maxVertexUniforms:R,maxVaryings:D,maxFragmentUniforms:I,maxSamples:z,samples:j}}function AI(i){const e=this;let t=null,n=0,r=!1,s=!1;const l=new nu,c=new Ei,f={value:null,needsUpdate:!1};this.uniform=f,this.numPlanes=0,this.numIntersection=0,this.init=function(g,y){const v=g.length!==0||y||n!==0||r;return r=y,n=g.length,v},this.beginShadows=function(){s=!0,m(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(g,y){t=m(g,y,0)},this.setState=function(g,y,v){const S=g.clippingPlanes,T=g.clipIntersection,A=g.clipShadows,w=i.get(g);if(!r||S===null||S.length===0||s&&!A)s?m(null):d();else{const R=s?0:n,D=R*4;let I=w.clippingState||null;f.value=I,I=m(S,y,D,v);for(let z=0;z!==D;++z)I[z]=t[z];w.clippingState=I,this.numIntersection=T?this.numPlanes:0,this.numPlanes+=R}};function d(){f.value!==t&&(f.value=t,f.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function m(g,y,v,S){const T=g!==null?g.length:0;let A=null;if(T!==0){if(A=f.value,S!==!0||A===null){const w=v+T*4,R=y.matrixWorldInverse;c.getNormalMatrix(R),(A===null||A.length<w)&&(A=new Float32Array(w));for(let D=0,I=v;D!==T;++D,I+=4)l.copy(g[D]).applyMatrix4(R,c),l.normal.toArray(A,I),A[I+3]=l.constant}f.value=A,f.needsUpdate=!0}return e.numPlanes=T,e.numIntersection=0,A}}function TI(i){let e=new WeakMap;function t(l,c){return c===s0?l.mapping=Bu:c===Fg&&(l.mapping=md),l}function n(l){if(l&&l.isTexture){const c=l.mapping;if(c===s0||c===Fg)if(e.has(l)){const f=e.get(l).texture;return t(f,l.mapping)}else{const f=l.image;if(f&&f.height>0){const d=new Wy(f.height);return d.fromEquirectangularTexture(i,l),e.set(l,d),l.addEventListener("dispose",r),t(d.texture,l.mapping)}else return null}}return l}function r(l){const c=l.target;c.removeEventListener("dispose",r);const f=e.get(c);f!==void 0&&(e.delete(c),f.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}const ud=4,b3=[.125,.215,.35,.446,.526,.582],dp=20,EI=256,vg=new au,_3=new fn;let O5=null,B5=0,U5=0,F5=!1;const CI=new Ee;class z_{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,n=.1,r=100,s={}){const{size:l=256,position:c=CI}=s;O5=this._renderer.getRenderTarget(),B5=this._renderer.getActiveCubeFace(),U5=this._renderer.getActiveMipmapLevel(),F5=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(l);const f=this._allocateTargets();return f.depthBuffer=!0,this._sceneToCubeUV(e,n,r,f,c),t>0&&this._blur(f,0,0,t),this._applyPMREM(f),this._cleanup(f),f}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=M3(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=w3(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(O5,B5,U5),this._renderer.xr.enabled=F5,e.scissorTest=!1,km(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Bu||e.mapping===md?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),O5=this._renderer.getRenderTarget(),B5=this._renderer.getActiveCubeFace(),U5=this._renderer.getActiveMipmapLevel(),F5=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:ar,minFilter:ar,generateMipmaps:!1,type:Ks,format:xa,colorSpace:Uu,depthBuffer:!1},r=S3(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=S3(e,t,n);const{_lodMax:s}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=NI(s)),this._blurMaterial=LI(s,e,t),this._ggxMaterial=RI(s,e,t)}return r}_compileMaterial(e){const t=new js(new Si,e);this._renderer.compile(t,vg)}_sceneToCubeUV(e,t,n,r,s){const f=new Fs(90,1,t,n),d=[1,-1,1,1,1,1],m=[1,1,1,-1,-1,-1],g=this._renderer,y=g.autoClear,v=g.toneMapping;g.getClearColor(_3),g.toneMapping=ru,g.autoClear=!1,g.state.buffers.depth.getReversed()&&(g.setRenderTarget(r),g.clearDepth(),g.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new js(new Dp,new kf({name:"PMREM.Background",side:cl,depthWrite:!1,depthTest:!1})));const T=this._backgroundBox,A=T.material;let w=!1;const R=e.background;R?R.isColor&&(A.color.copy(R),e.background=null,w=!0):(A.color.copy(_3),w=!0);for(let D=0;D<6;D++){const I=D%3;I===0?(f.up.set(0,d[D],0),f.position.set(s.x,s.y,s.z),f.lookAt(s.x+m[D],s.y,s.z)):I===1?(f.up.set(0,0,d[D]),f.position.set(s.x,s.y,s.z),f.lookAt(s.x,s.y+m[D],s.z)):(f.up.set(0,d[D],0),f.position.set(s.x,s.y,s.z),f.lookAt(s.x,s.y,s.z+m[D]));const z=this._cubeSize;km(r,I*z,D>2?z:0,z,z),g.setRenderTarget(r),w&&g.render(T,f),g.render(e,f)}g.toneMapping=v,g.autoClear=y,e.background=R}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===Bu||e.mapping===md;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=M3()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=w3());const s=r?this._cubemapMaterial:this._equirectMaterial,l=this._lodMeshes[0];l.material=s;const c=s.uniforms;c.envMap.value=e;const f=this._cubeSize;km(t,0,0,3*f,2*f),n.setRenderTarget(t),n.render(l,vg)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodMeshes.length;for(let s=1;s<r;s++)this._applyGGXFilter(e,s-1,s);t.autoClear=n}_applyGGXFilter(e,t,n){const r=this._renderer,s=this._pingPongRenderTarget,l=this._ggxMaterial,c=this._lodMeshes[n];c.material=l;const f=l.uniforms,d=n/(this._lodMeshes.length-1),m=t/(this._lodMeshes.length-1),g=Math.sqrt(d*d-m*m),y=0+d*1.25,v=g*y,{_lodMax:S}=this,T=this._sizeLods[n],A=3*T*(n>S-ud?n-S+ud:0),w=4*(this._cubeSize-T);f.envMap.value=e.texture,f.roughness.value=v,f.mipInt.value=S-t,km(s,A,w,3*T,2*T),r.setRenderTarget(s),r.render(c,vg),f.envMap.value=s.texture,f.roughness.value=0,f.mipInt.value=S-n,km(e,A,w,3*T,2*T),r.setRenderTarget(e),r.render(c,vg)}_blur(e,t,n,r,s){const l=this._pingPongRenderTarget;this._halfBlur(e,l,t,n,r,"latitudinal",s),this._halfBlur(l,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,l,c){const f=this._renderer,d=this._blurMaterial;l!=="latitudinal"&&l!=="longitudinal"&&Hn("blur direction must be either latitudinal or longitudinal!");const m=3,g=this._lodMeshes[r];g.material=d;const y=d.uniforms,v=this._sizeLods[n]-1,S=isFinite(s)?Math.PI/(2*v):2*Math.PI/(2*dp-1),T=s/S,A=isFinite(s)?1+Math.floor(m*T):dp;A>dp&&Mn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${A} samples when the maximum is set to ${dp}`);const w=[];let R=0;for(let X=0;X<dp;++X){const G=X/T,L=Math.exp(-G*G/2);w.push(L),X===0?R+=L:X<A&&(R+=2*L)}for(let X=0;X<w.length;X++)w[X]=w[X]/R;y.envMap.value=e.texture,y.samples.value=A,y.weights.value=w,y.latitudinal.value=l==="latitudinal",c&&(y.poleAxis.value=c);const{_lodMax:D}=this;y.dTheta.value=S,y.mipInt.value=D-n;const I=this._sizeLods[r],z=3*I*(r>D-ud?r-D+ud:0),j=4*(this._cubeSize-I);km(t,z,j,3*I,2*I),f.setRenderTarget(t),f.render(g,vg)}}function NI(i){const e=[],t=[],n=[];let r=i;const s=i-ud+1+b3.length;for(let l=0;l<s;l++){const c=Math.pow(2,r);e.push(c);let f=1/c;l>i-ud?f=b3[l-i+ud-1]:l===0&&(f=0),t.push(f);const d=1/(c-2),m=-d,g=1+d,y=[m,m,g,m,g,g,m,m,g,g,m,g],v=6,S=6,T=3,A=2,w=1,R=new Float32Array(T*S*v),D=new Float32Array(A*S*v),I=new Float32Array(w*S*v);for(let j=0;j<v;j++){const X=j%3*2/3-1,G=j>2?0:-1,L=[X,G,0,X+2/3,G,0,X+2/3,G+1,0,X,G,0,X+2/3,G+1,0,X,G+1,0];R.set(L,T*S*j),D.set(y,A*S*j);const k=[j,j,j,j,j,j];I.set(k,w*S*j)}const z=new Si;z.setAttribute("position",new zr(R,T)),z.setAttribute("uv",new zr(D,A)),z.setAttribute("faceIndex",new zr(I,w)),n.push(new js(z,null)),r>ud&&r--}return{lodMeshes:n,sizeLods:e,sigmas:t}}function S3(i,e,t){const n=new ul(i,e,t);return n.texture.mapping=b0,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function km(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function RI(i,e,t){return new fl({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:EI,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:db(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 3.2: Transform view direction to hemisphere configuration
				vec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));

				// Section 4.1: Orthonormal basis
				float lensq = Vh.x * Vh.x + Vh.y * Vh.y;
				vec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(Vh, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + Vh.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:Ou,depthTest:!1,depthWrite:!1})}function LI(i,e,t){const n=new Float32Array(dp),r=new Ee(0,1,0);return new fl({name:"SphericalGaussianBlur",defines:{n:dp,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:db(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Ou,depthTest:!1,depthWrite:!1})}function w3(){return new fl({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:db(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Ou,depthTest:!1,depthWrite:!1})}function M3(){return new fl({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:db(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Ou,depthTest:!1,depthWrite:!1})}function db(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function PI(i){let e=new WeakMap,t=null;function n(c){if(c&&c.isTexture){const f=c.mapping,d=f===s0||f===Fg,m=f===Bu||f===md;if(d||m){let g=e.get(c);const y=g!==void 0?g.texture.pmremVersion:0;if(c.isRenderTargetTexture&&c.pmremVersion!==y)return t===null&&(t=new z_(i)),g=d?t.fromEquirectangular(c,g):t.fromCubemap(c,g),g.texture.pmremVersion=c.pmremVersion,e.set(c,g),g.texture;if(g!==void 0)return g.texture;{const v=c.image;return d&&v&&v.height>0||m&&v&&r(v)?(t===null&&(t=new z_(i)),g=d?t.fromEquirectangular(c):t.fromCubemap(c),g.texture.pmremVersion=c.pmremVersion,e.set(c,g),c.addEventListener("dispose",s),g.texture):null}}}return c}function r(c){let f=0;const d=6;for(let m=0;m<d;m++)c[m]!==void 0&&f++;return f===d}function s(c){const f=c.target;f.removeEventListener("dispose",s);const d=e.get(f);d!==void 0&&(e.delete(f),d.dispose())}function l(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:l}}function II(i){const e={};function t(n){if(e[n]!==void 0)return e[n];const r=i.getExtension(n);return e[n]=r,r}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const r=t(n);return r===null&&c0("WebGLRenderer: "+n+" extension not supported."),r}}}function DI(i,e,t,n){const r={},s=new WeakMap;function l(g){const y=g.target;y.index!==null&&e.remove(y.index);for(const S in y.attributes)e.remove(y.attributes[S]);y.removeEventListener("dispose",l),delete r[y.id];const v=s.get(y);v&&(e.remove(v),s.delete(y)),n.releaseStatesOfGeometry(y),y.isInstancedBufferGeometry===!0&&delete y._maxInstanceCount,t.memory.geometries--}function c(g,y){return r[y.id]===!0||(y.addEventListener("dispose",l),r[y.id]=!0,t.memory.geometries++),y}function f(g){const y=g.attributes;for(const v in y)e.update(y[v],i.ARRAY_BUFFER)}function d(g){const y=[],v=g.index,S=g.attributes.position;let T=0;if(v!==null){const R=v.array;T=v.version;for(let D=0,I=R.length;D<I;D+=3){const z=R[D+0],j=R[D+1],X=R[D+2];y.push(z,j,j,X,X,z)}}else if(S!==void 0){const R=S.array;T=S.version;for(let D=0,I=R.length/3-1;D<I;D+=3){const z=D+0,j=D+1,X=D+2;y.push(z,j,j,X,X,z)}}else return;const A=new(CT(y)?ES:TS)(y,1);A.version=T;const w=s.get(g);w&&e.remove(w),s.set(g,A)}function m(g){const y=s.get(g);if(y){const v=g.index;v!==null&&y.version<v.version&&d(g)}else d(g);return s.get(g)}return{get:c,update:f,getWireframeAttribute:m}}function kI(i,e,t){let n;function r(y){n=y}let s,l;function c(y){s=y.type,l=y.bytesPerElement}function f(y,v){i.drawElements(n,v,s,y*l),t.update(v,n,1)}function d(y,v,S){S!==0&&(i.drawElementsInstanced(n,v,s,y*l,S),t.update(v,n,S))}function m(y,v,S){if(S===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,v,0,s,y,0,S);let A=0;for(let w=0;w<S;w++)A+=v[w];t.update(A,n,1)}function g(y,v,S,T){if(S===0)return;const A=e.get("WEBGL_multi_draw");if(A===null)for(let w=0;w<y.length;w++)d(y[w]/l,v[w],T[w]);else{A.multiDrawElementsInstancedWEBGL(n,v,0,s,y,0,T,0,S);let w=0;for(let R=0;R<S;R++)w+=v[R]*T[R];t.update(w,n,1)}}this.setMode=r,this.setIndex=c,this.render=f,this.renderInstances=d,this.renderMultiDraw=m,this.renderMultiDrawInstances=g}function OI(i){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,l,c){switch(t.calls++,l){case i.TRIANGLES:t.triangles+=c*(s/3);break;case i.LINES:t.lines+=c*(s/2);break;case i.LINE_STRIP:t.lines+=c*(s-1);break;case i.LINE_LOOP:t.lines+=c*s;break;case i.POINTS:t.points+=c*s;break;default:Hn("WebGLInfo: Unknown draw mode:",l);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:n}}function BI(i,e,t){const n=new WeakMap,r=new Yr;function s(l,c,f){const d=l.morphTargetInfluences,m=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,g=m!==void 0?m.length:0;let y=n.get(c);if(y===void 0||y.count!==g){let L=function(){X.dispose(),n.delete(c),c.removeEventListener("dispose",L)};y!==void 0&&y.texture.dispose();const v=c.morphAttributes.position!==void 0,S=c.morphAttributes.normal!==void 0,T=c.morphAttributes.color!==void 0,A=c.morphAttributes.position||[],w=c.morphAttributes.normal||[],R=c.morphAttributes.color||[];let D=0;v===!0&&(D=1),S===!0&&(D=2),T===!0&&(D=3);let I=c.attributes.position.count*D,z=1;I>e.maxTextureSize&&(z=Math.ceil(I/e.maxTextureSize),I=e.maxTextureSize);const j=new Float32Array(I*z*4*g),X=new Hy(j,I,z,g);X.type=Cs,X.needsUpdate=!0;const G=D*4;for(let k=0;k<g;k++){const U=A[k],q=w[k],W=R[k],J=I*z*4*k;for(let ce=0;ce<U.count;ce++){const K=ce*G;v===!0&&(r.fromBufferAttribute(U,ce),j[J+K+0]=r.x,j[J+K+1]=r.y,j[J+K+2]=r.z,j[J+K+3]=0),S===!0&&(r.fromBufferAttribute(q,ce),j[J+K+4]=r.x,j[J+K+5]=r.y,j[J+K+6]=r.z,j[J+K+7]=0),T===!0&&(r.fromBufferAttribute(W,ce),j[J+K+8]=r.x,j[J+K+9]=r.y,j[J+K+10]=r.z,j[J+K+11]=W.itemSize===4?r.w:1)}}y={count:g,texture:X,size:new zt(I,z)},n.set(c,y),c.addEventListener("dispose",L)}if(l.isInstancedMesh===!0&&l.morphTexture!==null)f.getUniforms().setValue(i,"morphTexture",l.morphTexture,t);else{let v=0;for(let T=0;T<d.length;T++)v+=d[T];const S=c.morphTargetsRelative?1:1-v;f.getUniforms().setValue(i,"morphTargetBaseInfluence",S),f.getUniforms().setValue(i,"morphTargetInfluences",d)}f.getUniforms().setValue(i,"morphTargetsTexture",y.texture,t),f.getUniforms().setValue(i,"morphTargetsTextureSize",y.size)}return{update:s}}function UI(i,e,t,n){let r=new WeakMap;function s(f){const d=n.render.frame,m=f.geometry,g=e.get(f,m);if(r.get(g)!==d&&(e.update(g),r.set(g,d)),f.isInstancedMesh&&(f.hasEventListener("dispose",c)===!1&&f.addEventListener("dispose",c),r.get(f)!==d&&(t.update(f.instanceMatrix,i.ARRAY_BUFFER),f.instanceColor!==null&&t.update(f.instanceColor,i.ARRAY_BUFFER),r.set(f,d))),f.isSkinnedMesh){const y=f.skeleton;r.get(y)!==d&&(y.update(),r.set(y,d))}return g}function l(){r=new WeakMap}function c(f){const d=f.target;d.removeEventListener("dispose",c),t.remove(d.instanceMatrix),d.instanceColor!==null&&t.remove(d.instanceColor)}return{update:s,dispose:l}}const FI={[hS]:"LINEAR_TONE_MAPPING",[dS]:"REINHARD_TONE_MAPPING",[pS]:"CINEON_TONE_MAPPING",[Iy]:"ACES_FILMIC_TONE_MAPPING",[gS]:"AGX_TONE_MAPPING",[vS]:"NEUTRAL_TONE_MAPPING",[mS]:"CUSTOM_TONE_MAPPING"};function zI(i,e,t,n,r){const s=new ul(e,t,{type:i,depthBuffer:n,stencilBuffer:r}),l=new ul(e,t,{type:Ks,depthBuffer:!1,stencilBuffer:!1}),c=new Si;c.setAttribute("position",new kn([-1,3,0,-1,-1,0,3,-1,0],3)),c.setAttribute("uv",new kn([0,2,0,0,2,0],2));const f=new US({uniforms:{tDiffuse:{value:null}},vertexShader:`
			precision highp float;

			uniform mat4 modelViewMatrix;
			uniform mat4 projectionMatrix;

			attribute vec3 position;
			attribute vec2 uv;

			varying vec2 vUv;

			void main() {
				vUv = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}`,fragmentShader:`
			precision highp float;

			uniform sampler2D tDiffuse;

			varying vec2 vUv;

			#include <tonemapping_pars_fragment>
			#include <colorspace_pars_fragment>

			void main() {
				gl_FragColor = texture2D( tDiffuse, vUv );

				#ifdef LINEAR_TONE_MAPPING
					gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );
				#elif defined( REINHARD_TONE_MAPPING )
					gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );
				#elif defined( CINEON_TONE_MAPPING )
					gl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );
				#elif defined( ACES_FILMIC_TONE_MAPPING )
					gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );
				#elif defined( AGX_TONE_MAPPING )
					gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );
				#elif defined( NEUTRAL_TONE_MAPPING )
					gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );
				#elif defined( CUSTOM_TONE_MAPPING )
					gl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );
				#endif

				#ifdef SRGB_TRANSFER
					gl_FragColor = sRGBTransferOETF( gl_FragColor );
				#endif
			}`,depthTest:!1,depthWrite:!1}),d=new js(c,f),m=new au(-1,1,1,-1,0,1);let g=null,y=null,v=!1,S,T=null,A=[],w=!1;this.setSize=function(R,D){s.setSize(R,D),l.setSize(R,D);for(let I=0;I<A.length;I++){const z=A[I];z.setSize&&z.setSize(R,D)}},this.setEffects=function(R){A=R,w=A.length>0&&A[0].isRenderPass===!0;const D=s.width,I=s.height;for(let z=0;z<A.length;z++){const j=A[z];j.setSize&&j.setSize(D,I)}},this.begin=function(R,D){if(v||R.toneMapping===ru&&A.length===0)return!1;if(T=D,D!==null){const I=D.width,z=D.height;(s.width!==I||s.height!==z)&&this.setSize(I,z)}return w===!1&&R.setRenderTarget(s),S=R.toneMapping,R.toneMapping=ru,!0},this.hasRenderPass=function(){return w},this.end=function(R,D){R.toneMapping=S,v=!0;let I=s,z=l;for(let j=0;j<A.length;j++){const X=A[j];if(X.enabled!==!1&&(X.render(R,z,I,D),X.needsSwap!==!1)){const G=I;I=z,z=G}}if(g!==R.outputColorSpace||y!==R.toneMapping){g=R.outputColorSpace,y=R.toneMapping,f.defines={},nr.getTransfer(g)===Ar&&(f.defines.SRGB_TRANSFER="");const j=FI[y];j&&(f.defines[j]=""),f.needsUpdate=!0}f.uniforms.tDiffuse.value=I.texture,R.setRenderTarget(T),R.render(d,m),T=null,v=!1},this.isCompositing=function(){return v},this.dispose=function(){s.dispose(),l.dispose(),c.dispose(),f.dispose()}}const LE=new Fr,j_=new p0(1,1),PE=new Hy,IE=new Gy,DE=new d1,A3=[],T3=[],E3=new Float32Array(16),C3=new Float32Array(9),N3=new Float32Array(4);function w0(i,e,t){const n=i[0];if(n<=0||n>0)return i;const r=e*t;let s=A3[r];if(s===void 0&&(s=new Float32Array(r),A3[r]=s),e!==0){n.toArray(s,0);for(let l=1,c=0;l!==e;++l)c+=t,i[l].toArray(s,c)}return s}function Da(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function ka(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function pb(i,e){let t=T3[e];t===void 0&&(t=new Int32Array(e),T3[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function jI(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function VI(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Da(t,e))return;i.uniform2fv(this.addr,e),ka(t,e)}}function HI(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Da(t,e))return;i.uniform3fv(this.addr,e),ka(t,e)}}function GI(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Da(t,e))return;i.uniform4fv(this.addr,e),ka(t,e)}}function qI(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Da(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),ka(t,e)}else{if(Da(t,n))return;N3.set(n),i.uniformMatrix2fv(this.addr,!1,N3),ka(t,n)}}function WI(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Da(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),ka(t,e)}else{if(Da(t,n))return;C3.set(n),i.uniformMatrix3fv(this.addr,!1,C3),ka(t,n)}}function XI(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Da(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),ka(t,e)}else{if(Da(t,n))return;E3.set(n),i.uniformMatrix4fv(this.addr,!1,E3),ka(t,n)}}function YI(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function ZI(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Da(t,e))return;i.uniform2iv(this.addr,e),ka(t,e)}}function $I(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Da(t,e))return;i.uniform3iv(this.addr,e),ka(t,e)}}function JI(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Da(t,e))return;i.uniform4iv(this.addr,e),ka(t,e)}}function KI(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function QI(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Da(t,e))return;i.uniform2uiv(this.addr,e),ka(t,e)}}function eD(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Da(t,e))return;i.uniform3uiv(this.addr,e),ka(t,e)}}function tD(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Da(t,e))return;i.uniform4uiv(this.addr,e),ka(t,e)}}function nD(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r);let s;this.type===i.SAMPLER_2D_SHADOW?(j_.compareFunction=t.isReversedDepthBuffer()?Vy:jy,s=j_):s=LE,t.setTexture2D(e||s,r)}function iD(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||IE,r)}function rD(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||DE,r)}function sD(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||PE,r)}function aD(i){switch(i){case 5126:return jI;case 35664:return VI;case 35665:return HI;case 35666:return GI;case 35674:return qI;case 35675:return WI;case 35676:return XI;case 5124:case 35670:return YI;case 35667:case 35671:return ZI;case 35668:case 35672:return $I;case 35669:case 35673:return JI;case 5125:return KI;case 36294:return QI;case 36295:return eD;case 36296:return tD;case 35678:case 36198:case 36298:case 36306:case 35682:return nD;case 35679:case 36299:case 36307:return iD;case 35680:case 36300:case 36308:case 36293:return rD;case 36289:case 36303:case 36311:case 36292:return sD}}function oD(i,e){i.uniform1fv(this.addr,e)}function lD(i,e){const t=w0(e,this.size,2);i.uniform2fv(this.addr,t)}function cD(i,e){const t=w0(e,this.size,3);i.uniform3fv(this.addr,t)}function uD(i,e){const t=w0(e,this.size,4);i.uniform4fv(this.addr,t)}function fD(i,e){const t=w0(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function hD(i,e){const t=w0(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function dD(i,e){const t=w0(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function pD(i,e){i.uniform1iv(this.addr,e)}function mD(i,e){i.uniform2iv(this.addr,e)}function gD(i,e){i.uniform3iv(this.addr,e)}function vD(i,e){i.uniform4iv(this.addr,e)}function xD(i,e){i.uniform1uiv(this.addr,e)}function yD(i,e){i.uniform2uiv(this.addr,e)}function bD(i,e){i.uniform3uiv(this.addr,e)}function _D(i,e){i.uniform4uiv(this.addr,e)}function SD(i,e,t){const n=this.cache,r=e.length,s=pb(t,r);Da(n,s)||(i.uniform1iv(this.addr,s),ka(n,s));let l;this.type===i.SAMPLER_2D_SHADOW?l=j_:l=LE;for(let c=0;c!==r;++c)t.setTexture2D(e[c]||l,s[c])}function wD(i,e,t){const n=this.cache,r=e.length,s=pb(t,r);Da(n,s)||(i.uniform1iv(this.addr,s),ka(n,s));for(let l=0;l!==r;++l)t.setTexture3D(e[l]||IE,s[l])}function MD(i,e,t){const n=this.cache,r=e.length,s=pb(t,r);Da(n,s)||(i.uniform1iv(this.addr,s),ka(n,s));for(let l=0;l!==r;++l)t.setTextureCube(e[l]||DE,s[l])}function AD(i,e,t){const n=this.cache,r=e.length,s=pb(t,r);Da(n,s)||(i.uniform1iv(this.addr,s),ka(n,s));for(let l=0;l!==r;++l)t.setTexture2DArray(e[l]||PE,s[l])}function TD(i){switch(i){case 5126:return oD;case 35664:return lD;case 35665:return cD;case 35666:return uD;case 35674:return fD;case 35675:return hD;case 35676:return dD;case 5124:case 35670:return pD;case 35667:case 35671:return mD;case 35668:case 35672:return gD;case 35669:case 35673:return vD;case 5125:return xD;case 36294:return yD;case 36295:return bD;case 36296:return _D;case 35678:case 36198:case 36298:case 36306:case 35682:return SD;case 35679:case 36299:case 36307:return wD;case 35680:case 36300:case 36308:case 36293:return MD;case 36289:case 36303:case 36311:case 36292:return AD}}class ED{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=aD(t.type)}}class CD{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=TD(t.type)}}class ND{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let s=0,l=r.length;s!==l;++s){const c=r[s];c.setValue(e,t[c.id],n)}}}const z5=/(\w+)(\])?(\[|\.)?/g;function R3(i,e){i.seq.push(e),i.map[e.id]=e}function RD(i,e,t){const n=i.name,r=n.length;for(z5.lastIndex=0;;){const s=z5.exec(n),l=z5.lastIndex;let c=s[1];const f=s[2]==="]",d=s[3];if(f&&(c=c|0),d===void 0||d==="["&&l+2===r){R3(t,d===void 0?new ED(c,i,e):new CD(c,i,e));break}else{let g=t.map[c];g===void 0&&(g=new ND(c),R3(t,g)),t=g}}}class _x{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let l=0;l<n;++l){const c=e.getActiveUniform(t,l),f=e.getUniformLocation(t,c.name);RD(c,f,this)}const r=[],s=[];for(const l of this.seq)l.type===e.SAMPLER_2D_SHADOW||l.type===e.SAMPLER_CUBE_SHADOW||l.type===e.SAMPLER_2D_ARRAY_SHADOW?r.push(l):s.push(l);r.length>0&&(this.seq=r.concat(s))}setValue(e,t,n,r){const s=this.map[t];s!==void 0&&s.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,l=t.length;s!==l;++s){const c=t[s],f=n[c.id];f.needsUpdate!==!1&&c.setValue(e,f.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,s=e.length;r!==s;++r){const l=e[r];l.id in t&&n.push(l)}return n}}function L3(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}const LD=37297;let PD=0;function ID(i,e){const t=i.split(`
`),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let l=r;l<s;l++){const c=l+1;n.push(`${c===e?">":" "} ${c}: ${t[l]}`)}return n.join(`
`)}const P3=new Ei;function DD(i){nr._getMatrix(P3,nr.workingColorSpace,i);const e=`mat3( ${P3.elements.map(t=>t.toFixed(4))} )`;switch(nr.getTransfer(i)){case Gg:return[e,"LinearTransferOETF"];case Ar:return[e,"sRGBTransferOETF"];default:return Mn("WebGLProgram: Unsupported color space: ",i),[e,"LinearTransferOETF"]}}function I3(i,e,t){const n=i.getShaderParameter(e,i.COMPILE_STATUS),s=(i.getShaderInfoLog(e)||"").trim();if(n&&s==="")return"";const l=/ERROR: 0:(\d+)/.exec(s);if(l){const c=parseInt(l[1]);return t.toUpperCase()+`

`+s+`

`+ID(i.getShaderSource(e),c)}else return s}function kD(i,e){const t=DD(e);return[`vec4 ${i}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}const OD={[hS]:"Linear",[dS]:"Reinhard",[pS]:"Cineon",[Iy]:"ACESFilmic",[gS]:"AgX",[vS]:"Neutral",[mS]:"Custom"};function BD(i,e){const t=OD[e];return t===void 0?(Mn("WebGLProgram: Unsupported toneMapping:",e),"vec3 "+i+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const rx=new Ee;function UD(){nr.getLuminanceCoefficients(rx);const i=rx.x.toFixed(4),e=rx.y.toFixed(4),t=rx.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${i}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function FD(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Ag).join(`
`)}function zD(i){const e=[];for(const t in i){const n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function jD(i,e){const t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const s=i.getActiveAttrib(e,r),l=s.name;let c=1;s.type===i.FLOAT_MAT2&&(c=2),s.type===i.FLOAT_MAT3&&(c=3),s.type===i.FLOAT_MAT4&&(c=4),t[l]={type:s.type,location:i.getAttribLocation(e,l),locationSize:c}}return t}function Ag(i){return i!==""}function D3(i,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function k3(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const VD=/^[ \t]*#include +<([\w\d./]+)>/gm;function V_(i){return i.replace(VD,GD)}const HD=new Map;function GD(i,e){let t=ki[e];if(t===void 0){const n=HD.get(e);if(n!==void 0)t=ki[n],Mn('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return V_(t)}const qD=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function O3(i){return i.replace(qD,WD)}function WD(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function B3(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	precision ${i.precision} sampler3D;
	precision ${i.precision} sampler2DArray;
	precision ${i.precision} sampler2DShadow;
	precision ${i.precision} samplerCubeShadow;
	precision ${i.precision} sampler2DArrayShadow;
	precision ${i.precision} isampler2D;
	precision ${i.precision} isampler3D;
	precision ${i.precision} isamplerCube;
	precision ${i.precision} isampler2DArray;
	precision ${i.precision} usampler2D;
	precision ${i.precision} usampler3D;
	precision ${i.precision} usamplerCube;
	precision ${i.precision} usampler2DArray;
	`;return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}const XD={[Jm]:"SHADOWMAP_TYPE_PCF",[mp]:"SHADOWMAP_TYPE_VSM"};function YD(i){return XD[i.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}const ZD={[Bu]:"ENVMAP_TYPE_CUBE",[md]:"ENVMAP_TYPE_CUBE",[b0]:"ENVMAP_TYPE_CUBE_UV"};function $D(i){return i.envMap===!1?"ENVMAP_TYPE_CUBE":ZD[i.envMapMode]||"ENVMAP_TYPE_CUBE"}const JD={[md]:"ENVMAP_MODE_REFRACTION"};function KD(i){return i.envMap===!1?"ENVMAP_MODE_REFLECTION":JD[i.envMapMode]||"ENVMAP_MODE_REFLECTION"}const QD={[c1]:"ENVMAP_BLENDING_MULTIPLY",[pT]:"ENVMAP_BLENDING_MIX",[mT]:"ENVMAP_BLENDING_ADD"};function ek(i){return i.envMap===!1?"ENVMAP_BLENDING_NONE":QD[i.combine]||"ENVMAP_BLENDING_NONE"}function tk(i){const e=i.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}function nk(i,e,t,n){const r=i.getContext(),s=t.defines;let l=t.vertexShader,c=t.fragmentShader;const f=YD(t),d=$D(t),m=KD(t),g=ek(t),y=tk(t),v=FD(t),S=zD(s),T=r.createProgram();let A,w,R=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(A=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S].filter(Ag).join(`
`),A.length>0&&(A+=`
`),w=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S].filter(Ag).join(`
`),w.length>0&&(w+=`
`)):(A=[B3(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+f:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Ag).join(`
`),w=[B3(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.envMap?"#define "+m:"",t.envMap?"#define "+g:"",y?"#define CUBEUV_TEXEL_WIDTH "+y.texelWidth:"",y?"#define CUBEUV_TEXEL_HEIGHT "+y.texelHeight:"",y?"#define CUBEUV_MAX_MIP "+y.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+f:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==ru?"#define TONE_MAPPING":"",t.toneMapping!==ru?ki.tonemapping_pars_fragment:"",t.toneMapping!==ru?BD("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",ki.colorspace_pars_fragment,kD("linearToOutputTexel",t.outputColorSpace),UD(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Ag).join(`
`)),l=V_(l),l=D3(l,t),l=k3(l,t),c=V_(c),c=D3(c,t),c=k3(c,t),l=O3(l),c=O3(c),t.isRawShaderMaterial!==!0&&(R=`#version 300 es
`,A=[v,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+A,w=["#define varying in",t.glslVersion===L_?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===L_?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+w);const D=R+A+l,I=R+w+c,z=L3(r,r.VERTEX_SHADER,D),j=L3(r,r.FRAGMENT_SHADER,I);r.attachShader(T,z),r.attachShader(T,j),t.index0AttributeName!==void 0?r.bindAttribLocation(T,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(T,0,"position"),r.linkProgram(T);function X(U){if(i.debug.checkShaderErrors){const q=r.getProgramInfoLog(T)||"",W=r.getShaderInfoLog(z)||"",J=r.getShaderInfoLog(j)||"",ce=q.trim(),K=W.trim(),ne=J.trim();let pe=!0,Re=!0;if(r.getProgramParameter(T,r.LINK_STATUS)===!1)if(pe=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(r,T,z,j);else{const Te=I3(r,z,"vertex"),ee=I3(r,j,"fragment");Hn("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(T,r.VALIDATE_STATUS)+`

Material Name: `+U.name+`
Material Type: `+U.type+`

Program Info Log: `+ce+`
`+Te+`
`+ee)}else ce!==""?Mn("WebGLProgram: Program Info Log:",ce):(K===""||ne==="")&&(Re=!1);Re&&(U.diagnostics={runnable:pe,programLog:ce,vertexShader:{log:K,prefix:A},fragmentShader:{log:ne,prefix:w}})}r.deleteShader(z),r.deleteShader(j),G=new _x(r,T),L=jD(r,T)}let G;this.getUniforms=function(){return G===void 0&&X(this),G};let L;this.getAttributes=function(){return L===void 0&&X(this),L};let k=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return k===!1&&(k=r.getProgramParameter(T,LD)),k},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(T),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=PD++,this.cacheKey=e,this.usedTimes=1,this.program=T,this.vertexShader=z,this.fragmentShader=j,this}let ik=0;class rk{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(n),l=this._getShaderCacheForMaterial(e);return l.has(r)===!1&&(l.add(r),r.usedTimes++),l.has(s)===!1&&(l.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new sk(e),t.set(e,n)),n}}class sk{constructor(e){this.id=ik++,this.code=e,this.usedTimes=0}}function ak(i,e,t,n,r,s,l){const c=new f0,f=new rk,d=new Set,m=[],g=new Map,y=r.logarithmicDepthBuffer;let v=r.precision;const S={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function T(L){return d.add(L),L===0?"uv":`uv${L}`}function A(L,k,U,q,W){const J=q.fog,ce=W.geometry,K=L.isMeshStandardMaterial?q.environment:null,ne=(L.isMeshStandardMaterial?t:e).get(L.envMap||K),pe=ne&&ne.mapping===b0?ne.image.height:null,Re=S[L.type];L.precision!==null&&(v=r.getMaxPrecision(L.precision),v!==L.precision&&Mn("WebGLProgram.getParameters:",L.precision,"not supported, using",v,"instead."));const Te=ce.morphAttributes.position||ce.morphAttributes.normal||ce.morphAttributes.color,ee=Te!==void 0?Te.length:0;let F=0;ce.morphAttributes.position!==void 0&&(F=1),ce.morphAttributes.normal!==void 0&&(F=2),ce.morphAttributes.color!==void 0&&(F=3);let $,re,Ae,ie;if(Re){const dn=Du[Re];$=dn.vertexShader,re=dn.fragmentShader}else $=L.vertexShader,re=L.fragmentShader,f.update(L),Ae=f.getVertexShaderID(L),ie=f.getFragmentShaderID(L);const _e=i.getRenderTarget(),ke=i.state.buffers.depth.getReversed(),Fe=W.isInstancedMesh===!0,We=W.isBatchedMesh===!0,nt=!!L.map,It=!!L.matcap,wt=!!ne,Je=!!L.aoMap,le=!!L.lightMap,Qe=!!L.bumpMap,Et=!!L.normalMap,we=!!L.displacementMap,ot=!!L.emissiveMap,Ct=!!L.metalnessMap,ht=!!L.roughnessMap,xt=L.anisotropy>0,he=L.clearcoat>0,Q=L.dispersion>0,Be=L.iridescence>0,ue=L.sheen>0,je=L.transmission>0,Ye=xt&&!!L.anisotropyMap,ft=he&&!!L.clearcoatMap,gt=he&&!!L.clearcoatNormalMap,Lt=he&&!!L.clearcoatRoughnessMap,un=Be&&!!L.iridescenceMap,bt=Be&&!!L.iridescenceThicknessMap,dt=ue&&!!L.sheenColorMap,Ge=ue&&!!L.sheenRoughnessMap,xe=!!L.specularMap,Pe=!!L.specularColorMap,rt=!!L.specularIntensityMap,Me=je&&!!L.transmissionMap,ze=je&&!!L.thicknessMap,Mt=!!L.gradientMap,Rt=!!L.alphaMap,se=L.alphaTest>0,Ve=!!L.alphaHash,vt=!!L.extensions;let Dt=ru;L.toneMapped&&(_e===null||_e.isXRRenderTarget===!0)&&(Dt=i.toneMapping);const bn={shaderID:Re,shaderType:L.type,shaderName:L.name,vertexShader:$,fragmentShader:re,defines:L.defines,customVertexShaderID:Ae,customFragmentShaderID:ie,isRawShaderMaterial:L.isRawShaderMaterial===!0,glslVersion:L.glslVersion,precision:v,batching:We,batchingColor:We&&W._colorsTexture!==null,instancing:Fe,instancingColor:Fe&&W.instanceColor!==null,instancingMorph:Fe&&W.morphTexture!==null,outputColorSpace:_e===null?i.outputColorSpace:_e.isXRRenderTarget===!0?_e.texture.colorSpace:Uu,alphaToCoverage:!!L.alphaToCoverage,map:nt,matcap:It,envMap:wt,envMapMode:wt&&ne.mapping,envMapCubeUVHeight:pe,aoMap:Je,lightMap:le,bumpMap:Qe,normalMap:Et,displacementMap:we,emissiveMap:ot,normalMapObjectSpace:Et&&L.normalMapType===_T,normalMapTangentSpace:Et&&L.normalMapType===yd,metalnessMap:Ct,roughnessMap:ht,anisotropy:xt,anisotropyMap:Ye,clearcoat:he,clearcoatMap:ft,clearcoatNormalMap:gt,clearcoatRoughnessMap:Lt,dispersion:Q,iridescence:Be,iridescenceMap:un,iridescenceThicknessMap:bt,sheen:ue,sheenColorMap:dt,sheenRoughnessMap:Ge,specularMap:xe,specularColorMap:Pe,specularIntensityMap:rt,transmission:je,transmissionMap:Me,thicknessMap:ze,gradientMap:Mt,opaque:L.transparent===!1&&L.blending===Sp&&L.alphaToCoverage===!1,alphaMap:Rt,alphaTest:se,alphaHash:Ve,combine:L.combine,mapUv:nt&&T(L.map.channel),aoMapUv:Je&&T(L.aoMap.channel),lightMapUv:le&&T(L.lightMap.channel),bumpMapUv:Qe&&T(L.bumpMap.channel),normalMapUv:Et&&T(L.normalMap.channel),displacementMapUv:we&&T(L.displacementMap.channel),emissiveMapUv:ot&&T(L.emissiveMap.channel),metalnessMapUv:Ct&&T(L.metalnessMap.channel),roughnessMapUv:ht&&T(L.roughnessMap.channel),anisotropyMapUv:Ye&&T(L.anisotropyMap.channel),clearcoatMapUv:ft&&T(L.clearcoatMap.channel),clearcoatNormalMapUv:gt&&T(L.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Lt&&T(L.clearcoatRoughnessMap.channel),iridescenceMapUv:un&&T(L.iridescenceMap.channel),iridescenceThicknessMapUv:bt&&T(L.iridescenceThicknessMap.channel),sheenColorMapUv:dt&&T(L.sheenColorMap.channel),sheenRoughnessMapUv:Ge&&T(L.sheenRoughnessMap.channel),specularMapUv:xe&&T(L.specularMap.channel),specularColorMapUv:Pe&&T(L.specularColorMap.channel),specularIntensityMapUv:rt&&T(L.specularIntensityMap.channel),transmissionMapUv:Me&&T(L.transmissionMap.channel),thicknessMapUv:ze&&T(L.thicknessMap.channel),alphaMapUv:Rt&&T(L.alphaMap.channel),vertexTangents:!!ce.attributes.tangent&&(Et||xt),vertexColors:L.vertexColors,vertexAlphas:L.vertexColors===!0&&!!ce.attributes.color&&ce.attributes.color.itemSize===4,pointsUvs:W.isPoints===!0&&!!ce.attributes.uv&&(nt||Rt),fog:!!J,useFog:L.fog===!0,fogExp2:!!J&&J.isFogExp2,flatShading:L.flatShading===!0&&L.wireframe===!1,sizeAttenuation:L.sizeAttenuation===!0,logarithmicDepthBuffer:y,reversedDepthBuffer:ke,skinning:W.isSkinnedMesh===!0,morphTargets:ce.morphAttributes.position!==void 0,morphNormals:ce.morphAttributes.normal!==void 0,morphColors:ce.morphAttributes.color!==void 0,morphTargetsCount:ee,morphTextureStride:F,numDirLights:k.directional.length,numPointLights:k.point.length,numSpotLights:k.spot.length,numSpotLightMaps:k.spotLightMap.length,numRectAreaLights:k.rectArea.length,numHemiLights:k.hemi.length,numDirLightShadows:k.directionalShadowMap.length,numPointLightShadows:k.pointShadowMap.length,numSpotLightShadows:k.spotShadowMap.length,numSpotLightShadowsWithMaps:k.numSpotLightShadowsWithMaps,numLightProbes:k.numLightProbes,numClippingPlanes:l.numPlanes,numClipIntersection:l.numIntersection,dithering:L.dithering,shadowMapEnabled:i.shadowMap.enabled&&U.length>0,shadowMapType:i.shadowMap.type,toneMapping:Dt,decodeVideoTexture:nt&&L.map.isVideoTexture===!0&&nr.getTransfer(L.map.colorSpace)===Ar,decodeVideoTextureEmissive:ot&&L.emissiveMap.isVideoTexture===!0&&nr.getTransfer(L.emissiveMap.colorSpace)===Ar,premultipliedAlpha:L.premultipliedAlpha,doubleSided:L.side===Es,flipSided:L.side===cl,useDepthPacking:L.depthPacking>=0,depthPacking:L.depthPacking||0,index0AttributeName:L.index0AttributeName,extensionClipCullDistance:vt&&L.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(vt&&L.extensions.multiDraw===!0||We)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:L.customProgramCacheKey()};return bn.vertexUv1s=d.has(1),bn.vertexUv2s=d.has(2),bn.vertexUv3s=d.has(3),d.clear(),bn}function w(L){const k=[];if(L.shaderID?k.push(L.shaderID):(k.push(L.customVertexShaderID),k.push(L.customFragmentShaderID)),L.defines!==void 0)for(const U in L.defines)k.push(U),k.push(L.defines[U]);return L.isRawShaderMaterial===!1&&(R(k,L),D(k,L),k.push(i.outputColorSpace)),k.push(L.customProgramCacheKey),k.join()}function R(L,k){L.push(k.precision),L.push(k.outputColorSpace),L.push(k.envMapMode),L.push(k.envMapCubeUVHeight),L.push(k.mapUv),L.push(k.alphaMapUv),L.push(k.lightMapUv),L.push(k.aoMapUv),L.push(k.bumpMapUv),L.push(k.normalMapUv),L.push(k.displacementMapUv),L.push(k.emissiveMapUv),L.push(k.metalnessMapUv),L.push(k.roughnessMapUv),L.push(k.anisotropyMapUv),L.push(k.clearcoatMapUv),L.push(k.clearcoatNormalMapUv),L.push(k.clearcoatRoughnessMapUv),L.push(k.iridescenceMapUv),L.push(k.iridescenceThicknessMapUv),L.push(k.sheenColorMapUv),L.push(k.sheenRoughnessMapUv),L.push(k.specularMapUv),L.push(k.specularColorMapUv),L.push(k.specularIntensityMapUv),L.push(k.transmissionMapUv),L.push(k.thicknessMapUv),L.push(k.combine),L.push(k.fogExp2),L.push(k.sizeAttenuation),L.push(k.morphTargetsCount),L.push(k.morphAttributeCount),L.push(k.numDirLights),L.push(k.numPointLights),L.push(k.numSpotLights),L.push(k.numSpotLightMaps),L.push(k.numHemiLights),L.push(k.numRectAreaLights),L.push(k.numDirLightShadows),L.push(k.numPointLightShadows),L.push(k.numSpotLightShadows),L.push(k.numSpotLightShadowsWithMaps),L.push(k.numLightProbes),L.push(k.shadowMapType),L.push(k.toneMapping),L.push(k.numClippingPlanes),L.push(k.numClipIntersection),L.push(k.depthPacking)}function D(L,k){c.disableAll(),k.instancing&&c.enable(0),k.instancingColor&&c.enable(1),k.instancingMorph&&c.enable(2),k.matcap&&c.enable(3),k.envMap&&c.enable(4),k.normalMapObjectSpace&&c.enable(5),k.normalMapTangentSpace&&c.enable(6),k.clearcoat&&c.enable(7),k.iridescence&&c.enable(8),k.alphaTest&&c.enable(9),k.vertexColors&&c.enable(10),k.vertexAlphas&&c.enable(11),k.vertexUv1s&&c.enable(12),k.vertexUv2s&&c.enable(13),k.vertexUv3s&&c.enable(14),k.vertexTangents&&c.enable(15),k.anisotropy&&c.enable(16),k.alphaHash&&c.enable(17),k.batching&&c.enable(18),k.dispersion&&c.enable(19),k.batchingColor&&c.enable(20),k.gradientMap&&c.enable(21),L.push(c.mask),c.disableAll(),k.fog&&c.enable(0),k.useFog&&c.enable(1),k.flatShading&&c.enable(2),k.logarithmicDepthBuffer&&c.enable(3),k.reversedDepthBuffer&&c.enable(4),k.skinning&&c.enable(5),k.morphTargets&&c.enable(6),k.morphNormals&&c.enable(7),k.morphColors&&c.enable(8),k.premultipliedAlpha&&c.enable(9),k.shadowMapEnabled&&c.enable(10),k.doubleSided&&c.enable(11),k.flipSided&&c.enable(12),k.useDepthPacking&&c.enable(13),k.dithering&&c.enable(14),k.transmission&&c.enable(15),k.sheen&&c.enable(16),k.opaque&&c.enable(17),k.pointsUvs&&c.enable(18),k.decodeVideoTexture&&c.enable(19),k.decodeVideoTextureEmissive&&c.enable(20),k.alphaToCoverage&&c.enable(21),L.push(c.mask)}function I(L){const k=S[L.type];let U;if(k){const q=Du[k];U=DT.clone(q.uniforms)}else U=L.uniforms;return U}function z(L,k){let U=g.get(k);return U!==void 0?++U.usedTimes:(U=new nk(i,k,L,s),m.push(U),g.set(k,U)),U}function j(L){if(--L.usedTimes===0){const k=m.indexOf(L);m[k]=m[m.length-1],m.pop(),g.delete(L.cacheKey),L.destroy()}}function X(L){f.remove(L)}function G(){f.dispose()}return{getParameters:A,getProgramCacheKey:w,getUniforms:I,acquireProgram:z,releaseProgram:j,releaseShaderCache:X,programs:m,dispose:G}}function ok(){let i=new WeakMap;function e(l){return i.has(l)}function t(l){let c=i.get(l);return c===void 0&&(c={},i.set(l,c)),c}function n(l){i.delete(l)}function r(l,c,f){i.get(l)[c]=f}function s(){i=new WeakMap}return{has:e,get:t,remove:n,update:r,dispose:s}}function lk(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function U3(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function F3(){const i=[];let e=0;const t=[],n=[],r=[];function s(){e=0,t.length=0,n.length=0,r.length=0}function l(g,y,v,S,T,A){let w=i[e];return w===void 0?(w={id:g.id,object:g,geometry:y,material:v,groupOrder:S,renderOrder:g.renderOrder,z:T,group:A},i[e]=w):(w.id=g.id,w.object=g,w.geometry=y,w.material=v,w.groupOrder=S,w.renderOrder=g.renderOrder,w.z=T,w.group=A),e++,w}function c(g,y,v,S,T,A){const w=l(g,y,v,S,T,A);v.transmission>0?n.push(w):v.transparent===!0?r.push(w):t.push(w)}function f(g,y,v,S,T,A){const w=l(g,y,v,S,T,A);v.transmission>0?n.unshift(w):v.transparent===!0?r.unshift(w):t.unshift(w)}function d(g,y){t.length>1&&t.sort(g||lk),n.length>1&&n.sort(y||U3),r.length>1&&r.sort(y||U3)}function m(){for(let g=e,y=i.length;g<y;g++){const v=i[g];if(v.id===null)break;v.id=null,v.object=null,v.geometry=null,v.material=null,v.group=null}}return{opaque:t,transmissive:n,transparent:r,init:s,push:c,unshift:f,finish:m,sort:d}}function ck(){let i=new WeakMap;function e(n,r){const s=i.get(n);let l;return s===void 0?(l=new F3,i.set(n,[l])):r>=s.length?(l=new F3,s.push(l)):l=s[r],l}function t(){i=new WeakMap}return{get:e,dispose:t}}function uk(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Ee,color:new fn};break;case"SpotLight":t={position:new Ee,direction:new Ee,color:new fn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Ee,color:new fn,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Ee,skyColor:new fn,groundColor:new fn};break;case"RectAreaLight":t={color:new fn,position:new Ee,halfWidth:new Ee,halfHeight:new Ee};break}return i[e.id]=t,t}}}function fk(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new zt};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new zt};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new zt,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}let hk=0;function dk(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function pk(i){const e=new uk,t=fk(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let d=0;d<9;d++)n.probe.push(new Ee);const r=new Ee,s=new ui,l=new ui;function c(d){let m=0,g=0,y=0;for(let L=0;L<9;L++)n.probe[L].set(0,0,0);let v=0,S=0,T=0,A=0,w=0,R=0,D=0,I=0,z=0,j=0,X=0;d.sort(dk);for(let L=0,k=d.length;L<k;L++){const U=d[L],q=U.color,W=U.intensity,J=U.distance;let ce=null;if(U.shadow&&U.shadow.map&&(U.shadow.map.texture.format===Ep?ce=U.shadow.map.texture:ce=U.shadow.map.depthTexture||U.shadow.map.texture),U.isAmbientLight)m+=q.r*W,g+=q.g*W,y+=q.b*W;else if(U.isLightProbe){for(let K=0;K<9;K++)n.probe[K].addScaledVector(U.sh.coefficients[K],W);X++}else if(U.isDirectionalLight){const K=e.get(U);if(K.color.copy(U.color).multiplyScalar(U.intensity),U.castShadow){const ne=U.shadow,pe=t.get(U);pe.shadowIntensity=ne.intensity,pe.shadowBias=ne.bias,pe.shadowNormalBias=ne.normalBias,pe.shadowRadius=ne.radius,pe.shadowMapSize=ne.mapSize,n.directionalShadow[v]=pe,n.directionalShadowMap[v]=ce,n.directionalShadowMatrix[v]=U.shadow.matrix,R++}n.directional[v]=K,v++}else if(U.isSpotLight){const K=e.get(U);K.position.setFromMatrixPosition(U.matrixWorld),K.color.copy(q).multiplyScalar(W),K.distance=J,K.coneCos=Math.cos(U.angle),K.penumbraCos=Math.cos(U.angle*(1-U.penumbra)),K.decay=U.decay,n.spot[T]=K;const ne=U.shadow;if(U.map&&(n.spotLightMap[z]=U.map,z++,ne.updateMatrices(U),U.castShadow&&j++),n.spotLightMatrix[T]=ne.matrix,U.castShadow){const pe=t.get(U);pe.shadowIntensity=ne.intensity,pe.shadowBias=ne.bias,pe.shadowNormalBias=ne.normalBias,pe.shadowRadius=ne.radius,pe.shadowMapSize=ne.mapSize,n.spotShadow[T]=pe,n.spotShadowMap[T]=ce,I++}T++}else if(U.isRectAreaLight){const K=e.get(U);K.color.copy(q).multiplyScalar(W),K.halfWidth.set(U.width*.5,0,0),K.halfHeight.set(0,U.height*.5,0),n.rectArea[A]=K,A++}else if(U.isPointLight){const K=e.get(U);if(K.color.copy(U.color).multiplyScalar(U.intensity),K.distance=U.distance,K.decay=U.decay,U.castShadow){const ne=U.shadow,pe=t.get(U);pe.shadowIntensity=ne.intensity,pe.shadowBias=ne.bias,pe.shadowNormalBias=ne.normalBias,pe.shadowRadius=ne.radius,pe.shadowMapSize=ne.mapSize,pe.shadowCameraNear=ne.camera.near,pe.shadowCameraFar=ne.camera.far,n.pointShadow[S]=pe,n.pointShadowMap[S]=ce,n.pointShadowMatrix[S]=U.shadow.matrix,D++}n.point[S]=K,S++}else if(U.isHemisphereLight){const K=e.get(U);K.skyColor.copy(U.color).multiplyScalar(W),K.groundColor.copy(U.groundColor).multiplyScalar(W),n.hemi[w]=K,w++}}A>0&&(i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=An.LTC_FLOAT_1,n.rectAreaLTC2=An.LTC_FLOAT_2):(n.rectAreaLTC1=An.LTC_HALF_1,n.rectAreaLTC2=An.LTC_HALF_2)),n.ambient[0]=m,n.ambient[1]=g,n.ambient[2]=y;const G=n.hash;(G.directionalLength!==v||G.pointLength!==S||G.spotLength!==T||G.rectAreaLength!==A||G.hemiLength!==w||G.numDirectionalShadows!==R||G.numPointShadows!==D||G.numSpotShadows!==I||G.numSpotMaps!==z||G.numLightProbes!==X)&&(n.directional.length=v,n.spot.length=T,n.rectArea.length=A,n.point.length=S,n.hemi.length=w,n.directionalShadow.length=R,n.directionalShadowMap.length=R,n.pointShadow.length=D,n.pointShadowMap.length=D,n.spotShadow.length=I,n.spotShadowMap.length=I,n.directionalShadowMatrix.length=R,n.pointShadowMatrix.length=D,n.spotLightMatrix.length=I+z-j,n.spotLightMap.length=z,n.numSpotLightShadowsWithMaps=j,n.numLightProbes=X,G.directionalLength=v,G.pointLength=S,G.spotLength=T,G.rectAreaLength=A,G.hemiLength=w,G.numDirectionalShadows=R,G.numPointShadows=D,G.numSpotShadows=I,G.numSpotMaps=z,G.numLightProbes=X,n.version=hk++)}function f(d,m){let g=0,y=0,v=0,S=0,T=0;const A=m.matrixWorldInverse;for(let w=0,R=d.length;w<R;w++){const D=d[w];if(D.isDirectionalLight){const I=n.directional[g];I.direction.setFromMatrixPosition(D.matrixWorld),r.setFromMatrixPosition(D.target.matrixWorld),I.direction.sub(r),I.direction.transformDirection(A),g++}else if(D.isSpotLight){const I=n.spot[v];I.position.setFromMatrixPosition(D.matrixWorld),I.position.applyMatrix4(A),I.direction.setFromMatrixPosition(D.matrixWorld),r.setFromMatrixPosition(D.target.matrixWorld),I.direction.sub(r),I.direction.transformDirection(A),v++}else if(D.isRectAreaLight){const I=n.rectArea[S];I.position.setFromMatrixPosition(D.matrixWorld),I.position.applyMatrix4(A),l.identity(),s.copy(D.matrixWorld),s.premultiply(A),l.extractRotation(s),I.halfWidth.set(D.width*.5,0,0),I.halfHeight.set(0,D.height*.5,0),I.halfWidth.applyMatrix4(l),I.halfHeight.applyMatrix4(l),S++}else if(D.isPointLight){const I=n.point[y];I.position.setFromMatrixPosition(D.matrixWorld),I.position.applyMatrix4(A),y++}else if(D.isHemisphereLight){const I=n.hemi[T];I.direction.setFromMatrixPosition(D.matrixWorld),I.direction.transformDirection(A),T++}}}return{setup:c,setupView:f,state:n}}function z3(i){const e=new pk(i),t=[],n=[];function r(m){d.camera=m,t.length=0,n.length=0}function s(m){t.push(m)}function l(m){n.push(m)}function c(){e.setup(t)}function f(m){e.setupView(t,m)}const d={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:d,setupLights:c,setupLightsView:f,pushLight:s,pushShadow:l}}function mk(i){let e=new WeakMap;function t(r,s=0){const l=e.get(r);let c;return l===void 0?(c=new z3(i),e.set(r,[c])):s>=l.length?(c=new z3(i),l.push(c)):c=l[s],c}function n(){e=new WeakMap}return{get:t,dispose:n}}const gk=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,vk=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );
	gl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );
}`,xk=[new Ee(1,0,0),new Ee(-1,0,0),new Ee(0,1,0),new Ee(0,-1,0),new Ee(0,0,1),new Ee(0,0,-1)],yk=[new Ee(0,-1,0),new Ee(0,-1,0),new Ee(0,0,1),new Ee(0,0,-1),new Ee(0,-1,0),new Ee(0,-1,0)],j3=new ui,xg=new Ee,j5=new Ee;function bk(i,e,t){let n=new _0;const r=new zt,s=new zt,l=new Yr,c=new FS,f=new zS,d={},m=t.maxTextureSize,g={[_h]:cl,[cl]:_h,[Es]:Es},y=new fl({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new zt},radius:{value:4}},vertexShader:gk,fragmentShader:vk}),v=y.clone();v.defines.HORIZONTAL_PASS=1;const S=new Si;S.setAttribute("position",new zr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const T=new js(S,y),A=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Jm;let w=this.type;this.render=function(j,X,G){if(A.enabled===!1||A.autoUpdate===!1&&A.needsUpdate===!1||j.length===0)return;j.type===Tg&&(Mn("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),j.type=Jm);const L=i.getRenderTarget(),k=i.getActiveCubeFace(),U=i.getActiveMipmapLevel(),q=i.state;q.setBlending(Ou),q.buffers.depth.getReversed()===!0?q.buffers.color.setClear(0,0,0,0):q.buffers.color.setClear(1,1,1,1),q.buffers.depth.setTest(!0),q.setScissorTest(!1);const W=w!==this.type;W&&X.traverse(function(J){J.material&&(Array.isArray(J.material)?J.material.forEach(ce=>ce.needsUpdate=!0):J.material.needsUpdate=!0)});for(let J=0,ce=j.length;J<ce;J++){const K=j[J],ne=K.shadow;if(ne===void 0){Mn("WebGLShadowMap:",K,"has no shadow.");continue}if(ne.autoUpdate===!1&&ne.needsUpdate===!1)continue;r.copy(ne.mapSize);const pe=ne.getFrameExtents();if(r.multiply(pe),s.copy(ne.mapSize),(r.x>m||r.y>m)&&(r.x>m&&(s.x=Math.floor(m/pe.x),r.x=s.x*pe.x,ne.mapSize.x=s.x),r.y>m&&(s.y=Math.floor(m/pe.y),r.y=s.y*pe.y,ne.mapSize.y=s.y)),ne.map===null||W===!0){if(ne.map!==null&&(ne.map.depthTexture!==null&&(ne.map.depthTexture.dispose(),ne.map.depthTexture=null),ne.map.dispose()),this.type===mp){if(K.isPointLight){Mn("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}ne.map=new ul(r.x,r.y,{format:Ep,type:Ks,minFilter:ar,magFilter:ar,generateMipmaps:!1}),ne.map.texture.name=K.name+".shadowMap",ne.map.depthTexture=new p0(r.x,r.y,Cs),ne.map.depthTexture.name=K.name+".shadowMapDepth",ne.map.depthTexture.format=If,ne.map.depthTexture.compareFunction=null,ne.map.depthTexture.minFilter=va,ne.map.depthTexture.magFilter=va}else{K.isPointLight?(ne.map=new Wy(r.x),ne.map.depthTexture=new qT(r.x,Ec)):(ne.map=new ul(r.x,r.y),ne.map.depthTexture=new p0(r.x,r.y,Ec)),ne.map.depthTexture.name=K.name+".shadowMap",ne.map.depthTexture.format=If;const Te=i.state.buffers.depth.getReversed();this.type===Jm?(ne.map.depthTexture.compareFunction=Te?Vy:jy,ne.map.depthTexture.minFilter=ar,ne.map.depthTexture.magFilter=ar):(ne.map.depthTexture.compareFunction=null,ne.map.depthTexture.minFilter=va,ne.map.depthTexture.magFilter=va)}ne.camera.updateProjectionMatrix()}const Re=ne.map.isWebGLCubeRenderTarget?6:1;for(let Te=0;Te<Re;Te++){if(ne.map.isWebGLCubeRenderTarget)i.setRenderTarget(ne.map,Te),i.clear();else{Te===0&&(i.setRenderTarget(ne.map),i.clear());const ee=ne.getViewport(Te);l.set(s.x*ee.x,s.y*ee.y,s.x*ee.z,s.y*ee.w),q.viewport(l)}if(K.isPointLight){const ee=ne.camera,F=ne.matrix,$=K.distance||ee.far;$!==ee.far&&(ee.far=$,ee.updateProjectionMatrix()),xg.setFromMatrixPosition(K.matrixWorld),ee.position.copy(xg),j5.copy(ee.position),j5.add(xk[Te]),ee.up.copy(yk[Te]),ee.lookAt(j5),ee.updateMatrixWorld(),F.makeTranslation(-xg.x,-xg.y,-xg.z),j3.multiplyMatrices(ee.projectionMatrix,ee.matrixWorldInverse),ne._frustum.setFromProjectionMatrix(j3,ee.coordinateSystem,ee.reversedDepth)}else ne.updateMatrices(K);n=ne.getFrustum(),I(X,G,ne.camera,K,this.type)}ne.isPointLightShadow!==!0&&this.type===mp&&R(ne,G),ne.needsUpdate=!1}w=this.type,A.needsUpdate=!1,i.setRenderTarget(L,k,U)};function R(j,X){const G=e.update(T);y.defines.VSM_SAMPLES!==j.blurSamples&&(y.defines.VSM_SAMPLES=j.blurSamples,v.defines.VSM_SAMPLES=j.blurSamples,y.needsUpdate=!0,v.needsUpdate=!0),j.mapPass===null&&(j.mapPass=new ul(r.x,r.y,{format:Ep,type:Ks})),y.uniforms.shadow_pass.value=j.map.depthTexture,y.uniforms.resolution.value=j.mapSize,y.uniforms.radius.value=j.radius,i.setRenderTarget(j.mapPass),i.clear(),i.renderBufferDirect(X,null,G,y,T,null),v.uniforms.shadow_pass.value=j.mapPass.texture,v.uniforms.resolution.value=j.mapSize,v.uniforms.radius.value=j.radius,i.setRenderTarget(j.map),i.clear(),i.renderBufferDirect(X,null,G,v,T,null)}function D(j,X,G,L){let k=null;const U=G.isPointLight===!0?j.customDistanceMaterial:j.customDepthMaterial;if(U!==void 0)k=U;else if(k=G.isPointLight===!0?f:c,i.localClippingEnabled&&X.clipShadows===!0&&Array.isArray(X.clippingPlanes)&&X.clippingPlanes.length!==0||X.displacementMap&&X.displacementScale!==0||X.alphaMap&&X.alphaTest>0||X.map&&X.alphaTest>0||X.alphaToCoverage===!0){const q=k.uuid,W=X.uuid;let J=d[q];J===void 0&&(J={},d[q]=J);let ce=J[W];ce===void 0&&(ce=k.clone(),J[W]=ce,X.addEventListener("dispose",z)),k=ce}if(k.visible=X.visible,k.wireframe=X.wireframe,L===mp?k.side=X.shadowSide!==null?X.shadowSide:X.side:k.side=X.shadowSide!==null?X.shadowSide:g[X.side],k.alphaMap=X.alphaMap,k.alphaTest=X.alphaToCoverage===!0?.5:X.alphaTest,k.map=X.map,k.clipShadows=X.clipShadows,k.clippingPlanes=X.clippingPlanes,k.clipIntersection=X.clipIntersection,k.displacementMap=X.displacementMap,k.displacementScale=X.displacementScale,k.displacementBias=X.displacementBias,k.wireframeLinewidth=X.wireframeLinewidth,k.linewidth=X.linewidth,G.isPointLight===!0&&k.isMeshDistanceMaterial===!0){const q=i.properties.get(k);q.light=G}return k}function I(j,X,G,L,k){if(j.visible===!1)return;if(j.layers.test(X.layers)&&(j.isMesh||j.isLine||j.isPoints)&&(j.castShadow||j.receiveShadow&&k===mp)&&(!j.frustumCulled||n.intersectsObject(j))){j.modelViewMatrix.multiplyMatrices(G.matrixWorldInverse,j.matrixWorld);const W=e.update(j),J=j.material;if(Array.isArray(J)){const ce=W.groups;for(let K=0,ne=ce.length;K<ne;K++){const pe=ce[K],Re=J[pe.materialIndex];if(Re&&Re.visible){const Te=D(j,Re,L,k);j.onBeforeShadow(i,j,X,G,W,Te,pe),i.renderBufferDirect(G,null,W,Te,j,pe),j.onAfterShadow(i,j,X,G,W,Te,pe)}}}else if(J.visible){const ce=D(j,J,L,k);j.onBeforeShadow(i,j,X,G,W,ce,null),i.renderBufferDirect(G,null,W,ce,j,null),j.onAfterShadow(i,j,X,G,W,ce,null)}}const q=j.children;for(let W=0,J=q.length;W<J;W++)I(q[W],X,G,L,k)}function z(j){j.target.removeEventListener("dispose",z);for(const G in d){const L=d[G],k=j.target.uuid;k in L&&(L[k].dispose(),delete L[k])}}}const _k={[Px]:Ix,[Dx]:Bx,[kx]:Ux,[Tp]:Ox,[Ix]:Px,[Bx]:Dx,[Ux]:kx,[Ox]:Tp};function Sk(i,e){function t(){let Me=!1;const ze=new Yr;let Mt=null;const Rt=new Yr(0,0,0,0);return{setMask:function(se){Mt!==se&&!Me&&(i.colorMask(se,se,se,se),Mt=se)},setLocked:function(se){Me=se},setClear:function(se,Ve,vt,Dt,bn){bn===!0&&(se*=Dt,Ve*=Dt,vt*=Dt),ze.set(se,Ve,vt,Dt),Rt.equals(ze)===!1&&(i.clearColor(se,Ve,vt,Dt),Rt.copy(ze))},reset:function(){Me=!1,Mt=null,Rt.set(-1,0,0,0)}}}function n(){let Me=!1,ze=!1,Mt=null,Rt=null,se=null;return{setReversed:function(Ve){if(ze!==Ve){const vt=e.get("EXT_clip_control");Ve?vt.clipControlEXT(vt.LOWER_LEFT_EXT,vt.ZERO_TO_ONE_EXT):vt.clipControlEXT(vt.LOWER_LEFT_EXT,vt.NEGATIVE_ONE_TO_ONE_EXT),ze=Ve;const Dt=se;se=null,this.setClear(Dt)}},getReversed:function(){return ze},setTest:function(Ve){Ve?_e(i.DEPTH_TEST):ke(i.DEPTH_TEST)},setMask:function(Ve){Mt!==Ve&&!Me&&(i.depthMask(Ve),Mt=Ve)},setFunc:function(Ve){if(ze&&(Ve=_k[Ve]),Rt!==Ve){switch(Ve){case Px:i.depthFunc(i.NEVER);break;case Ix:i.depthFunc(i.ALWAYS);break;case Dx:i.depthFunc(i.LESS);break;case Tp:i.depthFunc(i.LEQUAL);break;case kx:i.depthFunc(i.EQUAL);break;case Ox:i.depthFunc(i.GEQUAL);break;case Bx:i.depthFunc(i.GREATER);break;case Ux:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}Rt=Ve}},setLocked:function(Ve){Me=Ve},setClear:function(Ve){se!==Ve&&(ze&&(Ve=1-Ve),i.clearDepth(Ve),se=Ve)},reset:function(){Me=!1,Mt=null,Rt=null,se=null,ze=!1}}}function r(){let Me=!1,ze=null,Mt=null,Rt=null,se=null,Ve=null,vt=null,Dt=null,bn=null;return{setTest:function(dn){Me||(dn?_e(i.STENCIL_TEST):ke(i.STENCIL_TEST))},setMask:function(dn){ze!==dn&&!Me&&(i.stencilMask(dn),ze=dn)},setFunc:function(dn,tn,gn){(Mt!==dn||Rt!==tn||se!==gn)&&(i.stencilFunc(dn,tn,gn),Mt=dn,Rt=tn,se=gn)},setOp:function(dn,tn,gn){(Ve!==dn||vt!==tn||Dt!==gn)&&(i.stencilOp(dn,tn,gn),Ve=dn,vt=tn,Dt=gn)},setLocked:function(dn){Me=dn},setClear:function(dn){bn!==dn&&(i.clearStencil(dn),bn=dn)},reset:function(){Me=!1,ze=null,Mt=null,Rt=null,se=null,Ve=null,vt=null,Dt=null,bn=null}}}const s=new t,l=new n,c=new r,f=new WeakMap,d=new WeakMap;let m={},g={},y=new WeakMap,v=[],S=null,T=!1,A=null,w=null,R=null,D=null,I=null,z=null,j=null,X=new fn(0,0,0),G=0,L=!1,k=null,U=null,q=null,W=null,J=null;const ce=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let K=!1,ne=0;const pe=i.getParameter(i.VERSION);pe.indexOf("WebGL")!==-1?(ne=parseFloat(/^WebGL (\d)/.exec(pe)[1]),K=ne>=1):pe.indexOf("OpenGL ES")!==-1&&(ne=parseFloat(/^OpenGL ES (\d)/.exec(pe)[1]),K=ne>=2);let Re=null,Te={};const ee=i.getParameter(i.SCISSOR_BOX),F=i.getParameter(i.VIEWPORT),$=new Yr().fromArray(ee),re=new Yr().fromArray(F);function Ae(Me,ze,Mt,Rt){const se=new Uint8Array(4),Ve=i.createTexture();i.bindTexture(Me,Ve),i.texParameteri(Me,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(Me,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let vt=0;vt<Mt;vt++)Me===i.TEXTURE_3D||Me===i.TEXTURE_2D_ARRAY?i.texImage3D(ze,0,i.RGBA,1,1,Rt,0,i.RGBA,i.UNSIGNED_BYTE,se):i.texImage2D(ze+vt,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,se);return Ve}const ie={};ie[i.TEXTURE_2D]=Ae(i.TEXTURE_2D,i.TEXTURE_2D,1),ie[i.TEXTURE_CUBE_MAP]=Ae(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),ie[i.TEXTURE_2D_ARRAY]=Ae(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),ie[i.TEXTURE_3D]=Ae(i.TEXTURE_3D,i.TEXTURE_3D,1,1),s.setClear(0,0,0,1),l.setClear(1),c.setClear(0),_e(i.DEPTH_TEST),l.setFunc(Tp),Qe(!1),Et(M_),_e(i.CULL_FACE),Je(Ou);function _e(Me){m[Me]!==!0&&(i.enable(Me),m[Me]=!0)}function ke(Me){m[Me]!==!1&&(i.disable(Me),m[Me]=!1)}function Fe(Me,ze){return g[Me]!==ze?(i.bindFramebuffer(Me,ze),g[Me]=ze,Me===i.DRAW_FRAMEBUFFER&&(g[i.FRAMEBUFFER]=ze),Me===i.FRAMEBUFFER&&(g[i.DRAW_FRAMEBUFFER]=ze),!0):!1}function We(Me,ze){let Mt=v,Rt=!1;if(Me){Mt=y.get(ze),Mt===void 0&&(Mt=[],y.set(ze,Mt));const se=Me.textures;if(Mt.length!==se.length||Mt[0]!==i.COLOR_ATTACHMENT0){for(let Ve=0,vt=se.length;Ve<vt;Ve++)Mt[Ve]=i.COLOR_ATTACHMENT0+Ve;Mt.length=se.length,Rt=!0}}else Mt[0]!==i.BACK&&(Mt[0]=i.BACK,Rt=!0);Rt&&i.drawBuffers(Mt)}function nt(Me){return S!==Me?(i.useProgram(Me),S=Me,!0):!1}const It={[od]:i.FUNC_ADD,[JA]:i.FUNC_SUBTRACT,[KA]:i.FUNC_REVERSE_SUBTRACT};It[QA]=i.MIN,It[eT]=i.MAX;const wt={[tT]:i.ZERO,[nT]:i.ONE,[iT]:i.SRC_COLOR,[Rx]:i.SRC_ALPHA,[cT]:i.SRC_ALPHA_SATURATE,[oT]:i.DST_COLOR,[sT]:i.DST_ALPHA,[rT]:i.ONE_MINUS_SRC_COLOR,[Lx]:i.ONE_MINUS_SRC_ALPHA,[lT]:i.ONE_MINUS_DST_COLOR,[aT]:i.ONE_MINUS_DST_ALPHA,[uT]:i.CONSTANT_COLOR,[fT]:i.ONE_MINUS_CONSTANT_COLOR,[hT]:i.CONSTANT_ALPHA,[dT]:i.ONE_MINUS_CONSTANT_ALPHA};function Je(Me,ze,Mt,Rt,se,Ve,vt,Dt,bn,dn){if(Me===Ou){T===!0&&(ke(i.BLEND),T=!1);return}if(T===!1&&(_e(i.BLEND),T=!0),Me!==$A){if(Me!==A||dn!==L){if((w!==od||I!==od)&&(i.blendEquation(i.FUNC_ADD),w=od,I=od),dn)switch(Me){case Sp:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case A_:i.blendFunc(i.ONE,i.ONE);break;case T_:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case E_:i.blendFuncSeparate(i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ZERO,i.ONE);break;default:Hn("WebGLState: Invalid blending: ",Me);break}else switch(Me){case Sp:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case A_:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE,i.ONE,i.ONE);break;case T_:Hn("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case E_:Hn("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:Hn("WebGLState: Invalid blending: ",Me);break}R=null,D=null,z=null,j=null,X.set(0,0,0),G=0,A=Me,L=dn}return}se=se||ze,Ve=Ve||Mt,vt=vt||Rt,(ze!==w||se!==I)&&(i.blendEquationSeparate(It[ze],It[se]),w=ze,I=se),(Mt!==R||Rt!==D||Ve!==z||vt!==j)&&(i.blendFuncSeparate(wt[Mt],wt[Rt],wt[Ve],wt[vt]),R=Mt,D=Rt,z=Ve,j=vt),(Dt.equals(X)===!1||bn!==G)&&(i.blendColor(Dt.r,Dt.g,Dt.b,bn),X.copy(Dt),G=bn),A=Me,L=!1}function le(Me,ze){Me.side===Es?ke(i.CULL_FACE):_e(i.CULL_FACE);let Mt=Me.side===cl;ze&&(Mt=!Mt),Qe(Mt),Me.blending===Sp&&Me.transparent===!1?Je(Ou):Je(Me.blending,Me.blendEquation,Me.blendSrc,Me.blendDst,Me.blendEquationAlpha,Me.blendSrcAlpha,Me.blendDstAlpha,Me.blendColor,Me.blendAlpha,Me.premultipliedAlpha),l.setFunc(Me.depthFunc),l.setTest(Me.depthTest),l.setMask(Me.depthWrite),s.setMask(Me.colorWrite);const Rt=Me.stencilWrite;c.setTest(Rt),Rt&&(c.setMask(Me.stencilWriteMask),c.setFunc(Me.stencilFunc,Me.stencilRef,Me.stencilFuncMask),c.setOp(Me.stencilFail,Me.stencilZFail,Me.stencilZPass)),ot(Me.polygonOffset,Me.polygonOffsetFactor,Me.polygonOffsetUnits),Me.alphaToCoverage===!0?_e(i.SAMPLE_ALPHA_TO_COVERAGE):ke(i.SAMPLE_ALPHA_TO_COVERAGE)}function Qe(Me){k!==Me&&(Me?i.frontFace(i.CW):i.frontFace(i.CCW),k=Me)}function Et(Me){Me!==XA?(_e(i.CULL_FACE),Me!==U&&(Me===M_?i.cullFace(i.BACK):Me===YA?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):ke(i.CULL_FACE),U=Me}function we(Me){Me!==q&&(K&&i.lineWidth(Me),q=Me)}function ot(Me,ze,Mt){Me?(_e(i.POLYGON_OFFSET_FILL),(W!==ze||J!==Mt)&&(i.polygonOffset(ze,Mt),W=ze,J=Mt)):ke(i.POLYGON_OFFSET_FILL)}function Ct(Me){Me?_e(i.SCISSOR_TEST):ke(i.SCISSOR_TEST)}function ht(Me){Me===void 0&&(Me=i.TEXTURE0+ce-1),Re!==Me&&(i.activeTexture(Me),Re=Me)}function xt(Me,ze,Mt){Mt===void 0&&(Re===null?Mt=i.TEXTURE0+ce-1:Mt=Re);let Rt=Te[Mt];Rt===void 0&&(Rt={type:void 0,texture:void 0},Te[Mt]=Rt),(Rt.type!==Me||Rt.texture!==ze)&&(Re!==Mt&&(i.activeTexture(Mt),Re=Mt),i.bindTexture(Me,ze||ie[Me]),Rt.type=Me,Rt.texture=ze)}function he(){const Me=Te[Re];Me!==void 0&&Me.type!==void 0&&(i.bindTexture(Me.type,null),Me.type=void 0,Me.texture=void 0)}function Q(){try{i.compressedTexImage2D(...arguments)}catch(Me){Hn("WebGLState:",Me)}}function Be(){try{i.compressedTexImage3D(...arguments)}catch(Me){Hn("WebGLState:",Me)}}function ue(){try{i.texSubImage2D(...arguments)}catch(Me){Hn("WebGLState:",Me)}}function je(){try{i.texSubImage3D(...arguments)}catch(Me){Hn("WebGLState:",Me)}}function Ye(){try{i.compressedTexSubImage2D(...arguments)}catch(Me){Hn("WebGLState:",Me)}}function ft(){try{i.compressedTexSubImage3D(...arguments)}catch(Me){Hn("WebGLState:",Me)}}function gt(){try{i.texStorage2D(...arguments)}catch(Me){Hn("WebGLState:",Me)}}function Lt(){try{i.texStorage3D(...arguments)}catch(Me){Hn("WebGLState:",Me)}}function un(){try{i.texImage2D(...arguments)}catch(Me){Hn("WebGLState:",Me)}}function bt(){try{i.texImage3D(...arguments)}catch(Me){Hn("WebGLState:",Me)}}function dt(Me){$.equals(Me)===!1&&(i.scissor(Me.x,Me.y,Me.z,Me.w),$.copy(Me))}function Ge(Me){re.equals(Me)===!1&&(i.viewport(Me.x,Me.y,Me.z,Me.w),re.copy(Me))}function xe(Me,ze){let Mt=d.get(ze);Mt===void 0&&(Mt=new WeakMap,d.set(ze,Mt));let Rt=Mt.get(Me);Rt===void 0&&(Rt=i.getUniformBlockIndex(ze,Me.name),Mt.set(Me,Rt))}function Pe(Me,ze){const Rt=d.get(ze).get(Me);f.get(ze)!==Rt&&(i.uniformBlockBinding(ze,Rt,Me.__bindingPointIndex),f.set(ze,Rt))}function rt(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),l.setReversed(!1),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),m={},Re=null,Te={},g={},y=new WeakMap,v=[],S=null,T=!1,A=null,w=null,R=null,D=null,I=null,z=null,j=null,X=new fn(0,0,0),G=0,L=!1,k=null,U=null,q=null,W=null,J=null,$.set(0,0,i.canvas.width,i.canvas.height),re.set(0,0,i.canvas.width,i.canvas.height),s.reset(),l.reset(),c.reset()}return{buffers:{color:s,depth:l,stencil:c},enable:_e,disable:ke,bindFramebuffer:Fe,drawBuffers:We,useProgram:nt,setBlending:Je,setMaterial:le,setFlipSided:Qe,setCullFace:Et,setLineWidth:we,setPolygonOffset:ot,setScissorTest:Ct,activeTexture:ht,bindTexture:xt,unbindTexture:he,compressedTexImage2D:Q,compressedTexImage3D:Be,texImage2D:un,texImage3D:bt,updateUBOMapping:xe,uniformBlockBinding:Pe,texStorage2D:gt,texStorage3D:Lt,texSubImage2D:ue,texSubImage3D:je,compressedTexSubImage2D:Ye,compressedTexSubImage3D:ft,scissor:dt,viewport:Ge,reset:rt}}function wk(i,e,t,n,r,s,l){const c=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),d=new zt,m=new WeakMap;let g;const y=new WeakMap;let v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function S(he,Q){return v?new OffscreenCanvas(he,Q):Wg("canvas")}function T(he,Q,Be){let ue=1;const je=xt(he);if((je.width>Be||je.height>Be)&&(ue=Be/Math.max(je.width,je.height)),ue<1)if(typeof HTMLImageElement<"u"&&he instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&he instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&he instanceof ImageBitmap||typeof VideoFrame<"u"&&he instanceof VideoFrame){const Ye=Math.floor(ue*je.width),ft=Math.floor(ue*je.height);g===void 0&&(g=S(Ye,ft));const gt=Q?S(Ye,ft):g;return gt.width=Ye,gt.height=ft,gt.getContext("2d").drawImage(he,0,0,Ye,ft),Mn("WebGLRenderer: Texture has been resized from ("+je.width+"x"+je.height+") to ("+Ye+"x"+ft+")."),gt}else return"data"in he&&Mn("WebGLRenderer: Image in DataTexture is too big ("+je.width+"x"+je.height+")."),he;return he}function A(he){return he.generateMipmaps}function w(he){i.generateMipmap(he)}function R(he){return he.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:he.isWebGL3DRenderTarget?i.TEXTURE_3D:he.isWebGLArrayRenderTarget||he.isCompressedArrayTexture?i.TEXTURE_2D_ARRAY:i.TEXTURE_2D}function D(he,Q,Be,ue,je=!1){if(he!==null){if(i[he]!==void 0)return i[he];Mn("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+he+"'")}let Ye=Q;if(Q===i.RED&&(Be===i.FLOAT&&(Ye=i.R32F),Be===i.HALF_FLOAT&&(Ye=i.R16F),Be===i.UNSIGNED_BYTE&&(Ye=i.R8)),Q===i.RED_INTEGER&&(Be===i.UNSIGNED_BYTE&&(Ye=i.R8UI),Be===i.UNSIGNED_SHORT&&(Ye=i.R16UI),Be===i.UNSIGNED_INT&&(Ye=i.R32UI),Be===i.BYTE&&(Ye=i.R8I),Be===i.SHORT&&(Ye=i.R16I),Be===i.INT&&(Ye=i.R32I)),Q===i.RG&&(Be===i.FLOAT&&(Ye=i.RG32F),Be===i.HALF_FLOAT&&(Ye=i.RG16F),Be===i.UNSIGNED_BYTE&&(Ye=i.RG8)),Q===i.RG_INTEGER&&(Be===i.UNSIGNED_BYTE&&(Ye=i.RG8UI),Be===i.UNSIGNED_SHORT&&(Ye=i.RG16UI),Be===i.UNSIGNED_INT&&(Ye=i.RG32UI),Be===i.BYTE&&(Ye=i.RG8I),Be===i.SHORT&&(Ye=i.RG16I),Be===i.INT&&(Ye=i.RG32I)),Q===i.RGB_INTEGER&&(Be===i.UNSIGNED_BYTE&&(Ye=i.RGB8UI),Be===i.UNSIGNED_SHORT&&(Ye=i.RGB16UI),Be===i.UNSIGNED_INT&&(Ye=i.RGB32UI),Be===i.BYTE&&(Ye=i.RGB8I),Be===i.SHORT&&(Ye=i.RGB16I),Be===i.INT&&(Ye=i.RGB32I)),Q===i.RGBA_INTEGER&&(Be===i.UNSIGNED_BYTE&&(Ye=i.RGBA8UI),Be===i.UNSIGNED_SHORT&&(Ye=i.RGBA16UI),Be===i.UNSIGNED_INT&&(Ye=i.RGBA32UI),Be===i.BYTE&&(Ye=i.RGBA8I),Be===i.SHORT&&(Ye=i.RGBA16I),Be===i.INT&&(Ye=i.RGBA32I)),Q===i.RGB&&(Be===i.UNSIGNED_INT_5_9_9_9_REV&&(Ye=i.RGB9_E5),Be===i.UNSIGNED_INT_10F_11F_11F_REV&&(Ye=i.R11F_G11F_B10F)),Q===i.RGBA){const ft=je?Gg:nr.getTransfer(ue);Be===i.FLOAT&&(Ye=i.RGBA32F),Be===i.HALF_FLOAT&&(Ye=i.RGBA16F),Be===i.UNSIGNED_BYTE&&(Ye=ft===Ar?i.SRGB8_ALPHA8:i.RGBA8),Be===i.UNSIGNED_SHORT_4_4_4_4&&(Ye=i.RGBA4),Be===i.UNSIGNED_SHORT_5_5_5_1&&(Ye=i.RGB5_A1)}return(Ye===i.R16F||Ye===i.R32F||Ye===i.RG16F||Ye===i.RG32F||Ye===i.RGBA16F||Ye===i.RGBA32F)&&e.get("EXT_color_buffer_float"),Ye}function I(he,Q){let Be;return he?Q===null||Q===Ec||Q===o0?Be=i.DEPTH24_STENCIL8:Q===Cs?Be=i.DEPTH32F_STENCIL8:Q===a0&&(Be=i.DEPTH24_STENCIL8,Mn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):Q===null||Q===Ec||Q===o0?Be=i.DEPTH_COMPONENT24:Q===Cs?Be=i.DEPTH_COMPONENT32F:Q===a0&&(Be=i.DEPTH_COMPONENT16),Be}function z(he,Q){return A(he)===!0||he.isFramebufferTexture&&he.minFilter!==va&&he.minFilter!==ar?Math.log2(Math.max(Q.width,Q.height))+1:he.mipmaps!==void 0&&he.mipmaps.length>0?he.mipmaps.length:he.isCompressedTexture&&Array.isArray(he.image)?Q.mipmaps.length:1}function j(he){const Q=he.target;Q.removeEventListener("dispose",j),G(Q),Q.isVideoTexture&&m.delete(Q)}function X(he){const Q=he.target;Q.removeEventListener("dispose",X),k(Q)}function G(he){const Q=n.get(he);if(Q.__webglInit===void 0)return;const Be=he.source,ue=y.get(Be);if(ue){const je=ue[Q.__cacheKey];je.usedTimes--,je.usedTimes===0&&L(he),Object.keys(ue).length===0&&y.delete(Be)}n.remove(he)}function L(he){const Q=n.get(he);i.deleteTexture(Q.__webglTexture);const Be=he.source,ue=y.get(Be);delete ue[Q.__cacheKey],l.memory.textures--}function k(he){const Q=n.get(he);if(he.depthTexture&&(he.depthTexture.dispose(),n.remove(he.depthTexture)),he.isWebGLCubeRenderTarget)for(let ue=0;ue<6;ue++){if(Array.isArray(Q.__webglFramebuffer[ue]))for(let je=0;je<Q.__webglFramebuffer[ue].length;je++)i.deleteFramebuffer(Q.__webglFramebuffer[ue][je]);else i.deleteFramebuffer(Q.__webglFramebuffer[ue]);Q.__webglDepthbuffer&&i.deleteRenderbuffer(Q.__webglDepthbuffer[ue])}else{if(Array.isArray(Q.__webglFramebuffer))for(let ue=0;ue<Q.__webglFramebuffer.length;ue++)i.deleteFramebuffer(Q.__webglFramebuffer[ue]);else i.deleteFramebuffer(Q.__webglFramebuffer);if(Q.__webglDepthbuffer&&i.deleteRenderbuffer(Q.__webglDepthbuffer),Q.__webglMultisampledFramebuffer&&i.deleteFramebuffer(Q.__webglMultisampledFramebuffer),Q.__webglColorRenderbuffer)for(let ue=0;ue<Q.__webglColorRenderbuffer.length;ue++)Q.__webglColorRenderbuffer[ue]&&i.deleteRenderbuffer(Q.__webglColorRenderbuffer[ue]);Q.__webglDepthRenderbuffer&&i.deleteRenderbuffer(Q.__webglDepthRenderbuffer)}const Be=he.textures;for(let ue=0,je=Be.length;ue<je;ue++){const Ye=n.get(Be[ue]);Ye.__webglTexture&&(i.deleteTexture(Ye.__webglTexture),l.memory.textures--),n.remove(Be[ue])}n.remove(he)}let U=0;function q(){U=0}function W(){const he=U;return he>=r.maxTextures&&Mn("WebGLTextures: Trying to use "+he+" texture units while this GPU supports only "+r.maxTextures),U+=1,he}function J(he){const Q=[];return Q.push(he.wrapS),Q.push(he.wrapT),Q.push(he.wrapR||0),Q.push(he.magFilter),Q.push(he.minFilter),Q.push(he.anisotropy),Q.push(he.internalFormat),Q.push(he.format),Q.push(he.type),Q.push(he.generateMipmaps),Q.push(he.premultiplyAlpha),Q.push(he.flipY),Q.push(he.unpackAlignment),Q.push(he.colorSpace),Q.join()}function ce(he,Q){const Be=n.get(he);if(he.isVideoTexture&&Ct(he),he.isRenderTargetTexture===!1&&he.isExternalTexture!==!0&&he.version>0&&Be.__version!==he.version){const ue=he.image;if(ue===null)Mn("WebGLRenderer: Texture marked for update but no image data found.");else if(ue.complete===!1)Mn("WebGLRenderer: Texture marked for update but image is incomplete");else{ie(Be,he,Q);return}}else he.isExternalTexture&&(Be.__webglTexture=he.sourceTexture?he.sourceTexture:null);t.bindTexture(i.TEXTURE_2D,Be.__webglTexture,i.TEXTURE0+Q)}function K(he,Q){const Be=n.get(he);if(he.isRenderTargetTexture===!1&&he.version>0&&Be.__version!==he.version){ie(Be,he,Q);return}else he.isExternalTexture&&(Be.__webglTexture=he.sourceTexture?he.sourceTexture:null);t.bindTexture(i.TEXTURE_2D_ARRAY,Be.__webglTexture,i.TEXTURE0+Q)}function ne(he,Q){const Be=n.get(he);if(he.isRenderTargetTexture===!1&&he.version>0&&Be.__version!==he.version){ie(Be,he,Q);return}t.bindTexture(i.TEXTURE_3D,Be.__webglTexture,i.TEXTURE0+Q)}function pe(he,Q){const Be=n.get(he);if(he.isCubeDepthTexture!==!0&&he.version>0&&Be.__version!==he.version){_e(Be,he,Q);return}t.bindTexture(i.TEXTURE_CUBE_MAP,Be.__webglTexture,i.TEXTURE0+Q)}const Re={[zg]:i.REPEAT,[Js]:i.CLAMP_TO_EDGE,[jg]:i.MIRRORED_REPEAT},Te={[va]:i.NEAREST,[xS]:i.NEAREST_MIPMAP_NEAREST,[Xm]:i.NEAREST_MIPMAP_LINEAR,[ar]:i.LINEAR,[Eg]:i.LINEAR_MIPMAP_NEAREST,[Rf]:i.LINEAR_MIPMAP_LINEAR},ee={[ST]:i.NEVER,[ET]:i.ALWAYS,[wT]:i.LESS,[jy]:i.LEQUAL,[MT]:i.EQUAL,[Vy]:i.GEQUAL,[AT]:i.GREATER,[TT]:i.NOTEQUAL};function F(he,Q){if(Q.type===Cs&&e.has("OES_texture_float_linear")===!1&&(Q.magFilter===ar||Q.magFilter===Eg||Q.magFilter===Xm||Q.magFilter===Rf||Q.minFilter===ar||Q.minFilter===Eg||Q.minFilter===Xm||Q.minFilter===Rf)&&Mn("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(he,i.TEXTURE_WRAP_S,Re[Q.wrapS]),i.texParameteri(he,i.TEXTURE_WRAP_T,Re[Q.wrapT]),(he===i.TEXTURE_3D||he===i.TEXTURE_2D_ARRAY)&&i.texParameteri(he,i.TEXTURE_WRAP_R,Re[Q.wrapR]),i.texParameteri(he,i.TEXTURE_MAG_FILTER,Te[Q.magFilter]),i.texParameteri(he,i.TEXTURE_MIN_FILTER,Te[Q.minFilter]),Q.compareFunction&&(i.texParameteri(he,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(he,i.TEXTURE_COMPARE_FUNC,ee[Q.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(Q.magFilter===va||Q.minFilter!==Xm&&Q.minFilter!==Rf||Q.type===Cs&&e.has("OES_texture_float_linear")===!1)return;if(Q.anisotropy>1||n.get(Q).__currentAnisotropy){const Be=e.get("EXT_texture_filter_anisotropic");i.texParameterf(he,Be.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Q.anisotropy,r.getMaxAnisotropy())),n.get(Q).__currentAnisotropy=Q.anisotropy}}}function $(he,Q){let Be=!1;he.__webglInit===void 0&&(he.__webglInit=!0,Q.addEventListener("dispose",j));const ue=Q.source;let je=y.get(ue);je===void 0&&(je={},y.set(ue,je));const Ye=J(Q);if(Ye!==he.__cacheKey){je[Ye]===void 0&&(je[Ye]={texture:i.createTexture(),usedTimes:0},l.memory.textures++,Be=!0),je[Ye].usedTimes++;const ft=je[he.__cacheKey];ft!==void 0&&(je[he.__cacheKey].usedTimes--,ft.usedTimes===0&&L(Q)),he.__cacheKey=Ye,he.__webglTexture=je[Ye].texture}return Be}function re(he,Q,Be){return Math.floor(Math.floor(he/Be)/Q)}function Ae(he,Q,Be,ue){const Ye=he.updateRanges;if(Ye.length===0)t.texSubImage2D(i.TEXTURE_2D,0,0,0,Q.width,Q.height,Be,ue,Q.data);else{Ye.sort((bt,dt)=>bt.start-dt.start);let ft=0;for(let bt=1;bt<Ye.length;bt++){const dt=Ye[ft],Ge=Ye[bt],xe=dt.start+dt.count,Pe=re(Ge.start,Q.width,4),rt=re(dt.start,Q.width,4);Ge.start<=xe+1&&Pe===rt&&re(Ge.start+Ge.count-1,Q.width,4)===Pe?dt.count=Math.max(dt.count,Ge.start+Ge.count-dt.start):(++ft,Ye[ft]=Ge)}Ye.length=ft+1;const gt=i.getParameter(i.UNPACK_ROW_LENGTH),Lt=i.getParameter(i.UNPACK_SKIP_PIXELS),un=i.getParameter(i.UNPACK_SKIP_ROWS);i.pixelStorei(i.UNPACK_ROW_LENGTH,Q.width);for(let bt=0,dt=Ye.length;bt<dt;bt++){const Ge=Ye[bt],xe=Math.floor(Ge.start/4),Pe=Math.ceil(Ge.count/4),rt=xe%Q.width,Me=Math.floor(xe/Q.width),ze=Pe,Mt=1;i.pixelStorei(i.UNPACK_SKIP_PIXELS,rt),i.pixelStorei(i.UNPACK_SKIP_ROWS,Me),t.texSubImage2D(i.TEXTURE_2D,0,rt,Me,ze,Mt,Be,ue,Q.data)}he.clearUpdateRanges(),i.pixelStorei(i.UNPACK_ROW_LENGTH,gt),i.pixelStorei(i.UNPACK_SKIP_PIXELS,Lt),i.pixelStorei(i.UNPACK_SKIP_ROWS,un)}}function ie(he,Q,Be){let ue=i.TEXTURE_2D;(Q.isDataArrayTexture||Q.isCompressedArrayTexture)&&(ue=i.TEXTURE_2D_ARRAY),Q.isData3DTexture&&(ue=i.TEXTURE_3D);const je=$(he,Q),Ye=Q.source;t.bindTexture(ue,he.__webglTexture,i.TEXTURE0+Be);const ft=n.get(Ye);if(Ye.version!==ft.__version||je===!0){t.activeTexture(i.TEXTURE0+Be);const gt=nr.getPrimaries(nr.workingColorSpace),Lt=Q.colorSpace===xh?null:nr.getPrimaries(Q.colorSpace),un=Q.colorSpace===xh||gt===Lt?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,Q.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Q.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,Q.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,un);let bt=T(Q.image,!1,r.maxTextureSize);bt=ht(Q,bt);const dt=s.convert(Q.format,Q.colorSpace),Ge=s.convert(Q.type);let xe=D(Q.internalFormat,dt,Ge,Q.colorSpace,Q.isVideoTexture);F(ue,Q);let Pe;const rt=Q.mipmaps,Me=Q.isVideoTexture!==!0,ze=ft.__version===void 0||je===!0,Mt=Ye.dataReady,Rt=z(Q,bt);if(Q.isDepthTexture)xe=I(Q.format===ld,Q.type),ze&&(Me?t.texStorage2D(i.TEXTURE_2D,1,xe,bt.width,bt.height):t.texImage2D(i.TEXTURE_2D,0,xe,bt.width,bt.height,0,dt,Ge,null));else if(Q.isDataTexture)if(rt.length>0){Me&&ze&&t.texStorage2D(i.TEXTURE_2D,Rt,xe,rt[0].width,rt[0].height);for(let se=0,Ve=rt.length;se<Ve;se++)Pe=rt[se],Me?Mt&&t.texSubImage2D(i.TEXTURE_2D,se,0,0,Pe.width,Pe.height,dt,Ge,Pe.data):t.texImage2D(i.TEXTURE_2D,se,xe,Pe.width,Pe.height,0,dt,Ge,Pe.data);Q.generateMipmaps=!1}else Me?(ze&&t.texStorage2D(i.TEXTURE_2D,Rt,xe,bt.width,bt.height),Mt&&Ae(Q,bt,dt,Ge)):t.texImage2D(i.TEXTURE_2D,0,xe,bt.width,bt.height,0,dt,Ge,bt.data);else if(Q.isCompressedTexture)if(Q.isCompressedArrayTexture){Me&&ze&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Rt,xe,rt[0].width,rt[0].height,bt.depth);for(let se=0,Ve=rt.length;se<Ve;se++)if(Pe=rt[se],Q.format!==xa)if(dt!==null)if(Me){if(Mt)if(Q.layerUpdates.size>0){const vt=F_(Pe.width,Pe.height,Q.format,Q.type);for(const Dt of Q.layerUpdates){const bn=Pe.data.subarray(Dt*vt/Pe.data.BYTES_PER_ELEMENT,(Dt+1)*vt/Pe.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,se,0,0,Dt,Pe.width,Pe.height,1,dt,bn)}Q.clearLayerUpdates()}else t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,se,0,0,0,Pe.width,Pe.height,bt.depth,dt,Pe.data)}else t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,se,xe,Pe.width,Pe.height,bt.depth,0,Pe.data,0,0);else Mn("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Me?Mt&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,se,0,0,0,Pe.width,Pe.height,bt.depth,dt,Ge,Pe.data):t.texImage3D(i.TEXTURE_2D_ARRAY,se,xe,Pe.width,Pe.height,bt.depth,0,dt,Ge,Pe.data)}else{Me&&ze&&t.texStorage2D(i.TEXTURE_2D,Rt,xe,rt[0].width,rt[0].height);for(let se=0,Ve=rt.length;se<Ve;se++)Pe=rt[se],Q.format!==xa?dt!==null?Me?Mt&&t.compressedTexSubImage2D(i.TEXTURE_2D,se,0,0,Pe.width,Pe.height,dt,Pe.data):t.compressedTexImage2D(i.TEXTURE_2D,se,xe,Pe.width,Pe.height,0,Pe.data):Mn("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Me?Mt&&t.texSubImage2D(i.TEXTURE_2D,se,0,0,Pe.width,Pe.height,dt,Ge,Pe.data):t.texImage2D(i.TEXTURE_2D,se,xe,Pe.width,Pe.height,0,dt,Ge,Pe.data)}else if(Q.isDataArrayTexture)if(Me){if(ze&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Rt,xe,bt.width,bt.height,bt.depth),Mt)if(Q.layerUpdates.size>0){const se=F_(bt.width,bt.height,Q.format,Q.type);for(const Ve of Q.layerUpdates){const vt=bt.data.subarray(Ve*se/bt.data.BYTES_PER_ELEMENT,(Ve+1)*se/bt.data.BYTES_PER_ELEMENT);t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,Ve,bt.width,bt.height,1,dt,Ge,vt)}Q.clearLayerUpdates()}else t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,bt.width,bt.height,bt.depth,dt,Ge,bt.data)}else t.texImage3D(i.TEXTURE_2D_ARRAY,0,xe,bt.width,bt.height,bt.depth,0,dt,Ge,bt.data);else if(Q.isData3DTexture)Me?(ze&&t.texStorage3D(i.TEXTURE_3D,Rt,xe,bt.width,bt.height,bt.depth),Mt&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,bt.width,bt.height,bt.depth,dt,Ge,bt.data)):t.texImage3D(i.TEXTURE_3D,0,xe,bt.width,bt.height,bt.depth,0,dt,Ge,bt.data);else if(Q.isFramebufferTexture){if(ze)if(Me)t.texStorage2D(i.TEXTURE_2D,Rt,xe,bt.width,bt.height);else{let se=bt.width,Ve=bt.height;for(let vt=0;vt<Rt;vt++)t.texImage2D(i.TEXTURE_2D,vt,xe,se,Ve,0,dt,Ge,null),se>>=1,Ve>>=1}}else if(rt.length>0){if(Me&&ze){const se=xt(rt[0]);t.texStorage2D(i.TEXTURE_2D,Rt,xe,se.width,se.height)}for(let se=0,Ve=rt.length;se<Ve;se++)Pe=rt[se],Me?Mt&&t.texSubImage2D(i.TEXTURE_2D,se,0,0,dt,Ge,Pe):t.texImage2D(i.TEXTURE_2D,se,xe,dt,Ge,Pe);Q.generateMipmaps=!1}else if(Me){if(ze){const se=xt(bt);t.texStorage2D(i.TEXTURE_2D,Rt,xe,se.width,se.height)}Mt&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,dt,Ge,bt)}else t.texImage2D(i.TEXTURE_2D,0,xe,dt,Ge,bt);A(Q)&&w(ue),ft.__version=Ye.version,Q.onUpdate&&Q.onUpdate(Q)}he.__version=Q.version}function _e(he,Q,Be){if(Q.image.length!==6)return;const ue=$(he,Q),je=Q.source;t.bindTexture(i.TEXTURE_CUBE_MAP,he.__webglTexture,i.TEXTURE0+Be);const Ye=n.get(je);if(je.version!==Ye.__version||ue===!0){t.activeTexture(i.TEXTURE0+Be);const ft=nr.getPrimaries(nr.workingColorSpace),gt=Q.colorSpace===xh?null:nr.getPrimaries(Q.colorSpace),Lt=Q.colorSpace===xh||ft===gt?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,Q.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Q.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,Q.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Lt);const un=Q.isCompressedTexture||Q.image[0].isCompressedTexture,bt=Q.image[0]&&Q.image[0].isDataTexture,dt=[];for(let Ve=0;Ve<6;Ve++)!un&&!bt?dt[Ve]=T(Q.image[Ve],!0,r.maxCubemapSize):dt[Ve]=bt?Q.image[Ve].image:Q.image[Ve],dt[Ve]=ht(Q,dt[Ve]);const Ge=dt[0],xe=s.convert(Q.format,Q.colorSpace),Pe=s.convert(Q.type),rt=D(Q.internalFormat,xe,Pe,Q.colorSpace),Me=Q.isVideoTexture!==!0,ze=Ye.__version===void 0||ue===!0,Mt=je.dataReady;let Rt=z(Q,Ge);F(i.TEXTURE_CUBE_MAP,Q);let se;if(un){Me&&ze&&t.texStorage2D(i.TEXTURE_CUBE_MAP,Rt,rt,Ge.width,Ge.height);for(let Ve=0;Ve<6;Ve++){se=dt[Ve].mipmaps;for(let vt=0;vt<se.length;vt++){const Dt=se[vt];Q.format!==xa?xe!==null?Me?Mt&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,vt,0,0,Dt.width,Dt.height,xe,Dt.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,vt,rt,Dt.width,Dt.height,0,Dt.data):Mn("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Me?Mt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,vt,0,0,Dt.width,Dt.height,xe,Pe,Dt.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,vt,rt,Dt.width,Dt.height,0,xe,Pe,Dt.data)}}}else{if(se=Q.mipmaps,Me&&ze){se.length>0&&Rt++;const Ve=xt(dt[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,Rt,rt,Ve.width,Ve.height)}for(let Ve=0;Ve<6;Ve++)if(bt){Me?Mt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,0,0,0,dt[Ve].width,dt[Ve].height,xe,Pe,dt[Ve].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,0,rt,dt[Ve].width,dt[Ve].height,0,xe,Pe,dt[Ve].data);for(let vt=0;vt<se.length;vt++){const bn=se[vt].image[Ve].image;Me?Mt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,vt+1,0,0,bn.width,bn.height,xe,Pe,bn.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,vt+1,rt,bn.width,bn.height,0,xe,Pe,bn.data)}}else{Me?Mt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,0,0,0,xe,Pe,dt[Ve]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,0,rt,xe,Pe,dt[Ve]);for(let vt=0;vt<se.length;vt++){const Dt=se[vt];Me?Mt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,vt+1,0,0,xe,Pe,Dt.image[Ve]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,vt+1,rt,xe,Pe,Dt.image[Ve])}}}A(Q)&&w(i.TEXTURE_CUBE_MAP),Ye.__version=je.version,Q.onUpdate&&Q.onUpdate(Q)}he.__version=Q.version}function ke(he,Q,Be,ue,je,Ye){const ft=s.convert(Be.format,Be.colorSpace),gt=s.convert(Be.type),Lt=D(Be.internalFormat,ft,gt,Be.colorSpace),un=n.get(Q),bt=n.get(Be);if(bt.__renderTarget=Q,!un.__hasExternalTextures){const dt=Math.max(1,Q.width>>Ye),Ge=Math.max(1,Q.height>>Ye);je===i.TEXTURE_3D||je===i.TEXTURE_2D_ARRAY?t.texImage3D(je,Ye,Lt,dt,Ge,Q.depth,0,ft,gt,null):t.texImage2D(je,Ye,Lt,dt,Ge,0,ft,gt,null)}t.bindFramebuffer(i.FRAMEBUFFER,he),ot(Q)?c.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,ue,je,bt.__webglTexture,0,we(Q)):(je===i.TEXTURE_2D||je>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&je<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,ue,je,bt.__webglTexture,Ye),t.bindFramebuffer(i.FRAMEBUFFER,null)}function Fe(he,Q,Be){if(i.bindRenderbuffer(i.RENDERBUFFER,he),Q.depthBuffer){const ue=Q.depthTexture,je=ue&&ue.isDepthTexture?ue.type:null,Ye=I(Q.stencilBuffer,je),ft=Q.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;ot(Q)?c.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,we(Q),Ye,Q.width,Q.height):Be?i.renderbufferStorageMultisample(i.RENDERBUFFER,we(Q),Ye,Q.width,Q.height):i.renderbufferStorage(i.RENDERBUFFER,Ye,Q.width,Q.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,ft,i.RENDERBUFFER,he)}else{const ue=Q.textures;for(let je=0;je<ue.length;je++){const Ye=ue[je],ft=s.convert(Ye.format,Ye.colorSpace),gt=s.convert(Ye.type),Lt=D(Ye.internalFormat,ft,gt,Ye.colorSpace);ot(Q)?c.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,we(Q),Lt,Q.width,Q.height):Be?i.renderbufferStorageMultisample(i.RENDERBUFFER,we(Q),Lt,Q.width,Q.height):i.renderbufferStorage(i.RENDERBUFFER,Lt,Q.width,Q.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function We(he,Q,Be){const ue=Q.isWebGLCubeRenderTarget===!0;if(t.bindFramebuffer(i.FRAMEBUFFER,he),!(Q.depthTexture&&Q.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const je=n.get(Q.depthTexture);if(je.__renderTarget=Q,(!je.__webglTexture||Q.depthTexture.image.width!==Q.width||Q.depthTexture.image.height!==Q.height)&&(Q.depthTexture.image.width=Q.width,Q.depthTexture.image.height=Q.height,Q.depthTexture.needsUpdate=!0),ue){if(je.__webglInit===void 0&&(je.__webglInit=!0,Q.depthTexture.addEventListener("dispose",j)),je.__webglTexture===void 0){je.__webglTexture=i.createTexture(),t.bindTexture(i.TEXTURE_CUBE_MAP,je.__webglTexture),F(i.TEXTURE_CUBE_MAP,Q.depthTexture);const un=s.convert(Q.depthTexture.format),bt=s.convert(Q.depthTexture.type);let dt;Q.depthTexture.format===If?dt=i.DEPTH_COMPONENT24:Q.depthTexture.format===ld&&(dt=i.DEPTH24_STENCIL8);for(let Ge=0;Ge<6;Ge++)i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0,dt,Q.width,Q.height,0,un,bt,null)}}else ce(Q.depthTexture,0);const Ye=je.__webglTexture,ft=we(Q),gt=ue?i.TEXTURE_CUBE_MAP_POSITIVE_X+Be:i.TEXTURE_2D,Lt=Q.depthTexture.format===ld?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;if(Q.depthTexture.format===If)ot(Q)?c.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,Lt,gt,Ye,0,ft):i.framebufferTexture2D(i.FRAMEBUFFER,Lt,gt,Ye,0);else if(Q.depthTexture.format===ld)ot(Q)?c.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,Lt,gt,Ye,0,ft):i.framebufferTexture2D(i.FRAMEBUFFER,Lt,gt,Ye,0);else throw new Error("Unknown depthTexture format")}function nt(he){const Q=n.get(he),Be=he.isWebGLCubeRenderTarget===!0;if(Q.__boundDepthTexture!==he.depthTexture){const ue=he.depthTexture;if(Q.__depthDisposeCallback&&Q.__depthDisposeCallback(),ue){const je=()=>{delete Q.__boundDepthTexture,delete Q.__depthDisposeCallback,ue.removeEventListener("dispose",je)};ue.addEventListener("dispose",je),Q.__depthDisposeCallback=je}Q.__boundDepthTexture=ue}if(he.depthTexture&&!Q.__autoAllocateDepthBuffer)if(Be)for(let ue=0;ue<6;ue++)We(Q.__webglFramebuffer[ue],he,ue);else{const ue=he.texture.mipmaps;ue&&ue.length>0?We(Q.__webglFramebuffer[0],he,0):We(Q.__webglFramebuffer,he,0)}else if(Be){Q.__webglDepthbuffer=[];for(let ue=0;ue<6;ue++)if(t.bindFramebuffer(i.FRAMEBUFFER,Q.__webglFramebuffer[ue]),Q.__webglDepthbuffer[ue]===void 0)Q.__webglDepthbuffer[ue]=i.createRenderbuffer(),Fe(Q.__webglDepthbuffer[ue],he,!1);else{const je=he.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Ye=Q.__webglDepthbuffer[ue];i.bindRenderbuffer(i.RENDERBUFFER,Ye),i.framebufferRenderbuffer(i.FRAMEBUFFER,je,i.RENDERBUFFER,Ye)}}else{const ue=he.texture.mipmaps;if(ue&&ue.length>0?t.bindFramebuffer(i.FRAMEBUFFER,Q.__webglFramebuffer[0]):t.bindFramebuffer(i.FRAMEBUFFER,Q.__webglFramebuffer),Q.__webglDepthbuffer===void 0)Q.__webglDepthbuffer=i.createRenderbuffer(),Fe(Q.__webglDepthbuffer,he,!1);else{const je=he.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Ye=Q.__webglDepthbuffer;i.bindRenderbuffer(i.RENDERBUFFER,Ye),i.framebufferRenderbuffer(i.FRAMEBUFFER,je,i.RENDERBUFFER,Ye)}}t.bindFramebuffer(i.FRAMEBUFFER,null)}function It(he,Q,Be){const ue=n.get(he);Q!==void 0&&ke(ue.__webglFramebuffer,he,he.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),Be!==void 0&&nt(he)}function wt(he){const Q=he.texture,Be=n.get(he),ue=n.get(Q);he.addEventListener("dispose",X);const je=he.textures,Ye=he.isWebGLCubeRenderTarget===!0,ft=je.length>1;if(ft||(ue.__webglTexture===void 0&&(ue.__webglTexture=i.createTexture()),ue.__version=Q.version,l.memory.textures++),Ye){Be.__webglFramebuffer=[];for(let gt=0;gt<6;gt++)if(Q.mipmaps&&Q.mipmaps.length>0){Be.__webglFramebuffer[gt]=[];for(let Lt=0;Lt<Q.mipmaps.length;Lt++)Be.__webglFramebuffer[gt][Lt]=i.createFramebuffer()}else Be.__webglFramebuffer[gt]=i.createFramebuffer()}else{if(Q.mipmaps&&Q.mipmaps.length>0){Be.__webglFramebuffer=[];for(let gt=0;gt<Q.mipmaps.length;gt++)Be.__webglFramebuffer[gt]=i.createFramebuffer()}else Be.__webglFramebuffer=i.createFramebuffer();if(ft)for(let gt=0,Lt=je.length;gt<Lt;gt++){const un=n.get(je[gt]);un.__webglTexture===void 0&&(un.__webglTexture=i.createTexture(),l.memory.textures++)}if(he.samples>0&&ot(he)===!1){Be.__webglMultisampledFramebuffer=i.createFramebuffer(),Be.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,Be.__webglMultisampledFramebuffer);for(let gt=0;gt<je.length;gt++){const Lt=je[gt];Be.__webglColorRenderbuffer[gt]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,Be.__webglColorRenderbuffer[gt]);const un=s.convert(Lt.format,Lt.colorSpace),bt=s.convert(Lt.type),dt=D(Lt.internalFormat,un,bt,Lt.colorSpace,he.isXRRenderTarget===!0),Ge=we(he);i.renderbufferStorageMultisample(i.RENDERBUFFER,Ge,dt,he.width,he.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+gt,i.RENDERBUFFER,Be.__webglColorRenderbuffer[gt])}i.bindRenderbuffer(i.RENDERBUFFER,null),he.depthBuffer&&(Be.__webglDepthRenderbuffer=i.createRenderbuffer(),Fe(Be.__webglDepthRenderbuffer,he,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(Ye){t.bindTexture(i.TEXTURE_CUBE_MAP,ue.__webglTexture),F(i.TEXTURE_CUBE_MAP,Q);for(let gt=0;gt<6;gt++)if(Q.mipmaps&&Q.mipmaps.length>0)for(let Lt=0;Lt<Q.mipmaps.length;Lt++)ke(Be.__webglFramebuffer[gt][Lt],he,Q,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+gt,Lt);else ke(Be.__webglFramebuffer[gt],he,Q,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+gt,0);A(Q)&&w(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(ft){for(let gt=0,Lt=je.length;gt<Lt;gt++){const un=je[gt],bt=n.get(un);let dt=i.TEXTURE_2D;(he.isWebGL3DRenderTarget||he.isWebGLArrayRenderTarget)&&(dt=he.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(dt,bt.__webglTexture),F(dt,un),ke(Be.__webglFramebuffer,he,un,i.COLOR_ATTACHMENT0+gt,dt,0),A(un)&&w(dt)}t.unbindTexture()}else{let gt=i.TEXTURE_2D;if((he.isWebGL3DRenderTarget||he.isWebGLArrayRenderTarget)&&(gt=he.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(gt,ue.__webglTexture),F(gt,Q),Q.mipmaps&&Q.mipmaps.length>0)for(let Lt=0;Lt<Q.mipmaps.length;Lt++)ke(Be.__webglFramebuffer[Lt],he,Q,i.COLOR_ATTACHMENT0,gt,Lt);else ke(Be.__webglFramebuffer,he,Q,i.COLOR_ATTACHMENT0,gt,0);A(Q)&&w(gt),t.unbindTexture()}he.depthBuffer&&nt(he)}function Je(he){const Q=he.textures;for(let Be=0,ue=Q.length;Be<ue;Be++){const je=Q[Be];if(A(je)){const Ye=R(he),ft=n.get(je).__webglTexture;t.bindTexture(Ye,ft),w(Ye),t.unbindTexture()}}}const le=[],Qe=[];function Et(he){if(he.samples>0){if(ot(he)===!1){const Q=he.textures,Be=he.width,ue=he.height;let je=i.COLOR_BUFFER_BIT;const Ye=he.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,ft=n.get(he),gt=Q.length>1;if(gt)for(let un=0;un<Q.length;un++)t.bindFramebuffer(i.FRAMEBUFFER,ft.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+un,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,ft.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+un,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,ft.__webglMultisampledFramebuffer);const Lt=he.texture.mipmaps;Lt&&Lt.length>0?t.bindFramebuffer(i.DRAW_FRAMEBUFFER,ft.__webglFramebuffer[0]):t.bindFramebuffer(i.DRAW_FRAMEBUFFER,ft.__webglFramebuffer);for(let un=0;un<Q.length;un++){if(he.resolveDepthBuffer&&(he.depthBuffer&&(je|=i.DEPTH_BUFFER_BIT),he.stencilBuffer&&he.resolveStencilBuffer&&(je|=i.STENCIL_BUFFER_BIT)),gt){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,ft.__webglColorRenderbuffer[un]);const bt=n.get(Q[un]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,bt,0)}i.blitFramebuffer(0,0,Be,ue,0,0,Be,ue,je,i.NEAREST),f===!0&&(le.length=0,Qe.length=0,le.push(i.COLOR_ATTACHMENT0+un),he.depthBuffer&&he.resolveDepthBuffer===!1&&(le.push(Ye),Qe.push(Ye),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,Qe)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,le))}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),gt)for(let un=0;un<Q.length;un++){t.bindFramebuffer(i.FRAMEBUFFER,ft.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+un,i.RENDERBUFFER,ft.__webglColorRenderbuffer[un]);const bt=n.get(Q[un]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,ft.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+un,i.TEXTURE_2D,bt,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,ft.__webglMultisampledFramebuffer)}else if(he.depthBuffer&&he.resolveDepthBuffer===!1&&f){const Q=he.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[Q])}}}function we(he){return Math.min(r.maxSamples,he.samples)}function ot(he){const Q=n.get(he);return he.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&Q.__useRenderToTexture!==!1}function Ct(he){const Q=l.render.frame;m.get(he)!==Q&&(m.set(he,Q),he.update())}function ht(he,Q){const Be=he.colorSpace,ue=he.format,je=he.type;return he.isCompressedTexture===!0||he.isVideoTexture===!0||Be!==Uu&&Be!==xh&&(nr.getTransfer(Be)===Ar?(ue!==xa||je!==$a)&&Mn("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):Hn("WebGLTextures: Unsupported texture color space:",Be)),Q}function xt(he){return typeof HTMLImageElement<"u"&&he instanceof HTMLImageElement?(d.width=he.naturalWidth||he.width,d.height=he.naturalHeight||he.height):typeof VideoFrame<"u"&&he instanceof VideoFrame?(d.width=he.displayWidth,d.height=he.displayHeight):(d.width=he.width,d.height=he.height),d}this.allocateTextureUnit=W,this.resetTextureUnits=q,this.setTexture2D=ce,this.setTexture2DArray=K,this.setTexture3D=ne,this.setTextureCube=pe,this.rebindTextures=It,this.setupRenderTarget=wt,this.updateRenderTargetMipmap=Je,this.updateMultisampleRenderTarget=Et,this.setupDepthRenderbuffer=nt,this.setupFrameBufferTexture=ke,this.useMultisampledRTT=ot,this.isReversedDepthBuffer=function(){return t.buffers.depth.getReversed()}}function kE(i,e){function t(n,r=xh){let s;const l=nr.getTransfer(r);if(n===$a)return i.UNSIGNED_BYTE;if(n===Oy)return i.UNSIGNED_SHORT_4_4_4_4;if(n===By)return i.UNSIGNED_SHORT_5_5_5_1;if(n===yS)return i.UNSIGNED_INT_5_9_9_9_REV;if(n===bS)return i.UNSIGNED_INT_10F_11F_11F_REV;if(n===Dy)return i.BYTE;if(n===ky)return i.SHORT;if(n===a0)return i.UNSIGNED_SHORT;if(n===u1)return i.INT;if(n===Ec)return i.UNSIGNED_INT;if(n===Cs)return i.FLOAT;if(n===Ks)return i.HALF_FLOAT;if(n===_S)return i.ALPHA;if(n===SS)return i.RGB;if(n===xa)return i.RGBA;if(n===If)return i.DEPTH_COMPONENT;if(n===ld)return i.DEPTH_STENCIL;if(n===f1)return i.RED;if(n===h1)return i.RED_INTEGER;if(n===Ep)return i.RG;if(n===Uy)return i.RG_INTEGER;if(n===Fy)return i.RGBA_INTEGER;if(n===Cg||n===Ng||n===Rg||n===Lg)if(l===Ar)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(n===Cg)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Ng)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Rg)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Lg)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(n===Cg)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Ng)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Rg)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Lg)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===Fx||n===zx||n===jx||n===Vx)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(n===Fx)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===zx)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===jx)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Vx)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===Hx||n===Gx||n===qx||n===Wx||n===Xx||n===Yx||n===Zx)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(n===Hx||n===Gx)return l===Ar?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(n===qx)return l===Ar?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC;if(n===Wx)return s.COMPRESSED_R11_EAC;if(n===Xx)return s.COMPRESSED_SIGNED_R11_EAC;if(n===Yx)return s.COMPRESSED_RG11_EAC;if(n===Zx)return s.COMPRESSED_SIGNED_RG11_EAC}else return null;if(n===$x||n===Jx||n===Kx||n===Qx||n===ey||n===ty||n===ny||n===iy||n===ry||n===sy||n===ay||n===oy||n===ly||n===cy)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(n===$x)return l===Ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Jx)return l===Ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Kx)return l===Ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===Qx)return l===Ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===ey)return l===Ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===ty)return l===Ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===ny)return l===Ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===iy)return l===Ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===ry)return l===Ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===sy)return l===Ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===ay)return l===Ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===oy)return l===Ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===ly)return l===Ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===cy)return l===Ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===uy||n===fy||n===hy)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(n===uy)return l===Ar?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===fy)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===hy)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===dy||n===py||n===my||n===gy)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(n===dy)return s.COMPRESSED_RED_RGTC1_EXT;if(n===py)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===my)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===gy)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===o0?i.UNSIGNED_INT_24_8:i[n]!==void 0?i[n]:null}return{convert:t}}const Mk=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,Ak=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class Tk{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){const n=new LS(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new fl({vertexShader:Mk,fragmentShader:Ak,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new js(new _d(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Ek extends Df{constructor(e,t){super();const n=this;let r=null,s=1,l=null,c="local-floor",f=1,d=null,m=null,g=null,y=null,v=null,S=null;const T=typeof XRWebGLBinding<"u",A=new Tk,w={},R=t.getContextAttributes();let D=null,I=null;const z=[],j=[],X=new zt;let G=null;const L=new Fs;L.viewport=new Yr;const k=new Fs;k.viewport=new Yr;const U=[L,k],q=new AE;let W=null,J=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ie){let _e=z[ie];return _e===void 0&&(_e=new bx,z[ie]=_e),_e.getTargetRaySpace()},this.getControllerGrip=function(ie){let _e=z[ie];return _e===void 0&&(_e=new bx,z[ie]=_e),_e.getGripSpace()},this.getHand=function(ie){let _e=z[ie];return _e===void 0&&(_e=new bx,z[ie]=_e),_e.getHandSpace()};function ce(ie){const _e=j.indexOf(ie.inputSource);if(_e===-1)return;const ke=z[_e];ke!==void 0&&(ke.update(ie.inputSource,ie.frame,d||l),ke.dispatchEvent({type:ie.type,data:ie.inputSource}))}function K(){r.removeEventListener("select",ce),r.removeEventListener("selectstart",ce),r.removeEventListener("selectend",ce),r.removeEventListener("squeeze",ce),r.removeEventListener("squeezestart",ce),r.removeEventListener("squeezeend",ce),r.removeEventListener("end",K),r.removeEventListener("inputsourceschange",ne);for(let ie=0;ie<z.length;ie++){const _e=j[ie];_e!==null&&(j[ie]=null,z[ie].disconnect(_e))}W=null,J=null,A.reset();for(const ie in w)delete w[ie];e.setRenderTarget(D),v=null,y=null,g=null,r=null,I=null,Ae.stop(),n.isPresenting=!1,e.setPixelRatio(G),e.setSize(X.width,X.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ie){s=ie,n.isPresenting===!0&&Mn("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ie){c=ie,n.isPresenting===!0&&Mn("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return d||l},this.setReferenceSpace=function(ie){d=ie},this.getBaseLayer=function(){return y!==null?y:v},this.getBinding=function(){return g===null&&T&&(g=new XRWebGLBinding(r,t)),g},this.getFrame=function(){return S},this.getSession=function(){return r},this.setSession=async function(ie){if(r=ie,r!==null){if(D=e.getRenderTarget(),r.addEventListener("select",ce),r.addEventListener("selectstart",ce),r.addEventListener("selectend",ce),r.addEventListener("squeeze",ce),r.addEventListener("squeezestart",ce),r.addEventListener("squeezeend",ce),r.addEventListener("end",K),r.addEventListener("inputsourceschange",ne),R.xrCompatible!==!0&&await t.makeXRCompatible(),G=e.getPixelRatio(),e.getSize(X),T&&"createProjectionLayer"in XRWebGLBinding.prototype){let ke=null,Fe=null,We=null;R.depth&&(We=R.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,ke=R.stencil?ld:If,Fe=R.stencil?o0:Ec);const nt={colorFormat:t.RGBA8,depthFormat:We,scaleFactor:s};g=this.getBinding(),y=g.createProjectionLayer(nt),r.updateRenderState({layers:[y]}),e.setPixelRatio(1),e.setSize(y.textureWidth,y.textureHeight,!1),I=new ul(y.textureWidth,y.textureHeight,{format:xa,type:$a,depthTexture:new p0(y.textureWidth,y.textureHeight,Fe,void 0,void 0,void 0,void 0,void 0,void 0,ke),stencilBuffer:R.stencil,colorSpace:e.outputColorSpace,samples:R.antialias?4:0,resolveDepthBuffer:y.ignoreDepthValues===!1,resolveStencilBuffer:y.ignoreDepthValues===!1})}else{const ke={antialias:R.antialias,alpha:!0,depth:R.depth,stencil:R.stencil,framebufferScaleFactor:s};v=new XRWebGLLayer(r,t,ke),r.updateRenderState({baseLayer:v}),e.setPixelRatio(1),e.setSize(v.framebufferWidth,v.framebufferHeight,!1),I=new ul(v.framebufferWidth,v.framebufferHeight,{format:xa,type:$a,colorSpace:e.outputColorSpace,stencilBuffer:R.stencil,resolveDepthBuffer:v.ignoreDepthValues===!1,resolveStencilBuffer:v.ignoreDepthValues===!1})}I.isXRRenderTarget=!0,this.setFoveation(f),d=null,l=await r.requestReferenceSpace(c),Ae.setContext(r),Ae.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return A.getDepthTexture()};function ne(ie){for(let _e=0;_e<ie.removed.length;_e++){const ke=ie.removed[_e],Fe=j.indexOf(ke);Fe>=0&&(j[Fe]=null,z[Fe].disconnect(ke))}for(let _e=0;_e<ie.added.length;_e++){const ke=ie.added[_e];let Fe=j.indexOf(ke);if(Fe===-1){for(let nt=0;nt<z.length;nt++)if(nt>=j.length){j.push(ke),Fe=nt;break}else if(j[nt]===null){j[nt]=ke,Fe=nt;break}if(Fe===-1)break}const We=z[Fe];We&&We.connect(ke)}}const pe=new Ee,Re=new Ee;function Te(ie,_e,ke){pe.setFromMatrixPosition(_e.matrixWorld),Re.setFromMatrixPosition(ke.matrixWorld);const Fe=pe.distanceTo(Re),We=_e.projectionMatrix.elements,nt=ke.projectionMatrix.elements,It=We[14]/(We[10]-1),wt=We[14]/(We[10]+1),Je=(We[9]+1)/We[5],le=(We[9]-1)/We[5],Qe=(We[8]-1)/We[0],Et=(nt[8]+1)/nt[0],we=It*Qe,ot=It*Et,Ct=Fe/(-Qe+Et),ht=Ct*-Qe;if(_e.matrixWorld.decompose(ie.position,ie.quaternion,ie.scale),ie.translateX(ht),ie.translateZ(Ct),ie.matrixWorld.compose(ie.position,ie.quaternion,ie.scale),ie.matrixWorldInverse.copy(ie.matrixWorld).invert(),We[10]===-1)ie.projectionMatrix.copy(_e.projectionMatrix),ie.projectionMatrixInverse.copy(_e.projectionMatrixInverse);else{const xt=It+Ct,he=wt+Ct,Q=we-ht,Be=ot+(Fe-ht),ue=Je*wt/he*xt,je=le*wt/he*xt;ie.projectionMatrix.makePerspective(Q,Be,ue,je,xt,he),ie.projectionMatrixInverse.copy(ie.projectionMatrix).invert()}}function ee(ie,_e){_e===null?ie.matrixWorld.copy(ie.matrix):ie.matrixWorld.multiplyMatrices(_e.matrixWorld,ie.matrix),ie.matrixWorldInverse.copy(ie.matrixWorld).invert()}this.updateCamera=function(ie){if(r===null)return;let _e=ie.near,ke=ie.far;A.texture!==null&&(A.depthNear>0&&(_e=A.depthNear),A.depthFar>0&&(ke=A.depthFar)),q.near=k.near=L.near=_e,q.far=k.far=L.far=ke,(W!==q.near||J!==q.far)&&(r.updateRenderState({depthNear:q.near,depthFar:q.far}),W=q.near,J=q.far),q.layers.mask=ie.layers.mask|6,L.layers.mask=q.layers.mask&3,k.layers.mask=q.layers.mask&5;const Fe=ie.parent,We=q.cameras;ee(q,Fe);for(let nt=0;nt<We.length;nt++)ee(We[nt],Fe);We.length===2?Te(q,L,k):q.projectionMatrix.copy(L.projectionMatrix),F(ie,q,Fe)};function F(ie,_e,ke){ke===null?ie.matrix.copy(_e.matrixWorld):(ie.matrix.copy(ke.matrixWorld),ie.matrix.invert(),ie.matrix.multiply(_e.matrixWorld)),ie.matrix.decompose(ie.position,ie.quaternion,ie.scale),ie.updateMatrixWorld(!0),ie.projectionMatrix.copy(_e.projectionMatrix),ie.projectionMatrixInverse.copy(_e.projectionMatrixInverse),ie.isPerspectiveCamera&&(ie.fov=u0*2*Math.atan(1/ie.projectionMatrix.elements[5]),ie.zoom=1)}this.getCamera=function(){return q},this.getFoveation=function(){if(!(y===null&&v===null))return f},this.setFoveation=function(ie){f=ie,y!==null&&(y.fixedFoveation=ie),v!==null&&v.fixedFoveation!==void 0&&(v.fixedFoveation=ie)},this.hasDepthSensing=function(){return A.texture!==null},this.getDepthSensingMesh=function(){return A.getMesh(q)},this.getCameraTexture=function(ie){return w[ie]};let $=null;function re(ie,_e){if(m=_e.getViewerPose(d||l),S=_e,m!==null){const ke=m.views;v!==null&&(e.setRenderTargetFramebuffer(I,v.framebuffer),e.setRenderTarget(I));let Fe=!1;ke.length!==q.cameras.length&&(q.cameras.length=0,Fe=!0);for(let wt=0;wt<ke.length;wt++){const Je=ke[wt];let le=null;if(v!==null)le=v.getViewport(Je);else{const Et=g.getViewSubImage(y,Je);le=Et.viewport,wt===0&&(e.setRenderTargetTextures(I,Et.colorTexture,Et.depthStencilTexture),e.setRenderTarget(I))}let Qe=U[wt];Qe===void 0&&(Qe=new Fs,Qe.layers.enable(wt),Qe.viewport=new Yr,U[wt]=Qe),Qe.matrix.fromArray(Je.transform.matrix),Qe.matrix.decompose(Qe.position,Qe.quaternion,Qe.scale),Qe.projectionMatrix.fromArray(Je.projectionMatrix),Qe.projectionMatrixInverse.copy(Qe.projectionMatrix).invert(),Qe.viewport.set(le.x,le.y,le.width,le.height),wt===0&&(q.matrix.copy(Qe.matrix),q.matrix.decompose(q.position,q.quaternion,q.scale)),Fe===!0&&q.cameras.push(Qe)}const We=r.enabledFeatures;if(We&&We.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&T){g=n.getBinding();const wt=g.getDepthInformation(ke[0]);wt&&wt.isValid&&wt.texture&&A.init(wt,r.renderState)}if(We&&We.includes("camera-access")&&T){e.state.unbindTexture(),g=n.getBinding();for(let wt=0;wt<ke.length;wt++){const Je=ke[wt].camera;if(Je){let le=w[Je];le||(le=new LS,w[Je]=le);const Qe=g.getCameraImage(Je);le.sourceTexture=Qe}}}}for(let ke=0;ke<z.length;ke++){const Fe=j[ke],We=z[ke];Fe!==null&&We!==void 0&&We.update(Fe,_e,d||l)}$&&$(ie,_e),_e.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:_e}),S=null}const Ae=new RE;Ae.setAnimationLoop(re),this.setAnimationLoop=function(ie){$=ie},this.dispose=function(){}}}const op=new Cc,Ck=new ui;function Nk(i,e){function t(A,w){A.matrixAutoUpdate===!0&&A.updateMatrix(),w.value.copy(A.matrix)}function n(A,w){w.color.getRGB(A.fogColor.value,IT(i)),w.isFog?(A.fogNear.value=w.near,A.fogFar.value=w.far):w.isFogExp2&&(A.fogDensity.value=w.density)}function r(A,w,R,D,I){w.isMeshBasicMaterial||w.isMeshLambertMaterial?s(A,w):w.isMeshToonMaterial?(s(A,w),g(A,w)):w.isMeshPhongMaterial?(s(A,w),m(A,w)):w.isMeshStandardMaterial?(s(A,w),y(A,w),w.isMeshPhysicalMaterial&&v(A,w,I)):w.isMeshMatcapMaterial?(s(A,w),S(A,w)):w.isMeshDepthMaterial?s(A,w):w.isMeshDistanceMaterial?(s(A,w),T(A,w)):w.isMeshNormalMaterial?s(A,w):w.isLineBasicMaterial?(l(A,w),w.isLineDashedMaterial&&c(A,w)):w.isPointsMaterial?f(A,w,R,D):w.isSpriteMaterial?d(A,w):w.isShadowMaterial?(A.color.value.copy(w.color),A.opacity.value=w.opacity):w.isShaderMaterial&&(w.uniformsNeedUpdate=!1)}function s(A,w){A.opacity.value=w.opacity,w.color&&A.diffuse.value.copy(w.color),w.emissive&&A.emissive.value.copy(w.emissive).multiplyScalar(w.emissiveIntensity),w.map&&(A.map.value=w.map,t(w.map,A.mapTransform)),w.alphaMap&&(A.alphaMap.value=w.alphaMap,t(w.alphaMap,A.alphaMapTransform)),w.bumpMap&&(A.bumpMap.value=w.bumpMap,t(w.bumpMap,A.bumpMapTransform),A.bumpScale.value=w.bumpScale,w.side===cl&&(A.bumpScale.value*=-1)),w.normalMap&&(A.normalMap.value=w.normalMap,t(w.normalMap,A.normalMapTransform),A.normalScale.value.copy(w.normalScale),w.side===cl&&A.normalScale.value.negate()),w.displacementMap&&(A.displacementMap.value=w.displacementMap,t(w.displacementMap,A.displacementMapTransform),A.displacementScale.value=w.displacementScale,A.displacementBias.value=w.displacementBias),w.emissiveMap&&(A.emissiveMap.value=w.emissiveMap,t(w.emissiveMap,A.emissiveMapTransform)),w.specularMap&&(A.specularMap.value=w.specularMap,t(w.specularMap,A.specularMapTransform)),w.alphaTest>0&&(A.alphaTest.value=w.alphaTest);const R=e.get(w),D=R.envMap,I=R.envMapRotation;D&&(A.envMap.value=D,op.copy(I),op.x*=-1,op.y*=-1,op.z*=-1,D.isCubeTexture&&D.isRenderTargetTexture===!1&&(op.y*=-1,op.z*=-1),A.envMapRotation.value.setFromMatrix4(Ck.makeRotationFromEuler(op)),A.flipEnvMap.value=D.isCubeTexture&&D.isRenderTargetTexture===!1?-1:1,A.reflectivity.value=w.reflectivity,A.ior.value=w.ior,A.refractionRatio.value=w.refractionRatio),w.lightMap&&(A.lightMap.value=w.lightMap,A.lightMapIntensity.value=w.lightMapIntensity,t(w.lightMap,A.lightMapTransform)),w.aoMap&&(A.aoMap.value=w.aoMap,A.aoMapIntensity.value=w.aoMapIntensity,t(w.aoMap,A.aoMapTransform))}function l(A,w){A.diffuse.value.copy(w.color),A.opacity.value=w.opacity,w.map&&(A.map.value=w.map,t(w.map,A.mapTransform))}function c(A,w){A.dashSize.value=w.dashSize,A.totalSize.value=w.dashSize+w.gapSize,A.scale.value=w.scale}function f(A,w,R,D){A.diffuse.value.copy(w.color),A.opacity.value=w.opacity,A.size.value=w.size*R,A.scale.value=D*.5,w.map&&(A.map.value=w.map,t(w.map,A.uvTransform)),w.alphaMap&&(A.alphaMap.value=w.alphaMap,t(w.alphaMap,A.alphaMapTransform)),w.alphaTest>0&&(A.alphaTest.value=w.alphaTest)}function d(A,w){A.diffuse.value.copy(w.color),A.opacity.value=w.opacity,A.rotation.value=w.rotation,w.map&&(A.map.value=w.map,t(w.map,A.mapTransform)),w.alphaMap&&(A.alphaMap.value=w.alphaMap,t(w.alphaMap,A.alphaMapTransform)),w.alphaTest>0&&(A.alphaTest.value=w.alphaTest)}function m(A,w){A.specular.value.copy(w.specular),A.shininess.value=Math.max(w.shininess,1e-4)}function g(A,w){w.gradientMap&&(A.gradientMap.value=w.gradientMap)}function y(A,w){A.metalness.value=w.metalness,w.metalnessMap&&(A.metalnessMap.value=w.metalnessMap,t(w.metalnessMap,A.metalnessMapTransform)),A.roughness.value=w.roughness,w.roughnessMap&&(A.roughnessMap.value=w.roughnessMap,t(w.roughnessMap,A.roughnessMapTransform)),w.envMap&&(A.envMapIntensity.value=w.envMapIntensity)}function v(A,w,R){A.ior.value=w.ior,w.sheen>0&&(A.sheenColor.value.copy(w.sheenColor).multiplyScalar(w.sheen),A.sheenRoughness.value=w.sheenRoughness,w.sheenColorMap&&(A.sheenColorMap.value=w.sheenColorMap,t(w.sheenColorMap,A.sheenColorMapTransform)),w.sheenRoughnessMap&&(A.sheenRoughnessMap.value=w.sheenRoughnessMap,t(w.sheenRoughnessMap,A.sheenRoughnessMapTransform))),w.clearcoat>0&&(A.clearcoat.value=w.clearcoat,A.clearcoatRoughness.value=w.clearcoatRoughness,w.clearcoatMap&&(A.clearcoatMap.value=w.clearcoatMap,t(w.clearcoatMap,A.clearcoatMapTransform)),w.clearcoatRoughnessMap&&(A.clearcoatRoughnessMap.value=w.clearcoatRoughnessMap,t(w.clearcoatRoughnessMap,A.clearcoatRoughnessMapTransform)),w.clearcoatNormalMap&&(A.clearcoatNormalMap.value=w.clearcoatNormalMap,t(w.clearcoatNormalMap,A.clearcoatNormalMapTransform),A.clearcoatNormalScale.value.copy(w.clearcoatNormalScale),w.side===cl&&A.clearcoatNormalScale.value.negate())),w.dispersion>0&&(A.dispersion.value=w.dispersion),w.iridescence>0&&(A.iridescence.value=w.iridescence,A.iridescenceIOR.value=w.iridescenceIOR,A.iridescenceThicknessMinimum.value=w.iridescenceThicknessRange[0],A.iridescenceThicknessMaximum.value=w.iridescenceThicknessRange[1],w.iridescenceMap&&(A.iridescenceMap.value=w.iridescenceMap,t(w.iridescenceMap,A.iridescenceMapTransform)),w.iridescenceThicknessMap&&(A.iridescenceThicknessMap.value=w.iridescenceThicknessMap,t(w.iridescenceThicknessMap,A.iridescenceThicknessMapTransform))),w.transmission>0&&(A.transmission.value=w.transmission,A.transmissionSamplerMap.value=R.texture,A.transmissionSamplerSize.value.set(R.width,R.height),w.transmissionMap&&(A.transmissionMap.value=w.transmissionMap,t(w.transmissionMap,A.transmissionMapTransform)),A.thickness.value=w.thickness,w.thicknessMap&&(A.thicknessMap.value=w.thicknessMap,t(w.thicknessMap,A.thicknessMapTransform)),A.attenuationDistance.value=w.attenuationDistance,A.attenuationColor.value.copy(w.attenuationColor)),w.anisotropy>0&&(A.anisotropyVector.value.set(w.anisotropy*Math.cos(w.anisotropyRotation),w.anisotropy*Math.sin(w.anisotropyRotation)),w.anisotropyMap&&(A.anisotropyMap.value=w.anisotropyMap,t(w.anisotropyMap,A.anisotropyMapTransform))),A.specularIntensity.value=w.specularIntensity,A.specularColor.value.copy(w.specularColor),w.specularColorMap&&(A.specularColorMap.value=w.specularColorMap,t(w.specularColorMap,A.specularColorMapTransform)),w.specularIntensityMap&&(A.specularIntensityMap.value=w.specularIntensityMap,t(w.specularIntensityMap,A.specularIntensityMapTransform))}function S(A,w){w.matcap&&(A.matcap.value=w.matcap)}function T(A,w){const R=e.get(w).light;A.referencePosition.value.setFromMatrixPosition(R.matrixWorld),A.nearDistance.value=R.shadow.camera.near,A.farDistance.value=R.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function Rk(i,e,t,n){let r={},s={},l=[];const c=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function f(R,D){const I=D.program;n.uniformBlockBinding(R,I)}function d(R,D){let I=r[R.id];I===void 0&&(S(R),I=m(R),r[R.id]=I,R.addEventListener("dispose",A));const z=D.program;n.updateUBOMapping(R,z);const j=e.render.frame;s[R.id]!==j&&(y(R),s[R.id]=j)}function m(R){const D=g();R.__bindingPointIndex=D;const I=i.createBuffer(),z=R.__size,j=R.usage;return i.bindBuffer(i.UNIFORM_BUFFER,I),i.bufferData(i.UNIFORM_BUFFER,z,j),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,D,I),I}function g(){for(let R=0;R<c;R++)if(l.indexOf(R)===-1)return l.push(R),R;return Hn("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function y(R){const D=r[R.id],I=R.uniforms,z=R.__cache;i.bindBuffer(i.UNIFORM_BUFFER,D);for(let j=0,X=I.length;j<X;j++){const G=Array.isArray(I[j])?I[j]:[I[j]];for(let L=0,k=G.length;L<k;L++){const U=G[L];if(v(U,j,L,z)===!0){const q=U.__offset,W=Array.isArray(U.value)?U.value:[U.value];let J=0;for(let ce=0;ce<W.length;ce++){const K=W[ce],ne=T(K);typeof K=="number"||typeof K=="boolean"?(U.__data[0]=K,i.bufferSubData(i.UNIFORM_BUFFER,q+J,U.__data)):K.isMatrix3?(U.__data[0]=K.elements[0],U.__data[1]=K.elements[1],U.__data[2]=K.elements[2],U.__data[3]=0,U.__data[4]=K.elements[3],U.__data[5]=K.elements[4],U.__data[6]=K.elements[5],U.__data[7]=0,U.__data[8]=K.elements[6],U.__data[9]=K.elements[7],U.__data[10]=K.elements[8],U.__data[11]=0):(K.toArray(U.__data,J),J+=ne.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,q,U.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function v(R,D,I,z){const j=R.value,X=D+"_"+I;if(z[X]===void 0)return typeof j=="number"||typeof j=="boolean"?z[X]=j:z[X]=j.clone(),!0;{const G=z[X];if(typeof j=="number"||typeof j=="boolean"){if(G!==j)return z[X]=j,!0}else if(G.equals(j)===!1)return G.copy(j),!0}return!1}function S(R){const D=R.uniforms;let I=0;const z=16;for(let X=0,G=D.length;X<G;X++){const L=Array.isArray(D[X])?D[X]:[D[X]];for(let k=0,U=L.length;k<U;k++){const q=L[k],W=Array.isArray(q.value)?q.value:[q.value];for(let J=0,ce=W.length;J<ce;J++){const K=W[J],ne=T(K),pe=I%z,Re=pe%ne.boundary,Te=pe+Re;I+=Re,Te!==0&&z-Te<ne.storage&&(I+=z-Te),q.__data=new Float32Array(ne.storage/Float32Array.BYTES_PER_ELEMENT),q.__offset=I,I+=ne.storage}}}const j=I%z;return j>0&&(I+=z-j),R.__size=I,R.__cache={},this}function T(R){const D={boundary:0,storage:0};return typeof R=="number"||typeof R=="boolean"?(D.boundary=4,D.storage=4):R.isVector2?(D.boundary=8,D.storage=8):R.isVector3||R.isColor?(D.boundary=16,D.storage=12):R.isVector4?(D.boundary=16,D.storage=16):R.isMatrix3?(D.boundary=48,D.storage=48):R.isMatrix4?(D.boundary=64,D.storage=64):R.isTexture?Mn("WebGLRenderer: Texture samplers can not be part of an uniforms group."):Mn("WebGLRenderer: Unsupported uniform value type.",R),D}function A(R){const D=R.target;D.removeEventListener("dispose",A);const I=l.indexOf(D.__bindingPointIndex);l.splice(I,1),i.deleteBuffer(r[D.id]),delete r[D.id],delete s[D.id]}function w(){for(const R in r)i.deleteBuffer(r[R]);l=[],r={},s={}}return{bind:f,update:d,dispose:w}}const Lk=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let Tf=null;function Pk(){return Tf===null&&(Tf=new su(Lk,16,16,Ep,Ks),Tf.name="DFG_LUT",Tf.minFilter=ar,Tf.magFilter=ar,Tf.wrapS=Js,Tf.wrapT=Js,Tf.generateMipmaps=!1,Tf.needsUpdate=!0),Tf}class QS{constructor(e={}){const{canvas:t=RT(),context:n=null,depth:r=!0,stencil:s=!1,alpha:l=!1,antialias:c=!1,premultipliedAlpha:f=!0,preserveDrawingBuffer:d=!1,powerPreference:m="default",failIfMajorPerformanceCaveat:g=!1,reversedDepthBuffer:y=!1,outputBufferType:v=$a}=e;this.isWebGLRenderer=!0;let S;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");S=n.getContextAttributes().alpha}else S=l;const T=v,A=new Set([Fy,Uy,h1]),w=new Set([$a,Ec,a0,o0,Oy,By]),R=new Uint32Array(4),D=new Int32Array(4);let I=null,z=null;const j=[],X=[];let G=null;this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=ru,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const L=this;let k=!1;this._outputColorSpace=vo;let U=0,q=0,W=null,J=-1,ce=null;const K=new Yr,ne=new Yr;let pe=null;const Re=new fn(0);let Te=0,ee=t.width,F=t.height,$=1,re=null,Ae=null;const ie=new Yr(0,0,ee,F),_e=new Yr(0,0,ee,F);let ke=!1;const Fe=new _0;let We=!1,nt=!1;const It=new ui,wt=new Ee,Je=new Yr,le={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Qe=!1;function Et(){return W===null?$:1}let we=n;function ot(fe,Oe){return t.getContext(fe,Oe)}try{const fe={alpha:!0,depth:r,stencil:s,antialias:c,premultipliedAlpha:f,preserveDrawingBuffer:d,powerPreference:m,failIfMajorPerformanceCaveat:g};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${l1}`),t.addEventListener("webglcontextlost",Dt,!1),t.addEventListener("webglcontextrestored",bn,!1),t.addEventListener("webglcontextcreationerror",dn,!1),we===null){const Oe="webgl2";if(we=ot(Oe,fe),we===null)throw ot(Oe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(fe){throw Hn("WebGLRenderer: "+fe.message),fe}let Ct,ht,xt,he,Q,Be,ue,je,Ye,ft,gt,Lt,un,bt,dt,Ge,xe,Pe,rt,Me,ze,Mt,Rt,se;function Ve(){Ct=new II(we),Ct.init(),Mt=new kE(we,Ct),ht=new MI(we,Ct,e,Mt),xt=new Sk(we,Ct),ht.reversedDepthBuffer&&y&&xt.buffers.depth.setReversed(!0),he=new OI(we),Q=new ok,Be=new wk(we,Ct,xt,Q,ht,Mt,he),ue=new TI(L),je=new PI(L),Ye=new zL(we),Rt=new SI(we,Ye),ft=new DI(we,Ye,he,Rt),gt=new UI(we,ft,Ye,he),rt=new BI(we,ht,Be),Ge=new AI(Q),Lt=new ak(L,ue,je,Ct,ht,Rt,Ge),un=new Nk(L,Q),bt=new ck,dt=new mk(Ct),Pe=new _I(L,ue,je,xt,gt,S,f),xe=new bk(L,gt,ht),se=new Rk(we,he,ht,xt),Me=new wI(we,Ct,he),ze=new kI(we,Ct,he),he.programs=Lt.programs,L.capabilities=ht,L.extensions=Ct,L.properties=Q,L.renderLists=bt,L.shadowMap=xe,L.state=xt,L.info=he}Ve(),T!==$a&&(G=new zI(T,t.width,t.height,r,s));const vt=new Ek(L,we);this.xr=vt,this.getContext=function(){return we},this.getContextAttributes=function(){return we.getContextAttributes()},this.forceContextLoss=function(){const fe=Ct.get("WEBGL_lose_context");fe&&fe.loseContext()},this.forceContextRestore=function(){const fe=Ct.get("WEBGL_lose_context");fe&&fe.restoreContext()},this.getPixelRatio=function(){return $},this.setPixelRatio=function(fe){fe!==void 0&&($=fe,this.setSize(ee,F,!1))},this.getSize=function(fe){return fe.set(ee,F)},this.setSize=function(fe,Oe,$e=!0){if(vt.isPresenting){Mn("WebGLRenderer: Can't change size while VR device is presenting.");return}ee=fe,F=Oe,t.width=Math.floor(fe*$),t.height=Math.floor(Oe*$),$e===!0&&(t.style.width=fe+"px",t.style.height=Oe+"px"),G!==null&&G.setSize(t.width,t.height),this.setViewport(0,0,fe,Oe)},this.getDrawingBufferSize=function(fe){return fe.set(ee*$,F*$).floor()},this.setDrawingBufferSize=function(fe,Oe,$e){ee=fe,F=Oe,$=$e,t.width=Math.floor(fe*$e),t.height=Math.floor(Oe*$e),this.setViewport(0,0,fe,Oe)},this.setEffects=function(fe){if(T===$a){console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.");return}if(fe){for(let Oe=0;Oe<fe.length;Oe++)if(fe[Oe].isOutputPass===!0){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}}G.setEffects(fe||[])},this.getCurrentViewport=function(fe){return fe.copy(K)},this.getViewport=function(fe){return fe.copy(ie)},this.setViewport=function(fe,Oe,$e,et){fe.isVector4?ie.set(fe.x,fe.y,fe.z,fe.w):ie.set(fe,Oe,$e,et),xt.viewport(K.copy(ie).multiplyScalar($).round())},this.getScissor=function(fe){return fe.copy(_e)},this.setScissor=function(fe,Oe,$e,et){fe.isVector4?_e.set(fe.x,fe.y,fe.z,fe.w):_e.set(fe,Oe,$e,et),xt.scissor(ne.copy(_e).multiplyScalar($).round())},this.getScissorTest=function(){return ke},this.setScissorTest=function(fe){xt.setScissorTest(ke=fe)},this.setOpaqueSort=function(fe){re=fe},this.setTransparentSort=function(fe){Ae=fe},this.getClearColor=function(fe){return fe.copy(Pe.getClearColor())},this.setClearColor=function(){Pe.setClearColor(...arguments)},this.getClearAlpha=function(){return Pe.getClearAlpha()},this.setClearAlpha=function(){Pe.setClearAlpha(...arguments)},this.clear=function(fe=!0,Oe=!0,$e=!0){let et=0;if(fe){let Ze=!1;if(W!==null){const Vt=W.texture.format;Ze=A.has(Vt)}if(Ze){const Vt=W.texture.type,en=w.has(Vt),Gt=Pe.getClearColor(),vn=Pe.getClearAlpha(),nn=Gt.r,Tn=Gt.g,cn=Gt.b;en?(R[0]=nn,R[1]=Tn,R[2]=cn,R[3]=vn,we.clearBufferuiv(we.COLOR,0,R)):(D[0]=nn,D[1]=Tn,D[2]=cn,D[3]=vn,we.clearBufferiv(we.COLOR,0,D))}else et|=we.COLOR_BUFFER_BIT}Oe&&(et|=we.DEPTH_BUFFER_BIT),$e&&(et|=we.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),we.clear(et)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Dt,!1),t.removeEventListener("webglcontextrestored",bn,!1),t.removeEventListener("webglcontextcreationerror",dn,!1),Pe.dispose(),bt.dispose(),dt.dispose(),Q.dispose(),ue.dispose(),je.dispose(),gt.dispose(),Rt.dispose(),se.dispose(),Lt.dispose(),vt.dispose(),vt.removeEventListener("sessionstart",ii),vt.removeEventListener("sessionend",wi),Rn.stop()};function Dt(fe){fe.preventDefault(),Xg("WebGLRenderer: Context Lost."),k=!0}function bn(){Xg("WebGLRenderer: Context Restored."),k=!1;const fe=he.autoReset,Oe=xe.enabled,$e=xe.autoUpdate,et=xe.needsUpdate,Ze=xe.type;Ve(),he.autoReset=fe,xe.enabled=Oe,xe.autoUpdate=$e,xe.needsUpdate=et,xe.type=Ze}function dn(fe){Hn("WebGLRenderer: A WebGL context could not be created. Reason: ",fe.statusMessage)}function tn(fe){const Oe=fe.target;Oe.removeEventListener("dispose",tn),gn(Oe)}function gn(fe){Pn(fe),Q.remove(fe)}function Pn(fe){const Oe=Q.get(fe).programs;Oe!==void 0&&(Oe.forEach(function($e){Lt.releaseProgram($e)}),fe.isShaderMaterial&&Lt.releaseShaderCache(fe))}this.renderBufferDirect=function(fe,Oe,$e,et,Ze,Vt){Oe===null&&(Oe=le);const en=Ze.isMesh&&Ze.matrixWorld.determinant()<0,Gt=Xt(fe,Oe,$e,et,Ze);xt.setMaterial(et,en);let vn=$e.index,nn=1;if(et.wireframe===!0){if(vn=ft.getWireframeAttribute($e),vn===void 0)return;nn=2}const Tn=$e.drawRange,cn=$e.attributes.position;let hn=Tn.start*nn,si=(Tn.start+Tn.count)*nn;Vt!==null&&(hn=Math.max(hn,Vt.start*nn),si=Math.min(si,(Vt.start+Vt.count)*nn)),vn!==null?(hn=Math.max(hn,0),si=Math.min(si,vn.count)):cn!=null&&(hn=Math.max(hn,0),si=Math.min(si,cn.count));const pi=si-hn;if(pi<0||pi===1/0)return;Rt.setup(Ze,et,Gt,$e,vn);let ai,Sn=Me;if(vn!==null&&(ai=Ye.get(vn),Sn=ze,Sn.setIndex(ai)),Ze.isMesh)et.wireframe===!0?(xt.setLineWidth(et.wireframeLinewidth*Et()),Sn.setMode(we.LINES)):Sn.setMode(we.TRIANGLES);else if(Ze.isLine){let Jt=et.linewidth;Jt===void 0&&(Jt=1),xt.setLineWidth(Jt*Et()),Ze.isLineSegments?Sn.setMode(we.LINES):Ze.isLineLoop?Sn.setMode(we.LINE_LOOP):Sn.setMode(we.LINE_STRIP)}else Ze.isPoints?Sn.setMode(we.POINTS):Ze.isSprite&&Sn.setMode(we.TRIANGLES);if(Ze.isBatchedMesh)if(Ze._multiDrawInstances!==null)c0("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Sn.renderMultiDrawInstances(Ze._multiDrawStarts,Ze._multiDrawCounts,Ze._multiDrawCount,Ze._multiDrawInstances);else if(Ct.get("WEBGL_multi_draw"))Sn.renderMultiDraw(Ze._multiDrawStarts,Ze._multiDrawCounts,Ze._multiDrawCount);else{const Jt=Ze._multiDrawStarts,_n=Ze._multiDrawCounts,mn=Ze._multiDrawCount,Ui=vn?Ye.get(vn).bytesPerElement:1,ss=Q.get(et).currentProgram.getUniforms();for(let mi=0;mi<mn;mi++)ss.setValue(we,"_gl_DrawID",mi),Sn.render(Jt[mi]/Ui,_n[mi])}else if(Ze.isInstancedMesh)Sn.renderInstances(hn,pi,Ze.count);else if($e.isInstancedBufferGeometry){const Jt=$e._maxInstanceCount!==void 0?$e._maxInstanceCount:1/0,_n=Math.min($e.instanceCount,Jt);Sn.renderInstances(hn,pi,_n)}else Sn.render(hn,pi)};function Bi(fe,Oe,$e){fe.transparent===!0&&fe.side===Es&&fe.forceSinglePass===!1?(fe.side=cl,fe.needsUpdate=!0,lt(fe,Oe,$e),fe.side=_h,fe.needsUpdate=!0,lt(fe,Oe,$e),fe.side=Es):lt(fe,Oe,$e)}this.compile=function(fe,Oe,$e=null){$e===null&&($e=fe),z=dt.get($e),z.init(Oe),X.push(z),$e.traverseVisible(function(Ze){Ze.isLight&&Ze.layers.test(Oe.layers)&&(z.pushLight(Ze),Ze.castShadow&&z.pushShadow(Ze))}),fe!==$e&&fe.traverseVisible(function(Ze){Ze.isLight&&Ze.layers.test(Oe.layers)&&(z.pushLight(Ze),Ze.castShadow&&z.pushShadow(Ze))}),z.setupLights();const et=new Set;return fe.traverse(function(Ze){if(!(Ze.isMesh||Ze.isPoints||Ze.isLine||Ze.isSprite))return;const Vt=Ze.material;if(Vt)if(Array.isArray(Vt))for(let en=0;en<Vt.length;en++){const Gt=Vt[en];Bi(Gt,$e,Ze),et.add(Gt)}else Bi(Vt,$e,Ze),et.add(Vt)}),z=X.pop(),et},this.compileAsync=function(fe,Oe,$e=null){const et=this.compile(fe,Oe,$e);return new Promise(Ze=>{function Vt(){if(et.forEach(function(en){Q.get(en).currentProgram.isReady()&&et.delete(en)}),et.size===0){Ze(fe);return}setTimeout(Vt,10)}Ct.get("KHR_parallel_shader_compile")!==null?Vt():setTimeout(Vt,10)})};let xi=null;function $n(fe){xi&&xi(fe)}function ii(){Rn.stop()}function wi(){Rn.start()}const Rn=new RE;Rn.setAnimationLoop($n),typeof self<"u"&&Rn.setContext(self),this.setAnimationLoop=function(fe){xi=fe,vt.setAnimationLoop(fe),fe===null?Rn.stop():Rn.start()},vt.addEventListener("sessionstart",ii),vt.addEventListener("sessionend",wi),this.render=function(fe,Oe){if(Oe!==void 0&&Oe.isCamera!==!0){Hn("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(k===!0)return;const $e=vt.enabled===!0&&vt.isPresenting===!0,et=G!==null&&(W===null||$e)&&G.begin(L,W);if(fe.matrixWorldAutoUpdate===!0&&fe.updateMatrixWorld(),Oe.parent===null&&Oe.matrixWorldAutoUpdate===!0&&Oe.updateMatrixWorld(),vt.enabled===!0&&vt.isPresenting===!0&&(G===null||G.isCompositing()===!1)&&(vt.cameraAutoUpdate===!0&&vt.updateCamera(Oe),Oe=vt.getCamera()),fe.isScene===!0&&fe.onBeforeRender(L,fe,Oe,W),z=dt.get(fe,X.length),z.init(Oe),X.push(z),It.multiplyMatrices(Oe.projectionMatrix,Oe.matrixWorldInverse),Fe.setFromProjectionMatrix(It,wc,Oe.reversedDepth),nt=this.localClippingEnabled,We=Ge.init(this.clippingPlanes,nt),I=bt.get(fe,j.length),I.init(),j.push(I),vt.enabled===!0&&vt.isPresenting===!0){const en=L.xr.getDepthSensingMesh();en!==null&&ir(en,Oe,-1/0,L.sortObjects)}ir(fe,Oe,0,L.sortObjects),I.finish(),L.sortObjects===!0&&I.sort(re,Ae),Qe=vt.enabled===!1||vt.isPresenting===!1||vt.hasDepthSensing()===!1,Qe&&Pe.addToRenderList(I,fe),this.info.render.frame++,We===!0&&Ge.beginShadows();const Ze=z.state.shadowsArray;if(xe.render(Ze,fe,Oe),We===!0&&Ge.endShadows(),this.info.autoReset===!0&&this.info.reset(),(et&&G.hasRenderPass())===!1){const en=I.opaque,Gt=I.transmissive;if(z.setupLights(),Oe.isArrayCamera){const vn=Oe.cameras;if(Gt.length>0)for(let nn=0,Tn=vn.length;nn<Tn;nn++){const cn=vn[nn];te(en,Gt,fe,cn)}Qe&&Pe.render(fe);for(let nn=0,Tn=vn.length;nn<Tn;nn++){const cn=vn[nn];Mi(I,fe,cn,cn.viewport)}}else Gt.length>0&&te(en,Gt,fe,Oe),Qe&&Pe.render(fe),Mi(I,fe,Oe)}W!==null&&q===0&&(Be.updateMultisampleRenderTarget(W),Be.updateRenderTargetMipmap(W)),et&&G.end(L),fe.isScene===!0&&fe.onAfterRender(L,fe,Oe),Rt.resetDefaultState(),J=-1,ce=null,X.pop(),X.length>0?(z=X[X.length-1],We===!0&&Ge.setGlobalState(L.clippingPlanes,z.state.camera)):z=null,j.pop(),j.length>0?I=j[j.length-1]:I=null};function ir(fe,Oe,$e,et){if(fe.visible===!1)return;if(fe.layers.test(Oe.layers)){if(fe.isGroup)$e=fe.renderOrder;else if(fe.isLOD)fe.autoUpdate===!0&&fe.update(Oe);else if(fe.isLight)z.pushLight(fe),fe.castShadow&&z.pushShadow(fe);else if(fe.isSprite){if(!fe.frustumCulled||Fe.intersectsSprite(fe)){et&&Je.setFromMatrixPosition(fe.matrixWorld).applyMatrix4(It);const en=gt.update(fe),Gt=fe.material;Gt.visible&&I.push(fe,en,Gt,$e,Je.z,null)}}else if((fe.isMesh||fe.isLine||fe.isPoints)&&(!fe.frustumCulled||Fe.intersectsObject(fe))){const en=gt.update(fe),Gt=fe.material;if(et&&(fe.boundingSphere!==void 0?(fe.boundingSphere===null&&fe.computeBoundingSphere(),Je.copy(fe.boundingSphere.center)):(en.boundingSphere===null&&en.computeBoundingSphere(),Je.copy(en.boundingSphere.center)),Je.applyMatrix4(fe.matrixWorld).applyMatrix4(It)),Array.isArray(Gt)){const vn=en.groups;for(let nn=0,Tn=vn.length;nn<Tn;nn++){const cn=vn[nn],hn=Gt[cn.materialIndex];hn&&hn.visible&&I.push(fe,en,hn,$e,Je.z,cn)}}else Gt.visible&&I.push(fe,en,Gt,$e,Je.z,null)}}const Vt=fe.children;for(let en=0,Gt=Vt.length;en<Gt;en++)ir(Vt[en],Oe,$e,et)}function Mi(fe,Oe,$e,et){const{opaque:Ze,transmissive:Vt,transparent:en}=fe;z.setupLightsView($e),We===!0&&Ge.setGlobalState(L.clippingPlanes,$e),et&&xt.viewport(K.copy(et)),Ze.length>0&&be(Ze,Oe,$e),Vt.length>0&&be(Vt,Oe,$e),en.length>0&&be(en,Oe,$e),xt.buffers.depth.setTest(!0),xt.buffers.depth.setMask(!0),xt.buffers.color.setMask(!0),xt.setPolygonOffset(!1)}function te(fe,Oe,$e,et){if(($e.isScene===!0?$e.overrideMaterial:null)!==null)return;if(z.state.transmissionRenderTarget[et.id]===void 0){const hn=Ct.has("EXT_color_buffer_half_float")||Ct.has("EXT_color_buffer_float");z.state.transmissionRenderTarget[et.id]=new ul(1,1,{generateMipmaps:!0,type:hn?Ks:$a,minFilter:Rf,samples:ht.samples,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:nr.workingColorSpace})}const Vt=z.state.transmissionRenderTarget[et.id],en=et.viewport||K;Vt.setSize(en.z*L.transmissionResolutionScale,en.w*L.transmissionResolutionScale);const Gt=L.getRenderTarget(),vn=L.getActiveCubeFace(),nn=L.getActiveMipmapLevel();L.setRenderTarget(Vt),L.getClearColor(Re),Te=L.getClearAlpha(),Te<1&&L.setClearColor(16777215,.5),L.clear(),Qe&&Pe.render($e);const Tn=L.toneMapping;L.toneMapping=ru;const cn=et.viewport;if(et.viewport!==void 0&&(et.viewport=void 0),z.setupLightsView(et),We===!0&&Ge.setGlobalState(L.clippingPlanes,et),be(fe,$e,et),Be.updateMultisampleRenderTarget(Vt),Be.updateRenderTargetMipmap(Vt),Ct.has("WEBGL_multisampled_render_to_texture")===!1){let hn=!1;for(let si=0,pi=Oe.length;si<pi;si++){const ai=Oe[si],{object:Sn,geometry:Jt,material:_n,group:mn}=ai;if(_n.side===Es&&Sn.layers.test(et.layers)){const Ui=_n.side;_n.side=cl,_n.needsUpdate=!0,Ue(Sn,$e,et,Jt,_n,mn),_n.side=Ui,_n.needsUpdate=!0,hn=!0}}hn===!0&&(Be.updateMultisampleRenderTarget(Vt),Be.updateRenderTargetMipmap(Vt))}L.setRenderTarget(Gt,vn,nn),L.setClearColor(Re,Te),cn!==void 0&&(et.viewport=cn),L.toneMapping=Tn}function be(fe,Oe,$e){const et=Oe.isScene===!0?Oe.overrideMaterial:null;for(let Ze=0,Vt=fe.length;Ze<Vt;Ze++){const en=fe[Ze],{object:Gt,geometry:vn,group:nn}=en;let Tn=en.material;Tn.allowOverride===!0&&et!==null&&(Tn=et),Gt.layers.test($e.layers)&&Ue(Gt,Oe,$e,vn,Tn,nn)}}function Ue(fe,Oe,$e,et,Ze,Vt){fe.onBeforeRender(L,Oe,$e,et,Ze,Vt),fe.modelViewMatrix.multiplyMatrices($e.matrixWorldInverse,fe.matrixWorld),fe.normalMatrix.getNormalMatrix(fe.modelViewMatrix),Ze.onBeforeRender(L,Oe,$e,et,fe,Vt),Ze.transparent===!0&&Ze.side===Es&&Ze.forceSinglePass===!1?(Ze.side=cl,Ze.needsUpdate=!0,L.renderBufferDirect($e,Oe,et,Ze,fe,Vt),Ze.side=_h,Ze.needsUpdate=!0,L.renderBufferDirect($e,Oe,et,Ze,fe,Vt),Ze.side=Es):L.renderBufferDirect($e,Oe,et,Ze,fe,Vt),fe.onAfterRender(L,Oe,$e,et,Ze,Vt)}function lt(fe,Oe,$e){Oe.isScene!==!0&&(Oe=le);const et=Q.get(fe),Ze=z.state.lights,Vt=z.state.shadowsArray,en=Ze.state.version,Gt=Lt.getParameters(fe,Ze.state,Vt,Oe,$e),vn=Lt.getProgramCacheKey(Gt);let nn=et.programs;et.environment=fe.isMeshStandardMaterial?Oe.environment:null,et.fog=Oe.fog,et.envMap=(fe.isMeshStandardMaterial?je:ue).get(fe.envMap||et.environment),et.envMapRotation=et.environment!==null&&fe.envMap===null?Oe.environmentRotation:fe.envMapRotation,nn===void 0&&(fe.addEventListener("dispose",tn),nn=new Map,et.programs=nn);let Tn=nn.get(vn);if(Tn!==void 0){if(et.currentProgram===Tn&&et.lightsStateVersion===en)return St(fe,Gt),Tn}else Gt.uniforms=Lt.getUniforms(fe),fe.onBeforeCompile(Gt,L),Tn=Lt.acquireProgram(Gt,vn),nn.set(vn,Tn),et.uniforms=Gt.uniforms;const cn=et.uniforms;return(!fe.isShaderMaterial&&!fe.isRawShaderMaterial||fe.clipping===!0)&&(cn.clippingPlanes=Ge.uniform),St(fe,Gt),et.needsLights=an(fe),et.lightsStateVersion=en,et.needsLights&&(cn.ambientLightColor.value=Ze.state.ambient,cn.lightProbe.value=Ze.state.probe,cn.directionalLights.value=Ze.state.directional,cn.directionalLightShadows.value=Ze.state.directionalShadow,cn.spotLights.value=Ze.state.spot,cn.spotLightShadows.value=Ze.state.spotShadow,cn.rectAreaLights.value=Ze.state.rectArea,cn.ltc_1.value=Ze.state.rectAreaLTC1,cn.ltc_2.value=Ze.state.rectAreaLTC2,cn.pointLights.value=Ze.state.point,cn.pointLightShadows.value=Ze.state.pointShadow,cn.hemisphereLights.value=Ze.state.hemi,cn.directionalShadowMap.value=Ze.state.directionalShadowMap,cn.directionalShadowMatrix.value=Ze.state.directionalShadowMatrix,cn.spotShadowMap.value=Ze.state.spotShadowMap,cn.spotLightMatrix.value=Ze.state.spotLightMatrix,cn.spotLightMap.value=Ze.state.spotLightMap,cn.pointShadowMap.value=Ze.state.pointShadowMap,cn.pointShadowMatrix.value=Ze.state.pointShadowMatrix),et.currentProgram=Tn,et.uniformsList=null,Tn}function Tt(fe){if(fe.uniformsList===null){const Oe=fe.currentProgram.getUniforms();fe.uniformsList=_x.seqWithValue(Oe.seq,fe.uniforms)}return fe.uniformsList}function St(fe,Oe){const $e=Q.get(fe);$e.outputColorSpace=Oe.outputColorSpace,$e.batching=Oe.batching,$e.batchingColor=Oe.batchingColor,$e.instancing=Oe.instancing,$e.instancingColor=Oe.instancingColor,$e.instancingMorph=Oe.instancingMorph,$e.skinning=Oe.skinning,$e.morphTargets=Oe.morphTargets,$e.morphNormals=Oe.morphNormals,$e.morphColors=Oe.morphColors,$e.morphTargetsCount=Oe.morphTargetsCount,$e.numClippingPlanes=Oe.numClippingPlanes,$e.numIntersection=Oe.numClipIntersection,$e.vertexAlphas=Oe.vertexAlphas,$e.vertexTangents=Oe.vertexTangents,$e.toneMapping=Oe.toneMapping}function Xt(fe,Oe,$e,et,Ze){Oe.isScene!==!0&&(Oe=le),Be.resetTextureUnits();const Vt=Oe.fog,en=et.isMeshStandardMaterial?Oe.environment:null,Gt=W===null?L.outputColorSpace:W.isXRRenderTarget===!0?W.texture.colorSpace:Uu,vn=(et.isMeshStandardMaterial?je:ue).get(et.envMap||en),nn=et.vertexColors===!0&&!!$e.attributes.color&&$e.attributes.color.itemSize===4,Tn=!!$e.attributes.tangent&&(!!et.normalMap||et.anisotropy>0),cn=!!$e.morphAttributes.position,hn=!!$e.morphAttributes.normal,si=!!$e.morphAttributes.color;let pi=ru;et.toneMapped&&(W===null||W.isXRRenderTarget===!0)&&(pi=L.toneMapping);const ai=$e.morphAttributes.position||$e.morphAttributes.normal||$e.morphAttributes.color,Sn=ai!==void 0?ai.length:0,Jt=Q.get(et),_n=z.state.lights;if(We===!0&&(nt===!0||fe!==ce)){const Pr=fe===ce&&et.id===J;Ge.setState(et,fe,Pr)}let mn=!1;et.version===Jt.__version?(Jt.needsLights&&Jt.lightsStateVersion!==_n.state.version||Jt.outputColorSpace!==Gt||Ze.isBatchedMesh&&Jt.batching===!1||!Ze.isBatchedMesh&&Jt.batching===!0||Ze.isBatchedMesh&&Jt.batchingColor===!0&&Ze.colorTexture===null||Ze.isBatchedMesh&&Jt.batchingColor===!1&&Ze.colorTexture!==null||Ze.isInstancedMesh&&Jt.instancing===!1||!Ze.isInstancedMesh&&Jt.instancing===!0||Ze.isSkinnedMesh&&Jt.skinning===!1||!Ze.isSkinnedMesh&&Jt.skinning===!0||Ze.isInstancedMesh&&Jt.instancingColor===!0&&Ze.instanceColor===null||Ze.isInstancedMesh&&Jt.instancingColor===!1&&Ze.instanceColor!==null||Ze.isInstancedMesh&&Jt.instancingMorph===!0&&Ze.morphTexture===null||Ze.isInstancedMesh&&Jt.instancingMorph===!1&&Ze.morphTexture!==null||Jt.envMap!==vn||et.fog===!0&&Jt.fog!==Vt||Jt.numClippingPlanes!==void 0&&(Jt.numClippingPlanes!==Ge.numPlanes||Jt.numIntersection!==Ge.numIntersection)||Jt.vertexAlphas!==nn||Jt.vertexTangents!==Tn||Jt.morphTargets!==cn||Jt.morphNormals!==hn||Jt.morphColors!==si||Jt.toneMapping!==pi||Jt.morphTargetsCount!==Sn)&&(mn=!0):(mn=!0,Jt.__version=et.version);let Ui=Jt.currentProgram;mn===!0&&(Ui=lt(et,Oe,Ze));let ss=!1,mi=!1,Yi=!1;const Xi=Ui.getUniforms(),Zr=Jt.uniforms;if(xt.useProgram(Ui.program)&&(ss=!0,mi=!0,Yi=!0),et.id!==J&&(J=et.id,mi=!0),ss||ce!==fe){xt.buffers.depth.getReversed()&&fe.reversedDepth!==!0&&(fe._reversedDepth=!0,fe.updateProjectionMatrix()),Xi.setValue(we,"projectionMatrix",fe.projectionMatrix),Xi.setValue(we,"viewMatrix",fe.matrixWorldInverse);const gs=Xi.map.cameraPosition;gs!==void 0&&gs.setValue(we,wt.setFromMatrixPosition(fe.matrixWorld)),ht.logarithmicDepthBuffer&&Xi.setValue(we,"logDepthBufFC",2/(Math.log(fe.far+1)/Math.LN2)),(et.isMeshPhongMaterial||et.isMeshToonMaterial||et.isMeshLambertMaterial||et.isMeshBasicMaterial||et.isMeshStandardMaterial||et.isShaderMaterial)&&Xi.setValue(we,"isOrthographic",fe.isOrthographicCamera===!0),ce!==fe&&(ce=fe,mi=!0,Yi=!0)}if(Jt.needsLights&&(_n.state.directionalShadowMap.length>0&&Xi.setValue(we,"directionalShadowMap",_n.state.directionalShadowMap,Be),_n.state.spotShadowMap.length>0&&Xi.setValue(we,"spotShadowMap",_n.state.spotShadowMap,Be),_n.state.pointShadowMap.length>0&&Xi.setValue(we,"pointShadowMap",_n.state.pointShadowMap,Be)),Ze.isSkinnedMesh){Xi.setOptional(we,Ze,"bindMatrix"),Xi.setOptional(we,Ze,"bindMatrixInverse");const Pr=Ze.skeleton;Pr&&(Pr.boneTexture===null&&Pr.computeBoneTexture(),Xi.setValue(we,"boneTexture",Pr.boneTexture,Be))}Ze.isBatchedMesh&&(Xi.setOptional(we,Ze,"batchingTexture"),Xi.setValue(we,"batchingTexture",Ze._matricesTexture,Be),Xi.setOptional(we,Ze,"batchingIdTexture"),Xi.setValue(we,"batchingIdTexture",Ze._indirectTexture,Be),Xi.setOptional(we,Ze,"batchingColorTexture"),Ze._colorsTexture!==null&&Xi.setValue(we,"batchingColorTexture",Ze._colorsTexture,Be));const Tr=$e.morphAttributes;if((Tr.position!==void 0||Tr.normal!==void 0||Tr.color!==void 0)&&rt.update(Ze,$e,Ui),(mi||Jt.receiveShadow!==Ze.receiveShadow)&&(Jt.receiveShadow=Ze.receiveShadow,Xi.setValue(we,"receiveShadow",Ze.receiveShadow)),et.isMeshGouraudMaterial&&et.envMap!==null&&(Zr.envMap.value=vn,Zr.flipEnvMap.value=vn.isCubeTexture&&vn.isRenderTargetTexture===!1?-1:1),et.isMeshStandardMaterial&&et.envMap===null&&Oe.environment!==null&&(Zr.envMapIntensity.value=Oe.environmentIntensity),Zr.dfgLUT!==void 0&&(Zr.dfgLUT.value=Pk()),mi&&(Xi.setValue(we,"toneMappingExposure",L.toneMappingExposure),Jt.needsLights&&qt(Zr,Yi),Vt&&et.fog===!0&&un.refreshFogUniforms(Zr,Vt),un.refreshMaterialUniforms(Zr,et,$,F,z.state.transmissionRenderTarget[fe.id]),_x.upload(we,Tt(Jt),Zr,Be)),et.isShaderMaterial&&et.uniformsNeedUpdate===!0&&(_x.upload(we,Tt(Jt),Zr,Be),et.uniformsNeedUpdate=!1),et.isSpriteMaterial&&Xi.setValue(we,"center",Ze.center),Xi.setValue(we,"modelViewMatrix",Ze.modelViewMatrix),Xi.setValue(we,"normalMatrix",Ze.normalMatrix),Xi.setValue(we,"modelMatrix",Ze.matrixWorld),et.isShaderMaterial||et.isRawShaderMaterial){const Pr=et.uniformsGroups;for(let gs=0,Zl=Pr.length;gs<Zl;gs++){const Oa=Pr[gs];se.update(Oa,Ui),se.bind(Oa,Ui)}}return Ui}function qt(fe,Oe){fe.ambientLightColor.needsUpdate=Oe,fe.lightProbe.needsUpdate=Oe,fe.directionalLights.needsUpdate=Oe,fe.directionalLightShadows.needsUpdate=Oe,fe.pointLights.needsUpdate=Oe,fe.pointLightShadows.needsUpdate=Oe,fe.spotLights.needsUpdate=Oe,fe.spotLightShadows.needsUpdate=Oe,fe.rectAreaLights.needsUpdate=Oe,fe.hemisphereLights.needsUpdate=Oe}function an(fe){return fe.isMeshLambertMaterial||fe.isMeshToonMaterial||fe.isMeshPhongMaterial||fe.isMeshStandardMaterial||fe.isShadowMaterial||fe.isShaderMaterial&&fe.lights===!0}this.getActiveCubeFace=function(){return U},this.getActiveMipmapLevel=function(){return q},this.getRenderTarget=function(){return W},this.setRenderTargetTextures=function(fe,Oe,$e){const et=Q.get(fe);et.__autoAllocateDepthBuffer=fe.resolveDepthBuffer===!1,et.__autoAllocateDepthBuffer===!1&&(et.__useRenderToTexture=!1),Q.get(fe.texture).__webglTexture=Oe,Q.get(fe.depthTexture).__webglTexture=et.__autoAllocateDepthBuffer?void 0:$e,et.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(fe,Oe){const $e=Q.get(fe);$e.__webglFramebuffer=Oe,$e.__useDefaultFramebuffer=Oe===void 0};const sn=we.createFramebuffer();this.setRenderTarget=function(fe,Oe=0,$e=0){W=fe,U=Oe,q=$e;let et=null,Ze=!1,Vt=!1;if(fe){const Gt=Q.get(fe);if(Gt.__useDefaultFramebuffer!==void 0){xt.bindFramebuffer(we.FRAMEBUFFER,Gt.__webglFramebuffer),K.copy(fe.viewport),ne.copy(fe.scissor),pe=fe.scissorTest,xt.viewport(K),xt.scissor(ne),xt.setScissorTest(pe),J=-1;return}else if(Gt.__webglFramebuffer===void 0)Be.setupRenderTarget(fe);else if(Gt.__hasExternalTextures)Be.rebindTextures(fe,Q.get(fe.texture).__webglTexture,Q.get(fe.depthTexture).__webglTexture);else if(fe.depthBuffer){const Tn=fe.depthTexture;if(Gt.__boundDepthTexture!==Tn){if(Tn!==null&&Q.has(Tn)&&(fe.width!==Tn.image.width||fe.height!==Tn.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");Be.setupDepthRenderbuffer(fe)}}const vn=fe.texture;(vn.isData3DTexture||vn.isDataArrayTexture||vn.isCompressedArrayTexture)&&(Vt=!0);const nn=Q.get(fe).__webglFramebuffer;fe.isWebGLCubeRenderTarget?(Array.isArray(nn[Oe])?et=nn[Oe][$e]:et=nn[Oe],Ze=!0):fe.samples>0&&Be.useMultisampledRTT(fe)===!1?et=Q.get(fe).__webglMultisampledFramebuffer:Array.isArray(nn)?et=nn[$e]:et=nn,K.copy(fe.viewport),ne.copy(fe.scissor),pe=fe.scissorTest}else K.copy(ie).multiplyScalar($).floor(),ne.copy(_e).multiplyScalar($).floor(),pe=ke;if($e!==0&&(et=sn),xt.bindFramebuffer(we.FRAMEBUFFER,et)&&xt.drawBuffers(fe,et),xt.viewport(K),xt.scissor(ne),xt.setScissorTest(pe),Ze){const Gt=Q.get(fe.texture);we.framebufferTexture2D(we.FRAMEBUFFER,we.COLOR_ATTACHMENT0,we.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,Gt.__webglTexture,$e)}else if(Vt){const Gt=Oe;for(let vn=0;vn<fe.textures.length;vn++){const nn=Q.get(fe.textures[vn]);we.framebufferTextureLayer(we.FRAMEBUFFER,we.COLOR_ATTACHMENT0+vn,nn.__webglTexture,$e,Gt)}}else if(fe!==null&&$e!==0){const Gt=Q.get(fe.texture);we.framebufferTexture2D(we.FRAMEBUFFER,we.COLOR_ATTACHMENT0,we.TEXTURE_2D,Gt.__webglTexture,$e)}J=-1},this.readRenderTargetPixels=function(fe,Oe,$e,et,Ze,Vt,en,Gt=0){if(!(fe&&fe.isWebGLRenderTarget)){Hn("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let vn=Q.get(fe).__webglFramebuffer;if(fe.isWebGLCubeRenderTarget&&en!==void 0&&(vn=vn[en]),vn){xt.bindFramebuffer(we.FRAMEBUFFER,vn);try{const nn=fe.textures[Gt],Tn=nn.format,cn=nn.type;if(!ht.textureFormatReadable(Tn)){Hn("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!ht.textureTypeReadable(cn)){Hn("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Oe>=0&&Oe<=fe.width-et&&$e>=0&&$e<=fe.height-Ze&&(fe.textures.length>1&&we.readBuffer(we.COLOR_ATTACHMENT0+Gt),we.readPixels(Oe,$e,et,Ze,Mt.convert(Tn),Mt.convert(cn),Vt))}finally{const nn=W!==null?Q.get(W).__webglFramebuffer:null;xt.bindFramebuffer(we.FRAMEBUFFER,nn)}}},this.readRenderTargetPixelsAsync=async function(fe,Oe,$e,et,Ze,Vt,en,Gt=0){if(!(fe&&fe.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let vn=Q.get(fe).__webglFramebuffer;if(fe.isWebGLCubeRenderTarget&&en!==void 0&&(vn=vn[en]),vn)if(Oe>=0&&Oe<=fe.width-et&&$e>=0&&$e<=fe.height-Ze){xt.bindFramebuffer(we.FRAMEBUFFER,vn);const nn=fe.textures[Gt],Tn=nn.format,cn=nn.type;if(!ht.textureFormatReadable(Tn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!ht.textureTypeReadable(cn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const hn=we.createBuffer();we.bindBuffer(we.PIXEL_PACK_BUFFER,hn),we.bufferData(we.PIXEL_PACK_BUFFER,Vt.byteLength,we.STREAM_READ),fe.textures.length>1&&we.readBuffer(we.COLOR_ATTACHMENT0+Gt),we.readPixels(Oe,$e,et,Ze,Mt.convert(Tn),Mt.convert(cn),0);const si=W!==null?Q.get(W).__webglFramebuffer:null;xt.bindFramebuffer(we.FRAMEBUFFER,si);const pi=we.fenceSync(we.SYNC_GPU_COMMANDS_COMPLETE,0);return we.flush(),await qN(we,pi,4),we.bindBuffer(we.PIXEL_PACK_BUFFER,hn),we.getBufferSubData(we.PIXEL_PACK_BUFFER,0,Vt),we.deleteBuffer(hn),we.deleteSync(pi),Vt}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(fe,Oe=null,$e=0){const et=Math.pow(2,-$e),Ze=Math.floor(fe.image.width*et),Vt=Math.floor(fe.image.height*et),en=Oe!==null?Oe.x:0,Gt=Oe!==null?Oe.y:0;Be.setTexture2D(fe,0),we.copyTexSubImage2D(we.TEXTURE_2D,$e,0,0,en,Gt,Ze,Vt),xt.unbindTexture()};const ln=we.createFramebuffer(),rn=we.createFramebuffer();this.copyTextureToTexture=function(fe,Oe,$e=null,et=null,Ze=0,Vt=null){Vt===null&&(Ze!==0?(c0("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Vt=Ze,Ze=0):Vt=0);let en,Gt,vn,nn,Tn,cn,hn,si,pi;const ai=fe.isCompressedTexture?fe.mipmaps[Vt]:fe.image;if($e!==null)en=$e.max.x-$e.min.x,Gt=$e.max.y-$e.min.y,vn=$e.isBox3?$e.max.z-$e.min.z:1,nn=$e.min.x,Tn=$e.min.y,cn=$e.isBox3?$e.min.z:0;else{const Tr=Math.pow(2,-Ze);en=Math.floor(ai.width*Tr),Gt=Math.floor(ai.height*Tr),fe.isDataArrayTexture?vn=ai.depth:fe.isData3DTexture?vn=Math.floor(ai.depth*Tr):vn=1,nn=0,Tn=0,cn=0}et!==null?(hn=et.x,si=et.y,pi=et.z):(hn=0,si=0,pi=0);const Sn=Mt.convert(Oe.format),Jt=Mt.convert(Oe.type);let _n;Oe.isData3DTexture?(Be.setTexture3D(Oe,0),_n=we.TEXTURE_3D):Oe.isDataArrayTexture||Oe.isCompressedArrayTexture?(Be.setTexture2DArray(Oe,0),_n=we.TEXTURE_2D_ARRAY):(Be.setTexture2D(Oe,0),_n=we.TEXTURE_2D),we.pixelStorei(we.UNPACK_FLIP_Y_WEBGL,Oe.flipY),we.pixelStorei(we.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Oe.premultiplyAlpha),we.pixelStorei(we.UNPACK_ALIGNMENT,Oe.unpackAlignment);const mn=we.getParameter(we.UNPACK_ROW_LENGTH),Ui=we.getParameter(we.UNPACK_IMAGE_HEIGHT),ss=we.getParameter(we.UNPACK_SKIP_PIXELS),mi=we.getParameter(we.UNPACK_SKIP_ROWS),Yi=we.getParameter(we.UNPACK_SKIP_IMAGES);we.pixelStorei(we.UNPACK_ROW_LENGTH,ai.width),we.pixelStorei(we.UNPACK_IMAGE_HEIGHT,ai.height),we.pixelStorei(we.UNPACK_SKIP_PIXELS,nn),we.pixelStorei(we.UNPACK_SKIP_ROWS,Tn),we.pixelStorei(we.UNPACK_SKIP_IMAGES,cn);const Xi=fe.isDataArrayTexture||fe.isData3DTexture,Zr=Oe.isDataArrayTexture||Oe.isData3DTexture;if(fe.isDepthTexture){const Tr=Q.get(fe),Pr=Q.get(Oe),gs=Q.get(Tr.__renderTarget),Zl=Q.get(Pr.__renderTarget);xt.bindFramebuffer(we.READ_FRAMEBUFFER,gs.__webglFramebuffer),xt.bindFramebuffer(we.DRAW_FRAMEBUFFER,Zl.__webglFramebuffer);for(let Oa=0;Oa<vn;Oa++)Xi&&(we.framebufferTextureLayer(we.READ_FRAMEBUFFER,we.COLOR_ATTACHMENT0,Q.get(fe).__webglTexture,Ze,cn+Oa),we.framebufferTextureLayer(we.DRAW_FRAMEBUFFER,we.COLOR_ATTACHMENT0,Q.get(Oe).__webglTexture,Vt,pi+Oa)),we.blitFramebuffer(nn,Tn,en,Gt,hn,si,en,Gt,we.DEPTH_BUFFER_BIT,we.NEAREST);xt.bindFramebuffer(we.READ_FRAMEBUFFER,null),xt.bindFramebuffer(we.DRAW_FRAMEBUFFER,null)}else if(Ze!==0||fe.isRenderTargetTexture||Q.has(fe)){const Tr=Q.get(fe),Pr=Q.get(Oe);xt.bindFramebuffer(we.READ_FRAMEBUFFER,ln),xt.bindFramebuffer(we.DRAW_FRAMEBUFFER,rn);for(let gs=0;gs<vn;gs++)Xi?we.framebufferTextureLayer(we.READ_FRAMEBUFFER,we.COLOR_ATTACHMENT0,Tr.__webglTexture,Ze,cn+gs):we.framebufferTexture2D(we.READ_FRAMEBUFFER,we.COLOR_ATTACHMENT0,we.TEXTURE_2D,Tr.__webglTexture,Ze),Zr?we.framebufferTextureLayer(we.DRAW_FRAMEBUFFER,we.COLOR_ATTACHMENT0,Pr.__webglTexture,Vt,pi+gs):we.framebufferTexture2D(we.DRAW_FRAMEBUFFER,we.COLOR_ATTACHMENT0,we.TEXTURE_2D,Pr.__webglTexture,Vt),Ze!==0?we.blitFramebuffer(nn,Tn,en,Gt,hn,si,en,Gt,we.COLOR_BUFFER_BIT,we.NEAREST):Zr?we.copyTexSubImage3D(_n,Vt,hn,si,pi+gs,nn,Tn,en,Gt):we.copyTexSubImage2D(_n,Vt,hn,si,nn,Tn,en,Gt);xt.bindFramebuffer(we.READ_FRAMEBUFFER,null),xt.bindFramebuffer(we.DRAW_FRAMEBUFFER,null)}else Zr?fe.isDataTexture||fe.isData3DTexture?we.texSubImage3D(_n,Vt,hn,si,pi,en,Gt,vn,Sn,Jt,ai.data):Oe.isCompressedArrayTexture?we.compressedTexSubImage3D(_n,Vt,hn,si,pi,en,Gt,vn,Sn,ai.data):we.texSubImage3D(_n,Vt,hn,si,pi,en,Gt,vn,Sn,Jt,ai):fe.isDataTexture?we.texSubImage2D(we.TEXTURE_2D,Vt,hn,si,en,Gt,Sn,Jt,ai.data):fe.isCompressedTexture?we.compressedTexSubImage2D(we.TEXTURE_2D,Vt,hn,si,ai.width,ai.height,Sn,ai.data):we.texSubImage2D(we.TEXTURE_2D,Vt,hn,si,en,Gt,Sn,Jt,ai);we.pixelStorei(we.UNPACK_ROW_LENGTH,mn),we.pixelStorei(we.UNPACK_IMAGE_HEIGHT,Ui),we.pixelStorei(we.UNPACK_SKIP_PIXELS,ss),we.pixelStorei(we.UNPACK_SKIP_ROWS,mi),we.pixelStorei(we.UNPACK_SKIP_IMAGES,Yi),Vt===0&&Oe.generateMipmaps&&we.generateMipmap(_n),xt.unbindTexture()},this.initRenderTarget=function(fe){Q.get(fe).__webglFramebuffer===void 0&&Be.setupRenderTarget(fe)},this.initTexture=function(fe){fe.isCubeTexture?Be.setTextureCube(fe,0):fe.isData3DTexture?Be.setTexture3D(fe,0):fe.isDataArrayTexture||fe.isCompressedArrayTexture?Be.setTexture2DArray(fe,0):Be.setTexture2D(fe,0),xt.unbindTexture()},this.resetState=function(){U=0,q=0,W=null,xt.reset(),Rt.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return wc}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=nr._getDrawingBufferColorSpace(e),t.unpackColorSpace=nr._getUnpackColorSpace()}}const Ik=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:Iy,AddEquation:od,AddOperation:mT,AdditiveAnimationBlendMode:wS,AdditiveBlending:A_,AgXToneMapping:gS,AlphaFormat:_S,AlwaysCompare:ET,AlwaysDepth:Ix,AlwaysStencilFunc:R_,AmbientLight:bE,AnimationAction:CE,AnimationClip:Qg,AnimationLoader:I6,AnimationMixer:aL,AnimationObjectGroup:rL,AnimationUtils:N6,ArcCurve:XT,ArrayCamera:AE,ArrowHelper:LL,AttachedBindMode:C_,Audio:TE,AudioAnalyser:Y6,AudioContext:XS,AudioListener:q6,AudioLoader:V6,AxesHelper:PL,BackSide:cl,BasicDepthPacking:bT,BasicShadowMap:ZA,BatchedMesh:jT,Bone:NS,BooleanKeyframeTrack:kp,Box2:mL,Box3:Fo,Box3Helper:NL,BoxGeometry:Dp,BoxHelper:CL,BufferAttribute:zr,BufferGeometry:Si,BufferGeometryLoader:ME,ByteType:Dy,Cache:Lf,Camera:qy,CameraHelper:EL,CanvasTexture:KR,CapsuleGeometry:Qy,CatmullRomCurve3:YT,CineonToneMapping:pS,CircleGeometry:eb,ClampToEdgeWrapping:Js,Clock:YS,Color:fn,ColorKeyframeTrack:HS,ColorManagement:nr,CompressedArrayTexture:$R,CompressedCubeTexture:JR,CompressedTexture:Ky,CompressedTextureLoader:D6,ConeGeometry:g1,ConstantAlphaFactor:hT,ConstantColorFactor:uT,Controls:DL,CubeCamera:kT,CubeDepthTexture:qT,CubeReflectionMapping:Bu,CubeRefractionMapping:md,CubeTexture:d1,CubeTextureLoader:mE,CubeUVReflectionMapping:b0,CubicBezierCurve:IS,CubicBezierCurve3:ZT,CubicInterpolant:fE,CullFaceBack:M_,CullFaceFront:YA,CullFaceFrontBack:nN,CullFaceNone:XA,Curve:zu,CurvePath:JT,CustomBlending:$A,CustomToneMapping:mS,CylinderGeometry:m1,Cylindrical:pL,Data3DTexture:Gy,DataArrayTexture:Hy,DataTexture:su,DataTextureLoader:GS,DataUtils:yp,DecrementStencilOp:yN,DecrementWrapStencilOp:_N,DefaultLoadingManager:pE,DepthFormat:If,DepthStencilFormat:ld,DepthTexture:p0,DetachedBindMode:gT,DirectionalLight:yE,DirectionalLightHelper:TL,DiscreteInterpolant:hE,DodecahedronGeometry:tb,DoubleSide:Es,DstAlphaFactor:sT,DstColorFactor:oT,DynamicCopyUsage:ON,DynamicDrawUsage:RN,DynamicReadUsage:IN,EdgesGeometry:WT,EllipseCurve:nb,EqualCompare:MT,EqualDepth:kx,EqualStencilFunc:AN,EquirectangularReflectionMapping:s0,EquirectangularRefractionMapping:Fg,Euler:Cc,EventDispatcher:Df,ExternalTexture:LS,ExtrudeGeometry:ib,FileLoader:Tc,Float16BufferAttribute:CR,Float32BufferAttribute:kn,FloatType:Cs,Fog:Yy,FogExp2:Xy,FramebufferTexture:ZR,FrontSide:_h,Frustum:_0,FrustumArray:Jy,GLBufferAttribute:fL,GLSL1:UN,GLSL3:L_,GreaterCompare:AT,GreaterDepth:Bx,GreaterEqualCompare:Vy,GreaterEqualDepth:Ox,GreaterEqualStencilFunc:NN,GreaterStencilFunc:EN,GridHelper:ML,Group:Zm,HalfFloatType:Ks,HemisphereLight:gE,HemisphereLightHelper:wL,IcosahedronGeometry:v1,ImageBitmapLoader:j6,ImageLoader:e1,ImageUtils:LT,IncrementStencilOp:xN,IncrementWrapStencilOp:bN,InstancedBufferAttribute:d0,InstancedBufferGeometry:wE,InstancedInterleavedBuffer:uL,InstancedMesh:zT,Int16BufferAttribute:TR,Int32BufferAttribute:ER,Int8BufferAttribute:wR,IntType:u1,InterleavedBuffer:Zy,InterleavedBufferAttribute:Cp,Interpolant:b1,InterpolateDiscrete:Vg,InterpolateLinear:vy,InterpolateSmooth:yx,InterpolationSamplingMode:jN,InterpolationSamplingType:zN,InvertStencilOp:SN,KeepStencilOp:fp,KeyframeTrack:lu,LOD:UT,LatheGeometry:rb,Layers:f0,LessCompare:wT,LessDepth:Dx,LessEqualCompare:jy,LessEqualDepth:Tp,LessEqualStencilFunc:TN,LessStencilFunc:MN,Light:Sd,LightProbe:SE,Line:vd,Line3:xL,LineBasicMaterial:hl,LineCurve:DS,LineCurve3:$T,LineDashedMaterial:cE,LineLoop:VT,LineSegments:Of,LinearFilter:ar,LinearInterpolant:VS,LinearMipMapLinearFilter:N_,LinearMipMapNearestFilter:sN,LinearMipmapLinearFilter:Rf,LinearMipmapNearestFilter:Eg,LinearSRGBColorSpace:Uu,LinearToneMapping:hS,LinearTransfer:Gg,Loader:dl,LoaderUtils:O_,LoadingManager:fb,LoopOnce:vT,LoopPingPong:yT,LoopRepeat:xT,MOUSE:cp,Material:zo,MaterialLoader:hb,MathUtils:xp,Matrix2:KS,Matrix3:Ei,Matrix4:ui,MaxEquation:eT,Mesh:js,MeshBasicMaterial:kf,MeshDepthMaterial:FS,MeshDistanceMaterial:zS,MeshLambertMaterial:oE,MeshMatcapMaterial:lE,MeshNormalMaterial:aE,MeshPhongMaterial:rE,MeshPhysicalMaterial:Sy,MeshStandardMaterial:g0,MeshToonMaterial:sE,MinEquation:QA,MirroredRepeatWrapping:jg,MixOperation:pT,MultiplyBlending:E_,MultiplyOperation:c1,NearestFilter:va,NearestMipMapLinearFilter:rN,NearestMipMapNearestFilter:iN,NearestMipmapLinearFilter:Xm,NearestMipmapNearestFilter:xS,NeutralToneMapping:vS,NeverCompare:ST,NeverDepth:Px,NeverStencilFunc:wN,NoBlending:Ou,NoColorSpace:xh,NoNormalPacking:dN,NoToneMapping:ru,NormalAnimationBlendMode:zy,NormalBlending:Sp,NormalGAPacking:mN,NormalRGPacking:pN,NotEqualCompare:TT,NotEqualDepth:Ux,NotEqualStencilFunc:CN,NumberKeyframeTrack:Jg,Object3D:Oi,ObjectLoader:F6,ObjectSpaceNormalMap:_T,OctahedronGeometry:x1,OneFactor:nT,OneMinusConstantAlphaFactor:dT,OneMinusConstantColorFactor:fT,OneMinusDstAlphaFactor:aT,OneMinusDstColorFactor:lT,OneMinusSrcAlphaFactor:Lx,OneMinusSrcColorFactor:rT,OrthographicCamera:au,PCFShadowMap:Jm,PCFSoftShadowMap:Tg,PMREMGenerator:z_,Path:_y,PerspectiveCamera:Fs,Plane:nu,PlaneGeometry:_d,PlaneHelper:RL,PointLight:xE,PointLightHelper:_L,Points:HT,PointsMaterial:RS,PolarGridHelper:AL,PolyhedronGeometry:bd,PositionalAudio:X6,PropertyBinding:cr,PropertyMixer:EE,QuadraticBezierCurve:kS,QuadraticBezierCurve3:OS,Quaternion:Uo,QuaternionKeyframeTrack:_1,QuaternionLinearInterpolant:dE,R11_EAC_Format:Wx,RED_GREEN_RGTC2_Format:my,RED_RGTC1_Format:dy,REVISION:l1,RG11_EAC_Format:Yx,RGBADepthPacking:uN,RGBAFormat:xa,RGBAIntegerFormat:Fy,RGBA_ASTC_10x10_Format:oy,RGBA_ASTC_10x5_Format:ry,RGBA_ASTC_10x6_Format:sy,RGBA_ASTC_10x8_Format:ay,RGBA_ASTC_12x10_Format:ly,RGBA_ASTC_12x12_Format:cy,RGBA_ASTC_4x4_Format:$x,RGBA_ASTC_5x4_Format:Jx,RGBA_ASTC_5x5_Format:Kx,RGBA_ASTC_6x5_Format:Qx,RGBA_ASTC_6x6_Format:ey,RGBA_ASTC_8x5_Format:ty,RGBA_ASTC_8x6_Format:ny,RGBA_ASTC_8x8_Format:iy,RGBA_BPTC_Format:uy,RGBA_ETC2_EAC_Format:qx,RGBA_PVRTC_2BPPV1_Format:Vx,RGBA_PVRTC_4BPPV1_Format:jx,RGBA_S3TC_DXT1_Format:Ng,RGBA_S3TC_DXT3_Format:Rg,RGBA_S3TC_DXT5_Format:Lg,RGBDepthPacking:fN,RGBFormat:SS,RGBIntegerFormat:aN,RGB_BPTC_SIGNED_Format:fy,RGB_BPTC_UNSIGNED_Format:hy,RGB_ETC1_Format:Hx,RGB_ETC2_Format:Gx,RGB_PVRTC_2BPPV1_Format:zx,RGB_PVRTC_4BPPV1_Format:Fx,RGB_S3TC_DXT1_Format:Cg,RGDepthPacking:hN,RGFormat:Ep,RGIntegerFormat:Uy,RawShaderMaterial:US,Ray:Ip,Raycaster:S0,RectAreaLight:_E,RedFormat:f1,RedIntegerFormat:h1,ReinhardToneMapping:dS,RenderTarget:AS,RenderTarget3D:oL,RepeatWrapping:zg,ReplaceStencilOp:vN,ReverseSubtractEquation:KA,RingGeometry:sb,SIGNED_R11_EAC_Format:Xx,SIGNED_RED_GREEN_RGTC2_Format:gy,SIGNED_RED_RGTC1_Format:py,SIGNED_RG11_EAC_Format:Zx,SRGBColorSpace:vo,SRGBTransfer:Ar,Scene:p1,ShaderChunk:ki,ShaderLib:Du,ShaderMaterial:fl,ShadowMaterial:iE,Shape:Mp,ShapeGeometry:ab,ShapePath:IL,ShapeUtils:ku,ShortType:ky,Skeleton:$y,SkeletonHelper:bL,SkinnedMesh:FT,Source:cd,Sphere:xo,SphereGeometry:y1,Spherical:U_,SphericalHarmonics3:WS,SplineCurve:BS,SpotLight:vE,SpotLightHelper:yL,Sprite:BT,SpriteMaterial:CS,SrcAlphaFactor:Rx,SrcAlphaSaturateFactor:cT,SrcColorFactor:iT,StaticCopyUsage:kN,StaticDrawUsage:qg,StaticReadUsage:PN,StereoCamera:H6,StreamCopyUsage:BN,StreamDrawUsage:LN,StreamReadUsage:DN,StringKeyframeTrack:Op,SubtractEquation:JA,SubtractiveBlending:T_,TOUCH:up,TangentSpaceNormalMap:yd,TetrahedronGeometry:ob,Texture:Fr,TextureLoader:k6,TextureUtils:FL,Timer:hL,TimestampQuery:FN,TorusGeometry:lb,TorusKnotGeometry:cb,Triangle:Xl,TriangleFanDrawMode:cN,TriangleStripDrawMode:lN,TrianglesDrawMode:oN,TubeGeometry:ub,UVMapping:pd,Uint16BufferAttribute:TS,Uint32BufferAttribute:ES,Uint8BufferAttribute:MR,Uint8ClampedBufferAttribute:AR,Uniform:JS,UniformsGroup:cL,UniformsLib:An,UniformsUtils:DT,UnsignedByteType:$a,UnsignedInt101111Type:bS,UnsignedInt248Type:o0,UnsignedInt5999Type:yS,UnsignedIntType:Ec,UnsignedShort4444Type:Oy,UnsignedShort5551Type:By,UnsignedShortType:a0,VSMShadowMap:mp,Vector2:zt,Vector3:Ee,Vector4:Yr,VectorKeyframeTrack:Kg,VideoFrameTexture:YR,VideoTexture:GT,WebGL3DRenderTarget:hR,WebGLArrayRenderTarget:fR,WebGLCoordinateSystem:wc,WebGLCubeRenderTarget:Wy,WebGLRenderTarget:ul,WebGLRenderer:QS,WebGLUtils:kE,WebGPUCoordinateSystem:l0,WebXRController:bx,WireframeGeometry:nE,WrapAroundEnding:Hg,ZeroCurvatureEnding:gp,ZeroFactor:tT,ZeroSlopeEnding:vp,ZeroStencilOp:gN,createCanvasElement:RT,error:Hn,getConsoleFunction:GN,log:Xg,setConsoleFunction:HN,warn:Mn,warnOnce:c0},Symbol.toStringTag,{value:"Module"}));var V5={exports:{}},H5={},G5={exports:{}},q5={};var V3;function Dk(){if(V3)return q5;V3=1;var i=o1();function e(g,y){return g===y&&(g!==0||1/g===1/y)||g!==g&&y!==y}var t=typeof Object.is=="function"?Object.is:e,n=i.useState,r=i.useEffect,s=i.useLayoutEffect,l=i.useDebugValue;function c(g,y){var v=y(),S=n({inst:{value:v,getSnapshot:y}}),T=S[0].inst,A=S[1];return s(function(){T.value=v,T.getSnapshot=y,f(T)&&A({inst:T})},[g,v,y]),r(function(){return f(T)&&A({inst:T}),g(function(){f(T)&&A({inst:T})})},[g]),l(v),v}function f(g){var y=g.getSnapshot;g=g.value;try{var v=y();return!t(g,v)}catch{return!0}}function d(g,y){return y()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:c;return q5.useSyncExternalStore=i.useSyncExternalStore!==void 0?i.useSyncExternalStore:m,q5}var H3;function kk(){return H3||(H3=1,G5.exports=Dk()),G5.exports}var G3;function Ok(){if(G3)return H5;G3=1;var i=o1(),e=kk();function t(d,m){return d===m&&(d!==0||1/d===1/m)||d!==d&&m!==m}var n=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=i.useRef,l=i.useEffect,c=i.useMemo,f=i.useDebugValue;return H5.useSyncExternalStoreWithSelector=function(d,m,g,y,v){var S=s(null);if(S.current===null){var T={hasValue:!1,value:null};S.current=T}else T=S.current;S=c(function(){function w(j){if(!R){if(R=!0,D=j,j=y(j),v!==void 0&&T.hasValue){var X=T.value;if(v(X,j))return I=X}return I=j}if(X=I,n(D,j))return X;var G=y(j);return v!==void 0&&v(X,G)?(D=j,X):(D=j,I=G)}var R=!1,D,I,z=g===void 0?null:g;return[function(){return w(m())},z===null?void 0:function(){return w(z())}]},[m,g,y,v]);var A=r(d,S[0],S[1]);return l(function(){T.hasValue=!0,T.value=A},[A]),f(A),A},H5}var q3;function Bk(){return q3||(q3=1,V5.exports=Ok()),V5.exports}var Uk=Bk();const Fk=fS(Uk),W3=i=>{let e;const t=new Set,n=(d,m)=>{const g=typeof d=="function"?d(e):d;if(!Object.is(g,e)){const y=e;e=m??(typeof g!="object"||g===null)?g:Object.assign({},e,g),t.forEach(v=>v(e,y))}},r=()=>e,c={setState:n,getState:r,getInitialState:()=>f,subscribe:d=>(t.add(d),()=>t.delete(d))},f=e=i(n,r,c);return c},OE=(i=>i?W3(i):W3),{useSyncExternalStoreWithSelector:zk}=Fk,jk=i=>i;function Vk(i,e=jk,t){const n=zk(i.subscribe,i.getState,i.getInitialState,e,t);return Wm.useDebugValue(n),n}const X3=(i,e)=>{const t=OE(i),n=(r,s=e)=>Vk(t,r,s);return Object.assign(n,t),n},BE=((i,e)=>i?X3(i,e):X3),Hk=i=>typeof i=="object"&&typeof i.then=="function",_p=[];function UE(i,e,t=(n,r)=>n===r){if(i===e)return!0;if(!i||!e)return!1;const n=i.length;if(e.length!==n)return!1;for(let r=0;r<n;r++)if(!t(i[r],e[r]))return!1;return!0}function FE(i,e=null,t=!1,n={}){e===null&&(e=[i]);for(const s of _p)if(UE(e,s.keys,s.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return n.lifespan&&n.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,n.lifespan)),s.response;if(!t)throw s.promise}const r={keys:e,equal:n.equal,remove:()=>{const s=_p.indexOf(r);s!==-1&&_p.splice(s,1)},promise:(Hk(i)?i:i(...e)).then(s=>{r.response=s,n.lifespan&&n.lifespan>0&&(r.timeout=setTimeout(r.remove,n.lifespan))}).catch(s=>r.error=s)};if(_p.push(r),!t)throw r.promise}const Gk=(i,e,t)=>FE(i,e,!1,t),qk=(i,e,t)=>{FE(i,e,!0,t)},Wk=i=>{if(i===void 0||i.length===0)_p.splice(0,_p.length);else{const e=_p.find(t=>UE(i,t.keys,t.equal));e&&e.remove()}};var H_=qA();const Xk=fS(H_);function e2(i,e,t){if(!i)return;if(t(i)===!0)return i;let n=e?i.return:i.child;for(;n;){const r=e2(n,e,t);if(r)return r;n=e?null:n.sibling}}function zE(i){try{return Object.defineProperties(i,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return i}}const t2=zE(ge.createContext(null));let jE=class extends ge.Component{render(){return ge.createElement(t2.Provider,{value:this._reactInternals},this.props.children)}};function VE(){const i=ge.useContext(t2);if(i===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=ge.useId();return ge.useMemo(()=>{for(const t of[i,i?.alternate]){if(!t)continue;const n=e2(t,!1,r=>{let s=r.memoizedState;for(;s;){if(s.memoizedState===e)return!0;s=s.next}});if(n)return n}},[i,e])}const Yk=Symbol.for("react.context"),Zk=i=>i!==null&&typeof i=="object"&&"$$typeof"in i&&i.$$typeof===Yk;function $k(){const i=VE(),[e]=ge.useState(()=>new Map);e.clear();let t=i;for(;t;){const n=t.type;Zk(n)&&n!==t2&&!e.has(n)&&e.set(n,ge.use(zE(n))),t=t.return}return e}function Jk(){const i=$k();return ge.useMemo(()=>Array.from(i.keys()).reduce((e,t)=>n=>ge.createElement(e,null,ge.createElement(t.Provider,{...n,value:i.get(t)})),e=>ge.createElement(jE,{...e})),[i])}function HE(i){let e=i.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const GE=i=>i&&i.isOrthographicCamera,Kk=i=>i&&i.hasOwnProperty("current"),Qk=i=>i!=null&&(typeof i=="string"||typeof i=="number"||i.isColor),S1=((i,e)=>typeof window<"u"&&(((i=window.document)==null?void 0:i.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?ge.useLayoutEffect:ge.useEffect;function n2(i){const e=ge.useRef(i);return S1(()=>{e.current=i},[i]),e}function eO(){const i=VE(),e=Jk();return ge.useMemo(()=>({children:t})=>{const r=!!e2(i,!0,s=>s.type===ge.StrictMode)?ge.StrictMode:ge.Fragment;return _.jsx(r,{children:_.jsx(e,{children:t})})},[i,e])}function tO({set:i}){return S1(()=>(i(new Promise(()=>null)),()=>i(!1)),[i]),null}const nO=(i=>(i=class extends ge.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}},i.getDerivedStateFromError=()=>({error:!0}),i))();function qE(i){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(i)?Math.min(Math.max(i[0],t),i[1]):i}function Om(i){var e;return(e=i.__r3f)==null?void 0:e.root.getState()}const Ts={obj:i=>i===Object(i)&&!Ts.arr(i)&&typeof i!="function",fun:i=>typeof i=="function",str:i=>typeof i=="string",num:i=>typeof i=="number",boo:i=>typeof i=="boolean",und:i=>i===void 0,nul:i=>i===null,arr:i=>Array.isArray(i),equ(i,e,{arrays:t="shallow",objects:n="reference",strict:r=!0}={}){if(typeof i!=typeof e||!!i!=!!e)return!1;if(Ts.str(i)||Ts.num(i)||Ts.boo(i))return i===e;const s=Ts.obj(i);if(s&&n==="reference")return i===e;const l=Ts.arr(i);if(l&&t==="reference")return i===e;if((l||s)&&i===e)return!0;let c;for(c in i)if(!(c in e))return!1;if(s&&t==="shallow"&&n==="shallow"){for(c in r?e:i)if(!Ts.equ(i[c],e[c],{strict:r,objects:"reference"}))return!1}else for(c in r?e:i)if(i[c]!==e[c])return!1;if(Ts.und(c)){if(l&&i.length===0&&e.length===0||s&&Object.keys(i).length===0&&Object.keys(e).length===0)return!0;if(i!==e)return!1}return!0}};function iO(i){const e={nodes:{},materials:{},meshes:{}};return i&&i.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material),t.isMesh&&!e.meshes[t.name]&&(e.meshes[t.name]=t)}),e}function rO(i){i.type!=="Scene"&&(i.dispose==null||i.dispose());for(const e in i){const t=i[e];t?.type!=="Scene"&&(t==null||t.dispose==null||t.dispose())}}const WE=["children","key","ref"];function sO(i){const e={};for(const t in i)WE.includes(t)||(e[t]=i[t]);return e}function wy(i,e,t,n){const r=i;let s=r?.__r3f;return s||(s={root:e,type:t,parent:null,children:[],props:sO(n),object:r,eventCount:0,handlers:{},isHidden:!1},r&&(r.__r3f=s)),s}function t1(i,e){if(!e.includes("-"))return{root:i,key:e,target:i[e]};if(e in i)return{root:i,key:e,target:i[e]};let t=i;const n=e.split("-");for(const r of n){if(typeof t!="object"||t===null){if(t!==void 0){const s=n.slice(n.indexOf(r)).join("-");return{root:t,key:s,target:void 0}}return{root:i,key:e,target:void 0}}e=r,i=t,t=t[e]}return{root:i,key:e,target:t}}const Y3=/-\d+$/;function My(i,e){if(Ts.str(e.props.attach)){if(Y3.test(e.props.attach)){const r=e.props.attach.replace(Y3,""),{root:s,key:l}=t1(i.object,r);Array.isArray(s[l])||(s[l]=[])}const{root:t,key:n}=t1(i.object,e.props.attach);e.previousAttach=t[n],t[n]=e.object}else Ts.fun(e.props.attach)&&(e.previousAttach=e.props.attach(i.object,e.object))}function Ay(i,e){if(Ts.str(e.props.attach)){const{root:t,key:n}=t1(i.object,e.props.attach),r=e.previousAttach;r===void 0?delete t[n]:t[n]=r}else e.previousAttach==null||e.previousAttach(i.object,e.object);delete e.previousAttach}const G_=[...WE,"args","dispose","attach","object","onUpdate","dispose"],Z3=new Map;function aO(i){let e=Z3.get(i.constructor);try{e||(e=new i.constructor,Z3.set(i.constructor,e))}catch{}return e}function oO(i,e){const t={};for(const n in e)if(!G_.includes(n)&&!Ts.equ(e[n],i.props[n])){t[n]=e[n];for(const r in e)r.startsWith(`${n}-`)&&(t[r]=e[r])}for(const n in i.props){if(G_.includes(n)||e.hasOwnProperty(n))continue;const{root:r,key:s}=t1(i.object,n);if(r.constructor&&r.constructor.length===0){const l=aO(r);Ts.und(l)||(t[s]=l[s])}else t[s]=0}return t}const lO=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],cO=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function Nf(i,e){var t;const n=i.__r3f,r=n&&HE(n).getState(),s=n?.eventCount;for(const c in e){let f=e[c];if(G_.includes(c))continue;if(n&&cO.test(c)){typeof f=="function"?n.handlers[c]=f:delete n.handlers[c],n.eventCount=Object.keys(n.handlers).length;continue}if(f===void 0)continue;let{root:d,key:m,target:g}=t1(i,c);if(g===void 0&&(typeof d!="object"||d===null))throw Error(`R3F: Cannot set "${c}". Ensure it is an object before setting "${m}".`);if(g instanceof f0&&f instanceof f0)g.mask=f.mask;else if(g instanceof fn&&Qk(f))g.set(f);else if(g!==null&&typeof g=="object"&&typeof g.set=="function"&&typeof g.copy=="function"&&f!=null&&f.constructor&&g.constructor===f.constructor)g.copy(f);else if(g!==null&&typeof g=="object"&&typeof g.set=="function"&&Array.isArray(f))typeof g.fromArray=="function"?g.fromArray(f):g.set(...f);else if(g!==null&&typeof g=="object"&&typeof g.set=="function"&&typeof f=="number")typeof g.setScalar=="function"?g.setScalar(f):g.set(f);else{var l;d[m]=f,r&&!r.linear&&lO.includes(m)&&(l=d[m])!=null&&l.isTexture&&d[m].format===xa&&d[m].type===$a&&(d[m].colorSpace=vo)}}if(n!=null&&n.parent&&r!=null&&r.internal&&(t=n.object)!=null&&t.isObject3D&&s!==n.eventCount){const c=n.object,f=r.internal.interaction.indexOf(c);f>-1&&r.internal.interaction.splice(f,1),n.eventCount&&c.raycast!==null&&r.internal.interaction.push(c)}return n&&n.props.attach===void 0&&(n.object.isBufferGeometry?n.props.attach="geometry":n.object.isMaterial&&(n.props.attach="material")),n&&M0(n),i}function M0(i){var e;if(!i.parent)return;i.props.onUpdate==null||i.props.onUpdate(i.object);const t=(e=i.root)==null||e.getState==null?void 0:e.getState();t&&t.internal.frames===0&&t.invalidate()}function XE(i,e){i.manual||(GE(i)?(i.left=e.width/-2,i.right=e.width/2,i.top=e.height/2,i.bottom=e.height/-2):i.aspect=e.width/e.height,i.updateProjectionMatrix())}const ol=i=>i?.isObject3D;function sx(i){return(i.eventObject||i.object).uuid+"/"+i.index+i.instanceId}function YE(i,e,t,n){const r=t.get(e);r&&(t.delete(e),t.size===0&&(i.delete(n),r.target.releasePointerCapture(n)))}function uO(i,e){const{internal:t}=i.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,r)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(r)}),t.capturedMap.forEach((n,r)=>{YE(t.capturedMap,e,n,r)})}function fO(i){function e(f){const{internal:d}=i.getState(),m=f.offsetX-d.initialClick[0],g=f.offsetY-d.initialClick[1];return Math.round(Math.sqrt(m*m+g*g))}function t(f){return f.filter(d=>["Move","Over","Enter","Out","Leave"].some(m=>{var g;return(g=d.__r3f)==null?void 0:g.handlers["onPointer"+m]}))}function n(f,d){const m=i.getState(),g=new Set,y=[],v=d?d(m.internal.interaction):m.internal.interaction;for(let w=0;w<v.length;w++){const R=Om(v[w]);R&&(R.raycaster.camera=void 0)}m.previousRoot||m.events.compute==null||m.events.compute(f,m);function S(w){const R=Om(w);if(!R||!R.events.enabled||R.raycaster.camera===null)return[];if(R.raycaster.camera===void 0){var D;R.events.compute==null||R.events.compute(f,R,(D=R.previousRoot)==null?void 0:D.getState()),R.raycaster.camera===void 0&&(R.raycaster.camera=null)}return R.raycaster.camera?R.raycaster.intersectObject(w,!0):[]}let T=v.flatMap(S).sort((w,R)=>{const D=Om(w.object),I=Om(R.object);return!D||!I?w.distance-R.distance:I.events.priority-D.events.priority||w.distance-R.distance}).filter(w=>{const R=sx(w);return g.has(R)?!1:(g.add(R),!0)});m.events.filter&&(T=m.events.filter(T,m));for(const w of T){let R=w.object;for(;R;){var A;(A=R.__r3f)!=null&&A.eventCount&&y.push({...w,eventObject:R}),R=R.parent}}if("pointerId"in f&&m.internal.capturedMap.has(f.pointerId))for(let w of m.internal.capturedMap.get(f.pointerId).values())g.has(sx(w.intersection))||y.push(w.intersection);return y}function r(f,d,m,g){if(f.length){const y={stopped:!1};for(const v of f){let S=Om(v.object);if(S||v.object.traverseAncestors(T=>{const A=Om(T);if(A)return S=A,!1}),S){const{raycaster:T,pointer:A,camera:w,internal:R}=S,D=new Ee(A.x,A.y,0).unproject(w),I=L=>{var k,U;return(k=(U=R.capturedMap.get(L))==null?void 0:U.has(v.eventObject))!=null?k:!1},z=L=>{const k={intersection:v,target:d.target};R.capturedMap.has(L)?R.capturedMap.get(L).set(v.eventObject,k):R.capturedMap.set(L,new Map([[v.eventObject,k]])),d.target.setPointerCapture(L)},j=L=>{const k=R.capturedMap.get(L);k&&YE(R.capturedMap,v.eventObject,k,L)};let X={};for(let L in d){let k=d[L];typeof k!="function"&&(X[L]=k)}let G={...v,...X,pointer:A,intersections:f,stopped:y.stopped,delta:m,unprojectedPoint:D,ray:T.ray,camera:w,stopPropagation(){const L="pointerId"in d&&R.capturedMap.get(d.pointerId);if((!L||L.has(v.eventObject))&&(G.stopped=y.stopped=!0,R.hovered.size&&Array.from(R.hovered.values()).find(k=>k.eventObject===v.eventObject))){const k=f.slice(0,f.indexOf(v));s([...k,v])}},target:{hasPointerCapture:I,setPointerCapture:z,releasePointerCapture:j},currentTarget:{hasPointerCapture:I,setPointerCapture:z,releasePointerCapture:j},nativeEvent:d};if(g(G),y.stopped===!0)break}}}return f}function s(f){const{internal:d}=i.getState();for(const m of d.hovered.values())if(!f.length||!f.find(g=>g.object===m.object&&g.index===m.index&&g.instanceId===m.instanceId)){const y=m.eventObject.__r3f;if(d.hovered.delete(sx(m)),y!=null&&y.eventCount){const v=y.handlers,S={...m,intersections:f};v.onPointerOut==null||v.onPointerOut(S),v.onPointerLeave==null||v.onPointerLeave(S)}}}function l(f,d){for(let m=0;m<d.length;m++){const g=d[m].__r3f;g==null||g.handlers.onPointerMissed==null||g.handlers.onPointerMissed(f)}}function c(f){switch(f){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return d=>{const{internal:m}=i.getState();"pointerId"in d&&m.capturedMap.has(d.pointerId)&&requestAnimationFrame(()=>{m.capturedMap.has(d.pointerId)&&(m.capturedMap.delete(d.pointerId),s([]))})}}return function(m){const{onPointerMissed:g,internal:y}=i.getState();y.lastEvent.current=m;const v=f==="onPointerMove",S=f==="onClick"||f==="onContextMenu"||f==="onDoubleClick",A=n(m,v?t:void 0),w=S?e(m):0;f==="onPointerDown"&&(y.initialClick=[m.offsetX,m.offsetY],y.initialHits=A.map(D=>D.eventObject)),S&&!A.length&&w<=2&&(l(m,y.interaction),g&&g(m)),v&&s(A);function R(D){const I=D.eventObject,z=I.__r3f;if(!(z!=null&&z.eventCount))return;const j=z.handlers;if(v){if(j.onPointerOver||j.onPointerEnter||j.onPointerOut||j.onPointerLeave){const X=sx(D),G=y.hovered.get(X);G?G.stopped&&D.stopPropagation():(y.hovered.set(X,D),j.onPointerOver==null||j.onPointerOver(D),j.onPointerEnter==null||j.onPointerEnter(D))}j.onPointerMove==null||j.onPointerMove(D)}else{const X=j[f];X?(!S||y.initialHits.includes(I))&&(l(m,y.interaction.filter(G=>!y.initialHits.includes(G))),X(D)):S&&y.initialHits.includes(I)&&l(m,y.interaction.filter(G=>!y.initialHits.includes(G)))}}r(A,m,w,R)}}return{handlePointer:c}}const $3=i=>!!(i!=null&&i.render),i2=ge.createContext(null),hO=(i,e)=>{const t=BE((c,f)=>{const d=new Ee,m=new Ee,g=new Ee;function y(w=f().camera,R=m,D=f().size){const{width:I,height:z,top:j,left:X}=D,G=I/z;R.isVector3?g.copy(R):g.set(...R);const L=w.getWorldPosition(d).distanceTo(g);if(GE(w))return{width:I/w.zoom,height:z/w.zoom,top:j,left:X,factor:1,distance:L,aspect:G};{const k=w.fov*Math.PI/180,U=2*Math.tan(k/2)*L,q=U*(I/z);return{width:q,height:U,top:j,left:X,factor:I/q,distance:L,aspect:G}}}let v;const S=w=>c(R=>({performance:{...R.performance,current:w}})),T=new zt;return{set:c,get:f,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(w=1)=>i(f(),w),advance:(w,R)=>e(w,R,f()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new YS,pointer:T,mouse:T,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const w=f();v&&clearTimeout(v),w.performance.current!==w.performance.min&&S(w.performance.min),v=setTimeout(()=>S(f().performance.max),w.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:y},setEvents:w=>c(R=>({...R,events:{...R.events,...w}})),setSize:(w,R,D=0,I=0)=>{const z=f().camera,j={width:w,height:R,top:D,left:I};c(X=>({size:j,viewport:{...X.viewport,...y(z,m,j)}}))},setDpr:w=>c(R=>{const D=qE(w);return{viewport:{...R.viewport,dpr:D,initialDpr:R.viewport.initialDpr||D}}}),setFrameloop:(w="always")=>{const R=f().clock;R.stop(),R.elapsedTime=0,w!=="never"&&(R.start(),R.elapsedTime=0),c(()=>({frameloop:w}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:ge.createRef(),active:!1,frames:0,priority:0,subscribe:(w,R,D)=>{const I=f().internal;return I.priority=I.priority+(R>0?1:0),I.subscribers.push({ref:w,priority:R,store:D}),I.subscribers=I.subscribers.sort((z,j)=>z.priority-j.priority),()=>{const z=f().internal;z!=null&&z.subscribers&&(z.priority=z.priority-(R>0?1:0),z.subscribers=z.subscribers.filter(j=>j.ref!==w))}}}}}),n=t.getState();let r=n.size,s=n.viewport.dpr,l=n.camera;return t.subscribe(()=>{const{camera:c,size:f,viewport:d,gl:m,set:g}=t.getState();if(f.width!==r.width||f.height!==r.height||d.dpr!==s){r=f,s=d.dpr,XE(c,f),d.dpr>0&&m.setPixelRatio(d.dpr);const y=typeof HTMLCanvasElement<"u"&&m.domElement instanceof HTMLCanvasElement;m.setSize(f.width,f.height,y)}c!==l&&(l=c,g(y=>({viewport:{...y.viewport,...y.viewport.getCurrentViewport(c)}})))}),t.subscribe(c=>i(c)),t};function r2(){const i=ge.useContext(i2);if(!i)throw new Error("R3F: Hooks can only be used within the Canvas component!");return i}function da(i=t=>t,e){return r2()(i,e)}function Lr(i,e=0){const t=r2(),n=t.getState().internal.subscribe,r=n2(i);return S1(()=>n(r,e,t),[e,n,t]),null}const J3=new WeakMap,dO=i=>{var e;return typeof i=="function"&&(i==null||(e=i.prototype)==null?void 0:e.constructor)===i};function ZE(i,e){return function(t,...n){let r;return dO(t)?(r=J3.get(t),r||(r=new t,J3.set(t,r))):r=t,i&&i(r),Promise.all(n.map(s=>new Promise((l,c)=>r.load(s,f=>{ol(f?.scene)&&Object.assign(f,iO(f.scene)),l(f)},e,f=>c(new Error(`Could not load ${s}: ${f?.message}`))))))}}function v0(i,e,t,n){const r=Array.isArray(e)?e:[e],s=Gk(ZE(t,n),[i,...r],{equal:Ts.equ});return Array.isArray(e)?s:s[0]}v0.preload=function(i,e,t){const n=Array.isArray(e)?e:[e];return qk(ZE(t),[i,...n])};v0.clear=function(i,e){const t=Array.isArray(e)?e:[e];return Wk([i,...t])};const pO=1,mO=8,gO=32,vO=2;var xO={version:"9.5.0"};function yO(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var K3={exports:{}},Q3={exports:{}},eM;function bO(){return eM||(eM=1,(function(i){i.exports=function(e){function t(u,h,b,E){return new af(u,h,b,E)}function n(){}function r(u){var h="https://react.dev/errors/"+u;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)h+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(u){var h=u,b=u;if(u.alternate)for(;h.return;)h=h.return;else{u=h;do h=u,(h.flags&4098)!==0&&(b=h.return),u=h.return;while(u)}return h.tag===3?b:null}function l(u){if(s(u)!==u)throw Error(r(188))}function c(u){var h=u.alternate;if(!h){if(h=s(u),h===null)throw Error(r(188));return h!==u?null:u}for(var b=u,E=h;;){var O=b.return;if(O===null)break;var H=O.alternate;if(H===null){if(E=O.return,E!==null){b=E;continue}break}if(O.child===H.child){for(H=O.child;H;){if(H===b)return l(O),u;if(H===E)return l(O),h;H=H.sibling}throw Error(r(188))}if(b.return!==E.return)b=O,E=H;else{for(var ve=!1,Xe=O.child;Xe;){if(Xe===b){ve=!0,b=O,E=H;break}if(Xe===E){ve=!0,E=O,b=H;break}Xe=Xe.sibling}if(!ve){for(Xe=H.child;Xe;){if(Xe===b){ve=!0,b=H,E=O;break}if(Xe===E){ve=!0,E=H,b=O;break}Xe=Xe.sibling}if(!ve)throw Error(r(189))}}if(b.alternate!==E)throw Error(r(190))}if(b.tag!==3)throw Error(r(188));return b.stateNode.current===b?u:h}function f(u){var h=u.tag;if(h===5||h===26||h===27||h===6)return u;for(u=u.child;u!==null;){if(h=f(u),h!==null)return h;u=u.sibling}return null}function d(u){var h=u.tag;if(h===5||h===26||h===27||h===6)return u;for(u=u.child;u!==null;){if(u.tag!==4&&(h=d(u),h!==null))return h;u=u.sibling}return null}function m(u){return u===null||typeof u!="object"?null:(u=Xn&&u[Xn]||u["@@iterator"],typeof u=="function"?u:null)}function g(u){if(u==null)return null;if(typeof u=="function")return u.$$typeof===gi?null:u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case Kt:return"Fragment";case Dn:return"Profiler";case Yt:return"StrictMode";case Ci:return"Suspense";case pr:return"SuspenseList";case yn:return"Activity"}if(typeof u=="object")switch(u.$$typeof){case Ft:return"Portal";case Wn:return u.displayName||"Context";case En:return(u._context.displayName||"Context")+".Consumer";case Ln:var h=u.render;return u=u.displayName,u||(u=h.displayName||h.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case li:return h=u.displayName||null,h!==null?h:g(u.type)||"Memo";case wn:h=u._payload,u=u._init;try{return g(u(h))}catch{}}return null}function y(u){return{current:u}}function v(u){0>Kf||(u.current=Jp[Kf],Jp[Kf]=null,Kf--)}function S(u,h){Kf++,Jp[Kf]=u.current,u.current=h}function T(u){return u>>>=0,u===0?32:31-(Kp(u)/Y1|0)|0}function A(u){var h=u&42;if(h!==0)return h;switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return u&261888;case 262144:case 524288:case 1048576:case 2097152:return u&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return u&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return u}}function w(u,h,b){var E=u.pendingLanes;if(E===0)return 0;var O=0,H=u.suspendedLanes,ve=u.pingedLanes;u=u.warmLanes;var Xe=E&134217727;return Xe!==0?(E=Xe&~H,E!==0?O=A(E):(ve&=Xe,ve!==0?O=A(ve):b||(b=Xe&~u,b!==0&&(O=A(b))))):(Xe=E&~H,Xe!==0?O=A(Xe):ve!==0?O=A(ve):b||(b=E&~u,b!==0&&(O=A(b)))),O===0?0:h!==0&&h!==O&&(h&H)===0&&(H=O&-O,b=h&-h,H>=b||H===32&&(b&4194048)!==0)?h:O}function R(u,h){return(u.pendingLanes&~(u.suspendedLanes&~u.pingedLanes)&h)===0}function D(u,h){switch(u){case 1:case 2:case 4:case 8:case 64:return h+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function I(){var u=kh;return kh<<=1,(kh&62914560)===0&&(kh=4194304),u}function z(u){for(var h=[],b=0;31>b;b++)h.push(u);return h}function j(u,h){u.pendingLanes|=h,h!==268435456&&(u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0)}function X(u,h,b,E,O,H){var ve=u.pendingLanes;u.pendingLanes=b,u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0,u.expiredLanes&=b,u.entangledLanes&=b,u.errorRecoveryDisabledLanes&=b,u.shellSuspendCounter=0;var Xe=u.entanglements,kt=u.expirationTimes,Qt=u.hiddenUpdates;for(b=ve&~b;0<b;){var xn=31-Ao(b),on=1<<xn;Xe[xn]=0,kt[xn]=-1;var Nn=Qt[xn];if(Nn!==null)for(Qt[xn]=null,xn=0;xn<Nn.length;xn++){var vi=Nn[xn];vi!==null&&(vi.lane&=-536870913)}b&=~on}E!==0&&G(u,E,0),H!==0&&O===0&&u.tag!==0&&(u.suspendedLanes|=H&~(ve&~h))}function G(u,h,b){u.pendingLanes|=h,u.suspendedLanes&=~h;var E=31-Ao(h);u.entangledLanes|=h,u.entanglements[E]=u.entanglements[E]|1073741824|b&261930}function L(u,h){var b=u.entangledLanes|=h;for(u=u.entanglements;b;){var E=31-Ao(b),O=1<<E;O&h|u[E]&h&&(u[E]|=h),b&=~O}}function k(u,h){var b=h&-h;return b=(b&42)!==0?1:U(b),(b&(u.suspendedLanes|h))!==0?0:b}function U(u){switch(u){case 2:u=1;break;case 8:u=4;break;case 32:u=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:u=128;break;case 268435456:u=134217728;break;default:u=0}return u}function q(u){return u&=-u,2<u?8<u?(u&134217727)!==0?32:268435456:8:2}function W(u){if(typeof H0=="function"&&J1(u),To&&typeof To.setStrictMode=="function")try{To.setStrictMode(eh,u)}catch{}}function J(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}function ce(u){if(rm===void 0)try{throw Error()}catch(b){var h=b.stack.trim().match(/\n( *(at )?)/);rm=h&&h[1]||"",qc=-1<b.stack.indexOf(`
    at`)?" (<anonymous>)":-1<b.stack.indexOf("@")?"@unknown:0:0":""}return`
`+rm+u+qc}function K(u,h){if(!u||Ud)return"";Ud=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var E={DetermineComponentFrameRoot:function(){try{if(h){var on=function(){throw Error()};if(Object.defineProperty(on.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(on,[])}catch(vi){var Nn=vi}Reflect.construct(u,[],on)}else{try{on.call()}catch(vi){Nn=vi}u.call(on.prototype)}}else{try{throw Error()}catch(vi){Nn=vi}(on=u())&&typeof on.catch=="function"&&on.catch(function(){})}}catch(vi){if(vi&&Nn&&typeof vi.stack=="string")return[vi.stack,Nn.stack]}return[null,null]}};E.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var O=Object.getOwnPropertyDescriptor(E.DetermineComponentFrameRoot,"name");O&&O.configurable&&Object.defineProperty(E.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var H=E.DetermineComponentFrameRoot(),ve=H[0],Xe=H[1];if(ve&&Xe){var kt=ve.split(`
`),Qt=Xe.split(`
`);for(O=E=0;E<kt.length&&!kt[E].includes("DetermineComponentFrameRoot");)E++;for(;O<Qt.length&&!Qt[O].includes("DetermineComponentFrameRoot");)O++;if(E===kt.length||O===Qt.length)for(E=kt.length-1,O=Qt.length-1;1<=E&&0<=O&&kt[E]!==Qt[O];)O--;for(;1<=E&&0<=O;E--,O--)if(kt[E]!==Qt[O]){if(E!==1||O!==1)do if(E--,O--,0>O||kt[E]!==Qt[O]){var xn=`
`+kt[E].replace(" at new "," at ");return u.displayName&&xn.includes("<anonymous>")&&(xn=xn.replace("<anonymous>",u.displayName)),xn}while(1<=E&&0<=O);break}}}finally{Ud=!1,Error.prepareStackTrace=b}return(b=u?u.displayName||u.name:"")?ce(b):""}function ne(u,h){switch(u.tag){case 26:case 27:case 5:return ce(u.type);case 16:return ce("Lazy");case 13:return u.child!==h&&h!==null?ce("Suspense Fallback"):ce("Suspense");case 19:return ce("SuspenseList");case 0:case 15:return K(u.type,!1);case 11:return K(u.type.render,!1);case 1:return K(u.type,!0);case 31:return ce("Activity");default:return""}}function pe(u){try{var h="",b=null;do h+=ne(u,b),b=u,u=u.return;while(u);return h}catch(E){return`
Error generating stack: `+E.message+`
`+E.stack}}function Re(u,h){if(typeof u=="object"&&u!==null){var b=G0.get(u);return b!==void 0?b:(h={value:u,source:h,stack:pe(h)},G0.set(u,h),h)}return{value:u,source:h,stack:pe(h)}}function Te(u,h){Su[Wc++]=Fd,Su[Wc++]=Mr,Mr=u,Fd=h}function ee(u,h,b){Ol[el++]=Ra,Ol[el++]=gc,Ol[el++]=Bl,Bl=u;var E=Ra;u=gc;var O=32-Ao(E)-1;E&=~(1<<O),b+=1;var H=32-Ao(h)+O;if(30<H){var ve=O-O%5;H=(E&(1<<ve)-1).toString(32),E>>=ve,O-=ve,Ra=1<<32-Ao(h)+O|b<<O|E,gc=H+u}else Ra=1<<H|b<<O|E,gc=u}function F(u){u.return!==null&&(Te(u,1),ee(u,1,0))}function $(u){for(;u===Mr;)Mr=Su[--Wc],Su[Wc]=null,Fd=Su[--Wc],Su[Wc]=null;for(;u===Bl;)Bl=Ol[--el],Ol[el]=null,gc=Ol[--el],Ol[el]=null,Ra=Ol[--el],Ol[el]=null}function re(u,h){Ol[el++]=Ra,Ol[el++]=gc,Ol[el++]=Bl,Ra=h.id,gc=h.overflow,Bl=u}function Ae(u,h){S(La,h),S(wu,u),S(wa,null),u=ys(h),v(wa),S(wa,u)}function ie(){v(wa),v(wu),v(La)}function _e(u){u.memoizedState!==null&&S(zd,u);var h=wa.current,b=Ni(h,u.type);h!==b&&(S(wu,u),S(wa,b))}function ke(u){wu.current===u&&(v(wa),v(wu)),zd.current===u&&(v(zd),Gi?yu._currentValue=Ha:yu._currentValue2=Ha)}function Fe(u){var h=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw le(Re(h,u)),sm}function We(u,h){if(!Ii)throw Error(r(175));O1(u.stateNode,u.type,u.memoizedProps,h,u)||Fe(u,!0)}function nt(u){for(ca=u.return;ca;)switch(ca.tag){case 5:case 31:case 13:uo=!1;return;case 27:case 3:uo=!0;return;default:ca=ca.return}}function It(u){if(!Ii||u!==ca)return!1;if(!qi)return nt(u),qi=!0,!1;var h=u.tag;if(la?h!==3&&h!==27&&(h!==5||Dh(u.type)&&!Hi(u.type,u.memoizedProps))&&is&&Fe(u):h!==3&&(h!==5||Dh(u.type)&&!Hi(u.type,u.memoizedProps))&&is&&Fe(u),nt(u),h===13){if(!Ii)throw Error(r(316));if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(r(317));is=P0(u)}else if(h===31){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(r(317));is=U1(u)}else is=la&&h===27?C1(u.type,is):ca?E1(u.stateNode):null;return!0}function wt(){Ii&&(is=ca=null,qi=!1)}function Je(){var u=Xc;return u!==null&&(No===null?No=u:No.push.apply(No,u),Xc=null),u}function le(u){Xc===null?Xc=[u]:Xc.push(u)}function Qe(u,h,b){Gi?(S(Ul,h._currentValue),h._currentValue=b):(S(Ul,h._currentValue2),h._currentValue2=b)}function Et(u){var h=Ul.current;Gi?u._currentValue=h:u._currentValue2=h,v(Ul)}function we(u,h,b){for(;u!==null;){var E=u.alternate;if((u.childLanes&h)!==h?(u.childLanes|=h,E!==null&&(E.childLanes|=h)):E!==null&&(E.childLanes&h)!==h&&(E.childLanes|=h),u===b)break;u=u.return}}function ot(u,h,b,E){var O=u.child;for(O!==null&&(O.return=u);O!==null;){var H=O.dependencies;if(H!==null){var ve=O.child;H=H.firstContext;e:for(;H!==null;){var Xe=H;H=O;for(var kt=0;kt<h.length;kt++)if(Xe.context===h[kt]){H.lanes|=b,Xe=H.alternate,Xe!==null&&(Xe.lanes|=b),we(H.return,b,u),E||(ve=null);break e}H=Xe.next}}else if(O.tag===18){if(ve=O.return,ve===null)throw Error(r(341));ve.lanes|=b,H=ve.alternate,H!==null&&(H.lanes|=b),we(ve,b,u),ve=null}else ve=O.child;if(ve!==null)ve.return=O;else for(ve=O;ve!==null;){if(ve===u){ve=null;break}if(O=ve.sibling,O!==null){O.return=ve.return,ve=O;break}ve=ve.return}O=ve}}function Ct(u,h,b,E){u=null;for(var O=h,H=!1;O!==null;){if(!H){if((O.flags&524288)!==0)H=!0;else if((O.flags&262144)!==0)break}if(O.tag===10){var ve=O.alternate;if(ve===null)throw Error(r(387));if(ve=ve.memoizedProps,ve!==null){var Xe=O.type;ks(O.pendingProps.value,ve.value)||(u!==null?u.push(Xe):u=[Xe])}}else if(O===zd.current){if(ve=O.alternate,ve===null)throw Error(r(387));ve.memoizedState.memoizedState!==O.memoizedState.memoizedState&&(u!==null?u.push(yu):u=[yu])}O=O.return}u!==null&&ot(h,u,b,E),h.flags|=262144}function ht(u){for(u=u.firstContext;u!==null;){var h=u.context;if(!ks(Gi?h._currentValue:h._currentValue2,u.memoizedValue))return!0;u=u.next}return!1}function xt(u){Or=u,vc=null,u=u.dependencies,u!==null&&(u.firstContext=null)}function he(u){return Be(Or,u)}function Q(u,h){return Or===null&&xt(u),Be(u,h)}function Be(u,h){var b=Gi?h._currentValue:h._currentValue2;if(h={context:h,memoizedValue:b,next:null},vc===null){if(u===null)throw Error(r(308));vc=h,u.dependencies={lanes:0,firstContext:h},u.flags|=524288}else vc=vc.next=h;return b}function ue(){return{controller:new K1,data:new Map,refCount:0}}function je(u){u.refCount--,u.refCount===0&&Ma(Mb,function(){u.controller.abort()})}function Ye(){}function ft(u){u!==gr&&u.next===null&&(gr===null?jd=gr=u:gr=gr.next=u),Fl=!0,qa||(qa=!0,xe())}function gt(u,h){if(!am&&Fl){am=!0;do for(var b=!1,E=jd;E!==null;){if(u!==0){var O=E.pendingLanes;if(O===0)var H=0;else{var ve=E.suspendedLanes,Xe=E.pingedLanes;H=(1<<31-Ao(42|u)+1)-1,H&=O&~(ve&~Xe),H=H&201326741?H&201326741|1:H?H|2:0}H!==0&&(b=!0,Ge(E,H))}else H=Wi,H=w(E,E===Li?H:0,E.cancelPendingCommit!==null||E.timeoutHandle!==wr),(H&3)===0||R(E,H)||(b=!0,Ge(E,H));E=E.next}while(b);am=!1}}function Lt(){un()}function un(){Fl=qa=!1;var u=0;df!==0&&Na()&&(u=df);for(var h=Ga(),b=null,E=jd;E!==null;){var O=E.next,H=bt(E,h);H===0?(E.next=null,b===null?jd=O:b.next=O,O===null&&(gr=b)):(b=E,(u!==0||(H&3)!==0)&&(Fl=!0)),E=O}Xs!==0&&Xs!==5||gt(u),df!==0&&(df=0)}function bt(u,h){for(var b=u.suspendedLanes,E=u.pingedLanes,O=u.expirationTimes,H=u.pendingLanes&-62914561;0<H;){var ve=31-Ao(H),Xe=1<<ve,kt=O[ve];kt===-1?((Xe&b)===0||(Xe&E)!==0)&&(O[ve]=D(Xe,h)):kt<=h&&(u.expiredLanes|=Xe),H&=~Xe}if(h=Li,b=Wi,b=w(u,u===h?b:0,u.cancelPendingCommit!==null||u.timeoutHandle!==wr),E=u.callbackNode,b===0||u===h&&(xr===2||xr===9)||u.cancelPendingCommit!==null)return E!==null&&E!==null&&em(E),u.callbackNode=null,u.callbackPriority=0;if((b&3)===0||R(u,b)){if(h=b&-b,h===u.callbackPriority)return h;switch(E!==null&&em(E),q(b)){case 2:case 8:b=$1;break;case 32:b=Bd;break;case 268435456:b=nm;break;default:b=Bd}return E=dt.bind(null,u),b=Od(b,E),u.callbackPriority=h,u.callbackNode=b,h}return E!==null&&E!==null&&em(E),u.callbackPriority=2,u.callbackNode=null,2}function dt(u,h){if(Xs!==0&&Xs!==5)return u.callbackNode=null,u.callbackPriority=0,null;var b=u.callbackNode;if(wo()&&u.callbackNode!==b)return null;var E=Wi;return E=w(u,u===Li?E:0,u.cancelPendingCommit!==null||u.timeoutHandle!==wr),E===0?null:(oo(u,E,h),bt(u,Ga()),u.callbackNode!=null&&u.callbackNode===b?dt.bind(null,u):null)}function Ge(u,h){if(wo())return null;oo(u,h,!0)}function xe(){Cd?Ch(function(){(zi&6)!==0?Od(tm,Lt):un()}):Od(tm,Lt)}function Pe(){if(df===0){var u=Mu;u===0&&(u=Qp,Qp<<=1,(Qp&261888)===0&&(Qp=256)),df=u}return df}function rt(u,h){if(Oh===null){var b=Oh=[];q0=0,Mu=Pe(),ua={status:"pending",value:void 0,then:function(E){b.push(E)}}}return q0++,h.then(Me,Me),h}function Me(){if(--q0===0&&Oh!==null){ua!==null&&(ua.status="fulfilled");var u=Oh;Oh=null,Mu=0,ua=null;for(var h=0;h<u.length;h++)(0,u[h])()}}function ze(u,h){var b=[],E={status:"pending",value:null,reason:null,then:function(O){b.push(O)}};return u.then(function(){E.status="fulfilled",E.value=h;for(var O=0;O<b.length;O++)(0,b[O])(h)},function(O){for(E.status="rejected",E.reason=O,O=0;O<b.length;O++)(0,b[O])(void 0)}),E}function Mt(){var u=pf.current;return u!==null?u:Li.pooledCache}function Rt(u,h){h===null?S(pf,pf.current):S(pf,h.pool)}function se(){var u=Mt();return u===null?null:{parent:Gi?rs._currentValue:rs._currentValue2,pool:u}}function Ve(u,h){if(ks(u,h))return!0;if(typeof u!="object"||u===null||typeof h!="object"||h===null)return!1;var b=Object.keys(u),E=Object.keys(h);if(b.length!==E.length)return!1;for(E=0;E<b.length;E++){var O=b[E];if(!wb.call(h,O)||!ks(u[O],h[O]))return!1}return!0}function vt(u){return u=u.status,u==="fulfilled"||u==="rejected"}function Dt(u,h,b){switch(b=u[b],b===void 0?u.push(h):b!==h&&(h.then(Ye,Ye),h=b),h.status){case"fulfilled":return h.value;case"rejected":throw u=h.reason,tn(u),u;default:if(typeof h.status=="string")h.then(Ye,Ye);else{if(u=Li,u!==null&&100<u.shellSuspendCounter)throw Error(r(482));u=h,u.status="pending",u.then(function(E){if(h.status==="pending"){var O=h;O.status="fulfilled",O.value=E}},function(E){if(h.status==="pending"){var O=h;O.status="rejected",O.reason=E}})}switch(h.status){case"fulfilled":return h.value;case"rejected":throw u=h.reason,tn(u),u}throw fo=h,fa}}function bn(u){try{var h=u._init;return h(u._payload)}catch(b){throw b!==null&&typeof b=="object"&&typeof b.then=="function"?(fo=b,fa):b}}function dn(){if(fo===null)throw Error(r(459));var u=fo;return fo=null,u}function tn(u){if(u===fa||u===jl)throw Error(r(483))}function gn(u){var h=th;return th+=1,mf===null&&(mf=[]),Dt(mf,u,h)}function Pn(u,h){h=h.props.ref,u.ref=h!==void 0?h:null}function Bi(u,h){throw h.$$typeof===pt?Error(r(525)):(u=Object.prototype.toString.call(h),Error(r(31,u==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":u)))}function xi(u){function h(At,ut){if(u){var Pt=At.deletions;Pt===null?(At.deletions=[ut],At.flags|=16):Pt.push(ut)}}function b(At,ut){if(!u)return null;for(;ut!==null;)h(At,ut),ut=ut.sibling;return null}function E(At){for(var ut=new Map;At!==null;)At.key!==null?ut.set(At.key,At):ut.set(At.index,At),At=At.sibling;return ut}function O(At,ut){return At=co(At,ut),At.index=0,At.sibling=null,At}function H(At,ut,Pt){return At.index=Pt,u?(Pt=At.alternate,Pt!==null?(Pt=Pt.index,Pt<ut?(At.flags|=67108866,ut):Pt):(At.flags|=67108866,ut)):(At.flags|=1048576,ut)}function ve(At){return u&&At.alternate===null&&(At.flags|=67108866),At}function Xe(At,ut,Pt,pn){return ut===null||ut.tag!==6?(ut=V(Pt,At.mode,pn),ut.return=At,ut):(ut=O(ut,Pt),ut.return=At,ut)}function kt(At,ut,Pt,pn){var Zn=Pt.type;return Zn===Kt?xn(At,ut,Pt.props.children,pn,Pt.key):ut!==null&&(ut.elementType===Zn||typeof Zn=="object"&&Zn!==null&&Zn.$$typeof===wn&&bn(Zn)===ut.type)?(ut=O(ut,Pt.props),Pn(ut,Pt),ut.return=At,ut):(ut=M(Pt.type,Pt.key,Pt.props,null,At.mode,pn),Pn(ut,Pt),ut.return=At,ut)}function Qt(At,ut,Pt,pn){return ut===null||ut.tag!==4||ut.stateNode.containerInfo!==Pt.containerInfo||ut.stateNode.implementation!==Pt.implementation?(ut=oe(Pt,At.mode,pn),ut.return=At,ut):(ut=O(ut,Pt.children||[]),ut.return=At,ut)}function xn(At,ut,Pt,pn,Zn){return ut===null||ut.tag!==7?(ut=N(Pt,At.mode,pn,Zn),ut.return=At,ut):(ut=O(ut,Pt),ut.return=At,ut)}function on(At,ut,Pt){if(typeof ut=="string"&&ut!==""||typeof ut=="number"||typeof ut=="bigint")return ut=V(""+ut,At.mode,Pt),ut.return=At,ut;if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case Bt:return Pt=M(ut.type,ut.key,ut.props,null,At.mode,Pt),Pn(Pt,ut),Pt.return=At,Pt;case Ft:return ut=oe(ut,At.mode,Pt),ut.return=At,ut;case wn:return ut=bn(ut),on(At,ut,Pt)}if(Ki(ut)||m(ut))return ut=N(ut,At.mode,Pt,null),ut.return=At,ut;if(typeof ut.then=="function")return on(At,gn(ut),Pt);if(ut.$$typeof===Wn)return on(At,Q(At,ut),Pt);Bi(At,ut)}return null}function Nn(At,ut,Pt,pn){var Zn=ut!==null?ut.key:null;if(typeof Pt=="string"&&Pt!==""||typeof Pt=="number"||typeof Pt=="bigint")return Zn!==null?null:Xe(At,ut,""+Pt,pn);if(typeof Pt=="object"&&Pt!==null){switch(Pt.$$typeof){case Bt:return Pt.key===Zn?kt(At,ut,Pt,pn):null;case Ft:return Pt.key===Zn?Qt(At,ut,Pt,pn):null;case wn:return Pt=bn(Pt),Nn(At,ut,Pt,pn)}if(Ki(Pt)||m(Pt))return Zn!==null?null:xn(At,ut,Pt,pn,null);if(typeof Pt.then=="function")return Nn(At,ut,gn(Pt),pn);if(Pt.$$typeof===Wn)return Nn(At,ut,Q(At,Pt),pn);Bi(At,Pt)}return null}function vi(At,ut,Pt,pn,Zn){if(typeof pn=="string"&&pn!==""||typeof pn=="number"||typeof pn=="bigint")return At=At.get(Pt)||null,Xe(ut,At,""+pn,Zn);if(typeof pn=="object"&&pn!==null){switch(pn.$$typeof){case Bt:return At=At.get(pn.key===null?Pt:pn.key)||null,kt(ut,At,pn,Zn);case Ft:return At=At.get(pn.key===null?Pt:pn.key)||null,Qt(ut,At,pn,Zn);case wn:return pn=bn(pn),vi(At,ut,Pt,pn,Zn)}if(Ki(pn)||m(pn))return At=At.get(Pt)||null,xn(ut,At,pn,Zn,null);if(typeof pn.then=="function")return vi(At,ut,Pt,gn(pn),Zn);if(pn.$$typeof===Wn)return vi(At,ut,Pt,Q(ut,pn),Zn);Bi(ut,pn)}return null}function Us(At,ut,Pt,pn){for(var Zn=null,ds=null,ti=ut,er=ut=0,Aa=null;ti!==null&&er<Pt.length;er++){ti.index>er?(Aa=ti,ti=null):Aa=ti.sibling;var or=Nn(At,ti,Pt[er],pn);if(or===null){ti===null&&(ti=Aa);break}u&&ti&&or.alternate===null&&h(At,ti),ut=H(or,ut,er),ds===null?Zn=or:ds.sibling=or,ds=or,ti=Aa}if(er===Pt.length)return b(At,ti),qi&&Te(At,er),Zn;if(ti===null){for(;er<Pt.length;er++)ti=on(At,Pt[er],pn),ti!==null&&(ut=H(ti,ut,er),ds===null?Zn=ti:ds.sibling=ti,ds=ti);return qi&&Te(At,er),Zn}for(ti=E(ti);er<Pt.length;er++)Aa=vi(ti,At,er,Pt[er],pn),Aa!==null&&(u&&Aa.alternate!==null&&ti.delete(Aa.key===null?er:Aa.key),ut=H(Aa,ut,er),ds===null?Zn=Aa:ds.sibling=Aa,ds=Aa);return u&&ti.forEach(function(Gl){return h(At,Gl)}),qi&&Te(At,er),Zn}function Gh(At,ut,Pt,pn){if(Pt==null)throw Error(r(151));for(var Zn=null,ds=null,ti=ut,er=ut=0,Aa=null,or=Pt.next();ti!==null&&!or.done;er++,or=Pt.next()){ti.index>er?(Aa=ti,ti=null):Aa=ti.sibling;var Gl=Nn(At,ti,or.value,pn);if(Gl===null){ti===null&&(ti=Aa);break}u&&ti&&Gl.alternate===null&&h(At,ti),ut=H(Gl,ut,er),ds===null?Zn=Gl:ds.sibling=Gl,ds=Gl,ti=Aa}if(or.done)return b(At,ti),qi&&Te(At,er),Zn;if(ti===null){for(;!or.done;er++,or=Pt.next())or=on(At,or.value,pn),or!==null&&(ut=H(or,ut,er),ds===null?Zn=or:ds.sibling=or,ds=or);return qi&&Te(At,er),Zn}for(ti=E(ti);!or.done;er++,or=Pt.next())or=vi(ti,At,er,or.value,pn),or!==null&&(u&&or.alternate!==null&&ti.delete(or.key===null?er:or.key),ut=H(or,ut,er),ds===null?Zn=or:ds.sibling=or,ds=or);return u&&ti.forEach(function(Ab){return h(At,Ab)}),qi&&Te(At,er),Zn}function wf(At,ut,Pt,pn){if(typeof Pt=="object"&&Pt!==null&&Pt.type===Kt&&Pt.key===null&&(Pt=Pt.props.children),typeof Pt=="object"&&Pt!==null){switch(Pt.$$typeof){case Bt:e:{for(var Zn=Pt.key;ut!==null;){if(ut.key===Zn){if(Zn=Pt.type,Zn===Kt){if(ut.tag===7){b(At,ut.sibling),pn=O(ut,Pt.props.children),pn.return=At,At=pn;break e}}else if(ut.elementType===Zn||typeof Zn=="object"&&Zn!==null&&Zn.$$typeof===wn&&bn(Zn)===ut.type){b(At,ut.sibling),pn=O(ut,Pt.props),Pn(pn,Pt),pn.return=At,At=pn;break e}b(At,ut);break}else h(At,ut);ut=ut.sibling}Pt.type===Kt?(pn=N(Pt.props.children,At.mode,pn,Pt.key),pn.return=At,At=pn):(pn=M(Pt.type,Pt.key,Pt.props,null,At.mode,pn),Pn(pn,Pt),pn.return=At,At=pn)}return ve(At);case Ft:e:{for(Zn=Pt.key;ut!==null;){if(ut.key===Zn)if(ut.tag===4&&ut.stateNode.containerInfo===Pt.containerInfo&&ut.stateNode.implementation===Pt.implementation){b(At,ut.sibling),pn=O(ut,Pt.children||[]),pn.return=At,At=pn;break e}else{b(At,ut);break}else h(At,ut);ut=ut.sibling}pn=oe(Pt,At.mode,pn),pn.return=At,At=pn}return ve(At);case wn:return Pt=bn(Pt),wf(At,ut,Pt,pn)}if(Ki(Pt))return Us(At,ut,Pt,pn);if(m(Pt)){if(Zn=m(Pt),typeof Zn!="function")throw Error(r(150));return Pt=Zn.call(Pt),Gh(At,ut,Pt,pn)}if(typeof Pt.then=="function")return wf(At,ut,gn(Pt),pn);if(Pt.$$typeof===Wn)return wf(At,ut,Q(At,Pt),pn);Bi(At,Pt)}return typeof Pt=="string"&&Pt!==""||typeof Pt=="number"||typeof Pt=="bigint"?(Pt=""+Pt,ut!==null&&ut.tag===6?(b(At,ut.sibling),pn=O(ut,Pt),pn.return=At,At=pn):(b(At,ut),pn=V(Pt,At.mode,pn),pn.return=At,At=pn),ve(At)):b(At,ut)}return function(At,ut,Pt,pn){try{th=0;var Zn=wf(At,ut,Pt,pn);return mf=null,Zn}catch(ti){if(ti===fa||ti===jl)throw ti;var ds=t(29,ti,null,At.mode);return ds.lanes=pn,ds.return=At,ds}}}function $n(){for(var u=Zc,h=nh=Zc=0;h<u;){var b=Ia[h];Ia[h++]=null;var E=Ia[h];Ia[h++]=null;var O=Ia[h];Ia[h++]=null;var H=Ia[h];if(Ia[h++]=null,E!==null&&O!==null){var ve=E.pending;ve===null?O.next=O:(O.next=ve.next,ve.next=O),E.pending=O}H!==0&&ir(b,O,H)}}function ii(u,h,b,E){Ia[Zc++]=u,Ia[Zc++]=h,Ia[Zc++]=b,Ia[Zc++]=E,nh|=E,u.lanes|=E,u=u.alternate,u!==null&&(u.lanes|=E)}function wi(u,h,b,E){return ii(u,h,b,E),Mi(u)}function Rn(u,h){return ii(u,null,null,h),Mi(u)}function ir(u,h,b){u.lanes|=b;var E=u.alternate;E!==null&&(E.lanes|=b);for(var O=!1,H=u.return;H!==null;)H.childLanes|=b,E=H.alternate,E!==null&&(E.childLanes|=b),H.tag===22&&(u=H.stateNode,u===null||u._visibility&1||(O=!0)),u=H,H=H.return;return u.tag===3?(H=u.stateNode,O&&h!==null&&(O=31-Ao(b),u=H.hiddenUpdates,E=u[O],E===null?u[O]=[h]:E.push(h),h.lane=b|536870912),H):null}function Mi(u){if(50<sr)throw sr=0,Xd=null,Error(r(185));for(var h=u.return;h!==null;)u=h,h=u.return;return u.tag===3?u.stateNode:null}function te(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function be(u,h){u=u.updateQueue,h.updateQueue===u&&(h.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,callbacks:null})}function Ue(u){return{lane:u,tag:0,payload:null,callback:null,next:null}}function lt(u,h,b){var E=u.updateQueue;if(E===null)return null;if(E=E.shared,(zi&2)!==0){var O=E.pending;return O===null?h.next=h:(h.next=O.next,O.next=h),E.pending=h,h=Mi(u),ir(u,null,b),h}return ii(u,E,h,b),Mi(u)}function Tt(u,h,b){if(h=h.updateQueue,h!==null&&(h=h.shared,(b&4194048)!==0)){var E=h.lanes;E&=u.pendingLanes,b|=E,h.lanes=b,L(u,b)}}function St(u,h){var b=u.updateQueue,E=u.alternate;if(E!==null&&(E=E.updateQueue,b===E)){var O=null,H=null;if(b=b.firstBaseUpdate,b!==null){do{var ve={lane:b.lane,tag:b.tag,payload:b.payload,callback:null,next:null};H===null?O=H=ve:H=H.next=ve,b=b.next}while(b!==null);H===null?O=H=h:H=H.next=h}else O=H=h;b={baseState:E.baseState,firstBaseUpdate:O,lastBaseUpdate:H,shared:E.shared,callbacks:E.callbacks},u.updateQueue=b;return}u=b.lastBaseUpdate,u===null?b.firstBaseUpdate=h:u.next=h,b.lastBaseUpdate=h}function Xt(){if(lm){var u=ua;if(u!==null)throw u}}function qt(u,h,b,E){lm=!1;var O=u.updateQueue;tl=!1;var H=O.firstBaseUpdate,ve=O.lastBaseUpdate,Xe=O.shared.pending;if(Xe!==null){O.shared.pending=null;var kt=Xe,Qt=kt.next;kt.next=null,ve===null?H=Qt:ve.next=Qt,ve=kt;var xn=u.alternate;xn!==null&&(xn=xn.updateQueue,Xe=xn.lastBaseUpdate,Xe!==ve&&(Xe===null?xn.firstBaseUpdate=Qt:Xe.next=Qt,xn.lastBaseUpdate=kt))}if(H!==null){var on=O.baseState;ve=0,xn=Qt=kt=null,Xe=H;do{var Nn=Xe.lane&-536870913,vi=Nn!==Xe.lane;if(vi?(Wi&Nn)===Nn:(E&Nn)===Nn){Nn!==0&&Nn===Mu&&(lm=!0),xn!==null&&(xn=xn.next={lane:0,tag:Xe.tag,payload:Xe.payload,callback:null,next:null});e:{var Us=u,Gh=Xe;Nn=h;var wf=b;switch(Gh.tag){case 1:if(Us=Gh.payload,typeof Us=="function"){on=Us.call(wf,on,Nn);break e}on=Us;break e;case 3:Us.flags=Us.flags&-65537|128;case 0:if(Us=Gh.payload,Nn=typeof Us=="function"?Us.call(wf,on,Nn):Us,Nn==null)break e;on=Ut({},on,Nn);break e;case 2:tl=!0}}Nn=Xe.callback,Nn!==null&&(u.flags|=64,vi&&(u.flags|=8192),vi=O.callbacks,vi===null?O.callbacks=[Nn]:vi.push(Nn))}else vi={lane:Nn,tag:Xe.tag,payload:Xe.payload,callback:Xe.callback,next:null},xn===null?(Qt=xn=vi,kt=on):xn=xn.next=vi,ve|=Nn;if(Xe=Xe.next,Xe===null){if(Xe=O.shared.pending,Xe===null)break;vi=Xe,Xe=vi.next,vi.next=null,O.lastBaseUpdate=vi,O.shared.pending=null}}while(!0);xn===null&&(kt=on),O.baseState=kt,O.firstBaseUpdate=Qt,O.lastBaseUpdate=xn,H===null&&(O.shared.lanes=0),Tu|=ve,u.lanes=ve,u.memoizedState=on}}function an(u,h){if(typeof u!="function")throw Error(r(191,u));u.call(h)}function sn(u,h){var b=u.callbacks;if(b!==null)for(u.callbacks=null,u=0;u<b.length;u++)an(b[u],h)}function ln(u,h){u=Jc,S(gf,u),S(ih,h),Jc=u|h.baseLanes}function rn(){S(gf,Jc),S(ih,ih.current)}function fe(){Jc=gf.current,v(ih),v(gf)}function Oe(u){var h=u.alternate;S(Ss,Ss.current&1),S(Eo,u),Co===null&&(h===null||ih.current!==null||h.memoizedState!==null)&&(Co=u)}function $e(u){S(Ss,Ss.current),S(Eo,u),Co===null&&(Co=u)}function et(u){u.tag===22?(S(Ss,Ss.current),S(Eo,u),Co===null&&(Co=u)):Ze()}function Ze(){S(Ss,Ss.current),S(Eo,Eo.current)}function Vt(u){v(Eo),Co===u&&(Co=null),v(Ss)}function en(u){for(var h=u;h!==null;){if(h.tag===13){var b=h.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||mc(b)||Ih(b)))return h}else if(h.tag===19&&(h.memoizedProps.revealOrder==="forwards"||h.memoizedProps.revealOrder==="backwards"||h.memoizedProps.revealOrder==="unstable_legacy-backwards"||h.memoizedProps.revealOrder==="together")){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===u)break;for(;h.sibling===null;){if(h.return===null||h.return===u)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}function Gt(){throw Error(r(321))}function vn(u,h){if(h===null)return!1;for(var b=0;b<h.length&&b<u.length;b++)if(!ks(u[b],h[b]))return!1;return!0}function nn(u,h,b,E,O,H){return Au=H,yi=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,Cn.H=u===null||u.memoizedState===null?us:$c,$i=!1,H=b(E,O),$i=!1,Ti&&(H=cn(h,b,E,O)),Tn(u),H}function Tn(u){Cn.H=nl;var h=zn!==null&&zn.next!==null;if(Au=0,ci=zn=yi=null,Ri=!1,Vl=0,xc=null,h)throw Error(r(300));u===null||Wr||(u=u.dependencies,u!==null&&ht(u)&&(Wr=!0))}function cn(u,h,b,E){yi=u;var O=0;do{if(Ti&&(xc=null),Vl=0,Ti=!1,25<=O)throw Error(r(301));if(O+=1,ci=zn=null,u.updateQueue!=null){var H=u.updateQueue;H.lastEffect=null,H.events=null,H.stores=null,H.memoCache!=null&&(H.memoCache.index=0)}Cn.H=vf,H=h(b,E)}while(Ti);return H}function hn(){var u=Cn.H,h=u.useState()[0];return h=typeof h.then=="function"?mn(h):h,u=u.useState()[0],(zn!==null?zn.memoizedState:null)!==u&&(yi.flags|=1024),h}function si(){var u=Wa!==0;return Wa=0,u}function pi(u,h,b){h.updateQueue=u.updateQueue,h.flags&=-2053,u.lanes&=~b}function ai(u){if(Ri){for(u=u.memoizedState;u!==null;){var h=u.queue;h!==null&&(h.pending=null),u=u.next}Ri=!1}Au=0,ci=zn=yi=null,Ti=!1,Vl=Wa=0,xc=null}function Sn(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ci===null?yi.memoizedState=ci=u:ci=ci.next=u,ci}function Jt(){if(zn===null){var u=yi.alternate;u=u!==null?u.memoizedState:null}else u=zn.next;var h=ci===null?yi.memoizedState:ci.next;if(h!==null)ci=h,zn=u;else{if(u===null)throw yi.alternate===null?Error(r(467)):Error(r(310));zn=u,u={memoizedState:zn.memoizedState,baseState:zn.baseState,baseQueue:zn.baseQueue,queue:zn.queue,next:null},ci===null?yi.memoizedState=ci=u:ci=ci.next=u}return ci}function _n(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function mn(u){var h=Vl;return Vl+=1,xc===null&&(xc=[]),u=Dt(xc,u,h),h=yi,(ci===null?h.memoizedState:ci.next)===null&&(h=h.alternate,Cn.H=h===null||h.memoizedState===null?us:$c),u}function Ui(u){if(u!==null&&typeof u=="object"){if(typeof u.then=="function")return mn(u);if(u.$$typeof===Wn)return he(u)}throw Error(r(438,String(u)))}function ss(u){var h=null,b=yi.updateQueue;if(b!==null&&(h=b.memoCache),h==null){var E=yi.alternate;E!==null&&(E=E.updateQueue,E!==null&&(E=E.memoCache,E!=null&&(h={data:E.data.map(function(O){return O.slice()}),index:0})))}if(h==null&&(h={data:[],index:0}),b===null&&(b=_n(),yi.updateQueue=b),b.memoCache=h,b=h.data[h.index],b===void 0)for(b=h.data[h.index]=Array(u),E=0;E<u;E++)b[E]=Gr;return h.index++,b}function mi(u,h){return typeof h=="function"?h(u):h}function Yi(u){var h=Jt();return Xi(h,zn,u)}function Xi(u,h,b){var E=u.queue;if(E===null)throw Error(r(311));E.lastRenderedReducer=b;var O=u.baseQueue,H=E.pending;if(H!==null){if(O!==null){var ve=O.next;O.next=H.next,H.next=ve}h.baseQueue=O=H,E.pending=null}if(H=u.baseState,O===null)u.memoizedState=H;else{h=O.next;var Xe=ve=null,kt=null,Qt=h,xn=!1;do{var on=Qt.lane&-536870913;if(on!==Qt.lane?(Wi&on)===on:(Au&on)===on){var Nn=Qt.revertLane;if(Nn===0)kt!==null&&(kt=kt.next={lane:0,revertLane:0,gesture:null,action:Qt.action,hasEagerState:Qt.hasEagerState,eagerState:Qt.eagerState,next:null}),on===Mu&&(xn=!0);else if((Au&Nn)===Nn){Qt=Qt.next,Nn===Mu&&(xn=!0);continue}else on={lane:0,revertLane:Qt.revertLane,gesture:null,action:Qt.action,hasEagerState:Qt.hasEagerState,eagerState:Qt.eagerState,next:null},kt===null?(Xe=kt=on,ve=H):kt=kt.next=on,yi.lanes|=Nn,Tu|=Nn;on=Qt.action,$i&&b(H,on),H=Qt.hasEagerState?Qt.eagerState:b(H,on)}else Nn={lane:on,revertLane:Qt.revertLane,gesture:Qt.gesture,action:Qt.action,hasEagerState:Qt.hasEagerState,eagerState:Qt.eagerState,next:null},kt===null?(Xe=kt=Nn,ve=H):kt=kt.next=Nn,yi.lanes|=on,Tu|=on;Qt=Qt.next}while(Qt!==null&&Qt!==h);if(kt===null?ve=H:kt.next=Xe,!ks(H,u.memoizedState)&&(Wr=!0,xn&&(b=ua,b!==null)))throw b;u.memoizedState=H,u.baseState=ve,u.baseQueue=kt,E.lastRenderedState=H}return O===null&&(E.lanes=0),[u.memoizedState,E.dispatch]}function Zr(u){var h=Jt(),b=h.queue;if(b===null)throw Error(r(311));b.lastRenderedReducer=u;var E=b.dispatch,O=b.pending,H=h.memoizedState;if(O!==null){b.pending=null;var ve=O=O.next;do H=u(H,ve.action),ve=ve.next;while(ve!==O);ks(H,h.memoizedState)||(Wr=!0),h.memoizedState=H,h.baseQueue===null&&(h.baseState=H),b.lastRenderedState=H}return[H,E]}function Tr(u,h,b){var E=yi,O=Jt(),H=qi;if(H){if(b===void 0)throw Error(r(407));b=b()}else b=h();var ve=!ks((zn||O).memoizedState,b);if(ve&&(O.memoizedState=b,Wr=!0),O=O.queue,Pc(Zl.bind(null,E,O,u),[u]),O.getSnapshot!==h||ve||ci!==null&&ci.memoizedState.tag&1){if(E.flags|=2048,Hs(9,{destroy:void 0},gs.bind(null,E,O,b,h),null),Li===null)throw Error(r(349));H||(Au&127)!==0||Pr(E,h,b)}return b}function Pr(u,h,b){u.flags|=16384,u={getSnapshot:h,value:b},h=yi.updateQueue,h===null?(h=_n(),yi.updateQueue=h,h.stores=[u]):(b=h.stores,b===null?h.stores=[u]:b.push(u))}function gs(u,h,b,E){h.value=b,h.getSnapshot=E,Oa(h)&&Hu(u)}function Zl(u,h,b){return b(function(){Oa(h)&&Hu(u)})}function Oa(u){var h=u.getSnapshot;u=u.value;try{var b=h();return!ks(u,b)}catch{return!0}}function Hu(u){var h=Rn(u,2);h!==null&&Cr(h,u,2)}function Gu(u){var h=Sn();if(typeof u=="function"){var b=u;if(u=b(),$i){W(!0);try{b()}finally{W(!1)}}}return h.memoizedState=h.baseState=u,h.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mi,lastRenderedState:u},h}function Ea(u,h,b,E){return u.baseState=b,Xi(u,zn,typeof E=="function"?E:mi)}function jo(u,h,b,E,O){if(jt(u))throw Error(r(485));if(u=h.action,u!==null){var H={payload:O,action:u,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ve){H.listeners.push(ve)}};Cn.T!==null?b(!0):H.isTransition=!1,E(H),b=h.pending,b===null?(H.next=h.pending=H,pl(h,H)):(H.next=b.next,h.pending=b.next=H)}}function pl(u,h){var b=h.action,E=h.payload,O=u.state;if(h.isTransition){var H=Cn.T,ve={};Cn.T=ve;try{var Xe=b(O,E),kt=Cn.S;kt!==null&&kt(ve,Xe),Nc(u,h,Xe)}catch(Qt){qn(u,h,Qt)}finally{H!==null&&ve.types!==null&&(H.types=ve.types),Cn.T=H}}else try{H=b(O,E),Nc(u,h,H)}catch(Qt){qn(u,h,Qt)}}function Nc(u,h,b){b!==null&&typeof b=="object"&&typeof b.then=="function"?b.then(function(E){$l(u,h,E)},function(E){return qn(u,h,E)}):$l(u,h,b)}function $l(u,h,b){h.status="fulfilled",h.value=b,Uf(h),u.state=b,h=u.pending,h!==null&&(b=h.next,b===h?u.pending=null:(b=b.next,h.next=b,pl(u,b)))}function qn(u,h,b){var E=u.pending;if(u.pending=null,E!==null){E=E.next;do h.status="rejected",h.reason=b,Uf(h),h=h.next;while(h!==E)}u.action=null}function Uf(u){u=u.listeners;for(var h=0;h<u.length;h++)(0,u[h])()}function qu(u,h){return h}function Ff(u,h){if(qi){var b=Li.formState;if(b!==null){e:{var E=yi;if(qi){if(is){var O=T1(is,uo);if(O){is=E1(O),E=C0(O);break e}}Fe(E)}E=!1}E&&(h=b[0])}}b=Sn(),b.memoizedState=b.baseState=h,E={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qu,lastRenderedState:h},b.queue=E,b=Ie.bind(null,yi,E),E.dispatch=b,E=Gu(!1);var H=at.bind(null,yi,!1,E.queue);return E=Sn(),O={state:h,dispatch:null,action:u,pending:null},E.queue=O,b=jo.bind(null,yi,O,H,b),O.dispatch=b,E.memoizedState=u,[h,b,!1]}function Ba(u){var h=Jt();return Vs(h,zn,u)}function Vs(u,h,b){if(h=Xi(u,h,qu)[0],u=Yi(mi)[0],typeof h=="object"&&h!==null&&typeof h.then=="function")try{var E=mn(h)}catch(ve){throw ve===fa?jl:ve}else E=h;h=Jt();var O=h.queue,H=O.dispatch;return b!==h.memoizedState&&(yi.flags|=2048,Hs(9,{destroy:void 0},zf.bind(null,O,b),null)),[E,H,u]}function zf(u,h){u.action=h}function Rc(u){var h=Jt(),b=zn;if(b!==null)return Vs(h,b,u);Jt(),h=h.memoizedState,b=Jt();var E=b.queue.dispatch;return b.memoizedState=u,[h,E,!1]}function Hs(u,h,b,E){return u={tag:u,create:b,deps:E,inst:h,next:null},h=yi.updateQueue,h===null&&(h=_n(),yi.updateQueue=h),b=h.lastEffect,b===null?h.lastEffect=u.next=u:(E=b.next,b.next=u,u.next=E,h.lastEffect=u),u}function Lc(){return Jt().memoizedState}function Ja(u,h,b,E){var O=Sn();yi.flags|=u,O.memoizedState=Hs(1|h,{destroy:void 0},b,E===void 0?null:E)}function cu(u,h,b,E){var O=Jt();E=E===void 0?null:E;var H=O.memoizedState.inst;zn!==null&&E!==null&&vn(E,zn.memoizedState.deps)?O.memoizedState=Hs(h,H,b,E):(yi.flags|=u,O.memoizedState=Hs(1|h,H,b,E))}function Ka(u,h){Ja(8390656,8,u,h)}function Pc(u,h){cu(2048,8,u,h)}function Wu(u){yi.flags|=4;var h=yi.updateQueue;if(h===null)h=_n(),yi.updateQueue=h,h.events=[u];else{var b=h.events;b===null?h.events=[u]:b.push(u)}}function Ns(u){var h=Jt().memoizedState;return Wu({ref:h,nextImpl:u}),function(){if((zi&2)!==0)throw Error(r(440));return h.impl.apply(void 0,arguments)}}function Vo(u,h){return cu(4,2,u,h)}function Qa(u,h){return cu(4,4,u,h)}function ml(u,h){if(typeof h=="function"){u=u();var b=h(u);return function(){typeof b=="function"?b():h(null)}}if(h!=null)return u=u(),h.current=u,function(){h.current=null}}function uu(u,h,b){b=b!=null?b.concat([u]):null,cu(4,4,ml.bind(null,h,u),b)}function Jl(){}function gl(u,h){var b=Jt();h=h===void 0?null:h;var E=b.memoizedState;return h!==null&&vn(h,E[1])?E[0]:(b.memoizedState=[u,h],u)}function vl(u,h){var b=Jt();h=h===void 0?null:h;var E=b.memoizedState;if(h!==null&&vn(h,E[1]))return E[0];if(E=u(),$i){W(!0);try{u()}finally{W(!1)}}return b.memoizedState=[E,h],E}function Kl(u,h,b){return b===void 0||(Au&1073741824)!==0&&(Wi&261930)===0?u.memoizedState=h:(u.memoizedState=b,u=lc(),yi.lanes|=u,Tu|=u,b)}function Xu(u,h,b,E){return ks(b,h)?b:ih.current!==null?(u=Kl(u,b,E),ks(u,h)||(Wr=!0),u):(Au&42)===0||(Au&1073741824)!==0&&(Wi&261930)===0?(Wr=!0,u.memoizedState=b):(u=lc(),yi.lanes|=u,Tu|=u,h)}function xl(u,h,b,E,O){var H=es();Kn(H!==0&&8>H?H:8);var ve=Cn.T,Xe={};Cn.T=Xe,at(u,!1,h,b);try{var kt=O(),Qt=Cn.S;if(Qt!==null&&Qt(Xe,kt),kt!==null&&typeof kt=="object"&&typeof kt.then=="function"){var xn=ze(kt,E);qe(u,h,xn,Dr(u))}else qe(u,h,E,Dr(u))}catch(on){qe(u,h,{then:function(){},status:"rejected",reason:on},Dr())}finally{Kn(H),ve!==null&&Xe.types!==null&&(ve.types=Xe.types),Cn.T=ve}}function yl(u){var h=u.memoizedState;if(h!==null)return h;h={memoizedState:Ha,baseState:Ha,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mi,lastRenderedState:Ha},next:null};var b={};return h.next={memoizedState:b,baseState:b,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mi,lastRenderedState:b},next:null},u.memoizedState=h,u=u.alternate,u!==null&&(u.memoizedState=h),h}function Yu(){return he(yu)}function bl(){return Jt().memoizedState}function jf(){return Jt().memoizedState}function B(u){for(var h=u.return;h!==null;){switch(h.tag){case 24:case 3:var b=Dr();u=Ue(b);var E=lt(h,u,b);E!==null&&(Cr(E,h,b),Tt(E,h,b)),h={cache:ue()},u.payload=h;return}h=h.return}}function ae(u,h,b){var E=Dr();b={lane:E,revertLane:0,gesture:null,action:b,hasEagerState:!1,eagerState:null,next:null},jt(u)?$t(h,b):(b=wi(u,h,b,E),b!==null&&(Cr(b,u,E),In(b,h,E)))}function Ie(u,h,b){var E=Dr();qe(u,h,b,E)}function qe(u,h,b,E){var O={lane:E,revertLane:0,gesture:null,action:b,hasEagerState:!1,eagerState:null,next:null};if(jt(u))$t(h,O);else{var H=u.alternate;if(u.lanes===0&&(H===null||H.lanes===0)&&(H=h.lastRenderedReducer,H!==null))try{var ve=h.lastRenderedState,Xe=H(ve,b);if(O.hasEagerState=!0,O.eagerState=Xe,ks(Xe,ve))return ii(u,h,O,0),Li===null&&$n(),!1}catch{}if(b=wi(u,h,O,E),b!==null)return Cr(b,u,E),In(b,h,E),!0}return!1}function at(u,h,b,E){if(E={lane:2,revertLane:Pe(),gesture:null,action:E,hasEagerState:!1,eagerState:null,next:null},jt(u)){if(h)throw Error(r(479))}else h=wi(u,b,E,2),h!==null&&Cr(h,u,2)}function jt(u){var h=u.alternate;return u===yi||h!==null&&h===yi}function $t(u,h){Ti=Ri=!0;var b=u.pending;b===null?h.next=h:(h.next=b.next,b.next=h),u.pending=h}function In(u,h,b){if((b&4194048)!==0){var E=h.lanes;E&=u.pendingLanes,b|=E,h.lanes=b,L(u,b)}}function On(u,h,b,E){h=u.memoizedState,b=b(E,h),b=b==null?h:Ut({},h,b),u.memoizedState=b,u.lanes===0&&(u.updateQueue.baseState=b)}function Jn(u,h,b,E,O,H,ve){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(E,H,ve):h.prototype&&h.prototype.isPureReactComponent?!Ve(b,E)||!Ve(O,H):!0}function fi(u,h,b,E){u=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(b,E),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(b,E),h.state!==u&&Vd.enqueueReplaceState(h,h.state,null)}function Ai(u,h){var b=h;if("ref"in h){b={};for(var E in h)E!=="ref"&&(b[E]=h[E])}if(u=u.defaultProps){b===h&&(b=Ut({},b));for(var O in u)b[O]===void 0&&(b[O]=u[O])}return b}function yr(u,h){try{var b=u.onUncaughtError;b(h.value,{componentStack:h.stack})}catch(E){setTimeout(function(){throw E})}}function $r(u,h,b){try{var E=u.onCaughtError;E(b.value,{componentStack:b.stack,errorBoundary:h.tag===1?h.stateNode:null})}catch(O){setTimeout(function(){throw O})}}function ur(u,h,b){return b=Ue(b),b.tag=3,b.payload={element:null},b.callback=function(){yr(u,h)},b}function vs(u){return u=Ue(u),u.tag=3,u}function as(u,h,b,E){var O=b.type.getDerivedStateFromError;if(typeof O=="function"){var H=E.value;u.payload=function(){return O(H)},u.callback=function(){$r(h,b,E)}}var ve=b.stateNode;ve!==null&&typeof ve.componentDidCatch=="function"&&(u.callback=function(){$r(h,b,E),typeof O!="function"&&(Eu===null?Eu=new Set([this]):Eu.add(this));var Xe=E.stack;this.componentDidCatch(E.value,{componentStack:Xe!==null?Xe:""})})}function ea(u,h,b,E,O){if(b.flags|=32768,E!==null&&typeof E=="object"&&typeof E.then=="function"){if(h=b.alternate,h!==null&&Ct(h,b,O,!0),b=Eo.current,b!==null){switch(b.tag){case 31:case 13:return Co===null?Va():b.alternate===null&&hs===0&&(hs=3),b.flags&=-257,b.flags|=65536,b.lanes=O,E===Yc?b.flags|=16384:(h=b.updateQueue,h===null?b.updateQueue=new Set([E]):h.add(E),sf(u,E,O)),!1;case 22:return b.flags|=65536,E===Yc?b.flags|=16384:(h=b.updateQueue,h===null?(h={transitions:null,markerInstances:null,retryQueue:new Set([E])},b.updateQueue=h):(b=h.retryQueue,b===null?h.retryQueue=new Set([E]):b.add(E)),sf(u,E,O)),!1}throw Error(r(435,b.tag))}return sf(u,E,O),Va(),!1}if(qi)return h=Eo.current,h!==null?((h.flags&65536)===0&&(h.flags|=256),h.flags|=65536,h.lanes=O,E!==sm&&(u=Error(r(422),{cause:E}),le(Re(u,b)))):(E!==sm&&(h=Error(r(423),{cause:E}),le(Re(h,b))),u=u.current.alternate,u.flags|=65536,O&=-O,u.lanes|=O,E=Re(E,b),O=ur(u.stateNode,E,O),St(u,O),hs!==4&&(hs=2)),!1;var H=Error(r(520),{cause:E});if(H=Re(H,b),Gd===null?Gd=[H]:Gd.push(H),hs!==4&&(hs=2),h===null)return!0;E=Re(E,b),b=h;do{switch(b.tag){case 3:return b.flags|=65536,u=O&-O,b.lanes|=u,u=ur(b.stateNode,E,u),St(b,u),!1;case 1:if(h=b.type,H=b.stateNode,(b.flags&128)===0&&(typeof h.getDerivedStateFromError=="function"||H!==null&&typeof H.componentDidCatch=="function"&&(Eu===null||!Eu.has(H))))return b.flags|=65536,O&=-O,b.lanes|=O,O=vs(O),as(O,u,b,E),St(b,O),!1}b=b.return}while(b!==null);return!1}function Er(u,h,b,E){h.child=u===null?W0(h,null,b,E):Pa(h,u.child,b,E)}function yo(u,h,b,E,O){b=b.render;var H=h.ref;if("ref"in E){var ve={};for(var Xe in E)Xe!=="ref"&&(ve[Xe]=E[Xe])}else ve=E;return xt(h),E=nn(u,h,b,ve,H,O),Xe=si(),u!==null&&!Wr?(pi(u,h,O),Jr(u,h,O)):(qi&&Xe&&F(h),h.flags|=1,Er(u,h,E,O),h.child)}function _l(u,h,b,E,O){if(u===null){var H=b.type;return typeof H=="function"&&!xu(H)&&H.defaultProps===void 0&&b.compare===null?(h.tag=15,h.type=H,Zu(u,h,H,E,O)):(u=M(b.type,null,E,h,h.mode,O),u.ref=h.ref,u.return=h,h.child=u)}if(H=u.child,!ta(u,O)){var ve=H.memoizedProps;if(b=b.compare,b=b!==null?b:Ve,b(ve,E)&&u.ref===h.ref)return Jr(u,h,O)}return h.flags|=1,u=co(H,E),u.ref=h.ref,u.return=h,h.child=u}function Zu(u,h,b,E,O){if(u!==null){var H=u.memoizedProps;if(Ve(H,E)&&u.ref===h.ref)if(Wr=!1,h.pendingProps=E=H,ta(u,O))(u.flags&131072)!==0&&(Wr=!0);else return h.lanes=u.lanes,Jr(u,h,O)}return Ml(u,h,b,E,O)}function fu(u,h,b,E){var O=E.children,H=u!==null?u.memoizedState:null;if(u===null&&h.stateNode===null&&(h.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),E.mode==="hidden"){if((h.flags&128)!==0){if(H=H!==null?H.baseLanes|b:b,u!==null){for(E=h.child=u.child,O=0;E!==null;)O=O|E.lanes|E.childLanes,E=E.sibling;E=O&~H}else E=0,h.child=null;return bo(u,h,H,b,E)}if((b&536870912)!==0)h.memoizedState={baseLanes:0,cachePool:null},u!==null&&Rt(h,H!==null?H.cachePool:null),H!==null?ln(h,H):rn(),et(h);else return E=h.lanes=536870912,bo(u,h,H!==null?H.baseLanes|b:b,b,E)}else H!==null?(Rt(h,H.cachePool),ln(h,H),Ze(),h.memoizedState=null):(u!==null&&Rt(h,null),rn(),Ze());return Er(u,h,O,b),h.child}function Ua(u,h){return u!==null&&u.tag===22||h.stateNode!==null||(h.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.sibling}function bo(u,h,b,E,O){var H=Mt();return H=H===null?null:{parent:Gi?rs._currentValue:rs._currentValue2,pool:H},h.memoizedState={baseLanes:b,cachePool:H},u!==null&&Rt(h,null),rn(),et(h),u!==null&&Ct(u,h,E,!0),h.childLanes=O,null}function Sl(u,h){return h=Fa({mode:h.mode,children:h.children},u.mode),h.ref=u.ref,u.child=h,h.return=u,h}function wl(u,h,b){return Pa(h,u.child,null,b),u=Sl(h,h.pendingProps),u.flags|=2,Vt(h),h.memoizedState=null,u}function Gs(u,h,b){var E=h.pendingProps,O=(h.flags&128)!==0;if(h.flags&=-129,u===null){if(qi){if(E.mode==="hidden")return u=Sl(h,E),h.lanes=536870912,Ua(null,u);if($e(h),(u=is)?(u=R0(u,uo),u!==null&&(h.memoizedState={dehydrated:u,treeContext:Bl!==null?{id:Ra,overflow:gc}:null,retryLane:536870912,hydrationErrors:null},b=Y(u),b.return=h,h.child=b,ca=h,is=null)):u=null,u===null)throw Fe(h);return h.lanes=536870912,null}return Sl(h,E)}var H=u.memoizedState;if(H!==null){var ve=H.dehydrated;if($e(h),O)if(h.flags&256)h.flags&=-257,h=wl(u,h,b);else if(h.memoizedState!==null)h.child=u.child,h.flags|=128,h=null;else throw Error(r(558));else if(Wr||Ct(u,h,b,!1),O=(b&u.childLanes)!==0,Wr||O){if(E=Li,E!==null&&(ve=k(E,b),ve!==0&&ve!==H.retryLane))throw H.retryLane=ve,Rn(u,ve),Cr(E,u,ve),ho;Va(),h=wl(u,h,b)}else u=H.treeContext,Ii&&(is=L1(ve),ca=h,qi=!0,Xc=null,uo=!1,u!==null&&re(h,u)),h=Sl(h,E),h.flags|=4096;return h}return u=co(u.child,{mode:E.mode,children:E.children}),u.ref=h.ref,h.child=u,u.return=h,u}function Ho(u,h){var b=h.ref;if(b===null)u!==null&&u.ref!==null&&(h.flags|=4194816);else{if(typeof b!="function"&&typeof b!="object")throw Error(r(284));(u===null||u.ref!==b)&&(h.flags|=4194816)}}function Ml(u,h,b,E,O){return xt(h),b=nn(u,h,b,E,void 0,O),E=si(),u!==null&&!Wr?(pi(u,h,O),Jr(u,h,O)):(qi&&E&&F(h),h.flags|=1,Er(u,h,b,O),h.child)}function hu(u,h,b,E,O,H){return xt(h),h.updateQueue=null,b=cn(h,E,b,O),Tn(u),E=si(),u!==null&&!Wr?(pi(u,h,H),Jr(u,h,H)):(qi&&E&&F(h),h.flags|=1,Er(u,h,b,H),h.child)}function Go(u,h,b,E,O){if(xt(h),h.stateNode===null){var H=Gc,ve=b.contextType;typeof ve=="object"&&ve!==null&&(H=he(ve)),H=new b(E,H),h.memoizedState=H.state!==null&&H.state!==void 0?H.state:null,H.updater=Vd,h.stateNode=H,H._reactInternals=h,H=h.stateNode,H.props=E,H.state=h.memoizedState,H.refs={},te(h),ve=b.contextType,H.context=typeof ve=="object"&&ve!==null?he(ve):Gc,H.state=h.memoizedState,ve=b.getDerivedStateFromProps,typeof ve=="function"&&(On(h,b,ve,E),H.state=h.memoizedState),typeof b.getDerivedStateFromProps=="function"||typeof H.getSnapshotBeforeUpdate=="function"||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(ve=H.state,typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount(),ve!==H.state&&Vd.enqueueReplaceState(H,H.state,null),qt(h,E,H,O),Xt(),H.state=h.memoizedState),typeof H.componentDidMount=="function"&&(h.flags|=4194308),E=!0}else if(u===null){H=h.stateNode;var Xe=h.memoizedProps,kt=Ai(b,Xe);H.props=kt;var Qt=H.context,xn=b.contextType;ve=Gc,typeof xn=="object"&&xn!==null&&(ve=he(xn));var on=b.getDerivedStateFromProps;xn=typeof on=="function"||typeof H.getSnapshotBeforeUpdate=="function",Xe=h.pendingProps!==Xe,xn||typeof H.UNSAFE_componentWillReceiveProps!="function"&&typeof H.componentWillReceiveProps!="function"||(Xe||Qt!==ve)&&fi(h,H,E,ve),tl=!1;var Nn=h.memoizedState;H.state=Nn,qt(h,E,H,O),Xt(),Qt=h.memoizedState,Xe||Nn!==Qt||tl?(typeof on=="function"&&(On(h,b,on,E),Qt=h.memoizedState),(kt=tl||Jn(h,b,kt,E,Nn,Qt,ve))?(xn||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount()),typeof H.componentDidMount=="function"&&(h.flags|=4194308)):(typeof H.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=E,h.memoizedState=Qt),H.props=E,H.state=Qt,H.context=ve,E=kt):(typeof H.componentDidMount=="function"&&(h.flags|=4194308),E=!1)}else{H=h.stateNode,be(u,h),ve=h.memoizedProps,xn=Ai(b,ve),H.props=xn,on=h.pendingProps,Nn=H.context,Qt=b.contextType,kt=Gc,typeof Qt=="object"&&Qt!==null&&(kt=he(Qt)),Xe=b.getDerivedStateFromProps,(Qt=typeof Xe=="function"||typeof H.getSnapshotBeforeUpdate=="function")||typeof H.UNSAFE_componentWillReceiveProps!="function"&&typeof H.componentWillReceiveProps!="function"||(ve!==on||Nn!==kt)&&fi(h,H,E,kt),tl=!1,Nn=h.memoizedState,H.state=Nn,qt(h,E,H,O),Xt();var vi=h.memoizedState;ve!==on||Nn!==vi||tl||u!==null&&u.dependencies!==null&&ht(u.dependencies)?(typeof Xe=="function"&&(On(h,b,Xe,E),vi=h.memoizedState),(xn=tl||Jn(h,b,xn,E,Nn,vi,kt)||u!==null&&u.dependencies!==null&&ht(u.dependencies))?(Qt||typeof H.UNSAFE_componentWillUpdate!="function"&&typeof H.componentWillUpdate!="function"||(typeof H.componentWillUpdate=="function"&&H.componentWillUpdate(E,vi,kt),typeof H.UNSAFE_componentWillUpdate=="function"&&H.UNSAFE_componentWillUpdate(E,vi,kt)),typeof H.componentDidUpdate=="function"&&(h.flags|=4),typeof H.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof H.componentDidUpdate!="function"||ve===u.memoizedProps&&Nn===u.memoizedState||(h.flags|=4),typeof H.getSnapshotBeforeUpdate!="function"||ve===u.memoizedProps&&Nn===u.memoizedState||(h.flags|=1024),h.memoizedProps=E,h.memoizedState=vi),H.props=E,H.state=vi,H.context=kt,E=xn):(typeof H.componentDidUpdate!="function"||ve===u.memoizedProps&&Nn===u.memoizedState||(h.flags|=4),typeof H.getSnapshotBeforeUpdate!="function"||ve===u.memoizedProps&&Nn===u.memoizedState||(h.flags|=1024),E=!1)}return H=E,Ho(u,h),E=(h.flags&128)!==0,H||E?(H=h.stateNode,b=E&&typeof b.getDerivedStateFromError!="function"?null:H.render(),h.flags|=1,u!==null&&E?(h.child=Pa(h,u.child,null,O),h.child=Pa(h,null,b,O)):Er(u,h,b,O),h.memoizedState=H.state,u=h.child):u=Jr(u,h,O),u}function ya(u,h,b,E){return wt(),h.flags|=256,Er(u,h,b,E),h.child}function qo(u){return{baseLanes:u,cachePool:se()}}function Ic(u,h,b){return u=u!==null?u.childLanes&~b:0,h&&(u|=po),u}function $u(u,h,b){var E=h.pendingProps,O=!1,H=(h.flags&128)!==0,ve;if((ve=H)||(ve=u!==null&&u.memoizedState===null?!1:(Ss.current&2)!==0),ve&&(O=!0,h.flags&=-129),ve=(h.flags&32)!==0,h.flags&=-33,u===null){if(qi){if(O?Oe(h):Ze(),(u=is)?(u=k1(u,uo),u!==null&&(h.memoizedState={dehydrated:u,treeContext:Bl!==null?{id:Ra,overflow:gc}:null,retryLane:536870912,hydrationErrors:null},b=Y(u),b.return=h,h.child=b,ca=h,is=null)):u=null,u===null)throw Fe(h);return Ih(u)?h.lanes=32:h.lanes=536870912,null}var Xe=E.children;return E=E.fallback,O?(Ze(),O=h.mode,Xe=Fa({mode:"hidden",children:Xe},O),E=N(E,O,b,null),Xe.return=h,E.return=h,Xe.sibling=E,h.child=Xe,E=h.child,E.memoizedState=qo(b),E.childLanes=Ic(u,ve,b),h.memoizedState=rh,Ua(null,E)):(Oe(h),Ca(h,Xe))}var kt=u.memoizedState;if(kt!==null&&(Xe=kt.dehydrated,Xe!==null)){if(H)h.flags&256?(Oe(h),h.flags&=-257,h=Wo(u,h,b)):h.memoizedState!==null?(Ze(),h.child=u.child,h.flags|=128,h=null):(Ze(),Xe=E.fallback,O=h.mode,E=Fa({mode:"visible",children:E.children},O),Xe=N(Xe,O,b,null),Xe.flags|=2,E.return=h,Xe.return=h,E.sibling=Xe,h.child=E,Pa(h,u.child,null,b),E=h.child,E.memoizedState=qo(b),E.childLanes=Ic(u,ve,b),h.memoizedState=rh,h=Ua(null,E));else if(Oe(h),Ih(Xe))ve=uf(Xe).digest,E=Error(r(419)),E.stack="",E.digest=ve,le({value:E,source:null,stack:null}),h=Wo(u,h,b);else if(Wr||Ct(u,h,b,!1),ve=(b&u.childLanes)!==0,Wr||ve){if(ve=Li,ve!==null&&(E=k(ve,b),E!==0&&E!==kt.retryLane))throw kt.retryLane=E,Rn(u,E),Cr(ve,u,E),ho;mc(Xe)||Va(),h=Wo(u,h,b)}else mc(Xe)?(h.flags|=192,h.child=u.child,h=null):(u=kt.treeContext,Ii&&(is=P1(Xe),ca=h,qi=!0,Xc=null,uo=!1,u!==null&&re(h,u)),h=Ca(h,E.children),h.flags|=4096);return h}return O?(Ze(),Xe=E.fallback,O=h.mode,kt=u.child,H=kt.sibling,E=co(kt,{mode:"hidden",children:E.children}),E.subtreeFlags=kt.subtreeFlags&65011712,H!==null?Xe=co(H,Xe):(Xe=N(Xe,O,b,null),Xe.flags|=2),Xe.return=h,E.return=h,E.sibling=Xe,h.child=E,Ua(null,E),E=h.child,Xe=u.child.memoizedState,Xe===null?Xe=qo(b):(O=Xe.cachePool,O!==null?(kt=Gi?rs._currentValue:rs._currentValue2,O=O.parent!==kt?{parent:kt,pool:kt}:O):O=se(),Xe={baseLanes:Xe.baseLanes|b,cachePool:O}),E.memoizedState=Xe,E.childLanes=Ic(u,ve,b),h.memoizedState=rh,Ua(u.child,E)):(Oe(h),b=u.child,u=b.sibling,b=co(b,{mode:"visible",children:E.children}),b.return=h,b.sibling=null,u!==null&&(ve=h.deletions,ve===null?(h.deletions=[u],h.flags|=16):ve.push(u)),h.child=b,h.memoizedState=null,b)}function Ca(u,h){return h=Fa({mode:"visible",children:h},u.mode),h.return=u,u.child=h}function Fa(u,h){return u=t(22,u,null,h),u.lanes=0,u}function Wo(u,h,b){return Pa(h,u.child,null,b),u=Ca(h,h.pendingProps.children),u.flags|=2,h.memoizedState=null,u}function Ju(u,h,b){u.lanes|=h;var E=u.alternate;E!==null&&(E.lanes|=h),we(u.return,h,b)}function eo(u,h,b,E,O,H){var ve=u.memoizedState;ve===null?u.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:E,tail:b,tailMode:O,treeForkCount:H}:(ve.isBackwards=h,ve.rendering=null,ve.renderingStartTime=0,ve.last=E,ve.tail=b,ve.tailMode=O,ve.treeForkCount=H)}function Ql(u,h,b){var E=h.pendingProps,O=E.revealOrder,H=E.tail;E=E.children;var ve=Ss.current,Xe=(ve&2)!==0;if(Xe?(ve=ve&1|2,h.flags|=128):ve&=1,S(Ss,ve),Er(u,h,E,b),E=qi?Fd:0,!Xe&&u!==null&&(u.flags&128)!==0)e:for(u=h.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&Ju(u,b,h);else if(u.tag===19)Ju(u,b,h);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===h)break e;for(;u.sibling===null;){if(u.return===null||u.return===h)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}switch(O){case"forwards":for(b=h.child,O=null;b!==null;)u=b.alternate,u!==null&&en(u)===null&&(O=b),b=b.sibling;b=O,b===null?(O=h.child,h.child=null):(O=b.sibling,b.sibling=null),eo(h,!1,O,b,H,E);break;case"backwards":case"unstable_legacy-backwards":for(b=null,O=h.child,h.child=null;O!==null;){if(u=O.alternate,u!==null&&en(u)===null){h.child=O;break}u=O.sibling,O.sibling=b,b=O,O=u}eo(h,!0,b,null,H,E);break;case"together":eo(h,!1,null,null,void 0,E);break;default:h.memoizedState=null}return h.child}function Jr(u,h,b){if(u!==null&&(h.dependencies=u.dependencies),Tu|=h.lanes,(b&h.childLanes)===0)if(u!==null){if(Ct(u,h,b,!1),(b&h.childLanes)===0)return null}else return null;if(u!==null&&h.child!==u.child)throw Error(r(153));if(h.child!==null){for(u=h.child,b=co(u,u.pendingProps),h.child=b,b.return=h;u.sibling!==null;)u=u.sibling,b=b.sibling=co(u,u.pendingProps),b.return=h;b.sibling=null}return h.child}function ta(u,h){return(u.lanes&h)!==0?!0:(u=u.dependencies,!!(u!==null&&ht(u)))}function Al(u,h,b){switch(h.tag){case 3:Ae(h,h.stateNode.containerInfo),Qe(h,rs,u.memoizedState.cache),wt();break;case 27:case 5:_e(h);break;case 4:Ae(h,h.stateNode.containerInfo);break;case 10:Qe(h,h.type,h.memoizedProps.value);break;case 31:if(h.memoizedState!==null)return h.flags|=128,$e(h),null;break;case 13:var E=h.memoizedState;if(E!==null)return E.dehydrated!==null?(Oe(h),h.flags|=128,null):(b&h.child.childLanes)!==0?$u(u,h,b):(Oe(h),u=Jr(u,h,b),u!==null?u.sibling:null);Oe(h);break;case 19:var O=(u.flags&128)!==0;if(E=(b&h.childLanes)!==0,E||(Ct(u,h,b,!1),E=(b&h.childLanes)!==0),O){if(E)return Ql(u,h,b);h.flags|=128}if(O=h.memoizedState,O!==null&&(O.rendering=null,O.tail=null,O.lastEffect=null),S(Ss,Ss.current),E)break;return null;case 22:return h.lanes=0,fu(u,h,b,h.pendingProps);case 24:Qe(h,rs,u.memoizedState.cache)}return Jr(u,h,b)}function Xo(u,h,b){if(u!==null)if(u.memoizedProps!==h.pendingProps)Wr=!0;else{if(!ta(u,b)&&(h.flags&128)===0)return Wr=!1,Al(u,h,b);Wr=(u.flags&131072)!==0}else Wr=!1,qi&&(h.flags&1048576)!==0&&ee(h,Fd,h.index);switch(h.lanes=0,h.tag){case 16:e:{var E=h.pendingProps;if(u=bn(h.elementType),h.type=u,typeof u=="function")xu(u)?(E=Ai(u,E),h.tag=1,h=Go(null,h,u,E,b)):(h.tag=0,h=Ml(null,h,u,E,b));else{if(u!=null){var O=u.$$typeof;if(O===Ln){h.tag=11,h=yo(null,h,u,E,b);break e}else if(O===li){h.tag=14,h=_l(null,h,u,E,b);break e}}throw h=g(u)||u,Error(r(306,h,""))}}return h;case 0:return Ml(u,h,h.type,h.pendingProps,b);case 1:return E=h.type,O=Ai(E,h.pendingProps),Go(u,h,E,O,b);case 3:e:{if(Ae(h,h.stateNode.containerInfo),u===null)throw Error(r(387));var H=h.pendingProps;O=h.memoizedState,E=O.element,be(u,h),qt(h,H,null,b);var ve=h.memoizedState;if(H=ve.cache,Qe(h,rs,H),H!==O.cache&&ot(h,[rs],b,!0),Xt(),H=ve.element,Ii&&O.isDehydrated)if(O={element:H,isDehydrated:!1,cache:ve.cache},h.updateQueue.baseState=O,h.memoizedState=O,h.flags&256){h=ya(u,h,H,b);break e}else if(H!==E){E=Re(Error(r(424)),h),le(E),h=ya(u,h,H,b);break e}else for(Ii&&(is=R1(h.stateNode.containerInfo),ca=h,qi=!0,Xc=null,uo=!0),b=W0(h,null,H,b),h.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling;else{if(wt(),H===E){h=Jr(u,h,b);break e}Er(u,h,H,b)}h=h.child}return h;case 26:if(kl)return Ho(u,h),u===null?(b=k0(h.type,null,h.pendingProps,null))?h.memoizedState=b:qi||(h.stateNode=Zp(h.type,h.pendingProps,La.current,h)):h.memoizedState=k0(h.type,u.memoizedProps,h.pendingProps,u.memoizedState),null;case 27:if(la)return _e(h),u===null&&la&&qi&&(E=h.stateNode=$p(h.type,h.pendingProps,La.current,wa.current,!1),ca=h,uo=!0,is=N0(h.type,E,is)),Er(u,h,h.pendingProps.children,b),Ho(u,h),u===null&&(h.flags|=4194304),h.child;case 5:return u===null&&qi&&(G1(h.type,h.pendingProps,wa.current),(O=E=is)&&(E=I1(E,h.type,h.pendingProps,uo),E!==null?(h.stateNode=E,ca=h,is=N1(E),uo=!1,O=!0):O=!1),O||Fe(h)),_e(h),O=h.type,H=h.pendingProps,ve=u!==null?u.memoizedProps:null,E=H.children,Hi(O,H)?E=null:ve!==null&&Hi(O,ve)&&(h.flags|=32),h.memoizedState!==null&&(O=nn(u,h,hn,null,null,b),Gi?yu._currentValue=O:yu._currentValue2=O),Ho(u,h),Er(u,h,E,b),h.child;case 6:return u===null&&qi&&(D0(h.pendingProps,wa.current),(u=b=is)&&(b=D1(b,h.pendingProps,uo),b!==null?(h.stateNode=b,ca=h,is=null,u=!0):u=!1),u||Fe(h)),null;case 13:return $u(u,h,b);case 4:return Ae(h,h.stateNode.containerInfo),E=h.pendingProps,u===null?h.child=Pa(h,null,E,b):Er(u,h,E,b),h.child;case 11:return yo(u,h,h.type,h.pendingProps,b);case 7:return Er(u,h,h.pendingProps,b),h.child;case 8:return Er(u,h,h.pendingProps.children,b),h.child;case 12:return Er(u,h,h.pendingProps.children,b),h.child;case 10:return E=h.pendingProps,Qe(h,h.type,E.value),Er(u,h,E.children,b),h.child;case 9:return O=h.type._context,E=h.pendingProps.children,xt(h),O=he(O),E=E(O),h.flags|=1,Er(u,h,E,b),h.child;case 14:return _l(u,h,h.type,h.pendingProps,b);case 15:return Zu(u,h,h.type,h.pendingProps,b);case 19:return Ql(u,h,b);case 31:return Gs(u,h,b);case 22:return fu(u,h,b,h.pendingProps);case 24:return xt(h),E=he(rs),u===null?(O=Mt(),O===null&&(O=Li,H=ue(),O.pooledCache=H,H.refCount++,H!==null&&(O.pooledCacheLanes|=b),O=H),h.memoizedState={parent:E,cache:O},te(h),Qe(h,rs,O)):((u.lanes&b)!==0&&(be(u,h),qt(h,null,null,b),Xt()),O=u.memoizedState,H=h.memoizedState,O.parent!==E?(O={parent:E,cache:E},h.memoizedState=O,h.lanes===0&&(h.memoizedState=h.updateQueue.baseState=O),Qe(h,rs,E)):(E=H.cache,Qe(h,rs,E),E!==O.cache&&ot(h,[rs],b,!0))),Er(u,h,h.pendingProps.children,b),h.child;case 29:throw h.pendingProps}throw Error(r(156,h.tag))}function Rs(u){u.flags|=4}function ec(u){Nr&&(u.flags|=8)}function du(u,h){if(u!==null&&u.child===h.child)return!1;if((h.flags&16)!==0)return!0;for(u=h.child;u!==null;){if((u.flags&8218)!==0||(u.subtreeFlags&8218)!==0)return!0;u=u.sibling}return!1}function jr(u,h,b,E){if(ei)for(b=h.child;b!==null;){if(b.tag===5||b.tag===6)cs(u,b.stateNode);else if(!(b.tag===4||la&&b.tag===27)&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===h)break;for(;b.sibling===null;){if(b.return===null||b.return===h)return;b=b.return}b.sibling.return=b.return,b=b.sibling}else if(Nr)for(var O=h.child;O!==null;){if(O.tag===5){var H=O.stateNode;b&&E&&(H=Zf(H,O.type,O.memoizedProps)),cs(u,H)}else if(O.tag===6)H=O.stateNode,b&&E&&(H=$f(H,O.memoizedProps)),cs(u,H);else if(O.tag!==4){if(O.tag===22&&O.memoizedState!==null)H=O.child,H!==null&&(H.return=O),jr(u,O,!0,!0);else if(O.child!==null){O.child.return=O,O=O.child;continue}}if(O===h)break;for(;O.sibling===null;){if(O.return===null||O.return===h)return;O=O.return}O.sibling.return=O.return,O=O.sibling}}function Vf(u,h,b,E){var O=!1;if(Nr)for(var H=h.child;H!==null;){if(H.tag===5){var ve=H.stateNode;b&&E&&(ve=Zf(ve,H.type,H.memoizedProps)),Qo(u,ve)}else if(H.tag===6)ve=H.stateNode,b&&E&&(ve=$f(ve,H.memoizedProps)),Qo(u,ve);else if(H.tag!==4){if(H.tag===22&&H.memoizedState!==null)O=H.child,O!==null&&(O.return=H),Vf(u,H,!0,!0),O=!0;else if(H.child!==null){H.child.return=H,H=H.child;continue}}if(H===h)break;for(;H.sibling===null;){if(H.return===null||H.return===h)return O;H=H.return}H.sibling.return=H.return,H=H.sibling}return O}function Yo(u,h){if(Nr&&du(u,h)){u=h.stateNode;var b=u.containerInfo,E=cf();Vf(E,h,!1,!1),u.pendingChildren=E,Rs(h),pc(b,E)}}function _o(u,h,b,E){if(ei)u.memoizedProps!==E&&Rs(h);else if(Nr){var O=u.stateNode,H=u.memoizedProps;if((u=du(u,h))||H!==E){var ve=wa.current;H=Ph(O,b,H,E,!u,null),H===O?h.stateNode=O:(ec(h),kr(H,b,E,ve)&&Rs(h),h.stateNode=H,u&&jr(H,h,!1,!1))}else h.stateNode=O}}function Ls(u,h,b,E,O){if((u.mode&32)!==0&&(b===null?zc(h,E):jc(h,b,E))){if(u.flags|=16777216,(O&335544128)===O||of(h,E))if(mr(u.stateNode,h,E))u.flags|=8192;else if(Fi())u.flags|=8192;else throw fo=Yc,om}else u.flags&=-16777217}function Tl(u,h){if(F0(h)){if(u.flags|=16777216,!z0(h))if(Fi())u.flags|=8192;else throw fo=Yc,om}else u.flags&=-16777217}function tc(u,h){h!==null&&(u.flags|=4),u.flags&16384&&(h=u.tag!==22?I():536870912,u.lanes|=h,Vh|=h)}function El(u,h){if(!qi)switch(u.tailMode){case"hidden":h=u.tail;for(var b=null;h!==null;)h.alternate!==null&&(b=h),h=h.sibling;b===null?u.tail=null:b.sibling=null;break;case"collapsed":b=u.tail;for(var E=null;b!==null;)b.alternate!==null&&(E=b),b=b.sibling;E===null?h||u.tail===null?u.tail=null:u.tail.sibling=null:E.sibling=null}}function Zi(u){var h=u.alternate!==null&&u.alternate.child===u.child,b=0,E=0;if(h)for(var O=u.child;O!==null;)b|=O.lanes|O.childLanes,E|=O.subtreeFlags&65011712,E|=O.flags&65011712,O.return=u,O=O.sibling;else for(O=u.child;O!==null;)b|=O.lanes|O.childLanes,E|=O.subtreeFlags,E|=O.flags,O.return=u,O=O.sibling;return u.subtreeFlags|=E,u.childLanes=b,h}function nc(u,h,b){var E=h.pendingProps;switch($(h),h.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zi(h),null;case 1:return Zi(h),null;case 3:return b=h.stateNode,E=null,u!==null&&(E=u.memoizedState.cache),h.memoizedState.cache!==E&&(h.flags|=2048),Et(rs),ie(),b.pendingContext&&(b.context=b.pendingContext,b.pendingContext=null),(u===null||u.child===null)&&(It(h)?Rs(h):u===null||u.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,Je())),Yo(u,h),Zi(h),null;case 26:if(kl){var O=h.type,H=h.memoizedState;return u===null?(Rs(h),H!==null?(Zi(h),Tl(h,H)):(Zi(h),Ls(h,O,null,E,b))):H?H!==u.memoizedState?(Rs(h),Zi(h),Tl(h,H)):(Zi(h),h.flags&=-16777217):(H=u.memoizedProps,ei?H!==E&&Rs(h):_o(u,h,O,E),Zi(h),Ls(h,O,H,E,b)),null}case 27:if(la){if(ke(h),b=La.current,O=h.type,u!==null&&h.stateNode!=null)ei?u.memoizedProps!==E&&Rs(h):_o(u,h,O,E);else{if(!E){if(h.stateNode===null)throw Error(r(166));return Zi(h),null}u=wa.current,It(h)?We(h,u):(u=$p(O,E,b,u,!0),h.stateNode=u,Rs(h))}return Zi(h),null}case 5:if(ke(h),O=h.type,u!==null&&h.stateNode!=null)_o(u,h,O,E);else{if(!E){if(h.stateNode===null)throw Error(r(166));return Zi(h),null}if(H=wa.current,It(h))We(h,H),j1(h.stateNode,O,E,H)&&(h.flags|=64);else{var ve=rr(O,E,La.current,H,h);ec(h),jr(ve,h,!1,!1),h.stateNode=ve,kr(ve,O,E,H)&&Rs(h)}}return Zi(h),Ls(h,h.type,u===null?null:u.memoizedProps,h.pendingProps,b),null;case 6:if(u&&h.stateNode!=null)b=u.memoizedProps,ei?b!==E&&Rs(h):Nr&&(b!==E?(u=La.current,b=wa.current,ec(h),h.stateNode=Qr(E,u,b,h)):h.stateNode=u.stateNode);else{if(typeof E!="string"&&h.stateNode===null)throw Error(r(166));if(u=La.current,b=wa.current,It(h)){if(!Ii)throw Error(r(176));if(u=h.stateNode,b=h.memoizedProps,E=null,O=ca,O!==null)switch(O.tag){case 27:case 5:E=O.memoizedProps}bb(u,b,h,E)||Fe(h,!0)}else ec(h),h.stateNode=Qr(E,u,b,h)}return Zi(h),null;case 31:if(b=h.memoizedState,u===null||u.memoizedState!==null){if(E=It(h),b!==null){if(u===null){if(!E)throw Error(r(318));if(!Ii)throw Error(r(556));if(u=h.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(r(557));L0(u,h)}else wt(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Zi(h),u=!1}else b=Je(),u!==null&&u.memoizedState!==null&&(u.memoizedState.hydrationErrors=b),u=!0;if(!u)return h.flags&256?(Vt(h),h):(Vt(h),null);if((h.flags&128)!==0)throw Error(r(558))}return Zi(h),null;case 13:if(E=h.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(O=It(h),E!==null&&E.dehydrated!==null){if(u===null){if(!O)throw Error(r(318));if(!Ii)throw Error(r(344));if(O=h.memoizedState,O=O!==null?O.dehydrated:null,!O)throw Error(r(317));B1(O,h)}else wt(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Zi(h),O=!1}else O=Je(),u!==null&&u.memoizedState!==null&&(u.memoizedState.hydrationErrors=O),O=!0;if(!O)return h.flags&256?(Vt(h),h):(Vt(h),null)}return Vt(h),(h.flags&128)!==0?(h.lanes=b,h):(b=E!==null,u=u!==null&&u.memoizedState!==null,b&&(E=h.child,O=null,E.alternate!==null&&E.alternate.memoizedState!==null&&E.alternate.memoizedState.cachePool!==null&&(O=E.alternate.memoizedState.cachePool.pool),H=null,E.memoizedState!==null&&E.memoizedState.cachePool!==null&&(H=E.memoizedState.cachePool.pool),H!==O&&(E.flags|=2048)),b!==u&&b&&(h.child.flags|=8192),tc(h,h.updateQueue),Zi(h),null);case 4:return ie(),Yo(u,h),u===null&&Gn(h.stateNode.containerInfo),Zi(h),null;case 10:return Et(h.type),Zi(h),null;case 19:if(v(Ss),E=h.memoizedState,E===null)return Zi(h),null;if(O=(h.flags&128)!==0,H=E.rendering,H===null)if(O)El(E,!1);else{if(hs!==0||u!==null&&(u.flags&128)!==0)for(u=h.child;u!==null;){if(H=en(u),H!==null){for(h.flags|=128,El(E,!1),u=H.updateQueue,h.updateQueue=u,tc(h,u),h.subtreeFlags=0,u=b,b=h.child;b!==null;)Xf(b,u),b=b.sibling;return S(Ss,Ss.current&1|2),qi&&Te(h,E.treeForkCount),h.child}u=u.sibling}E.tail!==null&&Ga()>Sf&&(h.flags|=128,O=!0,El(E,!1),h.lanes=4194304)}else{if(!O)if(u=en(H),u!==null){if(h.flags|=128,O=!0,u=u.updateQueue,h.updateQueue=u,tc(h,u),El(E,!0),E.tail===null&&E.tailMode==="hidden"&&!H.alternate&&!qi)return Zi(h),null}else 2*Ga()-E.renderingStartTime>Sf&&b!==536870912&&(h.flags|=128,O=!0,El(E,!1),h.lanes=4194304);E.isBackwards?(H.sibling=h.child,h.child=H):(u=E.last,u!==null?u.sibling=H:h.child=H,E.last=H)}return E.tail!==null?(u=E.tail,E.rendering=u,E.tail=u.sibling,E.renderingStartTime=Ga(),u.sibling=null,b=Ss.current,S(Ss,O?b&1|2:b&1),qi&&Te(h,E.treeForkCount),u):(Zi(h),null);case 22:case 23:return Vt(h),fe(),E=h.memoizedState!==null,u!==null?u.memoizedState!==null!==E&&(h.flags|=8192):E&&(h.flags|=8192),E?(b&536870912)!==0&&(h.flags&128)===0&&(Zi(h),h.subtreeFlags&6&&(h.flags|=8192)):Zi(h),b=h.updateQueue,b!==null&&tc(h,b.retryQueue),b=null,u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(b=u.memoizedState.cachePool.pool),E=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(E=h.memoizedState.cachePool.pool),E!==b&&(h.flags|=2048),u!==null&&v(pf),null;case 24:return b=null,u!==null&&(b=u.memoizedState.cache),h.memoizedState.cache!==b&&(h.flags|=2048),Et(rs),Zi(h),null;case 25:return null;case 30:return null}throw Error(r(156,h.tag))}function Cl(u,h){switch($(h),h.tag){case 1:return u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 3:return Et(rs),ie(),u=h.flags,(u&65536)!==0&&(u&128)===0?(h.flags=u&-65537|128,h):null;case 26:case 27:case 5:return ke(h),null;case 31:if(h.memoizedState!==null){if(Vt(h),h.alternate===null)throw Error(r(340));wt()}return u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 13:if(Vt(h),u=h.memoizedState,u!==null&&u.dehydrated!==null){if(h.alternate===null)throw Error(r(340));wt()}return u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 19:return v(Ss),null;case 4:return ie(),null;case 10:return Et(h.type),null;case 22:case 23:return Vt(h),fe(),u!==null&&v(pf),u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 24:return Et(rs),null;case 25:return null;default:return null}}function Dc(u,h){switch($(h),h.tag){case 3:Et(rs),ie();break;case 26:case 27:case 5:ke(h);break;case 4:ie();break;case 31:h.memoizedState!==null&&Vt(h);break;case 13:Vt(h);break;case 19:v(Ss);break;case 10:Et(h.type);break;case 22:case 23:Vt(h),fe(),u!==null&&v(pf);break;case 24:Et(rs)}}function na(u,h){try{var b=h.updateQueue,E=b!==null?b.lastEffect:null;if(E!==null){var O=E.next;b=O;do{if((b.tag&u)===u){E=void 0;var H=b.create,ve=b.inst;E=H(),ve.destroy=E}b=b.next}while(b!==O)}}catch(Xe){Qn(h,h.return,Xe)}}function ba(u,h,b){try{var E=h.updateQueue,O=E!==null?E.lastEffect:null;if(O!==null){var H=O.next;E=H;do{if((E.tag&u)===u){var ve=E.inst,Xe=ve.destroy;if(Xe!==void 0){ve.destroy=void 0,O=h;var kt=b,Qt=Xe;try{Qt()}catch(xn){Qn(O,kt,xn)}}}E=E.next}while(E!==H)}}catch(xn){Qn(h,h.return,xn)}}function ia(u){var h=u.updateQueue;if(h!==null){var b=u.stateNode;try{sn(h,b)}catch(E){Qn(u,u.return,E)}}}function to(u,h,b){b.props=Ai(u.type,u.memoizedProps),b.state=u.memoizedState;try{b.componentWillUnmount()}catch(E){Qn(u,h,E)}}function Vi(u,h){try{var b=u.ref;if(b!==null){switch(u.tag){case 26:case 27:case 5:var E=xs(u.stateNode);break;case 30:E=u.stateNode;break;default:E=u.stateNode}typeof b=="function"?u.refCleanup=b(E):b.current=E}}catch(O){Qn(u,h,O)}}function di(u,h){var b=u.ref,E=u.refCleanup;if(b!==null)if(typeof E=="function")try{E()}catch(O){Qn(u,h,O)}finally{u.refCleanup=null,u=u.alternate,u!=null&&(u.refCleanup=null)}else if(typeof b=="function")try{b(null)}catch(O){Qn(u,h,O)}else b.current=null}function dr(u){var h=u.type,b=u.memoizedProps,E=u.stateNode;try{dc(E,h,b,u)}catch(O){Qn(u,u.return,O)}}function Vr(u,h,b){try{Nd(u.stateNode,u.type,b,h,u)}catch(E){Qn(u,u.return,E)}}function Zo(u){return u.tag===5||u.tag===3||(kl?u.tag===26:!1)||(la?u.tag===27&&Jf(u.type):!1)||u.tag===4}function no(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||Zo(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(la&&u.tag===27&&Jf(u.type)||u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function ic(u,h,b){var E=u.tag;if(E===5||E===6)u=u.stateNode,h?Hp(b,u,h):Rh(b,u);else if(E!==4&&(la&&E===27&&Jf(u.type)&&(b=u.stateNode,h=null),u=u.child,u!==null))for(ic(u,h,b),u=u.sibling;u!==null;)ic(u,h,b),u=u.sibling}function kc(u,h,b){var E=u.tag;if(E===5||E===6)u=u.stateNode,h?Rd(b,u,h):lf(b,u);else if(E!==4&&(la&&E===27&&Jf(u.type)&&(b=u.stateNode),u=u.child,u!==null))for(kc(u,h,b),u=u.sibling;u!==null;)kc(u,h,b),u=u.sibling}function Sh(u,h,b){u=u.containerInfo;try{Dl(u,b)}catch(E){Qn(h,h.return,E)}}function wd(u){var h=u.stateNode,b=u.memoizedProps;try{qs(u.type,b,h,u)}catch(E){Qn(u,u.return,E)}}function Fp(u,h){for(Qi(u.containerInfo),Os=h;Os!==null;)if(u=Os,h=u.child,(u.subtreeFlags&1028)!==0&&h!==null)h.return=u,Os=h;else for(;Os!==null;){u=Os;var b=u.alternate;switch(h=u.flags,u.tag){case 0:if((h&4)!==0&&(h=u.updateQueue,h=h!==null?h.events:null,h!==null))for(var E=0;E<h.length;E++){var O=h[E];O.ref.impl=O.nextImpl}break;case 11:case 15:break;case 1:if((h&1024)!==0&&b!==null){h=void 0,E=u,O=b.memoizedProps,b=b.memoizedState;var H=E.stateNode;try{var ve=Ai(E.type,O);h=H.getSnapshotBeforeUpdate(ve,b),H.__reactInternalSnapshotBeforeUpdate=h}catch(Xe){Qn(E,E.return,Xe)}}break;case 3:(h&1024)!==0&&ei&&_u(u.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((h&1024)!==0)throw Error(r(163))}if(h=u.sibling,h!==null){h.return=u.return,Os=h;break}Os=u.return}}function Md(u,h,b){var E=b.flags;switch(b.tag){case 0:case 11:case 15:ra(u,b),E&4&&na(5,b);break;case 1:if(ra(u,b),E&4)if(u=b.stateNode,h===null)try{u.componentDidMount()}catch(ve){Qn(b,b.return,ve)}else{var O=Ai(b.type,h.memoizedProps);h=h.memoizedState;try{u.componentDidUpdate(O,h,u.__reactInternalSnapshotBeforeUpdate)}catch(ve){Qn(b,b.return,ve)}}E&64&&ia(b),E&512&&Vi(b,b.return);break;case 3:if(ra(u,b),E&64&&(E=b.updateQueue,E!==null)){if(u=null,b.child!==null)switch(b.child.tag){case 27:case 5:u=xs(b.child.stateNode);break;case 1:u=b.child.stateNode}try{sn(E,u)}catch(ve){Qn(b,b.return,ve)}}break;case 27:la&&h===null&&E&4&&wd(b);case 26:case 5:if(ra(u,b),h===null){if(E&4)dr(b);else if(E&64){u=b.type,h=b.memoizedProps,O=b.stateNode;try{F1(O,u,h,b)}catch(ve){Qn(b,b.return,ve)}}}E&512&&Vi(b,b.return);break;case 12:ra(u,b);break;case 31:ra(u,b),E&4&&ro(u,b);break;case 13:ra(u,b),E&4&&Ku(u,b),E&64&&(E=b.memoizedState,E!==null&&(E=E.dehydrated,E!==null&&(b=T0.bind(null,b),ff(E,b))));break;case 22:if(E=b.memoizedState!==null||ws,!E){h=h!==null&&h.memoizedState!==null||Ms,O=ws;var H=Ms;ws=E,(Ms=h)&&!H?Ir(u,b,(b.subtreeFlags&8772)!==0):ra(u,b),ws=O,Ms=H}break;case 30:break;default:ra(u,b)}}function wh(u){var h=u.alternate;h!==null&&(u.alternate=null,wh(h)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(h=u.stateNode,h!==null&&_s(h)),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function io(u,h,b){for(b=b.child;b!==null;)rc(u,h,b),b=b.sibling}function rc(u,h,b){if(To&&typeof To.onCommitFiberUnmount=="function")try{To.onCommitFiberUnmount(eh,b)}catch{}switch(b.tag){case 26:if(kl){Ms||di(b,h),io(u,h,b),b.memoizedState?hf(b.memoizedState):b.stateNode&&U0(b.stateNode);break}case 27:if(la){Ms||di(b,h);var E=fs,O=Bs;Jf(b.type)&&(fs=b.stateNode,Bs=!1),io(u,h,b),Sa(b.stateNode),fs=E,Bs=O;break}case 5:Ms||di(b,h);case 6:if(ei){if(E=fs,O=Bs,fs=null,io(u,h,b),fs=E,Bs=O,fs!==null)if(Bs)try{Hc(fs,b.stateNode)}catch(H){Qn(b,h,H)}else try{Ld(fs,b.stateNode)}catch(H){Qn(b,h,H)}}else io(u,h,b);break;case 18:ei&&fs!==null&&(Bs?Xp(fs,b.stateNode):I0(fs,b.stateNode));break;case 4:ei?(E=fs,O=Bs,fs=b.stateNode.containerInfo,Bs=!0,io(u,h,b),fs=E,Bs=O):(Nr&&Sh(b.stateNode,b,cf()),io(u,h,b));break;case 0:case 11:case 14:case 15:ba(2,b,h),Ms||ba(4,b,h),io(u,h,b);break;case 1:Ms||(di(b,h),E=b.stateNode,typeof E.componentWillUnmount=="function"&&to(b,h,E)),io(u,h,b);break;case 21:io(u,h,b);break;case 22:Ms=(E=Ms)||b.memoizedState!==null,io(u,h,b),Ms=E;break;default:io(u,h,b)}}function ro(u,h){if(Ii&&h.memoizedState===null&&(u=h.alternate,u!==null&&(u=u.memoizedState,u!==null))){u=u.dehydrated;try{_b(u)}catch(b){Qn(h,h.return,b)}}}function Ku(u,h){if(Ii&&h.memoizedState===null&&(u=h.alternate,u!==null&&(u=u.memoizedState,u!==null&&(u=u.dehydrated,u!==null))))try{Sb(u)}catch(b){Qn(h,h.return,b)}}function so(u){switch(u.tag){case 31:case 13:case 19:var h=u.stateNode;return h===null&&(h=u.stateNode=new Y0),h;case 22:return u=u.stateNode,h=u._retryCache,h===null&&(h=u._retryCache=new Y0),h;default:throw Error(r(435,u.tag))}}function Nl(u,h){var b=so(u);h.forEach(function(E){if(!b.has(E)){b.add(E);var O=E0.bind(null,u,E);E.then(O,O)}})}function Ps(u,h){var b=h.deletions;if(b!==null)for(var E=0;E<b.length;E++){var O=b[E],H=u,ve=h;if(ei){var Xe=ve;e:for(;Xe!==null;){switch(Xe.tag){case 27:if(la){if(Jf(Xe.type)){fs=Xe.stateNode,Bs=!1;break e}break}case 5:fs=Xe.stateNode,Bs=!1;break e;case 3:case 4:fs=Xe.stateNode.containerInfo,Bs=!0;break e}Xe=Xe.return}if(fs===null)throw Error(r(160));rc(H,ve,O),fs=null,Bs=!1}else rc(H,ve,O);H=O.alternate,H!==null&&(H.return=null),O.return=null}if(h.subtreeFlags&13886)for(h=h.child;h!==null;)Qu(h,u),h=h.sibling}function Qu(u,h){var b=u.alternate,E=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:Ps(h,u),Is(u),E&4&&(ba(3,u,u.return),na(3,u),ba(5,u,u.return));break;case 1:Ps(h,u),Is(u),E&512&&(Ms||b===null||di(b,b.return)),E&64&&ws&&(u=u.updateQueue,u!==null&&(E=u.callbacks,E!==null&&(b=u.shared.hiddenCallbacks,u.shared.hiddenCallbacks=b===null?E:b.concat(E))));break;case 26:if(kl){var O=vr;if(Ps(h,u),Is(u),E&512&&(Ms||b===null||di(b,b.return)),E&4){E=b!==null?b.memoizedState:null;var H=u.memoizedState;b===null?H===null?u.stateNode===null?u.stateNode=q1(O,u.type,u.memoizedProps,u):B0(O,u.type,u.stateNode):u.stateNode=O0(O,H,u.memoizedProps):E!==H?(E===null?b.stateNode!==null&&U0(b.stateNode):hf(E),H===null?B0(O,u.type,u.stateNode):O0(O,H,u.memoizedProps)):H===null&&u.stateNode!==null&&Vr(u,u.memoizedProps,b.memoizedProps)}break}case 27:if(la){Ps(h,u),Is(u),E&512&&(Ms||b===null||di(b,b.return)),b!==null&&E&4&&Vr(u,u.memoizedProps,b.memoizedProps);break}case 5:if(Ps(h,u),Is(u),E&512&&(Ms||b===null||di(b,b.return)),ei){if(u.flags&32){O=u.stateNode;try{Pd(O)}catch(on){Qn(u,u.return,on)}}E&4&&u.stateNode!=null&&(O=u.memoizedProps,Vr(u,O,b!==null?b.memoizedProps:O)),E&1024&&(Bh=!0)}else Nr&&u.alternate!==null&&(u.alternate.stateNode=u.stateNode);break;case 6:if(Ps(h,u),Is(u),E&4&&ei){if(u.stateNode===null)throw Error(r(162));E=u.memoizedProps,b=b!==null?b.memoizedProps:E,O=u.stateNode;try{Lh(O,b,E)}catch(on){Qn(u,u.return,on)}}break;case 3:if(kl?(W1(),O=vr,vr=kd(h.containerInfo),Ps(h,u),vr=O):Ps(h,u),Is(u),E&4){if(ei&&Ii&&b!==null&&b.memoizedState.isDehydrated)try{z1(h.containerInfo)}catch(on){Qn(u,u.return,on)}if(Nr){E=h.containerInfo,b=h.pendingChildren;try{Dl(E,b)}catch(on){Qn(u,u.return,on)}}}Bh&&(Bh=!1,Hf(u));break;case 4:kl?(b=vr,vr=kd(u.stateNode.containerInfo),Ps(h,u),Is(u),vr=b):(Ps(h,u),Is(u)),E&4&&Nr&&Sh(u.stateNode,u,u.stateNode.pendingChildren);break;case 12:Ps(h,u),Is(u);break;case 31:Ps(h,u),Is(u),E&4&&(E=u.updateQueue,E!==null&&(u.updateQueue=null,Nl(u,E)));break;case 13:Ps(h,u),Is(u),u.child.flags&8192&&u.memoizedState!==null!=(b!==null&&b.memoizedState!==null)&&(qd=Ga()),E&4&&(E=u.updateQueue,E!==null&&(u.updateQueue=null,Nl(u,E)));break;case 22:O=u.memoizedState!==null;var ve=b!==null&&b.memoizedState!==null,Xe=ws,kt=Ms;if(ws=Xe||O,Ms=kt||ve,Ps(h,u),Ms=kt,ws=Xe,Is(u),E&8192&&(h=u.stateNode,h._visibility=O?h._visibility&-2:h._visibility|1,O&&(b===null||ve||ws||Ms||$o(u)),ei)){e:if(b=null,ei)for(h=u;;){if(h.tag===5||kl&&h.tag===26){if(b===null){ve=b=h;try{H=ve.stateNode,O?Gp(H):Id(ve.stateNode,ve.memoizedProps)}catch(on){Qn(ve,ve.return,on)}}}else if(h.tag===6){if(b===null){ve=h;try{var Qt=ve.stateNode;O?qp(Qt):Wp(Qt,ve.memoizedProps)}catch(on){Qn(ve,ve.return,on)}}}else if(h.tag===18){if(b===null){ve=h;try{var xn=ve.stateNode;O?V1(xn):H1(ve.stateNode)}catch(on){Qn(ve,ve.return,on)}}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===u)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===u)break e;for(;h.sibling===null;){if(h.return===null||h.return===u)break e;b===h&&(b=null),h=h.return}b===h&&(b=null),h.sibling.return=h.return,h=h.sibling}}E&4&&(E=u.updateQueue,E!==null&&(b=E.retryQueue,b!==null&&(E.retryQueue=null,Nl(u,b))));break;case 19:Ps(h,u),Is(u),E&4&&(E=u.updateQueue,E!==null&&(u.updateQueue=null,Nl(u,E)));break;case 30:break;case 21:break;default:Ps(h,u),Is(u)}}function Is(u){var h=u.flags;if(h&2){try{for(var b,E=u.return;E!==null;){if(Zo(E)){b=E;break}E=E.return}if(ei){if(b==null)throw Error(r(160));switch(b.tag){case 27:if(la){var O=b.stateNode,H=no(u);kc(u,H,O);break}case 5:var ve=b.stateNode;b.flags&32&&(Pd(ve),b.flags&=-33);var Xe=no(u);kc(u,Xe,ve);break;case 3:case 4:var kt=b.stateNode.containerInfo,Qt=no(u);ic(u,Qt,kt);break;default:throw Error(r(161))}}}catch(xn){Qn(u,u.return,xn)}u.flags&=-3}h&4096&&(u.flags&=-4097)}function Hf(u){if(u.subtreeFlags&1024)for(u=u.child;u!==null;){var h=u;Hf(h),h.tag===5&&h.flags&1024&&Ed(h.stateNode),u=u.sibling}}function ra(u,h){if(h.subtreeFlags&8772)for(h=h.child;h!==null;)Md(u,h.alternate,h),h=h.sibling}function $o(u){for(u=u.child;u!==null;){var h=u;switch(h.tag){case 0:case 11:case 14:case 15:ba(4,h,h.return),$o(h);break;case 1:di(h,h.return);var b=h.stateNode;typeof b.componentWillUnmount=="function"&&to(h,h.return,b),$o(h);break;case 27:la&&Sa(h.stateNode);case 26:case 5:di(h,h.return),$o(h);break;case 22:h.memoizedState===null&&$o(h);break;case 30:$o(h);break;default:$o(h)}u=u.sibling}}function Ir(u,h,b){for(b=b&&(h.subtreeFlags&8772)!==0,h=h.child;h!==null;){var E=h.alternate,O=u,H=h,ve=H.flags;switch(H.tag){case 0:case 11:case 15:Ir(O,H,b),na(4,H);break;case 1:if(Ir(O,H,b),E=H,O=E.stateNode,typeof O.componentDidMount=="function")try{O.componentDidMount()}catch(Qt){Qn(E,E.return,Qt)}if(E=H,O=E.updateQueue,O!==null){var Xe=E.stateNode;try{var kt=O.shared.hiddenCallbacks;if(kt!==null)for(O.shared.hiddenCallbacks=null,O=0;O<kt.length;O++)an(kt[O],Xe)}catch(Qt){Qn(E,E.return,Qt)}}b&&ve&64&&ia(H),Vi(H,H.return);break;case 27:la&&wd(H);case 26:case 5:Ir(O,H,b),b&&E===null&&ve&4&&dr(H),Vi(H,H.return);break;case 12:Ir(O,H,b);break;case 31:Ir(O,H,b),b&&ve&4&&ro(O,H);break;case 13:Ir(O,H,b),b&&ve&4&&Ku(O,H);break;case 22:H.memoizedState===null&&Ir(O,H,b),Vi(H,H.return);break;case 30:break;default:Ir(O,H,b)}h=h.sibling}}function Ds(u,h){var b=null;u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(b=u.memoizedState.cachePool.pool),u=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(u=h.memoizedState.cachePool.pool),u!==b&&(u!=null&&u.refCount++,b!=null&&je(b))}function ef(u,h){u=null,h.alternate!==null&&(u=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==u&&(h.refCount++,u!=null&&je(u))}function br(u,h,b,E){if(h.subtreeFlags&10256)for(h=h.child;h!==null;)Gf(u,h,b,E),h=h.sibling}function Gf(u,h,b,E){var O=h.flags;switch(h.tag){case 0:case 11:case 15:br(u,h,b,E),O&2048&&na(9,h);break;case 1:br(u,h,b,E);break;case 3:br(u,h,b,E),O&2048&&(u=null,h.alternate!==null&&(u=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==u&&(h.refCount++,u!=null&&je(u)));break;case 12:if(O&2048){br(u,h,b,E),u=h.stateNode;try{var H=h.memoizedProps,ve=H.id,Xe=H.onPostCommit;typeof Xe=="function"&&Xe(ve,h.alternate===null?"mount":"update",u.passiveEffectDuration,-0)}catch(kt){Qn(h,h.return,kt)}}else br(u,h,b,E);break;case 31:br(u,h,b,E);break;case 13:br(u,h,b,E);break;case 23:break;case 22:H=h.stateNode,ve=h.alternate,h.memoizedState!==null?H._visibility&2?br(u,h,b,E):sc(u,h):H._visibility&2?br(u,h,b,E):(H._visibility|=2,sa(u,h,b,E,(h.subtreeFlags&10256)!==0||!1)),O&2048&&Ds(ve,h);break;case 24:br(u,h,b,E),O&2048&&ef(h.alternate,h);break;default:br(u,h,b,E)}}function sa(u,h,b,E,O){for(O=O&&((h.subtreeFlags&10256)!==0||!1),h=h.child;h!==null;){var H=u,ve=h,Xe=b,kt=E,Qt=ve.flags;switch(ve.tag){case 0:case 11:case 15:sa(H,ve,Xe,kt,O),na(8,ve);break;case 23:break;case 22:var xn=ve.stateNode;ve.memoizedState!==null?xn._visibility&2?sa(H,ve,Xe,kt,O):sc(H,ve):(xn._visibility|=2,sa(H,ve,Xe,kt,O)),O&&Qt&2048&&Ds(ve.alternate,ve);break;case 24:sa(H,ve,Xe,kt,O),O&&Qt&2048&&ef(ve.alternate,ve);break;default:sa(H,ve,Xe,kt,O)}h=h.sibling}}function sc(u,h){if(h.subtreeFlags&10256)for(h=h.child;h!==null;){var b=u,E=h,O=E.flags;switch(E.tag){case 22:sc(b,E),O&2048&&Ds(E.alternate,E);break;case 24:sc(b,E),O&2048&&ef(E.alternate,E);break;default:sc(b,E)}h=h.sibling}}function So(u,h,b){if(u.subtreeFlags&il)for(u=u.child;u!==null;)ac(u,h,b),u=u.sibling}function ac(u,h,b){switch(u.tag){case 26:if(So(u,h,b),u.flags&il)if(u.memoizedState!==null)X1(b,vr,u.memoizedState,u.memoizedProps);else{var E=u.stateNode,O=u.type;u=u.memoizedProps,((h&335544128)===h||of(O,u))&&Th(b,E,O,u)}break;case 5:So(u,h,b),u.flags&il&&(E=u.stateNode,O=u.type,u=u.memoizedProps,((h&335544128)===h||of(O,u))&&Th(b,E,O,u));break;case 3:case 4:kl?(E=vr,vr=kd(u.stateNode.containerInfo),So(u,h,b),vr=E):So(u,h,b);break;case 22:u.memoizedState===null&&(E=u.alternate,E!==null&&E.memoizedState!==null?(E=il,il=16777216,So(u,h,b),il=E):So(u,h,b));break;default:So(u,h,b)}}function tf(u){var h=u.alternate;if(h!==null&&(u=h.child,u!==null)){h.child=null;do h=u.sibling,u.sibling=null,u=h;while(u!==null)}}function Oc(u){var h=u.deletions;if((u.flags&16)!==0){if(h!==null)for(var b=0;b<h.length;b++){var E=h[b];Os=E,ao(E,u)}tf(u)}if(u.subtreeFlags&10256)for(u=u.child;u!==null;)pu(u),u=u.sibling}function pu(u){switch(u.tag){case 0:case 11:case 15:Oc(u),u.flags&2048&&ba(9,u,u.return);break;case 3:Oc(u);break;case 12:Oc(u);break;case 22:var h=u.stateNode;u.memoizedState!==null&&h._visibility&2&&(u.return===null||u.return.tag!==13)?(h._visibility&=-3,mu(u)):Oc(u);break;default:Oc(u)}}function mu(u){var h=u.deletions;if((u.flags&16)!==0){if(h!==null)for(var b=0;b<h.length;b++){var E=h[b];Os=E,ao(E,u)}tf(u)}for(u=u.child;u!==null;){switch(h=u,h.tag){case 0:case 11:case 15:ba(8,h,h.return),mu(h);break;case 22:b=h.stateNode,b._visibility&2&&(b._visibility&=-3,mu(h));break;default:mu(h)}u=u.sibling}}function ao(u,h){for(;Os!==null;){var b=Os;switch(b.tag){case 0:case 11:case 15:ba(8,b,h);break;case 23:case 22:if(b.memoizedState!==null&&b.memoizedState.cachePool!==null){var E=b.memoizedState.cachePool.pool;E!=null&&E.refCount++}break;case 24:je(b.memoizedState.cache)}if(E=b.child,E!==null)E.return=b,Os=E;else e:for(b=u;Os!==null;){E=Os;var O=E.sibling,H=E.return;if(wh(E),E===b){Os=null;break e}if(O!==null){O.return=H,Os=O;break e}Os=H}}}function Bc(u){var h=Vn(u);if(h!=null){if(typeof h.memoizedProps["data-testname"]!="string")throw Error(r(364));return h}if(u=ns(u),u===null)throw Error(r(362));return u.stateNode.current}function oc(u,h){var b=u.tag;switch(h.$$typeof){case Hl:if(u.type===h.value)return!0;break;case Fh:e:{for(h=h.value,u=[u,0],b=0;b<u.length;){var E=u[b++],O=E.tag,H=u[b++],ve=h[H];if(O!==5&&O!==26&&O!==27||!Pl(E)){for(;ve!=null&&oc(E,ve);)H++,ve=h[H];if(H===h.length){h=!0;break e}else for(E=E.child;E!==null;)u.push(E,H),E=E.sibling}}h=!1}return h;case zh:if((b===5||b===26||b===27)&&bu(u.stateNode,h.value))return!0;break;case xf:if((b===5||b===6||b===26||b===27)&&(u=Vc(u),u!==null&&0<=u.indexOf(h.value)))return!0;break;case Hd:if((b===5||b===26||b===27)&&(u=u.memoizedProps["data-testname"],typeof u=="string"&&u.toLowerCase()===h.value.toLowerCase()))return!0;break;default:throw Error(r(365))}return!1}function nf(u){switch(u.$$typeof){case Hl:return"<"+(g(u.value)||"Unknown")+">";case Fh:return":has("+(nf(u)||"")+")";case zh:return'[role="'+u.value+'"]';case xf:return'"'+u.value+'"';case Hd:return'[data-testname="'+u.value+'"]';default:throw Error(r(365))}}function rf(u,h){var b=[];u=[u,0];for(var E=0;E<u.length;){var O=u[E++],H=O.tag,ve=u[E++],Xe=h[ve];if(H!==5&&H!==26&&H!==27||!Pl(O)){for(;Xe!=null&&oc(O,Xe);)ve++,Xe=h[ve];if(ve===h.length)b.push(O);else for(O=O.child;O!==null;)u.push(O,ve),O=O.sibling}}return b}function za(u,h){if(!ts)throw Error(r(363));u=Bc(u),u=rf(u,h),h=[],u=Array.from(u);for(var b=0;b<u.length;){var E=u[b++],O=E.tag;if(O===5||O===26||O===27)Pl(E)||h.push(E.stateNode);else for(E=E.child;E!==null;)u.push(E),E=E.sibling}return h}function Dr(){return(zi&2)!==0&&Wi!==0?Wi&-Wi:Cn.T!==null?Pe():Mo()}function lc(){if(po===0)if((Wi&536870912)===0||qi){var u=Qf;Qf<<=1,(Qf&3932160)===0&&(Qf=262144),po=u}else po=536870912;return u=Eo.current,u!==null&&(u.flags|=32),po}function Cr(u,h,b){(u===Li&&(xr===2||xr===9)||u.cancelPendingCommit!==null)&&(Kr(u,0),Rl(u,Wi,po,!1)),j(u,b),((zi&2)===0||u!==Li)&&(u===Li&&((zi&2)===0&&(_f|=b),hs===4&&Rl(u,Wi,po,!1)),ft(u))}function oo(u,h,b){if((zi&6)!==0)throw Error(r(327));var E=!b&&(h&127)===0&&(h&u.expiredLanes)===0||R(u,h),O=E?cc(u,h):Ll(u,h,!0),H=E;do{if(O===0){yf&&!E&&Rl(u,h,0,!1);break}else{if(b=u.current.alternate,H&&!zp(b)){O=Ll(u,h,!1),H=!1;continue}if(O===2){if(H=h,u.errorRecoveryDisabledLanes&H)var ve=0;else ve=u.pendingLanes&-536870913,ve=ve!==0?ve:ve&536870912?536870912:0;if(ve!==0){h=ve;e:{var Xe=u;O=Gd;var kt=Ii&&Xe.current.memoizedState.isDehydrated;if(kt&&(Kr(Xe,ve).flags|=256),ve=Ll(Xe,ve,!1),ve!==2){if(bf&&!kt){Xe.errorRecoveryDisabledLanes|=H,_f|=H,O=4;break e}H=No,No=O,H!==null&&(No===null?No=H:No.push.apply(No,H))}O=ve}if(H=!1,O!==2)continue}}if(O===1){Kr(u,0),Rl(u,h,0,!0);break}e:{switch(E=u,H=O,H){case 0:case 1:throw Error(r(345));case 4:if((h&4194048)!==h)break;case 6:Rl(E,h,po,!yc);break e;case 2:No=null;break;case 3:case 5:break;default:throw Error(r(329))}if((h&62914560)===h&&(O=qd+300-Ga(),10<O)){if(Rl(E,h,po,!yc),w(E,0,!0)!==0)break e;Kc=h,E.timeoutHandle=lr(ja.bind(null,E,b,No,Wd,cm,h,po,_f,Vh,yc,H,"Throttled",-0,0),O);break e}ja(E,b,No,Wd,cm,h,po,_f,Vh,yc,H,null,-0,0)}}break}while(!0);ft(u)}function ja(u,h,b,E,O,H,ve,Xe,kt,Qt,xn,on,Nn,vi){if(u.timeoutHandle=wr,on=h.subtreeFlags,on&8192||(on&16785408)===16785408){on=Td(),ac(h,H,on);var Us=(H&62914560)===H?qd-Ga():(H&4194048)===H?ah-Ga():0;if(Us=Eh(on,Us),Us!==null){Kc=H,u.cancelPendingCommit=Us(Ko.bind(null,u,h,H,b,E,O,ve,Xe,kt,xn,on,null,Nn,vi)),Rl(u,H,ve,!Qt);return}}Ko(u,h,H,b,E,O,ve,Xe,kt)}function zp(u){for(var h=u;;){var b=h.tag;if((b===0||b===11||b===15)&&h.flags&16384&&(b=h.updateQueue,b!==null&&(b=b.stores,b!==null)))for(var E=0;E<b.length;E++){var O=b[E],H=O.getSnapshot;O=O.value;try{if(!ks(H(),O))return!1}catch{return!1}}if(b=h.child,h.subtreeFlags&16384&&b!==null)b.return=h,h=b;else{if(h===u)break;for(;h.sibling===null;){if(h.return===null||h.return===u)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function Rl(u,h,b,E){h&=~jh,h&=~_f,u.suspendedLanes|=h,u.pingedLanes&=~h,E&&(u.warmLanes|=h),E=u.expirationTimes;for(var O=h;0<O;){var H=31-Ao(O),ve=1<<H;E[H]=-1,O&=~ve}b!==0&&G(u,b,h)}function qf(){return(zi&6)===0?(gt(0),!1):!0}function Mh(){if(ji!==null){if(xr===0)var u=ji.return;else u=ji,vc=Or=null,ai(u),mf=null,th=0,u=ji;for(;u!==null;)Dc(u.alternate,u),u=u.return;ji=null}}function Kr(u,h){var b=u.timeoutHandle;b!==wr&&(u.timeoutHandle=wr,bs(b)),b=u.cancelPendingCommit,b!==null&&(u.cancelPendingCommit=null,b()),Kc=0,Mh(),Li=u,ji=b=co(u.current,null),Wi=h,xr=0,Ws=null,yc=!1,yf=R(u,h),bf=!1,Vh=po=jh=_f=Tu=hs=0,No=Gd=null,cm=!1,(h&8)!==0&&(h|=h&32);var E=u.entangledLanes;if(E!==0)for(u=u.entanglements,E&=h;0<E;){var O=31-Ao(E),H=1<<O;h|=u[O],E&=~H}return Jc=h,$n(),b}function _r(u,h){yi=null,Cn.H=nl,h===fa||h===jl?(h=dn(),xr=3):h===om?(h=dn(),xr=4):xr=h===ho?8:h!==null&&typeof h=="object"&&typeof h.then=="function"?6:1,Ws=h,ji===null&&(hs=1,yr(u,Re(h,u.current)))}function Fi(){var u=Eo.current;return u===null?!0:(Wi&4194048)===Wi?Co===null:(Wi&62914560)===Wi||(Wi&536870912)!==0?u===Co:!1}function _a(){var u=Cn.H;return Cn.H=nl,u===null?nl:u}function Hr(){var u=Cn.A;return Cn.A=Uh,u}function Va(){hs=4,yc||(Wi&4194048)!==Wi&&Eo.current!==null||(yf=!0),(Tu&134217727)===0&&(_f&134217727)===0||Li===null||Rl(Li,Wi,po,!1)}function Ll(u,h,b){var E=zi;zi|=2;var O=_a(),H=Hr();(Li!==u||Wi!==h)&&(Wd=null,Kr(u,h)),h=!1;var ve=hs;e:do try{if(xr!==0&&ji!==null){var Xe=ji,kt=Ws;switch(xr){case 8:Mh(),ve=6;break e;case 3:case 2:case 9:case 6:Eo.current===null&&(h=!0);var Qt=xr;if(xr=0,Ws=null,Jo(u,Xe,kt,Qt),b&&yf){ve=0;break e}break;default:Qt=xr,xr=0,Ws=null,Jo(u,Xe,kt,Qt)}}Ad(),ve=hs;break}catch(xn){_r(u,xn)}while(!0);return h&&u.shellSuspendCounter++,vc=Or=null,zi=E,Cn.H=O,Cn.A=H,ji===null&&(Li=null,Wi=0,$n()),ve}function Ad(){for(;ji!==null;)Uc(ji)}function cc(u,h){var b=zi;zi|=2;var E=_a(),O=Hr();Li!==u||Wi!==h?(Wd=null,Sf=Ga()+500,Kr(u,h)):yf=R(u,h);e:do try{if(xr!==0&&ji!==null){h=ji;var H=Ws;t:switch(xr){case 1:xr=0,Ws=null,Jo(u,h,H,1);break;case 2:case 9:if(vt(H)){xr=0,Ws=null,Ah(h);break}h=function(){xr!==2&&xr!==9||Li!==u||(xr=7),ft(u)},H.then(h,h);break e;case 3:xr=7;break e;case 4:xr=5;break e;case 7:vt(H)?(xr=0,Ws=null,Ah(h)):(xr=0,Ws=null,Jo(u,h,H,7));break;case 5:var ve=null;switch(ji.tag){case 26:ve=ji.memoizedState;case 5:case 27:var Xe=ji,kt=Xe.type,Qt=Xe.pendingProps;if(ve?z0(ve):mr(Xe.stateNode,kt,Qt)){xr=0,Ws=null;var xn=Xe.sibling;if(xn!==null)ji=xn;else{var on=Xe.return;on!==null?(ji=on,gu(on)):ji=null}break t}}xr=0,Ws=null,Jo(u,h,H,5);break;case 6:xr=0,Ws=null,Jo(u,h,H,6);break;case 8:Mh(),hs=6;break e;default:throw Error(r(462))}}aa();break}catch(Nn){_r(u,Nn)}while(!0);return vc=Or=null,Cn.H=E,Cn.A=O,zi=b,ji!==null?0:(Li=null,Wi=0,$n(),hs)}function aa(){for(;ji!==null&&!Z1();)Uc(ji)}function Uc(u){var h=Xo(u.alternate,u,Jc);u.memoizedProps=u.pendingProps,h===null?gu(u):ji=h}function Ah(u){var h=u,b=h.alternate;switch(h.tag){case 15:case 0:h=hu(b,h,h.pendingProps,h.type,void 0,Wi);break;case 11:h=hu(b,h,h.pendingProps,h.type.render,h.ref,Wi);break;case 5:ai(h);default:Dc(b,h),h=ji=Xf(h,Jc),h=Xo(b,h,Jc)}u.memoizedProps=u.pendingProps,h===null?gu(u):ji=h}function Jo(u,h,b,E){vc=Or=null,ai(h),mf=null,th=0;var O=h.return;try{if(ea(u,O,h,b,Wi)){hs=1,yr(u,Re(b,u.current)),ji=null;return}}catch(H){if(O!==null)throw ji=O,H;hs=1,yr(u,Re(b,u.current)),ji=null;return}h.flags&32768?(qi||E===1?u=!0:yf||(Wi&536870912)!==0?u=!1:(yc=u=!0,(E===2||E===9||E===3||E===6)&&(E=Eo.current,E!==null&&E.tag===13&&(E.flags|=16384))),uc(h,u)):gu(h)}function gu(u){var h=u;do{if((h.flags&32768)!==0){uc(h,yc);return}u=h.return;var b=nc(h.alternate,h,Jc);if(b!==null){ji=b;return}if(h=h.sibling,h!==null){ji=h;return}ji=h=u}while(h!==null);hs===0&&(hs=5)}function uc(u,h){do{var b=Cl(u.alternate,u);if(b!==null){b.flags&=32767,ji=b;return}if(b=u.return,b!==null&&(b.flags|=32768,b.subtreeFlags=0,b.deletions=null),!h&&(u=u.sibling,u!==null)){ji=u;return}ji=u=b}while(u!==null);hs=6,ji=null}function Ko(u,h,b,E,O,H,ve,Xe,kt){u.cancelPendingCommit=null;do wo();while(Xs!==0);if((zi&6)!==0)throw Error(r(327));if(h!==null){if(h===u.current)throw Error(r(177));if(H=h.lanes|h.childLanes,H|=nh,X(u,b,H,ve,Xe,kt),u===Li&&(ji=Li=null,Wi=0),oh=h,Cu=u,Kc=b,Hh=H,um=O,Z0=E,(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?(u.callbackNode=null,u.callbackPriority=0,os(Bd,function(){return Wf(),null})):(u.callbackNode=null,u.callbackPriority=0),E=(h.flags&13878)!==0,(h.subtreeFlags&13878)!==0||E){E=Cn.T,Cn.T=null,O=es(),Kn(2),ve=zi,zi|=4;try{Fp(u,h,b)}finally{zi=ve,Kn(O),Cn.T=E}}Xs=1,fc(),lo(),vu()}}function fc(){if(Xs===1){Xs=0;var u=Cu,h=oh,b=(h.flags&13878)!==0;if((h.subtreeFlags&13878)!==0||b){b=Cn.T,Cn.T=null;var E=es();Kn(2);var O=zi;zi|=4;try{Qu(h,u),qr(u.containerInfo)}finally{zi=O,Kn(E),Cn.T=b}}u.current=h,Xs=2}}function lo(){if(Xs===2){Xs=0;var u=Cu,h=oh,b=(h.flags&8772)!==0;if((h.subtreeFlags&8772)!==0||b){b=Cn.T,Cn.T=null;var E=es();Kn(2);var O=zi;zi|=4;try{Md(u,h.alternate,h)}finally{zi=O,Kn(E),Cn.T=b}}Xs=3}}function vu(){if(Xs===4||Xs===3){Xs=0,V0();var u=Cu,h=oh,b=Kc,E=Z0;(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?Xs=5:(Xs=0,oh=Cu=null,Fc(u,u.pendingLanes));var O=u.pendingLanes;if(O===0&&(Eu=null),q(b),h=h.stateNode,To&&typeof To.onCommitFiberRoot=="function")try{To.onCommitFiberRoot(eh,h,void 0,(h.current.flags&128)===128)}catch{}if(E!==null){h=Cn.T,O=es(),Kn(2),Cn.T=null;try{for(var H=u.onRecoverableError,ve=0;ve<E.length;ve++){var Xe=E[ve];H(Xe.value,{componentStack:Xe.stack})}}finally{Cn.T=h,Kn(O)}}(Kc&3)!==0&&wo(),ft(u),O=u.pendingLanes,(b&261930)!==0&&(O&42)!==0?u===Xd?sr++:(sr=0,Xd=u):sr=0,Ii&&Dd(),gt(0)}}function Fc(u,h){(u.pooledCacheLanes&=h)===0&&(h=u.pooledCache,h!=null&&(u.pooledCache=null,je(h)))}function wo(){return fc(),lo(),vu(),Wf()}function Wf(){if(Xs!==5)return!1;var u=Cu,h=Hh;Hh=0;var b=q(Kc),E=32>b?32:b;b=Cn.T;var O=es();try{Kn(E),Cn.T=null,E=um,um=null;var H=Cu,ve=Kc;if(Xs=0,oh=Cu=null,Kc=0,(zi&6)!==0)throw Error(r(331));var Xe=zi;if(zi|=4,pu(H.current),Gf(H,H.current,ve,E),zi=Xe,gt(0,!1),To&&typeof To.onPostCommitFiberRoot=="function")try{To.onPostCommitFiberRoot(eh,H)}catch{}return!0}finally{Kn(O),Cn.T=b,Fc(u,h)}}function hc(u,h,b){h=Re(b,h),h=ur(u.stateNode,h,2),u=lt(u,h,2),u!==null&&(j(u,2),ft(u))}function Qn(u,h,b){if(u.tag===3)hc(u,u,b);else for(;h!==null;){if(h.tag===3){hc(h,u,b);break}else if(h.tag===1){var E=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof E.componentDidCatch=="function"&&(Eu===null||!Eu.has(E))){u=Re(b,u),b=vs(2),E=lt(h,b,2),E!==null&&(as(b,E,h,u),j(E,2),ft(E));break}}h=h.return}}function sf(u,h,b){var E=u.pingCache;if(E===null){E=u.pingCache=new rl;var O=new Set;E.set(h,O)}else O=E.get(h),O===void 0&&(O=new Set,E.set(h,O));O.has(b)||(bf=!0,O.add(b),u=jp.bind(null,u,h,b),h.then(u,u))}function jp(u,h,b){var E=u.pingCache;E!==null&&E.delete(h),u.pingedLanes|=u.suspendedLanes&b,u.warmLanes&=~b,Li===u&&(Wi&b)===b&&(hs===4||hs===3&&(Wi&62914560)===Wi&&300>Ga()-qd?(zi&2)===0&&Kr(u,0):jh|=b,Vh===Wi&&(Vh=0)),ft(u)}function Vp(u,h){h===0&&(h=I()),u=Rn(u,h),u!==null&&(j(u,h),ft(u))}function T0(u){var h=u.memoizedState,b=0;h!==null&&(b=h.retryLane),Vp(u,b)}function E0(u,h){var b=0;switch(u.tag){case 31:case 13:var E=u.stateNode,O=u.memoizedState;O!==null&&(b=O.retryLane);break;case 19:E=u.stateNode;break;case 22:E=u.stateNode._retryCache;break;default:throw Error(r(314))}E!==null&&E.delete(h),Vp(u,b)}function os(u,h){return Od(u,h)}function af(u,h,b,E){this.tag=u,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=E,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xu(u){return u=u.prototype,!(!u||!u.isReactComponent)}function co(u,h){var b=u.alternate;return b===null?(b=t(u.tag,h,u.key,u.mode),b.elementType=u.elementType,b.type=u.type,b.stateNode=u.stateNode,b.alternate=u,u.alternate=b):(b.pendingProps=h,b.type=u.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=u.flags&65011712,b.childLanes=u.childLanes,b.lanes=u.lanes,b.child=u.child,b.memoizedProps=u.memoizedProps,b.memoizedState=u.memoizedState,b.updateQueue=u.updateQueue,h=u.dependencies,b.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},b.sibling=u.sibling,b.index=u.index,b.ref=u.ref,b.refCleanup=u.refCleanup,b}function Xf(u,h){u.flags&=65011714;var b=u.alternate;return b===null?(u.childLanes=0,u.lanes=h,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=b.childLanes,u.lanes=b.lanes,u.child=b.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=b.memoizedProps,u.memoizedState=b.memoizedState,u.updateQueue=b.updateQueue,u.type=b.type,h=b.dependencies,u.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),u}function M(u,h,b,E,O,H){var ve=0;if(E=u,typeof u=="function")xu(u)&&(ve=1);else if(typeof u=="string")ve=kl&&la?Yp(u,b,wa.current)?26:j0(u)?27:5:kl?Yp(u,b,wa.current)?26:5:la&&j0(u)?27:5;else e:switch(u){case yn:return u=t(31,b,h,O),u.elementType=yn,u.lanes=H,u;case Kt:return N(b.children,O,H,h);case Yt:ve=8,O|=24;break;case Dn:return u=t(12,b,h,O|2),u.elementType=Dn,u.lanes=H,u;case Ci:return u=t(13,b,h,O),u.elementType=Ci,u.lanes=H,u;case pr:return u=t(19,b,h,O),u.elementType=pr,u.lanes=H,u;default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case Wn:ve=10;break e;case En:ve=9;break e;case Ln:ve=11;break e;case li:ve=14;break e;case wn:ve=16,E=null;break e}ve=29,b=Error(r(130,u===null?"null":typeof u,"")),E=null}return h=t(ve,b,h,O),h.elementType=u,h.type=E,h.lanes=H,h}function N(u,h,b,E){return u=t(7,u,E,h),u.lanes=b,u}function V(u,h,b){return u=t(6,u,null,h),u.lanes=b,u}function Y(u){var h=t(18,null,null,0);return h.stateNode=u,h}function oe(u,h,b){return h=t(4,u.children!==null?u.children:[],u.key,h),h.lanes=b,h.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},h}function de(u,h,b,E,O,H,ve,Xe,kt){this.tag=1,this.containerInfo=u,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=wr,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=z(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=z(0),this.hiddenUpdates=z(null),this.identifierPrefix=E,this.onUncaughtError=O,this.onCaughtError=H,this.onRecoverableError=ve,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=kt,this.incompleteTransitions=new Map}function me(u,h,b,E,O,H,ve,Xe,kt,Qt,xn,on){return u=new de(u,h,b,ve,kt,Qt,xn,on,Xe),h=1,H===!0&&(h|=24),H=t(3,null,null,h),u.current=H,H.stateNode=u,h=ue(),h.refCount++,u.pooledCache=h,h.refCount++,H.memoizedState={element:E,isDehydrated:b,cache:h},te(H),u}function Se(u){return u?(u=Gc,u):Gc}function Ne(u){var h=u._reactInternals;if(h===void 0)throw typeof u.render=="function"?Error(r(188)):(u=Object.keys(u).join(","),Error(r(268,u)));return u=c(h),u=u!==null?f(u):null,u===null?null:xs(u.stateNode)}function Le(u,h,b,E,O,H){O=Se(O),E.context===null?E.context=O:E.pendingContext=O,E=Ue(h),E.payload={element:b},H=H===void 0?null:H,H!==null&&(E.callback=H),b=lt(u,E,h),b!==null&&(Cr(b,u,h),Tt(b,u,h))}function Ke(u,h){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var b=u.retryLane;u.retryLane=b!==0&&b<h?b:h}}function mt(u,h){Ke(u,h),(u=u.alternate)&&Ke(u,h)}var Ce={},it=Wm,st=Xk,Ut=Object.assign,pt=Symbol.for("react.element"),Bt=Symbol.for("react.transitional.element"),Ft=Symbol.for("react.portal"),Kt=Symbol.for("react.fragment"),Yt=Symbol.for("react.strict_mode"),Dn=Symbol.for("react.profiler"),En=Symbol.for("react.consumer"),Wn=Symbol.for("react.context"),Ln=Symbol.for("react.forward_ref"),Ci=Symbol.for("react.suspense"),pr=Symbol.for("react.suspense_list"),li=Symbol.for("react.memo"),wn=Symbol.for("react.lazy"),yn=Symbol.for("react.activity"),Gr=Symbol.for("react.memo_cache_sentinel"),Xn=Symbol.iterator,gi=Symbol.for("react.client.reference"),Ki=Array.isArray,Cn=it.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oa=e.rendererVersion,Sr=e.rendererPackageName,ls=e.extraDevToolsConfig,xs=e.getPublicInstance,ys=e.getRootHostContext,Ni=e.getChildHostContext,Qi=e.prepareForCommit,qr=e.resetAfterCommit,rr=e.createInstance;e.cloneMutableInstance;var cs=e.appendInitialChild,kr=e.finalizeInitialChildren,Hi=e.shouldSetTextContent,Qr=e.createTextInstance;e.cloneMutableTextInstance;var lr=e.scheduleTimeout,bs=e.cancelTimeout,wr=e.noTimeout,Gi=e.isPrimaryRenderer;e.warnsIfNotActing;var ei=e.supportsMutation,Nr=e.supportsPersistence,Ii=e.supportsHydration,Vn=e.getInstanceFromNode;e.beforeActiveInstanceBlur;var Gn=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var Kn=e.setCurrentUpdatePriority,es=e.getCurrentUpdatePriority,Mo=e.resolveUpdatePriority;e.trackSchedulerEvent,e.resolveEventType,e.resolveEventTimeStamp;var Na=e.shouldAttemptEagerTransition,_s=e.detachDeletedInstance;e.requestPostPaintCallback;var zc=e.maySuspendCommit,jc=e.maySuspendCommitOnUpdate,of=e.maySuspendCommitInSyncRender,mr=e.preloadInstance,Td=e.startSuspendingCommit,Th=e.suspendInstance;e.suspendOnActiveViewTransition;var Eh=e.waitForCommitToBeReady;e.getSuspendedCommitReason;var Ha=e.NotPendingTransition,yu=e.HostTransitionContext,Ed=e.resetFormInstance;e.bindToConsole;var Cd=e.supportsMicrotasks,Ch=e.scheduleMicrotask,ts=e.supportsTestSelectors,ns=e.findFiberRoot,Yf=e.getBoundingRect,Vc=e.getTextContent,Pl=e.isHiddenSubtree,bu=e.matchAccessibilityRole,Il=e.setFocusIfFocusable,Nh=e.setupIntersectionObserver,lf=e.appendChild,Rh=e.appendChildToContainer,Lh=e.commitTextUpdate,dc=e.commitMount,Nd=e.commitUpdate,Rd=e.insertBefore,Hp=e.insertInContainerBefore,Ld=e.removeChild,Hc=e.removeChildFromContainer,Pd=e.resetTextContent,Gp=e.hideInstance,qp=e.hideTextInstance,Id=e.unhideInstance,Wp=e.unhideTextInstance;e.cancelViewTransitionName,e.cancelRootViewTransitionName,e.restoreRootViewTransitionName,e.cloneRootViewTransitionContainer,e.removeRootViewTransitionClone,e.measureClonedInstance,e.hasInstanceChanged,e.hasInstanceAffectedParent,e.startViewTransition,e.startGestureTransition,e.stopViewTransition,e.getCurrentGestureOffset,e.createViewTransitionInstance;var _u=e.clearContainer;e.createFragmentInstance,e.updateFragmentInstanceFiber,e.commitNewChildToFragmentInstance,e.deleteChildFromFragmentInstance;var Ph=e.cloneInstance,cf=e.createContainerChildSet,Qo=e.appendChildToContainerChildSet,pc=e.finalizeContainerChildren,Dl=e.replaceContainerChildren,Zf=e.cloneHiddenInstance,$f=e.cloneHiddenTextInstance,mc=e.isSuspenseInstancePending,Ih=e.isSuspenseInstanceFallback,uf=e.getSuspenseInstanceFallbackErrorDetails,ff=e.registerSuspenseInstanceRetry,T1=e.canHydrateFormStateMarker,C0=e.isFormStateMarkerMatching,E1=e.getNextHydratableSibling,C1=e.getNextHydratableSiblingAfterSingleton,N1=e.getFirstHydratableChild,R1=e.getFirstHydratableChildWithinContainer,L1=e.getFirstHydratableChildWithinActivityInstance,P1=e.getFirstHydratableChildWithinSuspenseInstance,N0=e.getFirstHydratableChildWithinSingleton,I1=e.canHydrateInstance,D1=e.canHydrateTextInstance,R0=e.canHydrateActivityInstance,k1=e.canHydrateSuspenseInstance,O1=e.hydrateInstance,bb=e.hydrateTextInstance,L0=e.hydrateActivityInstance,B1=e.hydrateSuspenseInstance,U1=e.getNextHydratableInstanceAfterActivityInstance,P0=e.getNextHydratableInstanceAfterSuspenseInstance,F1=e.commitHydratedInstance,z1=e.commitHydratedContainer,_b=e.commitHydratedActivityInstance,Sb=e.commitHydratedSuspenseInstance,j1=e.finalizeHydratedChildren,Dd=e.flushHydrationEvents;e.clearActivityBoundary;var I0=e.clearSuspenseBoundary;e.clearActivityBoundaryFromContainer;var Xp=e.clearSuspenseBoundaryFromContainer,V1=e.hideDehydratedBoundary,H1=e.unhideDehydratedBoundary,Dh=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var G1=e.validateHydratableInstance,D0=e.validateHydratableTextInstance,kl=e.supportsResources,Yp=e.isHostHoistableType,kd=e.getHoistableRoot,k0=e.getResource,O0=e.acquireResource,hf=e.releaseResource,q1=e.hydrateHoistable,B0=e.mountHoistable,U0=e.unmountHoistable,Zp=e.createHoistableInstance,W1=e.prepareToCommitHoistables,F0=e.mayResourceSuspendCommit,z0=e.preloadResource,X1=e.suspendResource,la=e.supportsSingletons,$p=e.resolveSingletonInstance,qs=e.acquireSingletonInstance,Sa=e.releaseSingletonInstance,j0=e.isHostSingletonType,Jf=e.isSingletonScope,Jp=[],Kf=-1,Gc={},Ao=Math.clz32?Math.clz32:T,Kp=Math.log,Y1=Math.LN2,Qp=256,Qf=262144,kh=4194304,Od=st.unstable_scheduleCallback,em=st.unstable_cancelCallback,Z1=st.unstable_shouldYield,V0=st.unstable_requestPaint,Ga=st.unstable_now,tm=st.unstable_ImmediatePriority,$1=st.unstable_UserBlockingPriority,Bd=st.unstable_NormalPriority,nm=st.unstable_IdlePriority,H0=st.log,J1=st.unstable_setDisableYieldValue,eh=null,To=null,ks=typeof Object.is=="function"?Object.is:J,im=typeof reportError=="function"?reportError:function(u){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var h=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof u=="object"&&u!==null&&typeof u.message=="string"?String(u.message):String(u),error:u});if(!window.dispatchEvent(h))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",u);return}console.error(u)},wb=Object.prototype.hasOwnProperty,rm,qc,Ud=!1,G0=new WeakMap,Su=[],Wc=0,Mr=null,Fd=0,Ol=[],el=0,Bl=null,Ra=1,gc="",wa=y(null),wu=y(null),La=y(null),zd=y(null),ca=null,is=null,qi=!1,Xc=null,uo=!1,sm=Error(r(519)),Ul=y(null),Or=null,vc=null,K1=typeof AbortController<"u"?AbortController:function(){var u=[],h=this.signal={aborted:!1,addEventListener:function(b,E){u.push(E)}};this.abort=function(){h.aborted=!0,u.forEach(function(b){return b()})}},Ma=st.unstable_scheduleCallback,Mb=st.unstable_NormalPriority,rs={$$typeof:Wn,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},jd=null,gr=null,qa=!1,Fl=!1,am=!1,df=0,Oh=null,q0=0,Mu=0,ua=null,zl=Cn.S;Cn.S=function(u,h){ah=Ga(),typeof h=="object"&&h!==null&&typeof h.then=="function"&&rt(u,h),zl!==null&&zl(u,h)};var pf=y(null),fa=Error(r(460)),om=Error(r(474)),jl=Error(r(542)),Yc={then:function(){}},fo=null,mf=null,th=0,Pa=xi(!0),W0=xi(!1),Ia=[],Zc=0,nh=0,tl=!1,lm=!1,ih=y(null),gf=y(0),Eo=y(null),Co=null,Ss=y(0),Au=0,yi=null,zn=null,ci=null,Ri=!1,Ti=!1,$i=!1,Wa=0,Vl=0,xc=null,X0=0,nl={readContext:he,use:Ui,useCallback:Gt,useContext:Gt,useEffect:Gt,useImperativeHandle:Gt,useLayoutEffect:Gt,useInsertionEffect:Gt,useMemo:Gt,useReducer:Gt,useRef:Gt,useState:Gt,useDebugValue:Gt,useDeferredValue:Gt,useTransition:Gt,useSyncExternalStore:Gt,useId:Gt,useHostTransitionStatus:Gt,useFormState:Gt,useActionState:Gt,useOptimistic:Gt,useMemoCache:Gt,useCacheRefresh:Gt};nl.useEffectEvent=Gt;var us={readContext:he,use:Ui,useCallback:function(u,h){return Sn().memoizedState=[u,h===void 0?null:h],u},useContext:he,useEffect:Ka,useImperativeHandle:function(u,h,b){b=b!=null?b.concat([u]):null,Ja(4194308,4,ml.bind(null,h,u),b)},useLayoutEffect:function(u,h){return Ja(4194308,4,u,h)},useInsertionEffect:function(u,h){Ja(4,2,u,h)},useMemo:function(u,h){var b=Sn();h=h===void 0?null:h;var E=u();if($i){W(!0);try{u()}finally{W(!1)}}return b.memoizedState=[E,h],E},useReducer:function(u,h,b){var E=Sn();if(b!==void 0){var O=b(h);if($i){W(!0);try{b(h)}finally{W(!1)}}}else O=h;return E.memoizedState=E.baseState=O,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:O},E.queue=u,u=u.dispatch=ae.bind(null,yi,u),[E.memoizedState,u]},useRef:function(u){var h=Sn();return u={current:u},h.memoizedState=u},useState:function(u){u=Gu(u);var h=u.queue,b=Ie.bind(null,yi,h);return h.dispatch=b,[u.memoizedState,b]},useDebugValue:Jl,useDeferredValue:function(u,h){var b=Sn();return Kl(b,u,h)},useTransition:function(){var u=Gu(!1);return u=xl.bind(null,yi,u.queue,!0,!1),Sn().memoizedState=u,[!1,u]},useSyncExternalStore:function(u,h,b){var E=yi,O=Sn();if(qi){if(b===void 0)throw Error(r(407));b=b()}else{if(b=h(),Li===null)throw Error(r(349));(Wi&127)!==0||Pr(E,h,b)}O.memoizedState=b;var H={value:b,getSnapshot:h};return O.queue=H,Ka(Zl.bind(null,E,H,u),[u]),E.flags|=2048,Hs(9,{destroy:void 0},gs.bind(null,E,H,b,h),null),b},useId:function(){var u=Sn(),h=Li.identifierPrefix;if(qi){var b=gc,E=Ra;b=(E&~(1<<32-Ao(E)-1)).toString(32)+b,h="_"+h+"R_"+b,b=Wa++,0<b&&(h+="H"+b.toString(32)),h+="_"}else b=X0++,h="_"+h+"r_"+b.toString(32)+"_";return u.memoizedState=h},useHostTransitionStatus:Yu,useFormState:Ff,useActionState:Ff,useOptimistic:function(u){var h=Sn();h.memoizedState=h.baseState=u;var b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return h.queue=b,h=at.bind(null,yi,!0,b),b.dispatch=h,[u,h]},useMemoCache:ss,useCacheRefresh:function(){return Sn().memoizedState=B.bind(null,yi)},useEffectEvent:function(u){var h=Sn(),b={impl:u};return h.memoizedState=b,function(){if((zi&2)!==0)throw Error(r(440));return b.impl.apply(void 0,arguments)}}},$c={readContext:he,use:Ui,useCallback:gl,useContext:he,useEffect:Pc,useImperativeHandle:uu,useInsertionEffect:Vo,useLayoutEffect:Qa,useMemo:vl,useReducer:Yi,useRef:Lc,useState:function(){return Yi(mi)},useDebugValue:Jl,useDeferredValue:function(u,h){var b=Jt();return Xu(b,zn.memoizedState,u,h)},useTransition:function(){var u=Yi(mi)[0],h=Jt().memoizedState;return[typeof u=="boolean"?u:mn(u),h]},useSyncExternalStore:Tr,useId:bl,useHostTransitionStatus:Yu,useFormState:Ba,useActionState:Ba,useOptimistic:function(u,h){var b=Jt();return Ea(b,zn,u,h)},useMemoCache:ss,useCacheRefresh:jf};$c.useEffectEvent=Ns;var vf={readContext:he,use:Ui,useCallback:gl,useContext:he,useEffect:Pc,useImperativeHandle:uu,useInsertionEffect:Vo,useLayoutEffect:Qa,useMemo:vl,useReducer:Zr,useRef:Lc,useState:function(){return Zr(mi)},useDebugValue:Jl,useDeferredValue:function(u,h){var b=Jt();return zn===null?Kl(b,u,h):Xu(b,zn.memoizedState,u,h)},useTransition:function(){var u=Zr(mi)[0],h=Jt().memoizedState;return[typeof u=="boolean"?u:mn(u),h]},useSyncExternalStore:Tr,useId:bl,useHostTransitionStatus:Yu,useFormState:Rc,useActionState:Rc,useOptimistic:function(u,h){var b=Jt();return zn!==null?Ea(b,zn,u,h):(b.baseState=u,[u,b.queue.dispatch])},useMemoCache:ss,useCacheRefresh:jf};vf.useEffectEvent=Ns;var Vd={enqueueSetState:function(u,h,b){u=u._reactInternals;var E=Dr(),O=Ue(E);O.payload=h,b!=null&&(O.callback=b),h=lt(u,O,E),h!==null&&(Cr(h,u,E),Tt(h,u,E))},enqueueReplaceState:function(u,h,b){u=u._reactInternals;var E=Dr(),O=Ue(E);O.tag=1,O.payload=h,b!=null&&(O.callback=b),h=lt(u,O,E),h!==null&&(Cr(h,u,E),Tt(h,u,E))},enqueueForceUpdate:function(u,h){u=u._reactInternals;var b=Dr(),E=Ue(b);E.tag=2,h!=null&&(E.callback=h),h=lt(u,E,b),h!==null&&(Cr(h,u,b),Tt(h,u,b))}},ho=Error(r(461)),Wr=!1,rh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},ws=!1,Ms=!1,Bh=!1,Y0=typeof WeakSet=="function"?WeakSet:Set,Os=null,fs=null,Bs=!1,vr=null,il=8192,Uh={getCacheForType:function(u){var h=he(rs),b=h.data.get(u);return b===void 0&&(b=u(),h.data.set(u,b)),b},cacheSignal:function(){return he(rs).controller.signal}},Hl=0,Fh=1,zh=2,Hd=3,xf=4;if(typeof Symbol=="function"&&Symbol.for){var sh=Symbol.for;Hl=sh("selector.component"),Fh=sh("selector.has_pseudo_class"),zh=sh("selector.role"),Hd=sh("selector.test_id"),xf=sh("selector.text")}var rl=typeof WeakMap=="function"?WeakMap:Map,zi=0,Li=null,ji=null,Wi=0,xr=0,Ws=null,yc=!1,yf=!1,bf=!1,Jc=0,hs=0,Tu=0,_f=0,jh=0,po=0,Vh=0,Gd=null,No=null,cm=!1,qd=0,ah=0,Sf=1/0,Wd=null,Eu=null,Xs=0,Cu=null,oh=null,Kc=0,Hh=0,um=null,Z0=null,sr=0,Xd=null;return Ce.attemptContinuousHydration=function(u){if(u.tag===13||u.tag===31){var h=Rn(u,67108864);h!==null&&Cr(h,u,67108864),mt(u,67108864)}},Ce.attemptHydrationAtCurrentPriority=function(u){if(u.tag===13||u.tag===31){var h=Dr();h=U(h);var b=Rn(u,h);b!==null&&Cr(b,u,h),mt(u,h)}},Ce.attemptSynchronousHydration=function(u){switch(u.tag){case 3:if(u=u.stateNode,u.current.memoizedState.isDehydrated){var h=A(u.pendingLanes);if(h!==0){for(u.pendingLanes|=2,u.entangledLanes|=2;h;){var b=1<<31-Ao(h);u.entanglements[1]|=b,h&=~b}ft(u),(zi&6)===0&&(Sf=Ga()+500,gt(0))}}break;case 31:case 13:h=Rn(u,2),h!==null&&Cr(h,u,2),qf(),mt(u,2)}},Ce.batchedUpdates=function(u,h){return u(h)},Ce.createComponentSelector=function(u){return{$$typeof:Hl,value:u}},Ce.createContainer=function(u,h,b,E,O,H,ve,Xe,kt,Qt){return me(u,h,!1,null,b,E,H,null,ve,Xe,kt,Qt)},Ce.createHasPseudoClassSelector=function(u){return{$$typeof:Fh,value:u}},Ce.createHydrationContainer=function(u,h,b,E,O,H,ve,Xe,kt,Qt,xn,on,Nn,vi){var Us;return u=me(b,E,!0,u,O,H,Xe,vi,kt,Qt,xn,on),u.context=Se(null),b=u.current,E=Dr(),E=U(E),O=Ue(E),O.callback=(Us=h)!=null?Us:null,lt(b,O,E),h=E,u.current.lanes=h,j(u,h),ft(u),u},Ce.createPortal=function(u,h,b){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ft,key:E==null?null:""+E,children:u,containerInfo:h,implementation:b}},Ce.createRoleSelector=function(u){return{$$typeof:zh,value:u}},Ce.createTestNameSelector=function(u){return{$$typeof:Hd,value:u}},Ce.createTextSelector=function(u){return{$$typeof:xf,value:u}},Ce.defaultOnCaughtError=function(u){console.error(u)},Ce.defaultOnRecoverableError=function(u){im(u)},Ce.defaultOnUncaughtError=function(u){im(u)},Ce.deferredUpdates=function(u){var h=Cn.T,b=es();try{return Kn(32),Cn.T=null,u()}finally{Kn(b),Cn.T=h}},Ce.discreteUpdates=function(u,h,b,E,O){var H=Cn.T,ve=es();try{return Kn(2),Cn.T=null,u(h,b,E,O)}finally{Kn(ve),Cn.T=H,zi===0&&(Sf=Ga()+500)}},Ce.findAllNodes=za,Ce.findBoundingRects=function(u,h){if(!ts)throw Error(r(363));h=za(u,h),u=[];for(var b=0;b<h.length;b++)u.push(Yf(h[b]));for(h=u.length-1;0<h;h--){b=u[h];for(var E=b.x,O=E+b.width,H=b.y,ve=H+b.height,Xe=h-1;0<=Xe;Xe--)if(h!==Xe){var kt=u[Xe],Qt=kt.x,xn=Qt+kt.width,on=kt.y,Nn=on+kt.height;if(E>=Qt&&H>=on&&O<=xn&&ve<=Nn){u.splice(h,1);break}else if(E!==Qt||b.width!==kt.width||Nn<H||on>ve){if(!(H!==on||b.height!==kt.height||xn<E||Qt>O)){Qt>E&&(kt.width+=Qt-E,kt.x=E),xn<O&&(kt.width=O-Qt),u.splice(h,1);break}}else{on>H&&(kt.height+=on-H,kt.y=H),Nn<ve&&(kt.height=ve-on),u.splice(h,1);break}}}return u},Ce.findHostInstance=Ne,Ce.findHostInstanceWithNoPortals=function(u){return u=c(u),u=u!==null?d(u):null,u===null?null:xs(u.stateNode)},Ce.findHostInstanceWithWarning=function(u){return Ne(u)},Ce.flushPassiveEffects=wo,Ce.flushSyncFromReconciler=function(u){var h=zi;zi|=1;var b=Cn.T,E=es();try{if(Kn(2),Cn.T=null,u)return u()}finally{Kn(E),Cn.T=b,zi=h,(zi&6)===0&&gt(0)}},Ce.flushSyncWork=qf,Ce.focusWithin=function(u,h){if(!ts)throw Error(r(363));for(u=Bc(u),h=rf(u,h),h=Array.from(h),u=0;u<h.length;){var b=h[u++],E=b.tag;if(!Pl(b)){if((E===5||E===26||E===27)&&Il(b.stateNode))return!0;for(b=b.child;b!==null;)h.push(b),b=b.sibling}}return!1},Ce.getFindAllNodesFailureDescription=function(u,h){if(!ts)throw Error(r(363));var b=0,E=[];u=[Bc(u),0];for(var O=0;O<u.length;){var H=u[O++],ve=H.tag,Xe=u[O++],kt=h[Xe];if((ve!==5&&ve!==26&&ve!==27||!Pl(H))&&(oc(H,kt)&&(E.push(nf(kt)),Xe++,Xe>b&&(b=Xe)),Xe<h.length))for(H=H.child;H!==null;)u.push(H,Xe),H=H.sibling}if(b<h.length){for(u=[];b<h.length;b++)u.push(nf(h[b]));return`findAllNodes was able to match part of the selector:
  `+(E.join(" > ")+`

No matching component was found for:
  `)+u.join(" > ")}return null},Ce.getPublicRootInstance=function(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 27:case 5:return xs(u.child.stateNode);default:return u.child.stateNode}},Ce.injectIntoDevTools=function(){var u={bundleType:0,version:oa,rendererPackageName:Sr,currentDispatcherRef:Cn,reconcilerVersion:"19.2.0"};if(ls!==null&&(u.rendererConfig=ls),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")u=!1;else{var h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(h.isDisabled||!h.supportsFiber)u=!0;else{try{eh=h.inject(u),To=h}catch{}u=!!h.checkDCE}}return u},Ce.isAlreadyRendering=function(){return(zi&6)!==0},Ce.observeVisibleRects=function(u,h,b,E){if(!ts)throw Error(r(363));u=za(u,h);var O=Nh(u,b,E).disconnect;return{disconnect:function(){O()}}},Ce.shouldError=function(){return null},Ce.shouldSuspend=function(){return!1},Ce.startHostTransition=function(u,h,b,E){if(u.tag!==5)throw Error(r(476));var O=yl(u).queue;xl(u,O,h,Ha,b===null?n:function(){var H=yl(u);return H.next===null&&(H=u.alternate.memoizedState),qe(u,H.next.queue,{},Dr()),b(E)})},Ce.updateContainer=function(u,h,b,E){var O=h.current,H=Dr();return Le(O,H,u,h,b,E),H},Ce.updateContainerSync=function(u,h,b,E){return Le(h.current,2,u,h,b,E),2},Ce},i.exports.default=i.exports,Object.defineProperty(i.exports,"__esModule",{value:!0})})(Q3)),Q3.exports}var tM;function _O(){return tM||(tM=1,K3.exports=bO()),K3.exports}var SO=_O();const wO=yO(SO);function MO(i){const e=wO(i);return e.injectIntoDevTools(),e}const $E=0,x0={},AO=/^three(?=[A-Z])/,mb=i=>`${i[0].toUpperCase()}${i.slice(1)}`;let TO=0;const EO=i=>typeof i=="function";function JE(i){if(EO(i)){const e=`${TO++}`;return x0[e]=i,e}else Object.assign(x0,i)}function KE(i,e){const t=mb(i),n=x0[t];if(i!=="primitive"&&!n)throw new Error(`R3F: ${t} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(i==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function CO(i,e,t){var n;return i=mb(i)in x0?i:i.replace(AO,""),KE(i,e),i==="primitive"&&(n=e.object)!=null&&n.__r3f&&delete e.object.__r3f,wy(e.object,t,i,e)}function NO(i){if(!i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?Ay(i.parent,i):ol(i.object)&&(i.object.visible=!1),i.isHidden=!0,M0(i)}}function QE(i){if(i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?My(i.parent,i):ol(i.object)&&i.props.visible!==!1&&(i.object.visible=!0),i.isHidden=!1,M0(i)}}function s2(i,e,t){const n=e.root.getState();if(!(!i.parent&&i.object!==n.scene)){if(!e.object){var r,s;const l=x0[mb(e.type)];e.object=(r=e.props.object)!=null?r:new l(...(s=e.props.args)!=null?s:[]),e.object.__r3f=e}if(Nf(e.object,e.props),e.props.attach)My(i,e);else if(ol(e.object)&&ol(i.object)){const l=i.object.children.indexOf(t?.object);if(t&&l!==-1){const c=i.object.children.indexOf(e.object);if(c!==-1){i.object.children.splice(c,1);const f=c<l?l-1:l;i.object.children.splice(f,0,e.object)}else e.object.parent=i.object,i.object.children.splice(l,0,e.object),e.object.dispatchEvent({type:"added"}),i.object.dispatchEvent({type:"childadded",child:e.object})}else i.object.add(e.object)}for(const l of e.children)s2(e,l);M0(e)}}function W5(i,e){e&&(e.parent=i,i.children.push(e),s2(i,e))}function nM(i,e,t){if(!e||!t)return;e.parent=i;const n=i.children.indexOf(t);n!==-1?i.children.splice(n,0,e):i.children.push(e),s2(i,e,t)}function e4(i){if(typeof i.dispose=="function"){const e=()=>{try{i.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():H_.unstable_scheduleCallback(H_.unstable_IdlePriority,e)}}function q_(i,e,t){if(!e)return;e.parent=null;const n=i.children.indexOf(e);n!==-1&&i.children.splice(n,1),e.props.attach?Ay(i,e):ol(e.object)&&ol(i.object)&&(i.object.remove(e.object),uO(HE(e),e.object));const r=e.props.dispose!==null&&t!==!1;for(let s=e.children.length-1;s>=0;s--){const l=e.children[s];q_(e,l,r)}e.children.length=0,delete e.object.__r3f,r&&e.type!=="primitive"&&e.object.type!=="Scene"&&e4(e.object),t===void 0&&M0(e)}function RO(i,e){for(const t of[i,i.alternate])if(t!==null)if(typeof t.ref=="function"){t.refCleanup==null||t.refCleanup();const n=t.ref(e);typeof n=="function"&&(t.refCleanup=n)}else t.ref&&(t.ref.current=e)}const Sx=[];function LO(){for(const[t]of Sx){const n=t.parent;if(n){t.props.attach?Ay(n,t):ol(t.object)&&ol(n.object)&&n.object.remove(t.object);for(const r of t.children)r.props.attach?Ay(t,r):ol(r.object)&&ol(t.object)&&t.object.remove(r.object)}t.isHidden&&QE(t),t.object.__r3f&&delete t.object.__r3f,t.type!=="primitive"&&e4(t.object)}for(const[t,n,r]of Sx){t.props=n;const s=t.parent;if(s){var i,e;const l=x0[mb(t.type)];t.object=(i=t.props.object)!=null?i:new l(...(e=t.props.args)!=null?e:[]),t.object.__r3f=t,RO(r,t.object),Nf(t.object,t.props),t.props.attach?My(s,t):ol(t.object)&&ol(s.object)&&s.object.add(t.object);for(const c of t.children)c.props.attach?My(t,c):ol(c.object)&&ol(t.object)&&t.object.add(c.object);M0(t)}}Sx.length=0}const X5=()=>{},iM={};let ax=$E;const PO=0,IO=4,Ty=MO({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:CO,removeChild:q_,appendChild:W5,appendInitialChild:W5,insertBefore:nM,appendChildToContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||W5(t,e)},removeChildFromContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||q_(t,e)},insertInContainerBefore(i,e,t){const n=i.getState().scene.__r3f;!e||!t||!n||nM(n,e,t)},getRootHostContext:()=>iM,getChildHostContext:()=>iM,commitUpdate(i,e,t,n,r){var s,l,c;KE(e,n);let f=!1;if((i.type==="primitive"&&t.object!==n.object||((s=n.args)==null?void 0:s.length)!==((l=t.args)==null?void 0:l.length)||(c=n.args)!=null&&c.some((m,g)=>{var y;return m!==((y=t.args)==null?void 0:y[g])}))&&(f=!0),f)Sx.push([i,{...n},r]);else{const m=oO(i,n);Object.keys(m).length&&(Object.assign(i.props,m),Nf(i.object,m))}(r.sibling===null||(r.flags&IO)===PO)&&LO()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:i=>i?.object,prepareForCommit:()=>null,preparePortalMount:i=>wy(i.getState().scene,i,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:NO,unhideInstance:QE,createTextInstance:X5,hideTextInstance:X5,unhideTextInstance:X5,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:ge.createContext(null),setCurrentUpdatePriority(i){ax=i},getCurrentUpdatePriority(){return ax},resolveUpdatePriority(){var i;if(ax!==$E)return ax;switch(typeof window<"u"&&((i=window.event)==null?void 0:i.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return vO;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return mO;default:return gO}},resetFormInstance(){},rendererPackageName:"@react-three/fiber",rendererVersion:xO.version,applyViewTransitionName(i,e,t){},restoreViewTransitionName(i,e){},cancelViewTransitionName(i,e,t){},cancelRootViewTransitionName(i){},restoreRootViewTransitionName(i){},InstanceMeasurement:null,measureInstance:i=>null,wasInstanceInViewport:i=>!0,hasInstanceChanged:(i,e)=>!1,hasInstanceAffectedParent:(i,e)=>!1,suspendOnActiveViewTransition(i,e){},startGestureTransition:()=>null,startViewTransition:()=>null,stopViewTransition(i){},createViewTransitionInstance:i=>null,getCurrentGestureOffset(i){throw new Error("startGestureTransition is not yet supported in react-three-fiber.")},cloneMutableInstance(i,e){return i},cloneMutableTextInstance(i){return i},cloneRootViewTransitionContainer(i){throw new Error("Not implemented.")},removeRootViewTransitionClone(i,e){throw new Error("Not implemented.")},createFragmentInstance:i=>null,updateFragmentInstanceFiber(i,e){},commitNewChildToFragmentInstance(i,e){},deleteChildFromFragmentInstance(i,e){},measureClonedInstance:i=>null,maySuspendCommitOnUpdate:(i,e,t)=>!1,maySuspendCommitInSyncRender:(i,e)=>!1,startSuspendingCommit:()=>null,getSuspendedCommitReason:(i,e)=>null}),Rp=new Map,Bm={objects:"shallow",strict:!1};function DO(i,e){if(!e&&typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&i.parentElement){const{width:t,height:n,top:r,left:s}=i.parentElement.getBoundingClientRect();return{width:t,height:n,top:r,left:s}}else if(!e&&typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas)return{width:i.width,height:i.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function kO(i){const e=Rp.get(i),t=e?.fiber,n=e?.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=n||hO(Y_,sM),l=t||Ty.createContainer(s,pO,null,!1,null,"",r,r,r,null);e||Rp.set(i,{fiber:l,store:s});let c,f,d=!1,m=null;return{async configure(g={}){let y;m=new Promise(ee=>y=ee);let{gl:v,size:S,scene:T,events:A,onCreated:w,shadows:R=!1,linear:D=!1,flat:I=!1,legacy:z=!1,orthographic:j=!1,frameloop:X="always",dpr:G=[1,2],performance:L,raycaster:k,camera:U,onPointerMissed:q}=g,W=s.getState(),J=W.gl;if(!W.gl){const ee={canvas:i,powerPreference:"high-performance",antialias:!0,alpha:!0},F=typeof v=="function"?await v(ee):v;$3(F)?J=F:J=new QS({...ee,...v}),W.set({gl:J})}let ce=W.raycaster;ce||W.set({raycaster:ce=new S0});const{params:K,...ne}=k||{};if(Ts.equ(ne,ce,Bm)||Nf(ce,{...ne}),Ts.equ(K,ce.params,Bm)||Nf(ce,{params:{...ce.params,...K}}),!W.camera||W.camera===f&&!Ts.equ(f,U,Bm)){f=U;const ee=U?.isCamera,F=ee?U:j?new au(0,0,0,0,.1,1e3):new Fs(75,0,.1,1e3);ee||(F.position.z=5,U&&(Nf(F,U),F.manual||("aspect"in U||"left"in U||"right"in U||"bottom"in U||"top"in U)&&(F.manual=!0,F.updateProjectionMatrix())),!W.camera&&!(U!=null&&U.rotation)&&F.lookAt(0,0,0)),W.set({camera:F}),ce.camera=F}if(!W.scene){let ee;T!=null&&T.isScene?(ee=T,wy(ee,s,"",{})):(ee=new p1,wy(ee,s,"",{}),T&&Nf(ee,T)),W.set({scene:ee})}A&&!W.events.handlers&&W.set({events:A(s)});const pe=DO(i,S);if(Ts.equ(pe,W.size,Bm)||W.setSize(pe.width,pe.height,pe.top,pe.left),G&&W.viewport.dpr!==qE(G)&&W.setDpr(G),W.frameloop!==X&&W.setFrameloop(X),W.onPointerMissed||W.set({onPointerMissed:q}),L&&!Ts.equ(L,W.performance,Bm)&&W.set(ee=>({performance:{...ee.performance,...L}})),!W.xr){var Re;const ee=(re,Ae)=>{const ie=s.getState();ie.frameloop!=="never"&&sM(re,!0,ie,Ae)},F=()=>{const re=s.getState();re.gl.xr.enabled=re.gl.xr.isPresenting,re.gl.xr.setAnimationLoop(re.gl.xr.isPresenting?ee:null),re.gl.xr.isPresenting||Y_(re)},$={connect(){const re=s.getState().gl;re.xr.addEventListener("sessionstart",F),re.xr.addEventListener("sessionend",F)},disconnect(){const re=s.getState().gl;re.xr.removeEventListener("sessionstart",F),re.xr.removeEventListener("sessionend",F)}};typeof((Re=J.xr)==null?void 0:Re.addEventListener)=="function"&&$.connect(),W.set({xr:$})}if(J.shadowMap){const ee=J.shadowMap.enabled,F=J.shadowMap.type;if(J.shadowMap.enabled=!!R,Ts.boo(R))J.shadowMap.type=Tg;else if(Ts.str(R)){var Te;const $={basic:ZA,percentage:Jm,soft:Tg,variance:mp};J.shadowMap.type=(Te=$[R])!=null?Te:Tg}else Ts.obj(R)&&Object.assign(J.shadowMap,R);(ee!==J.shadowMap.enabled||F!==J.shadowMap.type)&&(J.shadowMap.needsUpdate=!0)}return nr.enabled=!z,d||(J.outputColorSpace=D?Uu:vo,J.toneMapping=I?ru:Iy),W.legacy!==z&&W.set(()=>({legacy:z})),W.linear!==D&&W.set(()=>({linear:D})),W.flat!==I&&W.set(()=>({flat:I})),v&&!Ts.fun(v)&&!$3(v)&&!Ts.equ(v,J,Bm)&&Nf(J,v),c=w,d=!0,y(),this},render(g){return!d&&!m&&this.configure(),m.then(()=>{Ty.updateContainer(_.jsx(OO,{store:s,children:g,onCreated:c,rootElement:i}),l,null,()=>{})}),s},unmount(){t4(i)}}}function OO({store:i,children:e,onCreated:t,rootElement:n}){return S1(()=>{const r=i.getState();r.set(s=>({internal:{...s.internal,active:!0}})),t&&t(r),i.getState().events.connected||r.events.connect==null||r.events.connect(n)},[]),_.jsx(i2.Provider,{value:i,children:e})}function t4(i,e){const t=Rp.get(i),n=t?.fiber;if(n){const r=t?.store.getState();r&&(r.internal.active=!1),Ty.updateContainer(null,n,null,()=>{r&&setTimeout(()=>{try{var s,l,c,f;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(l=s.renderLists)==null||l.dispose==null||l.dispose(),(c=r.gl)==null||c.forceContextLoss==null||c.forceContextLoss(),(f=r.gl)!=null&&f.xr&&r.xr.disconnect(),rO(r.scene),Rp.delete(i)}catch{}},500)})}}function BO(i,e,t){return _.jsx(UO,{children:i,container:e,state:t})}function UO({state:i={},children:e,container:t}){const{events:n,size:r,...s}=i,l=r2(),[c]=ge.useState(()=>new S0),[f]=ge.useState(()=>new zt),d=n2((g,y)=>{let v;if(y.camera&&r){const S=y.camera;v=g.viewport.getCurrentViewport(S,new Ee,r),S!==g.camera&&XE(S,r)}return{...g,...y,scene:t,raycaster:c,pointer:f,mouse:f,previousRoot:l,events:{...g.events,...y.events,...n},size:{...g.size,...r},viewport:{...g.viewport,...v},setEvents:S=>y.set(T=>({...T,events:{...T.events,...S}}))}}),m=ge.useMemo(()=>{const g=BE((v,S)=>({...s,set:v,get:S})),y=v=>g.setState(S=>d.current(v,S));return y(l.getState()),l.subscribe(y),g},[l,t]);return _.jsx(_.Fragment,{children:Ty.createPortal(_.jsx(i2.Provider,{value:m,children:e}),m,null)})}const FO=new Set,zO=new Set,jO=new Set;function Y5(i,e){if(i.size)for(const{callback:t}of i.values())t(e)}function kg(i,e){switch(i){case"before":return Y5(FO,e);case"after":return Y5(zO,e);case"tail":return Y5(jO,e)}}let Z5,$5;function W_(i,e,t){let n=e.clock.getDelta();e.frameloop==="never"&&typeof i=="number"&&(n=i-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=i),Z5=e.internal.subscribers;for(let r=0;r<Z5.length;r++)$5=Z5[r],$5.ref.current($5.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let Ey=!1,X_=!1,J5,rM,Um;function n4(i){rM=requestAnimationFrame(n4),Ey=!0,J5=0,kg("before",i),X_=!0;for(const t of Rp.values()){var e;Um=t.store.getState(),Um.internal.active&&(Um.frameloop==="always"||Um.internal.frames>0)&&!((e=Um.gl.xr)!=null&&e.isPresenting)&&(J5+=W_(i,Um))}if(X_=!1,kg("after",i),J5===0)return kg("tail",i),Ey=!1,cancelAnimationFrame(rM)}function Y_(i,e=1){var t;if(!i)return Rp.forEach(n=>Y_(n.store.getState(),e));(t=i.gl.xr)!=null&&t.isPresenting||!i.internal.active||i.frameloop==="never"||(e>1?i.internal.frames=Math.min(60,i.internal.frames+e):X_?i.internal.frames=2:i.internal.frames=1,Ey||(Ey=!0,requestAnimationFrame(n4)))}function sM(i,e=!0,t,n){if(e&&kg("before",i),t)W_(i,t,n);else for(const r of Rp.values())W_(i,r.store.getState());e&&kg("after",i)}const K5={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function VO(i){const{handlePointer:e}=fO(i);return{priority:1,enabled:!0,compute(t,n,r){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(K5).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:r}=i.getState();(t=r.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{const{set:n,events:r}=i.getState();if(r.disconnect==null||r.disconnect(),n(s=>({events:{...s.events,connected:t}})),r.handlers)for(const s in r.handlers){const l=r.handlers[s],[c,f]=K5[s];t.addEventListener(c,l,{passive:f})}},disconnect:()=>{const{set:t,events:n}=i.getState();if(n.connected){if(n.handlers)for(const r in n.handlers){const s=n.handlers[r],[l]=K5[r];n.connected.removeEventListener(l,s)}t(r=>({events:{...r.events,connected:void 0}}))}}}}function aM(i,e){let t;return(...n)=>{window.clearTimeout(t),t=window.setTimeout(()=>i(...n),e)}}function HO({debounce:i,scroll:e,polyfill:t,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){const r=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!r)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,l]=ge.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),c=ge.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),f=i?typeof i=="number"?i:i.scroll:null,d=i?typeof i=="number"?i:i.resize:null,m=ge.useRef(!1);ge.useEffect(()=>(m.current=!0,()=>{m.current=!1}));const[g,y,v]=ge.useMemo(()=>{const w=()=>{if(!c.current.element)return;const{left:R,top:D,width:I,height:z,bottom:j,right:X,x:G,y:L}=c.current.element.getBoundingClientRect(),k={left:R,top:D,width:I,height:z,bottom:j,right:X,x:G,y:L};c.current.element instanceof HTMLElement&&n&&(k.height=c.current.element.offsetHeight,k.width=c.current.element.offsetWidth),Object.freeze(k),m.current&&!XO(c.current.lastBounds,k)&&l(c.current.lastBounds=k)};return[w,d?aM(w,d):w,f?aM(w,f):w]},[l,n,f,d]);function S(){c.current.scrollContainers&&(c.current.scrollContainers.forEach(w=>w.removeEventListener("scroll",v,!0)),c.current.scrollContainers=null),c.current.resizeObserver&&(c.current.resizeObserver.disconnect(),c.current.resizeObserver=null),c.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",c.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",c.current.orientationHandler))}function T(){c.current.element&&(c.current.resizeObserver=new r(v),c.current.resizeObserver.observe(c.current.element),e&&c.current.scrollContainers&&c.current.scrollContainers.forEach(w=>w.addEventListener("scroll",v,{capture:!0,passive:!0})),c.current.orientationHandler=()=>{v()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",c.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",c.current.orientationHandler))}const A=w=>{!w||w===c.current.element||(S(),c.current.element=w,c.current.scrollContainers=i4(w),T())};return qO(v,!!e),GO(y),ge.useEffect(()=>{S(),T()},[e,v,y]),ge.useEffect(()=>S,[]),[A,s,g]}function GO(i){ge.useEffect(()=>{const e=i;return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[i])}function qO(i,e){ge.useEffect(()=>{if(e){const t=i;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",t,!0)}}},[i,e])}function i4(i){const e=[];if(!i||i===document.body)return e;const{overflow:t,overflowX:n,overflowY:r}=window.getComputedStyle(i);return[t,n,r].some(s=>s==="auto"||s==="scroll")&&e.push(i),[...e,...i4(i.parentElement)]}const WO=["x","y","top","bottom","left","right","width","height"],XO=(i,e)=>WO.every(t=>i[t]===e[t]);function YO({ref:i,children:e,fallback:t,resize:n,style:r,gl:s,events:l=VO,eventSource:c,eventPrefix:f,shadows:d,linear:m,flat:g,legacy:y,orthographic:v,frameloop:S,dpr:T,performance:A,raycaster:w,camera:R,scene:D,onPointerMissed:I,onCreated:z,...j}){ge.useMemo(()=>JE(Ik),[]);const X=eO(),[G,L]=HO({scroll:!0,debounce:{scroll:50,resize:0},...n}),k=ge.useRef(null),U=ge.useRef(null);ge.useImperativeHandle(i,()=>k.current);const q=n2(I),[W,J]=ge.useState(!1),[ce,K]=ge.useState(!1);if(W)throw W;if(ce)throw ce;const ne=ge.useRef(null);S1(()=>{const Re=k.current;if(L.width>0&&L.height>0&&Re){ne.current||(ne.current=kO(Re));async function Te(){await ne.current.configure({gl:s,scene:D,events:l,shadows:d,linear:m,flat:g,legacy:y,orthographic:v,frameloop:S,dpr:T,performance:A,raycaster:w,camera:R,size:L,onPointerMissed:(...ee)=>q.current==null?void 0:q.current(...ee),onCreated:ee=>{ee.events.connect==null||ee.events.connect(c?Kk(c)?c.current:c:U.current),f&&ee.setEvents({compute:(F,$)=>{const re=F[f+"X"],Ae=F[f+"Y"];$.pointer.set(re/$.size.width*2-1,-(Ae/$.size.height)*2+1),$.raycaster.setFromCamera($.pointer,$.camera)}}),z?.(ee)}}),ne.current.render(_.jsx(X,{children:_.jsx(nO,{set:K,children:_.jsx(ge.Suspense,{fallback:_.jsx(tO,{set:J}),children:e??null})})}))}Te()}}),ge.useEffect(()=>{const Re=k.current;if(Re)return()=>t4(Re)},[]);const pe=c?"none":"auto";return _.jsx("div",{ref:U,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:pe,...r},...j,children:_.jsx("div",{ref:G,style:{width:"100%",height:"100%"},children:_.jsx("canvas",{ref:k,style:{display:"block"},children:t})})})}function ZO(i){return _.jsx(jE,{children:_.jsx(YO,{...i})})}function n1(){return n1=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},n1.apply(null,arguments)}const w1=new Ee,a2=new Ee,$O=new Ee,oM=new zt;function JO(i,e,t){const n=w1.setFromMatrixPosition(i.matrixWorld);n.project(e);const r=t.width/2,s=t.height/2;return[n.x*r+r,-(n.y*s)+s]}function KO(i,e){const t=w1.setFromMatrixPosition(i.matrixWorld),n=a2.setFromMatrixPosition(e.matrixWorld),r=t.sub(n),s=e.getWorldDirection($O);return r.angleTo(s)>Math.PI/2}function QO(i,e,t,n){const r=w1.setFromMatrixPosition(i.matrixWorld),s=r.clone();s.project(e),oM.set(s.x,s.y),t.setFromCamera(oM,e);const l=t.intersectObjects(n,!0);if(l.length){const c=l[0].distance;return r.distanceTo(t.ray.origin)<c}return!0}function eB(i,e){if(e instanceof au)return e.zoom;if(e instanceof Fs){const t=w1.setFromMatrixPosition(i.matrixWorld),n=a2.setFromMatrixPosition(e.matrixWorld),r=e.fov*Math.PI/180,s=t.distanceTo(n);return 1/(2*Math.tan(r/2)*s)}else return 1}function tB(i,e,t){if(e instanceof Fs||e instanceof au){const n=w1.setFromMatrixPosition(i.matrixWorld),r=a2.setFromMatrixPosition(e.matrixWorld),s=n.distanceTo(r),l=(t[1]-t[0])/(e.far-e.near),c=t[1]-l*e.far;return Math.round(l*s+c)}}const Z_=i=>Math.abs(i)<1e-10?0:i;function r4(i,e,t=""){let n="matrix3d(";for(let r=0;r!==16;r++)n+=Z_(e[r]*i.elements[r])+(r!==15?",":")");return t+n}const nB=(i=>e=>r4(e,i))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),iB=(i=>(e,t)=>r4(e,i(t),"translate(-50%,-50%)"))(i=>[1/i,1/i,1/i,1,-1/i,-1/i,-1/i,-1,1/i,1/i,1/i,1,1,1,1,1]);function rB(i){return i&&typeof i=="object"&&"current"in i}const fd=ge.forwardRef(({children:i,eps:e=.001,style:t,className:n,prepend:r,center:s,fullscreen:l,portal:c,distanceFactor:f,sprite:d=!1,transform:m=!1,occlude:g,onOcclude:y,castShadow:v,receiveShadow:S,material:T,geometry:A,zIndexRange:w=[16777271,0],calculatePosition:R=JO,as:D="div",wrapperClass:I,pointerEvents:z="auto",...j},X)=>{const{gl:G,camera:L,scene:k,size:U,raycaster:q,events:W,viewport:J}=da(),[ce]=ge.useState(()=>document.createElement(D)),K=ge.useRef(null),ne=ge.useRef(null),pe=ge.useRef(0),Re=ge.useRef([0,0]),Te=ge.useRef(null),ee=ge.useRef(null),F=c?.current||W.connected||G.domElement.parentNode,$=ge.useRef(null),re=ge.useRef(!1),Ae=ge.useMemo(()=>g&&g!=="blending"||Array.isArray(g)&&g.length&&rB(g[0]),[g]);ge.useLayoutEffect(()=>{const We=G.domElement;g&&g==="blending"?(We.style.zIndex=`${Math.floor(w[0]/2)}`,We.style.position="absolute",We.style.pointerEvents="none"):(We.style.zIndex=null,We.style.position=null,We.style.pointerEvents=null)},[g]),ge.useLayoutEffect(()=>{if(ne.current){const We=K.current=WA.createRoot(ce);if(k.updateMatrixWorld(),m)ce.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const nt=R(ne.current,L,U);ce.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${nt[0]}px,${nt[1]}px,0);transform-origin:0 0;`}return F&&(r?F.prepend(ce):F.appendChild(ce)),()=>{F&&F.removeChild(ce),We.unmount()}}},[F,m]),ge.useLayoutEffect(()=>{I&&(ce.className=I)},[I]);const ie=ge.useMemo(()=>m?{position:"absolute",top:0,left:0,width:U.width,height:U.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...l&&{top:-U.height/2,left:-U.width/2,width:U.width,height:U.height},...t},[t,s,l,U,m]),_e=ge.useMemo(()=>({position:"absolute",pointerEvents:z}),[z]);ge.useLayoutEffect(()=>{if(re.current=!1,m){var We;(We=K.current)==null||We.render(ge.createElement("div",{ref:Te,style:ie},ge.createElement("div",{ref:ee,style:_e},ge.createElement("div",{ref:X,className:n,style:t,children:i}))))}else{var nt;(nt=K.current)==null||nt.render(ge.createElement("div",{ref:X,style:ie,className:n,children:i}))}});const ke=ge.useRef(!0);Lr(We=>{if(ne.current){L.updateMatrixWorld(),ne.current.updateWorldMatrix(!0,!1);const nt=m?Re.current:R(ne.current,L,U);if(m||Math.abs(pe.current-L.zoom)>e||Math.abs(Re.current[0]-nt[0])>e||Math.abs(Re.current[1]-nt[1])>e){const It=KO(ne.current,L);let wt=!1;Ae&&(Array.isArray(g)?wt=g.map(Et=>Et.current):g!=="blending"&&(wt=[k]));const Je=ke.current;if(wt){const Et=QO(ne.current,L,q,wt);ke.current=Et&&!It}else ke.current=!It;Je!==ke.current&&(y?y(!ke.current):ce.style.display=ke.current?"block":"none");const le=Math.floor(w[0]/2),Qe=g?Ae?[w[0],le]:[le-1,0]:w;if(ce.style.zIndex=`${tB(ne.current,L,Qe)}`,m){const[Et,we]=[U.width/2,U.height/2],ot=L.projectionMatrix.elements[5]*we,{isOrthographicCamera:Ct,top:ht,left:xt,bottom:he,right:Q}=L,Be=nB(L.matrixWorldInverse),ue=Ct?`scale(${ot})translate(${Z_(-(Q+xt)/2)}px,${Z_((ht+he)/2)}px)`:`translateZ(${ot}px)`;let je=ne.current.matrixWorld;d&&(je=L.matrixWorldInverse.clone().transpose().copyPosition(je).scale(ne.current.scale),je.elements[3]=je.elements[7]=je.elements[11]=0,je.elements[15]=1),ce.style.width=U.width+"px",ce.style.height=U.height+"px",ce.style.perspective=Ct?"":`${ot}px`,Te.current&&ee.current&&(Te.current.style.transform=`${ue}${Be}translate(${Et}px,${we}px)`,ee.current.style.transform=iB(je,1/((f||10)/400)))}else{const Et=f===void 0?1:eB(ne.current,L)*f;ce.style.transform=`translate3d(${nt[0]}px,${nt[1]}px,0) scale(${Et})`}Re.current=nt,pe.current=L.zoom}}if(!Ae&&$.current&&!re.current)if(m){if(Te.current){const nt=Te.current.children[0];if(nt!=null&&nt.clientWidth&&nt!=null&&nt.clientHeight){const{isOrthographicCamera:It}=L;if(It||A)j.scale&&(Array.isArray(j.scale)?j.scale instanceof Ee?$.current.scale.copy(j.scale.clone().divideScalar(1)):$.current.scale.set(1/j.scale[0],1/j.scale[1],1/j.scale[2]):$.current.scale.setScalar(1/j.scale));else{const wt=(f||10)/400,Je=nt.clientWidth*wt,le=nt.clientHeight*wt;$.current.scale.set(Je,le,1)}re.current=!0}}}else{const nt=ce.children[0];if(nt!=null&&nt.clientWidth&&nt!=null&&nt.clientHeight){const It=1/J.factor,wt=nt.clientWidth*It,Je=nt.clientHeight*It;$.current.scale.set(wt,Je,1),re.current=!0}$.current.lookAt(We.camera.position)}});const Fe=ge.useMemo(()=>({vertexShader:m?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[m]);return ge.createElement("group",n1({},j,{ref:ne}),g&&!Ae&&ge.createElement("mesh",{castShadow:v,receiveShadow:S,ref:$},A||ge.createElement("planeGeometry",null),T||ge.createElement("shaderMaterial",{side:Es,vertexShader:Fe.vertexShader,fragmentShader:Fe.fragmentShader})))}),sB=i=>i;function aB(i,e=sB){const t=Wm.useSyncExternalStore(i.subscribe,Wm.useCallback(()=>e(i.getState()),[i,e]),Wm.useCallback(()=>e(i.getInitialState()),[i,e]));return Wm.useDebugValue(t),t}const lM=i=>{const e=OE(i),t=n=>aB(e,n);return Object.assign(t,e),t},oB=(i=>i?lM(i):lM),s4=parseInt(l1.replace(/\D+/g,""));var iu=Uint8Array,hd=Uint16Array,$_=Uint32Array,a4=new iu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),o4=new iu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),lB=new iu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),l4=function(i,e){for(var t=new hd(31),n=0;n<31;++n)t[n]=e+=1<<i[n-1];for(var r=new $_(t[30]),n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)r[s]=s-t[n]<<5|n;return[t,r]},c4=l4(a4,2),u4=c4[0],cB=c4[1];u4[28]=258,cB[258]=28;var uB=l4(o4,0),fB=uB[0],J_=new hd(32768);for(var ps=0;ps<32768;++ps){var rd=(ps&43690)>>>1|(ps&21845)<<1;rd=(rd&52428)>>>2|(rd&13107)<<2,rd=(rd&61680)>>>4|(rd&3855)<<4,J_[ps]=((rd&65280)>>>8|(rd&255)<<8)>>>1}var Og=(function(i,e,t){for(var n=i.length,r=0,s=new hd(e);r<n;++r)++s[i[r]-1];var l=new hd(e);for(r=0;r<e;++r)l[r]=l[r-1]+s[r-1]<<1;var c;if(t){c=new hd(1<<e);var f=15-e;for(r=0;r<n;++r)if(i[r])for(var d=r<<4|i[r],m=e-i[r],g=l[i[r]-1]++<<m,y=g|(1<<m)-1;g<=y;++g)c[J_[g]>>>f]=d}else for(c=new hd(n),r=0;r<n;++r)i[r]&&(c[r]=J_[l[i[r]-1]++]>>>15-i[r]);return c}),M1=new iu(288);for(var ps=0;ps<144;++ps)M1[ps]=8;for(var ps=144;ps<256;++ps)M1[ps]=9;for(var ps=256;ps<280;++ps)M1[ps]=7;for(var ps=280;ps<288;++ps)M1[ps]=8;var f4=new iu(32);for(var ps=0;ps<32;++ps)f4[ps]=5;var hB=Og(M1,9,1),dB=Og(f4,5,1),Q5=function(i){for(var e=i[0],t=1;t<i.length;++t)i[t]>e&&(e=i[t]);return e},Pu=function(i,e,t){var n=e/8|0;return(i[n]|i[n+1]<<8)>>(e&7)&t},e_=function(i,e){var t=e/8|0;return(i[t]|i[t+1]<<8|i[t+2]<<16)>>(e&7)},pB=function(i){return(i/8|0)+(i&7&&1)},mB=function(i,e,t){(t==null||t>i.length)&&(t=i.length);var n=new(i instanceof hd?hd:i instanceof $_?$_:iu)(t-e);return n.set(i.subarray(e,t)),n},gB=function(i,e,t){var n=i.length;if(!n||t&&!t.l&&n<5)return e||new iu(0);var r=!e||t,s=!t||t.i;t||(t={}),e||(e=new iu(n*3));var l=function(ie){var _e=e.length;if(ie>_e){var ke=new iu(Math.max(_e*2,ie));ke.set(e),e=ke}},c=t.f||0,f=t.p||0,d=t.b||0,m=t.l,g=t.d,y=t.m,v=t.n,S=n*8;do{if(!m){t.f=c=Pu(i,f,1);var T=Pu(i,f+1,3);if(f+=3,T)if(T==1)m=hB,g=dB,y=9,v=5;else if(T==2){var D=Pu(i,f,31)+257,I=Pu(i,f+10,15)+4,z=D+Pu(i,f+5,31)+1;f+=14;for(var j=new iu(z),X=new iu(19),G=0;G<I;++G)X[lB[G]]=Pu(i,f+G*3,7);f+=I*3;for(var L=Q5(X),k=(1<<L)-1,U=Og(X,L,1),G=0;G<z;){var q=U[Pu(i,f,k)];f+=q&15;var A=q>>>4;if(A<16)j[G++]=A;else{var W=0,J=0;for(A==16?(J=3+Pu(i,f,3),f+=2,W=j[G-1]):A==17?(J=3+Pu(i,f,7),f+=3):A==18&&(J=11+Pu(i,f,127),f+=7);J--;)j[G++]=W}}var ce=j.subarray(0,D),K=j.subarray(D);y=Q5(ce),v=Q5(K),m=Og(ce,y,1),g=Og(K,v,1)}else throw"invalid block type";else{var A=pB(f)+4,w=i[A-4]|i[A-3]<<8,R=A+w;if(R>n){if(s)throw"unexpected EOF";break}r&&l(d+w),e.set(i.subarray(A,R),d),t.b=d+=w,t.p=f=R*8;continue}if(f>S){if(s)throw"unexpected EOF";break}}r&&l(d+131072);for(var ne=(1<<y)-1,pe=(1<<v)-1,Re=f;;Re=f){var W=m[e_(i,f)&ne],Te=W>>>4;if(f+=W&15,f>S){if(s)throw"unexpected EOF";break}if(!W)throw"invalid length/literal";if(Te<256)e[d++]=Te;else if(Te==256){Re=f,m=null;break}else{var ee=Te-254;if(Te>264){var G=Te-257,F=a4[G];ee=Pu(i,f,(1<<F)-1)+u4[G],f+=F}var $=g[e_(i,f)&pe],re=$>>>4;if(!$)throw"invalid distance";f+=$&15;var K=fB[re];if(re>3){var F=o4[re];K+=e_(i,f)&(1<<F)-1,f+=F}if(f>S){if(s)throw"unexpected EOF";break}r&&l(d+131072);for(var Ae=d+ee;d<Ae;d+=4)e[d]=e[d-K],e[d+1]=e[d+1-K],e[d+2]=e[d+2-K],e[d+3]=e[d+3-K];d=Ae}}t.l=m,t.p=Re,t.b=d,m&&(c=1,t.m=y,t.d=g,t.n=v)}while(!c);return d==e.length?e:mB(e,0,d)},vB=new iu(0),xB=function(i){if((i[0]&15)!=8||i[0]>>>4>7||(i[0]<<8|i[1])%31)throw"invalid zlib data";if(i[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function ox(i,e){return gB((xB(i),i.subarray(2,-4)),e)}var yB=typeof TextDecoder<"u"&&new TextDecoder,bB=0;try{yB.decode(vB,{stream:!0}),bB=1}catch{}const _B=i=>i&&i.isCubeTexture;class SB extends js{constructor(e,t){var n,r;const s=_B(e),c=((r=s?(n=e.image[0])==null?void 0:n.width:e.image.width)!=null?r:1024)/4,f=Math.floor(Math.log2(c)),d=Math.pow(2,f),m=3*Math.max(d,112),g=4*d,y=[s?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/m}`,`#define CUBEUV_TEXEL_HEIGHT ${1/g}`,`#define CUBEUV_MAX_MIP ${f}.0`],v=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,S=y.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${s4>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,T={map:{value:e},height:{value:t?.height||15},radius:{value:t?.radius||100}},A=new v1(1,16),w=new fl({uniforms:T,fragmentShader:S,vertexShader:v,side:Es});super(A,w)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}var wB=Object.defineProperty,MB=(i,e,t)=>e in i?wB(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,AB=(i,e,t)=>(MB(i,e+"",t),t);class TB{constructor(){AB(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let s=0,l=r.length;s<l;s++)r[s].call(this,e);e.target=null}}}var EB=Object.defineProperty,CB=(i,e,t)=>e in i?EB(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ni=(i,e,t)=>(CB(i,typeof e!="symbol"?e+"":e,t),t);const lx=new Ip,cM=new nu,NB=Math.cos(70*(Math.PI/180)),uM=(i,e)=>(i%e+e)%e;let RB=class extends TB{constructor(e,t){super(),ni(this,"object"),ni(this,"domElement"),ni(this,"enabled",!0),ni(this,"target",new Ee),ni(this,"minDistance",0),ni(this,"maxDistance",1/0),ni(this,"minZoom",0),ni(this,"maxZoom",1/0),ni(this,"minPolarAngle",0),ni(this,"maxPolarAngle",Math.PI),ni(this,"minAzimuthAngle",-1/0),ni(this,"maxAzimuthAngle",1/0),ni(this,"enableDamping",!1),ni(this,"dampingFactor",.05),ni(this,"enableZoom",!0),ni(this,"zoomSpeed",1),ni(this,"enableRotate",!0),ni(this,"rotateSpeed",1),ni(this,"enablePan",!0),ni(this,"panSpeed",1),ni(this,"screenSpacePanning",!0),ni(this,"keyPanSpeed",7),ni(this,"zoomToCursor",!1),ni(this,"autoRotate",!1),ni(this,"autoRotateSpeed",2),ni(this,"reverseOrbit",!1),ni(this,"reverseHorizontalOrbit",!1),ni(this,"reverseVerticalOrbit",!1),ni(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),ni(this,"mouseButtons",{LEFT:cp.ROTATE,MIDDLE:cp.DOLLY,RIGHT:cp.PAN}),ni(this,"touches",{ONE:up.ROTATE,TWO:up.DOLLY_PAN}),ni(this,"target0"),ni(this,"position0"),ni(this,"zoom0"),ni(this,"_domElementKeyEvents",null),ni(this,"getPolarAngle"),ni(this,"getAzimuthalAngle"),ni(this,"setPolarAngle"),ni(this,"setAzimuthalAngle"),ni(this,"getDistance"),ni(this,"getZoomScale"),ni(this,"listenToKeyEvents"),ni(this,"stopListenToKeyEvents"),ni(this,"saveState"),ni(this,"reset"),ni(this,"update"),ni(this,"connect"),ni(this,"dispose"),ni(this,"dollyIn"),ni(this,"dollyOut"),ni(this,"getScale"),ni(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>m.phi,this.getAzimuthalAngle=()=>m.theta,this.setPolarAngle=xe=>{let Pe=uM(xe,2*Math.PI),rt=m.phi;rt<0&&(rt+=2*Math.PI),Pe<0&&(Pe+=2*Math.PI);let Me=Math.abs(Pe-rt);2*Math.PI-Me<Me&&(Pe<rt?Pe+=2*Math.PI:rt+=2*Math.PI),g.phi=Pe-rt,n.update()},this.setAzimuthalAngle=xe=>{let Pe=uM(xe,2*Math.PI),rt=m.theta;rt<0&&(rt+=2*Math.PI),Pe<0&&(Pe+=2*Math.PI);let Me=Math.abs(Pe-rt);2*Math.PI-Me<Me&&(Pe<rt?Pe+=2*Math.PI:rt+=2*Math.PI),g.theta=Pe-rt,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=xe=>{xe.addEventListener("keydown",Ye),this._domElementKeyEvents=xe},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Ye),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(r),n.update(),f=c.NONE},this.update=(()=>{const xe=new Ee,Pe=new Ee(0,1,0),rt=new Uo().setFromUnitVectors(e.up,Pe),Me=rt.clone().invert(),ze=new Ee,Mt=new Uo,Rt=2*Math.PI;return function(){const Ve=n.object.position;rt.setFromUnitVectors(e.up,Pe),Me.copy(rt).invert(),xe.copy(Ve).sub(n.target),xe.applyQuaternion(rt),m.setFromVector3(xe),n.autoRotate&&f===c.NONE&&J(q()),n.enableDamping?(m.theta+=g.theta*n.dampingFactor,m.phi+=g.phi*n.dampingFactor):(m.theta+=g.theta,m.phi+=g.phi);let vt=n.minAzimuthAngle,Dt=n.maxAzimuthAngle;isFinite(vt)&&isFinite(Dt)&&(vt<-Math.PI?vt+=Rt:vt>Math.PI&&(vt-=Rt),Dt<-Math.PI?Dt+=Rt:Dt>Math.PI&&(Dt-=Rt),vt<=Dt?m.theta=Math.max(vt,Math.min(Dt,m.theta)):m.theta=m.theta>(vt+Dt)/2?Math.max(vt,m.theta):Math.min(Dt,m.theta)),m.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,m.phi)),m.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(v,n.dampingFactor):n.target.add(v),n.zoomToCursor&&L||n.object.isOrthographicCamera?m.radius=$(m.radius):m.radius=$(m.radius*y),xe.setFromSpherical(m),xe.applyQuaternion(Me),Ve.copy(n.target).add(xe),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),n.enableDamping===!0?(g.theta*=1-n.dampingFactor,g.phi*=1-n.dampingFactor,v.multiplyScalar(1-n.dampingFactor)):(g.set(0,0,0),v.set(0,0,0));let bn=!1;if(n.zoomToCursor&&L){let dn=null;if(n.object instanceof Fs&&n.object.isPerspectiveCamera){const tn=xe.length();dn=$(tn*y);const gn=tn-dn;n.object.position.addScaledVector(X,gn),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const tn=new Ee(G.x,G.y,0);tn.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/y)),n.object.updateProjectionMatrix(),bn=!0;const gn=new Ee(G.x,G.y,0);gn.unproject(n.object),n.object.position.sub(gn).add(tn),n.object.updateMatrixWorld(),dn=xe.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;dn!==null&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(dn).add(n.object.position):(lx.origin.copy(n.object.position),lx.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(lx.direction))<NB?e.lookAt(n.target):(cM.setFromNormalAndCoplanarPoint(n.object.up,n.target),lx.intersectPlane(cM,n.target))))}else n.object instanceof au&&n.object.isOrthographicCamera&&(bn=y!==1,bn&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/y)),n.object.updateProjectionMatrix()));return y=1,L=!1,bn||ze.distanceToSquared(n.object.position)>d||8*(1-Mt.dot(n.object.quaternion))>d?(n.dispatchEvent(r),ze.copy(n.object.position),Mt.copy(n.object.quaternion),bn=!1,!0):!1}})(),this.connect=xe=>{n.domElement=xe,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",Lt),n.domElement.addEventListener("pointerdown",xt),n.domElement.addEventListener("pointercancel",Q),n.domElement.addEventListener("wheel",je)},this.dispose=()=>{var xe,Pe,rt,Me,ze,Mt;n.domElement&&(n.domElement.style.touchAction="auto"),(xe=n.domElement)==null||xe.removeEventListener("contextmenu",Lt),(Pe=n.domElement)==null||Pe.removeEventListener("pointerdown",xt),(rt=n.domElement)==null||rt.removeEventListener("pointercancel",Q),(Me=n.domElement)==null||Me.removeEventListener("wheel",je),(ze=n.domElement)==null||ze.ownerDocument.removeEventListener("pointermove",he),(Mt=n.domElement)==null||Mt.ownerDocument.removeEventListener("pointerup",Q),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",Ye)};const n=this,r={type:"change"},s={type:"start"},l={type:"end"},c={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let f=c.NONE;const d=1e-6,m=new U_,g=new U_;let y=1;const v=new Ee,S=new zt,T=new zt,A=new zt,w=new zt,R=new zt,D=new zt,I=new zt,z=new zt,j=new zt,X=new Ee,G=new zt;let L=!1;const k=[],U={};function q(){return 2*Math.PI/60/60*n.autoRotateSpeed}function W(){return Math.pow(.95,n.zoomSpeed)}function J(xe){n.reverseOrbit||n.reverseHorizontalOrbit?g.theta+=xe:g.theta-=xe}function ce(xe){n.reverseOrbit||n.reverseVerticalOrbit?g.phi+=xe:g.phi-=xe}const K=(()=>{const xe=new Ee;return function(rt,Me){xe.setFromMatrixColumn(Me,0),xe.multiplyScalar(-rt),v.add(xe)}})(),ne=(()=>{const xe=new Ee;return function(rt,Me){n.screenSpacePanning===!0?xe.setFromMatrixColumn(Me,1):(xe.setFromMatrixColumn(Me,0),xe.crossVectors(n.object.up,xe)),xe.multiplyScalar(rt),v.add(xe)}})(),pe=(()=>{const xe=new Ee;return function(rt,Me){const ze=n.domElement;if(ze&&n.object instanceof Fs&&n.object.isPerspectiveCamera){const Mt=n.object.position;xe.copy(Mt).sub(n.target);let Rt=xe.length();Rt*=Math.tan(n.object.fov/2*Math.PI/180),K(2*rt*Rt/ze.clientHeight,n.object.matrix),ne(2*Me*Rt/ze.clientHeight,n.object.matrix)}else ze&&n.object instanceof au&&n.object.isOrthographicCamera?(K(rt*(n.object.right-n.object.left)/n.object.zoom/ze.clientWidth,n.object.matrix),ne(Me*(n.object.top-n.object.bottom)/n.object.zoom/ze.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function Re(xe){n.object instanceof Fs&&n.object.isPerspectiveCamera||n.object instanceof au&&n.object.isOrthographicCamera?y=xe:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function Te(xe){Re(y/xe)}function ee(xe){Re(y*xe)}function F(xe){if(!n.zoomToCursor||!n.domElement)return;L=!0;const Pe=n.domElement.getBoundingClientRect(),rt=xe.clientX-Pe.left,Me=xe.clientY-Pe.top,ze=Pe.width,Mt=Pe.height;G.x=rt/ze*2-1,G.y=-(Me/Mt)*2+1,X.set(G.x,G.y,1).unproject(n.object).sub(n.object.position).normalize()}function $(xe){return Math.max(n.minDistance,Math.min(n.maxDistance,xe))}function re(xe){S.set(xe.clientX,xe.clientY)}function Ae(xe){F(xe),I.set(xe.clientX,xe.clientY)}function ie(xe){w.set(xe.clientX,xe.clientY)}function _e(xe){T.set(xe.clientX,xe.clientY),A.subVectors(T,S).multiplyScalar(n.rotateSpeed);const Pe=n.domElement;Pe&&(J(2*Math.PI*A.x/Pe.clientHeight),ce(2*Math.PI*A.y/Pe.clientHeight)),S.copy(T),n.update()}function ke(xe){z.set(xe.clientX,xe.clientY),j.subVectors(z,I),j.y>0?Te(W()):j.y<0&&ee(W()),I.copy(z),n.update()}function Fe(xe){R.set(xe.clientX,xe.clientY),D.subVectors(R,w).multiplyScalar(n.panSpeed),pe(D.x,D.y),w.copy(R),n.update()}function We(xe){F(xe),xe.deltaY<0?ee(W()):xe.deltaY>0&&Te(W()),n.update()}function nt(xe){let Pe=!1;switch(xe.code){case n.keys.UP:pe(0,n.keyPanSpeed),Pe=!0;break;case n.keys.BOTTOM:pe(0,-n.keyPanSpeed),Pe=!0;break;case n.keys.LEFT:pe(n.keyPanSpeed,0),Pe=!0;break;case n.keys.RIGHT:pe(-n.keyPanSpeed,0),Pe=!0;break}Pe&&(xe.preventDefault(),n.update())}function It(){if(k.length==1)S.set(k[0].pageX,k[0].pageY);else{const xe=.5*(k[0].pageX+k[1].pageX),Pe=.5*(k[0].pageY+k[1].pageY);S.set(xe,Pe)}}function wt(){if(k.length==1)w.set(k[0].pageX,k[0].pageY);else{const xe=.5*(k[0].pageX+k[1].pageX),Pe=.5*(k[0].pageY+k[1].pageY);w.set(xe,Pe)}}function Je(){const xe=k[0].pageX-k[1].pageX,Pe=k[0].pageY-k[1].pageY,rt=Math.sqrt(xe*xe+Pe*Pe);I.set(0,rt)}function le(){n.enableZoom&&Je(),n.enablePan&&wt()}function Qe(){n.enableZoom&&Je(),n.enableRotate&&It()}function Et(xe){if(k.length==1)T.set(xe.pageX,xe.pageY);else{const rt=Ge(xe),Me=.5*(xe.pageX+rt.x),ze=.5*(xe.pageY+rt.y);T.set(Me,ze)}A.subVectors(T,S).multiplyScalar(n.rotateSpeed);const Pe=n.domElement;Pe&&(J(2*Math.PI*A.x/Pe.clientHeight),ce(2*Math.PI*A.y/Pe.clientHeight)),S.copy(T)}function we(xe){if(k.length==1)R.set(xe.pageX,xe.pageY);else{const Pe=Ge(xe),rt=.5*(xe.pageX+Pe.x),Me=.5*(xe.pageY+Pe.y);R.set(rt,Me)}D.subVectors(R,w).multiplyScalar(n.panSpeed),pe(D.x,D.y),w.copy(R)}function ot(xe){const Pe=Ge(xe),rt=xe.pageX-Pe.x,Me=xe.pageY-Pe.y,ze=Math.sqrt(rt*rt+Me*Me);z.set(0,ze),j.set(0,Math.pow(z.y/I.y,n.zoomSpeed)),Te(j.y),I.copy(z)}function Ct(xe){n.enableZoom&&ot(xe),n.enablePan&&we(xe)}function ht(xe){n.enableZoom&&ot(xe),n.enableRotate&&Et(xe)}function xt(xe){var Pe,rt;n.enabled!==!1&&(k.length===0&&((Pe=n.domElement)==null||Pe.ownerDocument.addEventListener("pointermove",he),(rt=n.domElement)==null||rt.ownerDocument.addEventListener("pointerup",Q)),un(xe),xe.pointerType==="touch"?ft(xe):Be(xe))}function he(xe){n.enabled!==!1&&(xe.pointerType==="touch"?gt(xe):ue(xe))}function Q(xe){var Pe,rt,Me;bt(xe),k.length===0&&((Pe=n.domElement)==null||Pe.releasePointerCapture(xe.pointerId),(rt=n.domElement)==null||rt.ownerDocument.removeEventListener("pointermove",he),(Me=n.domElement)==null||Me.ownerDocument.removeEventListener("pointerup",Q)),n.dispatchEvent(l),f=c.NONE}function Be(xe){let Pe;switch(xe.button){case 0:Pe=n.mouseButtons.LEFT;break;case 1:Pe=n.mouseButtons.MIDDLE;break;case 2:Pe=n.mouseButtons.RIGHT;break;default:Pe=-1}switch(Pe){case cp.DOLLY:if(n.enableZoom===!1)return;Ae(xe),f=c.DOLLY;break;case cp.ROTATE:if(xe.ctrlKey||xe.metaKey||xe.shiftKey){if(n.enablePan===!1)return;ie(xe),f=c.PAN}else{if(n.enableRotate===!1)return;re(xe),f=c.ROTATE}break;case cp.PAN:if(xe.ctrlKey||xe.metaKey||xe.shiftKey){if(n.enableRotate===!1)return;re(xe),f=c.ROTATE}else{if(n.enablePan===!1)return;ie(xe),f=c.PAN}break;default:f=c.NONE}f!==c.NONE&&n.dispatchEvent(s)}function ue(xe){if(n.enabled!==!1)switch(f){case c.ROTATE:if(n.enableRotate===!1)return;_e(xe);break;case c.DOLLY:if(n.enableZoom===!1)return;ke(xe);break;case c.PAN:if(n.enablePan===!1)return;Fe(xe);break}}function je(xe){n.enabled===!1||n.enableZoom===!1||f!==c.NONE&&f!==c.ROTATE||(xe.preventDefault(),n.dispatchEvent(s),We(xe),n.dispatchEvent(l))}function Ye(xe){n.enabled===!1||n.enablePan===!1||nt(xe)}function ft(xe){switch(dt(xe),k.length){case 1:switch(n.touches.ONE){case up.ROTATE:if(n.enableRotate===!1)return;It(),f=c.TOUCH_ROTATE;break;case up.PAN:if(n.enablePan===!1)return;wt(),f=c.TOUCH_PAN;break;default:f=c.NONE}break;case 2:switch(n.touches.TWO){case up.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;le(),f=c.TOUCH_DOLLY_PAN;break;case up.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Qe(),f=c.TOUCH_DOLLY_ROTATE;break;default:f=c.NONE}break;default:f=c.NONE}f!==c.NONE&&n.dispatchEvent(s)}function gt(xe){switch(dt(xe),f){case c.TOUCH_ROTATE:if(n.enableRotate===!1)return;Et(xe),n.update();break;case c.TOUCH_PAN:if(n.enablePan===!1)return;we(xe),n.update();break;case c.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Ct(xe),n.update();break;case c.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;ht(xe),n.update();break;default:f=c.NONE}}function Lt(xe){n.enabled!==!1&&xe.preventDefault()}function un(xe){k.push(xe)}function bt(xe){delete U[xe.pointerId];for(let Pe=0;Pe<k.length;Pe++)if(k[Pe].pointerId==xe.pointerId){k.splice(Pe,1);return}}function dt(xe){let Pe=U[xe.pointerId];Pe===void 0&&(Pe=new zt,U[xe.pointerId]=Pe),Pe.set(xe.pageX,xe.pageY)}function Ge(xe){const Pe=xe.pointerId===k[0].pointerId?k[1]:k[0];return U[Pe.pointerId]}this.dollyIn=(xe=W())=>{ee(xe),n.update()},this.dollyOut=(xe=W())=>{Te(xe),n.update()},this.getScale=()=>y,this.setScale=xe=>{Re(xe),n.update()},this.getZoomScale=()=>W(),t!==void 0&&this.connect(t),this.update()}};class LB extends GS{constructor(e){super(e),this.type=Ks}parse(e){const l=function(G,L){switch(G){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(L||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(L||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(L||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(L||""))}},g=function(G,L,k){L=L||1024;let q=G.pos,W=-1,J=0,ce="",K=String.fromCharCode.apply(null,new Uint16Array(G.subarray(q,q+128)));for(;0>(W=K.indexOf(`
`))&&J<L&&q<G.byteLength;)ce+=K,J+=K.length,q+=128,K+=String.fromCharCode.apply(null,new Uint16Array(G.subarray(q,q+128)));return-1<W?(G.pos+=J+W+1,ce+K.slice(0,W)):!1},y=function(G){const L=/^#\?(\S+)/,k=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,U=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,q=/^\s*FORMAT=(\S+)\s*$/,W=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,J={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let ce,K;for((G.pos>=G.byteLength||!(ce=g(G)))&&l(1,"no header found"),(K=ce.match(L))||l(3,"bad initial token"),J.valid|=1,J.programtype=K[1],J.string+=ce+`
`;ce=g(G),ce!==!1;){if(J.string+=ce+`
`,ce.charAt(0)==="#"){J.comments+=ce+`
`;continue}if((K=ce.match(k))&&(J.gamma=parseFloat(K[1])),(K=ce.match(U))&&(J.exposure=parseFloat(K[1])),(K=ce.match(q))&&(J.valid|=2,J.format=K[1]),(K=ce.match(W))&&(J.valid|=4,J.height=parseInt(K[1],10),J.width=parseInt(K[2],10)),J.valid&2&&J.valid&4)break}return J.valid&2||l(3,"missing format specifier"),J.valid&4||l(3,"missing image size specifier"),J},v=function(G,L,k){const U=L;if(U<8||U>32767||G[0]!==2||G[1]!==2||G[2]&128)return new Uint8Array(G);U!==(G[2]<<8|G[3])&&l(3,"wrong scanline width");const q=new Uint8Array(4*L*k);q.length||l(4,"unable to allocate buffer space");let W=0,J=0;const ce=4*U,K=new Uint8Array(4),ne=new Uint8Array(ce);let pe=k;for(;pe>0&&J<G.byteLength;){J+4>G.byteLength&&l(1),K[0]=G[J++],K[1]=G[J++],K[2]=G[J++],K[3]=G[J++],(K[0]!=2||K[1]!=2||(K[2]<<8|K[3])!=U)&&l(3,"bad rgbe scanline format");let Re=0,Te;for(;Re<ce&&J<G.byteLength;){Te=G[J++];const F=Te>128;if(F&&(Te-=128),(Te===0||Re+Te>ce)&&l(3,"bad scanline data"),F){const $=G[J++];for(let re=0;re<Te;re++)ne[Re++]=$}else ne.set(G.subarray(J,J+Te),Re),Re+=Te,J+=Te}const ee=U;for(let F=0;F<ee;F++){let $=0;q[W]=ne[F+$],$+=U,q[W+1]=ne[F+$],$+=U,q[W+2]=ne[F+$],$+=U,q[W+3]=ne[F+$],W+=4}pe--}return q},S=function(G,L,k,U){const q=G[L+3],W=Math.pow(2,q-128)/255;k[U+0]=G[L+0]*W,k[U+1]=G[L+1]*W,k[U+2]=G[L+2]*W,k[U+3]=1},T=function(G,L,k,U){const q=G[L+3],W=Math.pow(2,q-128)/255;k[U+0]=yp.toHalfFloat(Math.min(G[L+0]*W,65504)),k[U+1]=yp.toHalfFloat(Math.min(G[L+1]*W,65504)),k[U+2]=yp.toHalfFloat(Math.min(G[L+2]*W,65504)),k[U+3]=yp.toHalfFloat(1)},A=new Uint8Array(e);A.pos=0;const w=y(A),R=w.width,D=w.height,I=v(A.subarray(A.pos),R,D);let z,j,X;switch(this.type){case Cs:X=I.length/4;const G=new Float32Array(X*4);for(let k=0;k<X;k++)S(I,k*4,G,k*4);z=G,j=Cs;break;case Ks:X=I.length/4;const L=new Uint16Array(X*4);for(let k=0;k<X;k++)T(I,k*4,L,k*4);z=L,j=Ks;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:R,height:D,data:z,header:w.string,gamma:w.gamma,exposure:w.exposure,type:j}}setDataType(e){return this.type=e,this}load(e,t,n,r){function s(l,c){switch(l.type){case Cs:case Ks:"colorSpace"in l?l.colorSpace="srgb-linear":l.encoding=3e3,l.minFilter=ar,l.magFilter=ar,l.generateMipmaps=!1,l.flipY=!0;break}t&&t(l,c)}return super.load(e,s,n,r)}}const yg=s4>=152;class PB extends GS{constructor(e){super(e),this.type=Ks}parse(e){const L=Math.pow(2.7182818,2.2);function k(te,be){for(var Ue=0,lt=0;lt<65536;++lt)(lt==0||te[lt>>3]&1<<(lt&7))&&(be[Ue++]=lt);for(var Tt=Ue-1;Ue<65536;)be[Ue++]=0;return Tt}function U(te){for(var be=0;be<16384;be++)te[be]={},te[be].len=0,te[be].lit=0,te[be].p=null}const q={l:0,c:0,lc:0};function W(te,be,Ue,lt,Tt){for(;Ue<te;)be=be<<8|Ge(lt,Tt),Ue+=8;Ue-=te,q.l=be>>Ue&(1<<te)-1,q.c=be,q.lc=Ue}const J=new Array(59);function ce(te){for(var be=0;be<=58;++be)J[be]=0;for(var be=0;be<65537;++be)J[te[be]]+=1;for(var Ue=0,be=58;be>0;--be){var lt=Ue+J[be]>>1;J[be]=Ue,Ue=lt}for(var be=0;be<65537;++be){var Tt=te[be];Tt>0&&(te[be]=Tt|J[Tt]++<<6)}}function K(te,be,Ue,lt,Tt,St,Xt){for(var qt=Ue,an=0,sn=0;Tt<=St;Tt++){if(qt.value-Ue.value>lt)return!1;W(6,an,sn,te,qt);var ln=q.l;if(an=q.c,sn=q.lc,Xt[Tt]=ln,ln==63){if(qt.value-Ue.value>lt)throw"Something wrong with hufUnpackEncTable";W(8,an,sn,te,qt);var rn=q.l+6;if(an=q.c,sn=q.lc,Tt+rn>St+1)throw"Something wrong with hufUnpackEncTable";for(;rn--;)Xt[Tt++]=0;Tt--}else if(ln>=59){var rn=ln-59+2;if(Tt+rn>St+1)throw"Something wrong with hufUnpackEncTable";for(;rn--;)Xt[Tt++]=0;Tt--}}ce(Xt)}function ne(te){return te&63}function pe(te){return te>>6}function Re(te,be,Ue,lt){for(;be<=Ue;be++){var Tt=pe(te[be]),St=ne(te[be]);if(Tt>>St)throw"Invalid table entry";if(St>14){var Xt=lt[Tt>>St-14];if(Xt.len)throw"Invalid table entry";if(Xt.lit++,Xt.p){var qt=Xt.p;Xt.p=new Array(Xt.lit);for(var an=0;an<Xt.lit-1;++an)Xt.p[an]=qt[an]}else Xt.p=new Array(1);Xt.p[Xt.lit-1]=be}else if(St)for(var sn=0,an=1<<14-St;an>0;an--){var Xt=lt[(Tt<<14-St)+sn];if(Xt.len||Xt.p)throw"Invalid table entry";Xt.len=St,Xt.lit=be,sn++}}return!0}const Te={c:0,lc:0};function ee(te,be,Ue,lt){te=te<<8|Ge(Ue,lt),be+=8,Te.c=te,Te.lc=be}const F={c:0,lc:0};function $(te,be,Ue,lt,Tt,St,Xt,qt,an,sn){if(te==be){lt<8&&(ee(Ue,lt,Tt,Xt),Ue=Te.c,lt=Te.lc),lt-=8;var ln=Ue>>lt,ln=new Uint8Array([ln])[0];if(an.value+ln>sn)return!1;for(var rn=qt[an.value-1];ln-- >0;)qt[an.value++]=rn}else if(an.value<sn)qt[an.value++]=te;else return!1;F.c=Ue,F.lc=lt}function re(te){return te&65535}function Ae(te){var be=re(te);return be>32767?be-65536:be}const ie={a:0,b:0};function _e(te,be){var Ue=Ae(te),lt=Ae(be),Tt=lt,St=Ue+(Tt&1)+(Tt>>1),Xt=St,qt=St-Tt;ie.a=Xt,ie.b=qt}function ke(te,be){var Ue=re(te),lt=re(be),Tt=Ue-(lt>>1)&65535,St=lt+Tt-32768&65535;ie.a=St,ie.b=Tt}function Fe(te,be,Ue,lt,Tt,St,Xt){for(var qt=Xt<16384,an=Ue>Tt?Tt:Ue,sn=1,ln;sn<=an;)sn<<=1;for(sn>>=1,ln=sn,sn>>=1;sn>=1;){for(var rn=0,fe=rn+St*(Tt-ln),Oe=St*sn,$e=St*ln,et=lt*sn,Ze=lt*ln,Vt,en,Gt,vn;rn<=fe;rn+=$e){for(var nn=rn,Tn=rn+lt*(Ue-ln);nn<=Tn;nn+=Ze){var cn=nn+et,hn=nn+Oe,si=hn+et;qt?(_e(te[nn+be],te[hn+be]),Vt=ie.a,Gt=ie.b,_e(te[cn+be],te[si+be]),en=ie.a,vn=ie.b,_e(Vt,en),te[nn+be]=ie.a,te[cn+be]=ie.b,_e(Gt,vn),te[hn+be]=ie.a,te[si+be]=ie.b):(ke(te[nn+be],te[hn+be]),Vt=ie.a,Gt=ie.b,ke(te[cn+be],te[si+be]),en=ie.a,vn=ie.b,ke(Vt,en),te[nn+be]=ie.a,te[cn+be]=ie.b,ke(Gt,vn),te[hn+be]=ie.a,te[si+be]=ie.b)}if(Ue&sn){var hn=nn+Oe;qt?_e(te[nn+be],te[hn+be]):ke(te[nn+be],te[hn+be]),Vt=ie.a,te[hn+be]=ie.b,te[nn+be]=Vt}}if(Tt&sn)for(var nn=rn,Tn=rn+lt*(Ue-ln);nn<=Tn;nn+=Ze){var cn=nn+et;qt?_e(te[nn+be],te[cn+be]):ke(te[nn+be],te[cn+be]),Vt=ie.a,te[cn+be]=ie.b,te[nn+be]=Vt}ln=sn,sn>>=1}return rn}function We(te,be,Ue,lt,Tt,St,Xt,qt,an,sn){for(var ln=0,rn=0,fe=qt,Oe=Math.trunc(Tt.value+(St+7)/8);Tt.value<Oe;)for(ee(ln,rn,Ue,Tt),ln=Te.c,rn=Te.lc;rn>=14;){var $e=ln>>rn-14&16383,et=be[$e];if(et.len)rn-=et.len,$(et.lit,Xt,ln,rn,Ue,lt,Tt,an,sn,fe),ln=F.c,rn=F.lc;else{if(!et.p)throw"hufDecode issues";var Ze;for(Ze=0;Ze<et.lit;Ze++){for(var Vt=ne(te[et.p[Ze]]);rn<Vt&&Tt.value<Oe;)ee(ln,rn,Ue,Tt),ln=Te.c,rn=Te.lc;if(rn>=Vt&&pe(te[et.p[Ze]])==(ln>>rn-Vt&(1<<Vt)-1)){rn-=Vt,$(et.p[Ze],Xt,ln,rn,Ue,lt,Tt,an,sn,fe),ln=F.c,rn=F.lc;break}}if(Ze==et.lit)throw"hufDecode issues"}}var en=8-St&7;for(ln>>=en,rn-=en;rn>0;){var et=be[ln<<14-rn&16383];if(et.len)rn-=et.len,$(et.lit,Xt,ln,rn,Ue,lt,Tt,an,sn,fe),ln=F.c,rn=F.lc;else throw"hufDecode issues"}return!0}function nt(te,be,Ue,lt,Tt,St){var Xt={value:0},qt=Ue.value,an=dt(be,Ue),sn=dt(be,Ue);Ue.value+=4;var ln=dt(be,Ue);if(Ue.value+=4,an<0||an>=65537||sn<0||sn>=65537)throw"Something wrong with HUF_ENCSIZE";var rn=new Array(65537),fe=new Array(16384);U(fe);var Oe=lt-(Ue.value-qt);if(K(te,be,Ue,Oe,an,sn,rn),ln>8*(lt-(Ue.value-qt)))throw"Something wrong with hufUncompress";Re(rn,an,sn,fe),We(rn,fe,te,be,Ue,ln,sn,St,Tt,Xt)}function It(te,be,Ue){for(var lt=0;lt<Ue;++lt)be[lt]=te[be[lt]]}function wt(te){for(var be=1;be<te.length;be++){var Ue=te[be-1]+te[be]-128;te[be]=Ue}}function Je(te,be){for(var Ue=0,lt=Math.floor((te.length+1)/2),Tt=0,St=te.length-1;!(Tt>St||(be[Tt++]=te[Ue++],Tt>St));)be[Tt++]=te[lt++]}function le(te){for(var be=te.byteLength,Ue=new Array,lt=0,Tt=new DataView(te);be>0;){var St=Tt.getInt8(lt++);if(St<0){var Xt=-St;be-=Xt+1;for(var qt=0;qt<Xt;qt++)Ue.push(Tt.getUint8(lt++))}else{var Xt=St;be-=2;for(var an=Tt.getUint8(lt++),qt=0;qt<Xt+1;qt++)Ue.push(an)}}return Ue}function Qe(te,be,Ue,lt,Tt,St){var cn=new DataView(St.buffer),Xt=Ue[te.idx[0]].width,qt=Ue[te.idx[0]].height,an=3,sn=Math.floor(Xt/8),ln=Math.ceil(Xt/8),rn=Math.ceil(qt/8),fe=Xt-(ln-1)*8,Oe=qt-(rn-1)*8,$e={value:0},et=new Array(an),Ze=new Array(an),Vt=new Array(an),en=new Array(an),Gt=new Array(an);for(let Sn=0;Sn<an;++Sn)Gt[Sn]=be[te.idx[Sn]],et[Sn]=Sn<1?0:et[Sn-1]+ln*rn,Ze[Sn]=new Float32Array(64),Vt[Sn]=new Uint16Array(64),en[Sn]=new Uint16Array(ln*64);for(let Sn=0;Sn<rn;++Sn){var vn=8;Sn==rn-1&&(vn=Oe);var nn=8;for(let _n=0;_n<ln;++_n){_n==ln-1&&(nn=fe);for(let mn=0;mn<an;++mn)Vt[mn].fill(0),Vt[mn][0]=Tt[et[mn]++],Et($e,lt,Vt[mn]),we(Vt[mn],Ze[mn]),ot(Ze[mn]);Ct(Ze);for(let mn=0;mn<an;++mn)ht(Ze[mn],en[mn],_n*64)}let Jt=0;for(let _n=0;_n<an;++_n){const mn=Ue[te.idx[_n]].type;for(let Ui=8*Sn;Ui<8*Sn+vn;++Ui){Jt=Gt[_n][Ui];for(let ss=0;ss<sn;++ss){const mi=ss*64+(Ui&7)*8;cn.setUint16(Jt+0*mn,en[_n][mi+0],!0),cn.setUint16(Jt+2*mn,en[_n][mi+1],!0),cn.setUint16(Jt+4*mn,en[_n][mi+2],!0),cn.setUint16(Jt+6*mn,en[_n][mi+3],!0),cn.setUint16(Jt+8*mn,en[_n][mi+4],!0),cn.setUint16(Jt+10*mn,en[_n][mi+5],!0),cn.setUint16(Jt+12*mn,en[_n][mi+6],!0),cn.setUint16(Jt+14*mn,en[_n][mi+7],!0),Jt+=16*mn}}if(sn!=ln)for(let Ui=8*Sn;Ui<8*Sn+vn;++Ui){const ss=Gt[_n][Ui]+8*sn*2*mn,mi=sn*64+(Ui&7)*8;for(let Yi=0;Yi<nn;++Yi)cn.setUint16(ss+Yi*2*mn,en[_n][mi+Yi],!0)}}}for(var Tn=new Uint16Array(Xt),cn=new DataView(St.buffer),hn=0;hn<an;++hn){Ue[te.idx[hn]].decoded=!0;var si=Ue[te.idx[hn]].type;if(Ue[hn].type==2)for(var pi=0;pi<qt;++pi){const Sn=Gt[hn][pi];for(var ai=0;ai<Xt;++ai)Tn[ai]=cn.getUint16(Sn+ai*2*si,!0);for(var ai=0;ai<Xt;++ai)cn.setFloat32(Sn+ai*2*si,ze(Tn[ai]),!0)}}}function Et(te,be,Ue){for(var lt,Tt=1;Tt<64;)lt=be[te.value],lt==65280?Tt=64:lt>>8==255?Tt+=lt&255:(Ue[Tt]=lt,Tt++),te.value++}function we(te,be){be[0]=ze(te[0]),be[1]=ze(te[1]),be[2]=ze(te[5]),be[3]=ze(te[6]),be[4]=ze(te[14]),be[5]=ze(te[15]),be[6]=ze(te[27]),be[7]=ze(te[28]),be[8]=ze(te[2]),be[9]=ze(te[4]),be[10]=ze(te[7]),be[11]=ze(te[13]),be[12]=ze(te[16]),be[13]=ze(te[26]),be[14]=ze(te[29]),be[15]=ze(te[42]),be[16]=ze(te[3]),be[17]=ze(te[8]),be[18]=ze(te[12]),be[19]=ze(te[17]),be[20]=ze(te[25]),be[21]=ze(te[30]),be[22]=ze(te[41]),be[23]=ze(te[43]),be[24]=ze(te[9]),be[25]=ze(te[11]),be[26]=ze(te[18]),be[27]=ze(te[24]),be[28]=ze(te[31]),be[29]=ze(te[40]),be[30]=ze(te[44]),be[31]=ze(te[53]),be[32]=ze(te[10]),be[33]=ze(te[19]),be[34]=ze(te[23]),be[35]=ze(te[32]),be[36]=ze(te[39]),be[37]=ze(te[45]),be[38]=ze(te[52]),be[39]=ze(te[54]),be[40]=ze(te[20]),be[41]=ze(te[22]),be[42]=ze(te[33]),be[43]=ze(te[38]),be[44]=ze(te[46]),be[45]=ze(te[51]),be[46]=ze(te[55]),be[47]=ze(te[60]),be[48]=ze(te[21]),be[49]=ze(te[34]),be[50]=ze(te[37]),be[51]=ze(te[47]),be[52]=ze(te[50]),be[53]=ze(te[56]),be[54]=ze(te[59]),be[55]=ze(te[61]),be[56]=ze(te[35]),be[57]=ze(te[36]),be[58]=ze(te[48]),be[59]=ze(te[49]),be[60]=ze(te[57]),be[61]=ze(te[58]),be[62]=ze(te[62]),be[63]=ze(te[63])}function ot(te){const be=.5*Math.cos(.7853975),Ue=.5*Math.cos(3.14159/16),lt=.5*Math.cos(3.14159/8),Tt=.5*Math.cos(3*3.14159/16),St=.5*Math.cos(5*3.14159/16),Xt=.5*Math.cos(3*3.14159/8),qt=.5*Math.cos(7*3.14159/16);for(var an=new Array(4),sn=new Array(4),ln=new Array(4),rn=new Array(4),fe=0;fe<8;++fe){var Oe=fe*8;an[0]=lt*te[Oe+2],an[1]=Xt*te[Oe+2],an[2]=lt*te[Oe+6],an[3]=Xt*te[Oe+6],sn[0]=Ue*te[Oe+1]+Tt*te[Oe+3]+St*te[Oe+5]+qt*te[Oe+7],sn[1]=Tt*te[Oe+1]-qt*te[Oe+3]-Ue*te[Oe+5]-St*te[Oe+7],sn[2]=St*te[Oe+1]-Ue*te[Oe+3]+qt*te[Oe+5]+Tt*te[Oe+7],sn[3]=qt*te[Oe+1]-St*te[Oe+3]+Tt*te[Oe+5]-Ue*te[Oe+7],ln[0]=be*(te[Oe+0]+te[Oe+4]),ln[3]=be*(te[Oe+0]-te[Oe+4]),ln[1]=an[0]+an[3],ln[2]=an[1]-an[2],rn[0]=ln[0]+ln[1],rn[1]=ln[3]+ln[2],rn[2]=ln[3]-ln[2],rn[3]=ln[0]-ln[1],te[Oe+0]=rn[0]+sn[0],te[Oe+1]=rn[1]+sn[1],te[Oe+2]=rn[2]+sn[2],te[Oe+3]=rn[3]+sn[3],te[Oe+4]=rn[3]-sn[3],te[Oe+5]=rn[2]-sn[2],te[Oe+6]=rn[1]-sn[1],te[Oe+7]=rn[0]-sn[0]}for(var $e=0;$e<8;++$e)an[0]=lt*te[16+$e],an[1]=Xt*te[16+$e],an[2]=lt*te[48+$e],an[3]=Xt*te[48+$e],sn[0]=Ue*te[8+$e]+Tt*te[24+$e]+St*te[40+$e]+qt*te[56+$e],sn[1]=Tt*te[8+$e]-qt*te[24+$e]-Ue*te[40+$e]-St*te[56+$e],sn[2]=St*te[8+$e]-Ue*te[24+$e]+qt*te[40+$e]+Tt*te[56+$e],sn[3]=qt*te[8+$e]-St*te[24+$e]+Tt*te[40+$e]-Ue*te[56+$e],ln[0]=be*(te[$e]+te[32+$e]),ln[3]=be*(te[$e]-te[32+$e]),ln[1]=an[0]+an[3],ln[2]=an[1]-an[2],rn[0]=ln[0]+ln[1],rn[1]=ln[3]+ln[2],rn[2]=ln[3]-ln[2],rn[3]=ln[0]-ln[1],te[0+$e]=rn[0]+sn[0],te[8+$e]=rn[1]+sn[1],te[16+$e]=rn[2]+sn[2],te[24+$e]=rn[3]+sn[3],te[32+$e]=rn[3]-sn[3],te[40+$e]=rn[2]-sn[2],te[48+$e]=rn[1]-sn[1],te[56+$e]=rn[0]-sn[0]}function Ct(te){for(var be=0;be<64;++be){var Ue=te[0][be],lt=te[1][be],Tt=te[2][be];te[0][be]=Ue+1.5747*Tt,te[1][be]=Ue-.1873*lt-.4682*Tt,te[2][be]=Ue+1.8556*lt}}function ht(te,be,Ue){for(var lt=0;lt<64;++lt)be[Ue+lt]=yp.toHalfFloat(xt(te[lt]))}function xt(te){return te<=1?Math.sign(te)*Math.pow(Math.abs(te),2.2):Math.sign(te)*Math.pow(L,Math.abs(te)-1)}function he(te){return new DataView(te.array.buffer,te.offset.value,te.size)}function Q(te){var be=te.viewer.buffer.slice(te.offset.value,te.offset.value+te.size),Ue=new Uint8Array(le(be)),lt=new Uint8Array(Ue.length);return wt(Ue),Je(Ue,lt),new DataView(lt.buffer)}function Be(te){var be=te.array.slice(te.offset.value,te.offset.value+te.size),Ue=ox(be),lt=new Uint8Array(Ue.length);return wt(Ue),Je(Ue,lt),new DataView(lt.buffer)}function ue(te){for(var be=te.viewer,Ue={value:te.offset.value},lt=new Uint16Array(te.width*te.scanlineBlockSize*(te.channels*te.type)),Tt=new Uint8Array(8192),St=0,Xt=new Array(te.channels),qt=0;qt<te.channels;qt++)Xt[qt]={},Xt[qt].start=St,Xt[qt].end=Xt[qt].start,Xt[qt].nx=te.width,Xt[qt].ny=te.lines,Xt[qt].size=te.type,St+=Xt[qt].nx*Xt[qt].ny*Xt[qt].size;var an=Mt(be,Ue),sn=Mt(be,Ue);if(sn>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(an<=sn)for(var qt=0;qt<sn-an+1;qt++)Tt[qt+an]=xe(be,Ue);var ln=new Uint16Array(65536),rn=k(Tt,ln),fe=dt(be,Ue);nt(te.array,be,Ue,fe,lt,St);for(var qt=0;qt<te.channels;++qt)for(var Oe=Xt[qt],$e=0;$e<Xt[qt].size;++$e)Fe(lt,Oe.start+$e,Oe.nx,Oe.size,Oe.ny,Oe.nx*Oe.size,rn);It(ln,lt,St);for(var et=0,Ze=new Uint8Array(lt.buffer.byteLength),Vt=0;Vt<te.lines;Vt++)for(var en=0;en<te.channels;en++){var Oe=Xt[en],Gt=Oe.nx*Oe.size,vn=new Uint8Array(lt.buffer,Oe.end*2,Gt*2);Ze.set(vn,et),et+=Gt*2,Oe.end+=Gt}return new DataView(Ze.buffer)}function je(te){var be=te.array.slice(te.offset.value,te.offset.value+te.size),Ue=ox(be);const lt=te.lines*te.channels*te.width,Tt=te.type==1?new Uint16Array(lt):new Uint32Array(lt);let St=0,Xt=0;const qt=new Array(4);for(let an=0;an<te.lines;an++)for(let sn=0;sn<te.channels;sn++){let ln=0;switch(te.type){case 1:qt[0]=St,qt[1]=qt[0]+te.width,St=qt[1]+te.width;for(let rn=0;rn<te.width;++rn){const fe=Ue[qt[0]++]<<8|Ue[qt[1]++];ln+=fe,Tt[Xt]=ln,Xt++}break;case 2:qt[0]=St,qt[1]=qt[0]+te.width,qt[2]=qt[1]+te.width,St=qt[2]+te.width;for(let rn=0;rn<te.width;++rn){const fe=Ue[qt[0]++]<<24|Ue[qt[1]++]<<16|Ue[qt[2]++]<<8;ln+=fe,Tt[Xt]=ln,Xt++}break}}return new DataView(Tt.buffer)}function Ye(te){var be=te.viewer,Ue={value:te.offset.value},lt=new Uint8Array(te.width*te.lines*(te.channels*te.type*2)),Tt={version:Pe(be,Ue),unknownUncompressedSize:Pe(be,Ue),unknownCompressedSize:Pe(be,Ue),acCompressedSize:Pe(be,Ue),dcCompressedSize:Pe(be,Ue),rleCompressedSize:Pe(be,Ue),rleUncompressedSize:Pe(be,Ue),rleRawSize:Pe(be,Ue),totalAcUncompressedCount:Pe(be,Ue),totalDcUncompressedCount:Pe(be,Ue),acCompression:Pe(be,Ue)};if(Tt.version<2)throw"EXRLoader.parse: "+wi.compression+" version "+Tt.version+" is unsupported";for(var St=new Array,Xt=Mt(be,Ue)-2;Xt>0;){var qt=ft(be.buffer,Ue),an=xe(be,Ue),sn=an>>2&3,ln=(an>>4)-1,rn=new Int8Array([ln])[0],fe=xe(be,Ue);St.push({name:qt,index:rn,type:fe,compression:sn}),Xt-=qt.length+3}for(var Oe=wi.channels,$e=new Array(te.channels),et=0;et<te.channels;++et){var Ze=$e[et]={},Vt=Oe[et];Ze.name=Vt.name,Ze.compression=0,Ze.decoded=!1,Ze.type=Vt.pixelType,Ze.pLinear=Vt.pLinear,Ze.width=te.width,Ze.height=te.lines}for(var en={idx:new Array(3)},Gt=0;Gt<te.channels;++Gt)for(var Ze=$e[Gt],et=0;et<St.length;++et){var vn=St[et];Ze.name==vn.name&&(Ze.compression=vn.compression,vn.index>=0&&(en.idx[vn.index]=Gt),Ze.offset=Gt)}if(Tt.acCompressedSize>0)switch(Tt.acCompression){case 0:var cn=new Uint16Array(Tt.totalAcUncompressedCount);nt(te.array,be,Ue,Tt.acCompressedSize,cn,Tt.totalAcUncompressedCount);break;case 1:var nn=te.array.slice(Ue.value,Ue.value+Tt.totalAcUncompressedCount),Tn=ox(nn),cn=new Uint16Array(Tn.buffer);Ue.value+=Tt.totalAcUncompressedCount;break}if(Tt.dcCompressedSize>0){var hn={array:te.array,offset:Ue,size:Tt.dcCompressedSize},si=new Uint16Array(Be(hn).buffer);Ue.value+=Tt.dcCompressedSize}if(Tt.rleRawSize>0){var nn=te.array.slice(Ue.value,Ue.value+Tt.rleCompressedSize),Tn=ox(nn),pi=le(Tn.buffer);Ue.value+=Tt.rleCompressedSize}for(var ai=0,Sn=new Array($e.length),et=0;et<Sn.length;++et)Sn[et]=new Array;for(var Jt=0;Jt<te.lines;++Jt)for(var _n=0;_n<$e.length;++_n)Sn[_n].push(ai),ai+=$e[_n].width*te.type*2;Qe(en,Sn,$e,cn,si,lt);for(var et=0;et<$e.length;++et){var Ze=$e[et];if(!Ze.decoded)switch(Ze.compression){case 2:for(var mn=0,Ui=0,Jt=0;Jt<te.lines;++Jt){for(var ss=Sn[et][mn],mi=0;mi<Ze.width;++mi){for(var Yi=0;Yi<2*Ze.type;++Yi)lt[ss++]=pi[Ui+Yi*Ze.width*Ze.height];Ui++}mn++}break;default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(lt.buffer)}function ft(te,be){for(var Ue=new Uint8Array(te),lt=0;Ue[be.value+lt]!=0;)lt+=1;var Tt=new TextDecoder().decode(Ue.slice(be.value,be.value+lt));return be.value=be.value+lt+1,Tt}function gt(te,be,Ue){var lt=new TextDecoder().decode(new Uint8Array(te).slice(be.value,be.value+Ue));return be.value=be.value+Ue,lt}function Lt(te,be){var Ue=bt(te,be),lt=dt(te,be);return[Ue,lt]}function un(te,be){var Ue=dt(te,be),lt=dt(te,be);return[Ue,lt]}function bt(te,be){var Ue=te.getInt32(be.value,!0);return be.value=be.value+4,Ue}function dt(te,be){var Ue=te.getUint32(be.value,!0);return be.value=be.value+4,Ue}function Ge(te,be){var Ue=te[be.value];return be.value=be.value+1,Ue}function xe(te,be){var Ue=te.getUint8(be.value);return be.value=be.value+1,Ue}const Pe=function(te,be){let Ue;return"getBigInt64"in DataView.prototype?Ue=Number(te.getBigInt64(be.value,!0)):Ue=te.getUint32(be.value+4,!0)+Number(te.getUint32(be.value,!0)<<32),be.value+=8,Ue};function rt(te,be){var Ue=te.getFloat32(be.value,!0);return be.value+=4,Ue}function Me(te,be){return yp.toHalfFloat(rt(te,be))}function ze(te){var be=(te&31744)>>10,Ue=te&1023;return(te>>15?-1:1)*(be?be===31?Ue?NaN:1/0:Math.pow(2,be-15)*(1+Ue/1024):6103515625e-14*(Ue/1024))}function Mt(te,be){var Ue=te.getUint16(be.value,!0);return be.value+=2,Ue}function Rt(te,be){return ze(Mt(te,be))}function se(te,be,Ue,lt){for(var Tt=Ue.value,St=[];Ue.value<Tt+lt-1;){var Xt=ft(be,Ue),qt=bt(te,Ue),an=xe(te,Ue);Ue.value+=3;var sn=bt(te,Ue),ln=bt(te,Ue);St.push({name:Xt,pixelType:qt,pLinear:an,xSampling:sn,ySampling:ln})}return Ue.value+=1,St}function Ve(te,be){var Ue=rt(te,be),lt=rt(te,be),Tt=rt(te,be),St=rt(te,be),Xt=rt(te,be),qt=rt(te,be),an=rt(te,be),sn=rt(te,be);return{redX:Ue,redY:lt,greenX:Tt,greenY:St,blueX:Xt,blueY:qt,whiteX:an,whiteY:sn}}function vt(te,be){var Ue=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],lt=xe(te,be);return Ue[lt]}function Dt(te,be){var Ue=dt(te,be),lt=dt(te,be),Tt=dt(te,be),St=dt(te,be);return{xMin:Ue,yMin:lt,xMax:Tt,yMax:St}}function bn(te,be){var Ue=["INCREASING_Y"],lt=xe(te,be);return Ue[lt]}function dn(te,be){var Ue=rt(te,be),lt=rt(te,be);return[Ue,lt]}function tn(te,be){var Ue=rt(te,be),lt=rt(te,be),Tt=rt(te,be);return[Ue,lt,Tt]}function gn(te,be,Ue,lt,Tt){if(lt==="string"||lt==="stringvector"||lt==="iccProfile")return gt(be,Ue,Tt);if(lt==="chlist")return se(te,be,Ue,Tt);if(lt==="chromaticities")return Ve(te,Ue);if(lt==="compression")return vt(te,Ue);if(lt==="box2i")return Dt(te,Ue);if(lt==="lineOrder")return bn(te,Ue);if(lt==="float")return rt(te,Ue);if(lt==="v2f")return dn(te,Ue);if(lt==="v3f")return tn(te,Ue);if(lt==="int")return bt(te,Ue);if(lt==="rational")return Lt(te,Ue);if(lt==="timecode")return un(te,Ue);if(lt==="preview")return Ue.value+=Tt,"skipped";Ue.value+=Tt}function Pn(te,be,Ue){const lt={};if(te.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";lt.version=te.getUint8(4);const Tt=te.getUint8(5);lt.spec={singleTile:!!(Tt&2),longName:!!(Tt&4),deepFormat:!!(Tt&8),multiPart:!!(Tt&16)},Ue.value=8;for(var St=!0;St;){var Xt=ft(be,Ue);if(Xt==0)St=!1;else{var qt=ft(be,Ue),an=dt(te,Ue),sn=gn(te,be,Ue,qt,an);sn===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${qt}'.`):lt[Xt]=sn}}if((Tt&-5)!=0)throw console.error("EXRHeader:",lt),"THREE.EXRLoader: provided file is currently unsupported.";return lt}function Bi(te,be,Ue,lt,Tt){const St={size:0,viewer:be,array:Ue,offset:lt,width:te.dataWindow.xMax-te.dataWindow.xMin+1,height:te.dataWindow.yMax-te.dataWindow.yMin+1,channels:te.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:te.channels[0].pixelType,uncompress:null,getter:null,format:null,[yg?"colorSpace":"encoding"]:null};switch(te.compression){case"NO_COMPRESSION":St.lines=1,St.uncompress=he;break;case"RLE_COMPRESSION":St.lines=1,St.uncompress=Q;break;case"ZIPS_COMPRESSION":St.lines=1,St.uncompress=Be;break;case"ZIP_COMPRESSION":St.lines=16,St.uncompress=Be;break;case"PIZ_COMPRESSION":St.lines=32,St.uncompress=ue;break;case"PXR24_COMPRESSION":St.lines=16,St.uncompress=je;break;case"DWAA_COMPRESSION":St.lines=32,St.uncompress=Ye;break;case"DWAB_COMPRESSION":St.lines=256,St.uncompress=Ye;break;default:throw"EXRLoader.parse: "+te.compression+" is unsupported"}if(St.scanlineBlockSize=St.lines,St.type==1)switch(Tt){case Cs:St.getter=Rt,St.inputSize=2;break;case Ks:St.getter=Mt,St.inputSize=2;break}else if(St.type==2)switch(Tt){case Cs:St.getter=rt,St.inputSize=4;break;case Ks:St.getter=Me,St.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+St.type+" for "+te.compression+".";St.blockCount=(te.dataWindow.yMax+1)/St.scanlineBlockSize;for(var Xt=0;Xt<St.blockCount;Xt++)Pe(be,lt);St.outputChannels=St.channels==3?4:St.channels;const qt=St.width*St.height*St.outputChannels;switch(Tt){case Cs:St.byteArray=new Float32Array(qt),St.channels<St.outputChannels&&St.byteArray.fill(1,0,qt);break;case Ks:St.byteArray=new Uint16Array(qt),St.channels<St.outputChannels&&St.byteArray.fill(15360,0,qt);break;default:console.error("THREE.EXRLoader: unsupported type: ",Tt);break}return St.bytesPerLine=St.width*St.inputSize*St.channels,St.outputChannels==4?St.format=xa:St.format=f1,yg?St.colorSpace="srgb-linear":St.encoding=3e3,St}const xi=new DataView(e),$n=new Uint8Array(e),ii={value:0},wi=Pn(xi,e,ii),Rn=Bi(wi,xi,$n,ii,this.type),ir={value:0},Mi={R:0,G:1,B:2,A:3,Y:0};for(let te=0;te<Rn.height/Rn.scanlineBlockSize;te++){const be=dt(xi,ii);Rn.size=dt(xi,ii),Rn.lines=be+Rn.scanlineBlockSize>Rn.height?Rn.height-be:Rn.scanlineBlockSize;const lt=Rn.size<Rn.lines*Rn.bytesPerLine?Rn.uncompress(Rn):he(Rn);ii.value+=Rn.size;for(let Tt=0;Tt<Rn.scanlineBlockSize;Tt++){const St=Tt+te*Rn.scanlineBlockSize;if(St>=Rn.height)break;for(let Xt=0;Xt<Rn.channels;Xt++){const qt=Mi[wi.channels[Xt].name];for(let an=0;an<Rn.width;an++){ir.value=(Tt*(Rn.channels*Rn.width)+Xt*Rn.width+an)*Rn.inputSize;const sn=(Rn.height-1-St)*(Rn.width*Rn.outputChannels)+an*Rn.outputChannels+qt;Rn.byteArray[sn]=Rn.getter(lt,ir)}}}}return{header:wi,width:Rn.width,height:Rn.height,data:Rn.byteArray,format:Rn.format,[yg?"colorSpace":"encoding"]:Rn[yg?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,n,r){function s(l,c){yg?l.colorSpace=c.colorSpace:l.encoding=c.encoding,l.minFilter=ar,l.magFilter=ar,l.generateMipmaps=!1,l.flipY=!1,t&&t(l,c)}return super.load(e,s,n,r)}}const IB=ge.forwardRef(({makeDefault:i,camera:e,regress:t,domElement:n,enableDamping:r=!0,keyEvents:s=!1,onChange:l,onStart:c,onEnd:f,...d},m)=>{const g=da(j=>j.invalidate),y=da(j=>j.camera),v=da(j=>j.gl),S=da(j=>j.events),T=da(j=>j.setEvents),A=da(j=>j.set),w=da(j=>j.get),R=da(j=>j.performance),D=e||y,I=n||S.connected||v.domElement,z=ge.useMemo(()=>new RB(D),[D]);return Lr(()=>{z.enabled&&z.update()},-1),ge.useEffect(()=>(s&&z.connect(s===!0?I:s),z.connect(I),()=>{z.dispose()}),[s,I,t,z,g]),ge.useEffect(()=>{const j=L=>{g(),t&&R.regress(),l&&l(L)},X=L=>{c&&c(L)},G=L=>{f&&f(L)};return z.addEventListener("change",j),z.addEventListener("start",X),z.addEventListener("end",G),()=>{z.removeEventListener("start",X),z.removeEventListener("end",G),z.removeEventListener("change",j)}},[l,c,f,z,g,T]),ge.useEffect(()=>{if(i){const j=w().controls;return A({controls:z}),()=>A({controls:j})}},[i,z]),ge.createElement("primitive",n1({ref:m,object:z,enableDamping:r},d))}),DB="modulepreload",kB=function(i){return"/chemlabdemo/"+i},fM={},Qm=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){let f=function(d){return Promise.all(d.map(m=>Promise.resolve(m).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");r=f(t.map(d=>{if(d=kB(d),d in fM)return;fM[d]=!0;const m=d.endsWith(".css"),g=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${g}`))return;const y=document.createElement("link");if(y.rel=m?"stylesheet":DB,m||(y.as="script"),y.crossOrigin="",y.href=d,c&&y.setAttribute("nonce",c),document.head.appendChild(y),m)return new Promise((v,S)=>{y.addEventListener("load",v),y.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${d}`)))})}))}function s(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return r.then(l=>{for(const c of l||[])c.status==="rejected"&&s(c.reason);return e().catch(s)})},h4=(i,e,t)=>{let n;switch(i){case $a:n=new Uint8ClampedArray(e*t*4);break;case Ks:n=new Uint16Array(e*t*4);break;case Ec:n=new Uint32Array(e*t*4);break;case Dy:n=new Int8Array(e*t*4);break;case ky:n=new Int16Array(e*t*4);break;case u1:n=new Int32Array(e*t*4);break;case Cs:n=new Float32Array(e*t*4);break;default:throw new Error("Unsupported data type")}return n};let cx;const OB=(i,e,t,n)=>{if(cx!==void 0)return cx;const r=new ul(1,1,n);e.setRenderTarget(r);const s=new js(new _d,new kf({color:16777215}));e.render(s,t),e.setRenderTarget(null);const l=h4(i,r.width,r.height);return e.readRenderTargetPixels(r,0,0,r.width,r.height,l),r.dispose(),s.geometry.dispose(),s.material.dispose(),cx=l[0]!==0,cx};class o2{_renderer;_rendererIsDisposable=!1;_material;_scene;_camera;_quad;_renderTarget;_width;_height;_type;_colorSpace;_supportsReadPixels=!0;constructor(e){this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const t={format:xa,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:e.renderTargetOptions?.anisotropy!==void 0?e.renderTargetOptions?.anisotropy:1,generateMipmaps:e.renderTargetOptions?.generateMipmaps!==void 0?e.renderTargetOptions?.generateMipmaps:!1,magFilter:e.renderTargetOptions?.magFilter!==void 0?e.renderTargetOptions?.magFilter:ar,minFilter:e.renderTargetOptions?.minFilter!==void 0?e.renderTargetOptions?.minFilter:ar,samples:e.renderTargetOptions?.samples!==void 0?e.renderTargetOptions?.samples:void 0,wrapS:e.renderTargetOptions?.wrapS!==void 0?e.renderTargetOptions?.wrapS:Js,wrapT:e.renderTargetOptions?.wrapT!==void 0?e.renderTargetOptions?.wrapT:Js};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=o2.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new p1,this._camera=new au,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!OB(this._type,this._renderer,this._camera,t)){let n;this._type===Ks&&(n=this._renderer.extensions.has("EXT_color_buffer_float")?Cs:void 0),n!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${Cs}`),this._type=n):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new js(new _d,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new ul(this.width,this.height,t),this._renderTarget.texture.mapping=e.renderTargetOptions?.mapping!==void 0?e.renderTargetOptions?.mapping:pd}static instantiateRenderer(){const e=new QS;return e.setSize(128,128),e}render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(e){throw this._renderer.setRenderTarget(null),e}this._renderer.setRenderTarget(null)};toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=h4(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new su(this.toArray(),this.width,this.height,xa,this._type,e?.mapping||pd,e?.wrapS||Js,e?.wrapT||Js,e?.magFilter||ar,e?.minFilter||ar,e?.anisotropy||1,Uu);return t.generateMipmaps=e?.generateMipmaps!==void 0?e?.generateMipmaps:!1,t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof fl&&Object.values(this.material.uniforms).forEach(t=>{t.value instanceof Fr&&t.value.dispose()}),Object.values(this.material).forEach(t=>{t instanceof Fr&&t.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}class d4 extends Error{}class p4 extends Error{}const bg=(i,e,t)=>{const n=new RegExp(`${e}="([^"]*)"`,"i").exec(i);if(n)return n[1];const r=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(i);if(r){const s=r[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return s&&s.length===3?s.map(l=>l.replace(/<\/?rdf:li>/g,"")):r[1].trim()}if(t!==void 0)return t;throw new Error(`Can't find ${e} in gainmap metadata`)},BB=i=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(i):e=i.toString();let t=e.indexOf("<x:xmpmeta");for(;t!==-1;){const n=e.indexOf("x:xmpmeta>",t),r=e.slice(t,n+10);try{const s=bg(r,"hdrgm:GainMapMin","0"),l=bg(r,"hdrgm:GainMapMax"),c=bg(r,"hdrgm:Gamma","1"),f=bg(r,"hdrgm:OffsetSDR","0.015625"),d=bg(r,"hdrgm:OffsetHDR","0.015625"),m=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(r),g=m?m[1]:"0",y=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(r);if(!y)throw new Error("Incomplete gainmap metadata");const v=y[1];return{gainMapMin:Array.isArray(s)?s.map(S=>parseFloat(S)):[parseFloat(s),parseFloat(s),parseFloat(s)],gainMapMax:Array.isArray(l)?l.map(S=>parseFloat(S)):[parseFloat(l),parseFloat(l),parseFloat(l)],gamma:Array.isArray(c)?c.map(S=>parseFloat(S)):[parseFloat(c),parseFloat(c),parseFloat(c)],offsetSdr:Array.isArray(f)?f.map(S=>parseFloat(S)):[parseFloat(f),parseFloat(f),parseFloat(f)],offsetHdr:Array.isArray(d)?d.map(S=>parseFloat(S)):[parseFloat(d),parseFloat(d),parseFloat(d)],hdrCapacityMin:parseFloat(g),hdrCapacityMax:parseFloat(v)}}catch{}t=e.indexOf("<x:xmpmeta",n)}};class UB{options;constructor(e){this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((t,n)=>{const r=this.options.debug,s=new DataView(e.buffer);if(s.getUint16(0)!==65496){n(new Error("Not a valid jpeg"));return}const l=s.byteLength;let c=2,f=0,d;for(;c<l;){if(++f>250){n(new Error(`Found no marker after ${f} loops `));return}if(s.getUint8(c)!==255){n(new Error(`Not a valid marker at offset 0x${c.toString(16)}, found: 0x${s.getUint8(c).toString(16)}`));return}if(d=s.getUint8(c+1),r&&console.log(`Marker: ${d.toString(16)}`),d===226){r&&console.log("Found APP2 marker (0xffe2)");const m=c+4;if(s.getUint32(m)===1297106432){const g=m+4;let y;if(s.getUint16(g)===18761)y=!1;else if(s.getUint16(g)===19789)y=!0;else{n(new Error("No valid endianness marker found in TIFF header"));return}if(s.getUint16(g+2,!y)!==42){n(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const v=s.getUint32(g+4,!y);if(v<8){n(new Error("Not valid TIFF data! (First offset less than 8)"));return}const S=g+v,T=s.getUint16(S,!y),A=S+2;let w=0;for(let z=A;z<A+12*T;z+=12)s.getUint16(z,!y)===45057&&(w=s.getUint32(z+8,!y));const D=S+2+T*12+4,I=[];for(let z=D;z<D+w*16;z+=16){const j={MPType:s.getUint32(z,!y),size:s.getUint32(z+4,!y),dataOffset:s.getUint32(z+8,!y),dependantImages:s.getUint32(z+12,!y),start:-1,end:-1,isFII:!1};j.dataOffset?(j.start=g+j.dataOffset,j.isFII=!1):(j.start=0,j.isFII=!0),j.end=j.start+j.size,I.push(j)}if(this.options.extractNonFII&&I.length){const z=new Blob([s]),j=[];for(const X of I){if(X.isFII&&!this.options.extractFII)continue;const G=z.slice(X.start,X.end+1,"image/jpeg");j.push(G)}t(j)}}}c+=2+s.getUint16(c+2)}})}}const FB=async i=>{const e=BB(i);if(!e)throw new p4("Gain map XMP metadata not found");const n=await new UB({extractFII:!0,extractNonFII:!0}).extract(i);if(n.length!==2)throw new d4("Gain map recovery image not found");return{sdr:new Uint8Array(await n[0].arrayBuffer()),gainMap:new Uint8Array(await n[1].arrayBuffer()),metadata:e}},hM=i=>new Promise((e,t)=>{const n=document.createElement("img");n.onload=()=>{e(n)},n.onerror=r=>{t(r)},n.src=URL.createObjectURL(i)});class zB extends dl{_renderer;_renderTargetOptions;_internalLoadingManager;_config;constructor(e,t){super(t),this._config=e,e.renderer&&(this._renderer=e.renderer),this._internalLoadingManager=new fb}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: A Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const e=this._config.createMaterial({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new Fr,sdr:new Fr});return this._config.createQuadRenderer({width:16,height:16,type:Ks,colorSpace:Uu,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async processImages(e,t,n){const r=t?new Blob([t],{type:"image/jpeg"}):void 0,s=new Blob([e],{type:"image/jpeg"});let l,c,f=!1;if(typeof createImageBitmap>"u"){const d=await Promise.all([r?hM(r):Promise.resolve(void 0),hM(s)]);c=d[0],l=d[1],f=n==="flipY"}else{const d=await Promise.all([r?createImageBitmap(r,{imageOrientation:n||"flipY"}):Promise.resolve(void 0),createImageBitmap(s,{imageOrientation:n||"flipY"})]);c=d[0],l=d[1]}return{sdrImage:l,gainMapImage:c,needsFlip:f}}createTextures(e,t,n){const r=new Fr(t||new ImageData(2,2),pd,Js,Js,ar,N_,xa,$a,1,Uu);r.flipY=n,r.needsUpdate=!0;const s=new Fr(e,pd,Js,Js,ar,N_,xa,$a,1,vo);return s.flipY=n,s.needsUpdate=!0,{gainMap:r,sdr:s}}updateQuadRenderer(e,t,n,r,s){e.width=t.width,e.height=t.height,e.material.gainMap=n,e.material.sdr=r,e.material.gainMapMin=s.gainMapMin,e.material.gainMapMax=s.gainMapMax,e.material.offsetHdr=s.offsetHdr,e.material.offsetSdr=s.offsetSdr,e.material.gamma=s.gamma,e.material.hdrCapacityMin=s.hdrCapacityMin,e.material.hdrCapacityMax=s.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,s.hdrCapacityMax),e.material.needsUpdate=!0}}const jB=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,VB=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class HB extends fl{_maxDisplayBoost;_hdrCapacityMin;_hdrCapacityMax;constructor({gamma:e,offsetHdr:t,offsetSdr:n,gainMapMin:r,gainMapMax:s,maxDisplayBoost:l,hdrCapacityMin:c,hdrCapacityMax:f,sdr:d,gainMap:m}){super({name:"GainMapDecoderMaterial",vertexShader:jB,fragmentShader:VB,uniforms:{sdr:{value:d},gainMap:{value:m},gamma:{value:new Ee(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:new Ee().fromArray(t)},offsetSdr:{value:new Ee().fromArray(n)},gainMapMin:{value:new Ee().fromArray(r)},gainMapMax:{value:new Ee().fromArray(s)},weightFactor:{value:(Math.log2(l)-c)/(f-c)}},blending:Ou,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=l,this._hdrCapacityMin=c,this._hdrCapacityMax=f,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){const e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){const t=this.uniforms.gamma.value;t.x=1/e[0],t.y=1/e[1],t.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){const e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class m4 extends zB{constructor(e,t){super({renderer:e,createMaterial:n=>new HB(n),createQuadRenderer:n=>new o2(n)},t)}async render(e,t,n,r){const{sdrImage:s,gainMapImage:l,needsFlip:c}=await this.processImages(n,r,"flipY"),{gainMap:f,sdr:d}=this.createTextures(s,l,c);this.updateQuadRenderer(e,s,f,d,t),e.render()}}class GB extends m4{load([e,t,n],r,s,l){const c=this.prepareQuadRenderer();let f,d,m;const g=async()=>{if(f&&d&&m){try{await this.render(c,m,f,d)}catch(L){this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(n),typeof l=="function"&&l(L),c.disposeOnDemandRenderer();return}typeof r=="function"&&r(c),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(n),c.disposeOnDemandRenderer()}};let y=!0,v=0,S=0,T=!0,A=0,w=0,R=!0,D=0,I=0;const z=()=>{if(typeof s=="function"){const L=v+A+D,k=S+w+I,U=y&&T&&R;s(new ProgressEvent("progress",{lengthComputable:U,loaded:k,total:L}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(n);const j=new Tc(this._internalLoadingManager);j.setResponseType("arraybuffer"),j.setRequestHeader(this.requestHeader),j.setPath(this.path),j.setWithCredentials(this.withCredentials),j.load(e,async L=>{if(typeof L=="string")throw new Error("Invalid sdr buffer");f=L,await g()},L=>{y=L.lengthComputable,S=L.loaded,v=L.total,z()},L=>{this.manager.itemError(e),typeof l=="function"&&l(L)});const X=new Tc(this._internalLoadingManager);X.setResponseType("arraybuffer"),X.setRequestHeader(this.requestHeader),X.setPath(this.path),X.setWithCredentials(this.withCredentials),X.load(t,async L=>{if(typeof L=="string")throw new Error("Invalid gainmap buffer");d=L,await g()},L=>{T=L.lengthComputable,w=L.loaded,A=L.total,z()},L=>{this.manager.itemError(t),typeof l=="function"&&l(L)});const G=new Tc(this._internalLoadingManager);return G.setRequestHeader(this.requestHeader),G.setPath(this.path),G.setWithCredentials(this.withCredentials),G.load(n,async L=>{if(typeof L!="string")throw new Error("Invalid metadata string");m=JSON.parse(L),await g()},L=>{R=L.lengthComputable,I=L.loaded,D=L.total,z()},L=>{this.manager.itemError(n),typeof l=="function"&&l(L)}),c}}class qB extends m4{load(e,t,n,r){const s=this.prepareQuadRenderer(),l=new Tc(this._internalLoadingManager);return l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setPath(this.path),l.setWithCredentials(this.withCredentials),this.manager.itemStart(e),l.load(e,async c=>{if(typeof c=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const f=new Uint8Array(c);let d,m,g;try{const y=await FB(f);d=y.sdr,m=y.gainMap,g=y.metadata}catch(y){if(y instanceof p4||y instanceof d4)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),g={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},d=f;else throw y}try{await this.render(s,g,d.buffer,m?.buffer)}catch(y){this.manager.itemError(e),typeof r=="function"&&r(y),s.disposeOnDemandRenderer();return}typeof t=="function"&&t(s),this.manager.itemEnd(e),s.disposeOnDemandRenderer()},n,c=>{this.manager.itemError(e),typeof r=="function"&&r(c)}),s}}const i1={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},g4="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",e0=i=>Array.isArray(i),l2=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function gb({files:i=l2,path:e="",preset:t=void 0,colorSpace:n=void 0,extensions:r}={}){t&&(c2(t),i=i1[t],e=g4);const s=e0(i),{extension:l,isCubemap:c}=u2(i),f=f2(l);if(!f)throw new Error("useEnvironment: Unrecognized file extension: "+i);const d=da(v=>v.gl);ge.useLayoutEffect(()=>{if(l!=="webp"&&l!=="jpg"&&l!=="jpeg")return;function v(){v0.clear(f,s?[i]:i)}d.domElement.addEventListener("webglcontextlost",v,{once:!0})},[i,d.domElement]);const m=v0(f,s?[i]:i,v=>{(l==="webp"||l==="jpg"||l==="jpeg")&&v.setRenderer(d),v.setPath==null||v.setPath(e),r&&r(v)});let g=s?m[0]:m;if(l==="jpg"||l==="jpeg"||l==="webp"){var y;g=(y=g.renderTarget)==null?void 0:y.texture}return g.mapping=c?Bu:s0,g.colorSpace=n??(c?"srgb":"srgb-linear"),g}const WB={files:l2,path:"",preset:void 0,extensions:void 0};gb.preload=i=>{const e={...WB,...i};let{files:t,path:n=""}=e;const{preset:r,extensions:s}=e;r&&(c2(r),t=i1[r],n=g4);const{extension:l}=u2(t);if(l==="webp"||l==="jpg"||l==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const c=f2(l);if(!c)throw new Error("useEnvironment: Unrecognized file extension: "+t);v0.preload(c,e0(t)?[t]:t,f=>{f.setPath==null||f.setPath(n),s&&s(f)})};const XB={files:l2,preset:void 0};gb.clear=i=>{const e={...XB,...i};let{files:t}=e;const{preset:n}=e;n&&(c2(n),t=i1[n]);const{extension:r}=u2(t),s=f2(r);if(!s)throw new Error("useEnvironment: Unrecognized file extension: "+t);v0.clear(s,e0(t)?[t]:t)};function c2(i){if(!(i in i1))throw new Error("Preset must be one of: "+Object.keys(i1).join(", "))}function u2(i){var e;const t=e0(i)&&i.length===6,n=e0(i)&&i.length===3&&i.some(l=>l.endsWith("json")),r=e0(i)?i[0]:i;return{extension:t?"cube":n?"webp":r.startsWith("data:application/exr")?"exr":r.startsWith("data:application/hdr")?"hdr":r.startsWith("data:image/jpeg")?"jpg":(e=r.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:t,isGainmap:n}}function f2(i){return i==="cube"?mE:i==="hdr"?LB:i==="exr"?PB:i==="jpg"||i==="jpeg"?qB:i==="webp"?GB:null}const YB=i=>i.current&&i.current.isScene,ZB=i=>YB(i)?i.current:i;function h2(i,e,t,n,r={}){var s,l,c,f;r={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...r};const d=ZB(e||t),m=d.background,g=d.environment,y={backgroundBlurriness:d.backgroundBlurriness,backgroundIntensity:d.backgroundIntensity,backgroundRotation:(s=(l=d.backgroundRotation)==null||l.clone==null?void 0:l.clone())!==null&&s!==void 0?s:[0,0,0],environmentIntensity:d.environmentIntensity,environmentRotation:(c=(f=d.environmentRotation)==null||f.clone==null?void 0:f.clone())!==null&&c!==void 0?c:[0,0,0]};return i!=="only"&&(d.environment=n),i&&(d.background=n),Nf(d,r),()=>{i!=="only"&&(d.environment=g),i&&(d.background=m),Nf(d,y)}}function d2({scene:i,background:e=!1,map:t,...n}){const r=da(s=>s.scene);return ge.useLayoutEffect(()=>{if(t)return h2(e,i,r,t,n)}),null}function v4({background:i=!1,scene:e,blur:t,backgroundBlurriness:n,backgroundIntensity:r,backgroundRotation:s,environmentIntensity:l,environmentRotation:c,...f}){const d=gb(f),m=da(g=>g.scene);return ge.useLayoutEffect(()=>h2(i,e,m,d,{backgroundBlurriness:t??n,backgroundIntensity:r,backgroundRotation:s,environmentIntensity:l,environmentRotation:c})),ge.useEffect(()=>()=>{d.dispose()},[d]),null}function $B({children:i,near:e=.1,far:t=1e3,resolution:n=256,frames:r=1,map:s,background:l=!1,blur:c,backgroundBlurriness:f,backgroundIntensity:d,backgroundRotation:m,environmentIntensity:g,environmentRotation:y,scene:v,files:S,path:T,preset:A=void 0,extensions:w}){const R=da(G=>G.gl),D=da(G=>G.scene),I=ge.useRef(null),[z]=ge.useState(()=>new p1),j=ge.useMemo(()=>{const G=new Wy(n);return G.texture.type=Ks,G},[n]);ge.useEffect(()=>()=>{j.dispose()},[j]),ge.useLayoutEffect(()=>{if(r===1){const G=R.autoClear;R.autoClear=!0,I.current.update(R,z),R.autoClear=G}return h2(l,v,D,j.texture,{backgroundBlurriness:c??f,backgroundIntensity:d,backgroundRotation:m,environmentIntensity:g,environmentRotation:y})},[i,z,j.texture,v,D,l,r,R]);let X=1;return Lr(()=>{if(r===1/0||X<r){const G=R.autoClear;R.autoClear=!0,I.current.update(R,z),R.autoClear=G,X++}}),ge.createElement(ge.Fragment,null,BO(ge.createElement(ge.Fragment,null,i,ge.createElement("cubeCamera",{ref:I,args:[e,t,j]}),S||A?ge.createElement(v4,{background:!0,files:S,preset:A,path:T,extensions:w}):s?ge.createElement(d2,{background:!0,map:s,extensions:w}):null),z))}function JB(i){var e,t,n,r;const s=gb(i),l=i.map||s;ge.useMemo(()=>JE({GroundProjectedEnvImpl:SB}),[]),ge.useEffect(()=>()=>{s.dispose()},[s]);const c=ge.useMemo(()=>[l],[l]),f=(e=i.ground)==null?void 0:e.height,d=(t=i.ground)==null?void 0:t.radius,m=(n=(r=i.ground)==null?void 0:r.scale)!==null&&n!==void 0?n:1e3;return ge.createElement(ge.Fragment,null,ge.createElement(d2,n1({},i,{map:l})),ge.createElement("groundProjectedEnvImpl",{args:c,scale:m,height:f,radius:d}))}function KB(i){return i.ground?ge.createElement(JB,i):i.map?ge.createElement(d2,i):i.children?ge.createElement($B,i):ge.createElement(v4,i)}const QB=[{id:"salt-dissolution",title:"Dissolving Salt vs Sand in Water",chapter:"Separation of Substances",classLevel:6,aim:"To study the solubility of salt and sand in water.",apparatus:["beaker","glass-rod"],chemicals:[{id:"water",name:"Water",color:"#a8d4ff"},{id:"salt",name:"Common Salt",color:"#d0e8ff"},{id:"sand",name:"Sand",color:"#c4a465"}],procedureSteps:["Place the beaker on the lab bench","Add water to the beaker","Add salt to the water","Place the glass rod","Stir the mixture with glass rod","Observe - then Reset and repeat with sand"],reactions:{"water+salt+stir":{observation:"The salt crystals gradually disappear as you stir. The solution becomes slightly milky.",explanation:"Salt (sodium chloride) is soluble in water. Water molecules surround the salt ions (Na and Cl) and pull them apart, distributing them evenly throughout the solution. This is called dissolution.",visual:{liquidColor:"#e8f4ff",particles:!1},success:!0},"water+sand+stir":{observation:"The sand particles swirl around but settle at the bottom when stirring stops. The water becomes slightly cloudy.",explanation:"Sand (silicon dioxide) is insoluble in water. The water molecules cannot break apart the strong bonds in sand particles. Sand is denser than water, so it sinks and settles at the bottom.",visual:{liquidColor:"#d4c4a8",particles:!0,settled:!0},success:!0},"water+salt":{observation:"Salt crystals are sitting in the water. Nothing much is happening yet.",explanation:"Try stirring the mixture to help the salt dissolve faster. Stirring increases the contact between water molecules and salt crystals.",visual:{liquidColor:"#a8d4ff",particles:!0},success:!1},"water+sand":{observation:"Sand has sunk to the bottom of the beaker. The water above is clear.",explanation:"Sand is denser than water and insoluble, so it naturally settles at the bottom.",visual:{liquidColor:"#a8d4ff",particles:!0,settled:!0},success:!1}},conclusion:"Salt is soluble in water and forms a clear solution. Sand is insoluble in water and settles at the bottom. This difference in solubility can be used to separate mixtures of salt and sand."},{id:"filtration",title:"Separation by Filtration",chapter:"Separation of Substances",classLevel:6,aim:"To separate insoluble impurities from water using filtration.",apparatus:["beaker","funnel","filter-paper"],chemicals:[{id:"muddy-water",name:"Muddy Water",color:"#4a3728"}],procedureSteps:["Place a beaker on the lab bench","Place the funnel on the lab bench","Place the filter paper in the funnel","Add muddy water to the beaker","Pour the muddy water through the funnel","Observe the transparent water collected below"],reactions:{"muddy-water":{observation:"Muddy water is in the beaker. The water appears brown and cloudy with suspended mud particles.",explanation:"Muddy water is a mixture of water and insoluble mud particles. To separate them, you need to set up a filtration apparatus.",visual:{liquidColor:"#8b7355",particles:!0},success:!1},"muddy-water+pour":{observation:"You are pouring the muddy water into the funnel... Watch as the filter paper separates the mud from the water!",explanation:"The muddy water passes through the filter paper. Water molecules are small enough to pass through the tiny pores, but mud particles are too large and get trapped.",visual:{pouring:!0},success:!1},"muddy-water+pour+filter":{observation:"Filtration complete! Clear water has collected in the beaker below. The brown mud residue is trapped on the filter paper.",explanation:"Filtration separates insoluble solid particles from a liquid. The filter paper acts as a barrier - it allows water molecules to pass through but traps the larger mud particles.",visual:{liquidColor:"#c8e0ff",particles:!1,filtered:!0},success:!0}},conclusion:"Filtration is used to separate insoluble solids from liquids. The filter paper traps solid particles while allowing the liquid to pass through. This method is used to purify drinking water and in many industrial processes."},{id:"evaporation",title:"Separation by Evaporation",chapter:"Separation of Substances",classLevel:6,aim:"To obtain salt from salt solution by evaporation.",apparatus:["tripod-stand","burner","china-dish"],chemicals:[{id:"salt-solution",name:"Salt Solution",color:"#e8f4ff"}],procedureSteps:["Place the tripod stand on the lab bench","Place the burner under the tripod stand","Place the china dish on the tripod stand","Add salt solution to the china dish","Heat the solution and observe evaporation","Observe the salt crystals left behind"],reactions:{"salt-solution":{observation:"Clear salt solution is in the china dish. The solution looks like plain water but contains dissolved salt.",explanation:"Salt solution is a homogeneous mixture where salt is completely dissolved in water. To recover the salt, you need to evaporate the water.",visual:{liquidColor:"#e8f4ff",particles:!1},success:!1},"salt-solution+heat":{observation:"As you heat the solution, you can see steam rising. The water level is decreasing gradually.",explanation:"Heat provides energy for water molecules to escape as water vapor (steam). Keep heating to evaporate all the water.",visual:{liquidColor:"#e8f4ff",steam:!0},success:!1},"salt-solution+heat+evaporate":{observation:"All the water has evaporated! White salt crystals are left behind at the bottom of the china dish.",explanation:"When water evaporates, the dissolved salt cannot escape with it because salt has a much higher boiling point. The salt crystallizes and remains in the dish. This is how sea salt is obtained from sea water!",visual:{liquidColor:"transparent",crystals:!0},success:!0}},conclusion:"Evaporation is used to separate a dissolved solid from a liquid. When the liquid evaporates, the solid is left behind. This method is used to obtain salt from sea water and in sugar production."},{id:"physical-chemical",title:"Physical vs Chemical Change",chapter:"Changes Around Us",classLevel:6,aim:"To distinguish between physical and chemical changes.",apparatus:["tripod-stand","burner","beaker","tongs"],chemicals:[{id:"ice",name:"Ice Cubes",color:"#e0f4ff"},{id:"paper",name:"Paper Strip",color:"#f5f5dc"},{id:"magnesium",name:"Magnesium Ribbon",color:"#d4d4d4"}],procedureSteps:["Click 'Tripod Stand' to place it on the bench","Click 'Burner' to place it under the stand","Click 'Beaker' to place it on the stand","Click 'Ice Cubes' to add them to the beaker","Click the Burner to turn it ON (Observe Melting)","Click the 'Reset' button to clear the workspace","Click 'Burner' to place it on the bench","Click 'Tongs' to place them","Click 'Paper Strip' to hold it with tongs","Click the Burner to turn it ON (Observe Burning)","Click the 'Reset' button to clear the workspace","Click 'Burner' to place it on the bench","Click 'Tongs' to place them","Click 'Magnesium Ribbon' to hold it","Click the Burner to turn it ON (Observe White Flash)"],reactions:{"ice+heat":{observation:"The ice is melting! It is turning into liquid water. If you cool it again, it will become ice.",explanation:"Melting of ice is a PHYSICAL CHANGE. Only the state changes (solid to liquid), but the substance remains water (HO). This change is reversible.",visual:{liquidColor:"#e0f4ff",melting:!0},success:!0},"paper+heat":{observation:"The paper catches fire and burns! It turns into ash and smoke. You cannot get the paper back from ash.",explanation:"Burning of paper is a CHEMICAL CHANGE. The paper reacts with oxygen to form new substances (ash, carbon dioxide, water vapor). This change is irreversible.",visual:{burning:!0,ash:!0},success:!0},"magnesium+heat":{observation:"The magnesium ribbon burns with a bright white flame! A white powder (magnesium oxide) is formed.",explanation:"Burning of magnesium is a CHEMICAL CHANGE. Magnesium reacts with oxygen: 2Mg + O  2MgO. The white powder formed is magnesium oxide, a completely new substance.",visual:{burning:!0,brightFlame:!0},success:!0}},conclusion:"Physical changes are reversible and do not form new substances (melting, freezing, dissolving). Chemical changes are usually irreversible and form new substances (burning, rusting, cooking)."}],eU=[{id:"acids-bases",title:"Testing Acids and Bases",chapter:"Acids, Bases and Salts",classLevel:7,aim:"To test the nature of substances using litmus indicators and observe color changes.",apparatus:["test-tube-stand","test-tube","dropper"],chemicals:[{id:"vinegar",name:"Vinegar (Acid)",color:"#fff4cc"},{id:"lemon-juice",name:"Lemon Juice (Acid)",color:"#fff0b3"},{id:"soap-solution",name:"Soap Solution (Base)",color:"#dbe9ff"},{id:"baking-soda",name:"Baking Soda Soln (Base)",color:"#e6e6ff"},{id:"blue-litmus",name:"Blue Litmus",color:"#4169e1"},{id:"red-litmus",name:"Red Litmus",color:"#dc143c"}],procedureSteps:["Add vinegar to test tube","Add blue litmus using dropper - observe color change","Reset & add red litmus - observe","Repeat for other substances"],reactions:{"vinegar+blue-litmus":{observation:" The BLUE litmus turned RED! This confirms vinegar is an ACID.",explanation:"Acids turn blue litmus paper/solution RED. Vinegar contains acetic acid which releases H ions in water.",visual:{liquidColor:"#E93434",indicatorChange:!0},success:!0,resultType:"acid"},"vinegar+red-litmus":{observation:"The red litmus remains RED. No color change with red litmus in acid.",explanation:"Red litmus does not change color in acidic solutions. To identify an acid, test with blue litmus.",visual:{liquidColor:"#FF8A8A"},success:!0,resultType:"acid-no-change"},"lemon-juice+blue-litmus":{observation:" The BLUE litmus turned RED! This confirms lemon juice is an ACID.",explanation:"Lemon juice contains citric acid. Like all acids, it releases H ions which turn blue litmus red.",visual:{liquidColor:"#E93434",indicatorChange:!0},success:!0,resultType:"acid"},"lemon-juice+red-litmus":{observation:"The red litmus remains RED. No color change with red litmus in acid.",explanation:"Red litmus does not change color in acidic solutions.",visual:{liquidColor:"#FF8A8A"},success:!0,resultType:"acid-no-change"},"soap-solution+blue-litmus":{observation:"The blue litmus remains BLUE. No color change with blue litmus in base.",explanation:"Blue litmus does not change color in basic solutions.",visual:{liquidColor:"#60A5FA"},success:!0,resultType:"base-no-change"},"soap-solution+red-litmus":{observation:" The RED litmus turned BLUE! This confirms soap solution is a BASE.",explanation:"Bases turn red litmus paper/solution BLUE. Soap solution releases OH ions in water.",visual:{liquidColor:"#2563EB",indicatorChange:!0},success:!0,resultType:"base"},"baking-soda+blue-litmus":{observation:"The blue litmus remains BLUE. No color change with blue litmus in base.",explanation:"Blue litmus does not change color in basic solutions.",visual:{liquidColor:"#60A5FA"},success:!0,resultType:"base-no-change"},"baking-soda+red-litmus":{observation:" The RED litmus turned BLUE! This confirms baking soda solution is a BASE.",explanation:"Baking soda (NaHCO) is a weak base that releases OH ions in water.",visual:{liquidColor:"#2563EB",indicatorChange:!0},success:!0,resultType:"base"}},conclusion:"Acids turn blue litmus red (due to H ions). Bases turn red litmus blue (due to OH ions). Common acids: vinegar, lemon juice. Common bases: soap, baking soda."}],tU=[{id:"neutralization",title:"Neutralization Reaction",chapter:"Acids, Bases and Salts",classLevel:8,aim:"To study the reaction between an acid and a base using phenolphthalein indicator.",apparatus:["beaker","dropper"],chemicals:[{id:"naoh",name:"NaOH Solution",color:"#e0e0ff"},{id:"phenolphthalein",name:"Phenolphthalein",color:"#ffb6c1"},{id:"hcl",name:"Dilute HCl",color:"#ffe0e0"}],procedureSteps:["Place the beaker on the lab bench","Add NaOH solution to the beaker","Add Phenolphthalein indicator","Select the dropper from apparatus shelf","Slowly add 5 drops of HCl to neutralize"],reactions:{naoh:{observation:"Sodium hydroxide (NaOH) solution is in the beaker. It is a clear, colorless basic solution.",explanation:"NaOH is a strong base that completely dissociates in water to form Na and OH ions.",visual:{liquidColor:"#FFFFFF"},success:!1},"naoh+phenolphthalein":{observation:" The solution turned PINK! Phenolphthalein indicates the presence of a base. Now add HCl to neutralize.",explanation:"Phenolphthalein is colorless in acidic/neutral solutions but turns pink/magenta in basic solutions (pH > 8.2).",visual:{liquidColor:"#FF1493",indicatorAdded:!0},success:!1},"naoh+phenolphthalein+hcl":{name:"NEUTRALIZATION COMPLETE!",description:"The solution turned colorless",observation:" NEUTRALIZATION COMPLETE! The solution is now colorless - the acid has neutralized the base!",explanation:"Complete neutralization: HCl + NaOH  NaCl + HO. The phenolphthalein turned colorless because the solution is no longer basic.",visual:{liquidColor:"#f0f8ff",neutralized:!0},success:!0}},conclusion:"When an acid (HCl) reacts with a base (NaOH), they neutralize each other to form salt (NaCl) and water. Reaction: HCl + NaOH  NaCl + HO"}],nU=[{id:"double-displacement",title:"Double Displacement Reaction",chapter:"Chemical Reactions and Equations",classLevel:10,aim:"To observe a double displacement reaction by mixing Sodium Sulphate and Barium Chloride solutions.",apparatus:["beaker"],chemicals:[{id:"sodium-sulphate",name:"Sodium Sulphate (NaSO)",color:"#c8e0ff"},{id:"barium-chloride",name:"Barium Chloride (BaCl)",color:"#d4f0e8"}],procedureSteps:["Place a beaker on the lab bench","Add Sodium Sulphate solution to the beaker","Add Barium Chloride solution to the same beaker","Observe the white precipitate formed"],reactions:{"sodium-sulphate":{observation:"Colorless Sodium Sulphate solution is in the beaker.",explanation:"Sodium Sulphate (NaSO) is a soluble salt that dissociates into Na and SO ions in water.",visual:{liquidColor:"#e8f4ff"},success:!1},"sodium-sulphate+barium-chloride":{observation:" A thick WHITE PRECIPITATE forms immediately! This is Barium Sulphate (BaSO).",explanation:"DOUBLE DISPLACEMENT REACTION: NaSO + BaCl  BaSO + 2NaCl. The SO ions from sodium sulphate combine with Ba ions from barium chloride to form insoluble Barium Sulphate precipitate. The Na and Cl ions remain dissolved as NaCl.",visual:{liquidColor:"#f5f5f5",particles:!0,settled:!0},success:!0}},conclusion:"Double displacement reaction occurs when two ionic compounds exchange their ions. NaSO + BaCl  BaSO + 2NaCl. The white precipitate of BaSO confirms the reaction."}],Cy={6:QB,7:eU,8:tU,10:nU};function iU(i){for(const e in Cy){const t=Cy[Number(e)].find(n=>n.id===i);if(t)return t}}function rU(i){return Cy[i]||[]}function p2(){return Object.values(Cy).flat()}function sU(){return p2().length}const go={water:{id:"water",name:"Water",formula:"HO",color:"#4fc3f7",type:"water"},hydrochloric_acid:{id:"hydrochloric_acid",name:"Hydrochloric Acid",formula:"HCl",color:"#c8e6c9",type:"acid",concentration:1},sodium_hydroxide:{id:"sodium_hydroxide",name:"Sodium Hydroxide",formula:"NaOH",color:"#e1bee7",type:"base",concentration:1},zinc:{id:"zinc",name:"Zinc Metal",formula:"Zn",color:"#b0bec5",type:"metal"},sodium_chloride:{id:"sodium_chloride",name:"Sodium Chloride (Salt)",formula:"NaCl",color:"#ffffff",type:"salt"},phenolphthalein:{id:"phenolphthalein",name:"Phenolphthalein",formula:"CHO",color:"#ffccff",type:"indicator"},sulfuric_acid:{id:"sulfuric_acid",name:"Sulfuric Acid",formula:"HSO",color:"#e8f5e9",type:"acid",concentration:1},barium_chloride:{id:"barium_chloride",name:"Barium Chloride",formula:"BaCl",color:"#e3f2fd",type:"salt"},silver_nitrate:{id:"silver_nitrate",name:"Silver Nitrate",formula:"AgNO",color:"#f5f5f5",type:"salt"},barium_sulfate:{id:"barium_sulfate",name:"Barium Sulfate",formula:"BaSO",color:"#ffffff",type:"salt"},silver_chloride:{id:"silver_chloride",name:"Silver Chloride",formula:"AgCl",color:"#f5f5f5",type:"salt"},baking_soda:{id:"baking_soda",name:"Baking Soda",formula:"NaHCO",color:"#ffffff",type:"base"},vinegar:{id:"vinegar",name:"Vinegar",formula:"CHCOOH",color:"#f5f0e0",type:"acid"},food_coloring_red:{id:"food_coloring_red",name:"Red Dye",color:"#ff0000",type:"other"},food_coloring_blue:{id:"food_coloring_blue",name:"Blue Dye",color:"#0000ff",type:"other"},food_coloring_yellow:{id:"food_coloring_yellow",name:"Yellow Dye",color:"#ffff00",type:"other"},hydrogen_peroxide:{id:"hydrogen_peroxide",name:"Hydrogen Peroxide",formula:"HO",color:"#ffffff",type:"other"},potassium_iodide:{id:"potassium_iodide",name:"Potassium Iodide",formula:"KI",color:"#ffeb3b",type:"salt"}},aU=[{id:"volcano_reaction",name:"Volcano Eruption! ",description:"Baking soda reacts with vinegar creating a fizzy foam eruption! CO gas is released.",reactants:{chemicalId1:"baking_soda",chemicalId2:"vinegar",chemicalType1:"base",chemicalType2:"acid"},products:[go.water],resultColor:"#ffffff",effects:["bubbles","foam"],isExothermic:!1},{id:"elephant_toothpaste",name:"Elephant Toothpaste! ",description:"Rapid decomposition of hydrogen peroxide catalyzed by potassium iodide creates massive foam!",reactants:{chemicalId1:"hydrogen_peroxide",chemicalId2:"potassium_iodide",chemicalType1:"other",chemicalType2:"salt"},products:[go.water],resultColor:"#fffef0",effects:["massive_foam","heat","bubbles"],isExothermic:!0},{id:"acid_base_neutralization",name:"Acid-Base Neutralization",description:"When an acid reacts with a base, they neutralize each other to form water and a salt.",reactants:{chemicalType1:"acid",chemicalType2:"base"},products:[go.water,go.sodium_chloride],resultColor:"#e0f7fa",effects:["color_change","heat"],isExothermic:!0},{id:"acid_metal_reaction",name:"Acid-Metal Reaction",description:"When an acid reacts with a reactive metal, it produces hydrogen gas and a salt.",reactants:{chemicalType1:"acid",chemicalType2:"metal"},products:[{id:"hydrogen_gas",name:"Hydrogen Gas",formula:"H",color:"transparent",type:"neutral"},{id:"zinc_chloride",name:"Zinc Chloride",formula:"ZnCl",color:"#f5f5f5",type:"salt"}],resultColor:"#f5f5f5",effects:["bubbles","heat"],isExothermic:!0},{id:"indicator_base",name:"Indicator Color Change",description:"Phenolphthalein turns pink in basic solutions!",reactants:{chemicalType1:"indicator",chemicalType2:"base",chemicalId1:"phenolphthalein"},products:[],resultColor:"#ff66b2",effects:["color_change"],isExothermic:!1,consumeReactants:!1},{id:"barium_sulfate_precipitation",name:"Precipitation Reaction",description:"Barium chloride reacts with sulfuric acid to form white barium sulfate precipitate!",reactants:{chemicalType1:"salt",chemicalType2:"acid",chemicalId1:"barium_chloride",chemicalId2:"sulfuric_acid"},products:[go.barium_sulfate],resultColor:"#ffffff",effects:["precipitate"],isExothermic:!1}];class oU{reactions;constructor(){this.reactions=aU}findReaction(e,t){return this.reactions.find(n=>{const{chemicalType1:r,chemicalType2:s,chemicalId1:l,chemicalId2:c}=n.reactants;if(!(r===e.type&&s===t.type||r===t.type&&s===e.type))return!1;if(l||c){const d=[e.id,t.id];if(l&&!d.includes(l)||c&&!d.includes(c))return!1}return!0})||null}checkReaction(e){if(e.length<2)return{occurred:!1,message:"Not enough chemicals to react."};for(let t=0;t<e.length;t++)for(let n=t+1;n<e.length;n++){const r=e[t].chemical,s=e[n].chemical,l=this.findReaction(r,s);if(l)return{occurred:!0,reaction:l,products:l.products,message:`Reaction! ${l.name}: ${l.description}`}}return{occurred:!1,message:"No reaction occurred."}}getAllReactions(){return[...this.reactions]}getChemical(e){return go[e]}}const dM=new oU;class lU{audioContext=null;isInitialized=!1;activeSounds=new Map;getContext(){return this.audioContext||(this.audioContext=new AudioContext),this.audioContext}async initialize(){if(this.isInitialized)return;const e=this.getContext();e.state==="suspended"&&await e.resume(),this.isInitialized=!0}playBubbles(e,t=4e3){this.initialize();const n=this.getContext(),r=[],s=[],l=n.sampleRate*(t/1e3),c=n.createBuffer(1,l,n.sampleRate),f=c.getChannelData(0);for(let S=0;S<l;S++)f[S]=(Math.random()*2-1)*.3;const d=n.createBufferSource();d.buffer=c;const m=n.createBiquadFilter();m.type="highpass",m.frequency.value=4e3;const g=n.createGain();g.gain.setValueAtTime(0,n.currentTime),g.gain.linearRampToValueAtTime(.04,n.currentTime+.3),g.gain.setValueAtTime(.04,n.currentTime+t/1e3-.5),g.gain.linearRampToValueAtTime(0,n.currentTime+t/1e3),d.connect(m),m.connect(g),g.connect(n.destination),d.start(),s.push(g),this.activeSounds.set(e,{oscillators:r,gains:s}),this.activeSounds.get(e).fizzNoise=d;const y=Math.floor(t/60);for(let S=0;S<y;S++){const T=Math.random()*t*.9,A=Math.random();let w,R,D;A<.5?(w=400+Math.random()*300,R=.03+Math.random()*.02,D=.04+Math.random()*.03):A<.85?(w=200+Math.random()*200,R=.05+Math.random()*.03,D=.06+Math.random()*.04):(w=80+Math.random()*100,R=.08+Math.random()*.04,D=.1+Math.random()*.06),setTimeout(()=>{if(!this.activeSounds.has(e))return;const I=n.createOscillator(),z=n.createGain(),j=n.createBiquadFilter();j.type="lowpass",j.frequency.value=1200+Math.random()*800,I.type="sine",I.frequency.setValueAtTime(w,n.currentTime),I.frequency.exponentialRampToValueAtTime(w*2.5,n.currentTime+D*.7),I.frequency.exponentialRampToValueAtTime(w*.5,n.currentTime+D),z.gain.setValueAtTime(0,n.currentTime),z.gain.linearRampToValueAtTime(R,n.currentTime+.005),z.gain.exponentialRampToValueAtTime(.001,n.currentTime+D),I.connect(j),j.connect(z),z.connect(n.destination),I.start(n.currentTime),I.stop(n.currentTime+D+.01)},T)}const v=Math.floor(t/800);for(let S=0;S<v;S++){const T=200+Math.random()*(t-500);setTimeout(()=>{if(!this.activeSounds.has(e))return;const A=n.createOscillator(),w=n.createGain();A.type="sine",A.frequency.setValueAtTime(40+Math.random()*30,n.currentTime),A.frequency.exponentialRampToValueAtTime(60+Math.random()*40,n.currentTime+.15),w.gain.setValueAtTime(0,n.currentTime),w.gain.linearRampToValueAtTime(.06,n.currentTime+.02),w.gain.exponentialRampToValueAtTime(.001,n.currentTime+.2),A.connect(w),w.connect(n.destination),A.start(n.currentTime),A.stop(n.currentTime+.25)},T)}setTimeout(()=>this.stopSound(e),t)}playSizzle(e,t=3e3){this.initialize();const n=this.getContext(),r=[],s=[],l=n.sampleRate*(t/1e3),c=n.createBuffer(1,l,n.sampleRate),f=c.getChannelData(0);for(let j=0;j<l;j++)f[j]=Math.random()*2-1;const d=n.createBufferSource();d.buffer=c;const m=n.createBiquadFilter();m.type="bandpass",m.frequency.value=2500,m.Q.value=1.5;const g=n.createGain();g.gain.setValueAtTime(0,n.currentTime),g.gain.linearRampToValueAtTime(.08,n.currentTime+.15),g.gain.setValueAtTime(.08,n.currentTime+t/1e3-.4),g.gain.exponentialRampToValueAtTime(.001,n.currentTime+t/1e3);const y=n.createOscillator(),v=n.createGain();y.frequency.value=12+Math.random()*6,v.gain.value=800,y.connect(v),v.connect(m.frequency),d.connect(m),m.connect(g),g.connect(n.destination),y.start(),d.start(),s.push(g),r.push(y),this.activeSounds.set(e,{oscillators:r,gains:s}),this.activeSounds.get(e).steamNoise=d;const S=Math.floor(t/50);for(let j=0;j<S;j++){const X=Math.random()*t*.85;setTimeout(()=>{if(!this.activeSounds.has(e))return;const G=n.createOscillator(),L=n.createGain(),k=n.createBiquadFilter();k.type="highpass",k.frequency.value=2e3+Math.random()*2e3,G.type="sawtooth",G.frequency.setValueAtTime(800+Math.random()*1200,n.currentTime),G.frequency.exponentialRampToValueAtTime(200,n.currentTime+.02),L.gain.setValueAtTime(0,n.currentTime),L.gain.linearRampToValueAtTime(.02+Math.random()*.02,n.currentTime+.002),L.gain.exponentialRampToValueAtTime(.001,n.currentTime+.02+Math.random()*.02),G.connect(k),k.connect(L),L.connect(n.destination),G.start(n.currentTime),G.stop(n.currentTime+.05)},X)}const T=n.createOscillator(),A=n.createGain(),w=n.createBiquadFilter();T.type="sine",T.frequency.setValueAtTime(80,n.currentTime),T.frequency.exponentialRampToValueAtTime(200,n.currentTime+t/3e3),T.frequency.exponentialRampToValueAtTime(60,n.currentTime+t/1e3),w.type="lowpass",w.frequency.value=300,A.gain.setValueAtTime(0,n.currentTime),A.gain.linearRampToValueAtTime(.1,n.currentTime+.1),A.gain.setValueAtTime(.1,n.currentTime+t/1e3-.3),A.gain.exponentialRampToValueAtTime(.001,n.currentTime+t/1e3),T.connect(w),w.connect(A),A.connect(n.destination),T.start(),T.stop(n.currentTime+t/1e3+.1),r.push(T);const R=n.createOscillator(),D=n.createGain();R.type="sine",R.frequency.setValueAtTime(55,n.currentTime);const I=n.createOscillator(),z=n.createGain();I.frequency.value=4,z.gain.value=3,I.connect(z),z.connect(R.frequency),D.gain.setValueAtTime(0,n.currentTime),D.gain.linearRampToValueAtTime(.06,n.currentTime+.3),D.gain.setValueAtTime(.06,n.currentTime+t/1e3-.5),D.gain.exponentialRampToValueAtTime(.001,n.currentTime+t/1e3),R.connect(D),D.connect(n.destination),I.start(),R.start(),R.stop(n.currentTime+t/1e3+.1),I.stop(n.currentTime+t/1e3+.1),r.push(R,I),setTimeout(()=>{this.stopSound(e)},t)}playPour(e){this.initialize();const t=this.getContext(),n=t.sampleRate*2,r=t.createBuffer(1,n,t.sampleRate),s=r.getChannelData(0);let l=0;for(let y=0;y<n;y++){const v=Math.random()*2-1;s[y]=(l+.02*v)/1.02,l=s[y],s[y]*=3.5}const c=t.createBufferSource();c.buffer=r,c.loop=!0;const f=t.createBiquadFilter();f.type="lowpass",f.frequency.value=600;const d=t.createGain();d.gain.setValueAtTime(0,t.currentTime),d.gain.linearRampToValueAtTime(.12,t.currentTime+.1);const m=t.createOscillator(),g=t.createGain();m.frequency.value=3,g.gain.value=.03,m.connect(g),g.connect(d.gain),c.connect(f),f.connect(d),d.connect(t.destination),m.start(),c.start(),this.activeSounds.set(e,{oscillators:[m],gains:[d]}),this.activeSounds.get(e).noise=c}stopSound(e){const t=this.activeSounds.get(e);if(!t)return;const n=this.getContext();this.activeSounds.delete(e),t.gains.forEach(r=>{try{r.gain.cancelScheduledValues(n.currentTime),r.gain.setValueAtTime(r.gain.value,n.currentTime),r.gain.linearRampToValueAtTime(0,n.currentTime+.05)}catch{}}),setTimeout(()=>{if(t.oscillators.forEach(r=>{try{r.stop()}catch{}}),t.noise)try{t.noise.stop()}catch{}if(t.fizzNoise)try{t.fizzNoise.stop()}catch{}if(t.steamNoise)try{t.steamNoise.stop()}catch{}if(t.flameNoise)try{t.flameNoise.stop()}catch{}if(t.rumbleNoise)try{t.rumbleNoise.stop()}catch{}},60)}playReactionSound(e,t,n){switch(e){case"bubbles":this.playBubbles(t,n);break;case"heat":this.playSizzle(t,n);break;case"boiling":this.playBoiling(t,n);break}}playFlame(e){this.initialize();const t=this.getContext(),n=t.sampleRate*4,r=t.createBuffer(1,n,t.sampleRate),s=r.getChannelData(0);let l=0;for(let y=0;y<n;y++){const v=Math.random()*2-1;s[y]=(l+.02*v)/1.02,l=s[y],s[y]*=3.5}const c=t.createBufferSource();c.buffer=r,c.loop=!0;const f=t.createBiquadFilter();f.type="bandpass",f.frequency.value=400,f.Q.value=.8;const d=t.createGain();d.gain.setValueAtTime(0,t.currentTime),d.gain.linearRampToValueAtTime(.08,t.currentTime+.3);const m=t.createOscillator(),g=t.createGain();m.frequency.value=8+Math.random()*4,g.gain.value=.02,m.connect(g),g.connect(d.gain),c.connect(f),f.connect(d),d.connect(t.destination),m.start(),c.start(),this.activeSounds.set(e,{oscillators:[m],gains:[d]}),this.activeSounds.get(e).flameNoise=c}playBoiling(e,t=5e3){this.initialize();const n=this.getContext(),r=[],s=[],l=n.sampleRate*(t/1e3),c=n.createBuffer(1,l,n.sampleRate),f=c.getChannelData(0);let d=0;for(let S=0;S<l;S++){const T=Math.random()*2-1;f[S]=(d+.02*T)/1.02,d=f[S],f[S]*=2}const m=n.createBufferSource();m.buffer=c;const g=n.createBiquadFilter();g.type="lowpass",g.frequency.value=200;const y=n.createGain();y.gain.setValueAtTime(0,n.currentTime),y.gain.linearRampToValueAtTime(.06,n.currentTime+.2),y.gain.setValueAtTime(.06,n.currentTime+t/1e3-.3),y.gain.linearRampToValueAtTime(0,n.currentTime+t/1e3),m.connect(g),g.connect(y),y.connect(n.destination),m.start(),s.push(y),this.activeSounds.set(e,{oscillators:r,gains:s}),this.activeSounds.get(e).rumbleNoise=m;const v=Math.floor(t/40);for(let S=0;S<v;S++){const T=Math.random()*t*.9;setTimeout(()=>{if(!this.activeSounds.has(e))return;const A=n.createOscillator(),w=n.createGain(),R=150+Math.random()*250;A.type="sine",A.frequency.setValueAtTime(R,n.currentTime),A.frequency.exponentialRampToValueAtTime(R*1.8,n.currentTime+.03),w.gain.setValueAtTime(0,n.currentTime),w.gain.linearRampToValueAtTime(.04+Math.random()*.03,n.currentTime+.005),w.gain.exponentialRampToValueAtTime(.001,n.currentTime+.04),A.connect(w),w.connect(n.destination),A.start(n.currentTime),A.stop(n.currentTime+.06)},T)}setTimeout(()=>this.stopSound(e),t)}playWarning(e="warning"){this.initialize();const t=this.getContext(),n=t.createOscillator(),r=t.createGain();n.type="sawtooth",n.frequency.setValueAtTime(440,t.currentTime),n.frequency.exponentialRampToValueAtTime(110,t.currentTime+.4),r.gain.setValueAtTime(0,t.currentTime),r.gain.linearRampToValueAtTime(.4,t.currentTime+.05),r.gain.exponentialRampToValueAtTime(.001,t.currentTime+.4),n.connect(r),r.connect(t.destination),n.start(t.currentTime),n.stop(t.currentTime+.5);const s=t.createOscillator(),l=t.createGain();s.type="square",s.frequency.setValueAtTime(430,t.currentTime),s.frequency.exponentialRampToValueAtTime(100,t.currentTime+.4),l.gain.setValueAtTime(0,t.currentTime),l.gain.linearRampToValueAtTime(.2,t.currentTime+.05),l.gain.exponentialRampToValueAtTime(.001,t.currentTime+.4),s.connect(l),l.connect(t.destination),s.start(t.currentTime),s.stop(t.currentTime+.5)}playDropSound(){this.initialize();const e=this.getContext(),t=e.createOscillator(),n=e.createGain(),r=1100+Math.random()*200;t.type="sine",t.frequency.setValueAtTime(r,e.currentTime),t.frequency.exponentialRampToValueAtTime(r*1.5,e.currentTime+.05),n.gain.setValueAtTime(0,e.currentTime),n.gain.linearRampToValueAtTime(.08,e.currentTime+.005),n.gain.exponentialRampToValueAtTime(.001,e.currentTime+.2),t.connect(n),n.connect(e.destination),t.start(e.currentTime),t.stop(e.currentTime+.25)}playPhaseSound(e){this.initialize();const t=this.getContext();if(e==="mixing"){const n=t.sampleRate*2,r=t.createBuffer(1,n,t.sampleRate),s=r.getChannelData(0);for(let d=0;d<n;d++)s[d]=(Math.random()*2-1)*.5;const l=t.createBufferSource();l.buffer=r;const c=t.createBiquadFilter();c.type="lowpass",c.frequency.value=400;const f=t.createGain();f.gain.setValueAtTime(0,t.currentTime),f.gain.linearRampToValueAtTime(.15,t.currentTime+.5),f.gain.linearRampToValueAtTime(0,t.currentTime+2),l.connect(c),c.connect(f),f.connect(t.destination),l.start()}else if(e==="bonding"){const n=t.createOscillator(),r=t.createGain();n.frequency.setValueAtTime(800,t.currentTime),n.frequency.exponentialRampToValueAtTime(1200,t.currentTime+.1),r.gain.setValueAtTime(0,t.currentTime),r.gain.linearRampToValueAtTime(.15,t.currentTime+.02),r.gain.exponentialRampToValueAtTime(.001,t.currentTime+.4),n.connect(r),r.connect(t.destination),n.start(),n.stop(t.currentTime+.5)}else if(e==="precipitating"){const n=t.createOscillator(),r=t.createGain();n.type="triangle",n.frequency.setValueAtTime(60,t.currentTime),n.frequency.linearRampToValueAtTime(40,t.currentTime+1.5),r.gain.setValueAtTime(0,t.currentTime),r.gain.linearRampToValueAtTime(.2,t.currentTime+.1),r.gain.linearRampToValueAtTime(0,t.currentTime+2),n.connect(r),r.connect(t.destination),n.start(),n.stop(t.currentTime+2)}}playPrecipitate(e="precipitate",t=15e3){this.initialize();const n=this.getContext(),r=[],s=[],l=n.createOscillator(),c=n.createGain(),f=n.createBiquadFilter();l.type="sine",l.frequency.setValueAtTime(30,n.currentTime),l.frequency.linearRampToValueAtTime(55,n.currentTime+t/2e3),l.frequency.linearRampToValueAtTime(40,n.currentTime+t/1e3),f.type="lowpass",f.frequency.value=80,c.gain.setValueAtTime(0,n.currentTime),c.gain.linearRampToValueAtTime(.15,n.currentTime+2),c.gain.setValueAtTime(.15,n.currentTime+t/1e3-3),c.gain.linearRampToValueAtTime(0,n.currentTime+t/1e3),l.connect(f),f.connect(c),c.connect(n.destination),l.start(),l.stop(n.currentTime+t/1e3+1),r.push(l),s.push(c);const d=(y,v,S)=>{setTimeout(()=>{if(!this.activeSounds.has(e))return;const T=n.createOscillator(),A=n.createGain(),w=n.createBiquadFilter();T.type="sine",T.frequency.value=y,T.detune.value=v,w.type="lowpass",w.frequency.value=2e3;const R=(t-S)/1e3;A.gain.setValueAtTime(0,n.currentTime),A.gain.linearRampToValueAtTime(.03,n.currentTime+1.5),A.gain.setValueAtTime(.03,n.currentTime+R-2),A.gain.linearRampToValueAtTime(0,n.currentTime+R),T.connect(w),w.connect(A),A.connect(n.destination),T.start(),T.stop(n.currentTime+R+.5)},S)};d(130.81,0,1e3),d(164.81,5,1500),d(196,-5,2e3),d(293.66,10,2500);for(let y=0;y<6;y++){const v=4e3+y*600;setTimeout(()=>{if(!this.activeSounds.has(e))return;const S=n.createOscillator(),T=n.createGain(),A=n.createBiquadFilter();S.type="sine",S.frequency.setValueAtTime(80+Math.random()*40,n.currentTime),S.frequency.exponentialRampToValueAtTime(200+Math.random()*100,n.currentTime+.3),S.frequency.exponentialRampToValueAtTime(60,n.currentTime+.6),A.type="bandpass",A.frequency.value=150,A.Q.value=2,T.gain.setValueAtTime(0,n.currentTime),T.gain.linearRampToValueAtTime(.06,n.currentTime+.1),T.gain.exponentialRampToValueAtTime(.001,n.currentTime+.6),S.connect(A),A.connect(T),T.connect(n.destination),S.start(),S.stop(n.currentTime+.7)},v)}[8e3,8500,9e3,9500].forEach((y,v)=>{setTimeout(()=>{if(!this.activeSounds.has(e))return;const S=n.createOscillator(),T=n.createGain();S.type="sine",S.frequency.setValueAtTime(60+v*10,n.currentTime),S.frequency.exponentialRampToValueAtTime(30,n.currentTime+.5),T.gain.setValueAtTime(0,n.currentTime),T.gain.linearRampToValueAtTime(.2,n.currentTime+.02),T.gain.exponentialRampToValueAtTime(.001,n.currentTime+.8),S.connect(T),T.connect(n.destination),S.start(),S.stop(n.currentTime+1);const A=n.createOscillator(),w=n.createGain();A.type="sine",A.frequency.value=800+v*200,w.gain.setValueAtTime(0,n.currentTime),w.gain.linearRampToValueAtTime(.06,n.currentTime+.01),w.gain.exponentialRampToValueAtTime(.001,n.currentTime+1.5),A.connect(w),w.connect(n.destination),A.start(),A.stop(n.currentTime+2)},y)});const g=11e3;for(let y=0;y<25;y++){const v=g+Math.random()*(t-g-1e3);setTimeout(()=>{if(!this.activeSounds.has(e))return;const S=n.createOscillator(),T=n.createGain(),A=2500+Math.random()*2500;S.type="sine",S.frequency.setValueAtTime(A,n.currentTime),S.frequency.exponentialRampToValueAtTime(A*.6,n.currentTime+.4),T.gain.setValueAtTime(0,n.currentTime),T.gain.linearRampToValueAtTime(.015+Math.random()*.01,n.currentTime+.01),T.gain.exponentialRampToValueAtTime(.001,n.currentTime+.4),S.connect(T),T.connect(n.destination),S.start(),S.stop(n.currentTime+.5)},v)}for(let y=0;y<8;y++){const v=11500+y*400+Math.random()*200;setTimeout(()=>{if(!this.activeSounds.has(e))return;const S=n.createOscillator(),T=n.createGain(),A=45+Math.random()*25;S.type="sine",S.frequency.setValueAtTime(A,n.currentTime),S.frequency.exponentialRampToValueAtTime(A*.4,n.currentTime+.2),T.gain.setValueAtTime(0,n.currentTime),T.gain.linearRampToValueAtTime(.08,n.currentTime+.015),T.gain.exponentialRampToValueAtTime(.001,n.currentTime+.25),S.connect(T),T.connect(n.destination),S.start(),S.stop(n.currentTime+.3)},v)}setTimeout(()=>{if(!this.activeSounds.has(e))return;[65.41,82.41,98,130.81].forEach((v,S)=>{const T=n.createOscillator(),A=n.createGain();T.type="sine",T.frequency.value=v,A.gain.setValueAtTime(0,n.currentTime),A.gain.linearRampToValueAtTime(.04,n.currentTime+.1+S*.05),A.gain.setValueAtTime(.04,n.currentTime+1.5),A.gain.exponentialRampToValueAtTime(.001,n.currentTime+3),T.connect(A),A.connect(n.destination),T.start(),T.stop(n.currentTime+3.5)})},t-1500),this.activeSounds.set(e,{oscillators:r,gains:s}),setTimeout(()=>this.stopSound(e),t+2e3)}stopAll(){this.activeSounds.forEach((e,t)=>this.stopSound(t))}playRobotBeep(){this.initialize();const e=this.getContext(),t=e.createOscillator(),n=e.createOscillator(),r=e.createGain();t.type="sine",t.frequency.setValueAtTime(800,e.currentTime),t.frequency.exponentialRampToValueAtTime(1200,e.currentTime+.08),n.type="sine",n.frequency.setValueAtTime(600,e.currentTime),n.frequency.exponentialRampToValueAtTime(900,e.currentTime+.08),n.detune.value=5,r.gain.setValueAtTime(0,e.currentTime),r.gain.linearRampToValueAtTime(.08,e.currentTime+.01),r.gain.setValueAtTime(.08,e.currentTime+.06),r.gain.exponentialRampToValueAtTime(.001,e.currentTime+.15),t.connect(r),n.connect(r),r.connect(e.destination),t.start(e.currentTime),n.start(e.currentTime),t.stop(e.currentTime+.2),n.stop(e.currentTime+.2)}playRobotCheer(){this.initialize();const e=this.getContext();[523.25,659.25,783.99,1046.5].forEach((n,r)=>{setTimeout(()=>{const s=e.createOscillator(),l=e.createGain(),c=e.createBiquadFilter();s.type="sine",s.frequency.value=n,c.type="lowpass",c.frequency.value=3e3,l.gain.setValueAtTime(0,e.currentTime),l.gain.linearRampToValueAtTime(.12,e.currentTime+.015),l.gain.exponentialRampToValueAtTime(.001,e.currentTime+.2),s.connect(c),c.connect(l),l.connect(e.destination),s.start(e.currentTime),s.stop(e.currentTime+.25)},r*60)}),setTimeout(()=>{const n=e.createOscillator(),r=e.createGain();n.type="sine",n.frequency.setValueAtTime(2e3,e.currentTime),n.frequency.exponentialRampToValueAtTime(3e3,e.currentTime+.05),n.frequency.exponentialRampToValueAtTime(1500,e.currentTime+.15),r.gain.setValueAtTime(0,e.currentTime),r.gain.linearRampToValueAtTime(.04,e.currentTime+.01),r.gain.exponentialRampToValueAtTime(.001,e.currentTime+.2),n.connect(r),r.connect(e.destination),n.start(e.currentTime),n.stop(e.currentTime+.25)},250)}playRobotThinking(){this.initialize();const e=this.getContext();for(let t=0;t<2;t++)setTimeout(()=>{const n=e.createOscillator(),r=e.createGain();n.type="sine",n.frequency.setValueAtTime(600+t*100,e.currentTime),r.gain.setValueAtTime(0,e.currentTime),r.gain.linearRampToValueAtTime(.04,e.currentTime+.01),r.gain.exponentialRampToValueAtTime(.001,e.currentTime+.1),n.connect(r),r.connect(e.destination),n.start(e.currentTime),n.stop(e.currentTime+.12)},t*100)}playRobotWelcome(){this.initialize();const e=this.getContext();[261.63,329.63,392,523.25].forEach((s,l)=>{const c=e.createOscillator(),f=e.createGain();c.type="sine",c.frequency.value=s,c.detune.value=l*3,f.gain.setValueAtTime(0,e.currentTime),f.gain.linearRampToValueAtTime(.06,e.currentTime+.05),f.gain.setValueAtTime(.06,e.currentTime+.3),f.gain.exponentialRampToValueAtTime(.001,e.currentTime+.6),c.connect(f),f.connect(e.destination),c.start(e.currentTime+l*.03),c.stop(e.currentTime+.7)});const n=e.createOscillator(),r=e.createGain();n.type="sine",n.frequency.setValueAtTime(200,e.currentTime),n.frequency.exponentialRampToValueAtTime(800,e.currentTime+.2),r.gain.setValueAtTime(0,e.currentTime),r.gain.linearRampToValueAtTime(.03,e.currentTime+.02),r.gain.exponentialRampToValueAtTime(.001,e.currentTime+.25),n.connect(r),r.connect(e.destination),n.start(e.currentTime),n.stop(e.currentTime+.3)}playRobotClick(){this.initialize();const e=this.getContext(),t=e.createOscillator(),n=e.createGain();t.type="sine",t.frequency.setValueAtTime(1e3,e.currentTime),t.frequency.exponentialRampToValueAtTime(600,e.currentTime+.03),n.gain.setValueAtTime(0,e.currentTime),n.gain.linearRampToValueAtTime(.06,e.currentTime+.005),n.gain.exponentialRampToValueAtTime(.001,e.currentTime+.05),t.connect(n),n.connect(e.destination),t.start(e.currentTime),t.stop(e.currentTime+.06)}playRobotExcited(){this.initialize();const e=this.getContext(),t=e.createOscillator(),n=e.createGain(),r=e.createOscillator(),s=e.createGain();t.type="sine",t.frequency.setValueAtTime(800,e.currentTime),r.frequency.value=20,s.gain.value=100,r.connect(s),s.connect(t.frequency),n.gain.setValueAtTime(0,e.currentTime),n.gain.linearRampToValueAtTime(.1,e.currentTime+.02),n.gain.setValueAtTime(.1,e.currentTime+.15),n.gain.exponentialRampToValueAtTime(.001,e.currentTime+.3),t.connect(n),n.connect(e.destination),r.start(e.currentTime),t.start(e.currentTime),r.stop(e.currentTime+.35),t.stop(e.currentTime+.35),setTimeout(()=>{const l=e.createOscillator(),c=e.createGain();l.type="sine",l.frequency.setValueAtTime(1200,e.currentTime),l.frequency.exponentialRampToValueAtTime(1800,e.currentTime+.08),c.gain.setValueAtTime(0,e.currentTime),c.gain.linearRampToValueAtTime(.08,e.currentTime+.01),c.gain.exponentialRampToValueAtTime(.001,e.currentTime+.12),l.connect(c),c.connect(e.destination),l.start(e.currentTime),l.stop(e.currentTime+.15)},150)}}const $s=new lU,K_=Object.freeze(Object.defineProperty({__proto__:null,SoundManager:$s},Symbol.toStringTag,{value:"Module"}));let pM=0;const De=oB((i,e)=>({showAssistant:!0,vessels:new Map([["beaker_1",{id:"beaker_1",type:"beaker",capacity:500,currentVolume:0,tiltAngle:0,temperature:25,contents:[],position:[-1.2,0,0]}],["beaker_2",{id:"beaker_2",type:"beaker",capacity:500,currentVolume:0,tiltAngle:0,temperature:25,contents:[],position:[1.2,0,0]}],["tube_1",{id:"tube_1",type:"test_tube",capacity:50,currentVolume:0,tiltAngle:0,temperature:25,contents:[],position:[-2.5,0,-1]}],["tube_2",{id:"tube_2",type:"test_tube",capacity:50,currentVolume:0,tiltAngle:0,temperature:25,contents:[],position:[-2.1,0,-1]}],["tube_3",{id:"tube_3",type:"test_tube",capacity:50,currentVolume:0,tiltAngle:0,temperature:25,contents:[],position:[-1.7,0,-1]}],["tube_4",{id:"tube_4",type:"test_tube",capacity:50,currentVolume:0,tiltAngle:0,temperature:25,contents:[],position:[-1.3,0,-1]}],["flask_1",{id:"flask_1",type:"flask",capacity:250,currentVolume:0,tiltAngle:0,temperature:25,contents:[],position:[2.8,0,.5]}]]),selectedVesselId:"beaker_1",isPouringActive:!1,pouringSourceId:null,pouringTargetId:null,pendingFiltrationVolume:0,isAutoPouring:!1,isAssistantSpeaking:!1,activeEffects:[],reactionNotification:null,safetyWarning:null,bunsenBurnerOn:!1,heatingVesselId:null,experimentMode:"sandbox",showLab:!1,currentExperiment:null,placedApparatus:[],addedChemicals:[],experimentActions:[],currentObservation:"Welcome to the Virtual Chemistry Lab! Select an experiment to begin.",currentExplanation:"",showExplanation:!1,experimentHeatLevel:0,experimentStirCount:0,isStirring:!1,completedExperiments:JSON.parse(localStorage.getItem("completedExperiments")||"[]"),saltTested:!1,sandTested:!1,resetAfterSaltTest:!1,showResetPrompt:!1,resetPromptMessage:"",showCompletionPopup:!1,dishCracked:!1,dishCrackedAcknowledged:!1,iceTested:!1,paperTested:!1,magnesiumTested:!1,neutralizationAnimating:!1,neutralizationDropCount:0,neutralizationComplete:!1,molecularViewActive:!1,molecularViewPhase:"idle",vinegarBlueLitmusTested:!1,vinegarRedLitmusTested:!1,lemonJuiceBlueLitmusTested:!1,lemonJuiceRedLitmusTested:!1,soapSolutionBlueLitmusTested:!1,soapSolutionRedLitmusTested:!1,bakingSodaBlueLitmusTested:!1,bakingSodaRedLitmusTested:!1,droppingState:{active:!1,chemicalId:null,vesselId:null,color:"#ffffff"},precipitateAnimationPhase:"idle",setPrecipitateAnimationPhase:t=>i({precipitateAnimationPhase:t}),addVessel:t=>i(n=>{const r=new Map(n.vessels);r.set(t.id,t);let s=n.placedApparatus;if(n.currentExperiment?.id==="filtration"&&t.type==="beaker"){const l=r.get(t.id);l&&!l.name&&r.set(t.id,{...l,name:"Muddy Water Beaker"}),r.has("collection_beaker")||r.set("collection_beaker",{id:"collection_beaker",name:"Collection Beaker",type:"beaker",capacity:250,currentVolume:0,tiltAngle:0,temperature:25,contents:[],position:[3.5,0,0]}),s.includes("beaker")||(s=[...s,"beaker"])}return{vessels:r,placedApparatus:s}}),removeVessel:t=>i(n=>{const r=new Map(n.vessels);return r.delete(t),{vessels:r}}),selectVessel:t=>i({selectedVesselId:t}),fillVessel:(t,n,r)=>i(s=>{const l=s.vessels.get(t);if(!l)return s;const c=["blue-litmus","red-litmus"].includes(n.id),f=c?0:r,d=Math.min(l.currentVolume+f,l.capacity),m=d-l.currentVolume;if(m<=0&&!c)return s;const g=l.contents.findIndex(S=>S.chemical.id===n.id);let y;g>=0?y=l.contents.map((S,T)=>T===g?{...S,volume:S.volume+m}:S):y=[...l.contents,{chemical:n,volume:m}];const v=new Map(s.vessels);if(v.set(t,{...l,currentVolume:d,contents:y}),s.experimentMode!=="guided"){const S=v.get(t),T=dM.checkReaction(S.contents);T.occurred&&T.reaction&&setTimeout(()=>{e().applyReaction(t,T.reaction)},100)}return{vessels:v}}),updateVesselTilt:(t,n)=>i(r=>{const s=r.vessels.get(t);if(!s)return r;const l=new Map(r.vessels);return l.set(t,{...s,tiltAngle:n}),{vessels:l}}),updateVesselPosition:(t,n)=>i(r=>{const s=r.vessels.get(t);if(!s)return r;const l=new Map(r.vessels);return l.set(t,{...s,position:n}),{vessels:l}}),clearVessel:t=>i(n=>{const r=n.vessels.get(t);if(!r)return n;const s=new Map(n.vessels);return s.set(t,{...r,currentVolume:0,contents:[],tiltAngle:0}),{vessels:s}}),getVessel:t=>e().vessels.get(t),transferLiquid:(t,n,r)=>i(s=>{const l=s.vessels.get(t),c=s.vessels.get(n);if(!l||!c||l.currentVolume<=0)return s;const f=l.currentVolume,d=c.capacity-c.currentVolume,m=Math.min(r,f,d);if(m<=0)return s;const g=m/l.currentVolume,y=[],v=[];l.contents.forEach(I=>{const z=I.volume*g,j=I.volume-z;j>.01&&y.push({...I,volume:j}),z>.01&&v.push({chemical:I.chemical,volume:z})});let S=[...c.contents];v.forEach(I=>{const z=S.findIndex(j=>j.chemical.id===I.chemical.id);z>=0?S[z]={...S[z],volume:S[z].volume+I.volume}:S.push(I)});const T=new Map(s.vessels);T.set(t,{...l,currentVolume:l.currentVolume-m,contents:y}),T.set(n,{...c,currentVolume:c.currentVolume+m,contents:S});const A=T.get(n),w=dM.checkReaction(A.contents);w.occurred&&w.reaction&&setTimeout(()=>{e().applyReaction(n,w.reaction)},100);let R=s.pendingFiltrationVolume||0,D=s.experimentActions;if(n==="collection_beaker"){m>0&&!D.includes("pour")&&(D=[...D,"pour"]),R+=m;const I=s.vessels.get(n);I&&T.set(n,I)}return{vessels:T,experimentActions:D,pendingFiltrationVolume:R}}),setPouringState:(t,n=null,r=null)=>i({isPouringActive:t,pouringSourceId:n,pouringTargetId:r}),addFiltrate:t=>i(n=>{const r=n.vessels.get("collection_beaker");if(!r||n.pendingFiltrationVolume<=0)return{};const s=Math.min(t,n.pendingFiltrationVolume);if(s<=0)return{};const l={id:"water",name:"Water",color:"#c8e0ff",type:"water"},c=new Map(n.vessels),f=r.contents.find(m=>m.chemical.id==="water");let d=[...r.contents];return f?d=r.contents.map(m=>m.chemical.id==="water"?{...m,volume:m.volume+s}:m):d.push({chemical:l,volume:s}),c.set("collection_beaker",{...r,currentVolume:r.currentVolume+s,contents:d}),{vessels:c,pendingFiltrationVolume:n.pendingFiltrationVolume-s}}),setAutoPouring:t=>i({isAutoPouring:t}),addEffect:t=>i(n=>({activeEffects:[...n.activeEffects,{...t,id:`effect_${++pM}`,startTime:Date.now()}]})),removeEffect:t=>i(n=>({activeEffects:n.activeEffects.filter(r=>r.id!==t)})),clearExpiredEffects:()=>i(t=>{const n=Date.now();return{activeEffects:t.activeEffects.filter(r=>n-r.startTime<r.duration)}}),dismissNotification:()=>i({reactionNotification:null}),showSafetyWarning:(t,n)=>i({safetyWarning:{title:t,message:n}}),dismissSafetyWarning:()=>i(t=>({safetyWarning:null,dishCrackedAcknowledged:t.dishCracked?!0:t.dishCrackedAcknowledged})),setDishCracked:t=>i({dishCracked:t,dishCrackedAcknowledged:!1}),resetPhysicalChemicalState:()=>{i({iceTested:!1,paperTested:!1,magnesiumTested:!1,showResetPrompt:!1,resetPromptMessage:"",placedApparatus:[],addedChemicals:[],experimentActions:[],currentObservation:"",currentExplanation:"",showExplanation:!1,vessels:new Map,activeEffects:[]})},ttsLanguage:"en",setTtsLanguage:t=>i({ttsLanguage:t}),startNeutralizationAnimation:()=>{i({neutralizationAnimating:!0,neutralizationDropCount:0,showResetPrompt:!1})},incrementNeutralizationDrops:()=>{const{neutralizationDropCount:t}=e(),n=t+1;i({neutralizationDropCount:n}),n>=5&&e().completeNeutralization()},completeNeutralization:()=>{i({neutralizationAnimating:!1,neutralizationComplete:!0,addedChemicals:[...e().addedChemicals.filter(t=>t!=="hcl"),"hcl"],currentObservation:" NEUTRALIZATION COMPLETE! The solution turned colorless - the acid has neutralized the base!",currentExplanation:"Complete neutralization: HCl + NaOH  NaCl + HO. The phenolphthalein turned colorless because the solution is no longer basic (pH  7).",showExplanation:!0}),e().checkExperimentReaction()},resetNeutralizationState:()=>{i({neutralizationAnimating:!1,neutralizationDropCount:0,neutralizationComplete:!1,isNeutralizationAudioDone:!1})},applyReaction:(t,n)=>i(r=>{const s=r.vessels.get(t);if(!s)return r;const l=s.contents.filter(g=>g.chemical.id.includes("food_coloring")||g.chemical.id.includes("dye"));let c;n.consumeReactants===!1?c=[...s.contents]:c=[...n.products.map(y=>({chemical:y,volume:s.currentVolume/n.products.length})),...l];const f=new Map(r.vessels);f.set(t,{...s,contents:c});const d=(n.effects||[]).map(g=>{let y=3e3;g==="bubbles"&&(y=4e3),g==="foam"&&(y=8e3),g==="massive_foam"&&(y=12e3);const v=`effect_${++pM}`;return $s.playReactionSound(g,v,y),{id:v,type:g,vesselId:t,startTime:Date.now(),duration:y}}),m={reaction:n,products:n.products,vesselId:t,timestamp:Date.now()};return{vessels:f,activeEffects:[...r.activeEffects,...d],reactionNotification:m}}),toggleBunsenBurner:()=>i(t=>{const n=!t.bunsenBurnerOn;let r=t.experimentActions;return n?($s.playFlame("bunsen_burner"),r.includes("heat")||(r=[...r,"heat"])):$s.stopSound("bunsen_burner"),{bunsenBurnerOn:n,experimentActions:r}}),setHeatingVessel:t=>i({heatingVesselId:t}),updateVesselTemperature:(t,n)=>i(r=>{const s=r.vessels.get(t);if(!s)return r;const l=new Map(r.vessels);return l.set(t,{...s,temperature:n}),{vessels:l}}),setExperimentMode:t=>i(()=>{if(t==="sandbox"){const n=new Map;return n.set("beaker_1",{id:"beaker_1",type:"beaker",position:[0,0,0],contents:[],capacity:500,currentVolume:0,tiltAngle:0,temperature:25}),{experimentMode:"sandbox",showLab:!0,currentExperiment:null,vessels:n,selectedVesselId:"beaker_1",placedApparatus:["beaker"],addedChemicals:[],experimentActions:[],currentObservation:" Free Exploration Mode - Add any chemicals to the beaker!",currentExplanation:"",showExplanation:!1}}return{experimentMode:t,showLab:!0}}),loadExperiment:t=>i(()=>{const n=iU(t);return n?{experimentMode:"guided",showLab:!0,currentExperiment:n,vessels:new Map,selectedVesselId:"beaker_1",placedApparatus:[],addedChemicals:[],experimentActions:[],currentObservation:` ${n.aim}`,currentExplanation:"",showExplanation:!1,experimentHeatLevel:0,experimentStirCount:0,saltTested:!1,sandTested:!1,resetAfterSaltTest:!1,iceTested:!1,paperTested:!1,magnesiumTested:!1,vinegarBlueLitmusTested:!1,vinegarRedLitmusTested:!1,lemonJuiceBlueLitmusTested:!1,lemonJuiceRedLitmusTested:!1,soapSolutionBlueLitmusTested:!1,soapSolutionRedLitmusTested:!1,bakingSodaBlueLitmusTested:!1,bakingSodaRedLitmusTested:!1,neutralizationAnimating:!1,neutralizationDropCount:0,neutralizationComplete:!1,showResetPrompt:!1,resetPromptMessage:"",showCompletionPopup:!1}:{}}),addApparatusToExperiment:t=>i(n=>n.placedApparatus.includes(t)?n:{placedApparatus:[...n.placedApparatus,t],currentObservation:`Added ${t.replace(/-/g," ")} to the lab bench.`}),addChemicalToExperiment:t=>i(n=>{if(n.addedChemicals.includes(t))return n;const r=[...n.addedChemicals,t],l=n.currentExperiment?.chemicals.find(c=>c.id===t)?.name||t.replace(/-/g," ");return{addedChemicals:r,currentObservation:`Added ${l} to the apparatus.`}}),performExperimentAction:t=>i(n=>{if(n.experimentActions.includes(t))return n;const r=[...n.experimentActions,t];let s=n.experimentHeatLevel,l=n.experimentStirCount,c=n.isStirring;return t==="heat"?(s=Math.min(100,n.experimentHeatLevel+30),n.currentExperiment?.id==="evaporation"&&setTimeout(()=>{De.getState().performExperimentAction("evaporate"),De.getState().checkExperimentReaction()},5e3)):t==="stir"&&(l=n.experimentStirCount+1,c=!0,setTimeout(()=>{De.setState({isStirring:!1}),De.getState().checkExperimentReaction()},4e3)),{experimentActions:r,experimentHeatLevel:s,experimentStirCount:l,isStirring:c}}),checkExperimentReaction:()=>i(t=>{if(!t.currentExperiment)return t;const n=[...t.addedChemicals],r=[...t.experimentActions],l=(()=>{const m=[];r.length>0&&(m.push([...n,...r].join("+")),m.push([...n].sort().concat([...r].sort()).join("+")));for(const g of r)m.push([...n,g].join("+")),m.push([...n].sort().concat(g).join("+"));return n.length>0&&(m.push(n.join("+")),m.push([...n].sort().join("+"))),m})(),c=Object.keys(t.currentExperiment.reactions);let f=null,d="";for(const m of l)if(t.currentExperiment.reactions[m]){f=t.currentExperiment.reactions[m],d=m;break}if(!f)for(const m of c){const g=m.split("+"),y=g.filter(A=>!["stir","heat","filter","evaporate","pour"].includes(A)),v=g.filter(A=>["stir","heat","filter","evaporate","pour"].includes(A)),S=y.every(A=>n.includes(A)),T=v.every(A=>r.includes(A));if(S&&T){f=t.currentExperiment.reactions[m],d=m;break}}if(f){if(t.currentExperiment.id==="salt-dissolution"&&f.success){let m=t.saltTested,g=t.sandTested,y=!1,v="";if(d.includes("salt")&&d.includes("stir")&&!t.saltTested?(m=!0,y=!0,v=" Salt test complete! Click RESET to test with Sand."):d.includes("sand")&&d.includes("stir")&&!t.sandTested&&(g=!0),m&&g){y=!1;const S=t.currentExperiment.id,T=!t.completedExperiments.includes(S),A=T?[...t.completedExperiments,S]:t.completedExperiments;return T&&localStorage.setItem("completedExperiments",JSON.stringify(A)),setTimeout(()=>{De.setState({showCompletionPopup:!0})},3e3),{currentObservation:" Experiment Complete! You tested both salt and sand.",currentExplanation:t.currentExperiment.conclusion,showExplanation:!0,saltTested:m,sandTested:g,showResetPrompt:!1,resetPromptMessage:"",completedExperiments:A}}return{currentObservation:f.observation,currentExplanation:f.explanation,showExplanation:!0,saltTested:m,sandTested:g,showResetPrompt:y,resetPromptMessage:v}}else if(t.currentExperiment.id==="physical-chemical"){let m=!1,g="";const y=new Map(t.vessels);if(d==="ice+heat"){m=!0,g=" Ice melted! Click RESET to test with Paper.";for(const[v,S]of y.entries()){const T=S.contents.find(A=>A.chemical.id==="ice");if(T){const w={id:"water",name:"Water",color:"#a8d4ff",type:"water",...t.currentExperiment.chemicals.find(z=>z.id==="water")},D=T.volume*.4,I=[{chemical:w,volume:D}];y.set(v,{...S,contents:I,currentVolume:D})}}return{vessels:y,currentObservation:f.observation,currentExplanation:f.explanation,showExplanation:!0,showResetPrompt:m,resetPromptMessage:g,iceTested:!0}}else if(d==="paper+heat"){m=!0,g=" Paper burnt! Click RESET to test with Magnesium.";for(const[v,S]of y.entries())if(S.type==="tongs"&&S.contents.some(T=>T.chemical.id==="paper")){const A=[{chemical:{id:"ash",name:"Ash",color:"#333",type:"neutral"},volume:1}];y.set(v,{...S,contents:A})}return $s.stopSound("bunsen_burner"),{vessels:y,currentObservation:f.observation,currentExplanation:f.explanation,showExplanation:!0,showResetPrompt:m,resetPromptMessage:g,paperTested:!0,bunsenBurnerOn:!1}}else if(d==="magnesium+heat"){for(const[T,A]of y.entries())if(A.type==="tongs"&&A.contents.some(w=>w.chemical.id==="magnesium")){const R=[{chemical:{id:"magnesium-oxide",name:"Magnesium Oxide",color:"#fff",type:"base"},volume:1}];y.set(T,{...A,contents:R})}const v=!t.completedExperiments.includes(t.currentExperiment.id),S=v?[...t.completedExperiments,t.currentExperiment.id]:t.completedExperiments;return v&&localStorage.setItem("completedExperiments",JSON.stringify(S)),setTimeout(()=>{De.setState({showCompletionPopup:!0})},3e3),$s.stopSound("bunsen_burner"),{vessels:y,currentObservation:f.observation,currentExplanation:f.explanation,showExplanation:!0,completedExperiments:S,magnesiumTested:!0,bunsenBurnerOn:!1}}return{vessels:y,currentObservation:f.observation,currentExplanation:f.explanation,showExplanation:!0,showResetPrompt:m,resetPromptMessage:g}}else if(t.currentExperiment.id==="acids-bases"&&f.success){let{vinegarBlueLitmusTested:m,vinegarRedLitmusTested:g,lemonJuiceBlueLitmusTested:y,lemonJuiceRedLitmusTested:v,soapSolutionBlueLitmusTested:S,soapSolutionRedLitmusTested:T,bakingSodaBlueLitmusTested:A,bakingSodaRedLitmusTested:w}=t;const R=new Map(t.vessels);if(f.visual?.liquidColor){for(const[j,X]of R.entries())if(X.type==="test_tube"){const G=X.contents.map(L=>({...L,chemical:{...L.chemical,color:f.visual.liquidColor}}));R.set(j,{...X,contents:G})}}let D=!1,I="";if(d.includes("vinegar")?d.includes("blue-litmus")?(m=!0,g?(D=!0,I=" Vinegar fully tested! Click RESET to test Lemon Juice."):(D=!0,I=" Blue Litmus tested. Click RESET to test with Red Litmus.")):d.includes("red-litmus")&&(g=!0,m?(D=!0,I=" Vinegar fully tested! Click RESET to test Lemon Juice."):(D=!0,I=" Red Litmus tested. Click RESET to test with Blue Litmus.")):d.includes("lemon-juice")?d.includes("blue-litmus")?(y=!0,v?(D=!0,I=" Lemon Juice fully tested! Click RESET to test Soap Solution."):(D=!0,I=" Blue Litmus tested. Click RESET to test with Red Litmus.")):d.includes("red-litmus")&&(v=!0,y?(D=!0,I=" Lemon Juice fully tested! Click RESET to test Soap Solution."):(D=!0,I=" Red Litmus tested. Click RESET to test with Blue Litmus.")):d.includes("soap-solution")?d.includes("blue-litmus")?(S=!0,T?(D=!0,I=" Soap Solution fully tested! Click RESET to test Baking Soda."):(D=!0,I=" Blue Litmus tested. Click RESET to test with Red Litmus.")):d.includes("red-litmus")&&(T=!0,S?(D=!0,I=" Soap Solution fully tested! Click RESET to test Baking Soda."):(D=!0,I=" Red Litmus tested. Click RESET to test with Blue Litmus.")):d.includes("baking-soda")&&(d.includes("blue-litmus")?(A=!0,w?D=!1:(D=!0,I=" Blue Litmus tested. Click RESET to test with Red Litmus.")):d.includes("red-litmus")&&(w=!0,A?D=!1:(D=!0,I=" Red Litmus tested. Click RESET to test with Blue Litmus."))),m&&g&&y&&v&&S&&T&&A&&w){const j=!t.completedExperiments.includes(t.currentExperiment.id),X=j?[...t.completedExperiments,t.currentExperiment.id]:t.completedExperiments;return j&&localStorage.setItem("completedExperiments",JSON.stringify(X)),{vessels:R,currentObservation:" Experiment Complete! You have tested all 4 substances with both litmus papers.",currentExplanation:t.currentExperiment.conclusion,showExplanation:!0,completedExperiments:X,vinegarBlueLitmusTested:m,vinegarRedLitmusTested:g,lemonJuiceBlueLitmusTested:y,lemonJuiceRedLitmusTested:v,soapSolutionBlueLitmusTested:S,soapSolutionRedLitmusTested:T,bakingSodaBlueLitmusTested:A,bakingSodaRedLitmusTested:w,showResetPrompt:!1}}return{vessels:R,currentObservation:f.observation,currentExplanation:f.explanation,showExplanation:!0,showResetPrompt:D,resetPromptMessage:I,vinegarBlueLitmusTested:m,vinegarRedLitmusTested:g,lemonJuiceBlueLitmusTested:y,lemonJuiceRedLitmusTested:v,soapSolutionBlueLitmusTested:S,soapSolutionRedLitmusTested:T,bakingSodaBlueLitmusTested:A,bakingSodaRedLitmusTested:w}}else if(f.success){const m=t.currentExperiment.id,g=!t.completedExperiments.includes(m),y=g?[...t.completedExperiments,m]:t.completedExperiments;return g&&localStorage.setItem("completedExperiments",JSON.stringify(y)),m!=="double-displacement"&&m!=="neutralization"&&(console.log(`[LabStore] Scheduling completion popup for ${m} in 3000ms`),setTimeout(()=>{console.log(`[LabStore] Triggering completion popup for ${m}`),De.setState({showCompletionPopup:!0})},3e3)),{currentObservation:f.observation||"Experiment Complete!",currentExplanation:f.explanation||t.currentExperiment.conclusion,showExplanation:!0,completedExperiments:y}}return{currentObservation:f.observation,currentExplanation:f.explanation,showExplanation:f.success||!!f.explanation&&f.explanation.length>0}}return t}),resetExperiment:()=>i(t=>{if(!t.currentExperiment)return t;let n=t.resetAfterSaltTest,r=` ${t.currentExperiment.aim}`,s=[];t.currentExperiment.id==="salt-dissolution"&&(t.saltTested&&!t.sandTested?(n=!0,s=["Place the beaker","Add water to the beaker","Add SAND to the water","Stir the mixture","Observe: Sand settles"],r=" Now test with SAND. Add water, then add sand, and stir."):t.saltTested&&t.sandTested&&(n=!1));let l=t.iceTested,c=t.paperTested,f=t.magnesiumTested;t.currentExperiment.id==="physical-chemical"&&(t.iceTested&&!t.paperTested?r=" Round 2: Now test with PAPER. Place burner and tongs, then add paper strip and heat.":t.iceTested&&t.paperTested&&!t.magnesiumTested?r=" Round 3: Now test with MAGNESIUM. Place burner and tongs, then add magnesium ribbon and heat.":t.iceTested&&t.paperTested&&t.magnesiumTested&&(l=!1,c=!1,f=!1,r=` ${t.currentExperiment.aim}`));let d=t.vinegarBlueLitmusTested,m=t.vinegarRedLitmusTested,g=t.lemonJuiceBlueLitmusTested,y=t.lemonJuiceRedLitmusTested,v=t.soapSolutionBlueLitmusTested,S=t.soapSolutionRedLitmusTested,T=t.bakingSodaBlueLitmusTested,A=t.bakingSodaRedLitmusTested;return t.currentExperiment.id==="acids-bases"&&(t.vinegarBlueLitmusTested&&t.vinegarRedLitmusTested&&t.lemonJuiceBlueLitmusTested&&t.lemonJuiceRedLitmusTested&&t.soapSolutionBlueLitmusTested&&t.soapSolutionRedLitmusTested&&t.bakingSodaBlueLitmusTested&&t.bakingSodaRedLitmusTested?(d=!1,m=!1,g=!1,y=!1,v=!1,S=!1,T=!1,A=!1,r=` ${t.currentExperiment.aim}`):!t.vinegarBlueLitmusTested||!t.vinegarRedLitmusTested?r=" Use the dropper to add litmus solution to the vinegar.":!t.lemonJuiceBlueLitmusTested||!t.lemonJuiceRedLitmusTested?r=" Round 2: Test Lemon Juice. Add lemon juice to the test tube.":!t.soapSolutionBlueLitmusTested||!t.soapSolutionRedLitmusTested?r=" Round 3: Test Soap Solution. Add soap solution to the test tube.":(!t.bakingSodaBlueLitmusTested||!t.bakingSodaRedLitmusTested)&&(r=" Round 4: Test Baking Soda. Add baking soda to the test tube.")),{...t,currentExperiment:{...t.currentExperiment,procedureSteps:s.length>0?s:t.currentExperiment.procedureSteps},vessels:new Map,placedApparatus:[],addedChemicals:[],experimentActions:[],experimentRunning:!1,timer:0,currentObservation:r,currentExplanation:"",showExplanation:!1,experimentHeatLevel:0,experimentStirCount:0,isStirring:!1,resetAfterSaltTest:n,saltTested:t.saltTested&&t.sandTested?!1:t.saltTested,sandTested:t.saltTested&&t.sandTested?!1:t.sandTested,iceTested:l,paperTested:c,magnesiumTested:f,vinegarBlueLitmusTested:d,vinegarRedLitmusTested:m,lemonJuiceBlueLitmusTested:g,lemonJuiceRedLitmusTested:y,soapSolutionBlueLitmusTested:v,soapSolutionRedLitmusTested:S,bakingSodaBlueLitmusTested:T,bakingSodaRedLitmusTested:A,showResetPrompt:!1,resetPromptMessage:"",showCompletionPopup:!1,dishCracked:!1,dishCrackedAcknowledged:!1,safetyWarning:null,bunsenBurnerOn:!1,neutralizationAnimating:!1,neutralizationDropCount:0,neutralizationComplete:!1,isNeutralizationAudioDone:!1}}),markExperimentComplete:t=>i(n=>{if(n.completedExperiments.includes(t))return n;const r=[...n.completedExperiments,t];return localStorage.setItem("completedExperiments",JSON.stringify(r)),{completedExperiments:r}}),unmarkExperimentComplete:t=>i(n=>{const r=n.completedExperiments.filter(s=>s!==t);return localStorage.setItem("completedExperiments",JSON.stringify(r)),{completedExperiments:r}}),goToHomeScreen:()=>i({experimentMode:"sandbox",showLab:!1,currentExperiment:null,placedApparatus:[],addedChemicals:[],experimentActions:[],currentObservation:"Welcome to the Virtual Chemistry Lab! Select an experiment to begin.",currentExplanation:"",showExplanation:!1,experimentHeatLevel:0,experimentStirCount:0,droppingState:{active:!1,chemicalId:null,vesselId:null,color:"#ffffff"}}),toggleAssistant:()=>i(t=>({showAssistant:!t.showAssistant})),setShowAssistant:t=>i({showAssistant:t}),setAssistantSpeaking:t=>i({isAssistantSpeaking:t}),startDroppingAnimation:(t,n,r)=>i({droppingState:{active:!0,chemicalId:t,vesselId:n,color:r}}),completeDroppingAnimation:()=>i(t=>({droppingState:{...t.droppingState,active:!1}})),isNeutralizationAudioDone:!1,setNeutralizationAudioDone:t=>i({isNeutralizationAudioDone:t})}));function cU({startPos:i,delay:e}){const t=ge.useRef(null),[n,r]=ge.useState(!1),s=ge.useRef(0),l=ge.useRef([...i]);return ge.useEffect(()=>{const c=setTimeout(()=>r(!0),e*1e3);return()=>clearTimeout(c)},[e]),Lr((c,f)=>{if(!n||!t.current)return;s.current+=f*2,l.current[1]-=s.current*f;const d=.05;if(l.current[1]<d){l.current[1]=d,s.current=0;const g=t.current.material;g.opacity=Math.max(0,g.opacity-f*3)}t.current.position.y=l.current[1];const m=t.current.material;m.opacity>0&&l.current[1]>d&&(m.opacity-=f*.3)}),n?_.jsxs("mesh",{ref:t,position:i,children:[_.jsx("sphereGeometry",{args:[.03,8,8]}),_.jsx("meshStandardMaterial",{color:"#a8e4ff",transparent:!0,opacity:.8,roughness:.1,metalness:.2})]}):null}function uU({initialPos:i,initialRot:e,melting:t,meltProgress:n,baseScale:r}){const s=ge.useRef(null),l=ge.useMemo(()=>1+i[1]*.5+Math.random()*.3,[i]),c=ge.useMemo(()=>Math.random()*Math.PI*2,[]),f=Math.min(1,n*l),d=Math.max(0,1-f*.95),m=xp.lerp(.85,.2,f),g=f*i[1]*.8,y=ge.useMemo(()=>{const v=new fn("#e0f6ff"),S=new fn("#a8e4ff");return v.lerp(S,f)},[f]);return Lr(v=>{if(!s.current||!t)return;const S=Math.sin(v.clock.elapsedTime*3+c)*.02*(1-f);s.current.rotation.z=e[2]+S,s.current.rotation.x=e[0]+S*.5}),d<=.05?null:_.jsxs("mesh",{ref:s,position:[i[0],i[1]-g,i[2]],rotation:e,scale:d*r,children:[_.jsx("boxGeometry",{args:[.37,.37,.37]}),_.jsx("meshStandardMaterial",{color:y,transparent:!0,opacity:m,roughness:.05,metalness:.15,envMapIntensity:1.5}),_.jsxs("mesh",{scale:.85,children:[_.jsx("boxGeometry",{args:[.37,.37,.37]}),_.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:m*.3})]})]})}function fU({scale:i=1,melting:e=!1,onMeltComplete:t}){const n=ge.useRef(null),[r,s]=ge.useState(0),l=ge.useRef(!1),c=ge.useMemo(()=>[{pos:[.25,.16,.15],rot:[.1,.2,0]},{pos:[-.25,.16,-.15],rot:[0,.5,.1]},{pos:[.25,.16,-.25],rot:[.2,0,.2]},{pos:[-.22,.16,.25],rot:[0,.3,0]},{pos:[0,.16,0],rot:[.1,.1,.1]},{pos:[.35,.16,0],rot:[.05,.4,0]},{pos:[-.35,.16,.1],rot:[.1,.1,.2]},{pos:[0,.16,.35],rot:[.2,.2,0]},{pos:[.1,.16,-.35],rot:[0,.3,.1]},{pos:[.15,.45,.15],rot:[.5,.2,.1]},{pos:[-.15,.45,-.1],rot:[.2,.5,.3]},{pos:[.1,.45,-.2],rot:[.1,.1,.4]},{pos:[-.1,.45,.2],rot:[.3,.2,.1]},{pos:[.2,.45,-.1],rot:[.4,.1,.2]},{pos:[0,.65,0],rot:[.6,.4,.2]}],[]),f=ge.useMemo(()=>e?c.flatMap((d,m)=>Array.from({length:3},(g,y)=>({pos:[d.pos[0]*i+(Math.random()-.5)*.1,d.pos[1]*i,d.pos[2]*i+(Math.random()-.5)*.1],delay:m*.3+y*.5+Math.random()*.5}))):[],[e,c,i]);return Lr((d,m)=>{e&&r<1&&s(g=>Math.min(1,g+m*.125)),e&&r>=.95&&!l.current&&(l.current=!0,t?.())}),ge.useEffect(()=>{e||(s(0),l.current=!1)},[e]),_.jsxs("group",{ref:n,scale:i,children:[c.map((d,m)=>_.jsx(uU,{initialPos:d.pos,initialRot:d.rot,melting:e,meltProgress:r,baseScale:1},m)),e&&r>.1&&r<.9&&f.map((d,m)=>_.jsx(cU,{startPos:d.pos,delay:d.delay},m)),e&&r>.2&&_.jsxs("mesh",{position:[0,.02,0],rotation:[-Math.PI/2,0,0],children:[_.jsx("circleGeometry",{args:[.5*Math.min(1,r*1.5),32]}),_.jsx("meshStandardMaterial",{color:"#a8e4ff",transparent:!0,opacity:Math.min(.6,r*.8),roughness:.1,metalness:.1})]})]})}function hU({burning:i=!1,onBurnComplete:e}){const t=ge.useRef(null),[n,r]=ge.useState(0),s=ge.useRef(!1),l=ge.useRef(0);Lr((d,m)=>{if(l.current+=m,i&&n<1&&r(g=>Math.min(1,g+m*.25)),i&&n>=.9&&!s.current&&(s.current=!0,e?.()),t.current){const g=Math.max(.05,1-n*.9);t.current.scale.set(1-n*.4,g,1),i&&n<.9&&(t.current.rotation.x=Math.sin(l.current*3)*.15*n,t.current.rotation.z=Math.sin(l.current*5)*.1*(1-n),t.current.position.y=-.15+n*.1)}}),ge.useEffect(()=>{i||(r(0),s.current=!1,l.current=0)},[i]);const c=ge.useMemo(()=>n<.2?new fn("#f5f5dc").lerp(new fn("#d4a574"),n/.2):n<.5?new fn("#d4a574").lerp(new fn("#5c3d2e"),(n-.2)/.3):n<.8?new fn("#5c3d2e").lerp(new fn("#2a2a2a"),(n-.5)/.3):new fn("#111111"),[n]),f=i?Math.sin(l.current*8)*.3+.7:0;return n>=.95?null:_.jsxs("group",{children:[_.jsxs("mesh",{ref:t,position:[0,-.15,0],children:[_.jsx("boxGeometry",{args:[.45,.35,.015]}),_.jsx("meshStandardMaterial",{color:c,roughness:.9,emissive:i&&n>.1?"#ff4400":"#000000",emissiveIntensity:i?n*.3:0})]}),i&&n>.05&&n<.85&&_.jsxs("mesh",{position:[0,-.15-.35*(1-n)*.5,0],children:[_.jsx("boxGeometry",{args:[.48*(1-n*.4),.04,.02]}),_.jsx("meshBasicMaterial",{color:"#ff6600",transparent:!0,opacity:f*.8})]}),i&&n>.08&&n<.88&&_.jsxs("group",{position:[0,-.15,0],children:[_.jsxs("mesh",{position:[0,.05,0],children:[_.jsx("sphereGeometry",{args:[.06*(1-n*.5),12,12]}),_.jsx("meshBasicMaterial",{color:"#ffffcc",transparent:!0,opacity:.9*(1-n)})]}),_.jsxs("mesh",{position:[Math.sin(l.current*12)*.02,.08,0],children:[_.jsx("sphereGeometry",{args:[.1*(1-n*.4),10,10]}),_.jsx("meshBasicMaterial",{color:"#ffcc00",transparent:!0,opacity:.75*(1-n)})]}),_.jsxs("mesh",{position:[Math.sin(l.current*8)*.03,.12+Math.sin(l.current*10)*.02,0],children:[_.jsx("sphereGeometry",{args:[.14*(1-n*.3),10,10]}),_.jsx("meshBasicMaterial",{color:"#ff6600",transparent:!0,opacity:.6*(1-n)})]}),_.jsxs("mesh",{position:[0,.15,0],children:[_.jsx("sphereGeometry",{args:[.18*(1-n*.3),8,8]}),_.jsx("meshBasicMaterial",{color:"#ff3300",transparent:!0,opacity:.35*(1-n)})]}),_.jsx("pointLight",{color:"#ff6600",intensity:3*f*(1-n),distance:2.5,decay:2}),_.jsx("pointLight",{color:"#ffcc00",intensity:1.5*f*(1-n),distance:1.5,position:[0,.1,0]})]}),i&&n>.15&&n<.9&&_.jsx("group",{position:[0,.1,0],children:[0,.3,.6,.9].map((d,m)=>{const g=(l.current+d)%1.5,y=g*.4,v=Math.max(0,.4-g*.3)*(1-n),S=Math.sin(l.current*2+d*5)*.05;return _.jsxs("mesh",{position:[S,y,0],children:[_.jsx("sphereGeometry",{args:[.04+g*.03,8,8]}),_.jsx("meshBasicMaterial",{color:"#444444",transparent:!0,opacity:v})]},m)})}),i&&n>.1&&n<.85&&_.jsx("group",{position:[0,-.1,0],children:[0,1.2,2.4,3.6,4.8].map((d,m)=>{const g=(l.current*1.5+d)%2,y=g*.3,v=Math.sin(d*3)*.15+Math.sin(l.current*4+d)*.05,S=Math.cos(d*2)*.08,T=Math.max(0,1-g*.6)*(1-n)*.8;return _.jsxs("mesh",{position:[v,y,S],children:[_.jsx("sphereGeometry",{args:[.012,6,6]}),_.jsx("meshBasicMaterial",{color:m%2===0?"#ff8800":"#ffaa00",transparent:!0,opacity:T})]},m)})}),i&&n>.4&&n<.95&&_.jsx("group",{position:[0,-.2,0],children:[0,.5,1].map((d,m)=>{const g=(l.current*.8+d)%1.2,y=-g*.15,v=Math.sin(d*4+l.current)*.08,S=Math.max(0,.5-g*.4)*n;return _.jsxs("mesh",{position:[v,y,0],rotation:[0,0,l.current+d],children:[_.jsx("boxGeometry",{args:[.025,.015,.002]}),_.jsx("meshBasicMaterial",{color:"#222222",transparent:!0,opacity:S})]},m)})})]})}function dU({burning:i=!1,onBurnComplete:e}){const t=ge.useRef(null),[n,r]=ge.useState(0),s=ge.useRef(!1),l=ge.useRef(0);Lr((m,g)=>{if(l.current+=g,i&&n<1&&r(y=>Math.min(1,y+g*.2)),i&&n>=.9&&!s.current&&(s.current=!0,e?.()),t.current&&i){const y=Math.max(.05,1-n*.95);t.current.scale.set(1,y,1);const v=.15-.3*y;t.current.position.y=v,t.current.position.x=Math.sin(l.current*15)*.005,t.current.position.z=Math.cos(l.current*12)*.003}}),ge.useEffect(()=>{i||(r(0),s.current=!1,l.current=0,t.current&&(t.current.scale.set(1,1,1),t.current.position.y=-.15))},[i]);const c=ge.useMemo(()=>n<.15?n/.15:n<.75?1:Math.max(0,(1-n)/.25),[n]),f=i?Math.sin(l.current*20)*.15+.85:0,d=-.45+.6*n;return n>=.95?null:_.jsxs("group",{children:[_.jsxs("group",{position:[0,0,0],rotation:[-.2,0,0],children:[_.jsxs("mesh",{ref:t,position:[0,-.15,0],children:[_.jsx("boxGeometry",{args:[.08,.6,.015]}),_.jsx("meshStandardMaterial",{color:i?"#ffffff":"#b8b8b8",metalness:.95,roughness:.15,emissive:i?"#ffffff":"#000000",emissiveIntensity:i?c*4:0})]}),i&&n>.05&&n<.9&&_.jsxs("mesh",{position:[0,d+.02,0],children:[_.jsx("sphereGeometry",{args:[.04,10,10]}),_.jsx("meshBasicMaterial",{color:"#ffffff"})]})]}),i&&n>.05&&n<.88&&_.jsxs("group",{position:[0,d+.05,0],children:[_.jsxs("mesh",{position:[0,0,0],children:[_.jsx("sphereGeometry",{args:[.08*c*f,16,16]}),_.jsx("meshBasicMaterial",{color:"#e0e8ff",transparent:!0,opacity:.95*c})]}),_.jsxs("mesh",{position:[Math.sin(l.current*18)*.01,.02,0],children:[_.jsx("sphereGeometry",{args:[.12*c,16,16]}),_.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:.9*c*f})]}),_.jsxs("mesh",{position:[0,.03,0],children:[_.jsx("sphereGeometry",{args:[.2*c,16,16]}),_.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:.7*c})]}),_.jsxs("mesh",{position:[0,.05,0],children:[_.jsx("sphereGeometry",{args:[.3*c,12,12]}),_.jsx("meshBasicMaterial",{color:"#fffaf0",transparent:!0,opacity:.5*c})]}),_.jsxs("mesh",{position:[0,0,0],children:[_.jsx("sphereGeometry",{args:[.5*c,12,12]}),_.jsx("meshBasicMaterial",{color:"#ffffee",transparent:!0,opacity:.25*c})]}),_.jsx("pointLight",{color:"#ffffff",intensity:15*c*f,distance:6,decay:2}),_.jsx("pointLight",{color:"#e8f0ff",intensity:8*c,distance:4,position:[0,.1,0]}),_.jsx("pointLight",{color:"#ccddff",intensity:3*c,distance:3,position:[0,-.1,0]})]}),i&&n>.08&&n<.85&&_.jsx("group",{position:[0,-.2,0],children:[0,.8,1.6,2.4,3.2,4,4.8,5.6].map((m,g)=>{const y=(l.current*2+m)%1.5,v=y*.5,S=Math.sin(m*2.5)*.2+Math.sin(l.current*6+m)*.08,T=Math.cos(m*1.8)*.15,A=Math.max(0,1-y*.8)*c,w=.015+Math.random()*.005;return _.jsxs("mesh",{position:[S,v,T],children:[_.jsx("sphereGeometry",{args:[w,6,6]}),_.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:A})]},g)})}),i&&n>.15&&n<.9&&_.jsx("group",{position:[0,.1,0],children:[0,.4,.8,1.2].map((m,g)=>{const y=(l.current*.8+m)%2,v=y*.5,S=Math.sin(l.current*1.5+m*3)*.1,T=Math.max(0,.5-y*.25)*c*.6;return _.jsxs("mesh",{position:[S,v,0],children:[_.jsx("sphereGeometry",{args:[.05+y*.04,8,8]}),_.jsx("meshBasicMaterial",{color:"#f8f8f8",transparent:!0,opacity:T})]},g)})}),i&&n>.3&&n<.95&&_.jsx("group",{position:[0,-.3,0],children:[0,.6,1.2].map((m,g)=>{const y=(l.current*.6+m)%1.5,v=-y*.2,S=Math.sin(m*3+l.current*.8)*.1,T=Math.max(0,.7-y*.5)*n;return _.jsxs("mesh",{position:[S,v,0],rotation:[l.current+m,0,l.current*.5],children:[_.jsx("boxGeometry",{args:[.02,.01,.015]}),_.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:T})]},g)})})]})}function pU(){return _.jsxs("group",{children:[_.jsxs("mesh",{position:[0,-.1,0],children:[_.jsx("boxGeometry",{args:[.15,.08,.01]}),_.jsx("meshStandardMaterial",{color:"#1a1a1a",roughness:1})]}),_.jsxs("mesh",{position:[.05,-.12,0],children:[_.jsx("boxGeometry",{args:[.06,.04,.01]}),_.jsx("meshStandardMaterial",{color:"#333",roughness:1})]}),_.jsxs("mesh",{position:[-.04,-.13,0],children:[_.jsx("boxGeometry",{args:[.05,.03,.01]}),_.jsx("meshStandardMaterial",{color:"#2a2a2a",roughness:1})]})]})}const mU={"Na+":{color:"#ff6600",borderColor:"#661100",label:"Na",size:.12},SO4:{color:"#ffff00",borderColor:"#665500",label:"SO",size:.12},"Ba2+":{color:"#00ff00",borderColor:"#004400",label:"Ba",size:.12},"Cl-":{color:"#ff00ff",borderColor:"#440044",label:"Cl",size:.12}};function gU({ion:i,showLabel:e=!0,showHalo:t=!1}){const n=mU[i.type],{size:r}=da(),s=r.width<768,l=r.height*.02;if(!e)return null;const c=n.size*(s?.8:1);return _.jsxs("group",{position:[i.position.x,i.position.y,i.position.z],children:[t&&_.jsxs("mesh",{renderOrder:15,children:[_.jsx("sphereGeometry",{args:[c*2.5,16,16]}),_.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:.3,depthWrite:!1})]}),i.phase==="bonded"&&_.jsxs("mesh",{rotation:[-Math.PI/2,0,0],children:[_.jsx("ringGeometry",{args:[.12,.15,32]}),_.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:.6,side:2})]}),_.jsxs("mesh",{renderOrder:20,children:[_.jsx("sphereGeometry",{args:[c,32,32]}),_.jsx("meshBasicMaterial",{color:n.color,toneMapped:!1,depthTest:!1})]}),_.jsxs("mesh",{renderOrder:19,scale:[1.08,1.08,1.08],children:[_.jsx("sphereGeometry",{args:[c,32,32]}),_.jsx("meshBasicMaterial",{color:n.borderColor,side:1,toneMapped:!1,depthTest:!1})]}),_.jsx(fd,{position:[0,0,0],center:!0,zIndexRange:[50,0],distanceFactor:6,style:{pointerEvents:"none",willChange:"transform"},children:_.jsx("div",{style:{color:"#ffffff",fontSize:`${l}px`,fontWeight:s?"800":"900",fontFamily:'"Segoe UI", Roboto, Helvetica, Arial, sans-serif',WebkitTextStroke:`${l*.03}px black`,textShadow:"0px 1px 2px rgba(0,0,0,0.5)",pointerEvents:"none",userSelect:"none",whiteSpace:"nowrap"},children:n.label})})]})}function vU({active:i,beakerRadius:e=.65,liquidHeight:t=1.2}){const n=ge.useRef(null),r=ge.useRef(0),[s,l]=ge.useState([]),[c,f]=ge.useState("intro"),[d,m]=ge.useState(!1),[g,y]=ge.useState(0),{camera:v,size:S}=da(),T=S.width<768,A=ge.useRef(null),w=De(I=>I.setPrecipitateAnimationPhase),R=I=>{f(I),w(I)};ge.useEffect(()=>()=>{w("idle")},[w]);const D=ge.useRef(null);return ge.useEffect(()=>{if(!A.current&&s.length,s.length>0)return;A.current=0,D.current=v.position.clone();const I=new Ee(0,2.5,4),z=v.position.clone();let j=0;const X=()=>{j+=.015,j<1&&(v.position.lerpVectors(z,I,j*j*(3-2*j)),requestAnimationFrame(X))};X();const G=setTimeout(()=>{const L=[],k=e*.75,U=(q,W)=>{const J=k*Math.sqrt(Math.random()),ce=Math.random()*Math.PI*2,K=J*Math.cos(ce),ne=J*Math.sin(ce),pe=t*(.2+Math.random()*.45);return{id:q,type:W,position:new Ee(K,pe,ne),velocity:new Ee((Math.random()-.5)*.05,(Math.random()-.5)*.05,(Math.random()-.5)*.05),phase:"floating"}};for(let q=0;q<10;q++)L.push(U(q,"Na+"));for(let q=0;q<5;q++)L.push(U(100+q,"SO4"));for(let q=0;q<5;q++)L.push(U(200+q,"Ba2+"));for(let q=0;q<10;q++)L.push(U(300+q,"Cl-"));l(L),R("mixing"),Qm(async()=>{const{SoundManager:q}=await Promise.resolve().then(()=>K_);return{SoundManager:q}},void 0).then(({SoundManager:q})=>{q.playPhaseSound("mixing")})},1e3);return()=>{clearTimeout(G),D.current&&v.position.copy(D.current)}},[]),ge.useEffect(()=>{c==="precipitating"&&A.current===null&&(A.current=r.current)},[c]),Lr(()=>{if(i&&(c==="precipitating"||c==="complete")&&s.length>0){let I=0,z=0;for(const j of s)if(j.type==="Ba2+"||j.type==="SO4"){z++;const G=Math.max(0,Math.min(1,1-(j.position.y-.08)/(.6-.08)));I+=G}if(z>0){const j=I/z;Math.abs(j-g)>.02&&y(Math.min(j,.75))}}}),Lr((I,z)=>{if(!i)return;const j=Math.min(z,.05);r.current+=j;const X=e*.75;n.current&&(n.current.rotation.y=Math.sin(r.current*.15)*.15),l(G=>G.map(L=>{const k={...L,position:L.position.clone(),velocity:L.velocity.clone()};if(c==="mixing"){k.velocity.x+=(Math.random()-.5)*.005,k.velocity.y+=(Math.random()-.5)*.005,k.velocity.z+=(Math.random()-.5)*.005,G.forEach(q=>{if(q.id!==L.id){const W=k.position.x-q.position.x,J=k.position.y-q.position.y,ce=k.position.z-q.position.z,K=Math.sqrt(W*W+J*J+ce*ce);if(K<.25&&K>.01){const ne=.001/K;k.velocity.x+=W/K*ne,k.velocity.y+=J/K*ne,k.velocity.z+=ce/K*ne}}}),k.position.y>t*.65&&(k.velocity.y-=.001),k.position.y<t*.4&&(k.velocity.y+=.001),k.velocity.multiplyScalar(.94),k.position.add(k.velocity.clone().multiplyScalar(j));const U=Math.sqrt(k.position.x**2+k.position.z**2);U>X*.9&&(k.position.x*=X*.85/U,k.position.z*=X*.85/U,k.velocity.multiplyScalar(-.3)),k.position.y=xp.clamp(k.position.y,t*.15,t*.7)}else if(c==="bonding")if(k.phase="seeking",L.type==="Ba2+"||L.type==="SO4"){const U=L.type==="Ba2+"?"SO4":"Ba2+",q=G.find(W=>W.type===U&&W.phase!=="bonded");if(q&&!L.partnerId){const W=new Ee().subVectors(q.position,L.position).normalize();k.velocity.add(W.multiplyScalar(.015)),k.velocity.multiplyScalar(.92),k.position.add(k.velocity.clone().multiplyScalar(j)),L.position.distanceTo(q.position)<.2&&(k.phase="bonded",k.partnerId=q.id)}}else{const U=Math.sqrt(k.position.x**2+k.position.z**2);U<X*.4&&(k.velocity.x+=k.position.x/(U+.01)*.008,k.velocity.z+=k.position.z/(U+.01)*.008),k.velocity.x+=(Math.random()-.5)*.006,k.velocity.y+=(Math.random()-.5)*.006,k.velocity.z+=(Math.random()-.5)*.006,k.velocity.multiplyScalar(.96),k.position.add(k.velocity.clone().multiplyScalar(j));const q=Math.sqrt(k.position.x**2+k.position.z**2);q>X*1&&(k.position.x*=X*.95/q,k.position.z*=X*.95/q),k.position.y=xp.clamp(k.position.y,t*.15,t*.7)}else if(c==="precipitating"||c==="complete")if(L.type==="Ba2+"||L.type==="SO4"){k.phase="precipitating",k.position.y=xp.lerp(k.position.y,.08,j*.3);const U=Math.sqrt(k.position.x**2+k.position.z**2);if(U>.3)k.position.x*=.995,k.position.z*=.995;else if(U<.15){const q=Math.atan2(k.position.z,k.position.x)+L.id*.5;k.position.x+=Math.cos(q)*.002,k.position.z+=Math.sin(q)*.002}}else{k.phase="dissolved",k.velocity.x+=(Math.random()-.5)*.008,k.velocity.y+=(Math.random()-.5)*.008,k.velocity.z+=(Math.random()-.5)*.008,k.velocity.multiplyScalar(.96),k.position.add(k.velocity.clone().multiplyScalar(j));const U=Math.sqrt(k.position.x**2+k.position.z**2);U>X*.85&&(k.position.x*=X*.8/U,k.position.z*=X*.8/U),k.position.y=xp.clamp(k.position.y,t*.15,t*.7)}return k}))}),i?_.jsxs("group",{ref:n,position:[0,.05,0],children:[!d&&_.jsxs(fd,{position:[0,-.9,0],center:!0,zIndexRange:[0,100],style:{pointerEvents:"none"},children:[_.jsx("style",{children:`
                        @keyframes fadeIn {
                            from { opacity: 0; transform: translateY(-10px); }
                            to { opacity: 1; transform: translateY(0); }
                        }
                        .eq-animate {
                            display: inline-block;
                            opacity: 0;
                            animation: fadeIn 0.5s ease-out forwards;
                        }
                    `}),_.jsxs("div",{style:{color:"#00ffff",fontSize:"24px",fontWeight:"bold",fontFamily:"Arial",textShadow:"0 0 10px #00aaff, 0 0 20px #004488",whiteSpace:"nowrap"},children:["NaSO + BaCl",(c==="precipitating"||c==="complete")&&_.jsxs(_.Fragment,{children:[_.jsx("span",{className:"eq-animate",style:{animationDelay:"1s"},children:"  "}),_.jsx("span",{className:"eq-animate",style:{animationDelay:"2s",color:"#ffffff"},children:"BaSO"}),_.jsx("span",{className:"eq-animate",style:{animationDelay:"4s"},children:" + "}),_.jsx("span",{className:"eq-animate",style:{animationDelay:"4.5s"},children:"2NaCl"})]})]})]}),!d&&c!=="intro"&&c!=="complete"&&_.jsx(fd,{position:[0,1.6,0],center:!0,zIndexRange:[0,100],style:{pointerEvents:"auto"},children:_.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[_.jsxs("div",{style:{color:c==="bonding"?"#00ff88":c==="precipitating"?"#ffaa00":"#88ddff",fontSize:"16px",fontWeight:"bold",fontFamily:"Arial",textShadow:"0 0 10px currentColor",background:"rgba(0,0,0,0.9)",padding:"10px 15px",borderRadius:"8px",border:"2px solid currentColor",whiteSpace:"nowrap"},children:[c==="mixing"&&"Step 1: Ions mixing",c==="bonding"&&"Step 2: Bonding",c==="precipitating"&&"Step 3: Precipitating"]}),_.jsx("button",{onClick:()=>{Qm(async()=>{const{SoundManager:I}=await Promise.resolve().then(()=>K_);return{SoundManager:I}},void 0).then(({SoundManager:I})=>{c==="mixing"?(R("bonding"),I.playPhaseSound("bonding")):c==="bonding"?(R("precipitating"),I.playPhaseSound("precipitating")):c==="precipitating"&&(R("complete"),m(!0))})},style:{background:"linear-gradient(135deg, #00aaff, #0066cc)",color:"white",border:"none",padding:"10px 25px",fontSize:"16px",fontWeight:"bold",borderRadius:"20px",cursor:"pointer",boxShadow:"0 4px 15px rgba(0,150,255,0.5)",whiteSpace:"nowrap"},children:c==="precipitating"?" Done":"Next "})]})}),s.map(I=>_.jsx(gU,{ion:I,showLabel:!0,showHalo:!1},I.id)),g>.05&&_.jsxs("group",{children:[_.jsxs("mesh",{position:[0,.02,0],renderOrder:-1,children:[_.jsx("cylinderGeometry",{args:[e*.75*Math.sqrt(g),e*.75*Math.sqrt(g),.06,32]}),_.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:g*.5,depthWrite:!1,depthTest:!0})]}),g>.3&&_.jsx(fd,{position:[.4,.15,0],zIndexRange:[0,100],style:{pointerEvents:"none"},children:_.jsx("div",{style:{color:"#ffffff",fontSize:"12px",fontWeight:"bold",fontFamily:"Arial",background:"rgba(0,0,0,0.7)",padding:"3px 8px",borderRadius:"4px",whiteSpace:"nowrap"},children:"BaSO (white precipitate)"})})]}),d&&_.jsx(fd,{position:[0,1.2,0],center:!0,zIndexRange:[200,0],style:{pointerEvents:"auto"},children:_.jsxs("div",{style:{background:"#0a1a2f",padding:T?"10px 15px":"15px 20px",borderRadius:"10px",border:"2px solid #00aaff",boxShadow:"0 0 20px rgba(0,150,255,0.4)",width:T?"250px":"300px",fontFamily:"Arial, sans-serif"},children:[_.jsx("div",{style:{color:"#00ffff",fontSize:T?"16px":"20px",fontWeight:"bold",marginBottom:"10px",textAlign:"center"},children:"Double Displacement Reaction"}),_.jsxs("div",{style:{color:"#ffffff",fontSize:T?"13px":"16px",marginBottom:"10px",textAlign:"center",fontWeight:"bold"},children:["NaSO + BaCl  ",_.jsx("span",{style:{color:"#ffffff"},children:"BaSO"})," + 2NaCl"]}),_.jsxs("div",{style:{color:"#cccccc",fontSize:T?"11px":"13px",lineHeight:"1.5",wordWrap:"break-word"},children:[_.jsxs("div",{style:{marginBottom:"8px"},children:[_.jsx("span",{style:{color:"#ffaa00"},children:"1."})," Solutions mix, ions separate"]}),_.jsxs("div",{style:{marginBottom:"8px"},children:[_.jsx("span",{style:{color:"#ffaa00"},children:"2."})," ",_.jsx("span",{style:{color:"#22ff22"},children:"Ba"})," attracts ",_.jsx("span",{style:{color:"#ffdd00"},children:"SO"})]}),_.jsxs("div",{style:{marginBottom:"8px"},children:[_.jsx("span",{style:{color:"#ffaa00"},children:"3."})," BaSO is ",_.jsx("span",{style:{color:"#ff6666"},children:"insoluble"}),"  sinks "]}),_.jsxs("div",{style:{borderTop:"1px solid #00aaff",paddingTop:"8px",marginTop:"5px"},children:[_.jsx("span",{style:{color:"#00ff88"},children:"Key:"})," ",_.jsx("span",{style:{color:"#4488ff"},children:"Na"})," + ",_.jsx("span",{style:{color:"#00ddff"},children:"Cl"})," stay dissolved (NaCl is ",_.jsx("span",{style:{color:"#88ff88"},children:"soluble"}),")"]})]}),_.jsx("button",{onClick:()=>{De.setState({showCompletionPopup:!0})},style:{display:"block",width:"100%",marginTop:"10px",padding:T?"10px":"12px 20px",background:"linear-gradient(135deg, #10b981, #059669)",color:"white",border:"none",borderRadius:"8px",fontSize:T?"14px":"16px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 15px rgba(16, 185, 129, 0.4)"},children:" Done"})]})})]}):null}function xU({vesselId:i}){const e=ge.useRef(null),t=ge.useRef(null),n=ge.useRef(null),[r,s]=ge.useState(!1),[l,c]=ge.useState(!1),[f,d]=ge.useState(0),{camera:m,gl:g}=da(),y=De(Ge=>Ge.vessels.get(i)),v=De(Ge=>Ge.vessels.get(i)?.contents??[]),S=De(Ge=>Ge.selectedVesselId),T=De(Ge=>Ge.selectVessel),A=De(Ge=>Ge.updateVesselTilt),w=De(Ge=>Ge.updateVesselPosition),R=De(Ge=>Ge.isStirring),D=De(Ge=>Ge.experimentActions),I=De(Ge=>Ge.currentExperiment),z=De(Ge=>Ge.bunsenBurnerOn),j=De(Ge=>Ge.checkExperimentReaction),X=De(Ge=>Ge.neutralizationDropCount),G=D.includes("stir")&&!R,[L,k]=ge.useState(0),[U,q]=ge.useState(0),[W,J]=ge.useState(!1),[ce,K]=ge.useState(0),[ne,pe]=ge.useState(!1),[Re,Te]=ge.useState([]),[ee,F]=ge.useState([]),$=ge.useRef(0);ge.useEffect(()=>{if(I?.id==="neutralization"&&X>$.current){const Ge=v.some(Pe=>Pe.chemical.id==="naoh"),xe=v.some(Pe=>Pe.chemical.id==="phenolphthalein");if(Ge&&xe){const Pe=Date.now();Te(rt=>[...rt.slice(-10),{id:Pe,time:Pe}]),F(rt=>[...rt.slice(-5),{id:Pe,time:Pe,x:(Math.random()-.5)*.1,z:(Math.random()-.5)*.1}]),Qm(async()=>{const{SoundManager:rt}=await Promise.resolve().then(()=>K_);return{SoundManager:rt}},void 0).then(({SoundManager:rt})=>{rt.playDropSound()})}$.current=X}},[X,I?.id,v]),Lr(()=>{const Ge=Date.now();Te(xe=>xe.filter(Pe=>Ge-Pe.id<600)),F(xe=>xe.filter(Pe=>Ge-Pe.time<800))});const re=S===i;Lr((Ge,xe)=>{R&&n.current?(n.current.rotation.y-=xe*5,k(Me=>Math.min(Me+xe/4,1)),J(!0),q(0)):W&&!R&&U<1&&q(Me=>Math.min(Me+xe/2,1));const Pe=y?.temperature||25,rt=v.some(Me=>Me.chemical.id==="ice");if(Pe>50&&rt&&ce<1){const Me=Math.min(ce+xe*.125,1);K(Me),Me>=.95&&!ne&&(pe(!0),z&&De.getState().toggleBunsenBurner(),I?.id==="physical-chemical"&&setTimeout(()=>j(),500))}Re.length>0&&Te(Me=>Me.map(ze=>({...ze,time:ze.time+xe})).filter(ze=>ze.time<1.5))});const Ae=2,ie=.8,_e=y?.position||[0,0,0],ke=y?.capacity||500,Fe=y?.temperature||25,We=ge.useMemo(()=>v.reduce((Ge,xe)=>xe.chemical.id==="ice"?Ge+xe.volume:Ge,0),[v]),nt=ge.useMemo(()=>{const Ge=v.reduce((rt,Me)=>Me.chemical.id==="ice"?rt:rt+Me.volume,0),Pe=We*.4*ce;return Ge+Pe},[v,We,ce]),It=ge.useMemo(()=>nt===0?0:Math.min(nt/ke,1)*(Ae-.2),[nt,ke,Ae]),wt=ge.useMemo(()=>{if(We>0&&ce>0)return"#a8e4ff";if(v.length===0)return"#4fc3f7";const Ge=v.some(gn=>gn.chemical.id==="sodium-sulphate"),xe=v.some(gn=>gn.chemical.id==="barium-chloride");if(Ge&&!xe||Ge&&xe)return"#c8e0ff";if(I?.id==="neutralization"){if(De.getState().neutralizationComplete)return"#f5f5f5";const Pn=v.some(xi=>xi.chemical.id==="naoh"),Bi=v.some(xi=>xi.chemical.id==="phenolphthalein");if(Pn&&Bi){const xi=new fn("#ff69b4"),$n=new fn("#f5f5f5");let ii=0;return X>=5?ii=1:ii=X*.02,"#"+xi.clone().lerp($n,ii).getHexString()}}const Pe=v.some(gn=>gn.chemical.id==="phenolphthalein"),rt=v.some(gn=>gn.chemical.type==="base");if(Pe&&rt)return"#ff69b4";const Me=v.filter(gn=>gn.chemical.type!=="metal"&&gn.chemical.id!=="ice"&&gn.chemical.id!=="sand"&&gn.chemical.id!=="paper");if(Me.length===0)return"#4fc3f7";if(Me.length===1)return Me[0].chemical.color;const ze=Me.some(gn=>gn.chemical.id.includes("food_coloring_red")),Mt=Me.some(gn=>gn.chemical.id.includes("food_coloring_blue")),Rt=Me.some(gn=>gn.chemical.id.includes("food_coloring_yellow"));let se=null;if(ze&&Mt&&Rt?se=new fn("#5d4037"):ze&&Mt?se=new fn("#9b59b6"):Mt&&Rt?se=new fn("#2ecc71"):ze&&Rt&&(se=new fn("#f39c12")),se){const gn=Me.reduce((ii,wi)=>ii+(wi.chemical.id.includes("food_coloring")?wi.volume:0),0),Pn=Me.reduce((ii,wi)=>ii+wi.volume,0),Bi=gn/Pn,xi=new fn("#4fc3f7"),$n=Math.min(Bi*5,.9);return"#"+xi.lerp(se,$n).getHexString()}let Ve=0,vt=0,Dt=0,bn=0;Me.forEach(gn=>{const Pn=new fn(gn.chemical.color),Bi=gn.chemical.id.includes("food_coloring")||gn.chemical.id.includes("dye"),xi=gn.chemical.color==="#ffffff"||gn.chemical.color==="#f5f5f5";let $n=gn.volume;Bi&&($n*=20),xi&&($n*=.1),vt+=Pn.r*$n,Dt+=Pn.g*$n,bn+=Pn.b*$n,Ve+=$n}),Ve>0&&(vt/=Ve,Dt/=Ve,bn/=Ve);const dn=v.some(gn=>(gn.chemical.name?.toLowerCase().includes("salt")||gn.chemical.id==="salt")&&!gn.chemical.name?.toLowerCase().includes("solution"));if(D.includes("stir")&&!R&&dn){const gn=new fn("#e0f0ff");return"#"+new fn(vt,Dt,bn).lerp(gn,.7).getHexString()}return"#"+new fn(vt,Dt,bn).getHexString()},[v,D,R,We,ce,I,X]),Je=ge.useMemo(()=>v.some(Ge=>{const xe=Ge.chemical.name?.toLowerCase()||"",Pe=Ge.chemical.id?.toLowerCase()||"";return(xe.includes("salt")||Pe==="salt")&&!xe.includes("solution")}),[v]),le=ge.useMemo(()=>v.some(Ge=>{const xe=Ge.chemical.name?.toLowerCase()||"",Pe=Ge.chemical.id?.toLowerCase()||"";return xe.includes("sand")||Pe==="sand"}),[v]),Qe=ge.useMemo(()=>v.some(Ge=>Ge.chemical.id==="ice"),[v]),Et=ge.useMemo(()=>{const Ge=v.some(Pe=>Pe.chemical.id==="sodium-sulphate"),xe=v.some(Pe=>Pe.chemical.id==="barium-chloride");return Ge&&xe},[v]),we=ge.useMemo(()=>{const Ge=v.some(rt=>rt.chemical.id==="naoh"),xe=v.some(rt=>rt.chemical.id==="phenolphthalein"),Pe=v.some(rt=>rt.chemical.id==="hcl");return Ge&&xe&&Pe},[v]),ot=ge.useMemo(()=>Et||we?.25:.85,[Et,we]),Ct=Je||le,ht=ge.useMemo(()=>le?"#c4a465":"#ffffff",[Je,le]),xt=ge.useMemo(()=>{if(!Ct||It===0)return[];const Ge=[],xe=Pe=>{const rt=Math.sin(Pe*9999)*1e4;return rt-Math.floor(rt)};if(Je&&!le){if(G)return[];const Pe=100;for(let rt=0;rt<Pe;rt++){const Me=rt/Pe*Math.PI*2+xe(rt*7)*.5,ze=.15+xe(rt*13)*.35,Mt=R?.15+xe(rt*17)*(It*.6):.05+xe(rt*17)*.1;Ge.push([Math.cos(Me)*ze,Mt,Math.sin(Me)*ze])}}else if(le)for(let rt=0;rt<200;rt++){const Me=rt/200*Math.PI*2+xe(rt*7)*.5,ze=.15+xe(rt*13)*.4,Mt=.2+xe(rt*17)*(It*.5),Rt=.05+xe(rt*17)*.1;let se;R?se=Mt:se=Mt+(Rt-Mt)*U,Ge.push([Math.cos(Me)*ze,se,Math.sin(Me)*ze])}return Ge},[Ct,Je,le,It,R,G,L,U]),he=ge.useMemo(()=>Je&&!le&&R?.06*(1-L):Je?.06:.03,[Je,le,R,L]),Q=y?.tiltAngle||0,Be=Q*Math.PI/180,ue=ge.useCallback(Ge=>{Ge.stopPropagation(),T(i)},[i,T]),je=ge.useCallback(Ge=>{if(Ge.stopPropagation(),!re){T(i);return}if(I?.id==="salt-dissolution"||I?.id==="filtration"||I?.id==="physical-chemical"||!I||I.id==="double-displacement")return;const xe=Ge.shiftKey||Ge.nativeEvent?.shiftKey;c(xe),s(!0),d(Ge.clientY||Ge.nativeEvent?.clientY||0),Ge.target?.setPointerCapture&&Ge.pointerId!==void 0&&Ge.target.setPointerCapture(Ge.pointerId)},[re,i,T,I]),Ye=ge.useMemo(()=>new S0,[]),ft=ge.useMemo(()=>new nu(new Ee(0,1,0),0),[]),gt=ge.useCallback(Ge=>{if(!(!r||!re))if(Ge.stopPropagation(),l){const xe=g.domElement.getBoundingClientRect(),Pe=(Ge.clientX-xe.left)/xe.width*2-1,rt=-((Ge.clientY-xe.top)/xe.height)*2+1;Ye.setFromCamera(new zt(Pe,rt),m);const Me=new Ee;if(Ye.ray.intersectPlane(ft,Me),Me){const ze=Math.max(-4,Math.min(4,Me.x)),Mt=Math.max(-4,Math.min(4,Me.z)),Rt=0,se=2;Math.sqrt(Math.pow(ze-Rt,2)+Math.pow(Mt-se,2))<.8?w(i,[Rt,1,se]):w(i,[ze,0,Mt])}}else{const xe=Ge.clientY||Ge.nativeEvent?.clientY||0,Pe=f-xe,Me=Math.max(0,Math.min(70,Q+Pe*.5));A(i,Me),d(xe)}},[r,re,l,i,Q,A,w,f,m,g,Ye,ft]),Lt=ge.useCallback(Ge=>{r&&(Ge.stopPropagation(),s(!1),c(!1),Ge.target?.releasePointerCapture&&Ge.pointerId!==void 0&&Ge.target.releasePointerCapture(Ge.pointerId))},[r]);if(!y)return null;const un=Fe>50,bt=Fe>=100,dt=De(Ge=>Ge.isAutoPouring);return Lr((Ge,xe)=>{if(!t.current)return;const Pe=v.some(rt=>rt.chemical.id==="muddy-water");if(dt&&Pe){const rt=new Ee(1,2.6,0),Me=-Math.PI/2.2;t.current.position.lerp(rt,xe*4),t.current.rotation.z+=(Me-t.current.rotation.z)*xe*4}else if(!r&&!l){Math.abs(t.current.rotation.z)>.01&&(t.current.rotation.z+=(0-t.current.rotation.z)*xe*4);const rt=new Ee(_e[0],_e[1],_e[2]);t.current.position.distanceTo(rt)>.1&&t.current.position.lerp(rt,xe*4)}}),_.jsx("group",{ref:t,name:i,position:_e,children:_.jsxs("group",{rotation:[0,0,-Be],children:[un&&_.jsxs("mesh",{position:[0,.02,0],rotation:[-Math.PI/2,0,0],children:[_.jsx("circleGeometry",{args:[ie*1.2,32]}),_.jsx("meshBasicMaterial",{color:bt?"#ff4400":"#ff8800",transparent:!0,opacity:.3})]}),!Et&&_.jsxs(_.Fragment,{children:[_.jsxs("mesh",{ref:e,position:[0,Ae/2,0],onClick:ue,onPointerDown:je,onPointerMove:gt,onPointerUp:Lt,onPointerLeave:Lt,children:[_.jsx("cylinderGeometry",{args:[ie,ie*.9,Ae,32,1,!0]}),_.jsx("meshBasicMaterial",{color:re?"#aaffcc":un?"#ffccaa":"#c8e6f8",transparent:!0,opacity:re?.3:.2,side:Es,depthWrite:!1})]}),_.jsxs("mesh",{position:[0,.02,0],rotation:[-Math.PI/2,0,0],children:[_.jsx("circleGeometry",{args:[ie*.9,32]}),_.jsx("meshBasicMaterial",{color:"#c8e6f8",transparent:!0,opacity:.25,depthWrite:!1})]}),_.jsxs("mesh",{position:[0,Ae,0],rotation:[-Math.PI/2,0,0],children:[_.jsx("ringGeometry",{args:[ie-.05,ie+.02,32]}),_.jsx("meshBasicMaterial",{color:"#e0e0e0"})]}),[.25,.5,.75].map((Ge,xe)=>_.jsxs("mesh",{position:[ie-.02,Ge*Ae+.1,0],children:[_.jsx("boxGeometry",{args:[.15,.02,.01]}),_.jsx("meshBasicMaterial",{color:"#888888"})]},xe))]}),Et&&_.jsxs(_.Fragment,{children:[_.jsxs("mesh",{position:[0,Ae/2,0],renderOrder:-10,children:[_.jsx("cylinderGeometry",{args:[ie*.95,ie*.85,Ae,32,1,!0]}),_.jsx("meshBasicMaterial",{color:"#88ccee",transparent:!0,opacity:.08,side:2,depthWrite:!1})]}),_.jsxs("mesh",{position:[0,.02,0],rotation:[-Math.PI/2,0,0],renderOrder:-10,children:[_.jsx("ringGeometry",{args:[ie*.75,ie*.85,32]}),_.jsx("meshBasicMaterial",{color:"#88bbdd",transparent:!0,opacity:.2,depthWrite:!1})]}),_.jsxs("mesh",{position:[0,Ae,0],rotation:[-Math.PI/2,0,0],renderOrder:-10,children:[_.jsx("ringGeometry",{args:[ie*.9,ie*1,32]}),_.jsx("meshBasicMaterial",{color:"#aaddff",transparent:!0,opacity:.5,depthWrite:!1})]})]}),Q>30&&_.jsxs("mesh",{position:[-ie*.8,Ae+.1,0],children:[_.jsx("sphereGeometry",{args:[.1,12,12]}),_.jsx("meshBasicMaterial",{color:Q>45?"#ff4444":"#ffaa00"})]}),Qe&&ce<.95&&_.jsx("group",{position:[0,.05,0],children:_.jsx(fU,{scale:.8,melting:un})}),Et&&_.jsx(vU,{active:!0,beakerRadius:ie,liquidHeight:It}),It>0&&_.jsxs("group",{ref:n,children:[Et?_.jsxs("mesh",{position:[0,It+.05,0],rotation:[-Math.PI/2,0,0],renderOrder:-5,children:[_.jsx("circleGeometry",{args:[ie*.82,32]}),_.jsx("meshBasicMaterial",{color:wt,transparent:!0,opacity:.1,side:2,depthWrite:!1})]}):_.jsxs("mesh",{position:[0,It/2+.05,0],renderOrder:1,children:[_.jsx("cylinderGeometry",{args:[ie*.82,ie*.8,It,32]}),_.jsx("meshPhysicalMaterial",{color:wt,transparent:!0,transmission:.6,opacity:ot,roughness:.2,metalness:0,ior:1.33,thickness:.5})]}),Re.map(Ge=>{const xe=(Date.now()-Ge.id)/1e3;return _.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,It+.052,0],renderOrder:3,children:[_.jsx("ringGeometry",{args:[.05+xe*1.6,.15+xe*1.6,32]}),_.jsx("meshBasicMaterial",{color:"white",transparent:!0,opacity:Math.max(0,.4-xe*.3),side:Es})]},Ge.id)}),ee.map(Ge=>{const xe=(Date.now()-Ge.id)/1e3;return[0,1,2,3,4].map(Pe=>{const rt=Pe/5*Math.PI*2,Me=xe*.8,ze=Math.sin(xe*Math.PI)*.4;return _.jsxs("mesh",{position:[Ge.x+Math.cos(rt)*Me,It+ze+.06,Ge.z+Math.sin(rt)*Me],children:[_.jsx("sphereGeometry",{args:[.02*(1-xe),8,8]}),_.jsx("meshBasicMaterial",{color:"white",transparent:!0,opacity:1-xe})]},`${Ge.id}_${Pe}`)})}),xt.map((Ge,xe)=>_.jsxs("mesh",{position:Ge,renderOrder:10,children:[_.jsx("boxGeometry",{args:[he,he,he]}),_.jsx("meshBasicMaterial",{color:ht,transparent:!0,opacity:1,depthTest:!1,depthWrite:!1})]},xe))]})]})})}function yU({vesselId:i,rackSlot:e=0}){const t=ge.useRef(null),n=ge.useRef(null),[r,s]=ge.useState(!1),[l,c]=ge.useState(!1),[f,d]=ge.useState(0),{camera:m,gl:g}=da(),y=De($=>$.vessels.get(i)),v=De($=>$.vessels.get(i)?.currentVolume??0),S=De($=>$.vessels.get(i)?.contents??[]),T=De($=>$.selectedVesselId),A=De($=>$.selectVessel),w=De($=>$.updateVesselTilt),R=De($=>$.updateVesselPosition),D=T===i,I=1.8,z=.2,j=y?.position||[0,0,0],X=y?.capacity||50,G=y?.temperature||25,L=ge.useMemo(()=>v===0?0:v/X*(I-.3),[v,X,I]),k=ge.useMemo(()=>S.length===0?"#4fc3f7":S.reduce((re,Ae)=>Ae.volume>re.volume?Ae:re).chemical.color,[S]),U=y?.tiltAngle||0,q=U*Math.PI/180,W=ge.useCallback($=>{$.stopPropagation(),A(i)},[i,A]),J=ge.useCallback($=>{if($.stopPropagation(),!D){A(i);return}const re=$.shiftKey||$.nativeEvent?.shiftKey;c(re),s(!0),d($.clientY||$.nativeEvent?.clientY||0),$.target?.setPointerCapture&&$.pointerId!==void 0&&$.target.setPointerCapture($.pointerId)},[D,i,A]),ce=ge.useMemo(()=>new S0,[]),K=ge.useMemo(()=>new nu(new Ee(0,1,0),0),[]),ne=ge.useCallback($=>{if(!(!r||!D))if($.stopPropagation(),l){const re=g.domElement.getBoundingClientRect(),Ae=($.clientX-re.left)/re.width*2-1,ie=-(($.clientY-re.top)/re.height)*2+1;ce.setFromCamera(new zt(Ae,ie),m);const _e=new Ee;if(ce.ray.intersectPlane(K,_e),_e){const ke=Math.max(-4,Math.min(4,_e.x)),Fe=Math.max(-4,Math.min(4,_e.z)),We=0,nt=2;Math.sqrt(Math.pow(ke-We,2)+Math.pow(Fe-nt,2))<.8?R(i,[We,1,nt]):R(i,[ke,0,Fe])}}else{const re=$.clientY||$.nativeEvent?.clientY||0,Ae=f-re,_e=Math.max(0,Math.min(70,U+Ae*.5));w(i,_e),d(re)}},[r,D,l,i,U,w,R,f,m,g,ce,K]),pe=ge.useCallback($=>{r&&($.stopPropagation(),s(!1),c(!1),$.target?.releasePointerCapture&&$.pointerId!==void 0&&$.target.releasePointerCapture($.pointerId))},[r]);if(!y)return null;const Re=G>50,Te=ge.useRef(new fn("#4fc3f7")),ee=ge.useRef(null),F=ge.useRef(null);return Lr(($,re)=>{const Ae=new fn(k);Te.current.lerp(Ae,re*1.5),ee.current&&ee.current.material&&(ee.current.material.color=Te.current),F.current&&F.current.material&&(F.current.material.color=Te.current)}),_.jsx("group",{ref:n,position:j,children:_.jsxs("group",{rotation:[0,0,-q],children:[D&&_.jsxs("mesh",{position:[0,.01,0],rotation:[-Math.PI/2,0,0],children:[_.jsx("ringGeometry",{args:[z+.05,z+.12,16]}),_.jsx("meshBasicMaterial",{color:l?"#ffaa00":"#00ff88",transparent:!0,opacity:.9})]}),_.jsxs("mesh",{ref:t,position:[0,I/2,0],onClick:W,onPointerDown:J,onPointerMove:ne,onPointerUp:pe,onPointerLeave:pe,children:[_.jsx("cylinderGeometry",{args:[z,z,I,16,1,!0]}),_.jsx("meshBasicMaterial",{color:D?"#aaffcc":Re?"#ffccaa":"#c8e6f8",transparent:!0,opacity:D?.35:.25,side:Es,depthWrite:!1})]}),_.jsxs("mesh",{position:[0,.05,0],children:[_.jsx("sphereGeometry",{args:[z,16,8,0,Math.PI*2,0,Math.PI/2]}),_.jsx("meshBasicMaterial",{color:"#c8e6f8",transparent:!0,opacity:.25,side:Es,depthWrite:!1})]}),_.jsxs("mesh",{position:[0,I,0],rotation:[-Math.PI/2,0,0],children:[_.jsx("ringGeometry",{args:[z-.02,z+.03,16]}),_.jsx("meshBasicMaterial",{color:"#ffffff"})]}),L>0&&_.jsxs("mesh",{ref:ee,position:[0,L/2+.1,0],renderOrder:1,children:[_.jsx("cylinderGeometry",{args:[z*.92,z*.92,L,16]}),_.jsx("meshBasicMaterial",{color:k,transparent:!0,opacity:.6})]}),L>0&&_.jsxs("mesh",{ref:F,position:[0,L+.1,0],rotation:[-Math.PI/2,0,0],renderOrder:2,children:[_.jsx("circleGeometry",{args:[z*.92,16]}),_.jsx("meshBasicMaterial",{color:k,transparent:!0,opacity:.7})]})]})})}function bU({position:i}){const r="#5d4037";return _.jsxs("group",{position:i,children:[_.jsxs("mesh",{position:[0,.08,0],children:[_.jsx("boxGeometry",{args:[1.95,.16,.6]}),_.jsx("meshStandardMaterial",{color:r,roughness:.7})]}),_.jsxs("mesh",{position:[0,.85,0],children:[_.jsx("boxGeometry",{args:[1.95,.12,.6]}),_.jsx("meshStandardMaterial",{color:r,roughness:.7})]}),_.jsxs("mesh",{position:[-1.95/2+.15,.85/2,0],children:[_.jsx("boxGeometry",{args:[.2,.85,.6]}),_.jsx("meshStandardMaterial",{color:r,roughness:.7})]}),_.jsxs("mesh",{position:[1.95/2-.15,.85/2,0],children:[_.jsx("boxGeometry",{args:[.2,.85,.6]}),_.jsx("meshStandardMaterial",{color:r,roughness:.7})]}),[-.5,0,.5].map((l,c)=>_.jsxs("group",{position:[l,0,0],children:[_.jsxs("mesh",{position:[0,.85+.061,0],rotation:[-Math.PI/2,0,0],children:[_.jsx("circleGeometry",{args:[.22,32]}),_.jsx("meshStandardMaterial",{color:"#1a1a1a",roughness:.9})]}),_.jsxs("mesh",{position:[0,.85+.062,0],rotation:[-Math.PI/2,0,0],children:[_.jsx("ringGeometry",{args:[.22,.23,32]}),_.jsx("meshStandardMaterial",{color:"#3e2723"})]}),_.jsxs("mesh",{position:[0,.161,0],rotation:[-Math.PI/2,0,0],children:[_.jsx("circleGeometry",{args:[.2,32]}),_.jsx("meshStandardMaterial",{color:"#3e2723",roughness:.9})]})]},c))]})}function _U({position:i}){const e=ge.useRef(null),t=ge.useRef(null),n=ge.useRef(null),r=ge.useRef(null),s=De(A=>A.droppingState),l=De(A=>A.completeDroppingAnimation),c=De(A=>A.fillVessel),f=De(A=>A.addChemicalToExperiment),d=De(A=>A.checkExperimentReaction),[m,g]=ge.useState(!1),y=ge.useRef(0),v=ge.useMemo(()=>new g0({color:"#ffffff",metalness:0,roughness:1,transparent:!0,opacity:.15,depthWrite:!1}),[]),S=ge.useMemo(()=>new g0({color:"#222222",roughness:.9,metalness:.1}),[]),T=ge.useMemo(()=>new kf({color:s.color||"#e8f4fc"}),[s.color]);return ge.useEffect(()=>{s.active&&!m&&(g(!0),y.current=0)},[s.active]),Lr((A,w)=>{if(!m)return;if(y.current+=w*1.5,e.current){let D=0;y.current<.2&&(D=Math.sin(y.current*Math.PI*5)*.1),e.current.scale.set(1+D,1-D,1+D)}const R=(D,I,z)=>{if(D.current)if(y.current>=I&&y.current<=z){D.current.visible=!0;const j=(y.current-I)/(z-I),X=-.6,G=-2.2;D.current.position.y=X+(G-X)*(j*j);const L=1+j*.5;D.current.scale.set(1/L,L,1/L)}else D.current.visible=!1};if(R(t,.2,.5),R(n,.45,.75),R(r,.7,1),y.current>1){if(g(!1),y.current=0,s.chemicalId&&s.vesselId){const D=s.chemicalId,I=25,z={id:D,name:D,color:s.color,type:"indicator"};c(s.vesselId,z,I),f(D),setTimeout(()=>d(),100)}l()}}),_.jsx("group",{position:i,children:_.jsxs("group",{position:[0,2,0],children:[_.jsxs("mesh",{ref:e,position:[0,.65,0],children:[_.jsx("sphereGeometry",{args:[.16,24,24]}),_.jsx("primitive",{object:S})]}),_.jsxs("mesh",{position:[0,.48,0],children:[_.jsx("cylinderGeometry",{args:[.07,.07,.15,16]}),_.jsx("meshStandardMaterial",{color:"#cccccc",metalness:.8,roughness:.2})]}),_.jsxs("mesh",{position:[0,0,0],renderOrder:2,children:[_.jsx("latheGeometry",{args:[[new zt(.05,.45),new zt(.04,-.45),new zt(.015,-.75)],32]}),_.jsx("primitive",{object:v})]}),_.jsxs("mesh",{position:[0,0,0],renderOrder:1,children:[_.jsx("latheGeometry",{args:[[new zt(.042,.45),new zt(.032,-.45),new zt(.008,-.75)],32]}),_.jsx("primitive",{object:T})]}),_.jsxs("mesh",{ref:t,position:[0,-.6,0],visible:!1,children:[_.jsx("sphereGeometry",{args:[.07,12,12]}),_.jsx("primitive",{object:T})]}),_.jsxs("mesh",{ref:n,position:[0,-.6,0],visible:!1,children:[_.jsx("sphereGeometry",{args:[.07,12,12]}),_.jsx("primitive",{object:T})]}),_.jsxs("mesh",{ref:r,position:[0,-.6,0],visible:!1,children:[_.jsx("sphereGeometry",{args:[.07,12,12]}),_.jsx("primitive",{object:T})]})]})})}function SU({position:i}){const e=De(y=>y.placedApparatus),t=e.includes("funnel"),n=e.includes("filter-paper"),r=De(y=>y.experimentActions.includes("pour")),s=ge.useRef(null),l=ge.useRef(null),c=ge.useRef(null),f=ge.useRef(!1),d=ge.useRef(0),m=ge.useRef(null),g=120;return Lr((y,v)=>{const S=De.getState().pendingFiltrationVolume||0,T=De.getState().addFiltrate,A=De.getState().performExperimentAction,w=De.getState().checkExperimentReaction;if(S>.1){f.current=!0;const I=(De.getState().isPouringActive?12:20)*v;T(I);const z=Math.min(S/g,1);if(z>d.current&&(d.current=z),s.current){s.current.visible=!0;const j=Math.max(z,.2);s.current.scale.set(.9*j,j,.9*j),s.current.position.y=-.51+.6*j}}if(l.current&&m.current&&d.current>0){S>.1&&(l.current.opacity=Math.min(l.current.opacity+v*.2,.9));const R=Math.max(d.current,.15);m.current.scale.set(.88*R,R,.88*R),m.current.position.y=-.51+.6*R,m.current.visible=!0}if(S>.1)c.current&&(c.current.visible=!0,c.current.children.forEach((R,D)=>{const I=R;I.position.y-=v*3,I.position.y<-2.5&&(I.position.y=-.9-Math.random()*.2,I.visible=!0)}));else if(s.current&&s.current.visible&&(s.current.visible=!1),c.current&&c.current.visible&&(c.current.visible=!1),f.current){f.current=!1;const R=De.getState().vessels,D=Array.from(R.values()).filter(z=>z.type==="beaker"&&z.id!=="collection_beaker");let I=0;D.forEach(z=>I+=z.currentVolume),I<5&&(A("filter"),w())}}),t?_.jsxs("group",{position:i,children:[_.jsxs("group",{position:[0,1.5,0],children:[_.jsxs("mesh",{rotation:[Math.PI,0,0],children:[_.jsx("coneGeometry",{args:[1,1.2,32,1,!0]}),_.jsx("meshBasicMaterial",{color:"#c8e6f8",transparent:!0,opacity:.6,side:Es,depthWrite:!1})]}),_.jsxs("mesh",{position:[0,.6,0],rotation:[-Math.PI/2,0,0],children:[_.jsx("ringGeometry",{args:[.95,1.05,32]}),_.jsx("meshBasicMaterial",{color:"#e0e0e0",side:Es})]}),_.jsxs("mesh",{position:[0,-.9,0],children:[_.jsx("cylinderGeometry",{args:[.08,.08,1,16]}),_.jsx("meshBasicMaterial",{color:"#c8e6f8",transparent:!0,opacity:.4,depthWrite:!1})]}),n&&_.jsxs("group",{children:[_.jsxs("mesh",{position:[0,.05,0],scale:[.95,.95,.95],rotation:[Math.PI,0,0],children:[_.jsx("coneGeometry",{args:[1,1.2,32,1,!0]}),_.jsx("meshBasicMaterial",{color:"#ffffff",side:Es,transparent:!0,opacity:.4,depthWrite:!1})]}),_.jsxs("mesh",{ref:s,position:[0,0,0],rotation:[Math.PI,0,0],visible:!1,children:[_.jsx("coneGeometry",{args:[.92,1.12,32,1]}),_.jsx("meshBasicMaterial",{color:"#8b7355"})]}),_.jsx("group",{children:_.jsxs("mesh",{ref:m,position:[0,.06,0],scale:[0,0,0],rotation:[Math.PI,0,0],visible:!1,children:[_.jsx("coneGeometry",{args:[.96,1.18,32,1,!0]}),_.jsx("meshBasicMaterial",{ref:l,color:"#5d4037",side:Es})]})})]}),_.jsx("group",{ref:c,visible:!1,children:[...Array(8)].map((y,v)=>_.jsxs("mesh",{position:[0,-.9-v*.4,0],scale:[.8,.8,.8],children:[_.jsx("sphereGeometry",{args:[.05,8,8]}),_.jsx("meshBasicMaterial",{color:"#c8e0ff"})]},v))})]}),t&&!n&&_.jsx(fd,{position:[0,2,0],center:!0,children:_.jsx("div",{className:"text-xs text-white bg-black/60 px-2 py-1 rounded backdrop-blur-sm whitespace-nowrap border border-white/20 select-none pointer-events-none",children:"Add Filter Paper"})}),n&&!r&&_.jsx(fd,{position:[0,2,0],center:!0,children:_.jsx("div",{className:"text-xs text-white bg-black/60 px-2 py-1 rounded backdrop-blur-sm whitespace-nowrap border border-white/20 select-none pointer-events-none",children:"Pour from Beaker"})})]}):null}function wU({vesselId:i}){const e=ge.useRef(null),t=ge.useRef(null),[n,r]=ge.useState(!1),[s,l]=ge.useState(!1),[c,f]=ge.useState(0),{camera:d,gl:m}=da(),g=De(Te=>Te.vessels.get(i)),y=De(Te=>Te.vessels.get(i)?.currentVolume??0),v=De(Te=>Te.vessels.get(i)?.contents??[]),S=De(Te=>Te.selectedVesselId),T=De(Te=>Te.selectVessel),A=De(Te=>Te.updateVesselTilt),w=De(Te=>Te.updateVesselPosition),R=S===i,D=1.8,I=.6,z=.15,j=g?.position||[0,0,0],X=g?.capacity||250,G=g?.temperature||25,L=ge.useMemo(()=>y===0?0:y/X*(D*.6),[y,X,D]),k=ge.useMemo(()=>v.length===0?"#4fc3f7":v.reduce((ee,F)=>F.volume>ee.volume?F:ee).chemical.color,[v]),U=g?.tiltAngle||0,q=U*Math.PI/180,W=ge.useCallback(Te=>{Te.stopPropagation(),T(i)},[i,T]),J=ge.useCallback(Te=>{if(Te.stopPropagation(),!R){T(i);return}const ee=Te.shiftKey||Te.nativeEvent?.shiftKey;l(ee),r(!0),f(Te.clientY||Te.nativeEvent?.clientY||0),Te.target?.setPointerCapture&&Te.pointerId!==void 0&&Te.target.setPointerCapture(Te.pointerId)},[R,i,T]),ce=ge.useMemo(()=>new S0,[]),K=ge.useMemo(()=>new nu(new Ee(0,1,0),0),[]),ne=ge.useCallback(Te=>{if(!(!n||!R))if(Te.stopPropagation(),s){const ee=m.domElement.getBoundingClientRect(),F=(Te.clientX-ee.left)/ee.width*2-1,$=-((Te.clientY-ee.top)/ee.height)*2+1;ce.setFromCamera(new zt(F,$),d);const re=new Ee;if(ce.ray.intersectPlane(K,re),re){const Ae=Math.max(-4,Math.min(4,re.x)),ie=Math.max(-4,Math.min(4,re.z)),_e=0,ke=2;Math.sqrt(Math.pow(Ae-_e,2)+Math.pow(ie-ke,2))<.8?w(i,[_e,1,ke]):w(i,[Ae,0,ie])}}else{const ee=Te.clientY||Te.nativeEvent?.clientY||0,F=c-ee,re=Math.max(0,Math.min(70,U+F*.5));A(i,re),f(ee)}},[n,R,s,i,U,A,w,c,d,m,ce,K]),pe=ge.useCallback(Te=>{n&&(Te.stopPropagation(),r(!1),l(!1),Te.target?.releasePointerCapture&&Te.pointerId!==void 0&&Te.target.releasePointerCapture(Te.pointerId))},[n]);if(!g)return null;const Re=G>50;return _.jsx("group",{ref:t,position:j,children:_.jsxs("group",{rotation:[0,0,-q],children:[R&&_.jsxs("mesh",{position:[0,.01,0],rotation:[-Math.PI/2,0,0],children:[_.jsx("ringGeometry",{args:[I+.05,I+.15,24]}),_.jsx("meshBasicMaterial",{color:s?"#ffaa00":"#00ff88",transparent:!0,opacity:.9})]}),_.jsxs("mesh",{ref:e,position:[0,D*.35,0],onClick:W,onPointerDown:J,onPointerMove:ne,onPointerUp:pe,onPointerLeave:pe,children:[_.jsx("cylinderGeometry",{args:[z,I,D*.7,24,1,!0]}),_.jsx("meshBasicMaterial",{color:R?"#aaffcc":Re?"#ffccaa":"#c8e6f8",transparent:!0,opacity:R?.3:.2,side:Es,depthWrite:!1})]}),_.jsxs("mesh",{position:[0,D*.8,0],children:[_.jsx("cylinderGeometry",{args:[z,z,D*.25,16,1,!0]}),_.jsx("meshBasicMaterial",{color:"#c8e6f8",transparent:!0,opacity:.25,side:Es,depthWrite:!1})]}),_.jsxs("mesh",{position:[0,.02,0],rotation:[-Math.PI/2,0,0],children:[_.jsx("circleGeometry",{args:[I,24]}),_.jsx("meshBasicMaterial",{color:"#c8e6f8",transparent:!0,opacity:.2,depthWrite:!1})]}),_.jsxs("mesh",{position:[0,D*.92,0],rotation:[-Math.PI/2,0,0],children:[_.jsx("ringGeometry",{args:[z-.02,z+.02,16]}),_.jsx("meshBasicMaterial",{color:"#ffffff"})]}),L>0&&_.jsxs(_.Fragment,{children:[_.jsxs("mesh",{position:[0,L/2+.05,0],renderOrder:1,children:[_.jsx("cylinderGeometry",{args:[I*.5*(1-L/D),I*.85,L,24]}),_.jsx("meshBasicMaterial",{color:k,transparent:!0,opacity:.85})]}),_.jsxs("mesh",{position:[0,L+.05,0],rotation:[-Math.PI/2,0,0],renderOrder:2,children:[_.jsx("circleGeometry",{args:[I*.85*(1-L/D/2),24]}),_.jsx("meshBasicMaterial",{color:k,transparent:!0,opacity:.95})]})]})]})})}const mM=45,MU=5,AU=.825;function TU(){const{scene:i}=da(),e=ge.useRef(0),t=De(f=>f.vessels),n=De(f=>f.transferLiquid),r=De(f=>f.setPouringState),s=De(f=>f.isPouringActive),l=De(f=>f.pouringSourceId),c=De(f=>f.pouringTargetId);return Lr((f,d)=>{const m=performance.now();if(m-e.current<16)return;e.current=m;const g=Array.from(t.values());let y=!1;for(const v of g){const S=i.getObjectByName(v.id);if(!S)continue;const T=Math.abs(S.rotation.z*(180/Math.PI));if(T<mM||v.currentVolume<=0)continue;const A=S.position;for(const w of g){if(w.id===v.id)continue;const R=i.getObjectByName(w.id),D=R?R.position:new Ee(...w.position);if(A.distanceTo(D)<MU){if(w.currentVolume>=w.capacity)continue;const z=D.x-A.x;if(z>-3&&z<3){(!s||l!==v.id||c!==w.id)&&(r(!0,v.id,w.id),$s.playPour("pouring"));const j=Math.min((T-mM)/45,1),X=AU*j*d*60;n(v.id,w.id,X),y=!0;break}}}if(y)break}!y&&s&&(r(!1),$s.stopSound("pouring"))}),null}function EU({vesselId:i,startTime:e,duration:t}){const n=De(d=>d.vessels.get(i)),r=ge.useRef([]),s=ge.useRef(null),l=ge.useRef(0),c=50;ge.useMemo(()=>{r.current=Array.from({length:c},()=>({position:new Ee((Math.random()-.5)*1.2,Math.random()*.3,(Math.random()-.5)*1.2),velocity:new Ee((Math.random()-.5)*.008,.015+Math.random()*.025,(Math.random()-.5)*.008),baseSize:.02+Math.random()*.06,phase:Math.random()*Math.PI*2,wobbleSpeed:2+Math.random()*3,wobbleAmount:.01+Math.random()*.02}))},[i]);const f=ge.useMemo(()=>new Oi,[]);return Lr((d,m)=>{if(!s.current||!n)return;l.current+=m;const y=(Date.now()-e)/t;let v=1;y<.1?v=y/.1:y>.8&&(v=1-(y-.8)/.2),r.current.forEach((S,T)=>{S.position.add(S.velocity);const A=Math.sin(l.current*S.wobbleSpeed+S.phase)*S.wobbleAmount,w=Math.cos(l.current*S.wobbleSpeed+S.phase+1)*S.wobbleAmount;S.position.x+=A,S.position.z+=w,S.position.y>2.5&&(S.position.set((Math.random()-.5)*1,.1+Math.random()*.2,(Math.random()-.5)*1),S.velocity.y=.015+Math.random()*.025,S.baseSize=.02+Math.random()*.06);const R=S.position.y/2.5,D=R<.7?1+R*.3:1.3-(R-.7)*2,I=S.baseSize*D*v;f.position.set(S.position.x,S.position.y,S.position.z),f.scale.setScalar(Math.max(.001,I)),f.updateMatrix(),s.current.setMatrixAt(T,f.matrix)}),s.current.instanceMatrix.needsUpdate=!0}),n?_.jsx("group",{position:n.position,children:_.jsxs("instancedMesh",{ref:s,args:[void 0,void 0,c],children:[_.jsx("sphereGeometry",{args:[1,12,12]}),_.jsx("meshPhysicalMaterial",{color:"#ffffff",transparent:!0,opacity:.5,roughness:0,metalness:0,transmission:.9,thickness:.5,ior:1.33})]})}):null}function CU({vesselId:i,startTime:e,duration:t}){const n=De(m=>m.vessels.get(i)),r=ge.useRef([]),s=ge.useRef(null),l=ge.useRef(null),c=ge.useRef(0),f=35;ge.useMemo(()=>{r.current=Array.from({length:f},()=>({position:new Ee((Math.random()-.5)*.8,Math.random()*.5,(Math.random()-.5)*.8),velocity:new Ee(0,.02+Math.random()*.03,0),life:Math.random(),maxLife:.8+Math.random()*.4,rotationSpeed:(Math.random()-.5)*4,spiralRadius:.1+Math.random()*.3}))},[i]);const d=ge.useMemo(()=>new Oi,[]);return Lr((m,g)=>{if(!s.current||!n)return;c.current+=g;const v=(Date.now()-e)/t;let S=1;if(v<.1?S=v/.1:v>.75&&(S=1-(v-.75)/.25),l.current){const T=Math.sin(c.current*8)*.3+.7;l.current.intensity=3*T*S}r.current.forEach((T,A)=>{T.life+=g/T.maxLife;const w=c.current*T.rotationSpeed+A,R=Math.cos(w)*T.spiralRadius*(1-T.life*.5),D=Math.sin(w)*T.spiralRadius*(1-T.life*.5);T.position.y+=T.velocity.y,(T.life>=1||T.position.y>3)&&(T.position.set((Math.random()-.5)*.6,.2+Math.random()*.3,(Math.random()-.5)*.6),T.life=0,T.velocity.y=.02+Math.random()*.03,T.spiralRadius=.1+Math.random()*.3);const z=.06*(T.life<.3?T.life/.3:1-(T.life-.3)/.7)*S;d.position.set(T.position.x+R,T.position.y,T.position.z+D),d.scale.setScalar(Math.max(.001,z)),d.updateMatrix(),s.current.setMatrixAt(A,d.matrix)}),s.current.instanceMatrix.needsUpdate=!0}),n?_.jsxs("group",{position:n.position,children:[_.jsxs("instancedMesh",{ref:s,args:[void 0,void 0,f],children:[_.jsx("sphereGeometry",{args:[1,8,8]}),_.jsx("meshBasicMaterial",{color:"#ff6b35",transparent:!0,opacity:.85})]}),_.jsxs("instancedMesh",{args:[void 0,void 0,15],children:[_.jsx("sphereGeometry",{args:[.03,6,6]}),_.jsx("meshBasicMaterial",{color:"#ffcc00",transparent:!0,opacity:.9})]}),_.jsx("pointLight",{ref:l,position:[0,1,0],color:"#ff4400",intensity:3,distance:4,decay:2}),_.jsx("pointLight",{position:[0,.5,0],color:"#ff8800",intensity:1.5,distance:2,decay:2})]}):null}function NU({vesselId:i,startTime:e,duration:t}){const n=De(d=>d.vessels.get(i)),r=ge.useRef([]),s=ge.useRef(null),l=ge.useRef(0),c=25;ge.useMemo(()=>{r.current=Array.from({length:c},()=>({position:new Ee((Math.random()-.5)*.6,1.5+Math.random()*.5,(Math.random()-.5)*.6),velocity:new Ee((Math.random()-.5)*.005,.01+Math.random()*.01,(Math.random()-.5)*.005),life:Math.random(),size:.05+Math.random()*.08}))},[i]);const f=ge.useMemo(()=>new Oi,[]);return Lr((d,m)=>{if(!s.current||!n)return;l.current+=m;const y=(Date.now()-e)/t,v=y>.8?1-(y-.8)/.2:1;r.current.forEach((S,T)=>{S.position.add(S.velocity),S.life+=.008,S.position.x+=Math.sin(l.current+T)*.002,(S.life>=1||S.position.y>4)&&(S.position.set((Math.random()-.5)*.5,1.5,(Math.random()-.5)*.5),S.life=0);const A=S.size*(1-S.life*.5)*v;f.position.copy(S.position),f.scale.setScalar(Math.max(.001,A)),f.updateMatrix(),s.current.setMatrixAt(T,f.matrix)}),s.current.instanceMatrix.needsUpdate=!0}),n?_.jsx("group",{position:n.position,children:_.jsxs("instancedMesh",{ref:s,args:[void 0,void 0,c],children:[_.jsx("sphereGeometry",{args:[1,8,8]}),_.jsx("meshBasicMaterial",{color:"#dddddd",transparent:!0,opacity:.3})]})}):null}function RU({vesselId:i,startTime:e,duration:t}){const n=De(f=>f.vessels.get(i)),r=ge.useRef([]),s=ge.useRef(null),l=30;ge.useMemo(()=>{r.current=Array.from({length:l},()=>({position:new Ee((Math.random()-.5)*.6,.1+Math.random()*.5,(Math.random()-.5)*.6),velocity:new Ee((Math.random()-.5)*.01,.02+Math.random()*.03,(Math.random()-.5)*.01),size:.02+Math.random()*.04}))},[i]);const c=ge.useMemo(()=>new Oi,[]);return Lr(()=>{if(!s.current||!n)return;const d=(Date.now()-e)/t,m=d>.8?1-(d-.8)/.2:1,g=n.currentVolume/n.capacity*1.8;r.current.forEach((y,v)=>{y.position.add(y.velocity),y.position.y>g&&(y.position.set((Math.random()-.5)*.5,.1,(Math.random()-.5)*.5),y.velocity.y=.02+Math.random()*.03);const S=y.size*m;c.position.copy(y.position),c.scale.setScalar(Math.max(.001,S)),c.updateMatrix(),s.current.setMatrixAt(v,c.matrix)}),s.current.instanceMatrix.needsUpdate=!0}),n?_.jsx("group",{position:n.position,children:_.jsxs("instancedMesh",{ref:s,args:[void 0,void 0,l],children:[_.jsx("sphereGeometry",{args:[1,6,6]}),_.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:.6})]})}):null}function LU({vesselId:i,startTime:e,duration:t}){const n=De(f=>f.vessels.get(i)),r=ge.useRef([]),s=ge.useRef(null),l=40;ge.useMemo(()=>{r.current=Array.from({length:l},()=>({position:new Ee((Math.random()-.5)*.8,.5+Math.random()*1,(Math.random()-.5)*.8),velocity:new Ee((Math.random()-.5)*.002,-.005-Math.random()*.01,(Math.random()-.5)*.002),size:.02+Math.random()*.03,settled:!1}))},[i]);const c=ge.useMemo(()=>new Oi,[]);return Lr(()=>{if(!s.current||!n)return;const d=(Date.now()-e)/t,m=Math.min(1,d*3);r.current.forEach((g,y)=>{g.settled||(g.position.add(g.velocity),g.position.x+=Math.sin(Date.now()*.002+y)*.001,g.position.y<=.15&&(g.position.y=.1+Math.random()*.1,g.settled=!0));const v=g.size*m;c.position.copy(g.position),c.scale.setScalar(Math.max(.001,v)),c.updateMatrix(),s.current.setMatrixAt(y,c.matrix)}),s.current.instanceMatrix.needsUpdate=!0}),n?_.jsx("group",{position:n.position,children:_.jsxs("instancedMesh",{ref:s,args:[void 0,void 0,l],children:[_.jsx("sphereGeometry",{args:[1,6,6]}),_.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:.9})]})}):null}function gM({vesselId:i,startTime:e,duration:t,isMassive:n=!1}){const r=De(g=>g.vessels.get(i)),s=ge.useRef([]),l=ge.useRef(null),c=ge.useRef(0),f=n?120:60;ge.useMemo(()=>{s.current=Array.from({length:f},()=>({position:new Ee((Math.random()-.5)*.8,.5+Math.random()*.5,(Math.random()-.5)*.8),velocity:new Ee((Math.random()-.5)*(n?.03:.015),(n?.06:.03)+Math.random()*(n?.06:.04),(Math.random()-.5)*(n?.03:.015)),size:(n?.06:.04)+Math.random()*(n?.12:.08),life:Math.random()}))},[i,n]);const d=ge.useMemo(()=>new Oi,[]);Lr((g,y)=>{if(!l.current||!r)return;c.current+=y;const S=(Date.now()-e)/t;let T=1;S<.2?T=S/.2:S>.7&&(T=1-(S-.7)/.3),s.current.forEach((A,w)=>{A.position.add(A.velocity),A.life+=y*.5;const R=Math.max(0,A.position.y-.5)*(n?.04:.02);A.position.x+=(A.position.x>0?1:-1)*R*y,A.position.z+=(A.position.z>0?1:-1)*R*y,A.position.x+=Math.sin(c.current*5+w)*.002,A.position.z+=Math.cos(c.current*5+w*.5)*.002;const D=n?5:3.5;(A.position.y>D||A.life>1)&&(A.position.set((Math.random()-.5)*.5,.3+Math.random()*.3,(Math.random()-.5)*.5),A.velocity.y=(n?.06:.03)+Math.random()*(n?.06:.04),A.life=0);const I=A.size*T*(1-A.life*.3);d.position.copy(A.position),d.scale.setScalar(Math.max(.001,I)),d.updateMatrix(),l.current.setMatrixAt(w,d.matrix)}),l.current.instanceMatrix.needsUpdate=!0});const m=ge.useMemo(()=>{if(!r)return"#fffef0";const g=r.contents.filter(A=>A.chemical.id.includes("food_coloring")||A.chemical.id.includes("dye"));if(g.length===0)return"#fffef0";if(g.length===1)return g[0].chemical.color;const y=g.some(A=>A.chemical.id.includes("red")),v=g.some(A=>A.chemical.id.includes("blue")),S=g.some(A=>A.chemical.id.includes("yellow"));if(y&&v&&S)return"#5d4037";if(y&&v)return"#9b59b6";if(v&&S)return"#2ecc71";if(y&&S)return"#f39c12";const T=new fn(0,0,0);return g.forEach(A=>{const w=new fn(A.chemical.color);T.r+=w.r,T.g+=w.g,T.b+=w.b}),T.r/=g.length,T.g/=g.length,T.b/=g.length,"#"+T.getHexString()},[r]);return r?_.jsxs("group",{position:r.position,children:[_.jsxs("instancedMesh",{ref:l,args:[void 0,void 0,f],children:[_.jsx("sphereGeometry",{args:[1,8,8]}),_.jsx("meshStandardMaterial",{color:m,transparent:!0,opacity:.85,roughness:.3})]}),_.jsx("pointLight",{position:[0,1.5,0],color:m,intensity:2,distance:3,decay:2})]}):null}function PU({effect:i}){if(Date.now()-i.startTime>=i.duration)return null;switch(i.type){case"bubbles":return _.jsx(EU,{vesselId:i.vesselId,startTime:i.startTime,duration:i.duration});case"heat":return _.jsx(CU,{vesselId:i.vesselId,startTime:i.startTime,duration:i.duration});case"steam":return _.jsx(NU,{vesselId:i.vesselId,startTime:i.startTime,duration:i.duration});case"boiling":return _.jsx(RU,{vesselId:i.vesselId,startTime:i.startTime,duration:i.duration});case"precipitate":return _.jsx(LU,{vesselId:i.vesselId,startTime:i.startTime,duration:i.duration});case"foam":return _.jsx(gM,{vesselId:i.vesselId,startTime:i.startTime,duration:i.duration});case"massive_foam":return _.jsx(gM,{vesselId:i.vesselId,startTime:i.startTime,duration:i.duration,isMassive:!0});default:return null}}function IU(){const i=De(t=>t.activeEffects),e=De(t=>t.clearExpiredEffects);return Lr(()=>{e()}),_.jsx(_.Fragment,{children:i.map(t=>_.jsx(PU,{effect:t},t.id))})}function DU(){const i=ge.useRef(null),e=De(d=>d.isStirring),t=De(d=>d.placedApparatus),n=De(d=>d.vessels),r=t.includes("glass-rod"),l=Array.from(n.values()).find(d=>d.type==="beaker"&&d.id!=="collection_beaker")?.position||[0,0,0];if(Lr(d=>{if(i.current&&e){const m=d.clock.elapsedTime,g=.2,y=4;i.current.position.x=l[0]+Math.cos(m*y)*g,i.current.position.y=l[1]+.8,i.current.position.z=l[2]+Math.sin(m*y)*g,i.current.rotation.x=Math.sin(m*y)*.15,i.current.rotation.z=Math.cos(m*y)*.15}else i.current&&r&&(i.current.position.x=l[0]+.25,i.current.position.y=l[1]+.6,i.current.position.z=l[2],i.current.rotation.x=0,i.current.rotation.z=.4)}),!r&&!e)return null;const c=2.5,f=.04;return _.jsxs("group",{ref:i,position:[l[0]+.25,l[1]+.6,l[2]],rotation:[0,0,.4],children:[_.jsxs("mesh",{position:[0,c/2-.5,0],children:[_.jsx("cylinderGeometry",{args:[f,f,c,16]}),_.jsx("meshStandardMaterial",{color:"#e8e8e8",transparent:!0,opacity:.7,roughness:.1,metalness:.3})]}),_.jsxs("mesh",{position:[0,-.5,0],children:[_.jsx("sphereGeometry",{args:[f*1.3,12,12]}),_.jsx("meshStandardMaterial",{color:"#d0d0d0",transparent:!0,opacity:.8,roughness:.1})]}),_.jsxs("mesh",{position:[0,c-.5,0],children:[_.jsx("sphereGeometry",{args:[f*1.2,12,12]}),_.jsx("meshStandardMaterial",{color:"#f0f0f0",transparent:!0,opacity:.9})]})]})}function kU({position:i=[0,1.1,2]}){const e=De(U=>U.addedChemicals),t=De(U=>U.bunsenBurnerOn),n=De(U=>U.setDishCracked),r=ge.useRef(null),[s,l]=ge.useState(0),c=e.includes("salt-solution"),f=t&&c,[d,m]=ge.useState(!1),[g,y]=ge.useState(!1),v=ge.useRef(0),S=5,T=De(U=>U.performExperimentAction),A=De(U=>U.checkExperimentReaction),w=30,R=4,D=ge.useRef([]),I=ge.useRef(0),[z]=ge.useState(()=>{const U=Array.from({length:R},()=>.5+Math.random()),q=U.reduce((J,ce)=>J+ce,0);let W=0;return U.map(J=>{const ce=J/q*Math.PI*2,K=W,ne=K+ce/2;return W+=ce,{startOffset:K,arcLength:ce,midAngle:ne}})}),j=ge.useRef([]);ge.useMemo(()=>{j.current=Array.from({length:w},()=>({position:new Ee((Math.random()-.5)*.4,.1+Math.random()*.3,(Math.random()-.5)*.4),velocity:new Ee((Math.random()-.5)*.02,.04+Math.random()*.03,(Math.random()-.5)*.02),life:Math.random()}))},[]);const X=ge.useMemo(()=>new Oi,[]),G=()=>{try{const U=window.AudioContext||window.webkitAudioContext;if(!U)return;const q=new U,W=q.sampleRate*.4,J=q.createBuffer(1,W,q.sampleRate),ce=J.getChannelData(0);for(let Re=0;Re<W;Re++)ce[Re]=Math.random()*2-1;const K=q.createBufferSource();K.buffer=J;const ne=q.createBiquadFilter();ne.type="highpass",ne.frequency.value=1500;const pe=q.createGain();pe.gain.setValueAtTime(.8,q.currentTime),pe.gain.exponentialRampToValueAtTime(.01,q.currentTime+.3),K.connect(ne),ne.connect(pe),pe.connect(q.destination),K.start()}catch(U){console.error("Audio playback failed",U)}},L=De(U=>U.toggleBunsenBurner);Lr((U,q)=>{if(t&&!g&&(!c||d?(v.current+=q,v.current>S&&(y(!0),n(!0),G(),setTimeout(()=>{$s.playWarning(),De.getState().showSafetyWarning("Oops! Thermal Shock! ",`The dish got too hot and CRACKED! 

Always keep some liquid inside to keep it safe. `)},2500),De.getState().bunsenBurnerOn&&L())):v.current=0),g&&(I.current=xp.lerp(I.current,.03,q*5),D.current.forEach((W,J)=>{if(W){const ce=z[J];W.position.set(Math.cos(ce.midAngle)*I.current,0,Math.sin(ce.midAngle)*I.current)}})),f&&!d&&!g&&l(W=>{const J=Math.min(W+q/8,1);return J>=1&&!d&&(m(!0),v.current=0,setTimeout(()=>{T("heat"),T("evaporate"),De.getState().bunsenBurnerOn&&L(),setTimeout(()=>A(),100)},2e3)),J}),r.current)if(!f||d||k<=.05||g){r.current.visible=!1;return}else r.current.visible=!0;!r.current||!f||d||g||(j.current.forEach((W,J)=>{W.life+=q*.5,W.position.add(W.velocity.clone().multiplyScalar(q*20)),W.life>=1&&(W.position.set((Math.random()-.5)*.4,.2,(Math.random()-.5)*.4),W.life=0);const ce=.06*(1-W.life*.5);X.position.copy(W.position),X.scale.setScalar(Math.max(.001,ce)),X.updateMatrix(),r.current.setMatrixAt(J,X.matrix)}),r.current.instanceMatrix.needsUpdate=!0)});const k=1-s;return _.jsxs("group",{position:i,children:[!g&&_.jsxs(_.Fragment,{children:[_.jsxs("mesh",{position:[0,.025,0],children:[_.jsx("cylinderGeometry",{args:[.5,.42,.05,32]}),_.jsx("meshStandardMaterial",{color:"#5d4037",roughness:.4,metalness:.1})]}),_.jsxs("mesh",{position:[0,.05,0],rotation:[Math.PI/2,0,0],children:[_.jsx("torusGeometry",{args:[.5,.025,16,50]}),_.jsx("meshStandardMaterial",{color:"#5d4037",roughness:.4})]})]}),!g&&_.jsxs("mesh",{position:[0,.051,0],rotation:[-Math.PI/2,0,0],children:[_.jsx("circleGeometry",{args:[.5,32]}),_.jsx("meshStandardMaterial",{color:"#5d4037",roughness:.4,metalness:.1})]}),!g&&c&&k>.01&&_.jsxs("mesh",{position:[0,.05+.005*k,0],scale:[1,k,1],children:[_.jsx("cylinderGeometry",{args:[.47,.47,.01,32]}),_.jsx("meshStandardMaterial",{color:"#aaddff",transparent:!0,opacity:.1+.5*k,roughness:.02,metalness:.1})]}),!g&&(c||d)&&_.jsx("group",{position:[0,.052,0],children:Array.from({length:150}).map((U,q)=>{const W=Math.sin(q*12.9898)*43758.5453,J=Math.cos(q*78.233)*43758.5453,ce=Math.sin(q*37.719)*43758.5453,K=Math.abs(W-Math.floor(W)),ne=Math.abs(J-Math.floor(J)),pe=Math.abs(ce-Math.floor(ce)),Re=K*.45,Te=ne*Math.PI*2,ee=.01+pe*.02,F=q%3,$=d?1:Math.max(0,(s-.6)*2.5);return $<=0?null:_.jsxs("mesh",{position:[Re*Math.cos(Te),ee/2,Re*Math.sin(Te)],rotation:[pe*Math.PI,K*Math.PI,ne*Math.PI],scale:[$,$,$],children:[F===0&&_.jsx("boxGeometry",{args:[ee,ee,ee]}),F===1&&_.jsx("tetrahedronGeometry",{args:[ee*.8]}),F===2&&_.jsx("dodecahedronGeometry",{args:[ee*.6]}),_.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.2,metalness:.1,emissive:"#eeeeee",emissiveIntensity:.1*$,transparent:!0,opacity:$})]},q)})}),f&&!d&&k>.05&&_.jsx("group",{position:[0,.15,0],children:_.jsxs("instancedMesh",{ref:r,args:[void 0,void 0,w],children:[_.jsx("sphereGeometry",{args:[1,8,8]}),_.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:.4})]})}),g&&z.map((U,q)=>_.jsx("group",{ref:W=>{W&&(D.current[q]=W)},rotation:[0,U.startOffset,0],children:_.jsxs("group",{position:[0,0,0],children:[_.jsxs("mesh",{position:[0,.025,0],children:[_.jsx("cylinderGeometry",{args:[.5,.42,.05,16,1,!1,0,U.arcLength]}),_.jsx("meshStandardMaterial",{color:"#5d4037",roughness:.4,metalness:.1,side:Es})]}),_.jsxs("mesh",{position:[0,.05,0],rotation:[Math.PI/2,0,0],children:[_.jsx("torusGeometry",{args:[.5,.025,8,U.arcLength]}),_.jsx("meshStandardMaterial",{color:"#5d4037",roughness:.4,side:Es})]})]})},`shard-${q}`))]})}function OU({position:i=[0,0,2]}){return _.jsxs("group",{position:i,children:[[0,1,2].map(e=>{const t=e*Math.PI*2/3+Math.PI/6,n=1,r=.6,s=Math.cos(t)*r,l=Math.sin(t)*r,c=0,f=0,d=(s+c)/2,m=(l+f)/2,g=.5,y=Math.atan2(r,n);return _.jsxs("mesh",{position:[d,g,m],rotation:[0,-t,y],children:[_.jsx("cylinderGeometry",{args:[.03,.03,n,8]}),_.jsx("meshStandardMaterial",{color:"#333333",metalness:.8,roughness:.3})]},e)}),_.jsxs("group",{position:[0,1,0],children:[_.jsxs("mesh",{rotation:[-Math.PI/2,0,0],children:[_.jsx("ringGeometry",{args:[.6,.75,32]}),_.jsx("meshStandardMaterial",{color:"#555555",metalness:.8,roughness:.4})]}),_.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,.01,0],children:[_.jsx("circleGeometry",{args:[.6,32]}),_.jsx("meshStandardMaterial",{color:"#666666",metalness:.7,roughness:.5,wireframe:!0})]}),_.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,-.02,0],children:[_.jsx("ringGeometry",{args:[.1,.15,16]}),_.jsx("meshStandardMaterial",{color:"#444444",metalness:.8,roughness:.3})]})]})]})}function BU({position:i=[0,0,2]}){const e=De(f=>f.bunsenBurnerOn),t=De(f=>f.toggleBunsenBurner),n=ge.useRef(null),r=ge.useRef([]),s=ge.useRef(0),l=40;ge.useMemo(()=>{r.current=Array.from({length:l},()=>({position:new Ee((Math.random()-.5)*.12,Math.random()*.3,(Math.random()-.5)*.12),velocity:new Ee((Math.random()-.5)*.008,.025+Math.random()*.02,(Math.random()-.5)*.008),life:Math.random(),maxLife:.4+Math.random()*.3,size:.025+Math.random()*.035}))},[]);const c=ge.useMemo(()=>new Oi,[]);return Lr((f,d)=>{!n.current||!e||(s.current+=d,r.current.forEach((m,g)=>{m.life+=d/m.maxLife,m.position.add(m.velocity),m.position.x+=Math.sin(s.current*12+g)*.002,m.position.z+=Math.cos(s.current*10+g*.5)*.002,m.life>=1&&(m.position.set((Math.random()-.5)*.1,.02,(Math.random()-.5)*.1),m.life=0,m.velocity.y=.025+Math.random()*.02);const y=m.life<.3?m.life/.3:1-(m.life-.3)/.7,v=m.size*y;c.position.copy(m.position),c.scale.setScalar(Math.max(.001,v)),c.updateMatrix(),n.current.setMatrixAt(g,c.matrix)}),n.current.instanceMatrix.needsUpdate=!0)}),_.jsxs("group",{position:i,children:[_.jsxs("mesh",{position:[0,.02,0],rotation:[-Math.PI/2,0,0],children:[_.jsx("ringGeometry",{args:[.9,1.1,32]}),_.jsx("meshBasicMaterial",{color:e?"#ff4400":"#555555",transparent:!0,opacity:e?.3:.15})]}),_.jsxs("mesh",{position:[0,.12,0],onClick:()=>t(),children:[_.jsx("cylinderGeometry",{args:[.18,.22,.24,16]}),_.jsx("meshStandardMaterial",{color:"#222222",metalness:.9,roughness:.3})]}),_.jsxs("mesh",{position:[0,.42,0],onClick:()=>t(),children:[_.jsx("cylinderGeometry",{args:[.07,.09,.36,16]}),_.jsx("meshStandardMaterial",{color:"#1a1a1a",metalness:.9,roughness:.2})]}),_.jsxs("mesh",{position:[0,.62,0],onClick:()=>t(),children:[_.jsx("cylinderGeometry",{args:[.1,.07,.04,16]}),_.jsx("meshStandardMaterial",{color:"#111111",metalness:.9,roughness:.2})]}),e&&_.jsxs("group",{position:[0,.65,0],children:[_.jsxs("instancedMesh",{ref:n,args:[void 0,void 0,l],children:[_.jsx("sphereGeometry",{args:[1,8,8]}),_.jsx("meshBasicMaterial",{color:"#3399ff",transparent:!0,opacity:.85})]}),_.jsxs("mesh",{position:[0,.18,0],children:[_.jsx("coneGeometry",{args:[.06,.35,8]}),_.jsx("meshBasicMaterial",{color:"#66ccff",transparent:!0,opacity:.9})]}),_.jsxs("mesh",{position:[0,.22,0],children:[_.jsx("coneGeometry",{args:[.1,.45,8]}),_.jsx("meshBasicMaterial",{color:"#0066cc",transparent:!0,opacity:.4})]}),_.jsx("pointLight",{position:[0,.25,0],color:"#4488ff",intensity:2.5,distance:3,decay:2})]}),!e&&_.jsxs("mesh",{position:[0,.8,0],children:[_.jsx("sphereGeometry",{args:[.08,12,12]}),_.jsx("meshBasicMaterial",{color:"#66ff66",transparent:!0,opacity:.5})]})]})}function UU(){const i=ge.useRef(null),e=De(g=>g.vessels),t=De(g=>g.bunsenBurnerOn),n=De(g=>g.checkExperimentReaction),r=Array.from(e.values()).find(g=>g.type==="tongs"),s=r?.contents.some(g=>g.chemical.id==="paper"),l=r?.contents.some(g=>g.chemical.id==="magnesium"),c=r?.contents.some(g=>g.chemical.id==="ash"||g.chemical.id==="magnesium-oxide"),d=t&&(s||l||c),m=()=>{n(),$s.stopSound("bunsen_burner")};return _.jsxs("group",{ref:i,position:[0,1.5,2],children:[_.jsxs("mesh",{position:[-.3,.075,0],rotation:[0,0,Math.atan2(.15,.6)],children:[_.jsx("boxGeometry",{args:[.62,.025,.025]}),_.jsx("meshStandardMaterial",{color:"#5a5a5a",metalness:.9,roughness:.2})]}),_.jsxs("mesh",{position:[-.3,-.075,0],rotation:[0,0,-Math.atan2(.15,.6)],children:[_.jsx("boxGeometry",{args:[.62,.025,.025]}),_.jsx("meshStandardMaterial",{color:"#5a5a5a",metalness:.9,roughness:.2})]}),_.jsxs("mesh",{position:[-.45,0,0],rotation:[Math.PI/2,0,0],children:[_.jsx("cylinderGeometry",{args:[.025,.025,.04,12]}),_.jsx("meshStandardMaterial",{color:"#333",metalness:.95,roughness:.15})]}),_.jsxs("group",{position:[0,0,0],children:[s&&_.jsx(hU,{burning:d,onBurnComplete:m}),l&&_.jsx(dU,{burning:d,onBurnComplete:m}),c&&_.jsx(pU,{})]})]})}function FU(){const i=ge.useRef(null),e=ge.useRef(null),t=ge.useRef(0),n=ge.useRef(0),r=ge.useRef(0),s=De(L=>L.neutralizationAnimating),l=De(L=>L.neutralizationDropCount),c=De(L=>L.neutralizationComplete),f=De(L=>L.incrementNeutralizationDrops),d=De(L=>L.placedApparatus),m=De(L=>L.currentExperiment),g=1200,y=5,v=ge.useMemo(()=>new Sy({color:"#ffffff",metalness:0,roughness:.1,transmission:.9,thickness:.1,transparent:!0,opacity:.3}),[]),S=ge.useMemo(()=>new g0({color:"#222222",roughness:.9,metalness:.1}),[]),T=ge.useMemo(()=>new Sy({color:"#e8f4fc",transmission:.8,thickness:.2,roughness:.1,transparent:!0,opacity:.7}),[]),A=De(L=>L.isAssistantSpeaking);Lr((L,k)=>{if(!s||l>=y||A)return;const q=L.clock.elapsedTime*1e3-n.current;if(t.current===0)q>g&&(t.current=.01),r.current>0&&(r.current=Math.max(0,r.current-k*3)),i.current&&(i.current.visible=!1);else if(i.current&&(i.current.visible=!0),t.current<.2?r.current=Math.min(1,r.current+k*5):r.current=Math.max(0,r.current-k*2),t.current+=k*1.8,i.current){if(t.current<.25){const W=t.current/.25;i.current.position.y=2.15,i.current.scale.set(.7*(1+Math.sin(W*Math.PI)*.1),.8*W,.7*(1+Math.sin(W*Math.PI)*.1))}else{const W=(t.current-.25)/.75,J=2.15,K=J-(J-.5)*(W*W);i.current.position.y=K;const ne=1+W*1.2;i.current.scale.set(.6/ne,.8*ne,.6/ne)}t.current>=1&&(f(),n.current=L.clock.elapsedTime*1e3,t.current=0)}if(e.current){const W=r.current*.22,J=Math.max(0,Math.sin(L.clock.elapsedTime*15)*.03*(1-r.current));e.current.scale.set(1+W+J,1-W+J,1+W+J)}});const w=De(L=>L.vessels),R=Array.from(w.values()).find(L=>L.type==="beaker"),D=R?R.position:[0,0,0],I=[D[0],D[1],D[2]],z=s||d.includes("dropper")&&m?.id==="neutralization",[j,X]=ge.useState(!1),G=De(L=>L.isNeutralizationAudioDone);return ge.useEffect(()=>{c&&l>=5&&G?X(!0):X(!1)},[c,l,G]),z?_.jsxs("group",{position:I,children:[_.jsxs("group",{position:[0,2.8,0],children:[_.jsxs("mesh",{ref:e,position:[0,.65,0],children:[_.jsx("sphereGeometry",{args:[.16,24,24]}),_.jsx("primitive",{object:S})]}),_.jsxs("mesh",{position:[0,.48,0],children:[_.jsx("cylinderGeometry",{args:[.07,.07,.15,16]}),_.jsx("meshStandardMaterial",{color:"#cccccc",metalness:.8,roughness:.2})]}),_.jsxs("mesh",{position:[0,0,0],children:[_.jsx("cylinderGeometry",{args:[.05,.04,.9,16]}),_.jsx("primitive",{object:v})]}),_.jsxs("mesh",{position:[0,-.6,0],children:[_.jsx("cylinderGeometry",{args:[.04,.015,.3,16]}),_.jsx("primitive",{object:v})]}),_.jsxs("group",{children:[_.jsxs("mesh",{position:[0,0,0],children:[_.jsx("cylinderGeometry",{args:[.04,.03,.85,12]}),_.jsx("primitive",{object:T})]}),_.jsxs("mesh",{position:[0,-.58,0],children:[_.jsx("cylinderGeometry",{args:[.03,.005,.25,12]}),_.jsx("primitive",{object:T})]})]})]}),i.current?.visible&&_.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,1.45,0],children:[_.jsx("circleGeometry",{args:[.06,16]}),_.jsx("meshBasicMaterial",{color:"black",transparent:!0,opacity:i.current.position.y>.6?.3*(1-(i.current.position.y-.6)/2):0})]}),_.jsxs("mesh",{ref:i,position:[0,1.35,0],visible:!1,children:[_.jsx("sphereGeometry",{args:[.08,16,16]}),_.jsx("primitive",{object:T})]}),j&&_.jsx(fd,{position:[0,2.2,0],center:!0,zIndexRange:[999,1e3],style:{pointerEvents:"auto"},children:_.jsxs("div",{style:{background:"linear-gradient(135deg, #0a2a1f 0%, #0f3d2e 100%)",padding:"16px 20px",borderRadius:"16px",border:"3px solid #10b981",boxShadow:"0 0 40px rgba(16, 185, 129, 0.6)",textAlign:"center",fontFamily:"Arial, sans-serif",animation:"fadeIn 0.5s ease-out",minWidth:"220px",maxWidth:"280px"},children:[_.jsx("div",{style:{color:"#10b981",fontSize:"18px",fontWeight:"bold",marginBottom:"10px",textShadow:"0 0 10px #10b981"},children:" NEUTRALIZATION COMPLETE!"}),_.jsxs("div",{style:{color:"#ffffff",fontSize:"13px",lineHeight:"1.5"},children:[_.jsxs("div",{style:{marginBottom:"8px"},children:["The solution turned ",_.jsx("strong",{style:{color:"#f5f5f5"},children:"colorless"})]}),_.jsx("div",{style:{color:"#00ffff",fontWeight:"bold",fontSize:"14px"},children:"HCl + NaOH  NaCl + HO"})]}),_.jsx("button",{onClick:()=>{console.log("Neutralization Popup: Done clicked"),De.setState({showCompletionPopup:!0})},style:{display:"block",width:"100%",marginTop:"14px",padding:"12px 16px",background:"linear-gradient(135deg, #10b981, #059669)",color:"white",border:"none",borderRadius:"10px",fontSize:"15px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 15px rgba(16, 185, 129, 0.4)"},children:" Done"})]})})]}):null}function zU({position:i,target:e}){const{camera:t,controls:n}=da();return ge.useEffect(()=>{t.position.set(...i)},[t,i]),ge.useEffect(()=>{n&&(n.target.set(...e),n.update())},[n,e]),null}function jU(){return _.jsx("group",{children:_.jsxs("mesh",{position:[0,-.1,0],rotation:[-Math.PI/2,0,0],receiveShadow:!0,children:[_.jsx("planeGeometry",{args:[12,12]}),_.jsx("meshBasicMaterial",{color:"#2a3f5f"})]})})}function VU(){return _.jsxs(_.Fragment,{children:[_.jsx("ambientLight",{intensity:.5}),_.jsx("directionalLight",{position:[5,10,5],intensity:1,castShadow:!0,"shadow-mapSize":[1024,1024]}),_.jsx("directionalLight",{position:[-5,5,-5],intensity:.3}),_.jsx("pointLight",{position:[0,5,-5],intensity:.5,color:"#ffffff"})]})}function HU(){const i=De(s=>s.vessels),e=De(s=>s.placedApparatus),t=Array.from(i.values()).filter(s=>s.type==="beaker"),n=Array.from(i.values()).filter(s=>s.type==="test_tube"),r=Array.from(i.values()).filter(s=>s.type==="flask");return _.jsxs(_.Fragment,{children:[t.map(s=>_.jsx(xU,{vesselId:s.id},s.id)),n.map(s=>_.jsx(yU,{vesselId:s.id},s.id)),e.includes("test-tube-stand")&&_.jsx(bU,{position:[0,0,1]}),r.map(s=>_.jsx(wU,{vesselId:s.id},s.id))]})}function GU(){const i=De(f=>f.vessels),e=De(f=>f.bunsenBurnerOn),t=De(f=>f.updateVesselTemperature),n=De(f=>f.addEffect),r=De(f=>f.activeEffects),s=ge.useRef(0),l=[0,0,2],c=.7;return Lr((f,d)=>{if(!e){i.forEach(m=>{if(m.temperature>25){const g=Math.max(25,m.temperature-d*5);t(m.id,g)}});return}i.forEach(m=>{const g=m.position[0]-l[0],y=m.position[2]-l[2],v=Math.sqrt(g*g+y*y);if(v<c){const S=15*(1-v/c),T=Math.min(120,m.temperature+d*S);t(m.id,T);const A=m.contents.some(w=>w.chemical.id==="ice");if(m.temperature>=100&&m.currentVolume>0&&!A){const w=Date.now();w-s.current>5e3&&(r.some(D=>D.vesselId===m.id&&(D.type==="boiling"||D.type==="steam"))||(n({type:"boiling",vesselId:m.id,duration:5e3}),n({type:"steam",vesselId:m.id,duration:5e3}),$s.playBoiling(`boiling_${m.id}`,5e3),s.current=w))}}else if(m.temperature>25){const S=Math.max(25,m.temperature-d*3);t(m.id,S)}})}),null}function vM({className:i,isMobile:e=!1}){const t=De(g=>g.experimentMode),n=De(g=>g.currentExperiment),r=t==="guided"&&n!==null,s=De(g=>g.placedApparatus),l=De(g=>g.vessels),c=ge.useMemo(()=>n?.id==="neutralization"?[0,1.5,0]:n?.id==="acids-bases"?e?[0,1.5,1]:[0,.8,1]:e&&n?.id==="filtration"?[1.75,0,0]:e&&(n?.id==="evaporation"||n?.id==="salt-dissolution")?[0,.8,0]:[0,0,0],[e,n?.id]),f=ge.useMemo(()=>e?n?.id==="evaporation"||n?.id==="salt-dissolution"?[3.8,4.8,4.8]:n?.id==="filtration"?[4.5,4,4.5]:n?.id==="neutralization"?[6,7,9]:n?.id==="acids-bases"?[0,3.2,6.5]:[4,5,6]:n?.id==="neutralization"?[5,6,8]:[4,5,6],[e,n?.id]),d=s.includes("funnel"),m=s.includes("dropper")&&n?.id!=="neutralization";return _.jsxs("div",{className:i,children:[_.jsxs(ZO,{camera:{position:f,fov:50},shadows:!0,style:{background:"transparent",touchAction:"none"},children:[_.jsx(zU,{position:f,target:c}),_.jsx(KB,{preset:"studio"}),_.jsx(VU,{}),_.jsx(jU,{}),s.includes("tripod-stand")&&_.jsx(OU,{}),s.includes("burner")&&_.jsx(BU,{}),_.jsx(GU,{}),_.jsx(HU,{}),_.jsx(TU,{}),_.jsx(IU,{}),r&&_.jsx(DU,{}),m&&(()=>{const g=Array.from(l.values()).find(v=>v.type==="test_tube"),y=g?[g.position[0],g.position[1]+.45,g.position[2]]:[-2.5,.55,-1];return _.jsx(_U,{position:y})})(),d&&_.jsx(SU,{position:[3.5,0,0]}),s.includes("china-dish")&&_.jsx(kU,{}),s.includes("tongs")&&_.jsx(UU,{}),_.jsx(FU,{}),_.jsx(IB,{makeDefault:!0,minPolarAngle:.1,maxPolarAngle:Math.PI/2-.1,minDistance:3,maxDistance:15,enablePan:!0,panSpeed:.5})]}),_.jsxs("div",{className:"absolute bottom-24 right-4 z-[100] flex flex-col glass-panel rounded-full p-1 gap-1 border border-white/10 shadow-lg",children:[_.jsx("button",{onClick:()=>{const g=new WheelEvent("wheel",{deltaY:-100,bubbles:!0});document.querySelector("canvas")?.dispatchEvent(g)},className:"w-10 h-10 rounded-full flex items-center justify-center text-cyan-400 hover:bg-white/10 active:bg-white/20 transition-all active:scale-95",title:"Zoom In",children:_.jsx("span",{className:"text-2xl font-light leading-none pb-1",children:"+"})}),_.jsx("div",{className:"h-[1px] w-6 bg-white/10 mx-auto"}),_.jsx("button",{onClick:()=>{const g=new WheelEvent("wheel",{deltaY:100,bubbles:!0});document.querySelector("canvas")?.dispatchEvent(g)},className:"w-10 h-10 rounded-full flex items-center justify-center text-cyan-400 hover:bg-white/10 active:bg-white/20 transition-all active:scale-95",title:"Zoom Out",children:_.jsx("span",{className:"text-2xl font-light leading-none pb-1",children:""})})]})]})}const qU=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),WU=i=>i.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),xM=i=>{const e=WU(i);return e.charAt(0).toUpperCase()+e.slice(1)},x4=(...i)=>i.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim(),XU=i=>{for(const e in i)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var YU={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const ZU=ge.forwardRef(({color:i="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:r="",children:s,iconNode:l,...c},f)=>ge.createElement("svg",{ref:f,...YU,width:e,height:e,stroke:i,strokeWidth:n?Number(t)*24/Number(e):t,className:x4("lucide",r),...!s&&!XU(c)&&{"aria-hidden":"true"},...c},[...l.map(([d,m])=>ge.createElement(d,m)),...Array.isArray(s)?s:[s]]));const Qs=(i,e)=>{const t=ge.forwardRef(({className:n,...r},s)=>ge.createElement(ZU,{ref:s,iconNode:e,className:x4(`lucide-${qU(xM(i))}`,`lucide-${i}`,n),...r}));return t.displayName=xM(i),t};const $U=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],JU=Qs("arrow-left",$U);const KU=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],yM=Qs("arrow-right",KU);const QU=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],bM=Qs("award",QU);const eF=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],_M=Qs("check",eF);const tF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Q_=Qs("circle-check",tF);const nF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],iF=Qs("circle",nF);const rF=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],vb=Qs("clipboard-list",rF);const sF=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],aF=Qs("droplets",sF);const oF=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],lF=Qs("eraser",oF);const cF=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],m2=Qs("eye",cF);const uF=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],wx=Qs("file-text",uF);const fF=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],y4=Qs("flask-conical",fF);const hF=[["path",{d:"M10 2v6.292a7 7 0 1 0 4 0V2",key:"1s42pc"}],["path",{d:"M5 15h14",key:"m0yey3"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],dF=Qs("flask-round",hF);const pF=[["circle",{cx:"12",cy:"9",r:"1",key:"124mty"}],["circle",{cx:"19",cy:"9",r:"1",key:"1ruzo2"}],["circle",{cx:"5",cy:"9",r:"1",key:"1a8b28"}],["circle",{cx:"12",cy:"15",r:"1",key:"1e56xg"}],["circle",{cx:"19",cy:"15",r:"1",key:"1a92ep"}],["circle",{cx:"5",cy:"15",r:"1",key:"5r1jwy"}]],mF=Qs("grip-horizontal",pF);const gF=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],vF=Qs("lightbulb",gF);const xF=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],y0=Qs("rotate-ccw",xF);const yF=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],t_=Qs("star",yF);const bF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],_F=Qs("target",bF);const SF=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],wF=Qs("trash-2",SF);const MF=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],SM=Qs("trophy",MF);const AF=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]],TF=Qs("wrench",AF);const EF=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],r1=Qs("x",EF);function wM(){const i=De(ue=>ue.selectedVesselId),e=De(ue=>ue.fillVessel),t=De(ue=>ue.selectVessel),n=De(ue=>ue.vessels),r=De(ue=>ue.experimentMode),s=De(ue=>ue.currentExperiment),l=De(ue=>ue.addChemicalToExperiment),c=De(ue=>ue.checkExperimentReaction),f=De(ue=>ue.addedChemicals),d=De(ue=>ue.addApparatusToExperiment),m=De(ue=>ue.addVessel),g=De(ue=>ue.placedApparatus),y=De(ue=>ue.saltTested),v=De(ue=>ue.sandTested),S=De(ue=>ue.resetAfterSaltTest),T=De(ue=>ue.iceTested),A=De(ue=>ue.paperTested),w=De(ue=>ue.magnesiumTested),R=De(ue=>ue.vinegarBlueLitmusTested),D=De(ue=>ue.vinegarRedLitmusTested),I=De(ue=>ue.lemonJuiceBlueLitmusTested),z=De(ue=>ue.lemonJuiceRedLitmusTested),j=De(ue=>ue.soapSolutionBlueLitmusTested),X=De(ue=>ue.soapSolutionRedLitmusTested),G=De(ue=>ue.bakingSodaBlueLitmusTested),L=De(ue=>ue.bakingSodaRedLitmusTested),k=De(ue=>ue.isAssistantSpeaking),U=De(ue=>ue.experimentActions),q=De(ue=>ue.performExperimentAction),W=De(ue=>ue.isAutoPouring),J=De(ue=>ue.setAutoPouring),ce=De(ue=>ue.bunsenBurnerOn),K=De(ue=>ue.toggleBunsenBurner),ne=De(ue=>ue.startNeutralizationAnimation),pe=De(ue=>ue.neutralizationAnimating),Re=De(ue=>ue.neutralizationDropCount),Te=De(ue=>ue.neutralizationComplete),ee=De(ue=>ue.showResetPrompt),F=De(ue=>ue.resetExperiment),$=De(ue=>ue.dishCracked),re=De(ue=>ue.showAssistant),Ae=De(ue=>ue.toggleAssistant),ie=s?.apparatus?.includes("burner")||s?.id==="evaporation"||s?.id==="physical-chemical",_e=i?n.get(i):null,ke=_e?.currentVolume??0,We=(_e?.capacity??500)-ke,nt=r==="guided"&&s!==null,It=ue=>({water:"",salt:"",sand:"","muddy-water":"","salt-solution":"",ice:"",paper:"",magnesium:"",hcl:"",hydrochloric_acid:"",naoh:"",sodium_hydroxide:"",phenolphthalein:"",h2so4:"",sulfuric_acid:"",barium_chloride:"",vinegar:"","lemon-juice":"","soap-solution":"","baking-soda":"","blue-litmus":"","red-litmus":"",zinc:"","sodium-sulphate":"","barium-chloride":""})[ue]||"",wt=ue=>({water:"water",salt:"salt",sand:"neutral",hcl:"acid",naoh:"base",h2so4:"acid",phenolphthalein:"indicator",barium_chloride:"salt",zinc:"metal",vinegar:"acid","lemon-juice":"acid","soap-solution":"base","baking-soda":"base","sodium-sulphate":"salt","barium-chloride":"salt"})[ue]||"neutral",Je=ue=>{if(!nt||s?.id!=="salt-dissolution")return!1;const je=f.includes("water"),Ye=f.includes("salt")||f.includes("sand");return ue==="water"?!1:ue==="salt"?!!(!je||y||Ye):ue==="sand"?!!(!je||!y||v||!S||Ye):!1},le=ue=>{if(!nt||s?.id!=="physical-chemical")return!1;const je=g.includes("beaker"),Ye=g.includes("tongs"),ft=f.includes("ice"),gt=f.includes("paper"),Lt=f.includes("magnesium");return ue==="ice"?!!(T||!je||ft):ue==="paper"?!!(!T||A||ft||!Ye||gt):ue==="magnesium"?!!(!T||!A||w||gt||!Ye||Lt):!1},Qe=ue=>{if(!nt||s?.id!=="neutralization")return!1;if(pe||Te)return!0;const je=f.includes("naoh"),Ye=f.includes("phenolphthalein");if(ue==="phenolphthalein"&&!je)return!0;const ft=g.includes("dropper");return ue==="hcl"&&(!Ye||!ft)},Et=ue=>{if(!nt||s?.id!=="acids-bases")return!1;const je=f.some(ft=>["vinegar","lemon-juice","soap-solution","baking-soda"].includes(ft)),Ye=f.some(ft=>["blue-litmus","red-litmus"].includes(ft));if(ue==="vinegar")return!!(R&&D||je);if(ue==="lemon-juice")return!!(!R||!D||I&&z||je);if(ue==="soap-solution")return!!(!I||!z||j&&X||je);if(ue==="baking-soda")return!!(!j||!X||G&&L||je);if(ue==="blue-litmus"||ue==="red-litmus"){if(!je||!g.includes("dropper")||Ye)return!0;const gt=f.find(Lt=>["vinegar","lemon-juice","soap-solution","baking-soda"].includes(Lt));if(gt==="vinegar"){if(ue==="blue-litmus"&&R||ue==="red-litmus"&&D)return!0}else if(gt==="lemon-juice"){if(ue==="blue-litmus"&&I||ue==="red-litmus"&&z)return!0}else if(gt==="soap-solution"){if(ue==="blue-litmus"&&j||ue==="red-litmus"&&X)return!0}else if(gt==="baking-soda"&&(ue==="blue-litmus"&&G||ue==="red-litmus"&&L))return!0;return!1}return!1},ot=nt&&s?s.chemicals.map(ue=>({id:ue.id,name:ue.name,color:ue.color,type:wt(ue.id),emoji:It(ue.id),label:ue.name})):[{...go.water,emoji:"",label:"Water"},{...go.baking_soda,emoji:"",label:"Baking Soda"},{...go.vinegar,emoji:"",label:"Vinegar"},{...go.food_coloring_red,emoji:"",label:"Red Dye"},{...go.food_coloring_blue,emoji:"",label:"Blue Dye"},{...go.food_coloring_yellow,emoji:"",label:"Yellow Dye"},{...go.hydrogen_peroxide,emoji:"",label:"HO (Peroxide)"},{...go.potassium_iodide,emoji:"",label:"KI (Catalyst)"},{...go.hydrochloric_acid,emoji:"",label:"HCl (Acid)"},{...go.sodium_hydroxide,emoji:"",label:"NaOH (Base)"},{...go.phenolphthalein,emoji:"",label:"Indicator"}],Ct=ue=>({id:`${ue}_${Date.now()}`,type:ue,capacity:250,currentVolume:0,tiltAngle:0,temperature:25,contents:[],position:[Math.random()*.5-.25,0,Math.random()*.5+.5]}),ht=ue=>{if(ue==="beaker"){const je=Ct("beaker");s?.id==="physical-chemical"&&g.includes("tripod-stand")?je.position=[0,1,2]:s?.id==="evaporation"&&g.includes("tripod-stand")&&(je.position=[0,1,2]),m(je),t(je.id),d("beaker")}else if(ue==="tongs"){const je={id:`tongs_${Date.now()}`,type:"tongs",capacity:10,currentVolume:0,tiltAngle:0,temperature:25,contents:[],position:[0,1.8,2]};m(je),t(je.id),d("tongs")}else if(ue==="test-tube"){const je={id:`test_tube_${Date.now()}`,type:"test_tube",capacity:60,currentVolume:0,tiltAngle:0,temperature:25,contents:[],position:[0,.1,1]};m(je),t(je.id),d("test-tube")}else d(ue)},xt=ue=>({beaker:"",funnel:"","filter-paper":"",burner:"","tripod-stand":"","china-dish":"","test-tube":"","glass-rod":"",dropper:"",tongs:""})[ue]||"",he=ue=>ue.split("-").map(je=>je.charAt(0).toUpperCase()+je.slice(1)).join(" "),Q=De(ue=>ue.startDroppingAnimation),Be=ue=>{if(nt&&s?.id==="neutralization"&&k&&ue.id==="hcl"&&Re>0)return;if(nt&&s?.id==="neutralization"&&ue.id==="hcl"){ne();return}if(nt&&s?.id==="acids-bases"){const dt=i;if(dt&&["blue-litmus","red-litmus"].includes(ue.id)){Q(ue.id,dt,ue.color);return}}if(nt&&s?.id==="evaporation"){l(ue.id),setTimeout(()=>c(),100);return}let je=i;if(je==="collection_beaker"&&(je=null),!je){if(ue.id==="paper"||ue.id==="magnesium"){const dt=Array.from(n.values()).find(Ge=>Ge.type==="tongs");dt&&(dt.contents.length>0||(je=dt.id))}if(!je){const dt=Array.from(n.values()).filter(Ge=>Ge.type==="beaker"&&Ge.id!=="collection_beaker");dt.length>0&&(je=dt[0].id)}}if(!je)return;const Ye=n.get(je);if(!Ye)return;const ft=Ye.capacity-Ye.currentVolume;if(ft<=0)return;const gt=ue.id==="muddy-water"?112.5:100,un=Ye.type==="test_tube"?Ye.capacity*.7:gt,bt=Math.min(un,ft);e(je,ue,bt),nt&&(l(ue.id),setTimeout(()=>c(),100))};return _.jsxs("div",{className:"w-full relative",children:[!i&&_.jsx("p",{className:"text-xs text-yellow-500/80 mb-3 bg-yellow-500/10 p-2 rounded border border-yellow-500/20",children:" Click a chemical to auto-fill first available beaker"}),_.jsxs("div",{className:`transition-opacity ${i?"opacity-100":"opacity-90"}`,children:[nt&&s?.apparatus&&_.jsxs("div",{className:"mb-1 md:mb-6",children:[_.jsxs("div",{className:"hidden md:flex items-center justify-center mb-2 md:mb-3 px-1 relative",children:[_.jsx("h4",{className:"text-[10px] md:text-[11px] font-bold text-[var(--accent-cyan)] uppercase tracking-[0.15em] opacity-80",children:"Apparatus"}),_.jsx("span",{className:"absolute right-0 text-[10px] bg-[rgba(34,211,238,0.1)] text-[var(--accent-cyan)] px-2 py-0.5 rounded-full border border-[rgba(34,211,238,0.2)]",children:"READY"})]}),_.jsxs("div",{className:`grid grid-cols-2 ${s?.id==="acids-bases"?"gap-px md:gap-0.5":"gap-0.5"} pb-0 md:pb-0`,children:[s.apparatus.map(ue=>{const je=g.includes(ue)||ue==="test-tube"&&g.some(vt=>vt.startsWith("test-tube")),Ye=["funnel","filter-paper","tripod-stand","burner","beaker","glass-rod","china-dish","tongs","test-tube","test-tube-stand"].includes(ue),ft=g.includes("beaker")&&(f.includes("salt")||f.includes("sand")),gt=s.id==="physical-chemical",Lt=f.includes("ice"),un=gt&&(!T||Lt),bt=gt&&T&&!Lt,dt=un&&!g.includes("tripod-stand"),Ge=un&&!g.includes("burner"),xe=un&&ue==="tongs",Pe=bt&&ue==="tripod-stand",rt=bt&&ue==="beaker",Me=bt&&!g.includes("burner"),ze=s.id==="neutralization"&&ue==="dropper"&&!f.includes("phenolphthalein"),Mt=s.id==="acids-bases",Rt=Mt&&ue==="test-tube"&&!g.includes("test-tube-stand"),se=Mt&&ue==="dropper"&&(!g.includes("test-tube")||!["vinegar","lemon-juice","soap-solution","baking-soda"].some(vt=>f.includes(vt))),Ve=Ye&&je||ue==="funnel"&&!g.includes("beaker")||ue==="filter-paper"&&!g.includes("funnel")||ue==="glass-rod"&&!ft||ue==="burner"&&!bt&&!g.includes("tripod-stand")||ue==="china-dish"&&!g.includes("burner")||ue==="beaker"&&(dt||Ge||rt)||ue==="tongs"&&(xe||Me)||ue==="tripod-stand"&&Pe||Rt||se||ze;return _.jsxs("button",{onClick:()=>ht(ue),disabled:Ve,className:`shrink-0 md:shrink group relative flex items-center gap-2 md:gap-3 ${s?.id==="acids-bases"?"px-1 py-px md:px-3.5 md:py-3":"px-2 py-0.5 md:px-3.5 md:py-3"} rounded-xl text-xs md:text-sm font-medium transition-all duration-200 overflow-hidden min-w-0
                                            ${je?"bg-emerald-500/10 border border-emerald-500/30 text-emerald-300 box-shadow-[0_0_15px_rgba(16,185,129,0.1)]":Ve?"bg-transparent border border-white/5 text-white/30 cursor-not-allowed":"bg-white/5 border border-white/10 text-white hover:bg-white/10 hover:border-white/20 hover:shadow-[0_0_15px_rgba(255,255,255,0.05)]"}`,children:[_.jsx("div",{className:`${s?.id==="acids-bases"?"p-0.5 md:p-1":"p-1"} rounded-lg ${s?.id==="acids-bases"?"text-base md:text-lg":"text-lg"} ${je?"bg-[rgba(16,185,129,0.2)]":"bg-[rgba(255,255,255,0.05)]"}`,children:ue==="tongs"?_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5 text-gray-300",children:[_.jsx("path",{d:"M12 12L8 4"}),_.jsx("path",{d:"M12 12L16 4"}),_.jsx("path",{d:"M12 12L9 21"}),_.jsx("path",{d:"M12 12L15 21"}),_.jsx("circle",{cx:"12",cy:"12",r:"2"})]}):xt(ue)}),_.jsx("span",{className:`flex-1 text-left font-medium tracking-wide ${s?.id==="acids-bases"?"text-[11px] md:text-[13px]":"text-[13px]"}`,children:he(ue)}),je&&_.jsx("div",{className:"absolute right-3 w-2 h-2 rounded-full bg-[var(--accent-success)] box-shadow-[0_0_8px_var(--accent-success)]"}),!je&&!Ve&&_.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-[rgba(255,255,255,0.05)] to-transparent -translate-x-full group-hover:animate-shimmer"})]},ue)}),s?.id==="acids-bases"&&_.jsxs("div",{className:"md:hidden shrink-0 flex items-center gap-1.5 ml-1",children:[_.jsx("button",{onClick:Ae,className:"group relative flex items-center justify-center p-1.5 rounded-xl transition-all duration-200",style:{backgroundColor:re?"rgba(6,182,212,0.15)":"rgba(255,255,255,0.05)",borderWidth:1,borderColor:re?"rgba(6,182,212,0.4)":"rgba(255,255,255,0.1)"},children:_.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[_.jsx("span",{className:"text-base",children:""}),_.jsx("div",{className:`w-5 h-2.5 rounded-full relative transition-colors ${re?"bg-cyan-500":"bg-white/10"}`,children:_.jsx("div",{className:`absolute top-0.5 w-1.5 h-1.5 rounded-full bg-white shadow-sm transition-transform duration-300 ${re?"left-2.5":"left-0.5"}`})})]})}),_.jsxs("button",{onClick:()=>F(),className:`flex flex-col items-center justify-center p-1.5 rounded-xl border transition-all duration-200 ${ee?"bg-yellow-500 hover:bg-yellow-400 border-yellow-600/50 text-black shadow-lg shadow-yellow-500/20":"bg-white/5 border-white/10 text-white/60 hover:text-white"}`,children:[_.jsx(y0,{className:`w-4 h-4 mb-0.5 ${ee?"text-black":""}`}),_.jsx("span",{className:"text-[9px] font-bold uppercase tracking-wider",children:"Reset"})]})]})]})]}),_.jsx("div",{className:"hidden md:flex items-center justify-center mb-3 px-1",children:_.jsx("h4",{className:"text-[11px] font-bold text-[var(--accent-cyan)] uppercase tracking-[0.15em] opacity-80",children:"Chemicals"})}),!g.includes("beaker")&&s?.id!=="evaporation"&&s?.id!=="acids-bases"&&s?.id!=="physical-chemical"&&_.jsxs("div",{className:"text-[11px] text-yellow-400/90 mb-3 px-3 py-2 rounded-lg bg-yellow-500/5 border border-yellow-500/20 flex items-center gap-2",children:[_.jsx("span",{children:""})," Place a beaker first before adding chemicals"]}),_.jsxs("div",{className:`${nt&&s?.id!=="acids-bases"?"flex gap-0.5 overflow-x-auto pb-0.5 snap-x":s?.id==="acids-bases"?"grid grid-cols-3 gap-px pb-0":"grid grid-cols-3 gap-0.5 overflow-y-auto pb-1"} md:grid md:grid-cols-2 md:pb-0 md:overflow-visible no-scrollbar`,children:[ot.map(ue=>{let je=!1;if(s?.id==="evaporation")je=g.includes("china-dish");else if(s?.id==="physical-chemical"){const ft=f.includes("ice");je=T&&!ft?g.includes("tongs"):g.includes("beaker")}else s?.id==="acids-bases"?je=g.includes("test-tube"):je=g.includes("beaker");const Ye=!je||We<=0||f.includes(ue.id)||Je(ue.id)||le(ue.id)||Qe(ue.id)||Et(ue.id)||!!$;return _.jsxs("button",{onClick:()=>Be(ue),disabled:Ye,className:`shrink-0 md:shrink group relative flex items-center gap-0.5 md:gap-2.5 rounded-xl border transition-all duration-200 min-w-[90px] md:min-w-0 snap-center
                                        ${s?.id==="acids-bases"?"px-0.5 py-px md:px-3 md:py-2.5":nt?"px-1 py-0.5":"px-2 py-2"}
                                        md:px-3 md:py-2.5
                                        disabled:opacity-40 disabled:cursor-not-allowed
                                        ${f.includes(ue.id)?"opacity-50":"hover:translate-y-[-2px]"}`,style:{backgroundColor:Ye?"transparent":`${ue.color}08`,borderColor:Ye?"rgba(255,255,255,0.05)":`${ue.color}20`},children:[_.jsx("span",{className:`${nt?"text-lg md:text-xl":"text-xl"} filter drop-shadow-md`,children:ue.id==="muddy-water"?_.jsx(aF,{className:`${nt?"w-4 h-4 md:w-5 md:h-5":"w-5 h-5"} text-[#8b7355]`}):ue.id==="sand"?_.jsx(mF,{className:`${nt?"w-4 h-4 md:w-5 md:h-5":"w-5 h-5"} text-[#e6c288]`}):ue.emoji}),_.jsx("div",{className:"flex flex-col text-left",children:_.jsx("span",{className:`${nt?"text-[11px] md:text-xs":"text-xs"} font-semibold tracking-wide leading-tight`,style:{color:Ye?"var(--text-dim)":"#fff"},children:ue.label})}),!Ye&&_.jsx("div",{className:"absolute inset-0 rounded-xl opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",style:{boxShadow:`inset 0 0 12px ${ue.color}20`}})]},ue.id)}),s?.id!=="acids-bases"&&s?.id!=="neutralization"&&s?.id!=="double-displacement"&&s?.id!=="salt-dissolution"&&s?.id!=="physical-chemical"&&_.jsxs("button",{onClick:Ae,className:`md:hidden shrink-0 group relative flex items-center justify-center gap-1.5 rounded-xl border transition-all duration-200 snap-center
                                ${["double-displacement","neutralization","physical-chemical"].includes(s?.id||"")?"w-auto px-2 py-1.5":"min-w-[90px] px-2 py-2"} 
                                hover:translate-y-[-2px]`,style:{backgroundColor:re?"rgba(6,182,212,0.1)":"rgba(255,255,255,0.05)",borderColor:re?"rgba(6,182,212,0.3)":"rgba(255,255,255,0.1)"},children:[_.jsx("span",{className:"text-xl filter drop-shadow-md",children:""}),!["double-displacement","neutralization","physical-chemical"].includes(s?.id||"")&&_.jsx("div",{className:"flex flex-col text-left flex-1",children:_.jsx("span",{className:"text-xs font-semibold tracking-wide leading-tight text-white",children:"Assistant"})}),_.jsx("div",{className:`rounded-full relative transition-colors border border-white/10 shrink-0 ${re?"bg-cyan-500":"bg-white/5"}
                                ${["double-displacement","neutralization","physical-chemical"].includes(s?.id||"")?"w-7 h-3.5":"w-6 h-3"}`,children:_.jsx("div",{className:`absolute top-0.5 rounded-full bg-white shadow-sm transition-transform duration-300 ${re?(["double-displacement","neutralization","physical-chemical"].includes(s?.id||""),"left-3.5"):"left-0.5"}
                                    ${["double-displacement","neutralization","physical-chemical"].includes(s?.id||"")?"w-2.5 h-2.5":"w-2 h-2"}`})})]})]}),(s?.id==="neutralization"||s?.id==="double-displacement"||s?.id==="salt-dissolution"||s?.id==="physical-chemical")&&_.jsx("div",{className:"md:hidden w-full px-2 mt-4 mb-4",children:_.jsxs("button",{onClick:Ae,className:`w-full py-3 px-4 rounded-xl flex items-center justify-between transition-all active:scale-95 shadow-lg border ${re?"bg-gradient-to-r from-cyan-600 to-blue-600 border-cyan-400/30 text-white":"bg-white/10 border-white/10 text-zinc-300"}`,children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("span",{className:"text-2xl filter drop-shadow-md",children:""}),_.jsx("span",{className:"text-sm font-bold tracking-wide",children:"Lab Assistant"})]}),_.jsx("div",{className:`w-12 h-7 rounded-full relative transition-colors border border-white/20 shrink-0 ${re?"bg-cyan-400":"bg-black/40"}`,children:_.jsx("div",{className:`absolute top-1 w-5 h-5 rounded-full bg-white shadow-sm transition-all duration-300 ${re?"left-6":"left-1"}`})})]})}),(f.length>0||ie&&g.includes("burner"))&&_.jsxs("div",{className:`mt-1 pt-1 border-t border-white/10 ${s?.id==="acids-bases"?"mt-0 pt-0 border-t-0":""}`,children:[s?.id!=="acids-bases"&&_.jsx("h4",{className:"flex justify-center text-[10px] font-bold text-white/50 mb-0.5 uppercase tracking-[0.15em] items-center gap-2",children:"Session Actions"}),_.jsxs("div",{className:"grid grid-cols-2 gap-1.5",children:[s?.reactions&&Object.keys(s.reactions).some(ue=>ue.includes("stir"))&&!U.includes("stir")&&(s.id!=="salt-dissolution"||g.includes("glass-rod"))&&_.jsxs("button",{onClick:()=>{q("stir")},className:"relative group p-2 rounded-xl bg-white/5 border border-white/10 hover:bg-orange-500/20 hover:border-orange-500/40 transition-all active:scale-95 flex flex-col items-center justify-center gap-1 h-14 shadow-[0_4px_20px_rgba(0,0,0,0.2)]",children:[_.jsx("div",{className:"text-xl filter drop-shadow-md group-hover:scale-110 transition-transform",children:""}),_.jsx("span",{className:"text-[10px] font-semibold text-white/80 group-hover:text-orange-200",children:"Stir"})]}),s?.reactions&&Object.keys(s.reactions).some(ue=>ue.includes("filter"))&&!U.includes("filter")&&s.id!=="filtration"&&_.jsxs("button",{onClick:()=>{q("filter"),setTimeout(()=>c(),100)},className:"relative group p-2 rounded-xl bg-white/5 border border-white/10 hover:bg-purple-500/20 hover:border-purple-500/40 transition-all active:scale-95 flex flex-col items-center justify-center gap-1 h-14 shadow-[0_4px_20px_rgba(0,0,0,0.2)]",children:[_.jsx("div",{className:"text-xl filter drop-shadow-md group-hover:scale-110 transition-transform",children:""}),_.jsx("span",{className:"text-[10px] font-semibold text-white/80 group-hover:text-purple-200",children:"Filter"})]}),s?.reactions&&Object.keys(s.reactions).some(ue=>ue.includes("evaporate"))&&!U.includes("evaporate")&&s.id!=="evaporation"&&_.jsxs("button",{onClick:()=>{q("evaporate"),setTimeout(()=>c(),100)},className:"relative group p-2 rounded-xl bg-white/5 border border-white/10 hover:bg-cyan-500/20 hover:border-cyan-500/40 transition-all active:scale-95 flex flex-col items-center justify-center gap-1 h-14 shadow-[0_4px_20px_rgba(0,0,0,0.2)]",children:[_.jsx("div",{className:"text-xl filter drop-shadow-md group-hover:scale-110 transition-transform",children:""}),_.jsx("span",{className:"text-[10px] font-semibold text-white/80 group-hover:text-cyan-200",children:"Evaporate"})]}),ie&&g.includes("burner")&&!$&&_.jsxs("button",{onClick:K,disabled:(()=>{if(s?.id==="physical-chemical"&&ce)return!0;if(!ce&&s?.id==="physical-chemical"){const ue=Array.from(n.values()).some(Ye=>Ye.type==="beaker"&&Ye.contents.some(ft=>ft.chemical.id==="ice")),je=Array.from(n.values()).some(Ye=>Ye.type==="tongs"&&Ye.contents.some(ft=>ft.chemical.id==="paper"||ft.chemical.id==="magnesium"));return!ue&&!je}return!1})(),className:`relative p-3 rounded-2xl transition-all active:scale-95 flex flex-row items-center justify-center gap-3 h-12 shadow-[0_4px_20px_rgba(0,0,0,0.2)] col-span-2 overflow-hidden
                                        ${ce?s?.id==="physical-chemical"?"bg-orange-600 text-white shadow-[0_0_30px_rgba(249,115,22,0.4)] border border-orange-500 cursor-not-allowed":"bg-orange-500 text-white shadow-[0_0_30px_rgba(249,115,22,0.4)] border border-orange-400":!ce&&s?.id==="physical-chemical"&&!Array.from(n.values()).some(ue=>ue.type==="beaker"&&ue.contents.some(je=>je.chemical.id==="ice"))&&!Array.from(n.values()).some(ue=>ue.type==="tongs"&&ue.contents.some(je=>je.chemical.id==="paper"||je.chemical.id==="magnesium"))?"bg-white/5 border border-white/5 opacity-40 cursor-not-allowed":"bg-white/10 border border-white/10 hover:bg-white/20"}`,children:[_.jsx("div",{className:`text-2xl transition-transform ${ce?"scale-110":"grayscale text-white/50"}`,children:""}),_.jsx("span",{className:`text-xs font-bold tracking-wide ${ce?"text-white":"text-white/60"}`,children:ce?s?.id==="physical-chemical"?"HEATING...":"BURNER ACTIVE":"Start Burner"}),ce&&_.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-orange-500/50 to-transparent animate-pulse"})]})]}),s?.id==="filtration"&&g.includes("beaker")&&g.includes("funnel")&&g.includes("filter-paper")&&f.includes("muddy-water")&&_.jsx("button",{className:`w-full mt-2 flex items-center justify-center gap-2 px-4 py-3 rounded-lg text-base font-bold transition-all
                                    ${W?"bg-blue-600 scale-95":"bg-blue-500 hover:bg-blue-400"}`,onPointerDown:()=>J(!0),onPointerUp:()=>J(!1),onPointerLeave:()=>J(!1),children:_.jsx("span",{children:"Pour into Funnel"})}),(ee||$)&&_.jsxs("button",{onClick:F,className:`w-full mt-1.5 items-center justify-center gap-2 px-4 py-2 rounded-lg text-xs font-bold transition-all
                                    bg-yellow-500 hover:bg-yellow-400 text-black
                                    ${s?.id==="acids-bases"?"hidden md:flex":"flex"}`,children:[_.jsx("span",{className:"text-sm",children:""}),_.jsx("span",{children:"RESET"})]})]})]})]})}function MM(){const i=De(S=>S.reactionNotification),e=De(S=>S.dismissNotification),t=De(S=>S.isNeutralizationAudioDone),n=De(S=>S.experimentMode),[r,s]=ge.useState(!1),[l,c]=ge.useState(!1),f=i?.reaction?.name==="NEUTRALIZATION COMPLETE!";ge.useEffect(()=>{if(i){if(f&&!t)return;if(s(!0),c(!1),!f){const S=setTimeout(()=>{c(!0),setTimeout(()=>{e(),s(!1)},300)},6e3);return()=>clearTimeout(S)}}},[i,e,f,t]);const d=()=>{c(!0),setTimeout(()=>{e(),s(!1)},300)},m=()=>{c(!0),setTimeout(()=>{e(),s(!1),De.setState({showCompletionPopup:!0})},300)};if(!i||!r)return null;const{reaction:g,products:y}=i,v={bubbles:"",heat:"",color_change:"",precipitate:"",smoke:"",explosion:""};return _.jsx("div",{className:`fixed left-1/2 -translate-x-1/2 z-[2000] transition-all duration-300 
                ${l?"opacity-0 translate-y-4":"opacity-100 translate-y-0"}
                ${n==="sandbox"?"top-[30%] md:top-auto md:bottom-24":"bottom-24"}
            `,children:_.jsxs("div",{className:`glass - panel p - 5 max - w - md shadow - 2xl border ${f?"border-green-500 shadow-green-500/20":"border-cyan-400/30"} `,children:[_.jsxs("div",{className:"flex items-start justify-between gap-4 mb-3",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:`w - 10 h - 10 rounded - full flex items - center justify - center text - white shadow - lg ${f?"bg-gradient-to-br from-green-400 to-emerald-600 shadow-green-500/30":"bg-gradient-to-br from-cyan-400 to-purple-500 shadow-cyan-500/20"} `,children:f?_.jsx(_M,{className:"w-6 h-6"}):_.jsx(dF,{className:"w-6 h-6"})}),_.jsxs("div",{children:[_.jsx("h3",{className:`font - bold text - lg ${f?"text-green-300 drop-shadow-[0_0_8px_rgba(74,222,128,0.5)]":"text-white"} `,children:g.name||"Reaction Occurred!"}),!f&&_.jsx("p",{className:"text-xs text-gray-400",children:"Reaction Occurred!"})]})]}),!f&&_.jsx("button",{onClick:d,className:"text-gray-400 hover:text-white transition-colors p-1",children:_.jsx(r1,{className:"w-4 h-4"})})]}),_.jsxs("div",{className:"text-sm text-gray-300 mb-4 leading-relaxed",children:[_.jsx("p",{children:g.description}),f&&_.jsx("p",{className:"mt-2 font-bold text-cyan-300 text-center text-lg drop-shadow-md",children:"HCl + NaOH  NaCl + HO"})]}),!f&&_.jsxs("div",{className:"mb-3",children:[_.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wide",children:"Products Formed:"}),_.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:y.map(S=>_.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium",style:{backgroundColor:`${S.color} 30`,color:S.color==="#ffffff"?"#cccccc":S.color,border:`1px solid ${S.color} 50`},children:S.formula||S.name},S.id))})]}),g.effects&&g.effects.length>0&&!f&&_.jsx("div",{className:"flex gap-2 mt-3 pt-3 border-t border-white/10",children:g.effects.map(S=>_.jsx("span",{className:"text-xl",title:S,children:v[S]||""},S))}),f&&_.jsxs("button",{onClick:m,className:"w-full mt-2 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-400 hover:to-emerald-500 text-white font-bold py-3 px-6 rounded-lg shadow-lg transform transition-all active:scale-95 flex items-center justify-center gap-2",children:[_.jsx(_M,{className:"w-5 h-5"}),"Done"]})]})})}function Rr(i){"@babel/helpers - typeof";return Rr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rr(i)}var Fu=Uint8Array,Mc=Uint16Array,g2=Int32Array,v2=new Fu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),x2=new Fu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),AM=new Fu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),b4=function(i,e){for(var t=new Mc(31),n=0;n<31;++n)t[n]=e+=1<<i[n-1];for(var r=new g2(t[30]),n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)r[s]=s-t[n]<<5|n;return{b:t,r}},_4=b4(v2,2),CF=_4.b,eS=_4.r;CF[28]=258,eS[258]=28;var NF=b4(x2,0),TM=NF.r,tS=new Mc(32768);for(var ms=0;ms<32768;++ms){var sd=(ms&43690)>>1|(ms&21845)<<1;sd=(sd&52428)>>2|(sd&13107)<<2,sd=(sd&61680)>>4|(sd&3855)<<4,tS[ms]=((sd&65280)>>8|(sd&255)<<8)>>1}var Bg=(function(i,e,t){for(var n=i.length,r=0,s=new Mc(e);r<n;++r)i[r]&&++s[i[r]-1];var l=new Mc(e);for(r=1;r<e;++r)l[r]=l[r-1]+s[r-1]<<1;var c;if(t){c=new Mc(1<<e);var f=15-e;for(r=0;r<n;++r)if(i[r])for(var d=r<<4|i[r],m=e-i[r],g=l[i[r]-1]++<<m,y=g|(1<<m)-1;g<=y;++g)c[tS[g]>>f]=d}else for(c=new Mc(n),r=0;r<n;++r)i[r]&&(c[r]=tS[l[i[r]-1]++]>>15-i[r]);return c}),Lp=new Fu(288);for(var ms=0;ms<144;++ms)Lp[ms]=8;for(var ms=144;ms<256;++ms)Lp[ms]=9;for(var ms=256;ms<280;++ms)Lp[ms]=7;for(var ms=280;ms<288;++ms)Lp[ms]=8;var Ny=new Fu(32);for(var ms=0;ms<32;++ms)Ny[ms]=5;var RF=Bg(Lp,9,0),LF=Bg(Ny,5,0),S4=function(i){return(i+7)/8|0},PF=function(i,e,t){return(t==null||t>i.length)&&(t=i.length),new Fu(i.subarray(e,t))},mh=function(i,e,t){t<<=e&7;var n=e/8|0;i[n]|=t,i[n+1]|=t>>8},_g=function(i,e,t){t<<=e&7;var n=e/8|0;i[n]|=t,i[n+1]|=t>>8,i[n+2]|=t>>16},n_=function(i,e){for(var t=[],n=0;n<i.length;++n)i[n]&&t.push({s:n,f:i[n]});var r=t.length,s=t.slice();if(!r)return{t:M4,l:0};if(r==1){var l=new Fu(t[0].s+1);return l[t[0].s]=1,{t:l,l:1}}t.sort(function(z,j){return z.f-j.f}),t.push({s:-1,f:25001});var c=t[0],f=t[1],d=0,m=1,g=2;for(t[0]={s:-1,f:c.f+f.f,l:c,r:f};m!=r-1;)c=t[t[d].f<t[g].f?d++:g++],f=t[d!=m&&t[d].f<t[g].f?d++:g++],t[m++]={s:-1,f:c.f+f.f,l:c,r:f};for(var y=s[0].s,n=1;n<r;++n)s[n].s>y&&(y=s[n].s);var v=new Mc(y+1),S=nS(t[m-1],v,0);if(S>e){var n=0,T=0,A=S-e,w=1<<A;for(s.sort(function(j,X){return v[X.s]-v[j.s]||j.f-X.f});n<r;++n){var R=s[n].s;if(v[R]>e)T+=w-(1<<S-v[R]),v[R]=e;else break}for(T>>=A;T>0;){var D=s[n].s;v[D]<e?T-=1<<e-v[D]++-1:++n}for(;n>=0&&T;--n){var I=s[n].s;v[I]==e&&(--v[I],++T)}S=e}return{t:new Fu(v),l:S}},nS=function(i,e,t){return i.s==-1?Math.max(nS(i.l,e,t+1),nS(i.r,e,t+1)):e[i.s]=t},EM=function(i){for(var e=i.length;e&&!i[--e];);for(var t=new Mc(++e),n=0,r=i[0],s=1,l=function(f){t[n++]=f},c=1;c<=e;++c)if(i[c]==r&&c!=e)++s;else{if(!r&&s>2){for(;s>138;s-=138)l(32754);s>2&&(l(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(l(r),--s;s>6;s-=6)l(8304);s>2&&(l(s-3<<5|8208),s=0)}for(;s--;)l(r);s=1,r=i[c]}return{c:t.subarray(0,n),n:e}},Sg=function(i,e){for(var t=0,n=0;n<e.length;++n)t+=i[n]*e[n];return t},w4=function(i,e,t){var n=t.length,r=S4(e+2);i[r]=n&255,i[r+1]=n>>8,i[r+2]=i[r]^255,i[r+3]=i[r+1]^255;for(var s=0;s<n;++s)i[r+s+4]=t[s];return(r+4+n)*8},CM=function(i,e,t,n,r,s,l,c,f,d,m){mh(e,m++,t),++r[256];for(var g=n_(r,15),y=g.t,v=g.l,S=n_(s,15),T=S.t,A=S.l,w=EM(y),R=w.c,D=w.n,I=EM(T),z=I.c,j=I.n,X=new Mc(19),G=0;G<R.length;++G)++X[R[G]&31];for(var G=0;G<z.length;++G)++X[z[G]&31];for(var L=n_(X,7),k=L.t,U=L.l,q=19;q>4&&!k[AM[q-1]];--q);var W=d+5<<3,J=Sg(r,Lp)+Sg(s,Ny)+l,ce=Sg(r,y)+Sg(s,T)+l+14+3*q+Sg(X,k)+2*X[16]+3*X[17]+7*X[18];if(f>=0&&W<=J&&W<=ce)return w4(e,m,i.subarray(f,f+d));var K,ne,pe,Re;if(mh(e,m,1+(ce<J)),m+=2,ce<J){K=Bg(y,v,0),ne=y,pe=Bg(T,A,0),Re=T;var Te=Bg(k,U,0);mh(e,m,D-257),mh(e,m+5,j-1),mh(e,m+10,q-4),m+=14;for(var G=0;G<q;++G)mh(e,m+3*G,k[AM[G]]);m+=3*q;for(var ee=[R,z],F=0;F<2;++F)for(var $=ee[F],G=0;G<$.length;++G){var re=$[G]&31;mh(e,m,Te[re]),m+=k[re],re>15&&(mh(e,m,$[G]>>5&127),m+=$[G]>>12)}}else K=RF,ne=Lp,pe=LF,Re=Ny;for(var G=0;G<c;++G){var Ae=n[G];if(Ae>255){var re=Ae>>18&31;_g(e,m,K[re+257]),m+=ne[re+257],re>7&&(mh(e,m,Ae>>23&31),m+=v2[re]);var ie=Ae&31;_g(e,m,pe[ie]),m+=Re[ie],ie>3&&(_g(e,m,Ae>>5&8191),m+=x2[ie])}else _g(e,m,K[Ae]),m+=ne[Ae]}return _g(e,m,K[256]),m+ne[256]},IF=new g2([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),M4=new Fu(0),DF=function(i,e,t,n,r,s){var l=s.z||i.length,c=new Fu(n+l+5*(1+Math.ceil(l/7e3))+r),f=c.subarray(n,c.length-r),d=s.l,m=(s.r||0)&7;if(e){m&&(f[0]=s.r>>3);for(var g=IF[e-1],y=g>>13,v=g&8191,S=(1<<t)-1,T=s.p||new Mc(32768),A=s.h||new Mc(S+1),w=Math.ceil(t/3),R=2*w,D=function(Je){return(i[Je]^i[Je+1]<<w^i[Je+2]<<R)&S},I=new g2(25e3),z=new Mc(288),j=new Mc(32),X=0,G=0,L=s.i||0,k=0,U=s.w||0,q=0;L+2<l;++L){var W=D(L),J=L&32767,ce=A[W];if(T[J]=ce,A[W]=J,U<=L){var K=l-L;if((X>7e3||k>24576)&&(K>423||!d)){m=CM(i,f,0,I,z,j,G,k,q,L-q,m),k=X=G=0,q=L;for(var ne=0;ne<286;++ne)z[ne]=0;for(var ne=0;ne<30;++ne)j[ne]=0}var pe=2,Re=0,Te=v,ee=J-ce&32767;if(K>2&&W==D(L-ee))for(var F=Math.min(y,K)-1,$=Math.min(32767,L),re=Math.min(258,K);ee<=$&&--Te&&J!=ce;){if(i[L+pe]==i[L+pe-ee]){for(var Ae=0;Ae<re&&i[L+Ae]==i[L+Ae-ee];++Ae);if(Ae>pe){if(pe=Ae,Re=ee,Ae>F)break;for(var ie=Math.min(ee,Ae-2),_e=0,ne=0;ne<ie;++ne){var ke=L-ee+ne&32767,Fe=T[ke],We=ke-Fe&32767;We>_e&&(_e=We,ce=ke)}}}J=ce,ce=T[J],ee+=J-ce&32767}if(Re){I[k++]=268435456|eS[pe]<<18|TM[Re];var nt=eS[pe]&31,It=TM[Re]&31;G+=v2[nt]+x2[It],++z[257+nt],++j[It],U=L+pe,++X}else I[k++]=i[L],++z[i[L]]}}for(L=Math.max(L,U);L<l;++L)I[k++]=i[L],++z[i[L]];m=CM(i,f,d,I,z,j,G,k,q,L-q,m),d||(s.r=m&7|f[m/8|0]<<3,m-=7,s.h=A,s.p=T,s.i=L,s.w=U)}else{for(var L=s.w||0;L<l+d;L+=65535){var wt=L+65535;wt>=l&&(f[m/8|0]=d,wt=l),m=w4(f,m+1,i.subarray(L,wt))}s.i=l}return PF(c,0,n+S4(m)+r)},A4=function(){var i=1,e=0;return{p:function(t){for(var n=i,r=e,s=t.length|0,l=0;l!=s;){for(var c=Math.min(l+2655,s);l<c;++l)r+=n+=t[l];n=(n&65535)+15*(n>>16),r=(r&65535)+15*(r>>16)}i=n,e=r},d:function(){return i%=65521,e%=65521,(i&255)<<24|(i&65280)<<8|(e&255)<<8|e>>8}}},kF=function(i,e,t,n,r){if(!r&&(r={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),l=new Fu(s.length+i.length);l.set(s),l.set(i,s.length),i=l,r.w=s.length}return DF(i,e.level==null?6:e.level,e.mem==null?r.l?Math.ceil(Math.max(8,Math.min(13,Math.log(i.length)))*1.5):20:12+e.mem,t,n,r)},T4=function(i,e,t){for(;t;++e)i[e]=t,t>>>=8},OF=function(i,e){var t=e.level,n=t==0?0:t<6?1:t==9?3:2;if(i[0]=120,i[1]=n<<6|(e.dictionary&&32),i[1]|=31-(i[0]<<8|i[1])%31,e.dictionary){var r=A4();r.p(e.dictionary),T4(i,2,r.d())}};function iS(i,e){e||(e={});var t=A4();t.p(i);var n=kF(i,e,e.dictionary?6:2,4);return OF(n,e),T4(n,n.length-4,t.d()),n}var BF=typeof TextDecoder<"u"&&new TextDecoder,UF=0;try{BF.decode(M4,{stream:!0}),UF=1}catch{}function FF(i){if(Array.isArray(i))return i}function zF(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,l,c=[],f=!0,d=!1;try{if(s=(t=t.call(i)).next,e!==0)for(;!(f=(n=s.call(t)).done)&&(c.push(n.value),c.length!==e);f=!0);}catch(m){d=!0,r=m}finally{try{if(!f&&t.return!=null&&(l=t.return(),Object(l)!==l))return}finally{if(d)throw r}}return c}}function NM(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function jF(i,e){if(i){if(typeof i=="string")return NM(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?NM(i,e):void 0}}function VF(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RM(i,e){return FF(i)||zF(i,e)||jF(i,e)||VF()}function LM(i,e="utf8"){return new TextDecoder(e).decode(i)}const HF=new TextEncoder;function GF(i){return HF.encode(i)}const qF=1024*8,WF=(()=>{const i=new Uint8Array(4),e=new Uint32Array(i.buffer);return!((e[0]=1)&i[0])})(),i_={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class y2{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=qF,t={}){let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const r=t.offset?t.offset>>>0:0,s=e.byteLength-r;let l=r;(ArrayBuffer.isView(e)||e instanceof y2)&&(e.byteLength!==e.buffer.byteLength&&(l=e.byteOffset+r),e=e.buffer),n?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=l,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,l,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,r=new Uint8Array(n);r.set(new Uint8Array(this.buffer)),this.buffer=r.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,t){const n=i_[t].BYTES_PER_ELEMENT*e,r=this.byteOffset+this.offset,s=this.buffer.slice(r,r+n);if(this.littleEndian===WF&&t!=="uint8"&&t!=="int8"){const c=new Uint8Array(this.buffer.slice(r,r+n));c.reverse();const f=new i_[t](c.buffer);return this.offset+=n,f.reverse(),f}const l=new i_[t](s);return this.offset+=n,l}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let t="";for(let n=0;n<e;n++)t+=this.readChar();return t}readUtf8(e=1){return LM(this.readBytes(e))}decodeText(e=1,t="utf8"){return LM(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(GF(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function A0(i){let e=i.length;for(;--e>=0;)i[e]=0}const XF=3,YF=258,E4=29,ZF=256,$F=ZF+1+E4,C4=30,JF=512,KF=new Array(($F+2)*2);A0(KF);const QF=new Array(C4*2);A0(QF);const e7=new Array(JF);A0(e7);const t7=new Array(YF-XF+1);A0(t7);const n7=new Array(E4);A0(n7);const i7=new Array(C4);A0(i7);const r7=(i,e,t,n)=>{let r=i&65535|0,s=i>>>16&65535|0,l=0;for(;t!==0;){l=t>2e3?2e3:t,t-=l;do r=r+e[n++]|0,s=s+r|0;while(--l);r%=65521,s%=65521}return r|s<<16|0};var rS=r7;const s7=()=>{let i,e=[];for(var t=0;t<256;t++){i=t;for(var n=0;n<8;n++)i=i&1?3988292384^i>>>1:i>>>1;e[t]=i}return e},a7=new Uint32Array(s7()),o7=(i,e,t,n)=>{const r=a7,s=n+t;i^=-1;for(let l=n;l<s;l++)i=i>>>8^r[(i^e[l])&255];return i^-1};var Ef=o7,sS={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},N4={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const l7=(i,e)=>Object.prototype.hasOwnProperty.call(i,e);var c7=function(i){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const n in t)l7(t,n)&&(i[n]=t[n])}}return i},u7=i=>{let e=0;for(let n=0,r=i.length;n<r;n++)e+=i[n].length;const t=new Uint8Array(e);for(let n=0,r=0,s=i.length;n<s;n++){let l=i[n];t.set(l,r),r+=l.length}return t},R4={assign:c7,flattenChunks:u7};let L4=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{L4=!1}const s1=new Uint8Array(256);for(let i=0;i<256;i++)s1[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;s1[254]=s1[254]=1;var f7=i=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(i);let e,t,n,r,s,l=i.length,c=0;for(r=0;r<l;r++)t=i.charCodeAt(r),(t&64512)===55296&&r+1<l&&(n=i.charCodeAt(r+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),r++)),c+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(c),s=0,r=0;s<c;r++)t=i.charCodeAt(r),(t&64512)===55296&&r+1<l&&(n=i.charCodeAt(r+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),r++)),t<128?e[s++]=t:t<2048?(e[s++]=192|t>>>6,e[s++]=128|t&63):t<65536?(e[s++]=224|t>>>12,e[s++]=128|t>>>6&63,e[s++]=128|t&63):(e[s++]=240|t>>>18,e[s++]=128|t>>>12&63,e[s++]=128|t>>>6&63,e[s++]=128|t&63);return e};const h7=(i,e)=>{if(e<65534&&i.subarray&&L4)return String.fromCharCode.apply(null,i.length===e?i:i.subarray(0,e));let t="";for(let n=0;n<e;n++)t+=String.fromCharCode(i[n]);return t};var d7=(i,e)=>{const t=e||i.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(i.subarray(0,e));let n,r;const s=new Array(t*2);for(r=0,n=0;n<t;){let l=i[n++];if(l<128){s[r++]=l;continue}let c=s1[l];if(c>4){s[r++]=65533,n+=c-1;continue}for(l&=c===2?31:c===3?15:7;c>1&&n<t;)l=l<<6|i[n++]&63,c--;if(c>1){s[r++]=65533;continue}l<65536?s[r++]=l:(l-=65536,s[r++]=55296|l>>10&1023,s[r++]=56320|l&1023)}return h7(s,r)},p7=(i,e)=>{e=e||i.length,e>i.length&&(e=i.length);let t=e-1;for(;t>=0&&(i[t]&192)===128;)t--;return t<0||t===0?e:t+s1[i[t]]>e?t:e},aS={string2buf:f7,buf2string:d7,utf8border:p7};function m7(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var g7=m7;const ux=16209,v7=16191;var x7=function(e,t){let n,r,s,l,c,f,d,m,g,y,v,S,T,A,w,R,D,I,z,j,X,G,L,k;const U=e.state;n=e.next_in,L=e.input,r=n+(e.avail_in-5),s=e.next_out,k=e.output,l=s-(t-e.avail_out),c=s+(e.avail_out-257),f=U.dmax,d=U.wsize,m=U.whave,g=U.wnext,y=U.window,v=U.hold,S=U.bits,T=U.lencode,A=U.distcode,w=(1<<U.lenbits)-1,R=(1<<U.distbits)-1;e:do{S<15&&(v+=L[n++]<<S,S+=8,v+=L[n++]<<S,S+=8),D=T[v&w];t:for(;;){if(I=D>>>24,v>>>=I,S-=I,I=D>>>16&255,I===0)k[s++]=D&65535;else if(I&16){z=D&65535,I&=15,I&&(S<I&&(v+=L[n++]<<S,S+=8),z+=v&(1<<I)-1,v>>>=I,S-=I),S<15&&(v+=L[n++]<<S,S+=8,v+=L[n++]<<S,S+=8),D=A[v&R];n:for(;;){if(I=D>>>24,v>>>=I,S-=I,I=D>>>16&255,I&16){if(j=D&65535,I&=15,S<I&&(v+=L[n++]<<S,S+=8,S<I&&(v+=L[n++]<<S,S+=8)),j+=v&(1<<I)-1,j>f){e.msg="invalid distance too far back",U.mode=ux;break e}if(v>>>=I,S-=I,I=s-l,j>I){if(I=j-I,I>m&&U.sane){e.msg="invalid distance too far back",U.mode=ux;break e}if(X=0,G=y,g===0){if(X+=d-I,I<z){z-=I;do k[s++]=y[X++];while(--I);X=s-j,G=k}}else if(g<I){if(X+=d+g-I,I-=g,I<z){z-=I;do k[s++]=y[X++];while(--I);if(X=0,g<z){I=g,z-=I;do k[s++]=y[X++];while(--I);X=s-j,G=k}}}else if(X+=g-I,I<z){z-=I;do k[s++]=y[X++];while(--I);X=s-j,G=k}for(;z>2;)k[s++]=G[X++],k[s++]=G[X++],k[s++]=G[X++],z-=3;z&&(k[s++]=G[X++],z>1&&(k[s++]=G[X++]))}else{X=s-j;do k[s++]=k[X++],k[s++]=k[X++],k[s++]=k[X++],z-=3;while(z>2);z&&(k[s++]=k[X++],z>1&&(k[s++]=k[X++]))}}else if((I&64)===0){D=A[(D&65535)+(v&(1<<I)-1)];continue n}else{e.msg="invalid distance code",U.mode=ux;break e}break}}else if((I&64)===0){D=T[(D&65535)+(v&(1<<I)-1)];continue t}else if(I&32){U.mode=v7;break e}else{e.msg="invalid literal/length code",U.mode=ux;break e}break}}while(n<r&&s<c);z=S>>3,n-=z,S-=z<<3,v&=(1<<S)-1,e.next_in=n,e.next_out=s,e.avail_in=n<r?5+(r-n):5-(n-r),e.avail_out=s<c?257+(c-s):257-(s-c),U.hold=v,U.bits=S};const Fm=15,PM=852,IM=592,DM=0,r_=1,kM=2,y7=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),b7=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),_7=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),S7=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),w7=(i,e,t,n,r,s,l,c)=>{const f=c.bits;let d=0,m=0,g=0,y=0,v=0,S=0,T=0,A=0,w=0,R=0,D,I,z,j,X,G=null,L;const k=new Uint16Array(Fm+1),U=new Uint16Array(Fm+1);let q=null,W,J,ce;for(d=0;d<=Fm;d++)k[d]=0;for(m=0;m<n;m++)k[e[t+m]]++;for(v=f,y=Fm;y>=1&&k[y]===0;y--);if(v>y&&(v=y),y===0)return r[s++]=1<<24|64<<16|0,r[s++]=1<<24|64<<16|0,c.bits=1,0;for(g=1;g<y&&k[g]===0;g++);for(v<g&&(v=g),A=1,d=1;d<=Fm;d++)if(A<<=1,A-=k[d],A<0)return-1;if(A>0&&(i===DM||y!==1))return-1;for(U[1]=0,d=1;d<Fm;d++)U[d+1]=U[d]+k[d];for(m=0;m<n;m++)e[t+m]!==0&&(l[U[e[t+m]]++]=m);if(i===DM?(G=q=l,L=20):i===r_?(G=y7,q=b7,L=257):(G=_7,q=S7,L=0),R=0,m=0,d=g,X=s,S=v,T=0,z=-1,w=1<<v,j=w-1,i===r_&&w>PM||i===kM&&w>IM)return 1;for(;;){W=d-T,l[m]+1<L?(J=0,ce=l[m]):l[m]>=L?(J=q[l[m]-L],ce=G[l[m]-L]):(J=96,ce=0),D=1<<d-T,I=1<<S,g=I;do I-=D,r[X+(R>>T)+I]=W<<24|J<<16|ce|0;while(I!==0);for(D=1<<d-1;R&D;)D>>=1;if(D!==0?(R&=D-1,R+=D):R=0,m++,--k[d]===0){if(d===y)break;d=e[t+l[m]]}if(d>v&&(R&j)!==z){for(T===0&&(T=v),X+=g,S=d-T,A=1<<S;S+T<y&&(A-=k[S+T],!(A<=0));)S++,A<<=1;if(w+=1<<S,i===r_&&w>PM||i===kM&&w>IM)return 1;z=R&j,r[z]=v<<24|S<<16|X-s|0}}return R!==0&&(r[X+R]=d-T<<24|64<<16|0),c.bits=v,0};var Ug=w7;const M7=0,P4=1,I4=2,{Z_FINISH:OM,Z_BLOCK:A7,Z_TREES:fx,Z_OK:Pp,Z_STREAM_END:T7,Z_NEED_DICT:E7,Z_STREAM_ERROR:ou,Z_DATA_ERROR:D4,Z_MEM_ERROR:k4,Z_BUF_ERROR:C7,Z_DEFLATED:BM}=N4,xb=16180,UM=16181,FM=16182,zM=16183,jM=16184,VM=16185,HM=16186,GM=16187,qM=16188,WM=16189,Ry=16190,gh=16191,s_=16192,XM=16193,a_=16194,YM=16195,ZM=16196,$M=16197,JM=16198,hx=16199,dx=16200,KM=16201,QM=16202,eA=16203,tA=16204,nA=16205,o_=16206,iA=16207,rA=16208,As=16209,O4=16210,B4=16211,N7=852,R7=592,L7=15,P7=L7,sA=i=>(i>>>24&255)+(i>>>8&65280)+((i&65280)<<8)+((i&255)<<24);function I7(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Bp=i=>{if(!i)return 1;const e=i.state;return!e||e.strm!==i||e.mode<xb||e.mode>B4?1:0},U4=i=>{if(Bp(i))return ou;const e=i.state;return i.total_in=i.total_out=e.total=0,i.msg="",e.wrap&&(i.adler=e.wrap&1),e.mode=xb,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(N7),e.distcode=e.distdyn=new Int32Array(R7),e.sane=1,e.back=-1,Pp},F4=i=>{if(Bp(i))return ou;const e=i.state;return e.wsize=0,e.whave=0,e.wnext=0,U4(i)},z4=(i,e)=>{let t;if(Bp(i))return ou;const n=i.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?ou:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=t,n.wbits=e,F4(i))},j4=(i,e)=>{if(!i)return ou;const t=new I7;i.state=t,t.strm=i,t.window=null,t.mode=xb;const n=z4(i,e);return n!==Pp&&(i.state=null),n},D7=i=>j4(i,P7);let aA=!0,l_,c_;const k7=i=>{if(aA){l_=new Int32Array(512),c_=new Int32Array(32);let e=0;for(;e<144;)i.lens[e++]=8;for(;e<256;)i.lens[e++]=9;for(;e<280;)i.lens[e++]=7;for(;e<288;)i.lens[e++]=8;for(Ug(P4,i.lens,0,288,l_,0,i.work,{bits:9}),e=0;e<32;)i.lens[e++]=5;Ug(I4,i.lens,0,32,c_,0,i.work,{bits:5}),aA=!1}i.lencode=l_,i.lenbits=9,i.distcode=c_,i.distbits=5},V4=(i,e,t,n)=>{let r;const s=i.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(e.subarray(t-s.wsize,t),0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>n&&(r=n),s.window.set(e.subarray(t-n,t-n+r),s.wnext),n-=r,n?(s.window.set(e.subarray(t-n,t),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0},O7=(i,e)=>{let t,n,r,s,l,c,f,d,m,g,y,v,S,T,A=0,w,R,D,I,z,j,X,G;const L=new Uint8Array(4);let k,U;const q=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Bp(i)||!i.output||!i.input&&i.avail_in!==0)return ou;t=i.state,t.mode===gh&&(t.mode=s_),l=i.next_out,r=i.output,f=i.avail_out,s=i.next_in,n=i.input,c=i.avail_in,d=t.hold,m=t.bits,g=c,y=f,G=Pp;e:for(;;)switch(t.mode){case xb:if(t.wrap===0){t.mode=s_;break}for(;m<16;){if(c===0)break e;c--,d+=n[s++]<<m,m+=8}if(t.wrap&2&&d===35615){t.wbits===0&&(t.wbits=15),t.check=0,L[0]=d&255,L[1]=d>>>8&255,t.check=Ef(t.check,L,2,0),d=0,m=0,t.mode=UM;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((d&255)<<8)+(d>>8))%31){i.msg="incorrect header check",t.mode=As;break}if((d&15)!==BM){i.msg="unknown compression method",t.mode=As;break}if(d>>>=4,m-=4,X=(d&15)+8,t.wbits===0&&(t.wbits=X),X>15||X>t.wbits){i.msg="invalid window size",t.mode=As;break}t.dmax=1<<t.wbits,t.flags=0,i.adler=t.check=1,t.mode=d&512?WM:gh,d=0,m=0;break;case UM:for(;m<16;){if(c===0)break e;c--,d+=n[s++]<<m,m+=8}if(t.flags=d,(t.flags&255)!==BM){i.msg="unknown compression method",t.mode=As;break}if(t.flags&57344){i.msg="unknown header flags set",t.mode=As;break}t.head&&(t.head.text=d>>8&1),t.flags&512&&t.wrap&4&&(L[0]=d&255,L[1]=d>>>8&255,t.check=Ef(t.check,L,2,0)),d=0,m=0,t.mode=FM;case FM:for(;m<32;){if(c===0)break e;c--,d+=n[s++]<<m,m+=8}t.head&&(t.head.time=d),t.flags&512&&t.wrap&4&&(L[0]=d&255,L[1]=d>>>8&255,L[2]=d>>>16&255,L[3]=d>>>24&255,t.check=Ef(t.check,L,4,0)),d=0,m=0,t.mode=zM;case zM:for(;m<16;){if(c===0)break e;c--,d+=n[s++]<<m,m+=8}t.head&&(t.head.xflags=d&255,t.head.os=d>>8),t.flags&512&&t.wrap&4&&(L[0]=d&255,L[1]=d>>>8&255,t.check=Ef(t.check,L,2,0)),d=0,m=0,t.mode=jM;case jM:if(t.flags&1024){for(;m<16;){if(c===0)break e;c--,d+=n[s++]<<m,m+=8}t.length=d,t.head&&(t.head.extra_len=d),t.flags&512&&t.wrap&4&&(L[0]=d&255,L[1]=d>>>8&255,t.check=Ef(t.check,L,2,0)),d=0,m=0}else t.head&&(t.head.extra=null);t.mode=VM;case VM:if(t.flags&1024&&(v=t.length,v>c&&(v=c),v&&(t.head&&(X=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(n.subarray(s,s+v),X)),t.flags&512&&t.wrap&4&&(t.check=Ef(t.check,n,v,s)),c-=v,s+=v,t.length-=v),t.length))break e;t.length=0,t.mode=HM;case HM:if(t.flags&2048){if(c===0)break e;v=0;do X=n[s+v++],t.head&&X&&t.length<65536&&(t.head.name+=String.fromCharCode(X));while(X&&v<c);if(t.flags&512&&t.wrap&4&&(t.check=Ef(t.check,n,v,s)),c-=v,s+=v,X)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=GM;case GM:if(t.flags&4096){if(c===0)break e;v=0;do X=n[s+v++],t.head&&X&&t.length<65536&&(t.head.comment+=String.fromCharCode(X));while(X&&v<c);if(t.flags&512&&t.wrap&4&&(t.check=Ef(t.check,n,v,s)),c-=v,s+=v,X)break e}else t.head&&(t.head.comment=null);t.mode=qM;case qM:if(t.flags&512){for(;m<16;){if(c===0)break e;c--,d+=n[s++]<<m,m+=8}if(t.wrap&4&&d!==(t.check&65535)){i.msg="header crc mismatch",t.mode=As;break}d=0,m=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),i.adler=t.check=0,t.mode=gh;break;case WM:for(;m<32;){if(c===0)break e;c--,d+=n[s++]<<m,m+=8}i.adler=t.check=sA(d),d=0,m=0,t.mode=Ry;case Ry:if(t.havedict===0)return i.next_out=l,i.avail_out=f,i.next_in=s,i.avail_in=c,t.hold=d,t.bits=m,E7;i.adler=t.check=1,t.mode=gh;case gh:if(e===A7||e===fx)break e;case s_:if(t.last){d>>>=m&7,m-=m&7,t.mode=o_;break}for(;m<3;){if(c===0)break e;c--,d+=n[s++]<<m,m+=8}switch(t.last=d&1,d>>>=1,m-=1,d&3){case 0:t.mode=XM;break;case 1:if(k7(t),t.mode=hx,e===fx){d>>>=2,m-=2;break e}break;case 2:t.mode=ZM;break;case 3:i.msg="invalid block type",t.mode=As}d>>>=2,m-=2;break;case XM:for(d>>>=m&7,m-=m&7;m<32;){if(c===0)break e;c--,d+=n[s++]<<m,m+=8}if((d&65535)!==(d>>>16^65535)){i.msg="invalid stored block lengths",t.mode=As;break}if(t.length=d&65535,d=0,m=0,t.mode=a_,e===fx)break e;case a_:t.mode=YM;case YM:if(v=t.length,v){if(v>c&&(v=c),v>f&&(v=f),v===0)break e;r.set(n.subarray(s,s+v),l),c-=v,s+=v,f-=v,l+=v,t.length-=v;break}t.mode=gh;break;case ZM:for(;m<14;){if(c===0)break e;c--,d+=n[s++]<<m,m+=8}if(t.nlen=(d&31)+257,d>>>=5,m-=5,t.ndist=(d&31)+1,d>>>=5,m-=5,t.ncode=(d&15)+4,d>>>=4,m-=4,t.nlen>286||t.ndist>30){i.msg="too many length or distance symbols",t.mode=As;break}t.have=0,t.mode=$M;case $M:for(;t.have<t.ncode;){for(;m<3;){if(c===0)break e;c--,d+=n[s++]<<m,m+=8}t.lens[q[t.have++]]=d&7,d>>>=3,m-=3}for(;t.have<19;)t.lens[q[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,k={bits:t.lenbits},G=Ug(M7,t.lens,0,19,t.lencode,0,t.work,k),t.lenbits=k.bits,G){i.msg="invalid code lengths set",t.mode=As;break}t.have=0,t.mode=JM;case JM:for(;t.have<t.nlen+t.ndist;){for(;A=t.lencode[d&(1<<t.lenbits)-1],w=A>>>24,R=A>>>16&255,D=A&65535,!(w<=m);){if(c===0)break e;c--,d+=n[s++]<<m,m+=8}if(D<16)d>>>=w,m-=w,t.lens[t.have++]=D;else{if(D===16){for(U=w+2;m<U;){if(c===0)break e;c--,d+=n[s++]<<m,m+=8}if(d>>>=w,m-=w,t.have===0){i.msg="invalid bit length repeat",t.mode=As;break}X=t.lens[t.have-1],v=3+(d&3),d>>>=2,m-=2}else if(D===17){for(U=w+3;m<U;){if(c===0)break e;c--,d+=n[s++]<<m,m+=8}d>>>=w,m-=w,X=0,v=3+(d&7),d>>>=3,m-=3}else{for(U=w+7;m<U;){if(c===0)break e;c--,d+=n[s++]<<m,m+=8}d>>>=w,m-=w,X=0,v=11+(d&127),d>>>=7,m-=7}if(t.have+v>t.nlen+t.ndist){i.msg="invalid bit length repeat",t.mode=As;break}for(;v--;)t.lens[t.have++]=X}}if(t.mode===As)break;if(t.lens[256]===0){i.msg="invalid code -- missing end-of-block",t.mode=As;break}if(t.lenbits=9,k={bits:t.lenbits},G=Ug(P4,t.lens,0,t.nlen,t.lencode,0,t.work,k),t.lenbits=k.bits,G){i.msg="invalid literal/lengths set",t.mode=As;break}if(t.distbits=6,t.distcode=t.distdyn,k={bits:t.distbits},G=Ug(I4,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,k),t.distbits=k.bits,G){i.msg="invalid distances set",t.mode=As;break}if(t.mode=hx,e===fx)break e;case hx:t.mode=dx;case dx:if(c>=6&&f>=258){i.next_out=l,i.avail_out=f,i.next_in=s,i.avail_in=c,t.hold=d,t.bits=m,x7(i,y),l=i.next_out,r=i.output,f=i.avail_out,s=i.next_in,n=i.input,c=i.avail_in,d=t.hold,m=t.bits,t.mode===gh&&(t.back=-1);break}for(t.back=0;A=t.lencode[d&(1<<t.lenbits)-1],w=A>>>24,R=A>>>16&255,D=A&65535,!(w<=m);){if(c===0)break e;c--,d+=n[s++]<<m,m+=8}if(R&&(R&240)===0){for(I=w,z=R,j=D;A=t.lencode[j+((d&(1<<I+z)-1)>>I)],w=A>>>24,R=A>>>16&255,D=A&65535,!(I+w<=m);){if(c===0)break e;c--,d+=n[s++]<<m,m+=8}d>>>=I,m-=I,t.back+=I}if(d>>>=w,m-=w,t.back+=w,t.length=D,R===0){t.mode=nA;break}if(R&32){t.back=-1,t.mode=gh;break}if(R&64){i.msg="invalid literal/length code",t.mode=As;break}t.extra=R&15,t.mode=KM;case KM:if(t.extra){for(U=t.extra;m<U;){if(c===0)break e;c--,d+=n[s++]<<m,m+=8}t.length+=d&(1<<t.extra)-1,d>>>=t.extra,m-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=QM;case QM:for(;A=t.distcode[d&(1<<t.distbits)-1],w=A>>>24,R=A>>>16&255,D=A&65535,!(w<=m);){if(c===0)break e;c--,d+=n[s++]<<m,m+=8}if((R&240)===0){for(I=w,z=R,j=D;A=t.distcode[j+((d&(1<<I+z)-1)>>I)],w=A>>>24,R=A>>>16&255,D=A&65535,!(I+w<=m);){if(c===0)break e;c--,d+=n[s++]<<m,m+=8}d>>>=I,m-=I,t.back+=I}if(d>>>=w,m-=w,t.back+=w,R&64){i.msg="invalid distance code",t.mode=As;break}t.offset=D,t.extra=R&15,t.mode=eA;case eA:if(t.extra){for(U=t.extra;m<U;){if(c===0)break e;c--,d+=n[s++]<<m,m+=8}t.offset+=d&(1<<t.extra)-1,d>>>=t.extra,m-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){i.msg="invalid distance too far back",t.mode=As;break}t.mode=tA;case tA:if(f===0)break e;if(v=y-f,t.offset>v){if(v=t.offset-v,v>t.whave&&t.sane){i.msg="invalid distance too far back",t.mode=As;break}v>t.wnext?(v-=t.wnext,S=t.wsize-v):S=t.wnext-v,v>t.length&&(v=t.length),T=t.window}else T=r,S=l-t.offset,v=t.length;v>f&&(v=f),f-=v,t.length-=v;do r[l++]=T[S++];while(--v);t.length===0&&(t.mode=dx);break;case nA:if(f===0)break e;r[l++]=t.length,f--,t.mode=dx;break;case o_:if(t.wrap){for(;m<32;){if(c===0)break e;c--,d|=n[s++]<<m,m+=8}if(y-=f,i.total_out+=y,t.total+=y,t.wrap&4&&y&&(i.adler=t.check=t.flags?Ef(t.check,r,y,l-y):rS(t.check,r,y,l-y)),y=f,t.wrap&4&&(t.flags?d:sA(d))!==t.check){i.msg="incorrect data check",t.mode=As;break}d=0,m=0}t.mode=iA;case iA:if(t.wrap&&t.flags){for(;m<32;){if(c===0)break e;c--,d+=n[s++]<<m,m+=8}if(t.wrap&4&&d!==(t.total&4294967295)){i.msg="incorrect length check",t.mode=As;break}d=0,m=0}t.mode=rA;case rA:G=T7;break e;case As:G=D4;break e;case O4:return k4;case B4:default:return ou}return i.next_out=l,i.avail_out=f,i.next_in=s,i.avail_in=c,t.hold=d,t.bits=m,(t.wsize||y!==i.avail_out&&t.mode<As&&(t.mode<o_||e!==OM))&&V4(i,i.output,i.next_out,y-i.avail_out),g-=i.avail_in,y-=i.avail_out,i.total_in+=g,i.total_out+=y,t.total+=y,t.wrap&4&&y&&(i.adler=t.check=t.flags?Ef(t.check,r,y,i.next_out-y):rS(t.check,r,y,i.next_out-y)),i.data_type=t.bits+(t.last?64:0)+(t.mode===gh?128:0)+(t.mode===hx||t.mode===a_?256:0),(g===0&&y===0||e===OM)&&G===Pp&&(G=C7),G},B7=i=>{if(Bp(i))return ou;let e=i.state;return e.window&&(e.window=null),i.state=null,Pp},U7=(i,e)=>{if(Bp(i))return ou;const t=i.state;return(t.wrap&2)===0?ou:(t.head=e,e.done=!1,Pp)},F7=(i,e)=>{const t=e.length;let n,r,s;return Bp(i)||(n=i.state,n.wrap!==0&&n.mode!==Ry)?ou:n.mode===Ry&&(r=1,r=rS(r,e,t,0),r!==n.check)?D4:(s=V4(i,e,t,t),s?(n.mode=O4,k4):(n.havedict=1,Pp))};var z7=F4,j7=z4,V7=U4,H7=D7,G7=j4,q7=O7,W7=B7,X7=U7,Y7=F7,Z7="pako inflate (from Nodeca project)",vh={inflateReset:z7,inflateReset2:j7,inflateResetKeep:V7,inflateInit:H7,inflateInit2:G7,inflate:q7,inflateEnd:W7,inflateGetHeader:X7,inflateSetDictionary:Y7,inflateInfo:Z7};function $7(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var J7=$7;const H4=Object.prototype.toString,{Z_NO_FLUSH:K7,Z_FINISH:Q7,Z_OK:a1,Z_STREAM_END:u_,Z_NEED_DICT:f_,Z_STREAM_ERROR:ez,Z_DATA_ERROR:oA,Z_MEM_ERROR:tz}=N4;function A1(i){this.options=R4.assign({chunkSize:1024*64,windowBits:15,to:""},i||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(i&&i.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g7,this.strm.avail_out=0;let t=vh.inflateInit2(this.strm,e.windowBits);if(t!==a1)throw new Error(sS[t]);if(this.header=new J7,vh.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=aS.string2buf(e.dictionary):H4.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=vh.inflateSetDictionary(this.strm,e.dictionary),t!==a1)))throw new Error(sS[t])}A1.prototype.push=function(i,e){const t=this.strm,n=this.options.chunkSize,r=this.options.dictionary;let s,l,c;if(this.ended)return!1;for(e===~~e?l=e:l=e===!0?Q7:K7,H4.call(i)==="[object ArrayBuffer]"?t.input=new Uint8Array(i):t.input=i,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(n),t.next_out=0,t.avail_out=n),s=vh.inflate(t,l),s===f_&&r&&(s=vh.inflateSetDictionary(t,r),s===a1?s=vh.inflate(t,l):s===oA&&(s=f_));t.avail_in>0&&s===u_&&t.state.wrap>0&&i[t.next_in]!==0;)vh.inflateReset(t),s=vh.inflate(t,l);switch(s){case ez:case oA:case f_:case tz:return this.onEnd(s),this.ended=!0,!1}if(c=t.avail_out,t.next_out&&(t.avail_out===0||s===u_))if(this.options.to==="string"){let f=aS.utf8border(t.output,t.next_out),d=t.next_out-f,m=aS.buf2string(t.output,f);t.next_out=d,t.avail_out=n-d,d&&t.output.set(t.output.subarray(f,f+d),0),this.onData(m)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(s===a1&&c===0)){if(s===u_)return s=vh.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};A1.prototype.onData=function(i){this.chunks.push(i)};A1.prototype.onEnd=function(i){i===a1&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=R4.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};function nz(i,e){const t=new A1(e);if(t.push(i),t.err)throw t.msg||sS[t.err];return t.result}var iz=A1,rz=nz,sz={Inflate:iz,inflate:rz};const{Inflate:az,inflate:oz}=sz;var lA=az,lz=oz;const G4=[];for(let i=0;i<256;i++){let e=i;for(let t=0;t<8;t++)e&1?e=3988292384^e>>>1:e=e>>>1;G4[i]=e}const cA=4294967295;function cz(i,e,t){let n=i;for(let r=0;r<t;r++)n=G4[(n^e[r])&255]^n>>>8;return n}function uz(i,e){return(cz(cA,i,e)^cA)>>>0}function uA(i,e,t){const n=i.readUint32(),r=uz(new Uint8Array(i.buffer,i.byteOffset+i.offset-e-4,e),e);if(r!==n)throw new Error(`CRC mismatch for chunk ${t}. Expected ${n}, found ${r}`)}function q4(i,e,t){for(let n=0;n<t;n++)e[n]=i[n]}function W4(i,e,t,n){let r=0;for(;r<n;r++)e[r]=i[r];for(;r<t;r++)e[r]=i[r]+e[r-n]&255}function X4(i,e,t,n){let r=0;if(t.length===0)for(;r<n;r++)e[r]=i[r];else for(;r<n;r++)e[r]=i[r]+t[r]&255}function Y4(i,e,t,n,r){let s=0;if(t.length===0){for(;s<r;s++)e[s]=i[s];for(;s<n;s++)e[s]=i[s]+(e[s-r]>>1)&255}else{for(;s<r;s++)e[s]=i[s]+(t[s]>>1)&255;for(;s<n;s++)e[s]=i[s]+(e[s-r]+t[s]>>1)&255}}function Z4(i,e,t,n,r){let s=0;if(t.length===0){for(;s<r;s++)e[s]=i[s];for(;s<n;s++)e[s]=i[s]+e[s-r]&255}else{for(;s<r;s++)e[s]=i[s]+t[s]&255;for(;s<n;s++)e[s]=i[s]+fz(e[s-r],t[s],t[s-r])&255}}function fz(i,e,t){const n=i+e-t,r=Math.abs(n-i),s=Math.abs(n-e),l=Math.abs(n-t);return r<=s&&r<=l?i:s<=l?e:t}function hz(i,e,t,n,r,s){switch(i){case 0:q4(e,t,r);break;case 1:W4(e,t,r,s);break;case 2:X4(e,t,n,r);break;case 3:Y4(e,t,n,r,s);break;case 4:Z4(e,t,n,r,s);break;default:throw new Error(`Unsupported filter: ${i}`)}}const dz=new Uint16Array([255]),pz=new Uint8Array(dz.buffer),mz=pz[0]===255;function gz(i){const{data:e,width:t,height:n,channels:r,depth:s}=i,l=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],c=Math.ceil(s/8)*r,f=new Uint8Array(n*t*c);let d=0;for(let m=0;m<7;m++){const g=l[m],y=Math.ceil((t-g.x)/g.xStep),v=Math.ceil((n-g.y)/g.yStep);if(y<=0||v<=0)continue;const S=y*c,T=new Uint8Array(S);for(let A=0;A<v;A++){const w=e[d++],R=e.subarray(d,d+S);d+=S;const D=new Uint8Array(S);hz(w,R,D,T,S,c),T.set(D);for(let I=0;I<y;I++){const z=g.x+I*g.xStep,j=g.y+A*g.yStep;if(!(z>=t||j>=n))for(let X=0;X<c;X++)f[(j*t+z)*c+X]=D[I*c+X]}}}if(s===16){const m=new Uint16Array(f.buffer);if(mz)for(let g=0;g<m.length;g++)m[g]=vz(m[g]);return m}else return f}function vz(i){return(i&255)<<8|i>>8&255}const xz=new Uint16Array([255]),yz=new Uint8Array(xz.buffer),bz=yz[0]===255,_z=new Uint8Array(0);function fA(i){const{data:e,width:t,height:n,channels:r,depth:s}=i,l=Math.ceil(s/8)*r,c=Math.ceil(s/8*r*t),f=new Uint8Array(n*c);let d=_z,m=0,g,y;for(let v=0;v<n;v++){switch(g=e.subarray(m+1,m+1+c),y=f.subarray(v*c,(v+1)*c),e[m]){case 0:q4(g,y,c);break;case 1:W4(g,y,c,l);break;case 2:X4(g,y,d,c);break;case 3:Y4(g,y,d,c,l);break;case 4:Z4(g,y,d,c,l);break;default:throw new Error(`Unsupported filter: ${e[m]}`)}d=y,m+=c+1}if(s===16){const v=new Uint16Array(f.buffer);if(bz)for(let S=0;S<v.length;S++)v[S]=Sz(v[S]);return v}else return f}function Sz(i){return(i&255)<<8|i>>8&255}const Mx=Uint8Array.of(137,80,78,71,13,10,26,10);function hA(i){if(!wz(i.readBytes(Mx.length)))throw new Error("wrong PNG signature")}function wz(i){if(i.length<Mx.length)return!1;for(let e=0;e<Mx.length;e++)if(i[e]!==Mx[e])return!1;return!0}const Mz="tEXt",Az=0,$4=new TextDecoder("latin1");function Tz(i){if(Cz(i),i.length===0||i.length>79)throw new Error("keyword length must be between 1 and 79")}const Ez=/^[\u0000-\u00FF]*$/;function Cz(i){if(!Ez.test(i))throw new Error("invalid latin1 text")}function Nz(i,e,t){const n=J4(e);i[n]=Rz(e,t-n.length-1)}function J4(i){for(i.mark();i.readByte()!==Az;);const e=i.offset;i.reset();const t=$4.decode(i.readBytes(e-i.offset-1));return i.skip(1),Tz(t),t}function Rz(i,e){return $4.decode(i.readBytes(e))}const Sc={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},h_={UNKNOWN:-1,DEFLATE:0},dA={UNKNOWN:-1,ADAPTIVE:0},d_={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},px={NONE:0,BACKGROUND:1,PREVIOUS:2},p_={SOURCE:0,OVER:1};class Lz extends y2{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,t={}){super(e);const{checkCrc:n=!1}=t;this._checkCrc=n,this._inflator=new lA,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=h_.UNKNOWN,this._filterMethod=dA.UNKNOWN,this._interlaceMethod=d_.UNKNOWN,this._colorType=Sc.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(hA(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeChunk(e,t)}return this.decodeImage(),this._png}decodeApng(){for(hA(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeApngChunk(e,t)}return this.decodeApngImage(),this._apng}decodeChunk(e,t){const n=this.offset;switch(t){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case Mz:Nz(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?uA(this,e+4,t):this.skip(4)}decodeApngChunk(e,t){const n=this.offset;switch(t!=="fdAT"&&t!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),t){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,t),this.offset=n+e;break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?uA(this,e+4,t):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=Pz(this.readUint8());const t=this.readUint8();this._colorType=t;let n;switch(t){case Sc.GREYSCALE:n=1;break;case Sc.TRUECOLOUR:n=3;break;case Sc.INDEXED_COLOUR:n=1;break;case Sc.GREYSCALE_ALPHA:n=2;break;case Sc.TRUECOLOUR_ALPHA:n=4;break;case Sc.UNKNOWN:default:throw new Error(`Unknown color type: ${t}`)}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==h_.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const t=e/3;this._hasPalette=!0;const n=[];this._palette=n;for(let r=0;r<t;r++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const t=e,n=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,n,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let t=e,n=this.offset+this.byteOffset;if(n+=4,t-=4,this._inflator.push(new Uint8Array(this.buffer,n,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case Sc.GREYSCALE:case Sc.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let t=0;t<e/2;t++)this._transparency[t]=this.readUint16();break}case Sc.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let t=0;for(;t<e;t++){const n=this.readByte();this._palette[t].push(n)}for(;t<this._palette.length;t++)this._palette[t].push(255);break}case Sc.UNKNOWN:case Sc.GREYSCALE_ALPHA:case Sc.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const t=J4(this),n=this.readUint8();if(n!==h_.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);const r=this.readBytes(e-t.length-2);this._png.iccEmbeddedProfile={name:t,profile:lz(r)}}decodepHYs(){const e=this.readUint32(),t=this.readUint32(),n=this.readByte();this._png.resolution={x:e,y:t,unit:n}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const t={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},n=this._frames.at(e);if(n){if(n.data=fA({data:n.data,width:n.width,height:n.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||n.xOffset===0&&n.yOffset===0&&n.width===this._png.width&&n.height===this._png.height)t.data=n.data;else{const r=this._apng.frames.at(e-1);this.disposeFrame(n,r,t),this.addFrameDataToCanvas(t,n)}this._apng.frames.push(t)}}return this._apng}disposeFrame(e,t,n){switch(e.disposeOp){case px.NONE:break;case px.BACKGROUND:for(let r=0;r<this._png.height;r++)for(let s=0;s<this._png.width;s++){const l=(r*e.width+s)*this._png.channels;for(let c=0;c<this._png.channels;c++)n.data[l+c]=0}break;case px.PREVIOUS:n.data.set(t.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,t){const n=1<<this._png.depth,r=(s,l)=>{const c=((s+t.yOffset)*this._png.width+t.xOffset+l)*this._png.channels,f=(s*t.width+l)*this._png.channels;return{index:c,frameIndex:f}};switch(t.blendOp){case p_.SOURCE:for(let s=0;s<t.height;s++)for(let l=0;l<t.width;l++){const{index:c,frameIndex:f}=r(s,l);for(let d=0;d<this._png.channels;d++)e.data[c+d]=t.data[f+d]}break;case p_.OVER:for(let s=0;s<t.height;s++)for(let l=0;l<t.width;l++){const{index:c,frameIndex:f}=r(s,l);for(let d=0;d<this._png.channels;d++){const m=t.data[f+this._png.channels-1]/n,g=d%(this._png.channels-1)===0?1:t.data[f+d],y=Math.floor(m*g+(1-m)*e.data[c+d]);e.data[c+d]+=y}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==dA.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===d_.NO_INTERLACE)this._png.data=fA({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===d_.ADAM7)this._png.data=gz({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,t=this._frames.at(-1);t?t.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:px.NONE,blendOp:p_.SOURCE,data:e}),this._inflator=new lA,this._writingDataChunks=!1}}function Pz(i){if(i!==1&&i!==2&&i!==4&&i!==8&&i!==16)throw new Error(`invalid bit depth: ${i}`);return i}var pA;(function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.METRE=1]="METRE"})(pA||(pA={}));function Iz(i,e){return new Lz(i,e).decode()}var hi=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function m_(){hi.console&&typeof hi.console.log=="function"&&hi.console.log.apply(hi.console,arguments)}var Xr={log:m_,warn:function(i){hi.console&&(typeof hi.console.warn=="function"?hi.console.warn.apply(hi.console,arguments):m_.call(null,arguments))},error:function(i){hi.console&&(typeof hi.console.error=="function"?hi.console.error.apply(hi.console,arguments):m_(i))}};function g_(i,e,t){var n=new XMLHttpRequest;n.open("GET",i),n.responseType="blob",n.onload=function(){hp(n.response,e,t)},n.onerror=function(){Xr.error("could not download file")},n.send()}function mA(i){var e=new XMLHttpRequest;e.open("HEAD",i,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function mx(i){try{i.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),i.dispatchEvent(e)}}var hp=hi.saveAs||((typeof window>"u"?"undefined":Rr(window))!=="object"||window!==hi?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(i,e,t){var n=hi.URL||hi.webkitURL,r=document.createElement("a");e=e||i.name||"download",r.download=e,r.rel="noopener",typeof i=="string"?(r.href=i,r.origin!==location.origin?mA(r.href)?g_(i,e,t):mx(r,r.target="_blank"):mx(r)):(r.href=n.createObjectURL(i),setTimeout(function(){n.revokeObjectURL(r.href)},4e4),setTimeout(function(){mx(r)},0))}:"msSaveOrOpenBlob"in navigator?function(i,e,t){if(e=e||i.name||"download",typeof i=="string")if(mA(i))g_(i,e,t);else{var n=document.createElement("a");n.href=i,n.target="_blank",setTimeout(function(){mx(n)})}else navigator.msSaveOrOpenBlob((function(r,s){return s===void 0?s={autoBom:!1}:Rr(s)!=="object"&&(Xr.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r})(i,t),e)}:function(i,e,t,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof i=="string")return g_(i,e,t);var r=i.type==="application/octet-stream",s=/constructor/i.test(hi.HTMLElement)||hi.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||r&&s)&&(typeof FileReader>"u"?"undefined":Rr(FileReader))==="object"){var c=new FileReader;c.onloadend=function(){var m=c.result;m=l?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=m:location=m,n=null},c.readAsDataURL(i)}else{var f=hi.URL||hi.webkitURL,d=f.createObjectURL(i);n?n.location=d:location.href=d,n=null,setTimeout(function(){f.revokeObjectURL(d)},4e4)}});function K4(i){var e;i=i||"",this.ok=!1,i.charAt(0)=="#"&&(i=i.substr(1,6)),i={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[i=(i=i.replace(/ /g,"")).toLowerCase()]||i;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(c){return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(c){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(c){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]}}],n=0;n<t.length;n++){var r=t[n].re,s=t[n].process,l=r.exec(i);l&&(e=s(l),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var c=this.r.toString(16),f=this.g.toString(16),d=this.b.toString(16);return c.length==1&&(c="0"+c),f.length==1&&(f="0"+f),d.length==1&&(d="0"+d),"#"+c+f+d}}var Ax=hi.atob.bind(hi),gA=hi.btoa.bind(hi);function v_(i,e){var t=i[0],n=i[1],r=i[2],s=i[3];t=Do(t,n,r,s,e[0],7,-680876936),s=Do(s,t,n,r,e[1],12,-389564586),r=Do(r,s,t,n,e[2],17,606105819),n=Do(n,r,s,t,e[3],22,-1044525330),t=Do(t,n,r,s,e[4],7,-176418897),s=Do(s,t,n,r,e[5],12,1200080426),r=Do(r,s,t,n,e[6],17,-1473231341),n=Do(n,r,s,t,e[7],22,-45705983),t=Do(t,n,r,s,e[8],7,1770035416),s=Do(s,t,n,r,e[9],12,-1958414417),r=Do(r,s,t,n,e[10],17,-42063),n=Do(n,r,s,t,e[11],22,-1990404162),t=Do(t,n,r,s,e[12],7,1804603682),s=Do(s,t,n,r,e[13],12,-40341101),r=Do(r,s,t,n,e[14],17,-1502002290),t=ko(t,n=Do(n,r,s,t,e[15],22,1236535329),r,s,e[1],5,-165796510),s=ko(s,t,n,r,e[6],9,-1069501632),r=ko(r,s,t,n,e[11],14,643717713),n=ko(n,r,s,t,e[0],20,-373897302),t=ko(t,n,r,s,e[5],5,-701558691),s=ko(s,t,n,r,e[10],9,38016083),r=ko(r,s,t,n,e[15],14,-660478335),n=ko(n,r,s,t,e[4],20,-405537848),t=ko(t,n,r,s,e[9],5,568446438),s=ko(s,t,n,r,e[14],9,-1019803690),r=ko(r,s,t,n,e[3],14,-187363961),n=ko(n,r,s,t,e[8],20,1163531501),t=ko(t,n,r,s,e[13],5,-1444681467),s=ko(s,t,n,r,e[2],9,-51403784),r=ko(r,s,t,n,e[7],14,1735328473),t=Oo(t,n=ko(n,r,s,t,e[12],20,-1926607734),r,s,e[5],4,-378558),s=Oo(s,t,n,r,e[8],11,-2022574463),r=Oo(r,s,t,n,e[11],16,1839030562),n=Oo(n,r,s,t,e[14],23,-35309556),t=Oo(t,n,r,s,e[1],4,-1530992060),s=Oo(s,t,n,r,e[4],11,1272893353),r=Oo(r,s,t,n,e[7],16,-155497632),n=Oo(n,r,s,t,e[10],23,-1094730640),t=Oo(t,n,r,s,e[13],4,681279174),s=Oo(s,t,n,r,e[0],11,-358537222),r=Oo(r,s,t,n,e[3],16,-722521979),n=Oo(n,r,s,t,e[6],23,76029189),t=Oo(t,n,r,s,e[9],4,-640364487),s=Oo(s,t,n,r,e[12],11,-421815835),r=Oo(r,s,t,n,e[15],16,530742520),t=Bo(t,n=Oo(n,r,s,t,e[2],23,-995338651),r,s,e[0],6,-198630844),s=Bo(s,t,n,r,e[7],10,1126891415),r=Bo(r,s,t,n,e[14],15,-1416354905),n=Bo(n,r,s,t,e[5],21,-57434055),t=Bo(t,n,r,s,e[12],6,1700485571),s=Bo(s,t,n,r,e[3],10,-1894986606),r=Bo(r,s,t,n,e[10],15,-1051523),n=Bo(n,r,s,t,e[1],21,-2054922799),t=Bo(t,n,r,s,e[8],6,1873313359),s=Bo(s,t,n,r,e[15],10,-30611744),r=Bo(r,s,t,n,e[6],15,-1560198380),n=Bo(n,r,s,t,e[13],21,1309151649),t=Bo(t,n,r,s,e[4],6,-145523070),s=Bo(s,t,n,r,e[11],10,-1120210379),r=Bo(r,s,t,n,e[2],15,718787259),n=Bo(n,r,s,t,e[9],21,-343485551),i[0]=dd(t,i[0]),i[1]=dd(n,i[1]),i[2]=dd(r,i[2]),i[3]=dd(s,i[3])}function yb(i,e,t,n,r,s){return e=dd(dd(e,i),dd(n,s)),dd(e<<r|e>>>32-r,t)}function Do(i,e,t,n,r,s,l){return yb(e&t|~e&n,i,e,r,s,l)}function ko(i,e,t,n,r,s,l){return yb(e&n|t&~n,i,e,r,s,l)}function Oo(i,e,t,n,r,s,l){return yb(e^t^n,i,e,r,s,l)}function Bo(i,e,t,n,r,s,l){return yb(t^(e|~n),i,e,r,s,l)}function Q4(i){var e,t=i.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=i.length;e+=64)v_(n,Dz(i.substring(e-64,e)));i=i.substring(e-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<i.length;e++)r[e>>2]|=i.charCodeAt(e)<<(e%4<<3);if(r[e>>2]|=128<<(e%4<<3),e>55)for(v_(n,r),e=0;e<16;e++)r[e]=0;return r[14]=8*t,v_(n,r),n}function Dz(i){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=i.charCodeAt(e)+(i.charCodeAt(e+1)<<8)+(i.charCodeAt(e+2)<<16)+(i.charCodeAt(e+3)<<24);return t}var vA="0123456789abcdef".split("");function kz(i){for(var e="",t=0;t<4;t++)e+=vA[i>>8*t+4&15]+vA[i>>8*t&15];return e}function Oz(i){return String.fromCharCode(255&i,(65280&i)>>8,(16711680&i)>>16,(4278190080&i)>>24)}function oS(i){return Q4(i).map(Oz).join("")}var Bz=(function(i){for(var e=0;e<i.length;e++)i[e]=kz(i[e]);return i.join("")})(Q4("hello"))!="5d41402abc4b2a76b9719d911017c592";function dd(i,e){if(Bz){var t=(65535&i)+(65535&e);return(i>>16)+(e>>16)+(t>>16)<<16|65535&t}return i+e&4294967295}function lS(i,e){var t,n,r,s;if(i!==t){for(var l=(r=i,s=1+(256/i.length|0),new Array(s+1).join(r)),c=[],f=0;f<256;f++)c[f]=f;var d=0;for(f=0;f<256;f++){var m=c[f];d=(d+m+l.charCodeAt(f))%256,c[f]=c[d],c[d]=m}t=i,n=c}else c=n;var g=e.length,y=0,v=0,S="";for(f=0;f<g;f++)v=(v+(m=c[y=(y+1)%256]))%256,c[y]=c[v],c[v]=m,l=c[(c[y]+c[v])%256],S+=String.fromCharCode(e.charCodeAt(f)^l);return S}var xA={print:4,modify:8,copy:16,"annot-forms":32};function Gm(i,e,t,n){this.v=1,this.r=2;var r=192;i.forEach(function(c){if(xA.perm!==void 0)throw new Error("Invalid permission: "+c);r+=xA[c]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(e+this.padding).substr(0,32),l=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,l),this.P=-(1+(255^r)),this.encryptionKey=oS(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=lS(this.encryptionKey,this.padding)}function qm(i){if(/[^\u0000-\u00ff]/.test(i))throw new Error("Invalid PDF Name Object: "+i+", Only accept ASCII characters.");for(var e="",t=i.length,n=0;n<t;n++){var r=i.charCodeAt(n);e+=r<33||r===35||r===37||r===40||r===41||r===47||r===60||r===62||r===91||r===93||r===123||r===125||r>126?"#"+("0"+r.toString(16)).slice(-2):i[n]}return e}function yA(i){if(Rr(i)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,n,r){if(r=r||!1,typeof t!="string"||typeof n!="function"||typeof r!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var s=Math.random().toString(35);return e[t][s]=[n,!!r],s},this.unsubscribe=function(t){for(var n in e)if(e[n][t])return delete e[n][t],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var n=Array.prototype.slice.call(arguments,1),r=[];for(var s in e[t]){var l=e[t][s];try{l[0].apply(i,n)}catch(c){hi.console&&Xr.error("jsPDF PubSub Error",c.message,c)}l[1]&&r.push(s)}r.length&&r.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Ly(i){if(!(this instanceof Ly))return new Ly(i);var e="opacity,stroke-opacity".split(",");for(var t in i)i.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=i[t]);this.id="",this.objectNumber=-1}function eC(i,e){this.gState=i,this.matrix=e,this.id="",this.objectNumber=-1}function pp(i,e,t,n,r){if(!(this instanceof pp))return new pp(i,e,t,n,r);this.type=i==="axial"?2:3,this.coords=e,this.colors=t,eC.call(this,n,r)}function $m(i,e,t,n,r){if(!(this instanceof $m))return new $m(i,e,t,n,r);this.boundingBox=i,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,eC.call(this,n,r)}function jn(i){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],r=arguments[2],s=arguments[3],l=[],c=1,f=16,d="S",m=null;Rr(i=i||{})==="object"&&(t=i.orientation,n=i.unit||n,r=i.format||r,s=i.compress||i.compressPdf||s,(m=i.encryption||null)!==null&&(m.userPassword=m.userPassword||"",m.ownerPassword=m.ownerPassword||"",m.userPermissions=m.userPermissions||[]),c=typeof i.userUnit=="number"?Math.abs(i.userUnit):1,i.precision!==void 0&&(e=i.precision),i.floatPrecision!==void 0&&(f=i.floatPrecision),d=i.defaultPathOperation||"S"),l=i.filters||(s===!0?["FlateEncode"]:l),n=n||"mm",t=(""+(t||"P")).toLowerCase();var g=i.putOnlyUsedFonts||!1,y={},v={internal:{},__private__:{}};v.__private__.PubSub=yA;var S="1.3",T=v.__private__.getPdfVersion=function(){return S};v.__private__.setPdfVersion=function(B){S=B};var A={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};v.__private__.getPageFormats=function(){return A};var w=v.__private__.getPageFormat=function(B){return A[B]};r=r||"a4";var R="compat",D="advanced",I=R;function z(){this.saveGraphicsState(),le(new tn(gt,0,0,-gt,0,bl()*gt).toString()+" cm"),this.setFontSize(this.getFontSize()/gt),d="n",I=D}function j(){this.restoreGraphicsState(),d="S",I=R}var X=v.__private__.combineFontStyleAndFontWeight=function(B,ae){if(B=="bold"&&ae=="normal"||B=="bold"&&ae==400||B=="normal"&&ae=="italic"||B=="bold"&&ae=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ae&&(B=ae==400||ae==="normal"?B==="italic"?"italic":"normal":ae!=700&&ae!=="bold"||B!=="normal"?(ae==700?"bold":ae)+""+B:"bold"),B};v.advancedAPI=function(B){var ae=I===R;return ae&&z.call(this),typeof B!="function"||(B(this),ae&&j.call(this)),this},v.compatAPI=function(B){var ae=I===D;return ae&&j.call(this),typeof B!="function"||(B(this),ae&&z.call(this)),this},v.isAdvancedAPI=function(){return I===D};var G,L=function(B){if(I!==D)throw new Error(B+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},k=v.roundToPrecision=v.__private__.roundToPrecision=function(B,ae){var Ie=e||ae;if(isNaN(B)||isNaN(Ie))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return B.toFixed(Ie).replace(/0+$/,"")};G=v.hpf=v.__private__.hpf=typeof f=="number"?function(B){if(isNaN(B))throw new Error("Invalid argument passed to jsPDF.hpf");return k(B,f)}:f==="smart"?function(B){if(isNaN(B))throw new Error("Invalid argument passed to jsPDF.hpf");return k(B,B>-1&&B<1?16:5)}:function(B){if(isNaN(B))throw new Error("Invalid argument passed to jsPDF.hpf");return k(B,16)};var U=v.f2=v.__private__.f2=function(B){if(isNaN(B))throw new Error("Invalid argument passed to jsPDF.f2");return k(B,2)},q=v.__private__.f3=function(B){if(isNaN(B))throw new Error("Invalid argument passed to jsPDF.f3");return k(B,3)},W=v.scale=v.__private__.scale=function(B){if(isNaN(B))throw new Error("Invalid argument passed to jsPDF.scale");return I===R?B*gt:I===D?B:void 0},J=function(B){return W((function(ae){return I===R?bl()-ae:I===D?ae:void 0})(B))};v.__private__.setPrecision=v.setPrecision=function(B){typeof parseInt(B,10)=="number"&&(e=parseInt(B,10))};var ce,K="00000000000000000000000000000000",ne=v.__private__.getFileId=function(){return K},pe=v.__private__.setFileId=function(B){return K=B!==void 0&&/^[a-fA-F0-9]{32}$/.test(B)?B.toUpperCase():K.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),m!==null&&(_n=new Gm(m.userPermissions,m.userPassword,m.ownerPassword,K)),K};v.setFileId=function(B){return pe(B),this},v.getFileId=function(){return ne()};var Re=v.__private__.convertDateToPDFDate=function(B){var ae=B.getTimezoneOffset(),Ie=ae<0?"+":"-",qe=Math.floor(Math.abs(ae/60)),at=Math.abs(ae%60),jt=[Ie,re(qe),"'",re(at),"'"].join("");return["D:",B.getFullYear(),re(B.getMonth()+1),re(B.getDate()),re(B.getHours()),re(B.getMinutes()),re(B.getSeconds()),jt].join("")},Te=v.__private__.convertPDFDateToDate=function(B){var ae=parseInt(B.substr(2,4),10),Ie=parseInt(B.substr(6,2),10)-1,qe=parseInt(B.substr(8,2),10),at=parseInt(B.substr(10,2),10),jt=parseInt(B.substr(12,2),10),$t=parseInt(B.substr(14,2),10);return new Date(ae,Ie,qe,at,jt,$t,0)},ee=v.__private__.setCreationDate=function(B){var ae;if(B===void 0&&(B=new Date),B instanceof Date)ae=Re(B);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(B))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ae=B}return ce=ae},F=v.__private__.getCreationDate=function(B){var ae=ce;return B==="jsDate"&&(ae=Te(ce)),ae};v.setCreationDate=function(B){return ee(B),this},v.getCreationDate=function(B){return F(B)};var $,re=v.__private__.padd2=function(B){return("0"+parseInt(B)).slice(-2)},Ae=v.__private__.padd2Hex=function(B){return("00"+(B=B.toString())).substr(B.length)},ie=0,_e=[],ke=[],Fe=0,We=[],nt=[],It=!1,wt=ke;v.__private__.setCustomOutputDestination=function(B){It=!0,wt=B};var Je=function(B){It||(wt=B)};v.__private__.resetCustomOutputDestination=function(){It=!1,wt=ke};var le=v.__private__.out=function(B){return B=B.toString(),Fe+=B.length+1,wt.push(B),wt},Qe=v.__private__.write=function(B){return le(arguments.length===1?B.toString():Array.prototype.join.call(arguments," "))},Et=v.__private__.getArrayBuffer=function(B){for(var ae=B.length,Ie=new ArrayBuffer(ae),qe=new Uint8Array(Ie);ae--;)qe[ae]=B.charCodeAt(ae);return Ie},we=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];v.__private__.getStandardFonts=function(){return we};var ot=i.fontSize||16;v.__private__.setFontSize=v.setFontSize=function(B){return ot=I===D?B/gt:B,this};var Ct,ht=v.__private__.getFontSize=v.getFontSize=function(){return I===R?ot:ot*gt},xt=i.R2L||!1;v.__private__.setR2L=v.setR2L=function(B){return xt=B,this},v.__private__.getR2L=v.getR2L=function(){return xt};var he,Q=v.__private__.setZoomMode=function(B){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(B))Ct=B;else if(isNaN(B)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(B)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+B+'" is not recognized.');Ct=B}else Ct=parseInt(B,10)};v.__private__.getZoomMode=function(){return Ct};var Be,ue=v.__private__.setPageMode=function(B){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(B)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+B+'" is not recognized.');he=B};v.__private__.getPageMode=function(){return he};var je=v.__private__.setLayoutMode=function(B){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(B)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+B+'" is not recognized.');Be=B};v.__private__.getLayoutMode=function(){return Be},v.__private__.setDisplayMode=v.setDisplayMode=function(B,ae,Ie){return Q(B),je(ae),ue(Ie),this};var Ye={title:"",subject:"",author:"",keywords:"",creator:""};v.__private__.getDocumentProperty=function(B){if(Object.keys(Ye).indexOf(B)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ye[B]},v.__private__.getDocumentProperties=function(){return Ye},v.__private__.setDocumentProperties=v.setProperties=v.setDocumentProperties=function(B){for(var ae in Ye)Ye.hasOwnProperty(ae)&&B[ae]&&(Ye[ae]=B[ae]);return this},v.__private__.setDocumentProperty=function(B,ae){if(Object.keys(Ye).indexOf(B)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ye[B]=ae};var ft,gt,Lt,un,bt,dt={},Ge={},xe=[],Pe={},rt={},Me={},ze={},Mt=null,Rt=0,se=[],Ve=new yA(v),vt=i.hotfixes||[],Dt={},bn={},dn=[],tn=function B(ae,Ie,qe,at,jt,$t){if(!(this instanceof B))return new B(ae,Ie,qe,at,jt,$t);isNaN(ae)&&(ae=1),isNaN(Ie)&&(Ie=0),isNaN(qe)&&(qe=0),isNaN(at)&&(at=1),isNaN(jt)&&(jt=0),isNaN($t)&&($t=0),this._matrix=[ae,Ie,qe,at,jt,$t]};Object.defineProperty(tn.prototype,"sx",{get:function(){return this._matrix[0]},set:function(B){this._matrix[0]=B}}),Object.defineProperty(tn.prototype,"shy",{get:function(){return this._matrix[1]},set:function(B){this._matrix[1]=B}}),Object.defineProperty(tn.prototype,"shx",{get:function(){return this._matrix[2]},set:function(B){this._matrix[2]=B}}),Object.defineProperty(tn.prototype,"sy",{get:function(){return this._matrix[3]},set:function(B){this._matrix[3]=B}}),Object.defineProperty(tn.prototype,"tx",{get:function(){return this._matrix[4]},set:function(B){this._matrix[4]=B}}),Object.defineProperty(tn.prototype,"ty",{get:function(){return this._matrix[5]},set:function(B){this._matrix[5]=B}}),Object.defineProperty(tn.prototype,"a",{get:function(){return this._matrix[0]},set:function(B){this._matrix[0]=B}}),Object.defineProperty(tn.prototype,"b",{get:function(){return this._matrix[1]},set:function(B){this._matrix[1]=B}}),Object.defineProperty(tn.prototype,"c",{get:function(){return this._matrix[2]},set:function(B){this._matrix[2]=B}}),Object.defineProperty(tn.prototype,"d",{get:function(){return this._matrix[3]},set:function(B){this._matrix[3]=B}}),Object.defineProperty(tn.prototype,"e",{get:function(){return this._matrix[4]},set:function(B){this._matrix[4]=B}}),Object.defineProperty(tn.prototype,"f",{get:function(){return this._matrix[5]},set:function(B){this._matrix[5]=B}}),Object.defineProperty(tn.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(tn.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(tn.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(tn.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),tn.prototype.join=function(B){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(G).join(B)},tn.prototype.multiply=function(B){var ae=B.sx*this.sx+B.shy*this.shx,Ie=B.sx*this.shy+B.shy*this.sy,qe=B.shx*this.sx+B.sy*this.shx,at=B.shx*this.shy+B.sy*this.sy,jt=B.tx*this.sx+B.ty*this.shx+this.tx,$t=B.tx*this.shy+B.ty*this.sy+this.ty;return new tn(ae,Ie,qe,at,jt,$t)},tn.prototype.decompose=function(){var B=this.sx,ae=this.shy,Ie=this.shx,qe=this.sy,at=this.tx,jt=this.ty,$t=Math.sqrt(B*B+ae*ae),In=(B/=$t)*Ie+(ae/=$t)*qe;Ie-=B*In,qe-=ae*In;var On=Math.sqrt(Ie*Ie+qe*qe);return In/=On,B*(qe/=On)<ae*(Ie/=On)&&(B=-B,ae=-ae,In=-In,$t=-$t),{scale:new tn($t,0,0,On,0,0),translate:new tn(1,0,0,1,at,jt),rotate:new tn(B,ae,-ae,B,0,0),skew:new tn(1,0,In,1,0,0)}},tn.prototype.toString=function(B){return this.join(" ")},tn.prototype.inversed=function(){var B=this.sx,ae=this.shy,Ie=this.shx,qe=this.sy,at=this.tx,jt=this.ty,$t=1/(B*qe-ae*Ie),In=qe*$t,On=-ae*$t,Jn=-Ie*$t,fi=B*$t;return new tn(In,On,Jn,fi,-In*at-Jn*jt,-On*at-fi*jt)},tn.prototype.applyToPoint=function(B){var ae=B.x*this.sx+B.y*this.shx+this.tx,Ie=B.x*this.shy+B.y*this.sy+this.ty;return new Qa(ae,Ie)},tn.prototype.applyToRectangle=function(B){var ae=this.applyToPoint(B),Ie=this.applyToPoint(new Qa(B.x+B.w,B.y+B.h));return new ml(ae.x,ae.y,Ie.x-ae.x,Ie.y-ae.y)},tn.prototype.clone=function(){var B=this.sx,ae=this.shy,Ie=this.shx,qe=this.sy,at=this.tx,jt=this.ty;return new tn(B,ae,Ie,qe,at,jt)},v.Matrix=tn;var gn=v.matrixMult=function(B,ae){return ae.multiply(B)},Pn=new tn(1,0,0,1,0,0);v.unitMatrix=v.identityMatrix=Pn;var Bi=function(B,ae){if(!rt[B]){var Ie=(ae instanceof pp?"Sh":"P")+(Object.keys(Pe).length+1).toString(10);ae.id=Ie,rt[B]=Ie,Pe[Ie]=ae,Ve.publish("addPattern",ae)}};v.ShadingPattern=pp,v.TilingPattern=$m,v.addShadingPattern=function(B,ae){return L("addShadingPattern()"),Bi(B,ae),this},v.beginTilingPattern=function(B){L("beginTilingPattern()"),Jl(B.boundingBox[0],B.boundingBox[1],B.boundingBox[2]-B.boundingBox[0],B.boundingBox[3]-B.boundingBox[1],B.matrix)},v.endTilingPattern=function(B,ae){L("endTilingPattern()"),ae.stream=nt[$].join(`
`),Bi(B,ae),Ve.publish("endTilingPattern",ae),dn.pop().restore()};var xi,$n=v.__private__.newObject=function(){var B=ii();return wi(B,!0),B},ii=v.__private__.newObjectDeferred=function(){return ie++,_e[ie]=function(){return Fe},ie},wi=function(B,ae){return ae=typeof ae=="boolean"&&ae,_e[B]=Fe,ae&&le(B+" 0 obj"),B},Rn=v.__private__.newAdditionalObject=function(){var B={objId:ii(),content:""};return We.push(B),B},ir=ii(),Mi=ii(),te=v.__private__.decodeColorString=function(B){var ae=B.split(" ");if(ae.length!==2||ae[1]!=="g"&&ae[1]!=="G")ae.length!==5||ae[4]!=="k"&&ae[4]!=="K"||(ae=[(1-ae[0])*(1-ae[3]),(1-ae[1])*(1-ae[3]),(1-ae[2])*(1-ae[3]),"r"]);else{var Ie=parseFloat(ae[0]);ae=[Ie,Ie,Ie,"r"]}for(var qe="#",at=0;at<3;at++)qe+=("0"+Math.floor(255*parseFloat(ae[at])).toString(16)).slice(-2);return qe},be=v.__private__.encodeColorString=function(B){var ae;typeof B=="string"&&(B={ch1:B});var Ie=B.ch1,qe=B.ch2,at=B.ch3,jt=B.ch4,$t=B.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ie=="string"&&Ie.charAt(0)!=="#"){var In=new K4(Ie);if(In.ok)Ie=In.toHex();else if(!/^\d*\.?\d*$/.test(Ie))throw new Error('Invalid color "'+Ie+'" passed to jsPDF.encodeColorString.')}if(typeof Ie=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ie)&&(Ie="#"+Ie[1]+Ie[1]+Ie[2]+Ie[2]+Ie[3]+Ie[3]),typeof Ie=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ie)){var On=parseInt(Ie.substr(1),16);Ie=On>>16&255,qe=On>>8&255,at=255&On}if(qe===void 0||jt===void 0&&Ie===qe&&qe===at)ae=typeof Ie=="string"?Ie+" "+$t[0]:B.precision===2?U(Ie/255)+" "+$t[0]:q(Ie/255)+" "+$t[0];else if(jt===void 0||Rr(jt)==="object"){if(jt&&!isNaN(jt.a)&&jt.a===0)return["1.","1.","1.",$t[1]].join(" ");ae=typeof Ie=="string"?[Ie,qe,at,$t[1]].join(" "):B.precision===2?[U(Ie/255),U(qe/255),U(at/255),$t[1]].join(" "):[q(Ie/255),q(qe/255),q(at/255),$t[1]].join(" ")}else ae=typeof Ie=="string"?[Ie,qe,at,jt,$t[2]].join(" "):B.precision===2?[U(Ie),U(qe),U(at),U(jt),$t[2]].join(" "):[q(Ie),q(qe),q(at),q(jt),$t[2]].join(" ");return ae},Ue=v.__private__.getFilters=function(){return l},lt=v.__private__.putStream=function(B){var ae=(B=B||{}).data||"",Ie=B.filters||Ue(),qe=B.alreadyAppliedFilters||[],at=B.addLength1||!1,jt=ae.length,$t=B.objectId,In=function(vs){return vs};if(m!==null&&$t===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");m!==null&&(In=_n.encryptor($t,0));var On={};Ie===!0&&(Ie=["FlateEncode"]);var Jn=B.additionalKeyValues||[],fi=(On=jn.API.processDataByFilters!==void 0?jn.API.processDataByFilters(ae,Ie):{data:ae,reverseChain:[]}).reverseChain+(Array.isArray(qe)?qe.join(" "):qe.toString());if(On.data.length!==0&&(Jn.push({key:"Length",value:On.data.length}),at===!0&&Jn.push({key:"Length1",value:jt})),fi.length!=0)if(fi.split("/").length-1==1)Jn.push({key:"Filter",value:fi});else{Jn.push({key:"Filter",value:"["+fi+"]"});for(var Ai=0;Ai<Jn.length;Ai+=1)if(Jn[Ai].key==="DecodeParms"){for(var yr=[],$r=0;$r<On.reverseChain.split("/").length-1;$r+=1)yr.push("null");yr.push(Jn[Ai].value),Jn[Ai].value="["+yr.join(" ")+"]"}}le("<<");for(var ur=0;ur<Jn.length;ur++)le("/"+Jn[ur].key+" "+Jn[ur].value);le(">>"),On.data.length!==0&&(le("stream"),le(In(On.data)),le("endstream"))},Tt=v.__private__.putPage=function(B){var ae=B.number,Ie=B.data,qe=B.objId,at=B.contentsObjId;wi(qe,!0),le("<</Type /Page"),le("/Parent "+B.rootDictionaryObjId+" 0 R"),le("/Resources "+B.resourceDictionaryObjId+" 0 R"),le("/MediaBox ["+parseFloat(G(B.mediaBox.bottomLeftX))+" "+parseFloat(G(B.mediaBox.bottomLeftY))+" "+G(B.mediaBox.topRightX)+" "+G(B.mediaBox.topRightY)+"]"),B.cropBox!==null&&le("/CropBox ["+G(B.cropBox.bottomLeftX)+" "+G(B.cropBox.bottomLeftY)+" "+G(B.cropBox.topRightX)+" "+G(B.cropBox.topRightY)+"]"),B.bleedBox!==null&&le("/BleedBox ["+G(B.bleedBox.bottomLeftX)+" "+G(B.bleedBox.bottomLeftY)+" "+G(B.bleedBox.topRightX)+" "+G(B.bleedBox.topRightY)+"]"),B.trimBox!==null&&le("/TrimBox ["+G(B.trimBox.bottomLeftX)+" "+G(B.trimBox.bottomLeftY)+" "+G(B.trimBox.topRightX)+" "+G(B.trimBox.topRightY)+"]"),B.artBox!==null&&le("/ArtBox ["+G(B.artBox.bottomLeftX)+" "+G(B.artBox.bottomLeftY)+" "+G(B.artBox.topRightX)+" "+G(B.artBox.topRightY)+"]"),typeof B.userUnit=="number"&&B.userUnit!==1&&le("/UserUnit "+B.userUnit),Ve.publish("putPage",{objId:qe,pageContext:se[ae],pageNumber:ae,page:Ie}),le("/Contents "+at+" 0 R"),le(">>"),le("endobj");var jt=Ie.join(`
`);return I===D&&(jt+=`
Q`),wi(at,!0),lt({data:jt,filters:Ue(),objectId:at}),le("endobj"),qe},St=v.__private__.putPages=function(){var B,ae,Ie=[];for(B=1;B<=Rt;B++)se[B].objId=ii(),se[B].contentsObjId=ii();for(B=1;B<=Rt;B++)Ie.push(Tt({number:B,data:nt[B],objId:se[B].objId,contentsObjId:se[B].contentsObjId,mediaBox:se[B].mediaBox,cropBox:se[B].cropBox,bleedBox:se[B].bleedBox,trimBox:se[B].trimBox,artBox:se[B].artBox,userUnit:se[B].userUnit,rootDictionaryObjId:ir,resourceDictionaryObjId:Mi}));wi(ir,!0),le("<</Type /Pages");var qe="/Kids [";for(ae=0;ae<Rt;ae++)qe+=Ie[ae]+" 0 R ";le(qe+"]"),le("/Count "+Rt),le(">>"),le("endobj"),Ve.publish("postPutPages")},Xt=function(B){Ve.publish("putFont",{font:B,out:le,newObject:$n,putStream:lt}),B.isAlreadyPutted!==!0&&(B.objectNumber=$n(),le("<<"),le("/Type /Font"),le("/BaseFont /"+qm(B.postScriptName)),le("/Subtype /Type1"),typeof B.encoding=="string"&&le("/Encoding /"+B.encoding),le("/FirstChar 32"),le("/LastChar 255"),le(">>"),le("endobj"))},qt=function(B){B.objectNumber=$n();var ae=[];ae.push({key:"Type",value:"/XObject"}),ae.push({key:"Subtype",value:"/Form"}),ae.push({key:"BBox",value:"["+[G(B.x),G(B.y),G(B.x+B.width),G(B.y+B.height)].join(" ")+"]"}),ae.push({key:"Matrix",value:"["+B.matrix.toString()+"]"});var Ie=B.pages[1].join(`
`);lt({data:Ie,additionalKeyValues:ae,objectId:B.objectNumber}),le("endobj")},an=function(B,ae){ae||(ae=21);var Ie=$n(),qe=(function($t,In){var On,Jn=[],fi=1/(In-1);for(On=0;On<1;On+=fi)Jn.push(On);if(Jn.push(1),$t[0].offset!=0){var Ai={offset:0,color:$t[0].color};$t.unshift(Ai)}if($t[$t.length-1].offset!=1){var yr={offset:1,color:$t[$t.length-1].color};$t.push(yr)}for(var $r="",ur=0,vs=0;vs<Jn.length;vs++){for(On=Jn[vs];On>$t[ur+1].offset;)ur++;var as=$t[ur].offset,ea=(On-as)/($t[ur+1].offset-as),Er=$t[ur].color,yo=$t[ur+1].color;$r+=Ae(Math.round((1-ea)*Er[0]+ea*yo[0]).toString(16))+Ae(Math.round((1-ea)*Er[1]+ea*yo[1]).toString(16))+Ae(Math.round((1-ea)*Er[2]+ea*yo[2]).toString(16))}return $r.trim()})(B.colors,ae),at=[];at.push({key:"FunctionType",value:"0"}),at.push({key:"Domain",value:"[0.0 1.0]"}),at.push({key:"Size",value:"["+ae+"]"}),at.push({key:"BitsPerSample",value:"8"}),at.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),at.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),lt({data:qe,additionalKeyValues:at,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ie}),le("endobj"),B.objectNumber=$n(),le("<< /ShadingType "+B.type),le("/ColorSpace /DeviceRGB");var jt="/Coords ["+G(parseFloat(B.coords[0]))+" "+G(parseFloat(B.coords[1]))+" ";B.type===2?jt+=G(parseFloat(B.coords[2]))+" "+G(parseFloat(B.coords[3])):jt+=G(parseFloat(B.coords[2]))+" "+G(parseFloat(B.coords[3]))+" "+G(parseFloat(B.coords[4]))+" "+G(parseFloat(B.coords[5])),le(jt+="]"),B.matrix&&le("/Matrix ["+B.matrix.toString()+"]"),le("/Function "+Ie+" 0 R"),le("/Extend [true true]"),le(">>"),le("endobj")},sn=function(B,ae){var Ie=ii(),qe=$n();ae.push({resourcesOid:Ie,objectOid:qe}),B.objectNumber=qe;var at=[];at.push({key:"Type",value:"/Pattern"}),at.push({key:"PatternType",value:"1"}),at.push({key:"PaintType",value:"1"}),at.push({key:"TilingType",value:"1"}),at.push({key:"BBox",value:"["+B.boundingBox.map(G).join(" ")+"]"}),at.push({key:"XStep",value:G(B.xStep)}),at.push({key:"YStep",value:G(B.yStep)}),at.push({key:"Resources",value:Ie+" 0 R"}),B.matrix&&at.push({key:"Matrix",value:"["+B.matrix.toString()+"]"}),lt({data:B.stream,additionalKeyValues:at,objectId:B.objectNumber}),le("endobj")},ln=function(B){for(var ae in B.objectNumber=$n(),le("<<"),B)switch(ae){case"opacity":le("/ca "+U(B[ae]));break;case"stroke-opacity":le("/CA "+U(B[ae]))}le(">>"),le("endobj")},rn=function(B){wi(B.resourcesOid,!0),le("<<"),le("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var ae in le("/Font <<"),dt)dt.hasOwnProperty(ae)&&(g===!1||g===!0&&y.hasOwnProperty(ae))&&le("/"+ae+" "+dt[ae].objectNumber+" 0 R");le(">>")})(),(function(){if(Object.keys(Pe).length>0){for(var ae in le("/Shading <<"),Pe)Pe.hasOwnProperty(ae)&&Pe[ae]instanceof pp&&Pe[ae].objectNumber>=0&&le("/"+ae+" "+Pe[ae].objectNumber+" 0 R");Ve.publish("putShadingPatternDict"),le(">>")}})(),(function(ae){if(Object.keys(Pe).length>0){for(var Ie in le("/Pattern <<"),Pe)Pe.hasOwnProperty(Ie)&&Pe[Ie]instanceof v.TilingPattern&&Pe[Ie].objectNumber>=0&&Pe[Ie].objectNumber<ae&&le("/"+Ie+" "+Pe[Ie].objectNumber+" 0 R");Ve.publish("putTilingPatternDict"),le(">>")}})(B.objectOid),(function(){if(Object.keys(Me).length>0){var ae;for(ae in le("/ExtGState <<"),Me)Me.hasOwnProperty(ae)&&Me[ae].objectNumber>=0&&le("/"+ae+" "+Me[ae].objectNumber+" 0 R");Ve.publish("putGStateDict"),le(">>")}})(),(function(){for(var ae in le("/XObject <<"),Dt)Dt.hasOwnProperty(ae)&&Dt[ae].objectNumber>=0&&le("/"+ae+" "+Dt[ae].objectNumber+" 0 R");Ve.publish("putXobjectDict"),le(">>")})(),le(">>"),le("endobj")},fe=function(B){Ge[B.fontName]=Ge[B.fontName]||{},Ge[B.fontName][B.fontStyle]=B.id},Oe=function(B,ae,Ie,qe,at){var jt={id:"F"+(Object.keys(dt).length+1).toString(10),postScriptName:B,fontName:ae,fontStyle:Ie,encoding:qe,isStandardFont:at||!1,metadata:{}};return Ve.publish("addFont",{font:jt,instance:this}),dt[jt.id]=jt,fe(jt),jt.id},$e=v.__private__.pdfEscape=v.pdfEscape=function(B,ae){return(function(Ie,qe){var at,jt,$t,In,On,Jn,fi,Ai,yr;if($t=(qe=qe||{}).sourceEncoding||"Unicode",On=qe.outputEncoding,(qe.autoencode||On)&&dt[ft].metadata&&dt[ft].metadata[$t]&&dt[ft].metadata[$t].encoding&&(In=dt[ft].metadata[$t].encoding,!On&&dt[ft].encoding&&(On=dt[ft].encoding),!On&&In.codePages&&(On=In.codePages[0]),typeof On=="string"&&(On=In[On]),On)){for(fi=!1,Jn=[],at=0,jt=Ie.length;at<jt;at++)(Ai=On[Ie.charCodeAt(at)])?Jn.push(String.fromCharCode(Ai)):Jn.push(Ie[at]),Jn[at].charCodeAt(0)>>8&&(fi=!0);Ie=Jn.join("")}for(at=Ie.length;fi===void 0&&at!==0;)Ie.charCodeAt(at-1)>>8&&(fi=!0),at--;if(!fi)return Ie;for(Jn=qe.noBOM?[]:[254,255],at=0,jt=Ie.length;at<jt;at++){if((yr=(Ai=Ie.charCodeAt(at))>>8)>>8)throw new Error("Character at position "+at+" of string '"+Ie+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Jn.push(yr),Jn.push(Ai-(yr<<8))}return String.fromCharCode.apply(void 0,Jn)})(B,ae).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},et=v.__private__.beginPage=function(B){nt[++Rt]=[],se[Rt]={objId:0,contentsObjId:0,userUnit:Number(c),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(B[0]),topRightY:Number(B[1])}},en(Rt),Je(nt[$])},Ze=function(B,ae){var Ie,qe,at;switch(t=ae||t,typeof B=="string"&&(Ie=w(B.toLowerCase()),Array.isArray(Ie)&&(qe=Ie[0],at=Ie[1])),Array.isArray(B)&&(qe=B[0]*gt,at=B[1]*gt),isNaN(qe)&&(qe=r[0],at=r[1]),(qe>14400||at>14400)&&(Xr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),qe=Math.min(14400,qe),at=Math.min(14400,at)),r=[qe,at],t.substr(0,1)){case"l":at>qe&&(r=[at,qe]);break;case"p":qe>at&&(r=[at,qe])}et(r),qn(Nc),le(Hs),Wu!==0&&le(Wu+" J"),Ns!==0&&le(Ns+" j"),Ve.publish("addPage",{pageNumber:Rt})},Vt=function(B){B>0&&B<=Rt&&(nt.splice(B,1),se.splice(B,1),Rt--,$>Rt&&($=Rt),this.setPage($))},en=function(B){B>0&&B<=Rt&&($=B)},Gt=v.__private__.getNumberOfPages=v.getNumberOfPages=function(){return nt.length-1},vn=function(B,ae,Ie){var qe,at=void 0;return Ie=Ie||{},B=B!==void 0?B:dt[ft].fontName,ae=ae!==void 0?ae:dt[ft].fontStyle,qe=B.toLowerCase(),Ge[qe]!==void 0&&Ge[qe][ae]!==void 0?at=Ge[qe][ae]:Ge[B]!==void 0&&Ge[B][ae]!==void 0?at=Ge[B][ae]:Ie.disableWarning===!1&&Xr.warn("Unable to look up font label for font '"+B+"', '"+ae+"'. Refer to getFontList() for available fonts."),at||Ie.noFallback||(at=Ge.times[ae])==null&&(at=Ge.times.normal),at},nn=v.__private__.putInfo=function(){var B=$n(),ae=function(qe){return qe};for(var Ie in m!==null&&(ae=_n.encryptor(B,0)),le("<<"),le("/Producer ("+$e(ae("jsPDF "+jn.version))+")"),Ye)Ye.hasOwnProperty(Ie)&&Ye[Ie]&&le("/"+Ie.substr(0,1).toUpperCase()+Ie.substr(1)+" ("+$e(ae(Ye[Ie]))+")");le("/CreationDate ("+$e(ae(ce))+")"),le(">>"),le("endobj")},Tn=v.__private__.putCatalog=function(B){var ae=(B=B||{}).rootDictionaryObjId||ir;switch($n(),le("<<"),le("/Type /Catalog"),le("/Pages "+ae+" 0 R"),Ct||(Ct="fullwidth"),Ct){case"fullwidth":le("/OpenAction [3 0 R /FitH null]");break;case"fullheight":le("/OpenAction [3 0 R /FitV null]");break;case"fullpage":le("/OpenAction [3 0 R /Fit]");break;case"original":le("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ie=""+Ct;Ie.substr(Ie.length-1)==="%"&&(Ct=parseInt(Ct)/100),typeof Ct=="number"&&le("/OpenAction [3 0 R /XYZ null null "+U(Ct)+"]")}switch(Be||(Be="continuous"),Be){case"continuous":le("/PageLayout /OneColumn");break;case"single":le("/PageLayout /SinglePage");break;case"two":case"twoleft":le("/PageLayout /TwoColumnLeft");break;case"tworight":le("/PageLayout /TwoColumnRight")}he&&le("/PageMode /"+he),Ve.publish("putCatalog"),le(">>"),le("endobj")},cn=v.__private__.putTrailer=function(){le("trailer"),le("<<"),le("/Size "+(ie+1)),le("/Root "+ie+" 0 R"),le("/Info "+(ie-1)+" 0 R"),m!==null&&le("/Encrypt "+_n.oid+" 0 R"),le("/ID [ <"+K+"> <"+K+"> ]"),le(">>")},hn=v.__private__.putHeader=function(){le("%PDF-"+S),le("%")},si=v.__private__.putXRef=function(){var B="0000000000";le("xref"),le("0 "+(ie+1)),le("0000000000 65535 f ");for(var ae=1;ae<=ie;ae++)typeof _e[ae]=="function"?le((B+_e[ae]()).slice(-10)+" 00000 n "):_e[ae]!==void 0?le((B+_e[ae]).slice(-10)+" 00000 n "):le("0000000000 00000 n ")},pi=v.__private__.buildDocument=function(){var B;ie=0,Fe=0,ke=[],_e=[],We=[],ir=ii(),Mi=ii(),Je(ke),Ve.publish("buildDocument"),hn(),St(),(function(){Ve.publish("putAdditionalObjects");for(var Ie=0;Ie<We.length;Ie++){var qe=We[Ie];wi(qe.objId,!0),le(qe.content),le("endobj")}Ve.publish("postPutAdditionalObjects")})(),B=[],(function(){for(var Ie in dt)dt.hasOwnProperty(Ie)&&(g===!1||g===!0&&y.hasOwnProperty(Ie))&&Xt(dt[Ie])})(),(function(){var Ie;for(Ie in Me)Me.hasOwnProperty(Ie)&&ln(Me[Ie])})(),(function(){for(var Ie in Dt)Dt.hasOwnProperty(Ie)&&qt(Dt[Ie])})(),(function(Ie){var qe;for(qe in Pe)Pe.hasOwnProperty(qe)&&(Pe[qe]instanceof pp?an(Pe[qe]):Pe[qe]instanceof $m&&sn(Pe[qe],Ie))})(B),Ve.publish("putResources"),B.forEach(rn),rn({resourcesOid:Mi,objectOid:Number.MAX_SAFE_INTEGER}),Ve.publish("postPutResources"),m!==null&&(_n.oid=$n(),le("<<"),le("/Filter /Standard"),le("/V "+_n.v),le("/R "+_n.r),le("/U <"+_n.toHexString(_n.U)+">"),le("/O <"+_n.toHexString(_n.O)+">"),le("/P "+_n.P),le(">>"),le("endobj")),nn(),Tn();var ae=Fe;return si(),cn(),le("startxref"),le(""+ae),le("%%EOF"),Je(nt[$]),ke.join(`
`)},ai=v.__private__.getBlob=function(B){return new Blob([Et(B)],{type:"application/pdf"})},Sn=v.output=v.__private__.output=(xi=function(B,ae){switch(typeof(ae=ae||{})=="string"?ae={filename:ae}:ae.filename=ae.filename||"generated.pdf",B){case void 0:return pi();case"save":v.save(ae.filename);break;case"arraybuffer":return Et(pi());case"blob":return ai(pi());case"bloburi":case"bloburl":if(hi.URL!==void 0&&typeof hi.URL.createObjectURL=="function")return hi.URL&&hi.URL.createObjectURL(ai(pi()))||void 0;Xr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ie="",qe=pi();try{Ie=gA(qe)}catch{Ie=gA(unescape(encodeURIComponent(qe)))}return"data:application/pdf;filename="+ae.filename+";base64,"+Ie;case"pdfobjectnewwindow":if(Object.prototype.toString.call(hi)==="[object Window]"){var at="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",jt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ae.pdfObjectUrl&&(at=ae.pdfObjectUrl,jt="");var $t='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+at+'"'+jt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ae)+");<\/script></body></html>",In=hi.open();return In!==null&&In.document.write($t),In}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(hi)==="[object Window]"){var On='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ae.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ae.filename+'" width="500px" height="400px" /></body></html>',Jn=hi.open();if(Jn!==null){Jn.document.write(On);var fi=this;Jn.document.documentElement.querySelector("#pdfViewer").onload=function(){Jn.document.title=ae.filename,Jn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(fi.output("bloburl"))}}return Jn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(hi)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Ai='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ae)+'"></iframe></body></html>',yr=hi.open();if(yr!==null&&(yr.document.write(Ai),yr.document.title=ae.filename),yr||typeof safari>"u")return yr;break;case"datauri":case"dataurl":return hi.document.location.href=this.output("datauristring",ae);default:return null}},xi.foo=function(){try{return xi.apply(this,arguments)}catch(Ie){var B=Ie.stack||"";~B.indexOf(" at ")&&(B=B.split(" at ")[1]);var ae="Error in function "+B.split(`
`)[0].split("<")[0]+": "+Ie.message;if(!hi.console)throw new Error(ae);hi.console.error(ae,Ie),hi.alert&&alert(ae)}},xi.foo.bar=xi,xi.foo),Jt=function(B){return Array.isArray(vt)===!0&&vt.indexOf(B)>-1};switch(n){case"pt":gt=1;break;case"mm":gt=72/25.4;break;case"cm":gt=72/2.54;break;case"in":gt=72;break;case"px":gt=Jt("px_scaling")==1?.75:96/72;break;case"pc":case"em":gt=12;break;case"ex":gt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);gt=n}var _n=null;ee(),pe();var mn=v.__private__.getPageInfo=v.getPageInfo=function(B){if(isNaN(B)||B%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:se[B].objId,pageNumber:B,pageContext:se[B]}},Ui=v.__private__.getPageInfoByObjId=function(B){if(isNaN(B)||B%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ae in se)if(se[ae].objId===B)break;return mn(ae)},ss=v.__private__.getCurrentPageInfo=v.getCurrentPageInfo=function(){return{objId:se[$].objId,pageNumber:$,pageContext:se[$]}};v.addPage=function(){return Ze.apply(this,arguments),this},v.setPage=function(){return en.apply(this,arguments),Je.call(this,nt[$]),this},v.insertPage=function(B){return this.addPage(),this.movePage($,B),this},v.movePage=function(B,ae){var Ie,qe;if(B>ae){Ie=nt[B],qe=se[B];for(var at=B;at>ae;at--)nt[at]=nt[at-1],se[at]=se[at-1];nt[ae]=Ie,se[ae]=qe,this.setPage(ae)}else if(B<ae){Ie=nt[B],qe=se[B];for(var jt=B;jt<ae;jt++)nt[jt]=nt[jt+1],se[jt]=se[jt+1];nt[ae]=Ie,se[ae]=qe,this.setPage(ae)}return this},v.deletePage=function(){return Vt.apply(this,arguments),this},v.__private__.text=v.text=function(B,ae,Ie,qe,at){var jt,$t,In,On,Jn,fi,Ai,yr,$r,ur=(qe=qe||{}).scope||this;if(typeof B=="number"&&typeof ae=="number"&&(typeof Ie=="string"||Array.isArray(Ie))){var vs=Ie;Ie=ae,ae=B,B=vs}if(arguments[3]instanceof tn==0?(In=arguments[4],On=arguments[5],Rr(Ai=arguments[3])==="object"&&Ai!==null||(typeof In=="string"&&(On=In,In=null),typeof Ai=="string"&&(On=Ai,Ai=null),typeof Ai=="number"&&(In=Ai,Ai=null),qe={flags:Ai,angle:In,align:On})):(L("The transform parameter of text() with a Matrix value"),$r=at),isNaN(ae)||isNaN(Ie)||B==null)throw new Error("Invalid arguments passed to jsPDF.text");if(B.length===0)return ur;var as,ea="",Er=typeof qe.lineHeightFactor=="number"?qe.lineHeightFactor:pl,yo=ur.internal.scaleFactor;function _l(Vi){return Vi=Vi.split("	").join(Array(qe.TabLen||9).join(" ")),$e(Vi,Ai)}function Zu(Vi){for(var di,dr=Vi.concat(),Vr=[],Zo=dr.length;Zo--;)typeof(di=dr.shift())=="string"?Vr.push(di):Array.isArray(Vi)&&(di.length===1||di[1]===void 0&&di[2]===void 0)?Vr.push(di[0]):Vr.push([di[0],di[1],di[2]]);return Vr}function fu(Vi,di){var dr;if(typeof Vi=="string")dr=di(Vi)[0];else if(Array.isArray(Vi)){for(var Vr,Zo,no=Vi.concat(),ic=[],kc=no.length;kc--;)typeof(Vr=no.shift())=="string"?ic.push(di(Vr)[0]):Array.isArray(Vr)&&typeof Vr[0]=="string"&&(Zo=di(Vr[0],Vr[1],Vr[2]),ic.push([Zo[0],Zo[1],Zo[2]]));dr=ic}return dr}var Ua=!1,bo=!0;if(typeof B=="string")Ua=!0;else if(Array.isArray(B)){var Sl=B.concat();$t=[];for(var wl,Gs=Sl.length;Gs--;)(typeof(wl=Sl.shift())!="string"||Array.isArray(wl)&&typeof wl[0]!="string")&&(bo=!1);Ua=bo}if(Ua===!1)throw new Error('Type of text must be string or Array. "'+B+'" is not recognized.');typeof B=="string"&&(B=B.match(/[\r?\n]/)?B.split(/\r\n|\r|\n/g):[B]);var Ho=ot/ur.internal.scaleFactor,Ml=Ho*(Er-1);switch(qe.baseline){case"bottom":Ie-=Ml;break;case"top":Ie+=Ho-Ml;break;case"hanging":Ie+=Ho-2*Ml;break;case"middle":Ie+=Ho/2-Ml}if((fi=qe.maxWidth||0)>0&&(typeof B=="string"?B=ur.splitTextToSize(B,fi):Object.prototype.toString.call(B)==="[object Array]"&&(B=B.reduce(function(Vi,di){return Vi.concat(ur.splitTextToSize(di,fi))},[]))),jt={text:B,x:ae,y:Ie,options:qe,mutex:{pdfEscape:$e,activeFontKey:ft,fonts:dt,activeFontSize:ot}},Ve.publish("preProcessText",jt),B=jt.text,In=(qe=jt.options).angle,$r instanceof tn==0&&In&&typeof In=="number"){In*=Math.PI/180,qe.rotationDirection===0&&(In=-In),I===D&&(In=-In);var hu=Math.cos(In),Go=Math.sin(In);$r=new tn(hu,Go,-Go,hu,0,0)}else In&&In instanceof tn&&($r=In);I!==D||$r||($r=Pn),(Jn=qe.charSpace||Ka)!==void 0&&(ea+=G(W(Jn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(yr=qe.horizontalScale)!==void 0&&(ea+=G(100*yr)+` Tz
`),qe.lang;var ya=-1,qo=qe.renderingMode!==void 0?qe.renderingMode:qe.stroke,Ic=ur.internal.getCurrentPageInfo().pageContext;switch(qo){case 0:case!1:case"fill":ya=0;break;case 1:case!0:case"stroke":ya=1;break;case 2:case"fillThenStroke":ya=2;break;case 3:case"invisible":ya=3;break;case 4:case"fillAndAddForClipping":ya=4;break;case 5:case"strokeAndAddPathForClipping":ya=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ya=6;break;case 7:case"addToPathForClipping":ya=7}var $u=Ic.usedRenderingMode!==void 0?Ic.usedRenderingMode:-1;ya!==-1?ea+=ya+` Tr
`:$u!==-1&&(ea+=`0 Tr
`),ya!==-1&&(Ic.usedRenderingMode=ya),On=qe.align||"left";var Ca,Fa=ot*Er,Wo=ur.internal.pageSize.getWidth(),Ju=dt[ft];Jn=qe.charSpace||Ka,fi=qe.maxWidth||0,Ai=Object.assign({autoencode:!0,noBOM:!0},qe.flags);var eo=[],Ql=function(Vi){return ur.getStringUnitWidth(Vi,{font:Ju,charSpace:Jn,fontSize:ot,doKerning:!1})*ot/yo};if(Object.prototype.toString.call(B)==="[object Array]"){var Jr;$t=Zu(B),On!=="left"&&(Ca=$t.map(Ql));var ta,Al=0;if(On==="right"){ae-=Ca[0],B=[],Gs=$t.length;for(var Xo=0;Xo<Gs;Xo++)Xo===0?(ta=Ba(ae),Jr=Vs(Ie)):(ta=W(Al-Ca[Xo]),Jr=-Fa),B.push([$t[Xo],ta,Jr]),Al=Ca[Xo]}else if(On==="center"){ae-=Ca[0]/2,B=[],Gs=$t.length;for(var Rs=0;Rs<Gs;Rs++)Rs===0?(ta=Ba(ae),Jr=Vs(Ie)):(ta=W((Al-Ca[Rs])/2),Jr=-Fa),B.push([$t[Rs],ta,Jr]),Al=Ca[Rs]}else if(On==="left"){B=[],Gs=$t.length;for(var ec=0;ec<Gs;ec++)B.push($t[ec])}else if(On==="justify"&&Ju.encoding==="Identity-H"){B=[],Gs=$t.length,fi=fi!==0?fi:Wo;for(var du=0,jr=0;jr<Gs;jr++)if(Jr=jr===0?Vs(Ie):-Fa,ta=jr===0?Ba(ae):du,jr<Gs-1){var Vf=W((fi-Ca[jr])/($t[jr].split(" ").length-1)),Yo=$t[jr].split(" ");B.push([Yo[0]+" ",ta,Jr]),du=0;for(var _o=1;_o<Yo.length;_o++){var Ls=(Ql(Yo[_o-1]+" "+Yo[_o])-Ql(Yo[_o]))*yo+Vf;_o==Yo.length-1?B.push([Yo[_o],Ls,0]):B.push([Yo[_o]+" ",Ls,0]),du-=Ls}}else B.push([$t[jr],ta,Jr]);B.push(["",du,0])}else{if(On!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(B=[],Gs=$t.length,fi=fi!==0?fi:Wo,jr=0;jr<Gs;jr++){Jr=jr===0?Vs(Ie):-Fa,ta=jr===0?Ba(ae):0;var Tl=$t[jr].split(" ").length-1,tc=Tl>0?(fi-Ca[jr])/Tl:0;jr<Gs-1?eo.push(G(W(tc))):eo.push(0),B.push([$t[jr],ta,Jr])}}}(typeof qe.R2L=="boolean"?qe.R2L:xt)===!0&&(B=fu(B,function(Vi,di,dr){return[Vi.split("").reverse().join(""),di,dr]})),jt={text:B,x:ae,y:Ie,options:qe,mutex:{pdfEscape:$e,activeFontKey:ft,fonts:dt,activeFontSize:ot}},Ve.publish("postProcessText",jt),B=jt.text,as=jt.mutex.isHex||!1;var El=dt[ft].encoding;El!=="WinAnsiEncoding"&&El!=="StandardEncoding"||(B=fu(B,function(Vi,di,dr){return[_l(Vi),di,dr]})),$t=Zu(B),B=[];for(var Zi,nc,Cl,Dc=Array.isArray($t[0])?1:0,na="",ba=function(Vi,di,dr){var Vr="";return dr instanceof tn?(dr=typeof qe.angle=="number"?gn(dr,new tn(1,0,0,1,Vi,di)):gn(new tn(1,0,0,1,Vi,di),dr),I===D&&(dr=gn(new tn(1,0,0,-1,0,0),dr)),Vr=dr.join(" ")+` Tm
`):Vr=G(Vi)+" "+G(di)+` Td
`,Vr},ia=0;ia<$t.length;ia++){switch(na="",Dc){case 1:Cl=(as?"<":"(")+$t[ia][0]+(as?">":")"),Zi=parseFloat($t[ia][1]),nc=parseFloat($t[ia][2]);break;case 0:Cl=(as?"<":"(")+$t[ia]+(as?">":")"),Zi=Ba(ae),nc=Vs(Ie)}eo!==void 0&&eo[ia]!==void 0&&(na=eo[ia]+` Tw
`),ia===0?B.push(na+ba(Zi,nc,$r)+Cl):Dc===0?B.push(na+Cl):Dc===1&&B.push(na+ba(Zi,nc,$r)+Cl)}B=Dc===0?B.join(` Tj
T* `):B.join(` Tj
`),B+=` Tj
`;var to=`BT
/`;return to+=ft+" "+ot+` Tf
`,to+=G(ot*Er)+` TL
`,to+=Ja+`
`,to+=ea,to+=B,le(to+="ET"),y[ft]=!0,ur};var mi=v.__private__.clip=v.clip=function(B){return le(B==="evenodd"?"W*":"W"),this};v.clipEvenOdd=function(){return mi("evenodd")},v.__private__.discardPath=v.discardPath=function(){return le("n"),this};var Yi=v.__private__.isValidStyle=function(B){var ae=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(B)!==-1&&(ae=!0),ae};v.__private__.setDefaultPathOperation=v.setDefaultPathOperation=function(B){return Yi(B)&&(d=B),this};var Xi=v.__private__.getStyle=v.getStyle=function(B){var ae=d;switch(B){case"D":case"S":ae="S";break;case"F":ae="f";break;case"FD":case"DF":ae="B";break;case"f":case"f*":case"B":case"B*":ae=B}return ae},Zr=v.close=function(){return le("h"),this};v.stroke=function(){return le("S"),this},v.fill=function(B){return Tr("f",B),this},v.fillEvenOdd=function(B){return Tr("f*",B),this},v.fillStroke=function(B){return Tr("B",B),this},v.fillStrokeEvenOdd=function(B){return Tr("B*",B),this};var Tr=function(B,ae){Rr(ae)==="object"?Zl(ae,B):le(B)},Pr=function(B){B===null||I===D&&B===void 0||(B=Xi(B),le(B))};function gs(B,ae,Ie,qe,at){var jt=new $m(ae||this.boundingBox,Ie||this.xStep,qe||this.yStep,this.gState,at||this.matrix);jt.stream=this.stream;var $t=B+"$$"+this.cloneIndex+++"$$";return Bi($t,jt),jt}var Zl=function(B,ae){var Ie=rt[B.key],qe=Pe[Ie];if(qe instanceof pp)le("q"),le(Oa(ae)),qe.gState&&v.setGState(qe.gState),le(B.matrix.toString()+" cm"),le("/"+Ie+" sh"),le("Q");else if(qe instanceof $m){var at=new tn(1,0,0,-1,0,bl());B.matrix&&(at=at.multiply(B.matrix||Pn),Ie=gs.call(qe,B.key,B.boundingBox,B.xStep,B.yStep,at).id),le("q"),le("/Pattern cs"),le("/"+Ie+" scn"),qe.gState&&v.setGState(qe.gState),le(ae),le("Q")}},Oa=function(B){switch(B){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Hu=v.moveTo=function(B,ae){return le(G(W(B))+" "+G(J(ae))+" m"),this},Gu=v.lineTo=function(B,ae){return le(G(W(B))+" "+G(J(ae))+" l"),this},Ea=v.curveTo=function(B,ae,Ie,qe,at,jt){return le([G(W(B)),G(J(ae)),G(W(Ie)),G(J(qe)),G(W(at)),G(J(jt)),"c"].join(" ")),this};v.__private__.line=v.line=function(B,ae,Ie,qe,at){if(isNaN(B)||isNaN(ae)||isNaN(Ie)||isNaN(qe)||!Yi(at))throw new Error("Invalid arguments passed to jsPDF.line");return I===R?this.lines([[Ie-B,qe-ae]],B,ae,[1,1],at||"S"):this.lines([[Ie-B,qe-ae]],B,ae,[1,1]).stroke()},v.__private__.lines=v.lines=function(B,ae,Ie,qe,at,jt){var $t,In,On,Jn,fi,Ai,yr,$r,ur,vs,as,ea;if(typeof B=="number"&&(ea=Ie,Ie=ae,ae=B,B=ea),qe=qe||[1,1],jt=jt||!1,isNaN(ae)||isNaN(Ie)||!Array.isArray(B)||!Array.isArray(qe)||!Yi(at)||typeof jt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Hu(ae,Ie),$t=qe[0],In=qe[1],Jn=B.length,vs=ae,as=Ie,On=0;On<Jn;On++)(fi=B[On]).length===2?(vs=fi[0]*$t+vs,as=fi[1]*In+as,Gu(vs,as)):(Ai=fi[0]*$t+vs,yr=fi[1]*In+as,$r=fi[2]*$t+vs,ur=fi[3]*In+as,vs=fi[4]*$t+vs,as=fi[5]*In+as,Ea(Ai,yr,$r,ur,vs,as));return jt&&Zr(),Pr(at),this},v.path=function(B){for(var ae=0;ae<B.length;ae++){var Ie=B[ae],qe=Ie.c;switch(Ie.op){case"m":Hu(qe[0],qe[1]);break;case"l":Gu(qe[0],qe[1]);break;case"c":Ea.apply(this,qe);break;case"h":Zr()}}return this},v.__private__.rect=v.rect=function(B,ae,Ie,qe,at){if(isNaN(B)||isNaN(ae)||isNaN(Ie)||isNaN(qe)||!Yi(at))throw new Error("Invalid arguments passed to jsPDF.rect");return I===R&&(qe=-qe),le([G(W(B)),G(J(ae)),G(W(Ie)),G(W(qe)),"re"].join(" ")),Pr(at),this},v.__private__.triangle=v.triangle=function(B,ae,Ie,qe,at,jt,$t){if(isNaN(B)||isNaN(ae)||isNaN(Ie)||isNaN(qe)||isNaN(at)||isNaN(jt)||!Yi($t))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ie-B,qe-ae],[at-Ie,jt-qe],[B-at,ae-jt]],B,ae,[1,1],$t,!0),this},v.__private__.roundedRect=v.roundedRect=function(B,ae,Ie,qe,at,jt,$t){if(isNaN(B)||isNaN(ae)||isNaN(Ie)||isNaN(qe)||isNaN(at)||isNaN(jt)||!Yi($t))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var In=4/3*(Math.SQRT2-1);return at=Math.min(at,.5*Ie),jt=Math.min(jt,.5*qe),this.lines([[Ie-2*at,0],[at*In,0,at,jt-jt*In,at,jt],[0,qe-2*jt],[0,jt*In,-at*In,jt,-at,jt],[2*at-Ie,0],[-at*In,0,-at,-jt*In,-at,-jt],[0,2*jt-qe],[0,-jt*In,at*In,-jt,at,-jt]],B+at,ae,[1,1],$t,!0),this},v.__private__.ellipse=v.ellipse=function(B,ae,Ie,qe,at){if(isNaN(B)||isNaN(ae)||isNaN(Ie)||isNaN(qe)||!Yi(at))throw new Error("Invalid arguments passed to jsPDF.ellipse");var jt=4/3*(Math.SQRT2-1)*Ie,$t=4/3*(Math.SQRT2-1)*qe;return Hu(B+Ie,ae),Ea(B+Ie,ae-$t,B+jt,ae-qe,B,ae-qe),Ea(B-jt,ae-qe,B-Ie,ae-$t,B-Ie,ae),Ea(B-Ie,ae+$t,B-jt,ae+qe,B,ae+qe),Ea(B+jt,ae+qe,B+Ie,ae+$t,B+Ie,ae),Pr(at),this},v.__private__.circle=v.circle=function(B,ae,Ie,qe){if(isNaN(B)||isNaN(ae)||isNaN(Ie)||!Yi(qe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(B,ae,Ie,Ie,qe)},v.setFont=function(B,ae,Ie){return Ie&&(ae=X(ae,Ie)),ft=vn(B,ae,{disableWarning:!1}),this};var jo=v.__private__.getFont=v.getFont=function(){return dt[vn.apply(v,arguments)]};v.__private__.getFontList=v.getFontList=function(){var B,ae,Ie={};for(B in Ge)if(Ge.hasOwnProperty(B))for(ae in Ie[B]=[],Ge[B])Ge[B].hasOwnProperty(ae)&&Ie[B].push(ae);return Ie},v.addFont=function(B,ae,Ie,qe,at){var jt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&jt.indexOf(arguments[3])!==-1?at=arguments[3]:arguments[3]&&jt.indexOf(arguments[3])==-1&&(Ie=X(Ie,qe)),Oe.call(this,B,ae,Ie,at=at||"Identity-H")};var pl,Nc=i.lineWidth||.200025,$l=v.__private__.getLineWidth=v.getLineWidth=function(){return Nc},qn=v.__private__.setLineWidth=v.setLineWidth=function(B){return Nc=B,le(G(W(B))+" w"),this};v.__private__.setLineDash=jn.API.setLineDash=jn.API.setLineDashPattern=function(B,ae){if(B=B||[],ae=ae||0,isNaN(ae)||!Array.isArray(B))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return B=B.map(function(Ie){return G(W(Ie))}).join(" "),ae=G(W(ae)),le("["+B+"] "+ae+" d"),this};var Uf=v.__private__.getLineHeight=v.getLineHeight=function(){return ot*pl};v.__private__.getLineHeight=v.getLineHeight=function(){return ot*pl};var qu=v.__private__.setLineHeightFactor=v.setLineHeightFactor=function(B){return typeof(B=B||1.15)=="number"&&(pl=B),this},Ff=v.__private__.getLineHeightFactor=v.getLineHeightFactor=function(){return pl};qu(i.lineHeight);var Ba=v.__private__.getHorizontalCoordinate=function(B){return W(B)},Vs=v.__private__.getVerticalCoordinate=function(B){return I===D?B:se[$].mediaBox.topRightY-se[$].mediaBox.bottomLeftY-W(B)},zf=v.__private__.getHorizontalCoordinateString=v.getHorizontalCoordinateString=function(B){return G(Ba(B))},Rc=v.__private__.getVerticalCoordinateString=v.getVerticalCoordinateString=function(B){return G(Vs(B))},Hs=i.strokeColor||"0 G";v.__private__.getStrokeColor=v.getDrawColor=function(){return te(Hs)},v.__private__.setStrokeColor=v.setDrawColor=function(B,ae,Ie,qe){return Hs=be({ch1:B,ch2:ae,ch3:Ie,ch4:qe,pdfColorType:"draw",precision:2}),le(Hs),this};var Lc=i.fillColor||"0 g";v.__private__.getFillColor=v.getFillColor=function(){return te(Lc)},v.__private__.setFillColor=v.setFillColor=function(B,ae,Ie,qe){return Lc=be({ch1:B,ch2:ae,ch3:Ie,ch4:qe,pdfColorType:"fill",precision:2}),le(Lc),this};var Ja=i.textColor||"0 g",cu=v.__private__.getTextColor=v.getTextColor=function(){return te(Ja)};v.__private__.setTextColor=v.setTextColor=function(B,ae,Ie,qe){return Ja=be({ch1:B,ch2:ae,ch3:Ie,ch4:qe,pdfColorType:"text",precision:3}),this};var Ka=i.charSpace,Pc=v.__private__.getCharSpace=v.getCharSpace=function(){return parseFloat(Ka||0)};v.__private__.setCharSpace=v.setCharSpace=function(B){if(isNaN(B))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ka=B,this};var Wu=0;v.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},v.__private__.setLineCap=v.setLineCap=function(B){var ae=v.CapJoinStyles[B];if(ae===void 0)throw new Error("Line cap style of '"+B+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Wu=ae,le(ae+" J"),this};var Ns=0;v.__private__.setLineJoin=v.setLineJoin=function(B){var ae=v.CapJoinStyles[B];if(ae===void 0)throw new Error("Line join style of '"+B+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ns=ae,le(ae+" j"),this},v.__private__.setLineMiterLimit=v.__private__.setMiterLimit=v.setLineMiterLimit=v.setMiterLimit=function(B){if(B=B||0,isNaN(B))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return le(G(W(B))+" M"),this},v.GState=Ly,v.setGState=function(B){(B=typeof B=="string"?Me[ze[B]]:Vo(null,B)).equals(Mt)||(le("/"+B.id+" gs"),Mt=B)};var Vo=function(B,ae){if(!B||!ze[B]){var Ie=!1;for(var qe in Me)if(Me.hasOwnProperty(qe)&&Me[qe].equals(ae)){Ie=!0;break}if(Ie)ae=Me[qe];else{var at="GS"+(Object.keys(Me).length+1).toString(10);Me[at]=ae,ae.id=at}return B&&(ze[B]=ae.id),Ve.publish("addGState",ae),ae}};v.addGState=function(B,ae){return Vo(B,ae),this},v.saveGraphicsState=function(){return le("q"),xe.push({key:ft,size:ot,color:Ja}),this},v.restoreGraphicsState=function(){le("Q");var B=xe.pop();return ft=B.key,ot=B.size,Ja=B.color,Mt=null,this},v.setCurrentTransformationMatrix=function(B){return le(B.toString()+" cm"),this},v.comment=function(B){return le("#"+B),this};var Qa=function(B,ae){var Ie=B||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ie},set:function(jt){isNaN(jt)||(Ie=parseFloat(jt))}});var qe=ae||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return qe},set:function(jt){isNaN(jt)||(qe=parseFloat(jt))}});var at="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return at},set:function(jt){at=jt.toString()}}),this},ml=function(B,ae,Ie,qe){Qa.call(this,B,ae),this.type="rect";var at=Ie||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return at},set:function($t){isNaN($t)||(at=parseFloat($t))}});var jt=qe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return jt},set:function($t){isNaN($t)||(jt=parseFloat($t))}}),this},uu=function(){this.page=Rt,this.currentPage=$,this.pages=nt.slice(0),this.pagesContext=se.slice(0),this.x=Lt,this.y=un,this.matrix=bt,this.width=vl($),this.height=Xu($),this.outputDestination=wt,this.id="",this.objectNumber=-1};uu.prototype.restore=function(){Rt=this.page,$=this.currentPage,se=this.pagesContext,nt=this.pages,Lt=this.x,un=this.y,bt=this.matrix,Kl($,this.width),xl($,this.height),wt=this.outputDestination};var Jl=function(B,ae,Ie,qe,at){dn.push(new uu),Rt=$=0,nt=[],Lt=B,un=ae,bt=at,et([Ie,qe])};for(var gl in v.beginFormObject=function(B,ae,Ie,qe,at){return Jl(B,ae,Ie,qe,at),this},v.endFormObject=function(B){return(function(ae){if(bn[ae])dn.pop().restore();else{var Ie=new uu,qe="Xo"+(Object.keys(Dt).length+1).toString(10);Ie.id=qe,bn[ae]=qe,Dt[qe]=Ie,Ve.publish("addFormObject",Ie),dn.pop().restore()}})(B),this},v.doFormObject=function(B,ae){var Ie=Dt[bn[B]];return le("q"),le(ae.toString()+" cm"),le("/"+Ie.id+" Do"),le("Q"),this},v.getFormObject=function(B){var ae=Dt[bn[B]];return{x:ae.x,y:ae.y,width:ae.width,height:ae.height,matrix:ae.matrix}},v.save=function(B,ae){return B=B||"generated.pdf",(ae=ae||{}).returnPromise=ae.returnPromise||!1,ae.returnPromise===!1?(hp(ai(pi()),B),typeof hp.unload=="function"&&hi.setTimeout&&setTimeout(hp.unload,911),this):new Promise(function(Ie,qe){try{var at=hp(ai(pi()),B);typeof hp.unload=="function"&&hi.setTimeout&&setTimeout(hp.unload,911),Ie(at)}catch(jt){qe(jt.message)}})},jn.API)jn.API.hasOwnProperty(gl)&&(gl==="events"&&jn.API.events.length?(function(B,ae){var Ie,qe,at;for(at=ae.length-1;at!==-1;at--)Ie=ae[at][0],qe=ae[at][1],B.subscribe.apply(B,[Ie].concat(typeof qe=="function"?[qe]:qe))})(Ve,jn.API.events):v[gl]=jn.API[gl]);function vl(B){return se[B].mediaBox.topRightX-se[B].mediaBox.bottomLeftX}function Kl(B,ae){se[B].mediaBox.topRightX=ae+se[B].mediaBox.bottomLeftX}function Xu(B){return se[B].mediaBox.topRightY-se[B].mediaBox.bottomLeftY}function xl(B,ae){se[B].mediaBox.topRightY=ae+se[B].mediaBox.bottomLeftY}var yl=v.getPageWidth=function(B){return vl(B=B||$)/gt},Yu=v.setPageWidth=function(B,ae){Kl(B,ae*gt)},bl=v.getPageHeight=function(B){return Xu(B=B||$)/gt},jf=v.setPageHeight=function(B,ae){xl(B,ae*gt)};return v.internal={pdfEscape:$e,getStyle:Xi,getFont:jo,getFontSize:ht,getCharSpace:Pc,getTextColor:cu,getLineHeight:Uf,getLineHeightFactor:Ff,getLineWidth:$l,write:Qe,getHorizontalCoordinate:Ba,getVerticalCoordinate:Vs,getCoordinateString:zf,getVerticalCoordinateString:Rc,collections:{},newObject:$n,newAdditionalObject:Rn,newObjectDeferred:ii,newObjectDeferredBegin:wi,getFilters:Ue,putStream:lt,events:Ve,scaleFactor:gt,pageSize:{getWidth:function(){return yl($)},setWidth:function(B){Yu($,B)},getHeight:function(){return bl($)},setHeight:function(B){jf($,B)}},encryptionOptions:m,encryption:_n,getEncryptor:function(B){return m!==null?_n.encryptor(B,0):function(ae){return ae}},output:Sn,getNumberOfPages:Gt,get pages(){return nt},out:le,f2:U,f3:q,getPageInfo:mn,getPageInfoByObjId:Ui,getCurrentPageInfo:ss,getPDFVersion:T,Point:Qa,Rectangle:ml,Matrix:tn,hasHotfix:Jt},Object.defineProperty(v.internal.pageSize,"width",{get:function(){return yl($)},set:function(B){Yu($,B)},enumerable:!0,configurable:!0}),Object.defineProperty(v.internal.pageSize,"height",{get:function(){return bl($)},set:function(B){jf($,B)},enumerable:!0,configurable:!0}),(function(B){for(var ae=0,Ie=we.length;ae<Ie;ae++){var qe=Oe.call(this,B[ae][0],B[ae][1],B[ae][2],we[ae][3],!0);g===!1&&(y[qe]=!0);var at=B[ae][0].split("-");fe({id:qe,fontName:at[0],fontStyle:at[1]||""})}Ve.publish("addFonts",{fonts:dt,dictionary:Ge})}).call(v,we),ft="F1",Ze(r,t),Ve.publish("initialized"),v}Gm.prototype.lsbFirstWord=function(i){return String.fromCharCode(255&i,i>>8&255,i>>16&255,i>>24&255)},Gm.prototype.toHexString=function(i){return i.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Gm.prototype.hexToBytes=function(i){for(var e=[],t=0;t<i.length;t+=2)e.push(String.fromCharCode(parseInt(i.substr(t,2),16)));return e.join("")},Gm.prototype.processOwnerPassword=function(i,e){return lS(oS(e).substr(0,5),i)},Gm.prototype.encryptor=function(i,e){var t=oS(this.encryptionKey+String.fromCharCode(255&i,i>>8&255,i>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return lS(t,n)}},Ly.prototype.equals=function(i){var e,t="id,objectNumber,equals";if(!i||Rr(i)!==Rr(this))return!1;var n=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!i.hasOwnProperty(e)||this[e]!==i[e])return!1;n++}for(e in i)i.hasOwnProperty(e)&&t.indexOf(e)<0&&n--;return n===0},jn.API={events:[]},jn.version="3.0.4";var Zs=jn.API,b2=1,Up=function(i){return i.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},zm=function(i){return i.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},_i=function(i){return i.toFixed(2)},ad=function(i){return i.toFixed(5)};Zs.__acroform__={};var Yl=function(i,e){i.prototype=Object.create(e.prototype),i.prototype.constructor=i},bA=function(i){return i*b2},Cf=function(i){var e=new nC,t=Un.internal.getHeight(i)||0,n=Un.internal.getWidth(i)||0;return e.BBox=[0,0,Number(_i(n)),Number(_i(t))],e},Uz=Zs.__acroform__.setBit=function(i,e){if(i=i||0,e=e||0,isNaN(i)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return i|1<<e},Fz=Zs.__acroform__.clearBit=function(i,e){if(i=i||0,e=e||0,isNaN(i)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return i&~(1<<e)},zz=Zs.__acroform__.getBit=function(i,e){if(isNaN(i)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return i&1<<e?1:0},pa=Zs.__acroform__.getBitForPdf=function(i,e){if(isNaN(i)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return zz(i,e-1)},ma=Zs.__acroform__.setBitForPdf=function(i,e){if(isNaN(i)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Uz(i,e-1)},ga=Zs.__acroform__.clearBitForPdf=function(i,e){if(isNaN(i)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Fz(i,e-1)},jz=Zs.__acroform__.calculateCoordinates=function(i,e){var t=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,r=i[0],s=i[1],l=i[2],c=i[3],f={};return f.lowerLeft_X=t(r)||0,f.lowerLeft_Y=n(s+c)||0,f.upperRight_X=t(r+l)||0,f.upperRight_Y=n(s)||0,[Number(_i(f.lowerLeft_X)),Number(_i(f.lowerLeft_Y)),Number(_i(f.upperRight_X)),Number(_i(f.upperRight_Y))]},Vz=function(i){if(i.appearanceStreamContent)return i.appearanceStreamContent;if(i.V||i.DV){var e=[],t=i._V||i.DV,n=cS(i,t),r=i.scope.internal.getFont(i.fontName,i.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(i.scope.__private__.encodeColorString(i.color)),e.push("/"+r+" "+_i(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=Cf(i);return s.scope=i.scope,s.stream=e.join(`
`),s}},cS=function(i,e){var t=i.fontSize===0?i.maxFontSize:i.fontSize,n={text:"",fontSize:""},r=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");r=i.multiline?r.map(function(U){return U.split(`
`)}):r.map(function(U){return[U]});var s=t,l=Un.internal.getHeight(i)||0;l=l<0?-l:l;var c=Un.internal.getWidth(i)||0;c=c<0?-c:c;var f=function(U,q,W){if(U+1<r.length){var J=q+" "+r[U+1][0];return gx(J,i,W).width<=c-4}return!1};s++;e:for(;s>0;){e="",s--;var d,m,g=gx("3",i,s).height,y=i.multiline?l-s:(l-g)/2,v=y+=2,S=0,T=0,A=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+gx(e,i,s=12).width+", FieldWidth:"+c+`
`;break}for(var w="",R=0,D=0;D<r.length;D++)if(r.hasOwnProperty(D)){var I=!1;if(r[D].length!==1&&A!==r[D].length-1){if((g+2)*(R+2)+2>l)continue e;w+=r[D][A],I=!0,T=D,D--}else{w=(w+=r[D][A]+" ").substr(w.length-1)==" "?w.substr(0,w.length-1):w;var z=parseInt(D),j=f(z,w,s),X=D>=r.length-1;if(j&&!X){w+=" ",A=0;continue}if(j||X){if(X)T=z;else if(i.multiline&&(g+2)*(R+2)+2>l)continue e}else{if(!i.multiline||(g+2)*(R+2)+2>l)continue e;T=z}}for(var G="",L=S;L<=T;L++){var k=r[L];if(i.multiline){if(L===T){G+=k[A]+" ",A=(A+1)%k.length;continue}if(L===S){G+=k[k.length-1]+" ";continue}}G+=k[0]+" "}switch(G=G.substr(G.length-1)==" "?G.substr(0,G.length-1):G,m=gx(G,i,s).width,i.textAlign){case"right":d=c-m-2;break;case"center":d=(c-m)/2;break;default:d=2}e+=_i(d)+" "+_i(v)+` Td
`,e+="("+Up(G)+`) Tj
`,e+=-_i(d)+` 0 Td
`,v=-(s+2),m=0,S=I?T:T+1,R++,w=""}break}return n.text=e,n.fontSize=s,n},gx=function(i,e,t){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),r=e.scope.getStringUnitWidth(i,{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:r}},Hz={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Gz=function(i,e){var t={type:"reference",object:i};e.internal.getPageInfo(i.page).pageContext.annotations.find(function(n){return n.type===t.type&&n.object===t.object})===void 0&&e.internal.getPageInfo(i.page).pageContext.annotations.push(t)},qz=function(i,e){if(e.scope=i,i.internal!==void 0&&(i.internal.acroformPlugin===void 0||i.internal.acroformPlugin.isInitialized===!1)){if(ju.FieldNum=0,i.internal.acroformPlugin=JSON.parse(JSON.stringify(Hz)),i.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");b2=i.internal.scaleFactor,i.internal.acroformPlugin.acroFormDictionaryRoot=new iC,i.internal.acroformPlugin.acroFormDictionaryRoot.scope=i,i.internal.acroformPlugin.acroFormDictionaryRoot._eventID=i.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(i)}),i.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var r in n)if(n.hasOwnProperty(r)){var s=n[r];s.objId=void 0,s.hasAnnotation&&Gz(s,t)}})(i)}),i.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(i)}),i.internal.events.subscribe("postPutPages",function(t){(function(n,r){var s=!n;for(var l in n||(r.internal.newObjectDeferredBegin(r.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),r.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||r.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(l)){var c=n[l],f=[],d=c.Rect;if(c.Rect&&(c.Rect=jz(c.Rect,r)),r.internal.newObjectDeferredBegin(c.objId,!0),c.DA=Un.createDefaultAppearanceStream(c),Rr(c)==="object"&&typeof c.getKeyValueListForStream=="function"&&(f=c.getKeyValueListForStream()),c.Rect=d,c.hasAppearanceStream&&!c.appearanceStreamContent){var m=Vz(c);f.push({key:"AP",value:"<</N "+m+">>"}),r.internal.acroformPlugin.xForms.push(m)}if(c.appearanceStreamContent){var g="";for(var y in c.appearanceStreamContent)if(c.appearanceStreamContent.hasOwnProperty(y)){var v=c.appearanceStreamContent[y];if(g+="/"+y+" ",g+="<<",Object.keys(v).length>=1||Array.isArray(v)){for(var l in v)if(v.hasOwnProperty(l)){var S=v[l];typeof S=="function"&&(S=S.call(r,c)),g+="/"+l+" "+S+" ",r.internal.acroformPlugin.xForms.indexOf(S)>=0||r.internal.acroformPlugin.xForms.push(S)}}else typeof(S=v)=="function"&&(S=S.call(r,c)),g+="/"+l+" "+S,r.internal.acroformPlugin.xForms.indexOf(S)>=0||r.internal.acroformPlugin.xForms.push(S);g+=">>"}f.push({key:"AP",value:`<<
`+g+">>"})}r.internal.putStream({additionalKeyValues:f,objectId:c.objId}),r.internal.out("endobj")}s&&(function(T,A){for(var w in T)if(T.hasOwnProperty(w)){var R=w,D=T[w];A.internal.newObjectDeferredBegin(D.objId,!0),Rr(D)==="object"&&typeof D.putStream=="function"&&D.putStream(),delete T[R]}})(r.internal.acroformPlugin.xForms,r)})(t,i)}),i.internal.acroformPlugin.isInitialized=!0}},tC=Zs.__acroform__.arrayToPdfArray=function(i,e,t){var n=function(l){return l};if(Array.isArray(i)){for(var r="[",s=0;s<i.length;s++)switch(s!==0&&(r+=" "),Rr(i[s])){case"boolean":case"number":case"object":r+=i[s].toString();break;case"string":i[s].substr(0,1)!=="/"?(e!==void 0&&t&&(n=t.internal.getEncryptor(e)),r+="("+Up(n(i[s].toString()))+")"):r+=i[s].toString()}return r+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},x_=function(i,e,t){var n=function(r){return r};return e!==void 0&&t&&(n=t.internal.getEncryptor(e)),(i=i||"").toString(),"("+Up(n(i))+")"},Pf=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(i){this._objId=i}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Pf.prototype.toString=function(){return this.objId+" 0 R"},Pf.prototype.putStream=function(){var i=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:i,objectId:this.objId}),this.scope.internal.out("endobj")},Pf.prototype.getKeyValueListForStream=function(){var i=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var n=e[t],r=this[n];r&&(Array.isArray(r)?i.push({key:n,value:tC(r,this.objId,this.scope)}):r instanceof Pf?(r.scope=this.scope,i.push({key:n,value:r.objId+" 0 R"})):typeof r!="function"&&i.push({key:n,value:r}))}return i};var nC=function(){Pf.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var i,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){i=t.trim()},get:function(){return i||null}})};Yl(nC,Pf);var iC=function(){Pf.call(this);var i,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(i){var t=function(n){return n};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Up(t(i))+")"}},set:function(t){i=t}})};Yl(iC,Pf);var ju=function i(){Pf.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute F supplied.');e=w}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!pa(e,3)},set:function(w){w?this.F=ma(e,3):this.F=ga(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute Ff supplied.');t=w}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(w){n=w!==void 0?w:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(w){n[0]=w}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(w){n[1]=w}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(w){n[2]=w}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(w){n[3]=w}});var r="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return r},set:function(w){switch(w){case"/Btn":case"/Tx":case"/Ch":case"/Sig":r=w;break;default:throw new Error('Invalid value "'+w+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof Py)return;s="FieldObject"+i.FieldNum++}var w=function(R){return R};return this.scope&&(w=this.scope.internal.getEncryptor(this.objId)),"("+Up(w(s))+")"},set:function(w){s=w.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(w){s=w}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(w){l=w}});var c="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return c},set:function(w){c=w}});var f=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return f},set:function(w){f=w}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/b2:d},set:function(w){d=w}});var m="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return m},set:function(w){m=w}});var g="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!g||this instanceof Py||this instanceof Ap))return x_(g,this.objId,this.scope)},set:function(w){w=w.toString(),g=w}});var y=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(y)return this instanceof Za==0?x_(y,this.objId,this.scope):y},set:function(w){w=w.toString(),y=this instanceof Za==0?w.substr(0,1)==="("?zm(w.substr(1,w.length-2)):zm(w):w}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Za==1?zm(y.substr(1,y.length-1)):y},set:function(w){w=w.toString(),y=this instanceof Za==1?"/"+w:w}});var v=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(v)return v},set:function(w){this.V=w}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(v)return this instanceof Za==0?x_(v,this.objId,this.scope):v},set:function(w){w=w.toString(),v=this instanceof Za==0?w.substr(0,1)==="("?zm(w.substr(1,w.length-2)):zm(w):w}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Za==1?zm(v.substr(1,v.length-1)):v},set:function(w){w=w.toString(),v=this instanceof Za==1?"/"+w:w}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var S,T=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return T},set:function(w){w=!!w,T=w}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(S)return S},set:function(w){S=w}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!pa(this.Ff,1)},set:function(w){w?this.Ff=ma(this.Ff,1):this.Ff=ga(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!pa(this.Ff,2)},set:function(w){w?this.Ff=ma(this.Ff,2):this.Ff=ga(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!pa(this.Ff,3)},set:function(w){w?this.Ff=ma(this.Ff,3):this.Ff=ga(this.Ff,3)}});var A=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(A!==null)return A},set:function(w){if([0,1,2].indexOf(w)===-1)throw new Error('Invalid value "'+w+'" for attribute Q supplied.');A=w}}),Object.defineProperty(this,"textAlign",{get:function(){var w;switch(A){case 0:default:w="left";break;case 1:w="center";break;case 2:w="right"}return w},configurable:!0,enumerable:!0,set:function(w){switch(w){case"right":case 2:A=2;break;case"center":case 1:A=1;break;default:A=0}}})};Yl(ju,Pf);var t0=function(){ju.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var i=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return i},set:function(t){i=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return i},set:function(t){i=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return tC(e,this.objId,this.scope)},set:function(t){var n,r;r=[],typeof(n=t)=="string"&&(r=(function(s,l,c){c||(c=1);for(var f,d=[];f=l.exec(s);)d.push(f[c]);return d})(n,/\((.*?)\)/g)),e=r}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,n){for(n=n||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!pa(this.Ff,18)},set:function(t){t?this.Ff=ma(this.Ff,18):this.Ff=ga(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!pa(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=ma(this.Ff,19):this.Ff=ga(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!pa(this.Ff,20)},set:function(t){t?(this.Ff=ma(this.Ff,20),e.sort()):this.Ff=ga(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!pa(this.Ff,22)},set:function(t){t?this.Ff=ma(this.Ff,22):this.Ff=ga(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!pa(this.Ff,23)},set:function(t){t?this.Ff=ma(this.Ff,23):this.Ff=ga(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!pa(this.Ff,27)},set:function(t){t?this.Ff=ma(this.Ff,27):this.Ff=ga(this.Ff,27)}}),this.hasAppearanceStream=!1};Yl(t0,ju);var n0=function(){t0.call(this),this.fontName="helvetica",this.combo=!1};Yl(n0,t0);var i0=function(){n0.call(this),this.combo=!0};Yl(i0,n0);var Tx=function(){i0.call(this),this.edit=!0};Yl(Tx,i0);var Za=function(){ju.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!pa(this.Ff,15)},set:function(t){t?this.Ff=ma(this.Ff,15):this.Ff=ga(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!pa(this.Ff,16)},set:function(t){t?this.Ff=ma(this.Ff,16):this.Ff=ga(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!pa(this.Ff,17)},set:function(t){t?this.Ff=ma(this.Ff,17):this.Ff=ga(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!pa(this.Ff,26)},set:function(t){t?this.Ff=ma(this.Ff,26):this.Ff=ga(this.Ff,26)}});var i,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(s){return s};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,r=[];for(n in r.push("<<"),e)r.push("/"+n+" ("+Up(t(e[n]))+")");return r.push(">>"),r.join(`
`)}},set:function(t){Rr(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return i},set:function(t){i=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return i.substr(1,i.length-1)},set:function(t){i="/"+t}})};Yl(Za,ju);var Ex=function(){Za.call(this),this.pushButton=!0};Yl(Ex,Za);var r0=function(){Za.call(this),this.radio=!0,this.pushButton=!1;var i=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return i},set:function(e){i=e!==void 0?e:[]}})};Yl(r0,Za);var Py=function(){var i,e;ju.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return i},set:function(r){i=r}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(r){e=r}});var t,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(c){return c};this.scope&&(r=this.scope.internal.getEncryptor(this.objId));var s,l=[];for(s in l.push("<<"),n)l.push("/"+s+" ("+Up(r(n[s]))+")");return l.push(">>"),l.join(`
`)},set:function(r){Rr(r)==="object"&&(n=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(r){typeof r=="string"&&(n.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Un.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Yl(Py,ju),r0.prototype.setAppearance=function(i){if(!("createAppearanceStream"in i)||!("getCA"in i))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=i.createAppearanceStream(t.optionName),t.caption=i.getCA()}},r0.prototype.createOption=function(i){var e=new Py;return e.Parent=this,e.optionName=i,this.Kids.push(e),Wz.call(this.scope,e),e};var Cx=function(){Za.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Un.CheckBox.createAppearanceStream()};Yl(Cx,Za);var Ap=function(){ju.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!pa(this.Ff,13)},set:function(e){e?this.Ff=ma(this.Ff,13):this.Ff=ga(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!pa(this.Ff,21)},set:function(e){e?this.Ff=ma(this.Ff,21):this.Ff=ga(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!pa(this.Ff,23)},set:function(e){e?this.Ff=ma(this.Ff,23):this.Ff=ga(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!pa(this.Ff,24)},set:function(e){e?this.Ff=ma(this.Ff,24):this.Ff=ga(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!pa(this.Ff,25)},set:function(e){e?this.Ff=ma(this.Ff,25):this.Ff=ga(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!pa(this.Ff,26)},set:function(e){e?this.Ff=ma(this.Ff,26):this.Ff=ga(this.Ff,26)}});var i=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return i},set:function(e){i=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return i},set:function(e){Number.isInteger(e)&&(i=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Yl(Ap,ju);var Nx=function(){Ap.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!pa(this.Ff,14)},set:function(i){i?this.Ff=ma(this.Ff,14):this.Ff=ga(this.Ff,14)}}),this.password=!0};Yl(Nx,Ap);var Un={CheckBox:{createAppearanceStream:function(){return{N:{On:Un.CheckBox.YesNormal},D:{On:Un.CheckBox.YesPushDown,Off:Un.CheckBox.OffPushDown}}},YesPushDown:function(i){var e=Cf(i);e.scope=i.scope;var t=[],n=i.scope.internal.getFont(i.fontName,i.fontStyle).id,r=i.scope.__private__.encodeColorString(i.color),s=cS(i,i.caption);return t.push("0.749023 g"),t.push("0 0 "+_i(Un.internal.getWidth(i))+" "+_i(Un.internal.getHeight(i))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+n+" "+_i(s.fontSize)+" Tf "+r),t.push("BT"),t.push(s.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(i){var e=Cf(i);e.scope=i.scope;var t=i.scope.internal.getFont(i.fontName,i.fontStyle).id,n=i.scope.__private__.encodeColorString(i.color),r=[],s=Un.internal.getHeight(i),l=Un.internal.getWidth(i),c=cS(i,i.caption);return r.push("1 g"),r.push("0 0 "+_i(l)+" "+_i(s)+" re"),r.push("f"),r.push("q"),r.push("0 0 1 rg"),r.push("0 0 "+_i(l-1)+" "+_i(s-1)+" re"),r.push("W"),r.push("n"),r.push("0 g"),r.push("BT"),r.push("/"+t+" "+_i(c.fontSize)+" Tf "+n),r.push(c.text),r.push("ET"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(i){var e=Cf(i);e.scope=i.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+_i(Un.internal.getWidth(i))+" "+_i(Un.internal.getHeight(i))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(i){var e={D:{Off:Un.RadioButton.Circle.OffPushDown},N:{}};return e.N[i]=Un.RadioButton.Circle.YesNormal,e.D[i]=Un.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(i){var e=Cf(i);e.scope=i.scope;var t=[],n=Un.internal.getWidth(i)<=Un.internal.getHeight(i)?Un.internal.getWidth(i)/4:Un.internal.getHeight(i)/4;n=Number((.9*n).toFixed(5));var r=Un.internal.Bezier_C,s=Number((n*r).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+ad(Un.internal.getWidth(i)/2)+" "+ad(Un.internal.getHeight(i)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),t.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),t.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),t.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(i){var e=Cf(i);e.scope=i.scope;var t=[],n=Un.internal.getWidth(i)<=Un.internal.getHeight(i)?Un.internal.getWidth(i)/4:Un.internal.getHeight(i)/4;n=Number((.9*n).toFixed(5));var r=Number((2*n).toFixed(5)),s=Number((r*Un.internal.Bezier_C).toFixed(5)),l=Number((n*Un.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+ad(Un.internal.getWidth(i)/2)+" "+ad(Un.internal.getHeight(i)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),t.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),t.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),t.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+ad(Un.internal.getWidth(i)/2)+" "+ad(Un.internal.getHeight(i)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+l+" "+l+" "+n+" 0 "+n+" c"),t.push("-"+l+" "+n+" -"+n+" "+l+" -"+n+" 0 c"),t.push("-"+n+" -"+l+" -"+l+" -"+n+" 0 -"+n+" c"),t.push(l+" -"+n+" "+n+" -"+l+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(i){var e=Cf(i);e.scope=i.scope;var t=[],n=Un.internal.getWidth(i)<=Un.internal.getHeight(i)?Un.internal.getWidth(i)/4:Un.internal.getHeight(i)/4;n=Number((.9*n).toFixed(5));var r=Number((2*n).toFixed(5)),s=Number((r*Un.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+ad(Un.internal.getWidth(i)/2)+" "+ad(Un.internal.getHeight(i)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),t.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),t.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),t.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(i){var e={D:{Off:Un.RadioButton.Cross.OffPushDown},N:{}};return e.N[i]=Un.RadioButton.Cross.YesNormal,e.D[i]=Un.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(i){var e=Cf(i);e.scope=i.scope;var t=[],n=Un.internal.calculateCross(i);return t.push("q"),t.push("1 1 "+_i(Un.internal.getWidth(i)-2)+" "+_i(Un.internal.getHeight(i)-2)+" re"),t.push("W"),t.push("n"),t.push(_i(n.x1.x)+" "+_i(n.x1.y)+" m"),t.push(_i(n.x2.x)+" "+_i(n.x2.y)+" l"),t.push(_i(n.x4.x)+" "+_i(n.x4.y)+" m"),t.push(_i(n.x3.x)+" "+_i(n.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(i){var e=Cf(i);e.scope=i.scope;var t=Un.internal.calculateCross(i),n=[];return n.push("0.749023 g"),n.push("0 0 "+_i(Un.internal.getWidth(i))+" "+_i(Un.internal.getHeight(i))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+_i(Un.internal.getWidth(i)-2)+" "+_i(Un.internal.getHeight(i)-2)+" re"),n.push("W"),n.push("n"),n.push(_i(t.x1.x)+" "+_i(t.x1.y)+" m"),n.push(_i(t.x2.x)+" "+_i(t.x2.y)+" l"),n.push(_i(t.x4.x)+" "+_i(t.x4.y)+" m"),n.push(_i(t.x3.x)+" "+_i(t.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(i){var e=Cf(i);e.scope=i.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+_i(Un.internal.getWidth(i))+" "+_i(Un.internal.getHeight(i))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(i){var e=i.scope.internal.getFont(i.fontName,i.fontStyle).id,t=i.scope.__private__.encodeColorString(i.color);return"/"+e+" "+i.fontSize+" Tf "+t}};Un.internal={Bezier_C:.551915024494,calculateCross:function(i){var e=Un.internal.getWidth(i),t=Un.internal.getHeight(i),n=Math.min(e,t);return{x1:{x:(e-n)/2,y:(t-n)/2+n},x2:{x:(e-n)/2+n,y:(t-n)/2},x3:{x:(e-n)/2,y:(t-n)/2},x4:{x:(e-n)/2+n,y:(t-n)/2+n}}}},Un.internal.getWidth=function(i){var e=0;return Rr(i)==="object"&&(e=bA(i.Rect[2])),e},Un.internal.getHeight=function(i){var e=0;return Rr(i)==="object"&&(e=bA(i.Rect[3])),e};var Wz=Zs.addField=function(i){if(qz(this,i),!(i instanceof ju))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=i).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),i.page=i.scope.internal.getCurrentPageInfo().pageNumber,this};Zs.AcroFormChoiceField=t0,Zs.AcroFormListBox=n0,Zs.AcroFormComboBox=i0,Zs.AcroFormEditBox=Tx,Zs.AcroFormButton=Za,Zs.AcroFormPushButton=Ex,Zs.AcroFormRadioButton=r0,Zs.AcroFormCheckBox=Cx,Zs.AcroFormTextField=Ap,Zs.AcroFormPasswordField=Nx,Zs.AcroFormAppearance=Un,Zs.AcroForm={ChoiceField:t0,ListBox:n0,ComboBox:i0,EditBox:Tx,Button:Za,PushButton:Ex,RadioButton:r0,CheckBox:Cx,TextField:Ap,PasswordField:Nx,Appearance:Un},jn.AcroForm={ChoiceField:t0,ListBox:n0,ComboBox:i0,EditBox:Tx,Button:Za,PushButton:Ex,RadioButton:r0,CheckBox:Cx,TextField:Ap,PasswordField:Nx,Appearance:Un};jn.AcroForm;function rC(i){return i.reduce(function(e,t,n){return e[t]=n,e},{})}(function(i){var e="addImage_";i.__addimage__={};var t="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=i.__addimage__.getImageFileTypeByImageData=function(U,q){var W,J,ce,K,ne,pe=t;if((q=q||t)==="RGBA"||U.data!==void 0&&U.data instanceof Uint8ClampedArray&&"height"in U&&"width"in U)return"RGBA";if(j(U))for(ne in n)for(ce=n[ne],W=0;W<ce.length;W+=1){for(K=!0,J=0;J<ce[W].length;J+=1)if(ce[W][J]!==void 0&&ce[W][J]!==U[J]){K=!1;break}if(K===!0){pe=ne;break}}else for(ne in n)for(ce=n[ne],W=0;W<ce.length;W+=1){for(K=!0,J=0;J<ce[W].length;J+=1)if(ce[W][J]!==void 0&&ce[W][J]!==U.charCodeAt(J)){K=!1;break}if(K===!0){pe=ne;break}}return pe===t&&q!==t&&(pe=q),pe},s=function U(q){for(var W=this.internal.write,J=this.internal.putStream,ce=(0,this.internal.getFilters)();ce.indexOf("FlateEncode")!==-1;)ce.splice(ce.indexOf("FlateEncode"),1);q.objectId=this.internal.newObject();var K=[];if(K.push({key:"Type",value:"/XObject"}),K.push({key:"Subtype",value:"/Image"}),K.push({key:"Width",value:q.width}),K.push({key:"Height",value:q.height}),q.colorSpace===w.INDEXED?K.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(q.palette.length/3-1)+" "+("sMask"in q&&q.sMask!==void 0?q.objectId+2:q.objectId+1)+" 0 R]"}):(K.push({key:"ColorSpace",value:"/"+q.colorSpace}),q.colorSpace===w.DEVICE_CMYK&&K.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),K.push({key:"BitsPerComponent",value:q.bitsPerComponent}),"decodeParameters"in q&&q.decodeParameters!==void 0&&K.push({key:"DecodeParms",value:"<<"+q.decodeParameters+">>"}),"transparency"in q&&Array.isArray(q.transparency)&&q.transparency.length>0){for(var ne="",pe=0,Re=q.transparency.length;pe<Re;pe++)ne+=q.transparency[pe]+" "+q.transparency[pe]+" ";K.push({key:"Mask",value:"["+ne+"]"})}q.sMask!==void 0&&K.push({key:"SMask",value:q.objectId+1+" 0 R"});var Te=q.filter!==void 0?["/"+q.filter]:void 0;if(J({data:q.data,additionalKeyValues:K,alreadyAppliedFilters:Te,objectId:q.objectId}),W("endobj"),"sMask"in q&&q.sMask!==void 0){var ee,F=(ee=q.sMaskBitsPerComponent)!==null&&ee!==void 0?ee:q.bitsPerComponent,$={width:q.width,height:q.height,colorSpace:"DeviceGray",bitsPerComponent:F,data:q.sMask};"filter"in q&&($.decodeParameters="/Predictor ".concat(q.predictor," /Colors 1 /BitsPerComponent ").concat(F," /Columns ").concat(q.width),$.filter=q.filter),U.call(this,$)}if(q.colorSpace===w.INDEXED){var re=this.internal.newObject();J({data:G(new Uint8Array(q.palette)),objectId:re}),W("endobj")}},l=function(){var U=this.internal.collections[e+"images"];for(var q in U)s.call(this,U[q])},c=function(){var U,q=this.internal.collections[e+"images"],W=this.internal.write;for(var J in q)W("/I"+(U=q[J]).index,U.objectId,"0","R")},f=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",l),this.internal.events.subscribe("putXobjectDict",c))},d=function(){var U=this.internal.collections[e+"images"];return f.call(this),U},m=function(){return Object.keys(this.internal.collections[e+"images"]).length},g=function(U){return typeof i["process"+U.toUpperCase()]=="function"},y=function(U){return Rr(U)==="object"&&U.nodeType===1},v=function(U,q){if(U.nodeName==="IMG"&&U.hasAttribute("src")){var W=""+U.getAttribute("src");if(W.indexOf("data:image/")===0)return Ax(unescape(W).split("base64,").pop());var J=i.loadFile(W,!0);if(J!==void 0)return J}if(U.nodeName==="CANVAS"){if(U.width===0||U.height===0)throw new Error("Given canvas must have data. Canvas width: "+U.width+", height: "+U.height);var ce;switch(q){case"PNG":ce="image/png";break;case"WEBP":ce="image/webp";break;default:ce="image/jpeg"}return Ax(U.toDataURL(ce,1).split("base64,").pop())}},S=function(U){var q=this.internal.collections[e+"images"];if(q){for(var W in q)if(U===q[W].alias)return q[W]}},T=function(U,q,W){return U||q||(U=-96,q=-96),U<0&&(U=-1*W.width*72/U/this.internal.scaleFactor),q<0&&(q=-1*W.height*72/q/this.internal.scaleFactor),U===0&&(U=q*W.width/W.height),q===0&&(q=U*W.height/W.width),[U,q]},A=function(U,q,W,J,ce,K){var ne=T.call(this,W,J,ce),pe=this.internal.getCoordinateString,Re=this.internal.getVerticalCoordinateString,Te=d.call(this);if(W=ne[0],J=ne[1],Te[ce.index]=ce,K){K*=Math.PI/180;var ee=Math.cos(K),F=Math.sin(K),$=function(Ae){return Ae.toFixed(4)},re=[$(ee),$(F),$(-1*F),$(ee),0,0,"cm"]}this.internal.write("q"),K?(this.internal.write([1,"0","0",1,pe(U),Re(q+J),"cm"].join(" ")),this.internal.write(re.join(" ")),this.internal.write([pe(W),"0","0",pe(J),"0","0","cm"].join(" "))):this.internal.write([pe(W),"0","0",pe(J),pe(U),Re(q+J),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ce.index+" Do"),this.internal.write("Q")},w=i.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};i.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var R=i.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},D=i.__addimage__.sHashCode=function(U){var q,W,J=0;if(typeof U=="string")for(W=U.length,q=0;q<W;q++)J=(J<<5)-J+U.charCodeAt(q),J|=0;else if(j(U))for(W=U.byteLength/2,q=0;q<W;q++)J=(J<<5)-J+U[q],J|=0;return J},I=i.__addimage__.validateStringAsBase64=function(U){(U=U||"").toString().trim();var q=!0;return U.length===0&&(q=!1),U.length%4!=0&&(q=!1),/^[A-Za-z0-9+/]+$/.test(U.substr(0,U.length-2))===!1&&(q=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(U.substr(-2))===!1&&(q=!1),q},z=i.__addimage__.extractImageFromDataUrl=function(U){if(U==null||!(U=U.trim()).startsWith("data:"))return null;var q=U.indexOf(",");return q<0?null:U.substring(0,q).trim().endsWith("base64")?U.substring(q+1):null};i.__addimage__.isArrayBuffer=function(U){return U instanceof ArrayBuffer};var j=i.__addimage__.isArrayBufferView=function(U){return U instanceof Int8Array||U instanceof Uint8Array||U instanceof Uint8ClampedArray||U instanceof Int16Array||U instanceof Uint16Array||U instanceof Int32Array||U instanceof Uint32Array||U instanceof Float32Array||U instanceof Float64Array},X=i.__addimage__.binaryStringToUint8Array=function(U){for(var q=U.length,W=new Uint8Array(q),J=0;J<q;J++)W[J]=U.charCodeAt(J);return W},G=i.__addimage__.arrayBufferToBinaryString=function(U){for(var q="",W=j(U)?U:new Uint8Array(U),J=0;J<W.length;J+=8192)q+=String.fromCharCode.apply(null,W.subarray(J,J+8192));return q};i.addImage=function(){var U,q,W,J,ce,K,ne,pe,Re;if(typeof arguments[1]=="number"?(q=t,W=arguments[1],J=arguments[2],ce=arguments[3],K=arguments[4],ne=arguments[5],pe=arguments[6],Re=arguments[7]):(q=arguments[1],W=arguments[2],J=arguments[3],ce=arguments[4],K=arguments[5],ne=arguments[6],pe=arguments[7],Re=arguments[8]),Rr(U=arguments[0])==="object"&&!y(U)&&"imageData"in U){var Te=U;U=Te.imageData,q=Te.format||q||t,W=Te.x||W||0,J=Te.y||J||0,ce=Te.w||Te.width||ce,K=Te.h||Te.height||K,ne=Te.alias||ne,pe=Te.compression||pe,Re=Te.rotation||Te.angle||Re}var ee=this.internal.getFilters();if(pe===void 0&&ee.indexOf("FlateEncode")!==-1&&(pe="SLOW"),isNaN(W)||isNaN(J))throw new Error("Invalid coordinates passed to jsPDF.addImage");f.call(this);var F=L.call(this,U,q,ne,pe);return A.call(this,W,J,ce,K,F,Re),this};var L=function(U,q,W,J){var ce,K,ne;if(typeof U=="string"&&r(U)===t){U=unescape(U);var pe=k(U,!1);(pe!==""||(pe=i.loadFile(U,!0))!==void 0)&&(U=pe)}if(y(U)&&(U=v(U,q)),q=r(U,q),!g(q))throw new Error("addImage does not support files of type '"+q+"', please ensure that a plugin for '"+q+"' support is added.");if(((ne=W)==null||ne.length===0)&&(W=(function(Re){return typeof Re=="string"||j(Re)?D(Re):j(Re.data)?D(Re.data):null})(U)),(ce=S.call(this,W))||(U instanceof Uint8Array||q==="RGBA"||(K=U,U=X(U)),ce=this["process"+q.toUpperCase()](U,m.call(this),W,(function(Re){return Re&&typeof Re=="string"&&(Re=Re.toUpperCase()),Re in i.image_compression?Re:R.NONE})(J),K)),!ce)throw new Error("An unknown error occurred whilst processing the image.");return ce},k=i.__addimage__.convertBase64ToBinaryString=function(U,q){q=typeof q!="boolean"||q;var W,J="";if(typeof U=="string"){var ce;W=(ce=z(U))!==null&&ce!==void 0?ce:U;try{J=Ax(W)}catch(K){if(q)throw I(W)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+K.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return J};i.getImageProperties=function(U){var q,W,J="";if(y(U)&&(U=v(U)),typeof U=="string"&&r(U)===t&&((J=k(U,!1))===""&&(J=i.loadFile(U)||""),U=J),W=r(U),!g(W))throw new Error("addImage does not support files of type '"+W+"', please ensure that a plugin for '"+W+"' support is added.");if(U instanceof Uint8Array||(U=X(U)),!(q=this["process"+W.toUpperCase()](U)))throw new Error("An unknown error occurred whilst processing the image");return q.fileType=W,q}})(jn.API),(function(i){var e=function(t){if(t!==void 0&&t!="")return!0};jn.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),i.events.push(["putPage",function(t){for(var n,r,s,l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,f=this.internal.getPageInfoByObjId(t.objId),d=t.pageContext.annotations,m=!1,g=0;g<d.length&&!m;g++)switch((n=d[g]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(m=!0);break;case"reference":case"text":case"freetext":m=!0}if(m!=0){this.internal.write("/Annots [");for(var y=0;y<d.length;y++){n=d[y];var v=this.internal.pdfEscape,S=this.internal.getEncryptor(t.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var T=this.internal.newAdditionalObject(),A=this.internal.newAdditionalObject(),w=this.internal.getEncryptor(T.objId),R=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(r="/Rect ["+l(n.bounds.x)+" "+c(n.bounds.y+n.bounds.h)+" "+l(n.bounds.x+n.bounds.w)+" "+c(n.bounds.y)+"] ")+"/Contents ("+v(w(n.contents))+")",s+=" /Popup "+A.objId+" 0 R",s+=" /P "+f.objId+" 0 R",s+=" /T ("+v(w(R))+") >>",T.content=s;var D=T.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+l(n.bounds.x+30)+" "+c(n.bounds.y+n.bounds.h)+" "+l(n.bounds.x+n.bounds.w+30)+" "+c(n.bounds.y)+"] ")+" /Parent "+D,n.open&&(s+=" /Open true"),s+=" >>",A.content=s,this.internal.write(T.objId,"0 R",A.objId,"0 R");break;case"freetext":r="/Rect ["+l(n.bounds.x)+" "+c(n.bounds.y)+" "+l(n.bounds.x+n.bounds.w)+" "+c(n.bounds.y+n.bounds.h)+"] ";var I=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+v(S(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+I+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var z=this.annotations._nameMap[n.options.name];n.options.pageNumber=z.page,n.options.top=z.y}else n.options.top||(n.options.top=0);if(r="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+v(S(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;default:var j=c(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+j+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),i.createAnnotation=function(t){var n=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":n.pageContext.annotations.push(t)}},i.link=function(t,n,r,s,l){var c=this.internal.getCurrentPageInfo(),f=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;c.pageContext.annotations.push({finalBounds:{x:f(t),y:d(n),w:f(t+r),h:d(n+s)},options:l,type:"link"})},i.textWithLink=function(t,n,r,s){var l,c,f=this.getTextWidth(t),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){c=s.maxWidth;var m=this.splitTextToSize(t,c).length;l=Math.ceil(d*m)}else c=f,l=d;return this.text(t,n,r,s),r+=.2*d,s.align==="center"&&(n-=f/2),s.align==="right"&&(n-=f),this.link(n,r-d,c,l,s),f},i.getTextWidth=function(t){var n=this.internal.getFontSize();return this.getStringUnitWidth(t)*n/this.internal.scaleFactor}})(jn.API),(function(i){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},r=[1570,1571,1573,1575];i.__arabicParser__={};var s=i.__arabicParser__.isInArabicSubstitutionA=function(T){return e[T.charCodeAt(0)]!==void 0},l=i.__arabicParser__.isArabicLetter=function(T){return typeof T=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(T)},c=i.__arabicParser__.isArabicEndLetter=function(T){return l(T)&&s(T)&&e[T.charCodeAt(0)].length<=2},f=i.__arabicParser__.isArabicAlfLetter=function(T){return l(T)&&r.indexOf(T.charCodeAt(0))>=0};i.__arabicParser__.arabicLetterHasIsolatedForm=function(T){return l(T)&&s(T)&&e[T.charCodeAt(0)].length>=1};var d=i.__arabicParser__.arabicLetterHasFinalForm=function(T){return l(T)&&s(T)&&e[T.charCodeAt(0)].length>=2};i.__arabicParser__.arabicLetterHasInitialForm=function(T){return l(T)&&s(T)&&e[T.charCodeAt(0)].length>=3};var m=i.__arabicParser__.arabicLetterHasMedialForm=function(T){return l(T)&&s(T)&&e[T.charCodeAt(0)].length==4},g=i.__arabicParser__.resolveLigatures=function(T){var A=0,w=t,R="",D=0;for(A=0;A<T.length;A+=1)w[T.charCodeAt(A)]!==void 0?(D++,typeof(w=w[T.charCodeAt(A)])=="number"&&(R+=String.fromCharCode(w),w=t,D=0),A===T.length-1&&(w=t,R+=T.charAt(A-(D-1)),A-=D-1,D=0)):(w=t,R+=T.charAt(A-D),A-=D,D=0);return R};i.__arabicParser__.isArabicDiacritic=function(T){return T!==void 0&&n[T.charCodeAt(0)]!==void 0};var y=i.__arabicParser__.getCorrectForm=function(T,A,w){return l(T)?s(T)===!1?-1:!d(T)||!l(A)&&!l(w)||!l(w)&&c(A)||c(T)&&!l(A)||c(T)&&f(A)||c(T)&&c(A)?0:m(T)&&l(A)&&!c(A)&&l(w)&&d(w)?3:c(T)||!l(w)?1:2:-1},v=function(T){var A=0,w=0,R=0,D="",I="",z="",j=(T=T||"").split("\\s+"),X=[];for(A=0;A<j.length;A+=1){for(X.push(""),w=0;w<j[A].length;w+=1)D=j[A][w],I=j[A][w-1],z=j[A][w+1],l(D)?(R=y(D,I,z),X[A]+=R!==-1?String.fromCharCode(e[D.charCodeAt(0)][R]):D):X[A]+=D;X[A]=g(X[A])}return X.join(" ")},S=i.__arabicParser__.processArabic=i.processArabic=function(){var T,A=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,w=[];if(Array.isArray(A)){var R=0;for(w=[],R=0;R<A.length;R+=1)Array.isArray(A[R])?w.push([v(A[R][0]),A[R][1],A[R][2]]):w.push([v(A[R])]);T=w}else T=v(A);return typeof arguments[0]=="string"?T:(arguments[0].text=T,arguments[0])};i.events.push(["preProcessText",S])})(jn.API),jn.API.autoPrint=function(i){var e;return(i=i||{}).variant=i.variant||"non-conform",i.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(i){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(c){t=c}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(c){n=isNaN(c)||Number.isInteger(c)===!1||c<0?150:c,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(c){r=isNaN(c)||Number.isInteger(c)===!1||c<0?300:c,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(c){s=c}});var l={};Object.defineProperty(this,"style",{get:function(){return l},set:function(c){l=c}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,n){var r;if((t=t||"2d")!=="2d")return null;for(r in n)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=n[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},i.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(jn.API),(function(i){var e={left:0,top:0,bottom:0,right:0},t=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),r.call(this))},r=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var f=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return f},set:function(T){f=T}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(T){d=T}});var m=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return m},set:function(T){m=T}});var g=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return g},set:function(T){g=T}});var y=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return y},set:function(T){y=T}});var v=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return v},set:function(T){v=T}});var S=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return S},set:function(T){S=T}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},i.setHeaderFunction=function(f){return n.call(this),this.internal.__cell__.headerFunction=typeof f=="function"?f:void 0,this},i.getTextDimensions=function(f,d){n.call(this);var m=(d=d||{}).fontSize||this.getFontSize(),g=d.font||this.getFont(),y=d.scaleFactor||this.internal.scaleFactor,v=0,S=0,T=0,A=this;if(!Array.isArray(f)&&typeof f!="string"){if(typeof f!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");f=String(f)}var w=d.maxWidth;w>0?typeof f=="string"?f=this.splitTextToSize(f,w):Object.prototype.toString.call(f)==="[object Array]"&&(f=f.reduce(function(D,I){return D.concat(A.splitTextToSize(I,w))},[])):f=Array.isArray(f)?f:[f];for(var R=0;R<f.length;R++)v<(T=this.getStringUnitWidth(f[R],{font:g})*m)&&(v=T);return v!==0&&(S=f.length),{w:v/=y,h:Math.max((S*m*this.getLineHeightFactor()-m*(this.getLineHeightFactor()-1))/y,0)}},i.cellAddPage=function(){n.call(this),this.addPage();var f=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(f.left,f.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=i.cell=function(){var f;f=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var d=this.internal.__cell__.lastCell,m=this.internal.__cell__.padding,g=this.internal.__cell__.margins||e,y=this.internal.__cell__.tableHeaderRow,v=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===f.lineNumber?(f.x=(d.x||0)+(d.width||0),f.y=d.y||0):d.y+d.height+f.height+g.bottom>this.getPageHeight()?(this.cellAddPage(),f.y=g.top,v&&y&&(this.printHeaderRow(f.lineNumber,!0),f.y+=y[0].height)):f.y=d.y+d.height||f.y),f.text[0]!==void 0&&(this.rect(f.x,f.y,f.width,f.height,t===!0?"FD":void 0),f.align==="right"?this.text(f.text,f.x+f.width-m,f.y+m,{align:"right",baseline:"top"}):f.align==="center"?this.text(f.text,f.x+f.width/2,f.y+m,{align:"center",baseline:"top",maxWidth:f.width-m-m}):this.text(f.text,f.x+m,f.y+m,{align:"left",baseline:"top",maxWidth:f.width-m-m})),this.internal.__cell__.lastCell=f,this};i.table=function(f,d,m,g,y){if(n.call(this),!m)throw new Error("No data for PDF table.");var v,S,T,A,w=[],R=[],D=[],I={},z={},j=[],X=[],G=(y=y||{}).autoSize||!1,L=y.printHeaders!==!1,k=y.css&&y.css["font-size"]!==void 0?16*y.css["font-size"]:y.fontSize||12,U=y.margins||Object.assign({width:this.getPageWidth()},e),q=typeof y.padding=="number"?y.padding:3,W=y.headerBackgroundColor||"#c8c8c8",J=y.headerTextColor||"#000";if(r.call(this),this.internal.__cell__.printHeaders=L,this.internal.__cell__.margins=U,this.internal.__cell__.table_font_size=k,this.internal.__cell__.padding=q,this.internal.__cell__.headerBackgroundColor=W,this.internal.__cell__.headerTextColor=J,this.setFontSize(k),g==null)R=w=Object.keys(m[0]),D=w.map(function(){return"left"});else if(Array.isArray(g)&&Rr(g[0])==="object")for(w=g.map(function(Te){return Te.name}),R=g.map(function(Te){return Te.prompt||Te.name||""}),D=g.map(function(Te){return Te.align||"left"}),v=0;v<g.length;v+=1)z[g[v].name]=.7499990551181103*g[v].width;else Array.isArray(g)&&typeof g[0]=="string"&&(R=w=g,D=w.map(function(){return"left"}));if(G||Array.isArray(g)&&typeof g[0]=="string")for(v=0;v<w.length;v+=1){for(I[A=w[v]]=m.map(function(Te){return Te[A]}),this.setFont(void 0,"bold"),j.push(this.getTextDimensions(R[v],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),S=I[A],this.setFont(void 0,"normal"),T=0;T<S.length;T+=1)j.push(this.getTextDimensions(S[T],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);z[A]=Math.max.apply(null,j)+q+q,j=[]}if(L){var ce={};for(v=0;v<w.length;v+=1)ce[w[v]]={},ce[w[v]].text=R[v],ce[w[v]].align=D[v];var K=c.call(this,ce,z);X=w.map(function(Te){return new s(f,d,z[Te],K,ce[Te].text,void 0,ce[Te].align)}),this.setTableHeaderRow(X),this.printHeaderRow(1,!1)}var ne=g.reduce(function(Te,ee){return Te[ee.name]=ee.align,Te},{});for(v=0;v<m.length;v+=1){"rowStart"in y&&y.rowStart instanceof Function&&y.rowStart({row:v,data:m[v]},this);var pe=c.call(this,m[v],z);for(T=0;T<w.length;T+=1){var Re=m[v][w[T]];"cellStart"in y&&y.cellStart instanceof Function&&y.cellStart({row:v,col:T,data:Re},this),l.call(this,new s(f,d,z[w[T]],pe,Re,v+2,ne[w[T]]))}}return this.internal.__cell__.table_x=f,this.internal.__cell__.table_y=d,this};var c=function(f,d){var m=this.internal.__cell__.padding,g=this.internal.__cell__.table_font_size,y=this.internal.scaleFactor;return Object.keys(f).map(function(v){var S=f[v];return this.splitTextToSize(S.hasOwnProperty("text")?S.text:S,d[v]-m-m)},this).map(function(v){return this.getLineHeightFactor()*v.length*g/y+m+m},this).reduce(function(v,S){return Math.max(v,S)},0)};i.setTableHeaderRow=function(f){n.call(this),this.internal.__cell__.tableHeaderRow=f},i.printHeaderRow=function(f,d){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var m;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var g=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(g[0],g[1],g[2],g[3],void 0,-1)}this.setFont(void 0,"bold");for(var y=[],v=0;v<this.internal.__cell__.tableHeaderRow.length;v+=1){m=this.internal.__cell__.tableHeaderRow[v].clone(),d&&(m.y=this.internal.__cell__.margins.top||0,y.push(m)),m.lineNumber=f;var S=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,m),this.setTextColor(S)}y.length>0&&this.setTableHeaderRow(y),this.setFont(void 0,"normal"),t=!1}})(jn.API);var sC={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},aC=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],uS=rC(aC),oC=[100,200,300,400,500,600,700,800,900],Xz=rC(oC);function y_(i){var e=i.family.replace(/"|'/g,"").toLowerCase(),t=(function(s){return sC[s=s||"normal"]?s:"normal"})(i.style),n=(function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400})(i.weight),r=(function(s){return typeof uS[s=s||"normal"]=="number"?s:"normal"})(i.stretch);return{family:e,style:t,weight:n,stretch:r,src:i.src||[],ref:i.ref||{name:e,style:[r,t,n].join(" ")}}}function _A(i,e,t,n){var r;for(r=t;r>=0&&r<e.length;r+=n)if(i[e[r]])return i[e[r]];for(r=t;r>=0&&r<e.length;r-=n)if(i[e[r]])return i[e[r]]}var Yz={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},SA={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function wA(i){return[i.stretch,i.style,i.weight,i.family].join(" ")}function MA(i){return i.trimLeft()}function Zz(i,e){for(var t=0;t<i.length;){if(i.charAt(t)===e)return[i.substring(0,t),i.substring(t+1)];t+=1}return null}function $z(i){var e=i.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],i.substring(e[0].length)]}var vx,AA,TA,jm,xx,EA,CA,NA,b_=["times"];function RA(i,e,t,n,r){var s=4,l=PA;switch(r){case jn.API.image_compression.FAST:s=1,l=LA;break;case jn.API.image_compression.MEDIUM:s=6,l=IA;break;case jn.API.image_compression.SLOW:s=9,l=DA}i=(function(f,d,m,g){for(var y,v=f.length/d,S=new Uint8Array(f.length+v),T=[Jz,LA,PA,IA,DA],A=0;A<v;A+=1){var w=A*d,R=f.subarray(w,w+d);if(g)S.set(g(R,m,y),w+A);else{for(var D=T.length,I=[],z=0;z<D;z+=1)I[z]=T[z](R,m,y);var j=Qz(I.concat());S.set(I[j],w+A)}y=R}return S})(i,e,Math.ceil(t*n/8),l);var c=iS(i,{level:s});return jn.API.__addimage__.arrayBufferToBinaryString(c)}function Jz(i){var e=Array.apply([],i);return e.unshift(0),e}function LA(i,e){var t=i.length,n=[];n[0]=1;for(var r=0;r<t;r+=1){var s=i[r-e]||0;n[r+1]=i[r]-s+256&255}return n}function PA(i,e,t){var n=i.length,r=[];r[0]=2;for(var s=0;s<n;s+=1){var l=t&&t[s]||0;r[s+1]=i[s]-l+256&255}return r}function IA(i,e,t){var n=i.length,r=[];r[0]=3;for(var s=0;s<n;s+=1){var l=i[s-e]||0,c=t&&t[s]||0;r[s+1]=i[s]+256-(l+c>>>1)&255}return r}function DA(i,e,t){var n=i.length,r=[];r[0]=4;for(var s=0;s<n;s+=1){var l=Kz(i[s-e]||0,t&&t[s]||0,t&&t[s-e]||0);r[s+1]=i[s]-l+256&255}return r}function Kz(i,e,t){if(i===e&&e===t)return i;var n=Math.abs(e-t),r=Math.abs(i-t),s=Math.abs(i+e-t-t);return n<=r&&n<=s?i:r<=s?e:t}function Qz(i){var e=i.map(function(t){return t.reduce(function(n,r){return n+Math.abs(r)},0)});return e.indexOf(Math.min.apply(null,e))}function __(i,e,t){var n=e*t,r=Math.floor(n/8),s=16-(n-8*r+t),l=(1<<t)-1;return lC(i,r)>>s&l}function kA(i,e,t,n){var r=t*n,s=Math.floor(r/8),l=16-(r-8*s+n),c=(1<<n)-1,f=(e&c)<<l;(function(d,m,g){if(m+1<d.byteLength)d.setUint16(m,g,!1);else{var y=g>>8&255;d.setUint8(m,y)}})(i,s,lC(i,s)&~(c<<l)&65535|f)}function lC(i,e){return e+1<i.byteLength?i.getUint16(e,!1):i.getUint8(e)<<8}function e9(i){var e=0;if(i[e++]!==71||i[e++]!==73||i[e++]!==70||i[e++]!==56||(i[e++]+1&253)!=56||i[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=i[e++]|i[e++]<<8,n=i[e++]|i[e++]<<8,r=i[e++],s=r>>7,l=1<<1+(7&r);i[e++],i[e++];var c=null,f=null;s&&(c=e,f=l,e+=3*l);var d=!0,m=[],g=0,y=null,v=0,S=null;for(this.width=t,this.height=n;d&&e<i.length;)switch(i[e++]){case 33:switch(i[e++]){case 255:if(i[e]!==11||i[e+1]==78&&i[e+2]==69&&i[e+3]==84&&i[e+4]==83&&i[e+5]==67&&i[e+6]==65&&i[e+7]==80&&i[e+8]==69&&i[e+9]==50&&i[e+10]==46&&i[e+11]==48&&i[e+12]==3&&i[e+13]==1&&i[e+16]==0)e+=14,S=i[e++]|i[e++]<<8,e++;else for(e+=12;;){if(!((U=i[e++])>=0))throw Error("Invalid block size");if(U===0)break;e+=U}break;case 249:if(i[e++]!==4||i[e+4]!==0)throw new Error("Invalid graphics extension block.");var T=i[e++];g=i[e++]|i[e++]<<8,y=i[e++],1&T||(y=null),v=T>>2&7,e++;break;case 254:for(;;){if(!((U=i[e++])>=0))throw Error("Invalid block size");if(U===0)break;e+=U}break;default:throw new Error("Unknown graphic control label: 0x"+i[e-1].toString(16))}break;case 44:var A=i[e++]|i[e++]<<8,w=i[e++]|i[e++]<<8,R=i[e++]|i[e++]<<8,D=i[e++]|i[e++]<<8,I=i[e++],z=I>>6&1,j=1<<1+(7&I),X=c,G=f,L=!1;I>>7&&(L=!0,X=e,G=j,e+=3*j);var k=e;for(e++;;){var U;if(!((U=i[e++])>=0))throw Error("Invalid block size");if(U===0)break;e+=U}m.push({x:A,y:w,width:R,height:D,has_local_palette:L,palette_offset:X,palette_size:G,data_offset:k,data_length:e-k,transparent_index:y,interlaced:!!z,delay:g,disposal:v});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+i[e-1].toString(16))}this.numFrames=function(){return m.length},this.loopCount=function(){return S},this.frameInfo=function(q){if(q<0||q>=m.length)throw new Error("Frame index out of range.");return m[q]},this.decodeAndBlitFrameBGRA=function(q,W){var J=this.frameInfo(q),ce=J.width*J.height,K=new Uint8Array(ce);OA(i,J.data_offset,K,ce);var ne=J.palette_offset,pe=J.transparent_index;pe===null&&(pe=256);var Re=J.width,Te=t-Re,ee=Re,F=4*(J.y*t+J.x),$=4*((J.y+J.height)*t+J.x),re=F,Ae=4*Te;J.interlaced===!0&&(Ae+=4*t*7);for(var ie=8,_e=0,ke=K.length;_e<ke;++_e){var Fe=K[_e];if(ee===0&&(ee=Re,(re+=Ae)>=$&&(Ae=4*Te+4*t*(ie-1),re=F+(Re+Te)*(ie<<1),ie>>=1)),Fe===pe)re+=4;else{var We=i[ne+3*Fe],nt=i[ne+3*Fe+1],It=i[ne+3*Fe+2];W[re++]=It,W[re++]=nt,W[re++]=We,W[re++]=255}--ee}},this.decodeAndBlitFrameRGBA=function(q,W){var J=this.frameInfo(q),ce=J.width*J.height,K=new Uint8Array(ce);OA(i,J.data_offset,K,ce);var ne=J.palette_offset,pe=J.transparent_index;pe===null&&(pe=256);var Re=J.width,Te=t-Re,ee=Re,F=4*(J.y*t+J.x),$=4*((J.y+J.height)*t+J.x),re=F,Ae=4*Te;J.interlaced===!0&&(Ae+=4*t*7);for(var ie=8,_e=0,ke=K.length;_e<ke;++_e){var Fe=K[_e];if(ee===0&&(ee=Re,(re+=Ae)>=$&&(Ae=4*Te+4*t*(ie-1),re=F+(Re+Te)*(ie<<1),ie>>=1)),Fe===pe)re+=4;else{var We=i[ne+3*Fe],nt=i[ne+3*Fe+1],It=i[ne+3*Fe+2];W[re++]=We,W[re++]=nt,W[re++]=It,W[re++]=255}--ee}}}function OA(i,e,t,n){for(var r=i[e++],s=1<<r,l=s+1,c=l+1,f=r+1,d=(1<<f)-1,m=0,g=0,y=0,v=i[e++],S=new Int32Array(4096),T=null;;){for(;m<16&&v!==0;)g|=i[e++]<<m,m+=8,v===1?v=i[e++]:--v;if(m<f)break;var A=g&d;if(g>>=f,m-=f,A!==s){if(A===l)break;for(var w=A<c?A:T,R=0,D=w;D>s;)D=S[D]>>8,++R;var I=D;if(y+R+(w!==A?1:0)>n)return void Xr.log("Warning, gif stream longer than expected.");t[y++]=I;var z=y+=R;for(w!==A&&(t[y++]=I),D=w;R--;)D=S[D],t[--z]=255&D,D>>=8;T!==null&&c<4096&&(S[c++]=T<<8|I,c>=d+1&&f<12&&(++f,d=d<<1|1)),T=A}else c=l+1,d=(1<<(f=r+1))-1,T=null}return y!==n&&Xr.log("Warning, gif stream shorter than expected."),t}function S_(i){var e,t,n,r,s,l=Math.floor,c=new Array(64),f=new Array(64),d=new Array(64),m=new Array(64),g=new Array(65535),y=new Array(65535),v=new Array(64),S=new Array(64),T=[],A=0,w=7,R=new Array(64),D=new Array(64),I=new Array(64),z=new Array(256),j=new Array(2048),X=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],G=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],L=[0,1,2,3,4,5,6,7,8,9,10,11],k=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],U=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],q=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],W=[0,1,2,3,4,5,6,7,8,9,10,11],J=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ce=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function K(F,$){for(var re=0,Ae=0,ie=new Array,_e=1;_e<=16;_e++){for(var ke=1;ke<=F[_e];ke++)ie[$[Ae]]=[],ie[$[Ae]][0]=re,ie[$[Ae]][1]=_e,Ae++,re++;re*=2}return ie}function ne(F){for(var $=F[0],re=F[1]-1;re>=0;)$&1<<re&&(A|=1<<w),re--,--w<0&&(A==255?(pe(255),pe(0)):pe(A),w=7,A=0)}function pe(F){T.push(F)}function Re(F){pe(F>>8&255),pe(255&F)}function Te(F,$,re,Ae,ie){for(var _e,ke=ie[0],Fe=ie[240],We=(function(ot,Ct){var ht,xt,he,Q,Be,ue,je,Ye,ft,gt,Lt=0;for(ft=0;ft<8;++ft){ht=ot[Lt],xt=ot[Lt+1],he=ot[Lt+2],Q=ot[Lt+3],Be=ot[Lt+4],ue=ot[Lt+5],je=ot[Lt+6];var un=ht+(Ye=ot[Lt+7]),bt=ht-Ye,dt=xt+je,Ge=xt-je,xe=he+ue,Pe=he-ue,rt=Q+Be,Me=Q-Be,ze=un+rt,Mt=un-rt,Rt=dt+xe,se=dt-xe;ot[Lt]=ze+Rt,ot[Lt+4]=ze-Rt;var Ve=.707106781*(se+Mt);ot[Lt+2]=Mt+Ve,ot[Lt+6]=Mt-Ve;var vt=.382683433*((ze=Me+Pe)-(se=Ge+bt)),Dt=.5411961*ze+vt,bn=1.306562965*se+vt,dn=.707106781*(Rt=Pe+Ge),tn=bt+dn,gn=bt-dn;ot[Lt+5]=gn+Dt,ot[Lt+3]=gn-Dt,ot[Lt+1]=tn+bn,ot[Lt+7]=tn-bn,Lt+=8}for(Lt=0,ft=0;ft<8;++ft){ht=ot[Lt],xt=ot[Lt+8],he=ot[Lt+16],Q=ot[Lt+24],Be=ot[Lt+32],ue=ot[Lt+40],je=ot[Lt+48];var Pn=ht+(Ye=ot[Lt+56]),Bi=ht-Ye,xi=xt+je,$n=xt-je,ii=he+ue,wi=he-ue,Rn=Q+Be,ir=Q-Be,Mi=Pn+Rn,te=Pn-Rn,be=xi+ii,Ue=xi-ii;ot[Lt]=Mi+be,ot[Lt+32]=Mi-be;var lt=.707106781*(Ue+te);ot[Lt+16]=te+lt,ot[Lt+48]=te-lt;var Tt=.382683433*((Mi=ir+wi)-(Ue=$n+Bi)),St=.5411961*Mi+Tt,Xt=1.306562965*Ue+Tt,qt=.707106781*(be=wi+$n),an=Bi+qt,sn=Bi-qt;ot[Lt+40]=sn+St,ot[Lt+24]=sn-St,ot[Lt+8]=an+Xt,ot[Lt+56]=an-Xt,Lt++}for(ft=0;ft<64;++ft)gt=ot[ft]*Ct[ft],v[ft]=gt>0?gt+.5|0:gt-.5|0;return v})(F,$),nt=0;nt<64;++nt)S[X[nt]]=We[nt];var It=S[0]-re;re=S[0],It==0?ne(Ae[0]):(ne(Ae[y[_e=32767+It]]),ne(g[_e]));for(var wt=63;wt>0&&S[wt]==0;)wt--;if(wt==0)return ne(ke),re;for(var Je,le=1;le<=wt;){for(var Qe=le;S[le]==0&&le<=wt;)++le;var Et=le-Qe;if(Et>=16){Je=Et>>4;for(var we=1;we<=Je;++we)ne(Fe);Et&=15}_e=32767+S[le],ne(ie[(Et<<4)+y[_e]]),ne(g[_e]),le++}return wt!=63&&ne(ke),re}function ee(F){F=Math.min(Math.max(F,1),100),s!=F&&((function($){for(var re=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Ae=0;Ae<64;Ae++){var ie=l((re[Ae]*$+50)/100);ie=Math.min(Math.max(ie,1),255),c[X[Ae]]=ie}for(var _e=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ke=0;ke<64;ke++){var Fe=l((_e[ke]*$+50)/100);Fe=Math.min(Math.max(Fe,1),255),f[X[ke]]=Fe}for(var We=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],nt=0,It=0;It<8;It++)for(var wt=0;wt<8;wt++)d[nt]=1/(c[X[nt]]*We[It]*We[wt]*8),m[nt]=1/(f[X[nt]]*We[It]*We[wt]*8),nt++})(F<50?Math.floor(5e3/F):Math.floor(200-2*F)),s=F)}this.encode=function(F,$){$&&ee($),T=new Array,A=0,w=7,Re(65496),Re(65504),Re(16),pe(74),pe(70),pe(73),pe(70),pe(0),pe(1),pe(1),pe(0),Re(1),Re(1),pe(0),pe(0),(function(){Re(65499),Re(132),pe(0);for(var xt=0;xt<64;xt++)pe(c[xt]);pe(1);for(var he=0;he<64;he++)pe(f[he])})(),(function(xt,he){Re(65472),Re(17),pe(8),Re(he),Re(xt),pe(3),pe(1),pe(17),pe(0),pe(2),pe(17),pe(1),pe(3),pe(17),pe(1)})(F.width,F.height),(function(){Re(65476),Re(418),pe(0);for(var xt=0;xt<16;xt++)pe(G[xt+1]);for(var he=0;he<=11;he++)pe(L[he]);pe(16);for(var Q=0;Q<16;Q++)pe(k[Q+1]);for(var Be=0;Be<=161;Be++)pe(U[Be]);pe(1);for(var ue=0;ue<16;ue++)pe(q[ue+1]);for(var je=0;je<=11;je++)pe(W[je]);pe(17);for(var Ye=0;Ye<16;Ye++)pe(J[Ye+1]);for(var ft=0;ft<=161;ft++)pe(ce[ft])})(),Re(65498),Re(12),pe(3),pe(1),pe(0),pe(2),pe(17),pe(3),pe(17),pe(0),pe(63),pe(0);var re=0,Ae=0,ie=0;A=0,w=7,this.encode.displayName="_encode_";for(var _e,ke,Fe,We,nt,It,wt,Je,le,Qe=F.data,Et=F.width,we=F.height,ot=4*Et,Ct=0;Ct<we;){for(_e=0;_e<ot;){for(nt=ot*Ct+_e,wt=-1,Je=0,le=0;le<64;le++)It=nt+(Je=le>>3)*ot+(wt=4*(7&le)),Ct+Je>=we&&(It-=ot*(Ct+1+Je-we)),_e+wt>=ot&&(It-=_e+wt-ot+4),ke=Qe[It++],Fe=Qe[It++],We=Qe[It++],R[le]=(j[ke]+j[Fe+256|0]+j[We+512|0]>>16)-128,D[le]=(j[ke+768|0]+j[Fe+1024|0]+j[We+1280|0]>>16)-128,I[le]=(j[ke+1280|0]+j[Fe+1536|0]+j[We+1792|0]>>16)-128;re=Te(R,d,re,e,n),Ae=Te(D,m,Ae,t,r),ie=Te(I,m,ie,t,r),_e+=32}Ct+=8}if(w>=0){var ht=[];ht[1]=w+1,ht[0]=(1<<w+1)-1,ne(ht)}return Re(65497),new Uint8Array(T)},i=i||50,(function(){for(var F=String.fromCharCode,$=0;$<256;$++)z[$]=F($)})(),e=K(G,L),t=K(q,W),n=K(k,U),r=K(J,ce),(function(){for(var F=1,$=2,re=1;re<=15;re++){for(var Ae=F;Ae<$;Ae++)y[32767+Ae]=re,g[32767+Ae]=[],g[32767+Ae][1]=re,g[32767+Ae][0]=Ae;for(var ie=-($-1);ie<=-F;ie++)y[32767+ie]=re,g[32767+ie]=[],g[32767+ie][1]=re,g[32767+ie][0]=$-1+ie;F<<=1,$<<=1}})(),(function(){for(var F=0;F<256;F++)j[F]=19595*F,j[F+256|0]=38470*F,j[F+512|0]=7471*F+32768,j[F+768|0]=-11059*F,j[F+1024|0]=-21709*F,j[F+1280|0]=32768*F+8421375,j[F+1536|0]=-27439*F,j[F+1792|0]=-5329*F})(),ee(i)}function Iu(i,e){if(this.pos=0,this.buffer=i,this.datav=new DataView(i.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function BA(i){function e(L){if(!L)throw Error("assert :P")}function t(L,k,U){for(var q=0;4>q;q++)if(L[k+q]!=U.charCodeAt(q))return!0;return!1}function n(L,k,U,q,W){for(var J=0;J<W;J++)L[k+J]=U[q+J]}function r(L,k,U,q){for(var W=0;W<q;W++)L[k+W]=U}function s(L){return new Int32Array(L)}function l(L,k){for(var U=[],q=0;q<L;q++)U.push(new k);return U}function c(L,k){var U=[];return(function q(W,J,ce){for(var K=ce[J],ne=0;ne<K&&(W.push(ce.length>J+1?[]:new k),!(ce.length<J+1));ne++)q(W[ne],J+1,ce)})(U,0,L),U}var f=function(){var L=this;function k(M,N){for(var V=1<<N-1>>>0;M&V;)V>>>=1;return V?(M&V-1)+V:M}function U(M,N,V,Y,oe){e(!(Y%V));do M[N+(Y-=V)]=oe;while(0<Y)}function q(M,N,V,Y,oe){if(e(2328>=oe),512>=oe)var de=s(512);else if((de=s(oe))==null)return 0;return(function(me,Se,Ne,Le,Ke,mt){var Ce,it,st=Se,Ut=1<<Ne,pt=s(16),Bt=s(16);for(e(Ke!=0),e(Le!=null),e(me!=null),e(0<Ne),it=0;it<Ke;++it){if(15<Le[it])return 0;++pt[Le[it]]}if(pt[0]==Ke)return 0;for(Bt[1]=0,Ce=1;15>Ce;++Ce){if(pt[Ce]>1<<Ce)return 0;Bt[Ce+1]=Bt[Ce]+pt[Ce]}for(it=0;it<Ke;++it)Ce=Le[it],0<Le[it]&&(mt[Bt[Ce]++]=it);if(Bt[15]==1)return(Le=new W).g=0,Le.value=mt[0],U(me,st,1,Ut,Le),Ut;var Ft,Kt=-1,Yt=Ut-1,Dn=0,En=1,Wn=1,Ln=1<<Ne;for(it=0,Ce=1,Ke=2;Ce<=Ne;++Ce,Ke<<=1){if(En+=Wn<<=1,0>(Wn-=pt[Ce]))return 0;for(;0<pt[Ce];--pt[Ce])(Le=new W).g=Ce,Le.value=mt[it++],U(me,st+Dn,Ke,Ln,Le),Dn=k(Dn,Ce)}for(Ce=Ne+1,Ke=2;15>=Ce;++Ce,Ke<<=1){if(En+=Wn<<=1,0>(Wn-=pt[Ce]))return 0;for(;0<pt[Ce];--pt[Ce]){if(Le=new W,(Dn&Yt)!=Kt){for(st+=Ln,Ft=1<<(Kt=Ce)-Ne;15>Kt&&!(0>=(Ft-=pt[Kt]));)++Kt,Ft<<=1;Ut+=Ln=1<<(Ft=Kt-Ne),me[Se+(Kt=Dn&Yt)].g=Ft+Ne,me[Se+Kt].value=st-Se-Kt}Le.g=Ce-Ne,Le.value=mt[it++],U(me,st+(Dn>>Ne),Ke,Ln,Le),Dn=k(Dn,Ce)}}return En!=2*Bt[15]-1?0:Ut})(M,N,V,Y,oe,de)}function W(){this.value=this.g=0}function J(){this.value=this.g=0}function ce(){this.G=l(5,W),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l(Ql,J)}function K(M,N,V,Y){e(M!=null),e(N!=null),e(2147483648>Y),M.Ca=254,M.I=0,M.b=-8,M.Ka=0,M.oa=N,M.pa=V,M.Jd=N,M.Yc=V+Y,M.Zc=4<=Y?V+Y-4+1:V,ke(M)}function ne(M,N){for(var V=0;0<N--;)V|=We(M,128)<<N;return V}function pe(M,N){var V=ne(M,N);return Fe(M)?-V:V}function Re(M,N,V,Y){var oe,de=0;for(e(M!=null),e(N!=null),e(4294967288>Y),M.Sb=Y,M.Ra=0,M.u=0,M.h=0,4<Y&&(Y=4),oe=0;oe<Y;++oe)de+=N[V+oe]<<8*oe;M.Ra=de,M.bb=Y,M.oa=N,M.pa=V}function Te(M){for(;8<=M.u&&M.bb<M.Sb;)M.Ra>>>=8,M.Ra+=M.oa[M.pa+M.bb]<<Al-8>>>0,++M.bb,M.u-=8;Ae(M)&&(M.h=1,M.u=0)}function ee(M,N){if(e(0<=N),!M.h&&N<=ta){var V=re(M)&Jr[N];return M.u+=N,Te(M),V}return M.h=1,M.u=0}function F(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function $(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function re(M){return M.Ra>>>(M.u&Al-1)>>>0}function Ae(M){return e(M.bb<=M.Sb),M.h||M.bb==M.Sb&&M.u>Al}function ie(M,N){M.u=N,M.h=Ae(M)}function _e(M){M.u>=Xo&&(e(M.u>=Xo),Te(M))}function ke(M){e(M!=null&&M.oa!=null),M.pa<M.Zc?(M.I=(M.oa[M.pa++]|M.I<<8)>>>0,M.b+=8):(e(M!=null&&M.oa!=null),M.pa<M.Yc?(M.b+=8,M.I=M.oa[M.pa++]|M.I<<8):M.Ka?M.b=0:(M.I<<=8,M.b+=8,M.Ka=1))}function Fe(M){return ne(M,1)}function We(M,N){var V=M.Ca;0>M.b&&ke(M);var Y=M.b,oe=V*N>>>8,de=(M.I>>>Y>oe)+0;for(de?(V-=oe,M.I-=oe+1<<Y>>>0):V=oe+1,Y=V,oe=0;256<=Y;)oe+=8,Y>>=8;return Y=7^oe+Rs[Y],M.b-=Y,M.Ca=(V<<Y)-1,de}function nt(M,N,V){M[N+0]=V>>24&255,M[N+1]=V>>16&255,M[N+2]=V>>8&255,M[N+3]=255&V}function It(M,N){return M[N+0]|M[N+1]<<8}function wt(M,N){return It(M,N)|M[N+2]<<16}function Je(M,N){return It(M,N)|It(M,N+2)<<16}function le(M,N){var V=1<<N;return e(M!=null),e(0<N),M.X=s(V),M.X==null?0:(M.Mb=32-N,M.Xa=N,1)}function Qe(M,N){e(M!=null),e(N!=null),e(M.Xa==N.Xa),n(N.X,0,M.X,0,1<<N.Xa)}function Et(){this.X=[],this.Xa=this.Mb=0}function we(M,N,V,Y){e(V!=null),e(Y!=null);var oe=V[0],de=Y[0];return oe==0&&(oe=(M*de+N/2)/N),de==0&&(de=(N*oe+M/2)/M),0>=oe||0>=de?0:(V[0]=oe,Y[0]=de,1)}function ot(M,N){return M+(1<<N)-1>>>N}function Ct(M,N){return((4278255360&M)+(4278255360&N)>>>0&4278255360)+((16711935&M)+(16711935&N)>>>0&16711935)>>>0}function ht(M,N){L[N]=function(V,Y,oe,de,me,Se,Ne){var Le;for(Le=0;Le<me;++Le){var Ke=L[M](Se[Ne+Le-1],oe,de+Le);Se[Ne+Le]=Ct(V[Y+Le],Ke)}}}function xt(){this.ud=this.hd=this.jd=0}function he(M,N){return((4278124286&(M^N))>>>1)+(M&N)>>>0}function Q(M){return 0<=M&&256>M?M:0>M?0:255<M?255:void 0}function Be(M,N){return Q(M+(M-N+.5>>1))}function ue(M,N,V){return Math.abs(N-V)-Math.abs(M-V)}function je(M,N,V,Y,oe,de,me){for(Y=de[me-1],V=0;V<oe;++V)de[me+V]=Y=Ct(M[N+V],Y)}function Ye(M,N,V,Y,oe){var de;for(de=0;de<V;++de){var me=M[N+de],Se=me>>8&255,Ne=16711935&(Ne=(Ne=16711935&me)+((Se<<16)+Se));Y[oe+de]=(4278255360&me)+Ne>>>0}}function ft(M,N){N.jd=255&M,N.hd=M>>8&255,N.ud=M>>16&255}function gt(M,N,V,Y,oe,de){var me;for(me=0;me<Y;++me){var Se=N[V+me],Ne=Se>>>8,Le=Se,Ke=255&(Ke=(Ke=Se>>>16)+((M.jd<<24>>24)*(Ne<<24>>24)>>>5));Le=255&(Le=(Le+=(M.hd<<24>>24)*(Ne<<24>>24)>>>5)+((M.ud<<24>>24)*(Ke<<24>>24)>>>5)),oe[de+me]=(4278255360&Se)+(Ke<<16)+Le}}function Lt(M,N,V,Y,oe){L[N]=function(de,me,Se,Ne,Le,Ke,mt,Ce,it){for(Ne=mt;Ne<Ce;++Ne)for(mt=0;mt<it;++mt)Le[Ke++]=oe(Se[Y(de[me++])])},L[M]=function(de,me,Se,Ne,Le,Ke,mt){var Ce=8>>de.b,it=de.Ea,st=de.K[0],Ut=de.w;if(8>Ce)for(de=(1<<de.b)-1,Ut=(1<<Ce)-1;me<Se;++me){var pt,Bt=0;for(pt=0;pt<it;++pt)pt&de||(Bt=Y(Ne[Le++])),Ke[mt++]=oe(st[Bt&Ut]),Bt>>=Ce}else L["VP8LMapColor"+V](Ne,Le,st,Ut,Ke,mt,me,Se,it)}}function un(M,N,V,Y,oe){for(V=N+V;N<V;){var de=M[N++];Y[oe++]=de>>16&255,Y[oe++]=de>>8&255,Y[oe++]=255&de}}function bt(M,N,V,Y,oe){for(V=N+V;N<V;){var de=M[N++];Y[oe++]=de>>16&255,Y[oe++]=de>>8&255,Y[oe++]=255&de,Y[oe++]=de>>24&255}}function dt(M,N,V,Y,oe){for(V=N+V;N<V;){var de=(me=M[N++])>>16&240|me>>12&15,me=240&me|me>>28&15;Y[oe++]=de,Y[oe++]=me}}function Ge(M,N,V,Y,oe){for(V=N+V;N<V;){var de=(me=M[N++])>>16&248|me>>13&7,me=me>>5&224|me>>3&31;Y[oe++]=de,Y[oe++]=me}}function xe(M,N,V,Y,oe){for(V=N+V;N<V;){var de=M[N++];Y[oe++]=255&de,Y[oe++]=de>>8&255,Y[oe++]=de>>16&255}}function Pe(M,N,V,Y,oe,de){if(de==0)for(V=N+V;N<V;)nt(Y,((de=M[N++])[0]>>24|de[1]>>8&65280|de[2]<<8&16711680|de[3]<<24)>>>0),oe+=32;else n(Y,oe,M,N,V)}function rt(M,N){L[N][0]=L[M+"0"],L[N][1]=L[M+"1"],L[N][2]=L[M+"2"],L[N][3]=L[M+"3"],L[N][4]=L[M+"4"],L[N][5]=L[M+"5"],L[N][6]=L[M+"6"],L[N][7]=L[M+"7"],L[N][8]=L[M+"8"],L[N][9]=L[M+"9"],L[N][10]=L[M+"10"],L[N][11]=L[M+"11"],L[N][12]=L[M+"12"],L[N][13]=L[M+"13"],L[N][14]=L[M+"0"],L[N][15]=L[M+"0"]}function Me(M){return M==tf||M==Oc||M==pu||M==mu}function ze(){this.eb=[],this.size=this.A=this.fb=0}function Mt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Rt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ze,this.f.kb=new Mt,this.sd=null}function se(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ve(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function vt(M){return alert("todo:WebPSamplerProcessPlane"),M.T}function Dt(M,N){var V=M.T,Y=N.ba.f.RGBA,oe=Y.eb,de=Y.fb+M.ka*Y.A,me=aa[N.ba.S],Se=M.y,Ne=M.O,Le=M.f,Ke=M.N,mt=M.ea,Ce=M.W,it=N.cc,st=N.dc,Ut=N.Mc,pt=N.Nc,Bt=M.ka,Ft=M.ka+M.T,Kt=M.U,Yt=Kt+1>>1;for(Bt==0?me(Se,Ne,null,null,Le,Ke,mt,Ce,Le,Ke,mt,Ce,oe,de,null,null,Kt):(me(N.ec,N.fc,Se,Ne,it,st,Ut,pt,Le,Ke,mt,Ce,oe,de-Y.A,oe,de,Kt),++V);Bt+2<Ft;Bt+=2)it=Le,st=Ke,Ut=mt,pt=Ce,Ke+=M.Rc,Ce+=M.Rc,de+=2*Y.A,me(Se,(Ne+=2*M.fa)-M.fa,Se,Ne,it,st,Ut,pt,Le,Ke,mt,Ce,oe,de-Y.A,oe,de,Kt);return Ne+=M.fa,M.j+Ft<M.o?(n(N.ec,N.fc,Se,Ne,Kt),n(N.cc,N.dc,Le,Ke,Yt),n(N.Mc,N.Nc,mt,Ce,Yt),V--):1&Ft||me(Se,Ne,null,null,Le,Ke,mt,Ce,Le,Ke,mt,Ce,oe,de+Y.A,null,null,Kt),V}function bn(M,N,V){var Y=M.F,oe=[M.J];if(Y!=null){var de=M.U,me=N.ba.S,Se=me==sc||me==pu;N=N.ba.f.RGBA;var Ne=[0],Le=M.ka;Ne[0]=M.T,M.Kb&&(Le==0?--Ne[0]:(--Le,oe[0]-=M.width),M.j+M.ka+M.T==M.o&&(Ne[0]=M.o-M.j-Le));var Ke=N.eb;Le=N.fb+Le*N.A,M=Ku(Y,oe[0],M.width,de,Ne,Ke,Le+(Se?0:3),N.A),e(V==Ne),M&&Me(me)&&rc(Ke,Le,Se,de,Ne,N.A)}return 0}function dn(M){var N=M.ma,V=N.ba.S,Y=11>V,oe=V==br||V==sa||V==sc||V==So||V==12||Me(V);if(N.memory=null,N.Ib=null,N.Jb=null,N.Nd=null,!Wo(N.Oa,M,oe?11:12))return 0;if(oe&&Me(V)&&Zu(),M.da)alert("todo:use_scaling");else{if(Y){if(N.Ib=vt,M.Kb){if(V=M.U+1>>1,N.memory=s(M.U+2*V),N.memory==null)return 0;N.ec=N.memory,N.fc=0,N.cc=N.ec,N.dc=N.fc+M.U,N.Mc=N.cc,N.Nc=N.dc+V,N.Ib=Dt,Zu()}}else alert("todo:EmitYUV");oe&&(N.Jb=bn,Y&&yo())}if(Y&&!hc){for(M=0;256>M;++M)Qn[M]=89858*(M-128)+vu>>lo,Vp[M]=-22014*(M-128)+vu,jp[M]=-45773*(M-128),sf[M]=113618*(M-128)+vu>>lo;for(M=Fc;M<wo;++M)N=76283*(M-16)+vu>>lo,T0[M-Fc]=nn(N,255),E0[M-Fc]=nn(N+8>>4,15);hc=1}return 1}function tn(M){var N=M.ma,V=M.U,Y=M.T;return e(!(1&M.ka)),0>=V||0>=Y?0:(V=N.Ib(M,N),N.Jb!=null&&N.Jb(M,N,V),N.Dc+=V,1)}function gn(M){M.ma.memory=null}function Pn(M,N,V,Y){return ee(M,8)!=47?0:(N[0]=ee(M,14)+1,V[0]=ee(M,14)+1,Y[0]=ee(M,1),ee(M,3)!=0?0:!M.h)}function Bi(M,N){if(4>M)return M+1;var V=M-2>>1;return(2+(1&M)<<V)+ee(N,V)+1}function xi(M,N){return 120<N?N-120:1<=(V=((V=za[N-1])>>4)*M+(8-(15&V)))?V:1;var V}function $n(M,N,V){var Y=re(V),oe=M[N+=255&Y].g-8;return 0<oe&&(ie(V,V.u+8),Y=re(V),N+=M[N].value,N+=Y&(1<<oe)-1),ie(V,V.u+M[N].g),M[N].value}function ii(M,N,V){return V.g+=M.g,V.value+=M.value<<N>>>0,e(8>=V.g),M.g}function wi(M,N,V){var Y=M.xc;return e((N=Y==0?0:M.vc[M.md*(V>>Y)+(N>>Y)])<M.Wb),M.Ya[N]}function Rn(M,N,V,Y){var oe=M.ab,de=M.c*N,me=M.C;N=me+N;var Se=V,Ne=Y;for(Y=M.Ta,V=M.Ua;0<oe--;){var Le=M.gc[oe],Ke=me,mt=N,Ce=Se,it=Ne,st=(Ne=Y,Se=V,Le.Ea);switch(e(Ke<mt),e(mt<=Le.nc),Le.hc){case 2:jr(Ce,it,(mt-Ke)*st,Ne,Se);break;case 0:var Ut=Ke,pt=mt,Bt=Ne,Ft=Se,Kt=(Ln=Le).Ea;Ut==0&&(ec(Ce,it,null,null,1,Bt,Ft),je(Ce,it+1,0,0,Kt-1,Bt,Ft+1),it+=Kt,Ft+=Kt,++Ut);for(var Yt=1<<Ln.b,Dn=Yt-1,En=ot(Kt,Ln.b),Wn=Ln.K,Ln=Ln.w+(Ut>>Ln.b)*En;Ut<pt;){var Ci=Wn,pr=Ln,li=1;for(du(Ce,it,Bt,Ft-Kt,1,Bt,Ft);li<Kt;){var wn=(li&~Dn)+Yt;wn>Kt&&(wn=Kt),(0,Tl[Ci[pr++]>>8&15])(Ce,it+ +li,Bt,Ft+li-Kt,wn-li,Bt,Ft+li),li=wn}it+=Kt,Ft+=Kt,++Ut&Dn||(Ln+=En)}mt!=Le.nc&&n(Ne,Se-st,Ne,Se+(mt-Ke-1)*st,st);break;case 1:for(st=Ce,pt=it,Kt=(Ce=Le.Ea)-(Ft=Ce&~(Bt=(it=1<<Le.b)-1)),Ut=ot(Ce,Le.b),Yt=Le.K,Le=Le.w+(Ke>>Le.b)*Ut;Ke<mt;){for(Dn=Yt,En=Le,Wn=new xt,Ln=pt+Ft,Ci=pt+Ce;pt<Ln;)ft(Dn[En++],Wn),tc(Wn,st,pt,it,Ne,Se),pt+=it,Se+=it;pt<Ci&&(ft(Dn[En++],Wn),tc(Wn,st,pt,Kt,Ne,Se),pt+=Kt,Se+=Kt),++Ke&Bt||(Le+=Ut)}break;case 3:if(Ce==Ne&&it==Se&&0<Le.b){for(pt=Ne,Ce=st=Se+(mt-Ke)*st-(Ft=(mt-Ke)*ot(Le.Ea,Le.b)),it=Ne,Bt=Se,Ut=[],Ft=(Kt=Ft)-1;0<=Ft;--Ft)Ut[Ft]=it[Bt+Ft];for(Ft=Kt-1;0<=Ft;--Ft)pt[Ce+Ft]=Ut[Ft];Vf(Le,Ke,mt,Ne,st,Ne,Se)}else Vf(Le,Ke,mt,Ce,it,Ne,Se)}Se=Y,Ne=V}Ne!=V&&n(Y,V,Se,Ne,de)}function ir(M,N){var V=M.V,Y=M.Ba+M.c*M.C,oe=N-M.C;if(e(N<=M.l.o),e(16>=oe),0<oe){var de=M.l,me=M.Ta,Se=M.Ua,Ne=de.width;if(Rn(M,oe,V,Y),oe=Se=[Se],e((V=M.C)<(Y=N)),e(de.v<de.va),Y>de.o&&(Y=de.o),V<de.j){var Le=de.j-V;V=de.j,oe[0]+=Le*Ne}if(V>=Y?V=0:(oe[0]+=4*de.v,de.ka=V-de.j,de.U=de.va-de.v,de.T=Y-V,V=1),V){if(Se=Se[0],11>(V=M.ca).S){var Ke=V.f.RGBA,mt=(Y=V.S,oe=de.U,de=de.T,Le=Ke.eb,Ke.A),Ce=de;for(Ke=Ke.fb+M.Ma*Ke.A;0<Ce--;){var it=me,st=Se,Ut=oe,pt=Le,Bt=Ke;switch(Y){case ef:El(it,st,Ut,pt,Bt);break;case br:Zi(it,st,Ut,pt,Bt);break;case tf:Zi(it,st,Ut,pt,Bt),rc(pt,Bt,0,Ut,1,0);break;case Gf:Dc(it,st,Ut,pt,Bt);break;case sa:Pe(it,st,Ut,pt,Bt,1);break;case Oc:Pe(it,st,Ut,pt,Bt,1),rc(pt,Bt,0,Ut,1,0);break;case sc:Pe(it,st,Ut,pt,Bt,0);break;case pu:Pe(it,st,Ut,pt,Bt,0),rc(pt,Bt,1,Ut,1,0);break;case So:nc(it,st,Ut,pt,Bt);break;case mu:nc(it,st,Ut,pt,Bt),ro(pt,Bt,Ut,1,0);break;case ac:Cl(it,st,Ut,pt,Bt);break;default:e(0)}Se+=Ne,Ke+=mt}M.Ma+=de}else alert("todo:EmitRescaledRowsYUVA");e(M.Ma<=V.height)}}M.C=N,e(M.C<=M.i)}function Mi(M){var N;if(0<M.ua)return 0;for(N=0;N<M.Wb;++N){var V=M.Ya[N].G,Y=M.Ya[N].H;if(0<V[1][Y[1]+0].g||0<V[2][Y[2]+0].g||0<V[3][Y[3]+0].g)return 0}return 1}function te(M,N,V,Y,oe,de){if(M.Z!=0){var me=M.qd,Se=M.rd;for(e(cc[M.Z]!=null);N<V;++N)cc[M.Z](me,Se,Y,oe,Y,oe,de),me=Y,Se=oe,oe+=de;M.qd=me,M.rd=Se}}function be(M,N){var V=M.l.ma,Y=V.Z==0||V.Z==1?M.l.j:M.C;if(Y=M.C<Y?Y:M.C,e(N<=M.l.o),N>Y){var oe=M.l.width,de=V.ca,me=V.tb+oe*Y,Se=M.V,Ne=M.Ba+M.c*Y,Le=M.gc;e(M.ab==1),e(Le[0].hc==3),_o(Le[0],Y,N,Se,Ne,de,me),te(V,Y,N,de,me,oe)}M.C=M.Ma=N}function Ue(M,N,V,Y,oe,de,me){var Se=M.$/Y,Ne=M.$%Y,Le=M.m,Ke=M.s,mt=V+M.$,Ce=mt;oe=V+Y*oe;var it=V+Y*de,st=280+Ke.ua,Ut=M.Pb?Se:16777216,pt=0<Ke.ua?Ke.Wa:null,Bt=Ke.wc,Ft=mt<it?wi(Ke,Ne,Se):null;e(M.C<de),e(it<=oe);var Kt=!1;e:for(;;){for(;Kt||mt<it;){var Yt=0;if(Se>=Ut){var Dn=mt-V;e((Ut=M).Pb),Ut.wd=Ut.m,Ut.xd=Dn,0<Ut.s.ua&&Qe(Ut.s.Wa,Ut.s.vb),Ut=Se+lc}if(Ne&Bt||(Ft=wi(Ke,Ne,Se)),e(Ft!=null),Ft.Qb&&(N[mt]=Ft.qb,Kt=!0),!Kt)if(_e(Le),Ft.jc){Yt=Le,Dn=N;var En=mt,Wn=Ft.pd[re(Yt)&Ql-1];e(Ft.jc),256>Wn.g?(ie(Yt,Yt.u+Wn.g),Dn[En]=Wn.value,Yt=0):(ie(Yt,Yt.u+Wn.g-256),e(256<=Wn.value),Yt=Wn.value),Yt==0&&(Kt=!0)}else Yt=$n(Ft.G[0],Ft.H[0],Le);if(Le.h)break;if(Kt||256>Yt){if(!Kt)if(Ft.nd)N[mt]=(Ft.qb|Yt<<8)>>>0;else{if(_e(Le),Kt=$n(Ft.G[1],Ft.H[1],Le),_e(Le),Dn=$n(Ft.G[2],Ft.H[2],Le),En=$n(Ft.G[3],Ft.H[3],Le),Le.h)break;N[mt]=(En<<24|Kt<<16|Yt<<8|Dn)>>>0}if(Kt=!1,++mt,++Ne>=Y&&(Ne=0,++Se,me!=null&&Se<=de&&!(Se%16)&&me(M,Se),pt!=null))for(;Ce<mt;)Yt=N[Ce++],pt.X[(506832829*Yt&4294967295)>>>pt.Mb]=Yt}else if(280>Yt){if(Yt=Bi(Yt-256,Le),Dn=$n(Ft.G[4],Ft.H[4],Le),_e(Le),Dn=xi(Y,Dn=Bi(Dn,Le)),Le.h)break;if(mt-V<Dn||oe-mt<Yt)break e;for(En=0;En<Yt;++En)N[mt+En]=N[mt+En-Dn];for(mt+=Yt,Ne+=Yt;Ne>=Y;)Ne-=Y,++Se,me!=null&&Se<=de&&!(Se%16)&&me(M,Se);if(e(mt<=oe),Ne&Bt&&(Ft=wi(Ke,Ne,Se)),pt!=null)for(;Ce<mt;)Yt=N[Ce++],pt.X[(506832829*Yt&4294967295)>>>pt.Mb]=Yt}else{if(!(Yt<st))break e;for(Kt=Yt-280,e(pt!=null);Ce<mt;)Yt=N[Ce++],pt.X[(506832829*Yt&4294967295)>>>pt.Mb]=Yt;Yt=mt,e(!(Kt>>>(Dn=pt).Xa)),N[Yt]=Dn.X[Kt],Kt=!0}Kt||e(Le.h==Ae(Le))}if(M.Pb&&Le.h&&mt<oe)e(M.m.h),M.a=5,M.m=M.wd,M.$=M.xd,0<M.s.ua&&Qe(M.s.vb,M.s.Wa);else{if(Le.h)break e;me?.(M,Se>de?de:Se),M.a=0,M.$=mt-V}return 1}return M.a=3,0}function lt(M){e(M!=null),M.vc=null,M.yc=null,M.Ya=null;var N=M.Wa;N!=null&&(N.X=null),M.vb=null,e(M!=null)}function Tt(){var M=new Jn;return M==null?null:(M.a=0,M.xb=Ad,rt("Predictor","VP8LPredictors"),rt("Predictor","VP8LPredictors_C"),rt("PredictorAdd","VP8LPredictorsAdd"),rt("PredictorAdd","VP8LPredictorsAdd_C"),jr=Ye,tc=gt,El=un,Zi=bt,nc=dt,Cl=Ge,Dc=xe,L.VP8LMapColor32b=Yo,L.VP8LMapColor8b=Ls,M)}function St(M,N,V,Y,oe){var de=1,me=[M],Se=[N],Ne=Y.m,Le=Y.s,Ke=null,mt=0;e:for(;;){if(V)for(;de&&ee(Ne,1);){var Ce=me,it=Se,st=Y,Ut=1,pt=st.m,Bt=st.gc[st.ab],Ft=ee(pt,2);if(st.Oc&1<<Ft)de=0;else{switch(st.Oc|=1<<Ft,Bt.hc=Ft,Bt.Ea=Ce[0],Bt.nc=it[0],Bt.K=[null],++st.ab,e(4>=st.ab),Ft){case 0:case 1:Bt.b=ee(pt,3)+2,Ut=St(ot(Bt.Ea,Bt.b),ot(Bt.nc,Bt.b),0,st,Bt.K),Bt.K=Bt.K[0];break;case 3:var Kt,Yt=ee(pt,8)+1,Dn=16<Yt?0:4<Yt?1:2<Yt?2:3;if(Ce[0]=ot(Bt.Ea,Dn),Bt.b=Dn,Kt=Ut=St(Yt,1,0,st,Bt.K)){var En,Wn=Yt,Ln=Bt,Ci=1<<(8>>Ln.b),pr=s(Ci);if(pr==null)Kt=0;else{var li=Ln.K[0],wn=Ln.w;for(pr[0]=Ln.K[0][0],En=1;En<1*Wn;++En)pr[En]=Ct(li[wn+En],pr[En-1]);for(;En<4*Ci;++En)pr[En]=0;Ln.K[0]=null,Ln.K[0]=pr,Kt=1}}Ut=Kt;break;case 2:break;default:e(0)}de=Ut}}if(me=me[0],Se=Se[0],de&&ee(Ne,1)&&!(de=1<=(mt=ee(Ne,4))&&11>=mt)){Y.a=3;break e}var yn;if(yn=de)t:{var Gr,Xn,gi,Ki=Y,Cn=me,oa=Se,Sr=mt,ls=V,xs=Ki.m,ys=Ki.s,Ni=[null],Qi=1,qr=0,rr=Dr[Sr];n:for(;;){if(ls&&ee(xs,1)){var cs=ee(xs,3)+2,kr=ot(Cn,cs),Hi=ot(oa,cs),Qr=kr*Hi;if(!St(kr,Hi,0,Ki,Ni))break n;for(Ni=Ni[0],ys.xc=cs,Gr=0;Gr<Qr;++Gr){var lr=Ni[Gr]>>8&65535;Ni[Gr]=lr,lr>=Qi&&(Qi=lr+1)}}if(xs.h)break n;for(Xn=0;5>Xn;++Xn){var bs=oc[Xn];!Xn&&0<Sr&&(bs+=1<<Sr),qr<bs&&(qr=bs)}var wr=l(Qi*rr,W),Gi=Qi,ei=l(Gi,ce);if(ei==null)var Nr=null;else e(65536>=Gi),Nr=ei;var Ii=s(qr);if(Nr==null||Ii==null||wr==null){Ki.a=1;break n}var Vn=wr;for(Gr=gi=0;Gr<Qi;++Gr){var Gn=Nr[Gr],Kn=Gn.G,es=Gn.H,Mo=0,Na=1,_s=0;for(Xn=0;5>Xn;++Xn){bs=oc[Xn],Kn[Xn]=Vn,es[Xn]=gi,!Xn&&0<Sr&&(bs+=1<<Sr);r:{var zc,jc=bs,of=Ki,mr=Ii,Td=Vn,Th=gi,Eh=0,Ha=of.m,yu=ee(Ha,1);if(r(mr,0,0,jc),yu){var Ed=ee(Ha,1)+1,Cd=ee(Ha,1),Ch=ee(Ha,Cd==0?1:8);mr[Ch]=1,Ed==2&&(mr[Ch=ee(Ha,8)]=1);var ts=1}else{var ns=s(19),Yf=ee(Ha,4)+4;if(19<Yf){of.a=3;var Vc=0;break r}for(zc=0;zc<Yf;++zc)ns[rf[zc]]=ee(Ha,3);var Pl=void 0,bu=void 0,Il=of,Nh=ns,lf=jc,Rh=mr,Lh=0,dc=Il.m,Nd=8,Rd=l(128,W);i:for(;q(Rd,0,7,Nh,19);){if(ee(dc,1)){var Hp=2+2*ee(dc,3);if((Pl=2+ee(dc,Hp))>lf)break i}else Pl=lf;for(bu=0;bu<lf&&Pl--;){_e(dc);var Ld=Rd[0+(127&re(dc))];ie(dc,dc.u+Ld.g);var Hc=Ld.value;if(16>Hc)Rh[bu++]=Hc,Hc!=0&&(Nd=Hc);else{var Pd=Hc==16,Gp=Hc-16,qp=Bc[Gp],Id=ee(dc,ao[Gp])+qp;if(bu+Id>lf)break i;for(var Wp=Pd?Nd:0;0<Id--;)Rh[bu++]=Wp}}Lh=1;break i}Lh||(Il.a=3),ts=Lh}(ts=ts&&!Ha.h)&&(Eh=q(Td,Th,8,mr,jc)),ts&&Eh!=0?Vc=Eh:(of.a=3,Vc=0)}if(Vc==0)break n;if(Na&&nf[Xn]==1&&(Na=Vn[gi].g==0),Mo+=Vn[gi].g,gi+=Vc,3>=Xn){var _u,Ph=Ii[0];for(_u=1;_u<bs;++_u)Ii[_u]>Ph&&(Ph=Ii[_u]);_s+=Ph}}if(Gn.nd=Na,Gn.Qb=0,Na&&(Gn.qb=(Kn[3][es[3]+0].value<<24|Kn[1][es[1]+0].value<<16|Kn[2][es[2]+0].value)>>>0,Mo==0&&256>Kn[0][es[0]+0].value&&(Gn.Qb=1,Gn.qb+=Kn[0][es[0]+0].value<<8)),Gn.jc=!Gn.Qb&&6>_s,Gn.jc){var cf,Qo=Gn;for(cf=0;cf<Ql;++cf){var pc=cf,Dl=Qo.pd[pc],Zf=Qo.G[0][Qo.H[0]+pc];256<=Zf.value?(Dl.g=Zf.g+256,Dl.value=Zf.value):(Dl.g=0,Dl.value=0,pc>>=ii(Zf,8,Dl),pc>>=ii(Qo.G[1][Qo.H[1]+pc],16,Dl),pc>>=ii(Qo.G[2][Qo.H[2]+pc],0,Dl),ii(Qo.G[3][Qo.H[3]+pc],24,Dl))}}}ys.vc=Ni,ys.Wb=Qi,ys.Ya=Nr,ys.yc=wr,yn=1;break t}yn=0}if(!(de=yn)){Y.a=3;break e}if(0<mt){if(Le.ua=1<<mt,!le(Le.Wa,mt)){Y.a=1,de=0;break e}}else Le.ua=0;var $f=Y,mc=me,Ih=Se,uf=$f.s,ff=uf.xc;if($f.c=mc,$f.i=Ih,uf.md=ot(mc,ff),uf.wc=ff==0?-1:(1<<ff)-1,V){Y.xb=Ll;break e}if((Ke=s(me*Se))==null){Y.a=1,de=0;break e}de=(de=Ue(Y,Ke,0,me,Se,Se,null))&&!Ne.h;break e}return de?(oe!=null?oe[0]=Ke:(e(Ke==null),e(V)),Y.$=0,V||lt(Le)):lt(Le),de}function Xt(M,N){var V=M.c*M.i,Y=V+N+16*N;return e(M.c<=N),M.V=s(Y),M.V==null?(M.Ta=null,M.Ua=0,M.a=1,0):(M.Ta=M.V,M.Ua=M.Ba+V+N,1)}function qt(M,N){var V=M.C,Y=N-V,oe=M.V,de=M.Ba+M.c*V;for(e(N<=M.l.o);0<Y;){var me=16<Y?16:Y,Se=M.l.ma,Ne=M.l.width,Le=Ne*me,Ke=Se.ca,mt=Se.tb+Ne*V,Ce=M.Ta,it=M.Ua;Rn(M,me,oe,de),so(Ce,it,Ke,mt,Le),te(Se,V,V+me,Ke,mt,Ne),Y-=me,oe+=me*M.c,V+=me}e(V==N),M.C=M.Ma=N}function an(){this.ub=this.yd=this.td=this.Rb=0}function sn(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ln(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function rn(){this.Yb=(function(){var M=[];return(function N(V,Y,oe){for(var de=oe[Y],me=0;me<de&&(V.push(oe.length>Y+1?[]:0),!(oe.length<Y+1));me++)N(V[me],Y+1,oe)})(M,0,[3,11]),M})()}function fe(){this.jb=s(3),this.Wc=c([4,8],rn),this.Xc=c([4,17],rn)}function Oe(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function $e(){this.ld=this.La=this.dd=this.tc=0}function et(){this.Na=this.la=0}function Ze(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Vt(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function en(){this.uc=this.M=this.Nb=0,this.wa=Array(new $e),this.Y=0,this.ya=Array(new Vt),this.aa=0,this.l=new Tn}function Gt(){this.y=s(16),this.f=s(8),this.ea=s(8)}function vn(){this.cb=this.a=0,this.sc="",this.m=new F,this.Od=new an,this.Kc=new sn,this.ed=new Oe,this.Qa=new ln,this.Ic=this.$c=this.Aa=0,this.D=new en,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,F),this.ia=0,this.pb=l(4,Ze),this.Pa=new fe,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Gt),this.Hd=0,this.rb=Array(new et),this.sb=0,this.wa=Array(new $e),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Vt),this.L=this.aa=0,this.gd=c([4,2],$e),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function nn(M,N){return 0>M?0:M>N?N:M}function Tn(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function cn(){var M=new vn;return M!=null&&(M.a=0,M.sc="OK",M.cb=0,M.Xb=0,ja||(ja=ai)),M}function hn(M,N,V){return M.a==0&&(M.a=N,M.sc=V,M.cb=0),0}function si(M,N,V){return 3<=V&&M[N+0]==157&&M[N+1]==1&&M[N+2]==42}function pi(M,N){if(M==null)return 0;if(M.a=0,M.sc="OK",N==null)return hn(M,2,"null VP8Io passed to VP8GetHeaders()");var V=N.data,Y=N.w,oe=N.ha;if(4>oe)return hn(M,7,"Truncated header.");var de=V[Y+0]|V[Y+1]<<8|V[Y+2]<<16,me=M.Od;if(me.Rb=!(1&de),me.td=de>>1&7,me.yd=de>>4&1,me.ub=de>>5,3<me.td)return hn(M,3,"Incorrect keyframe parameters.");if(!me.yd)return hn(M,4,"Frame not displayable.");Y+=3,oe-=3;var Se=M.Kc;if(me.Rb){if(7>oe)return hn(M,7,"cannot parse picture header");if(!si(V,Y,oe))return hn(M,3,"Bad code word");Se.c=16383&(V[Y+4]<<8|V[Y+3]),Se.Td=V[Y+4]>>6,Se.i=16383&(V[Y+6]<<8|V[Y+5]),Se.Ud=V[Y+6]>>6,Y+=7,oe-=7,M.za=Se.c+15>>4,M.Ub=Se.i+15>>4,N.width=Se.c,N.height=Se.i,N.Da=0,N.j=0,N.v=0,N.va=N.width,N.o=N.height,N.da=0,N.ib=N.width,N.hb=N.height,N.U=N.width,N.T=N.height,r((de=M.Pa).jb,0,255,de.jb.length),e((de=M.Qa)!=null),de.Cb=0,de.Bb=0,de.Fb=1,r(de.Zb,0,0,de.Zb.length),r(de.Lb,0,0,de.Lb)}if(me.ub>oe)return hn(M,7,"bad partition length");K(de=M.m,V,Y,me.ub),Y+=me.ub,oe-=me.ub,me.Rb&&(Se.Ld=Fe(de),Se.Kd=Fe(de)),Se=M.Qa;var Ne,Le=M.Pa;if(e(de!=null),e(Se!=null),Se.Cb=Fe(de),Se.Cb){if(Se.Bb=Fe(de),Fe(de)){for(Se.Fb=Fe(de),Ne=0;4>Ne;++Ne)Se.Zb[Ne]=Fe(de)?pe(de,7):0;for(Ne=0;4>Ne;++Ne)Se.Lb[Ne]=Fe(de)?pe(de,6):0}if(Se.Bb)for(Ne=0;3>Ne;++Ne)Le.jb[Ne]=Fe(de)?ne(de,8):255}else Se.Bb=0;if(de.Ka)return hn(M,3,"cannot parse segment header");if((Se=M.ed).zd=Fe(de),Se.Tb=ne(de,6),Se.wb=ne(de,3),Se.Pc=Fe(de),Se.Pc&&Fe(de)){for(Le=0;4>Le;++Le)Fe(de)&&(Se.vd[Le]=pe(de,6));for(Le=0;4>Le;++Le)Fe(de)&&(Se.od[Le]=pe(de,6))}if(M.L=Se.Tb==0?0:Se.zd?1:2,de.Ka)return hn(M,3,"cannot parse filter header");var Ke=oe;if(oe=Ne=Y,Y=Ne+Ke,Se=Ke,M.Xb=(1<<ne(M.m,2))-1,Ke<3*(Le=M.Xb))V=7;else{for(Ne+=3*Le,Se-=3*Le,Ke=0;Ke<Le;++Ke){var mt=V[oe+0]|V[oe+1]<<8|V[oe+2]<<16;mt>Se&&(mt=Se),K(M.Jc[+Ke],V,Ne,mt),Ne+=mt,Se-=mt,oe+=3}K(M.Jc[+Le],V,Ne,Se),V=Ne<Y?0:5}if(V!=0)return hn(M,V,"cannot parse partitions");for(V=ne(Ne=M.m,7),oe=Fe(Ne)?pe(Ne,4):0,Y=Fe(Ne)?pe(Ne,4):0,Se=Fe(Ne)?pe(Ne,4):0,Le=Fe(Ne)?pe(Ne,4):0,Ne=Fe(Ne)?pe(Ne,4):0,Ke=M.Qa,mt=0;4>mt;++mt){if(Ke.Cb){var Ce=Ke.Zb[mt];Ke.Fb||(Ce+=V)}else{if(0<mt){M.pb[mt]=M.pb[0];continue}Ce=V}var it=M.pb[mt];it.Sc[0]=Cr[nn(Ce+oe,127)],it.Sc[1]=oo[nn(Ce+0,127)],it.Eb[0]=2*Cr[nn(Ce+Y,127)],it.Eb[1]=101581*oo[nn(Ce+Se,127)]>>16,8>it.Eb[1]&&(it.Eb[1]=8),it.Qc[0]=Cr[nn(Ce+Le,117)],it.Qc[1]=oo[nn(Ce+Ne,127)],it.lc=Ce+Ne}if(!me.Rb)return hn(M,4,"Not a key frame.");for(Fe(de),me=M.Pa,V=0;4>V;++V){for(oe=0;8>oe;++oe)for(Y=0;3>Y;++Y)for(Se=0;11>Se;++Se)Le=We(de,_r[V][oe][Y][Se])?ne(de,8):Mh[V][oe][Y][Se],me.Wc[V][oe].Yb[Y][Se]=Le;for(oe=0;17>oe;++oe)me.Xc[V][oe]=me.Wc[V][Fi[oe]]}return M.kc=Fe(de),M.kc&&(M.Bd=ne(de,8)),M.cb=1}function ai(M,N,V,Y,oe,de,me){var Se=N[oe].Yb[V];for(V=0;16>oe;++oe){if(!We(M,Se[V+0]))return oe;for(;!We(M,Se[V+1]);)if(Se=N[++oe].Yb[0],V=0,oe==16)return 16;var Ne=N[oe+1].Yb;if(We(M,Se[V+2])){var Le=M,Ke=0;if(We(Le,(Ce=Se)[(mt=V)+3]))if(We(Le,Ce[mt+6])){for(Se=0,mt=2*(Ke=We(Le,Ce[mt+8]))+(Ce=We(Le,Ce[mt+9+Ke])),Ke=0,Ce=zp[mt];Ce[Se];++Se)Ke+=Ke+We(Le,Ce[Se]);Ke+=3+(8<<mt)}else We(Le,Ce[mt+7])?(Ke=7+2*We(Le,165),Ke+=We(Le,145)):Ke=5+We(Le,159);else Ke=We(Le,Ce[mt+4])?3+We(Le,Ce[mt+5]):2;Se=Ne[2]}else Ke=1,Se=Ne[1];Ne=me+Rl[oe],0>(Le=M).b&&ke(Le);var mt,Ce=Le.b,it=(mt=Le.Ca>>1)-(Le.I>>Ce)>>31;--Le.b,Le.Ca+=it,Le.Ca|=1,Le.I-=(mt+1&it)<<Ce,de[Ne]=((Ke^it)-it)*Y[(0<oe)+0]}return 16}function Sn(M){var N=M.rb[M.sb-1];N.la=0,N.Na=0,r(M.zc,0,0,M.zc.length),M.ja=0}function Jt(M,N,V,Y,oe){oe=M[N+V+32*Y]+(oe>>3),M[N+V+32*Y]=-256&oe?0>oe?0:255:oe}function _n(M,N,V,Y,oe,de){Jt(M,N,0,V,Y+oe),Jt(M,N,1,V,Y+de),Jt(M,N,2,V,Y-de),Jt(M,N,3,V,Y-oe)}function mn(M){return(20091*M>>16)+M}function Ui(M,N,V,Y){var oe,de=0,me=s(16);for(oe=0;4>oe;++oe){var Se=M[N+0]+M[N+8],Ne=M[N+0]-M[N+8],Le=(35468*M[N+4]>>16)-mn(M[N+12]),Ke=mn(M[N+4])+(35468*M[N+12]>>16);me[de+0]=Se+Ke,me[de+1]=Ne+Le,me[de+2]=Ne-Le,me[de+3]=Se-Ke,de+=4,N++}for(oe=de=0;4>oe;++oe)Se=(M=me[de+0]+4)+me[de+8],Ne=M-me[de+8],Le=(35468*me[de+4]>>16)-mn(me[de+12]),Jt(V,Y,0,0,Se+(Ke=mn(me[de+4])+(35468*me[de+12]>>16))),Jt(V,Y,1,0,Ne+Le),Jt(V,Y,2,0,Ne-Le),Jt(V,Y,3,0,Se-Ke),de++,Y+=32}function ss(M,N,V,Y){var oe=M[N+0]+4,de=35468*M[N+4]>>16,me=mn(M[N+4]),Se=35468*M[N+1]>>16;_n(V,Y,0,oe+me,M=mn(M[N+1]),Se),_n(V,Y,1,oe+de,M,Se),_n(V,Y,2,oe-de,M,Se),_n(V,Y,3,oe-me,M,Se)}function mi(M,N,V,Y,oe){Ui(M,N,V,Y),oe&&Ui(M,N+16,V,Y+4)}function Yi(M,N,V,Y){ba(M,N+0,V,Y,1),ba(M,N+32,V,Y+128,1)}function Xi(M,N,V,Y){var oe;for(M=M[N+0]+4,oe=0;4>oe;++oe)for(N=0;4>N;++N)Jt(V,Y,N,oe,M)}function Zr(M,N,V,Y){M[N+0]&&Vi(M,N+0,V,Y),M[N+16]&&Vi(M,N+16,V,Y+4),M[N+32]&&Vi(M,N+32,V,Y+128),M[N+48]&&Vi(M,N+48,V,Y+128+4)}function Tr(M,N,V,Y){var oe,de=s(16);for(oe=0;4>oe;++oe){var me=M[N+0+oe]+M[N+12+oe],Se=M[N+4+oe]+M[N+8+oe],Ne=M[N+4+oe]-M[N+8+oe],Le=M[N+0+oe]-M[N+12+oe];de[0+oe]=me+Se,de[8+oe]=me-Se,de[4+oe]=Le+Ne,de[12+oe]=Le-Ne}for(oe=0;4>oe;++oe)me=(M=de[0+4*oe]+3)+de[3+4*oe],Se=de[1+4*oe]+de[2+4*oe],Ne=de[1+4*oe]-de[2+4*oe],Le=M-de[3+4*oe],V[Y+0]=me+Se>>3,V[Y+16]=Le+Ne>>3,V[Y+32]=me-Se>>3,V[Y+48]=Le-Ne>>3,Y+=64}function Pr(M,N,V){var Y,oe=N-32,de=Ir,me=255-M[oe-1];for(Y=0;Y<V;++Y){var Se,Ne=de,Le=me+M[N-1];for(Se=0;Se<V;++Se)M[N+Se]=Ne[Le+M[oe+Se]];N+=32}}function gs(M,N){Pr(M,N,4)}function Zl(M,N){Pr(M,N,8)}function Oa(M,N){Pr(M,N,16)}function Hu(M,N){var V;for(V=0;16>V;++V)n(M,N+32*V,M,N-32,16)}function Gu(M,N){var V;for(V=16;0<V;--V)r(M,N,M[N-1],16),N+=32}function Ea(M,N,V){var Y;for(Y=0;16>Y;++Y)r(N,V+32*Y,M,16)}function jo(M,N){var V,Y=16;for(V=0;16>V;++V)Y+=M[N-1+32*V]+M[N+V-32];Ea(Y>>5,M,N)}function pl(M,N){var V,Y=8;for(V=0;16>V;++V)Y+=M[N-1+32*V];Ea(Y>>4,M,N)}function Nc(M,N){var V,Y=8;for(V=0;16>V;++V)Y+=M[N+V-32];Ea(Y>>4,M,N)}function $l(M,N){Ea(128,M,N)}function qn(M,N,V){return M+2*N+V+2>>2}function Uf(M,N){var V,Y=N-32;for(Y=new Uint8Array([qn(M[Y-1],M[Y+0],M[Y+1]),qn(M[Y+0],M[Y+1],M[Y+2]),qn(M[Y+1],M[Y+2],M[Y+3]),qn(M[Y+2],M[Y+3],M[Y+4])]),V=0;4>V;++V)n(M,N+32*V,Y,0,Y.length)}function qu(M,N){var V=M[N-1],Y=M[N-1+32],oe=M[N-1+64],de=M[N-1+96];nt(M,N+0,16843009*qn(M[N-1-32],V,Y)),nt(M,N+32,16843009*qn(V,Y,oe)),nt(M,N+64,16843009*qn(Y,oe,de)),nt(M,N+96,16843009*qn(oe,de,de))}function Ff(M,N){var V,Y=4;for(V=0;4>V;++V)Y+=M[N+V-32]+M[N-1+32*V];for(Y>>=3,V=0;4>V;++V)r(M,N+32*V,Y,4)}function Ba(M,N){var V=M[N-1+0],Y=M[N-1+32],oe=M[N-1+64],de=M[N-1-32],me=M[N+0-32],Se=M[N+1-32],Ne=M[N+2-32],Le=M[N+3-32];M[N+0+96]=qn(Y,oe,M[N-1+96]),M[N+1+96]=M[N+0+64]=qn(V,Y,oe),M[N+2+96]=M[N+1+64]=M[N+0+32]=qn(de,V,Y),M[N+3+96]=M[N+2+64]=M[N+1+32]=M[N+0+0]=qn(me,de,V),M[N+3+64]=M[N+2+32]=M[N+1+0]=qn(Se,me,de),M[N+3+32]=M[N+2+0]=qn(Ne,Se,me),M[N+3+0]=qn(Le,Ne,Se)}function Vs(M,N){var V=M[N+1-32],Y=M[N+2-32],oe=M[N+3-32],de=M[N+4-32],me=M[N+5-32],Se=M[N+6-32],Ne=M[N+7-32];M[N+0+0]=qn(M[N+0-32],V,Y),M[N+1+0]=M[N+0+32]=qn(V,Y,oe),M[N+2+0]=M[N+1+32]=M[N+0+64]=qn(Y,oe,de),M[N+3+0]=M[N+2+32]=M[N+1+64]=M[N+0+96]=qn(oe,de,me),M[N+3+32]=M[N+2+64]=M[N+1+96]=qn(de,me,Se),M[N+3+64]=M[N+2+96]=qn(me,Se,Ne),M[N+3+96]=qn(Se,Ne,Ne)}function zf(M,N){var V=M[N-1+0],Y=M[N-1+32],oe=M[N-1+64],de=M[N-1-32],me=M[N+0-32],Se=M[N+1-32],Ne=M[N+2-32],Le=M[N+3-32];M[N+0+0]=M[N+1+64]=de+me+1>>1,M[N+1+0]=M[N+2+64]=me+Se+1>>1,M[N+2+0]=M[N+3+64]=Se+Ne+1>>1,M[N+3+0]=Ne+Le+1>>1,M[N+0+96]=qn(oe,Y,V),M[N+0+64]=qn(Y,V,de),M[N+0+32]=M[N+1+96]=qn(V,de,me),M[N+1+32]=M[N+2+96]=qn(de,me,Se),M[N+2+32]=M[N+3+96]=qn(me,Se,Ne),M[N+3+32]=qn(Se,Ne,Le)}function Rc(M,N){var V=M[N+0-32],Y=M[N+1-32],oe=M[N+2-32],de=M[N+3-32],me=M[N+4-32],Se=M[N+5-32],Ne=M[N+6-32],Le=M[N+7-32];M[N+0+0]=V+Y+1>>1,M[N+1+0]=M[N+0+64]=Y+oe+1>>1,M[N+2+0]=M[N+1+64]=oe+de+1>>1,M[N+3+0]=M[N+2+64]=de+me+1>>1,M[N+0+32]=qn(V,Y,oe),M[N+1+32]=M[N+0+96]=qn(Y,oe,de),M[N+2+32]=M[N+1+96]=qn(oe,de,me),M[N+3+32]=M[N+2+96]=qn(de,me,Se),M[N+3+64]=qn(me,Se,Ne),M[N+3+96]=qn(Se,Ne,Le)}function Hs(M,N){var V=M[N-1+0],Y=M[N-1+32],oe=M[N-1+64],de=M[N-1+96];M[N+0+0]=V+Y+1>>1,M[N+2+0]=M[N+0+32]=Y+oe+1>>1,M[N+2+32]=M[N+0+64]=oe+de+1>>1,M[N+1+0]=qn(V,Y,oe),M[N+3+0]=M[N+1+32]=qn(Y,oe,de),M[N+3+32]=M[N+1+64]=qn(oe,de,de),M[N+3+64]=M[N+2+64]=M[N+0+96]=M[N+1+96]=M[N+2+96]=M[N+3+96]=de}function Lc(M,N){var V=M[N-1+0],Y=M[N-1+32],oe=M[N-1+64],de=M[N-1+96],me=M[N-1-32],Se=M[N+0-32],Ne=M[N+1-32],Le=M[N+2-32];M[N+0+0]=M[N+2+32]=V+me+1>>1,M[N+0+32]=M[N+2+64]=Y+V+1>>1,M[N+0+64]=M[N+2+96]=oe+Y+1>>1,M[N+0+96]=de+oe+1>>1,M[N+3+0]=qn(Se,Ne,Le),M[N+2+0]=qn(me,Se,Ne),M[N+1+0]=M[N+3+32]=qn(V,me,Se),M[N+1+32]=M[N+3+64]=qn(Y,V,me),M[N+1+64]=M[N+3+96]=qn(oe,Y,V),M[N+1+96]=qn(de,oe,Y)}function Ja(M,N){var V;for(V=0;8>V;++V)n(M,N+32*V,M,N-32,8)}function cu(M,N){var V;for(V=0;8>V;++V)r(M,N,M[N-1],8),N+=32}function Ka(M,N,V){var Y;for(Y=0;8>Y;++Y)r(N,V+32*Y,M,8)}function Pc(M,N){var V,Y=8;for(V=0;8>V;++V)Y+=M[N+V-32]+M[N-1+32*V];Ka(Y>>4,M,N)}function Wu(M,N){var V,Y=4;for(V=0;8>V;++V)Y+=M[N+V-32];Ka(Y>>3,M,N)}function Ns(M,N){var V,Y=4;for(V=0;8>V;++V)Y+=M[N-1+32*V];Ka(Y>>3,M,N)}function Vo(M,N){Ka(128,M,N)}function Qa(M,N,V){var Y=M[N-V],oe=M[N+0],de=3*(oe-Y)+ra[1020+M[N-2*V]-M[N+V]],me=$o[112+(de+4>>3)];M[N-V]=Ir[255+Y+$o[112+(de+3>>3)]],M[N+0]=Ir[255+oe-me]}function ml(M,N,V,Y){var oe=M[N+0],de=M[N+V];return Ds[255+M[N-2*V]-M[N-V]]>Y||Ds[255+de-oe]>Y}function uu(M,N,V,Y){return 4*Ds[255+M[N-V]-M[N+0]]+Ds[255+M[N-2*V]-M[N+V]]<=Y}function Jl(M,N,V,Y,oe){var de=M[N-3*V],me=M[N-2*V],Se=M[N-V],Ne=M[N+0],Le=M[N+V],Ke=M[N+2*V],mt=M[N+3*V];return 4*Ds[255+Se-Ne]+Ds[255+me-Le]>Y?0:Ds[255+M[N-4*V]-de]<=oe&&Ds[255+de-me]<=oe&&Ds[255+me-Se]<=oe&&Ds[255+mt-Ke]<=oe&&Ds[255+Ke-Le]<=oe&&Ds[255+Le-Ne]<=oe}function gl(M,N,V,Y){var oe=2*Y+1;for(Y=0;16>Y;++Y)uu(M,N+Y,V,oe)&&Qa(M,N+Y,V)}function vl(M,N,V,Y){var oe=2*Y+1;for(Y=0;16>Y;++Y)uu(M,N+Y*V,1,oe)&&Qa(M,N+Y*V,1)}function Kl(M,N,V,Y){var oe;for(oe=3;0<oe;--oe)gl(M,N+=4*V,V,Y)}function Xu(M,N,V,Y){var oe;for(oe=3;0<oe;--oe)vl(M,N+=4,V,Y)}function xl(M,N,V,Y,oe,de,me,Se){for(de=2*de+1;0<oe--;){if(Jl(M,N,V,de,me))if(ml(M,N,V,Se))Qa(M,N,V);else{var Ne=M,Le=N,Ke=V,mt=Ne[Le-2*Ke],Ce=Ne[Le-Ke],it=Ne[Le+0],st=Ne[Le+Ke],Ut=Ne[Le+2*Ke],pt=27*(Ft=ra[1020+3*(it-Ce)+ra[1020+mt-st]])+63>>7,Bt=18*Ft+63>>7,Ft=9*Ft+63>>7;Ne[Le-3*Ke]=Ir[255+Ne[Le-3*Ke]+Ft],Ne[Le-2*Ke]=Ir[255+mt+Bt],Ne[Le-Ke]=Ir[255+Ce+pt],Ne[Le+0]=Ir[255+it-pt],Ne[Le+Ke]=Ir[255+st-Bt],Ne[Le+2*Ke]=Ir[255+Ut-Ft]}N+=Y}}function yl(M,N,V,Y,oe,de,me,Se){for(de=2*de+1;0<oe--;){if(Jl(M,N,V,de,me))if(ml(M,N,V,Se))Qa(M,N,V);else{var Ne=M,Le=N,Ke=V,mt=Ne[Le-Ke],Ce=Ne[Le+0],it=Ne[Le+Ke],st=$o[112+(4+(Ut=3*(Ce-mt))>>3)],Ut=$o[112+(Ut+3>>3)],pt=st+1>>1;Ne[Le-2*Ke]=Ir[255+Ne[Le-2*Ke]+pt],Ne[Le-Ke]=Ir[255+mt+Ut],Ne[Le+0]=Ir[255+Ce-st],Ne[Le+Ke]=Ir[255+it-pt]}N+=Y}}function Yu(M,N,V,Y,oe,de){xl(M,N,V,1,16,Y,oe,de)}function bl(M,N,V,Y,oe,de){xl(M,N,1,V,16,Y,oe,de)}function jf(M,N,V,Y,oe,de){var me;for(me=3;0<me;--me)yl(M,N+=4*V,V,1,16,Y,oe,de)}function B(M,N,V,Y,oe,de){var me;for(me=3;0<me;--me)yl(M,N+=4,1,V,16,Y,oe,de)}function ae(M,N,V,Y,oe,de,me,Se){xl(M,N,oe,1,8,de,me,Se),xl(V,Y,oe,1,8,de,me,Se)}function Ie(M,N,V,Y,oe,de,me,Se){xl(M,N,1,oe,8,de,me,Se),xl(V,Y,1,oe,8,de,me,Se)}function qe(M,N,V,Y,oe,de,me,Se){yl(M,N+4*oe,oe,1,8,de,me,Se),yl(V,Y+4*oe,oe,1,8,de,me,Se)}function at(M,N,V,Y,oe,de,me,Se){yl(M,N+4,1,oe,8,de,me,Se),yl(V,Y+4,1,oe,8,de,me,Se)}function jt(){this.ba=new Rt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ve,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function $t(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function In(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function On(){this.ua=0,this.Wa=new Et,this.vb=new Et,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ce,this.yc=new W}function Jn(){this.xb=this.a=0,this.l=new Tn,this.ca=new Rt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new $,this.Pb=0,this.wd=new $,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new On,this.ab=0,this.gc=l(4,In),this.Oc=0}function fi(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Tn,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Ai(M,N,V,Y,oe,de,me){for(M=M==null?0:M[N+0],N=0;N<me;++N)oe[de+N]=M+V[Y+N]&255,M=oe[de+N]}function yr(M,N,V,Y,oe,de,me){var Se;if(M==null)Ai(null,null,V,Y,oe,de,me);else for(Se=0;Se<me;++Se)oe[de+Se]=M[N+Se]+V[Y+Se]&255}function $r(M,N,V,Y,oe,de,me){if(M==null)Ai(null,null,V,Y,oe,de,me);else{var Se,Ne=M[N+0],Le=Ne,Ke=Ne;for(Se=0;Se<me;++Se)Le=Ke+(Ne=M[N+Se])-Le,Ke=V[Y+Se]+(-256&Le?0>Le?0:255:Le)&255,Le=Ne,oe[de+Se]=Ke}}function ur(M,N,V,Y){var oe=N.width,de=N.o;if(e(M!=null&&N!=null),0>V||0>=Y||V+Y>de)return null;if(!M.Cc){if(M.ga==null){var me;if(M.ga=new fi,(me=M.ga==null)||(me=N.width*N.o,e(M.Gb.length==0),M.Gb=s(me),M.Uc=0,M.Gb==null?me=0:(M.mb=M.Gb,M.nb=M.Uc,M.rc=null,me=1),me=!me),!me){me=M.ga;var Se=M.Fa,Ne=M.P,Le=M.qc,Ke=M.mb,mt=M.nb,Ce=Ne+1,it=Le-1,st=me.l;if(e(Se!=null&&Ke!=null&&N!=null),cc[0]=null,cc[1]=Ai,cc[2]=yr,cc[3]=$r,me.ca=Ke,me.tb=mt,me.c=N.width,me.i=N.height,e(0<me.c&&0<me.i),1>=Le)N=0;else if(me.$a=3&Se[Ne+0],me.Z=Se[Ne+0]>>2&3,me.Lc=Se[Ne+0]>>4&3,Ne=Se[Ne+0]>>6&3,0>me.$a||1<me.$a||4<=me.Z||1<me.Lc||Ne)N=0;else if(st.put=tn,st.ac=dn,st.bc=gn,st.ma=me,st.width=N.width,st.height=N.height,st.Da=N.Da,st.v=N.v,st.va=N.va,st.j=N.j,st.o=N.o,me.$a)e:{e(me.$a==1),N=Tt();t:for(;;){if(N==null){N=0;break e}if(e(me!=null),me.mc=N,N.c=me.c,N.i=me.i,N.l=me.l,N.l.ma=me,N.l.width=me.c,N.l.height=me.i,N.a=0,Re(N.m,Se,Ce,it),!St(me.c,me.i,1,N,null)||(N.ab==1&&N.gc[0].hc==3&&Mi(N.s)?(me.ic=1,Se=N.c*N.i,N.Ta=null,N.Ua=0,N.V=s(Se),N.Ba=0,N.V==null?(N.a=1,N=0):N=1):(me.ic=0,N=Xt(N,me.c)),!N))break t;N=1;break e}me.mc=null,N=0}else N=it>=me.c*me.i;me=!N}if(me)return null;M.ga.Lc!=1?M.Ga=0:Y=de-V}e(M.ga!=null),e(V+Y<=de);e:{if(N=(Se=M.ga).c,de=Se.l.o,Se.$a==0){if(Ce=M.rc,it=M.Vc,st=M.Fa,Ne=M.P+1+V*N,Le=M.mb,Ke=M.nb+V*N,e(Ne<=M.P+M.qc),Se.Z!=0)for(e(cc[Se.Z]!=null),me=0;me<Y;++me)cc[Se.Z](Ce,it,st,Ne,Le,Ke,N),Ce=Le,it=Ke,Ke+=N,Ne+=N;else for(me=0;me<Y;++me)n(Le,Ke,st,Ne,N),Ce=Le,it=Ke,Ke+=N,Ne+=N;M.rc=Ce,M.Vc=it}else{if(e(Se.mc!=null),N=V+Y,e((me=Se.mc)!=null),e(N<=me.i),me.C>=N)N=1;else if(Se.ic||yo(),Se.ic){Se=me.V,Ce=me.Ba,it=me.c;var Ut=me.i,pt=(st=1,Ne=me.$/it,Le=me.$%it,Ke=me.m,mt=me.s,me.$),Bt=it*Ut,Ft=it*N,Kt=mt.wc,Yt=pt<Ft?wi(mt,Le,Ne):null;e(pt<=Bt),e(N<=Ut),e(Mi(mt));t:for(;;){for(;!Ke.h&&pt<Ft;){if(Le&Kt||(Yt=wi(mt,Le,Ne)),e(Yt!=null),_e(Ke),256>(Ut=$n(Yt.G[0],Yt.H[0],Ke)))Se[Ce+pt]=Ut,++pt,++Le>=it&&(Le=0,++Ne<=N&&!(Ne%16)&&be(me,Ne));else{if(!(280>Ut)){st=0;break t}Ut=Bi(Ut-256,Ke);var Dn,En=$n(Yt.G[4],Yt.H[4],Ke);if(_e(Ke),!(pt>=(En=xi(it,En=Bi(En,Ke)))&&Bt-pt>=Ut)){st=0;break t}for(Dn=0;Dn<Ut;++Dn)Se[Ce+pt+Dn]=Se[Ce+pt+Dn-En];for(pt+=Ut,Le+=Ut;Le>=it;)Le-=it,++Ne<=N&&!(Ne%16)&&be(me,Ne);pt<Ft&&Le&Kt&&(Yt=wi(mt,Le,Ne))}e(Ke.h==Ae(Ke))}be(me,Ne>N?N:Ne);break t}!st||Ke.h&&pt<Bt?(st=0,me.a=Ke.h?5:3):me.$=pt,N=st}else N=Ue(me,me.V,me.Ba,me.c,me.i,N,qt);if(!N){Y=0;break e}}V+Y>=de&&(M.Cc=1),Y=1}if(!Y)return null;if(M.Cc&&((Y=M.ga)!=null&&(Y.mc=null),M.ga=null,0<M.Ga))return alert("todo:WebPDequantizeLevels"),null}return M.nb+V*oe}function vs(M,N,V,Y,oe,de){for(;0<oe--;){var me,Se=M,Ne=N+(V?1:0),Le=M,Ke=N+(V?0:3);for(me=0;me<Y;++me){var mt=Le[Ke+4*me];mt!=255&&(mt*=32897,Se[Ne+4*me+0]=Se[Ne+4*me+0]*mt>>23,Se[Ne+4*me+1]=Se[Ne+4*me+1]*mt>>23,Se[Ne+4*me+2]=Se[Ne+4*me+2]*mt>>23)}N+=de}}function as(M,N,V,Y,oe){for(;0<Y--;){var de;for(de=0;de<V;++de){var me=M[N+2*de+0],Se=15&(Le=M[N+2*de+1]),Ne=4369*Se,Le=(240&Le|Le>>4)*Ne>>16;M[N+2*de+0]=(240&me|me>>4)*Ne>>16&240|(15&me|me<<4)*Ne>>16>>4&15,M[N+2*de+1]=240&Le|Se}N+=oe}}function ea(M,N,V,Y,oe,de,me,Se){var Ne,Le,Ke=255;for(Le=0;Le<oe;++Le){for(Ne=0;Ne<Y;++Ne){var mt=M[N+Ne];de[me+4*Ne]=mt,Ke&=mt}N+=V,me+=Se}return Ke!=255}function Er(M,N,V,Y,oe){var de;for(de=0;de<oe;++de)V[Y+de]=M[N+de]>>8}function yo(){rc=vs,ro=as,Ku=ea,so=Er}function _l(M,N,V){L[M]=function(Y,oe,de,me,Se,Ne,Le,Ke,mt,Ce,it,st,Ut,pt,Bt,Ft,Kt){var Yt,Dn=Kt-1>>1,En=Se[Ne+0]|Le[Ke+0]<<16,Wn=mt[Ce+0]|it[st+0]<<16;e(Y!=null);var Ln=3*En+Wn+131074>>2;for(N(Y[oe+0],255&Ln,Ln>>16,Ut,pt),de!=null&&(Ln=3*Wn+En+131074>>2,N(de[me+0],255&Ln,Ln>>16,Bt,Ft)),Yt=1;Yt<=Dn;++Yt){var Ci=Se[Ne+Yt]|Le[Ke+Yt]<<16,pr=mt[Ce+Yt]|it[st+Yt]<<16,li=En+Ci+Wn+pr+524296,wn=li+2*(Ci+Wn)>>3;Ln=wn+En>>1,En=(li=li+2*(En+pr)>>3)+Ci>>1,N(Y[oe+2*Yt-1],255&Ln,Ln>>16,Ut,pt+(2*Yt-1)*V),N(Y[oe+2*Yt-0],255&En,En>>16,Ut,pt+(2*Yt-0)*V),de!=null&&(Ln=li+Wn>>1,En=wn+pr>>1,N(de[me+2*Yt-1],255&Ln,Ln>>16,Bt,Ft+(2*Yt-1)*V),N(de[me+2*Yt+0],255&En,En>>16,Bt,Ft+(2*Yt+0)*V)),En=Ci,Wn=pr}1&Kt||(Ln=3*En+Wn+131074>>2,N(Y[oe+Kt-1],255&Ln,Ln>>16,Ut,pt+(Kt-1)*V),de!=null&&(Ln=3*Wn+En+131074>>2,N(de[me+Kt-1],255&Ln,Ln>>16,Bt,Ft+(Kt-1)*V)))}}function Zu(){aa[ef]=Uc,aa[br]=Jo,aa[Gf]=Ah,aa[sa]=gu,aa[sc]=uc,aa[So]=Ko,aa[ac]=fc,aa[tf]=Jo,aa[Oc]=gu,aa[pu]=uc,aa[mu]=Ko}function fu(M){return M&-16384?0>M?0:255:M>>Wf}function Ua(M,N){return fu((19077*M>>8)+(26149*N>>8)-14234)}function bo(M,N,V){return fu((19077*M>>8)-(6419*N>>8)-(13320*V>>8)+8708)}function Sl(M,N){return fu((19077*M>>8)+(33050*N>>8)-17685)}function wl(M,N,V,Y,oe){Y[oe+0]=Ua(M,V),Y[oe+1]=bo(M,N,V),Y[oe+2]=Sl(M,N)}function Gs(M,N,V,Y,oe){Y[oe+0]=Sl(M,N),Y[oe+1]=bo(M,N,V),Y[oe+2]=Ua(M,V)}function Ho(M,N,V,Y,oe){var de=bo(M,N,V);N=de<<3&224|Sl(M,N)>>3,Y[oe+0]=248&Ua(M,V)|de>>5,Y[oe+1]=N}function Ml(M,N,V,Y,oe){var de=240&Sl(M,N)|15;Y[oe+0]=240&Ua(M,V)|bo(M,N,V)>>4,Y[oe+1]=de}function hu(M,N,V,Y,oe){Y[oe+0]=255,wl(M,N,V,Y,oe+1)}function Go(M,N,V,Y,oe){Gs(M,N,V,Y,oe),Y[oe+3]=255}function ya(M,N,V,Y,oe){wl(M,N,V,Y,oe),Y[oe+3]=255}function qo(M,N,V){L[M]=function(Y,oe,de,me,Se,Ne,Le,Ke,mt){for(var Ce=Ke+(-2&mt)*V;Ke!=Ce;)N(Y[oe+0],de[me+0],Se[Ne+0],Le,Ke),N(Y[oe+1],de[me+0],Se[Ne+0],Le,Ke+V),oe+=2,++me,++Ne,Ke+=2*V;1&mt&&N(Y[oe+0],de[me+0],Se[Ne+0],Le,Ke)}}function Ic(M,N,V){return V==0?M==0?N==0?6:5:N==0?4:0:V}function $u(M,N,V,Y,oe){switch(M>>>30){case 3:ba(N,V,Y,oe,0);break;case 2:ia(N,V,Y,oe);break;case 1:Vi(N,V,Y,oe)}}function Ca(M,N){var V,Y,oe=N.M,de=N.Nb,me=M.oc,Se=M.pc+40,Ne=M.oc,Le=M.pc+584,Ke=M.oc,mt=M.pc+600;for(V=0;16>V;++V)me[Se+32*V-1]=129;for(V=0;8>V;++V)Ne[Le+32*V-1]=129,Ke[mt+32*V-1]=129;for(0<oe?me[Se-1-32]=Ne[Le-1-32]=Ke[mt-1-32]=129:(r(me,Se-32-1,127,21),r(Ne,Le-32-1,127,9),r(Ke,mt-32-1,127,9)),Y=0;Y<M.za;++Y){var Ce=N.ya[N.aa+Y];if(0<Y){for(V=-1;16>V;++V)n(me,Se+32*V-4,me,Se+32*V+12,4);for(V=-1;8>V;++V)n(Ne,Le+32*V-4,Ne,Le+32*V+4,4),n(Ke,mt+32*V-4,Ke,mt+32*V+4,4)}var it=M.Gd,st=M.Hd+Y,Ut=Ce.ad,pt=Ce.Hc;if(0<oe&&(n(me,Se-32,it[st].y,0,16),n(Ne,Le-32,it[st].f,0,8),n(Ke,mt-32,it[st].ea,0,8)),Ce.Za){var Bt=me,Ft=Se-32+16;for(0<oe&&(Y>=M.za-1?r(Bt,Ft,it[st].y[15],4):n(Bt,Ft,it[st+1].y,0,4)),V=0;4>V;V++)Bt[Ft+128+V]=Bt[Ft+256+V]=Bt[Ft+384+V]=Bt[Ft+0+V];for(V=0;16>V;++V,pt<<=2)Bt=me,Ft=Se+os[V],Hr[Ce.Ob[V]](Bt,Ft),$u(pt,Ut,16*+V,Bt,Ft)}else if(Bt=Ic(Y,oe,Ce.Ob[0]),_a[Bt](me,Se),pt!=0)for(V=0;16>V;++V,pt<<=2)$u(pt,Ut,16*+V,me,Se+os[V]);for(V=Ce.Gc,Bt=Ic(Y,oe,Ce.Dd),Va[Bt](Ne,Le),Va[Bt](Ke,mt),pt=Ut,Bt=Ne,Ft=Le,255&(Ce=0|V)&&(170&Ce?to(pt,256,Bt,Ft):di(pt,256,Bt,Ft)),Ce=Ke,pt=mt,255&(V>>=8)&&(170&V?to(Ut,320,Ce,pt):di(Ut,320,Ce,pt)),oe<M.Ub-1&&(n(it[st].y,0,me,Se+480,16),n(it[st].f,0,Ne,Le+224,8),n(it[st].ea,0,Ke,mt+224,8)),V=8*de*M.B,it=M.sa,st=M.ta+16*Y+16*de*M.R,Ut=M.qa,Ce=M.ra+8*Y+V,pt=M.Ha,Bt=M.Ia+8*Y+V,V=0;16>V;++V)n(it,st+V*M.R,me,Se+32*V,16);for(V=0;8>V;++V)n(Ut,Ce+V*M.B,Ne,Le+32*V,8),n(pt,Bt+V*M.B,Ke,mt+32*V,8)}}function Fa(M,N,V,Y,oe,de,me,Se,Ne){var Le=[0],Ke=[0],mt=0,Ce=Ne!=null?Ne.kd:0,it=Ne??new $t;if(M==null||12>V)return 7;it.data=M,it.w=N,it.ha=V,N=[N],V=[V],it.gb=[it.gb];e:{var st=N,Ut=V,pt=it.gb;if(e(M!=null),e(Ut!=null),e(pt!=null),pt[0]=0,12<=Ut[0]&&!t(M,st[0],"RIFF")){if(t(M,st[0]+8,"WEBP")){pt=3;break e}var Bt=Je(M,st[0]+4);if(12>Bt||4294967286<Bt){pt=3;break e}if(Ce&&Bt>Ut[0]-8){pt=7;break e}pt[0]=Bt,st[0]+=12,Ut[0]-=12}pt=0}if(pt!=0)return pt;for(Bt=0<it.gb[0],V=V[0];;){e:{var Ft=M;Ut=N,pt=V;var Kt=Le,Yt=Ke,Dn=st=[0];if((Ln=mt=[mt])[0]=0,8>pt[0])pt=7;else{if(!t(Ft,Ut[0],"VP8X")){if(Je(Ft,Ut[0]+4)!=10){pt=3;break e}if(18>pt[0]){pt=7;break e}var En=Je(Ft,Ut[0]+8),Wn=1+wt(Ft,Ut[0]+12);if(2147483648<=Wn*(Ft=1+wt(Ft,Ut[0]+15))){pt=3;break e}Dn!=null&&(Dn[0]=En),Kt!=null&&(Kt[0]=Wn),Yt!=null&&(Yt[0]=Ft),Ut[0]+=18,pt[0]-=18,Ln[0]=1}pt=0}}if(mt=mt[0],st=st[0],pt!=0)return pt;if(Ut=!!(2&st),!Bt&&mt)return 3;if(de!=null&&(de[0]=!!(16&st)),me!=null&&(me[0]=Ut),Se!=null&&(Se[0]=0),me=Le[0],st=Ke[0],mt&&Ut&&Ne==null){pt=0;break}if(4>V){pt=7;break}if(Bt&&mt||!Bt&&!mt&&!t(M,N[0],"ALPH")){V=[V],it.na=[it.na],it.P=[it.P],it.Sa=[it.Sa];e:{En=M,pt=N,Bt=V;var Ln=it.gb;Kt=it.na,Yt=it.P,Dn=it.Sa,Wn=22,e(En!=null),e(Bt!=null),Ft=pt[0];var Ci=Bt[0];for(e(Kt!=null),e(Dn!=null),Kt[0]=null,Yt[0]=null,Dn[0]=0;;){if(pt[0]=Ft,Bt[0]=Ci,8>Ci){pt=7;break e}var pr=Je(En,Ft+4);if(4294967286<pr){pt=3;break e}var li=8+pr+1&-2;if(Wn+=li,0<Ln&&Wn>Ln){pt=3;break e}if(!t(En,Ft,"VP8 ")||!t(En,Ft,"VP8L")){pt=0;break e}if(Ci[0]<li){pt=7;break e}t(En,Ft,"ALPH")||(Kt[0]=En,Yt[0]=Ft+8,Dn[0]=pr),Ft+=li,Ci-=li}}if(V=V[0],it.na=it.na[0],it.P=it.P[0],it.Sa=it.Sa[0],pt!=0)break}V=[V],it.Ja=[it.Ja],it.xa=[it.xa];e:if(Ln=M,pt=N,Bt=V,Kt=it.gb[0],Yt=it.Ja,Dn=it.xa,En=pt[0],Ft=!t(Ln,En,"VP8 "),Wn=!t(Ln,En,"VP8L"),e(Ln!=null),e(Bt!=null),e(Yt!=null),e(Dn!=null),8>Bt[0])pt=7;else{if(Ft||Wn){if(Ln=Je(Ln,En+4),12<=Kt&&Ln>Kt-12){pt=3;break e}if(Ce&&Ln>Bt[0]-8){pt=7;break e}Yt[0]=Ln,pt[0]+=8,Bt[0]-=8,Dn[0]=Wn}else Dn[0]=5<=Bt[0]&&Ln[En+0]==47&&!(Ln[En+4]>>5),Yt[0]=Bt[0];pt=0}if(V=V[0],it.Ja=it.Ja[0],it.xa=it.xa[0],N=N[0],pt!=0)break;if(4294967286<it.Ja)return 3;if(Se==null||Ut||(Se[0]=it.xa?2:1),me=[me],st=[st],it.xa){if(5>V){pt=7;break}Se=me,Ce=st,Ut=de,M==null||5>V?M=0:5<=V&&M[N+0]==47&&!(M[N+4]>>5)?(Bt=[0],Ln=[0],Kt=[0],Re(Yt=new $,M,N,V),Pn(Yt,Bt,Ln,Kt)?(Se!=null&&(Se[0]=Bt[0]),Ce!=null&&(Ce[0]=Ln[0]),Ut!=null&&(Ut[0]=Kt[0]),M=1):M=0):M=0}else{if(10>V){pt=7;break}Se=st,M==null||10>V||!si(M,N+3,V-3)?M=0:(Ce=M[N+0]|M[N+1]<<8|M[N+2]<<16,Ut=16383&(M[N+7]<<8|M[N+6]),M=16383&(M[N+9]<<8|M[N+8]),1&Ce||3<(Ce>>1&7)||!(Ce>>4&1)||Ce>>5>=it.Ja||!Ut||!M?M=0:(me&&(me[0]=Ut),Se&&(Se[0]=M),M=1))}if(!M||(me=me[0],st=st[0],mt&&(Le[0]!=me||Ke[0]!=st)))return 3;Ne!=null&&(Ne[0]=it,Ne.offset=N-Ne.w,e(4294967286>N-Ne.w),e(Ne.offset==Ne.ha-V));break}return pt==0||pt==7&&mt&&Ne==null?(de!=null&&(de[0]|=it.na!=null&&0<it.na.length),Y!=null&&(Y[0]=me),oe!=null&&(oe[0]=st),0):pt}function Wo(M,N,V){var Y=N.width,oe=N.height,de=0,me=0,Se=Y,Ne=oe;if(N.Da=M!=null&&0<M.Da,N.Da&&(Se=M.cd,Ne=M.bd,de=M.v,me=M.j,11>V||(de&=-2,me&=-2),0>de||0>me||0>=Se||0>=Ne||de+Se>Y||me+Ne>oe))return 0;if(N.v=de,N.j=me,N.va=de+Se,N.o=me+Ne,N.U=Se,N.T=Ne,N.da=M!=null&&0<M.da,N.da){if(!we(Se,Ne,V=[M.ib],de=[M.hb]))return 0;N.ib=V[0],N.hb=de[0]}return N.ob=M!=null&&M.ob,N.Kb=M==null||!M.Sd,N.da&&(N.ob=N.ib<3*Y/4&&N.hb<3*oe/4,N.Kb=0),1}function Ju(M){if(M==null)return 2;if(11>M.S){var N=M.f.RGBA;N.fb+=(M.height-1)*N.A,N.A=-N.A}else N=M.f.kb,M=M.height,N.O+=(M-1)*N.fa,N.fa=-N.fa,N.N+=(M-1>>1)*N.Ab,N.Ab=-N.Ab,N.W+=(M-1>>1)*N.Db,N.Db=-N.Db,N.F!=null&&(N.J+=(M-1)*N.lb,N.lb=-N.lb);return 0}function eo(M,N,V,Y){if(Y==null||0>=M||0>=N)return 2;if(V!=null){if(V.Da){var oe=V.cd,de=V.bd,me=-2&V.v,Se=-2&V.j;if(0>me||0>Se||0>=oe||0>=de||me+oe>M||Se+de>N)return 2;M=oe,N=de}if(V.da){if(!we(M,N,oe=[V.ib],de=[V.hb]))return 2;M=oe[0],N=de[0]}}Y.width=M,Y.height=N;e:{var Ne=Y.width,Le=Y.height;if(M=Y.S,0>=Ne||0>=Le||!(M>=ef&&13>M))M=2;else{if(0>=Y.Rd&&Y.sd==null){me=de=oe=N=0;var Ke=(Se=Ne*Xf[M])*Le;if(11>M||(de=(Le+1)/2*(N=(Ne+1)/2),M==12&&(me=(oe=Ne)*Le)),(Le=s(Ke+2*de+me))==null){M=1;break e}Y.sd=Le,11>M?((Ne=Y.f.RGBA).eb=Le,Ne.fb=0,Ne.A=Se,Ne.size=Ke):((Ne=Y.f.kb).y=Le,Ne.O=0,Ne.fa=Se,Ne.Fd=Ke,Ne.f=Le,Ne.N=0+Ke,Ne.Ab=N,Ne.Cd=de,Ne.ea=Le,Ne.W=0+Ke+de,Ne.Db=N,Ne.Ed=de,M==12&&(Ne.F=Le,Ne.J=0+Ke+2*de),Ne.Tc=me,Ne.lb=oe)}if(N=1,oe=Y.S,de=Y.width,me=Y.height,oe>=ef&&13>oe)if(11>oe)M=Y.f.RGBA,N&=(Se=Math.abs(M.A))*(me-1)+de<=M.size,N&=Se>=de*Xf[oe],N&=M.eb!=null;else{M=Y.f.kb,Se=(de+1)/2,Ke=(me+1)/2,Ne=Math.abs(M.fa),Le=Math.abs(M.Ab);var mt=Math.abs(M.Db),Ce=Math.abs(M.lb),it=Ce*(me-1)+de;N&=Ne*(me-1)+de<=M.Fd,N&=Le*(Ke-1)+Se<=M.Cd,N=(N&=mt*(Ke-1)+Se<=M.Ed)&Ne>=de&Le>=Se&mt>=Se,N&=M.y!=null,N&=M.f!=null,N&=M.ea!=null,oe==12&&(N&=Ce>=de,N&=it<=M.Tc,N&=M.F!=null)}else N=0;M=N?0:2}}return M!=0||V!=null&&V.fd&&(M=Ju(Y)),M}var Ql=64,Jr=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ta=24,Al=32,Xo=8,Rs=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ht("Predictor0","PredictorAdd0"),L.Predictor0=function(){return 4278190080},L.Predictor1=function(M){return M},L.Predictor2=function(M,N,V){return N[V+0]},L.Predictor3=function(M,N,V){return N[V+1]},L.Predictor4=function(M,N,V){return N[V-1]},L.Predictor5=function(M,N,V){return he(he(M,N[V+1]),N[V+0])},L.Predictor6=function(M,N,V){return he(M,N[V-1])},L.Predictor7=function(M,N,V){return he(M,N[V+0])},L.Predictor8=function(M,N,V){return he(N[V-1],N[V+0])},L.Predictor9=function(M,N,V){return he(N[V+0],N[V+1])},L.Predictor10=function(M,N,V){return he(he(M,N[V-1]),he(N[V+0],N[V+1]))},L.Predictor11=function(M,N,V){var Y=N[V+0];return 0>=ue(Y>>24&255,M>>24&255,(N=N[V-1])>>24&255)+ue(Y>>16&255,M>>16&255,N>>16&255)+ue(Y>>8&255,M>>8&255,N>>8&255)+ue(255&Y,255&M,255&N)?Y:M},L.Predictor12=function(M,N,V){var Y=N[V+0];return(Q((M>>24&255)+(Y>>24&255)-((N=N[V-1])>>24&255))<<24|Q((M>>16&255)+(Y>>16&255)-(N>>16&255))<<16|Q((M>>8&255)+(Y>>8&255)-(N>>8&255))<<8|Q((255&M)+(255&Y)-(255&N)))>>>0},L.Predictor13=function(M,N,V){var Y=N[V-1];return(Be((M=he(M,N[V+0]))>>24&255,Y>>24&255)<<24|Be(M>>16&255,Y>>16&255)<<16|Be(M>>8&255,Y>>8&255)<<8|Be(255&M,255&Y))>>>0};var ec=L.PredictorAdd0;L.PredictorAdd1=je,ht("Predictor2","PredictorAdd2"),ht("Predictor3","PredictorAdd3"),ht("Predictor4","PredictorAdd4"),ht("Predictor5","PredictorAdd5"),ht("Predictor6","PredictorAdd6"),ht("Predictor7","PredictorAdd7"),ht("Predictor8","PredictorAdd8"),ht("Predictor9","PredictorAdd9"),ht("Predictor10","PredictorAdd10"),ht("Predictor11","PredictorAdd11"),ht("Predictor12","PredictorAdd12"),ht("Predictor13","PredictorAdd13");var du=L.PredictorAdd2;Lt("ColorIndexInverseTransform","MapARGB","32b",function(M){return M>>8&255},function(M){return M}),Lt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(M){return M},function(M){return M>>8&255});var jr,Vf=L.ColorIndexInverseTransform,Yo=L.MapARGB,_o=L.VP8LColorIndexInverseTransformAlpha,Ls=L.MapAlpha,Tl=L.VP8LPredictorsAdd=[];Tl.length=16,(L.VP8LPredictors=[]).length=16,(L.VP8LPredictorsAdd_C=[]).length=16,(L.VP8LPredictors_C=[]).length=16;var tc,El,Zi,nc,Cl,Dc,na,ba,ia,to,Vi,di,dr,Vr,Zo,no,ic,kc,Sh,wd,Fp,Md,wh,io,rc,ro,Ku,so,Nl=s(511),Ps=s(2041),Qu=s(225),Is=s(767),Hf=0,ra=Ps,$o=Qu,Ir=Is,Ds=Nl,ef=0,br=1,Gf=2,sa=3,sc=4,So=5,ac=6,tf=7,Oc=8,pu=9,mu=10,ao=[2,3,7],Bc=[3,3,11],oc=[280,256,256,256,40],nf=[0,1,1,1,0],rf=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],za=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Dr=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],lc=8,Cr=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],oo=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ja=null,zp=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Rl=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],qf=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Mh=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Kr=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],_r=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Fi=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],_a=[],Hr=[],Va=[],Ll=1,Ad=2,cc=[],aa=[];_l("UpsampleRgbLinePair",wl,3),_l("UpsampleBgrLinePair",Gs,3),_l("UpsampleRgbaLinePair",ya,4),_l("UpsampleBgraLinePair",Go,4),_l("UpsampleArgbLinePair",hu,4),_l("UpsampleRgba4444LinePair",Ml,2),_l("UpsampleRgb565LinePair",Ho,2);var Uc=L.UpsampleRgbLinePair,Ah=L.UpsampleBgrLinePair,Jo=L.UpsampleRgbaLinePair,gu=L.UpsampleBgraLinePair,uc=L.UpsampleArgbLinePair,Ko=L.UpsampleRgba4444LinePair,fc=L.UpsampleRgb565LinePair,lo=16,vu=1<<lo-1,Fc=-227,wo=482,Wf=6,hc=0,Qn=s(256),sf=s(256),jp=s(256),Vp=s(256),T0=s(wo-Fc),E0=s(wo-Fc);qo("YuvToRgbRow",wl,3),qo("YuvToBgrRow",Gs,3),qo("YuvToRgbaRow",ya,4),qo("YuvToBgraRow",Go,4),qo("YuvToArgbRow",hu,4),qo("YuvToRgba4444Row",Ml,2),qo("YuvToRgb565Row",Ho,2);var os=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],af=[0,2,8],xu=[8,7,6,4,4,2,2,2,1,1,1,1],co=1;this.WebPDecodeRGBA=function(M,N,V,Y,oe){var de=br,me=new jt,Se=new Rt;me.ba=Se,Se.S=de,Se.width=[Se.width],Se.height=[Se.height];var Ne=Se.width,Le=Se.height,Ke=new se;if(Ke==null||M==null)var mt=2;else e(Ke!=null),mt=Fa(M,N,V,Ke.width,Ke.height,Ke.Pd,Ke.Qd,Ke.format,null);if(mt!=0?Ne=0:(Ne!=null&&(Ne[0]=Ke.width[0]),Le!=null&&(Le[0]=Ke.height[0]),Ne=1),Ne){Se.width=Se.width[0],Se.height=Se.height[0],Y!=null&&(Y[0]=Se.width),oe!=null&&(oe[0]=Se.height);e:{if(Y=new Tn,(oe=new $t).data=M,oe.w=N,oe.ha=V,oe.kd=1,N=[0],e(oe!=null),((M=Fa(oe.data,oe.w,oe.ha,null,null,null,N,null,oe))==0||M==7)&&N[0]&&(M=4),(N=M)==0){if(e(me!=null),Y.data=oe.data,Y.w=oe.w+oe.offset,Y.ha=oe.ha-oe.offset,Y.put=tn,Y.ac=dn,Y.bc=gn,Y.ma=me,oe.xa){if((M=Tt())==null){me=1;break e}if((function(Ce,it){var st=[0],Ut=[0],pt=[0];t:for(;;){if(Ce==null)return 0;if(it==null)return Ce.a=2,0;if(Ce.l=it,Ce.a=0,Re(Ce.m,it.data,it.w,it.ha),!Pn(Ce.m,st,Ut,pt)){Ce.a=3;break t}if(Ce.xb=Ad,it.width=st[0],it.height=Ut[0],!St(st[0],Ut[0],1,Ce,null))break t;return 1}return e(Ce.a!=0),0})(M,Y)){if(Y=(N=eo(Y.width,Y.height,me.Oa,me.ba))==0){t:{Y=M;n:for(;;){if(Y==null){Y=0;break t}if(e(Y.s.yc!=null),e(Y.s.Ya!=null),e(0<Y.s.Wb),e((V=Y.l)!=null),e((oe=V.ma)!=null),Y.xb!=0){if(Y.ca=oe.ba,Y.tb=oe.tb,e(Y.ca!=null),!Wo(oe.Oa,V,sa)){Y.a=2;break n}if(!Xt(Y,V.width)||V.da)break n;if((V.da||Me(Y.ca.S))&&yo(),11>Y.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),Y.ca.f.kb.F!=null&&yo()),Y.Pb&&0<Y.s.ua&&Y.s.vb.X==null&&!le(Y.s.vb,Y.s.Wa.Xa)){Y.a=1;break n}Y.xb=0}if(!Ue(Y,Y.V,Y.Ba,Y.c,Y.i,V.o,ir))break n;oe.Dc=Y.Ma,Y=1;break t}e(Y.a!=0),Y=0}Y=!Y}Y&&(N=M.a)}else N=M.a}else{if((M=new cn)==null){me=1;break e}if(M.Fa=oe.na,M.P=oe.P,M.qc=oe.Sa,pi(M,Y)){if((N=eo(Y.width,Y.height,me.Oa,me.ba))==0){if(M.Aa=0,V=me.Oa,e((oe=M)!=null),V!=null){if(0<(Ne=0>(Ne=V.Md)?0:100<Ne?255:255*Ne/100)){for(Le=Ke=0;4>Le;++Le)12>(mt=oe.pb[Le]).lc&&(mt.ia=Ne*xu[0>mt.lc?0:mt.lc]>>3),Ke|=mt.ia;Ke&&(alert("todo:VP8InitRandom"),oe.ia=1)}oe.Ga=V.Id,100<oe.Ga?oe.Ga=100:0>oe.Ga&&(oe.Ga=0)}(function(Ce,it){if(Ce==null)return 0;if(it==null)return hn(Ce,2,"NULL VP8Io parameter in VP8Decode().");if(!Ce.cb&&!pi(Ce,it))return 0;if(e(Ce.cb),it.ac==null||it.ac(it)){it.ob&&(Ce.L=0);var st=af[Ce.L];if(Ce.L==2?(Ce.yb=0,Ce.zb=0):(Ce.yb=it.v-st>>4,Ce.zb=it.j-st>>4,0>Ce.yb&&(Ce.yb=0),0>Ce.zb&&(Ce.zb=0)),Ce.Va=it.o+15+st>>4,Ce.Hb=it.va+15+st>>4,Ce.Hb>Ce.za&&(Ce.Hb=Ce.za),Ce.Va>Ce.Ub&&(Ce.Va=Ce.Ub),0<Ce.L){var Ut=Ce.ed;for(st=0;4>st;++st){var pt;if(Ce.Qa.Cb){var Bt=Ce.Qa.Lb[st];Ce.Qa.Fb||(Bt+=Ut.Tb)}else Bt=Ut.Tb;for(pt=0;1>=pt;++pt){var Ft=Ce.gd[st][pt],Kt=Bt;if(Ut.Pc&&(Kt+=Ut.vd[0],pt&&(Kt+=Ut.od[0])),0<(Kt=0>Kt?0:63<Kt?63:Kt)){var Yt=Kt;0<Ut.wb&&(Yt=4<Ut.wb?Yt>>2:Yt>>1)>9-Ut.wb&&(Yt=9-Ut.wb),1>Yt&&(Yt=1),Ft.dd=Yt,Ft.tc=2*Kt+Yt,Ft.ld=40<=Kt?2:15<=Kt?1:0}else Ft.tc=0;Ft.La=pt}}}st=0}else hn(Ce,6,"Frame setup failed"),st=Ce.a;if(st=st==0){if(st){Ce.$c=0,0<Ce.Aa||(Ce.Ic=co);t:{st=Ce.Ic,Ut=4*(Yt=Ce.za);var Dn=32*Yt,En=Yt+1,Wn=0<Ce.L?Yt*(0<Ce.Aa?2:1):0,Ln=(Ce.Aa==2?2:1)*Yt;if((Ft=Ut+832+(pt=3*(16*st+af[Ce.L])/2*Dn)+(Bt=Ce.Fa!=null&&0<Ce.Fa.length?Ce.Kc.c*Ce.Kc.i:0))!=Ft)st=0;else{if(Ft>Ce.Vb){if(Ce.Vb=0,Ce.Ec=s(Ft),Ce.Fc=0,Ce.Ec==null){st=hn(Ce,1,"no memory during frame initialization.");break t}Ce.Vb=Ft}Ft=Ce.Ec,Kt=Ce.Fc,Ce.Ac=Ft,Ce.Bc=Kt,Kt+=Ut,Ce.Gd=l(Dn,Gt),Ce.Hd=0,Ce.rb=l(En+1,et),Ce.sb=1,Ce.wa=Wn?l(Wn,$e):null,Ce.Y=0,Ce.D.Nb=0,Ce.D.wa=Ce.wa,Ce.D.Y=Ce.Y,0<Ce.Aa&&(Ce.D.Y+=Yt),e(!0),Ce.oc=Ft,Ce.pc=Kt,Kt+=832,Ce.ya=l(Ln,Vt),Ce.aa=0,Ce.D.ya=Ce.ya,Ce.D.aa=Ce.aa,Ce.Aa==2&&(Ce.D.aa+=Yt),Ce.R=16*Yt,Ce.B=8*Yt,Yt=(Dn=af[Ce.L])*Ce.R,Dn=Dn/2*Ce.B,Ce.sa=Ft,Ce.ta=Kt+Yt,Ce.qa=Ce.sa,Ce.ra=Ce.ta+16*st*Ce.R+Dn,Ce.Ha=Ce.qa,Ce.Ia=Ce.ra+8*st*Ce.B+Dn,Ce.$c=0,Kt+=pt,Ce.mb=Bt?Ft:null,Ce.nb=Bt?Kt:null,e(Kt+Bt<=Ce.Fc+Ce.Vb),Sn(Ce),r(Ce.Ac,Ce.Bc,0,Ut),st=1}}if(st){if(it.ka=0,it.y=Ce.sa,it.O=Ce.ta,it.f=Ce.qa,it.N=Ce.ra,it.ea=Ce.Ha,it.Vd=Ce.Ia,it.fa=Ce.R,it.Rc=Ce.B,it.F=null,it.J=0,!Hf){for(st=-255;255>=st;++st)Nl[255+st]=0>st?-st:st;for(st=-1020;1020>=st;++st)Ps[1020+st]=-128>st?-128:127<st?127:st;for(st=-112;112>=st;++st)Qu[112+st]=-16>st?-16:15<st?15:st;for(st=-255;510>=st;++st)Is[255+st]=0>st?0:255<st?255:st;Hf=1}na=Tr,ba=mi,to=Yi,Vi=Xi,di=Zr,ia=ss,dr=Yu,Vr=bl,Zo=ae,no=Ie,ic=jf,kc=B,Sh=qe,wd=at,Fp=gl,Md=vl,wh=Kl,io=Xu,Hr[0]=Ff,Hr[1]=gs,Hr[2]=Uf,Hr[3]=qu,Hr[4]=Ba,Hr[5]=zf,Hr[6]=Vs,Hr[7]=Rc,Hr[8]=Lc,Hr[9]=Hs,_a[0]=jo,_a[1]=Oa,_a[2]=Hu,_a[3]=Gu,_a[4]=pl,_a[5]=Nc,_a[6]=$l,Va[0]=Pc,Va[1]=Zl,Va[2]=Ja,Va[3]=cu,Va[4]=Ns,Va[5]=Wu,Va[6]=Vo,st=1}else st=0}st&&(st=(function(Ci,pr){for(Ci.M=0;Ci.M<Ci.Va;++Ci.M){var li,wn=Ci.Jc[Ci.M&Ci.Xb],yn=Ci.m,Gr=Ci;for(li=0;li<Gr.za;++li){var Xn=yn,gi=Gr,Ki=gi.Ac,Cn=gi.Bc+4*li,oa=gi.zc,Sr=gi.ya[gi.aa+li];if(gi.Qa.Bb?Sr.$b=We(Xn,gi.Pa.jb[0])?2+We(Xn,gi.Pa.jb[2]):We(Xn,gi.Pa.jb[1]):Sr.$b=0,gi.kc&&(Sr.Ad=We(Xn,gi.Bd)),Sr.Za=!We(Xn,145)+0,Sr.Za){var ls=Sr.Ob,xs=0;for(gi=0;4>gi;++gi){var ys,Ni=oa[0+gi];for(ys=0;4>ys;++ys){Ni=Kr[Ki[Cn+ys]][Ni];for(var Qi=qf[We(Xn,Ni[0])];0<Qi;)Qi=qf[2*Qi+We(Xn,Ni[Qi])];Ni=-Qi,Ki[Cn+ys]=Ni}n(ls,xs,Ki,Cn,4),xs+=4,oa[0+gi]=Ni}}else Ni=We(Xn,156)?We(Xn,128)?1:3:We(Xn,163)?2:0,Sr.Ob[0]=Ni,r(Ki,Cn,Ni,4),r(oa,0,Ni,4);Sr.Dd=We(Xn,142)?We(Xn,114)?We(Xn,183)?1:3:2:0}if(Gr.m.Ka)return hn(Ci,7,"Premature end-of-partition0 encountered.");for(;Ci.ja<Ci.za;++Ci.ja){if(Gr=wn,Xn=(yn=Ci).rb[yn.sb-1],Ki=yn.rb[yn.sb+yn.ja],li=yn.ya[yn.aa+yn.ja],Cn=yn.kc?li.Ad:0)Xn.la=Ki.la=0,li.Za||(Xn.Na=Ki.Na=0),li.Hc=0,li.Gc=0,li.ia=0;else{var qr,rr;if(Xn=Ki,Ki=Gr,Cn=yn.Pa.Xc,oa=yn.ya[yn.aa+yn.ja],Sr=yn.pb[oa.$b],gi=oa.ad,ls=0,xs=yn.rb[yn.sb-1],Ni=ys=0,r(gi,ls,0,384),oa.Za)var cs=0,kr=Cn[3];else{Qi=s(16);var Hi=Xn.Na+xs.Na;if(Hi=ja(Ki,Cn[1],Hi,Sr.Eb,0,Qi,0),Xn.Na=xs.Na=(0<Hi)+0,1<Hi)na(Qi,0,gi,ls);else{var Qr=Qi[0]+3>>3;for(Qi=0;256>Qi;Qi+=16)gi[ls+Qi]=Qr}cs=1,kr=Cn[0]}var lr=15&Xn.la,bs=15&xs.la;for(Qi=0;4>Qi;++Qi){var wr=1&bs;for(Qr=rr=0;4>Qr;++Qr)lr=lr>>1|(wr=(Hi=ja(Ki,kr,Hi=wr+(1&lr),Sr.Sc,cs,gi,ls))>cs)<<7,rr=rr<<2|(3<Hi?3:1<Hi?2:gi[ls+0]!=0),ls+=16;lr>>=4,bs=bs>>1|wr<<7,ys=(ys<<8|rr)>>>0}for(kr=lr,cs=bs>>4,qr=0;4>qr;qr+=2){for(rr=0,lr=Xn.la>>4+qr,bs=xs.la>>4+qr,Qi=0;2>Qi;++Qi){for(wr=1&bs,Qr=0;2>Qr;++Qr)Hi=wr+(1&lr),lr=lr>>1|(wr=0<(Hi=ja(Ki,Cn[2],Hi,Sr.Qc,0,gi,ls)))<<3,rr=rr<<2|(3<Hi?3:1<Hi?2:gi[ls+0]!=0),ls+=16;lr>>=2,bs=bs>>1|wr<<5}Ni|=rr<<4*qr,kr|=lr<<4<<qr,cs|=(240&bs)<<qr}Xn.la=kr,xs.la=cs,oa.Hc=ys,oa.Gc=Ni,oa.ia=43690&Ni?0:Sr.ia,Cn=!(ys|Ni)}if(0<yn.L&&(yn.wa[yn.Y+yn.ja]=yn.gd[li.$b][li.Za],yn.wa[yn.Y+yn.ja].La|=!Cn),Gr.Ka)return hn(Ci,7,"Premature end-of-file encountered.")}if(Sn(Ci),yn=pr,Gr=1,li=(wn=Ci).D,Xn=0<wn.L&&wn.M>=wn.zb&&wn.M<=wn.Va,wn.Aa==0)t:{if(li.M=wn.M,li.uc=Xn,Ca(wn,li),Gr=1,li=(rr=wn.D).Nb,Xn=(Ni=af[wn.L])*wn.R,Ki=Ni/2*wn.B,Qi=16*li*wn.R,Qr=8*li*wn.B,Cn=wn.sa,oa=wn.ta-Xn+Qi,Sr=wn.qa,gi=wn.ra-Ki+Qr,ls=wn.Ha,xs=wn.Ia-Ki+Qr,bs=(lr=rr.M)==0,ys=lr>=wn.Va-1,wn.Aa==2&&Ca(wn,rr),rr.uc)for(wr=(Hi=wn).D.M,e(Hi.D.uc),rr=Hi.yb;rr<Hi.Hb;++rr){cs=rr,kr=wr;var Gi=(ei=(_s=Hi).D).Nb;qr=_s.R;var ei=ei.wa[ei.Y+cs],Nr=_s.sa,Ii=_s.ta+16*Gi*qr+16*cs,Vn=ei.dd,Gn=ei.tc;if(Gn!=0)if(e(3<=Gn),_s.L==1)0<cs&&Md(Nr,Ii,qr,Gn+4),ei.La&&io(Nr,Ii,qr,Gn),0<kr&&Fp(Nr,Ii,qr,Gn+4),ei.La&&wh(Nr,Ii,qr,Gn);else{var Kn=_s.B,es=_s.qa,Mo=_s.ra+8*Gi*Kn+8*cs,Na=_s.Ha,_s=_s.Ia+8*Gi*Kn+8*cs;Gi=ei.ld,0<cs&&(Vr(Nr,Ii,qr,Gn+4,Vn,Gi),no(es,Mo,Na,_s,Kn,Gn+4,Vn,Gi)),ei.La&&(kc(Nr,Ii,qr,Gn,Vn,Gi),wd(es,Mo,Na,_s,Kn,Gn,Vn,Gi)),0<kr&&(dr(Nr,Ii,qr,Gn+4,Vn,Gi),Zo(es,Mo,Na,_s,Kn,Gn+4,Vn,Gi)),ei.La&&(ic(Nr,Ii,qr,Gn,Vn,Gi),Sh(es,Mo,Na,_s,Kn,Gn,Vn,Gi))}}if(wn.ia&&alert("todo:DitherRow"),yn.put!=null){if(rr=16*lr,lr=16*(lr+1),bs?(yn.y=wn.sa,yn.O=wn.ta+Qi,yn.f=wn.qa,yn.N=wn.ra+Qr,yn.ea=wn.Ha,yn.W=wn.Ia+Qr):(rr-=Ni,yn.y=Cn,yn.O=oa,yn.f=Sr,yn.N=gi,yn.ea=ls,yn.W=xs),ys||(lr-=Ni),lr>yn.o&&(lr=yn.o),yn.F=null,yn.J=null,wn.Fa!=null&&0<wn.Fa.length&&rr<lr&&(yn.J=ur(wn,yn,rr,lr-rr),yn.F=wn.mb,yn.F==null&&yn.F.length==0)){Gr=hn(wn,3,"Could not decode alpha data.");break t}rr<yn.j&&(Ni=yn.j-rr,rr=yn.j,e(!(1&Ni)),yn.O+=wn.R*Ni,yn.N+=wn.B*(Ni>>1),yn.W+=wn.B*(Ni>>1),yn.F!=null&&(yn.J+=yn.width*Ni)),rr<lr&&(yn.O+=yn.v,yn.N+=yn.v>>1,yn.W+=yn.v>>1,yn.F!=null&&(yn.J+=yn.v),yn.ka=rr-yn.j,yn.U=yn.va-yn.v,yn.T=lr-rr,Gr=yn.put(yn))}li+1!=wn.Ic||ys||(n(wn.sa,wn.ta-Xn,Cn,oa+16*wn.R,Xn),n(wn.qa,wn.ra-Ki,Sr,gi+8*wn.B,Ki),n(wn.Ha,wn.Ia-Ki,ls,xs+8*wn.B,Ki))}if(!Gr)return hn(Ci,6,"Output aborted.")}return 1})(Ce,it)),it.bc!=null&&it.bc(it),st&=1}return st?(Ce.cb=0,st):0})(M,Y)||(N=M.a)}}else N=M.a}N==0&&me.Oa!=null&&me.Oa.fd&&(N=Ju(me.ba))}me=N}de=me!=0?null:11>de?Se.f.RGBA.eb:Se.f.kb.y}else de=null;return de};var Xf=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(L,k){for(var U="",q=0;q<4;q++)U+=String.fromCharCode(L[k++]);return U}function m(L,k){return L[k+0]|L[k+1]<<8}function g(L,k){return(L[k+0]|L[k+1]<<8|L[k+2]<<16)>>>0}function y(L,k){return(L[k+0]|L[k+1]<<8|L[k+2]<<16|L[k+3]<<24)>>>0}new f;var v=[0],S=[0],T=[],A=new f,w=i,R=(function(L,k){var U={},q=0,W=!1,J=0,ce=0;if(U.frames=[],!(function(F,$){for(var re=0;re<4;re++)if(F[$+re]!="RIFF".charCodeAt(re))return!0;return!1})(L,k)){for(y(L,k+=4),k+=8;k<L.length;){var K=d(L,k),ne=y(L,k+=4);k+=4;var pe=ne+(1&ne);switch(K){case"VP8 ":case"VP8L":U.frames[q]===void 0&&(U.frames[q]={}),(ee=U.frames[q]).src_off=W?ce:k-8,ee.src_size=J+ne+8,q++,W&&(W=!1,J=0,ce=0);break;case"VP8X":(ee=U.header={}).feature_flags=L[k];var Re=k+4;ee.canvas_width=1+g(L,Re),Re+=3,ee.canvas_height=1+g(L,Re),Re+=3;break;case"ALPH":W=!0,J=pe+8,ce=k-8;break;case"ANIM":(ee=U.header).bgcolor=y(L,k),Re=k+4,ee.loop_count=m(L,Re),Re+=2;break;case"ANMF":var Te,ee;(ee=U.frames[q]={}).offset_x=2*g(L,k),k+=3,ee.offset_y=2*g(L,k),k+=3,ee.width=1+g(L,k),k+=3,ee.height=1+g(L,k),k+=3,ee.duration=g(L,k),k+=3,Te=L[k++],ee.dispose=1&Te,ee.blend=Te>>1&1}K!="ANMF"&&(k+=pe)}return U}})(w,0);R.response=w,R.rgbaoutput=!0,R.dataurl=!1;var D=R.header?R.header:null,I=R.frames?R.frames:null;if(D){D.loop_counter=D.loop_count,v=[D.canvas_height],S=[D.canvas_width];for(var z=0;z<I.length&&I[z].blend!=0;z++);}var j=I[0],X=A.WebPDecodeRGBA(w,j.src_off,j.src_size,S,v);j.rgba=X,j.imgwidth=S[0],j.imgheight=v[0];for(var G=0;G<S[0]*v[0]*4;G++)T[G]=X[G];return this.width=S,this.height=v,this.data=T,this}(function(i){var e,t,n,r,s,l,c,f,d,m=function(F){return F=F||{},this.isStrokeTransparent=F.isStrokeTransparent||!1,this.strokeOpacity=F.strokeOpacity||1,this.strokeStyle=F.strokeStyle||"#000000",this.fillStyle=F.fillStyle||"#000000",this.isFillTransparent=F.isFillTransparent||!1,this.fillOpacity=F.fillOpacity||1,this.font=F.font||"10px sans-serif",this.textBaseline=F.textBaseline||"alphabetic",this.textAlign=F.textAlign||"left",this.lineWidth=F.lineWidth||1,this.lineJoin=F.lineJoin||"miter",this.lineCap=F.lineCap||"butt",this.path=F.path||[],this.transform=F.transform!==void 0?F.transform.clone():new f,this.globalCompositeOperation=F.globalCompositeOperation||"normal",this.globalAlpha=F.globalAlpha||1,this.clip_path=F.clip_path||[],this.currentPoint=F.currentPoint||new l,this.miterLimit=F.miterLimit||10,this.lastPoint=F.lastPoint||new l,this.lineDashOffset=F.lineDashOffset||0,this.lineDash=F.lineDash||[],this.margin=F.margin||[0,0,0,0],this.prevPageLastElemOffset=F.prevPageLastElemOffset||0,this.ignoreClearRect=typeof F.ignoreClearRect!="boolean"||F.ignoreClearRect,this};i.events.push(["initialized",function(){this.context2d=new g(this),e=this.internal.f2,t=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,r=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,l=this.internal.Point,c=this.internal.Rectangle,f=this.internal.Matrix,d=new m}]);var g=function(F){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var $=F;Object.defineProperty(this,"pdf",{get:function(){return $}});var re=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return re},set:function(le){re=!!le}});var Ae=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Ae},set:function(le){Ae=!!le}});var ie=0;Object.defineProperty(this,"posX",{get:function(){return ie},set:function(le){isNaN(le)||(ie=le)}});var _e=0;Object.defineProperty(this,"posY",{get:function(){return _e},set:function(le){isNaN(le)||(_e=le)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(le){var Qe;typeof le=="number"?Qe=[le,le,le,le]:((Qe=new Array(4))[0]=le[0],Qe[1]=le.length>=2?le[1]:Qe[0],Qe[2]=le.length>=3?le[2]:Qe[0],Qe[3]=le.length>=4?le[3]:Qe[1]),d.margin=Qe}});var ke=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ke},set:function(le){ke=le}});var Fe=0;Object.defineProperty(this,"lastBreak",{get:function(){return Fe},set:function(le){Fe=le}});var We=[];Object.defineProperty(this,"pageBreaks",{get:function(){return We},set:function(le){We=le}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(le){le instanceof m&&(d=le)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(le){d.path=le}});var nt=[];Object.defineProperty(this,"ctxStack",{get:function(){return nt},set:function(le){nt=le}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(le){var Qe;Qe=y(le),this.ctx.fillStyle=Qe.style,this.ctx.isFillTransparent=Qe.a===0,this.ctx.fillOpacity=Qe.a,this.pdf.setFillColor(Qe.r,Qe.g,Qe.b,{a:Qe.a}),this.pdf.setTextColor(Qe.r,Qe.g,Qe.b,{a:Qe.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(le){var Qe=y(le);this.ctx.strokeStyle=Qe.style,this.ctx.isStrokeTransparent=Qe.a===0,this.ctx.strokeOpacity=Qe.a,Qe.a===0?this.pdf.setDrawColor(255,255,255):(Qe.a,this.pdf.setDrawColor(Qe.r,Qe.g,Qe.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(le){["butt","round","square"].indexOf(le)!==-1&&(this.ctx.lineCap=le,this.pdf.setLineCap(le))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(le){isNaN(le)||(this.ctx.lineWidth=le,this.pdf.setLineWidth(le))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(le){["bevel","round","miter"].indexOf(le)!==-1&&(this.ctx.lineJoin=le,this.pdf.setLineJoin(le))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(le){isNaN(le)||(this.ctx.miterLimit=le,this.pdf.setMiterLimit(le))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(le){this.ctx.textBaseline=le}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(le){["right","end","center","left","start"].indexOf(le)!==-1&&(this.ctx.textAlign=le)}});var It=null,wt=null,Je=null;Object.defineProperty(this,"fontFaces",{get:function(){return Je},set:function(le){It=null,wt=null,Je=le}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(le){var Qe;if(this.ctx.font=le,(Qe=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(le))!==null){var Et=Qe[1];Qe[2];var we=Qe[3],ot=Qe[4];Qe[5];var Ct=Qe[6],ht=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ot)[2];ot=Math.floor(ht==="px"?parseFloat(ot)*this.pdf.internal.scaleFactor:ht==="em"?parseFloat(ot)*this.pdf.getFontSize():parseFloat(ot)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ot);var xt=(function(Lt){var un,bt,dt=[],Ge=Lt.trim();if(Ge==="")return b_;if(Ge in SA)return[SA[Ge]];for(;Ge!=="";){switch(bt=null,un=(Ge=MA(Ge)).charAt(0)){case'"':case"'":bt=Zz(Ge.substring(1),un);break;default:bt=$z(Ge)}if(bt===null||(dt.push(bt[0]),(Ge=MA(bt[1]))!==""&&Ge.charAt(0)!==","))return b_;Ge=Ge.replace(/^,/,"")}return dt})(Ct);if(this.fontFaces){var he=(function(Lt,un){var bt=Lt.getFontList(),dt=JSON.stringify(bt);if(It===null||wt!==dt){var Ge=(function(xe){var Pe=[];return Object.keys(xe).forEach(function(rt){xe[rt].forEach(function(Me){var ze=null;switch(Me){case"bold":ze={family:rt,weight:"bold"};break;case"italic":ze={family:rt,style:"italic"};break;case"bolditalic":ze={family:rt,weight:"bold",style:"italic"};break;case"":case"normal":ze={family:rt}}ze!==null&&(ze.ref={name:rt,style:Me},Pe.push(ze))})}),Pe})(bt);It=(function(xe){for(var Pe={},rt=0;rt<xe.length;++rt){var Me=y_(xe[rt]),ze=Me.family,Mt=Me.stretch,Rt=Me.style,se=Me.weight;Pe[ze]=Pe[ze]||{},Pe[ze][Mt]=Pe[ze][Mt]||{},Pe[ze][Mt][Rt]=Pe[ze][Mt][Rt]||{},Pe[ze][Mt][Rt][se]=Me}return Pe})(Ge.concat(un)),wt=dt}return It})(this.pdf,this.fontFaces),Q=xt.map(function(Lt){return{family:Lt,stretch:"normal",weight:we,style:Et}}),Be=(function(Lt,un,bt){for(var dt=(bt=bt||{}).defaultFontFamily||"times",Ge=Object.assign({},Yz,bt.genericFontFamilies||{}),xe=null,Pe=null,rt=0;rt<un.length;++rt)if(Ge[(xe=y_(un[rt])).family]&&(xe.family=Ge[xe.family]),Lt.hasOwnProperty(xe.family)){Pe=Lt[xe.family];break}if(!(Pe=Pe||Lt[dt]))throw new Error("Could not find a font-family for the rule '"+wA(xe)+"' and default family '"+dt+"'.");if(Pe=(function(Me,ze){if(ze[Me])return ze[Me];var Mt=uS[Me],Rt=Mt<=uS.normal?-1:1,se=_A(ze,aC,Mt,Rt);if(!se)throw new Error("Could not find a matching font-stretch value for "+Me);return se})(xe.stretch,Pe),Pe=(function(Me,ze){if(ze[Me])return ze[Me];for(var Mt=sC[Me],Rt=0;Rt<Mt.length;++Rt)if(ze[Mt[Rt]])return ze[Mt[Rt]];throw new Error("Could not find a matching font-style for "+Me)})(xe.style,Pe),!(Pe=(function(Me,ze){if(ze[Me])return ze[Me];if(Me===400&&ze[500])return ze[500];if(Me===500&&ze[400])return ze[400];var Mt=Xz[Me],Rt=_A(ze,oC,Mt,Me<400?-1:1);if(!Rt)throw new Error("Could not find a matching font-weight for value "+Me);return Rt})(xe.weight,Pe)))throw new Error("Failed to resolve a font for the rule '"+wA(xe)+"'.");return Pe})(he,Q);this.pdf.setFont(Be.ref.name,Be.ref.style)}else{var ue="";(we==="bold"||parseInt(we,10)>=700||Et==="bold")&&(ue="bold"),Et==="italic"&&(ue+="italic"),ue.length===0&&(ue="normal");for(var je="",Ye={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ft=0;ft<xt.length;ft++){if(this.pdf.internal.getFont(xt[ft],ue,{noFallback:!0,disableWarning:!0})!==void 0){je=xt[ft];break}if(ue==="bolditalic"&&this.pdf.internal.getFont(xt[ft],"bold",{noFallback:!0,disableWarning:!0})!==void 0)je=xt[ft],ue="bold";else if(this.pdf.internal.getFont(xt[ft],"normal",{noFallback:!0,disableWarning:!0})!==void 0){je=xt[ft],ue="normal";break}}if(je===""){for(var gt=0;gt<xt.length;gt++)if(Ye[xt[gt]]){je=Ye[xt[gt]];break}}je=je===""?"Times":je,this.pdf.setFont(je,ue)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(le){this.ctx.globalCompositeOperation=le}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(le){this.ctx.globalAlpha=le}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(le){this.ctx.lineDashOffset=le,ee.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(le){this.ctx.lineDash=le,ee.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(le){this.ctx.ignoreClearRect=!!le}})};g.prototype.setLineDash=function(F){this.lineDash=F},g.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},g.prototype.fill=function(){I.call(this,"fill",!1)},g.prototype.stroke=function(){I.call(this,"stroke",!1)},g.prototype.beginPath=function(){this.path=[{type:"begin"}]},g.prototype.moveTo=function(F,$){if(isNaN(F)||isNaN($))throw Xr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var re=this.ctx.transform.applyToPoint(new l(F,$));this.path.push({type:"mt",x:re.x,y:re.y}),this.ctx.lastPoint=new l(F,$)},g.prototype.closePath=function(){var F=new l(0,0),$=0;for($=this.path.length-1;$!==-1;$--)if(this.path[$].type==="begin"&&Rr(this.path[$+1])==="object"&&typeof this.path[$+1].x=="number"){F=new l(this.path[$+1].x,this.path[$+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(F.x,F.y)},g.prototype.lineTo=function(F,$){if(isNaN(F)||isNaN($))throw Xr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var re=this.ctx.transform.applyToPoint(new l(F,$));this.path.push({type:"lt",x:re.x,y:re.y}),this.ctx.lastPoint=new l(re.x,re.y)},g.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),I.call(this,null,!0)},g.prototype.quadraticCurveTo=function(F,$,re,Ae){if(isNaN(re)||isNaN(Ae)||isNaN(F)||isNaN($))throw Xr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ie=this.ctx.transform.applyToPoint(new l(re,Ae)),_e=this.ctx.transform.applyToPoint(new l(F,$));this.path.push({type:"qct",x1:_e.x,y1:_e.y,x:ie.x,y:ie.y}),this.ctx.lastPoint=new l(ie.x,ie.y)},g.prototype.bezierCurveTo=function(F,$,re,Ae,ie,_e){if(isNaN(ie)||isNaN(_e)||isNaN(F)||isNaN($)||isNaN(re)||isNaN(Ae))throw Xr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ke=this.ctx.transform.applyToPoint(new l(ie,_e)),Fe=this.ctx.transform.applyToPoint(new l(F,$)),We=this.ctx.transform.applyToPoint(new l(re,Ae));this.path.push({type:"bct",x1:Fe.x,y1:Fe.y,x2:We.x,y2:We.y,x:ke.x,y:ke.y}),this.ctx.lastPoint=new l(ke.x,ke.y)},g.prototype.arc=function(F,$,re,Ae,ie,_e){if(isNaN(F)||isNaN($)||isNaN(re)||isNaN(Ae)||isNaN(ie))throw Xr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(_e=!!_e,!this.ctx.transform.isIdentity){var ke=this.ctx.transform.applyToPoint(new l(F,$));F=ke.x,$=ke.y;var Fe=this.ctx.transform.applyToPoint(new l(0,re)),We=this.ctx.transform.applyToPoint(new l(0,0));re=Math.sqrt(Math.pow(Fe.x-We.x,2)+Math.pow(Fe.y-We.y,2))}Math.abs(ie-Ae)>=2*Math.PI&&(Ae=0,ie=2*Math.PI),this.path.push({type:"arc",x:F,y:$,radius:re,startAngle:Ae,endAngle:ie,counterclockwise:_e})},g.prototype.arcTo=function(F,$,re,Ae,ie){throw new Error("arcTo not implemented.")},g.prototype.rect=function(F,$,re,Ae){if(isNaN(F)||isNaN($)||isNaN(re)||isNaN(Ae))throw Xr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(F,$),this.lineTo(F+re,$),this.lineTo(F+re,$+Ae),this.lineTo(F,$+Ae),this.lineTo(F,$),this.lineTo(F+re,$),this.lineTo(F,$)},g.prototype.fillRect=function(F,$,re,Ae){if(isNaN(F)||isNaN($)||isNaN(re)||isNaN(Ae))throw Xr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!v.call(this)){var ie={};this.lineCap!=="butt"&&(ie.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ie.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(F,$,re,Ae),this.fill(),ie.hasOwnProperty("lineCap")&&(this.lineCap=ie.lineCap),ie.hasOwnProperty("lineJoin")&&(this.lineJoin=ie.lineJoin)}},g.prototype.strokeRect=function(F,$,re,Ae){if(isNaN(F)||isNaN($)||isNaN(re)||isNaN(Ae))throw Xr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");S.call(this)||(this.beginPath(),this.rect(F,$,re,Ae),this.stroke())},g.prototype.clearRect=function(F,$,re,Ae){if(isNaN(F)||isNaN($)||isNaN(re)||isNaN(Ae))throw Xr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(F,$,re,Ae))},g.prototype.save=function(F){F=typeof F!="boolean"||F;for(var $=this.pdf.internal.getCurrentPageInfo().pageNumber,re=0;re<this.pdf.internal.getNumberOfPages();re++)this.pdf.setPage(re+1),this.pdf.internal.out("q");if(this.pdf.setPage($),F){this.ctx.fontSize=this.pdf.internal.getFontSize();var Ae=new m(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Ae}},g.prototype.restore=function(F){F=typeof F!="boolean"||F;for(var $=this.pdf.internal.getCurrentPageInfo().pageNumber,re=0;re<this.pdf.internal.getNumberOfPages();re++)this.pdf.setPage(re+1),this.pdf.internal.out("Q");this.pdf.setPage($),F&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},g.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var y=function(F){var $,re,Ae,ie;if(F.isCanvasGradient===!0&&(F=F.getColor()),!F)return{r:0,g:0,b:0,a:0,style:F};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(F))$=0,re=0,Ae=0,ie=0;else{var _e=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(F);if(_e!==null)$=parseInt(_e[1]),re=parseInt(_e[2]),Ae=parseInt(_e[3]),ie=1;else if((_e=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(F))!==null)$=parseInt(_e[1]),re=parseInt(_e[2]),Ae=parseInt(_e[3]),ie=parseFloat(_e[4]);else{if(ie=1,typeof F=="string"&&F.charAt(0)!=="#"){var ke=new K4(F);F=ke.ok?ke.toHex():"#000000"}F.length===4?($=F.substring(1,2),$+=$,re=F.substring(2,3),re+=re,Ae=F.substring(3,4),Ae+=Ae):($=F.substring(1,3),re=F.substring(3,5),Ae=F.substring(5,7)),$=parseInt($,16),re=parseInt(re,16),Ae=parseInt(Ae,16)}}return{r:$,g:re,b:Ae,a:ie,style:F}},v=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},S=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};g.prototype.fillText=function(F,$,re,Ae){if(isNaN($)||isNaN(re)||typeof F!="string")throw Xr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Ae=isNaN(Ae)?void 0:Ae,!v.call(this)){var ie=pe(this.ctx.transform.rotation),_e=this.ctx.transform.scaleX;q.call(this,{text:F,x:$,y:re,scale:_e,angle:ie,align:this.textAlign,maxWidth:Ae})}},g.prototype.strokeText=function(F,$,re,Ae){if(isNaN($)||isNaN(re)||typeof F!="string")throw Xr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!S.call(this)){Ae=isNaN(Ae)?void 0:Ae;var ie=pe(this.ctx.transform.rotation),_e=this.ctx.transform.scaleX;q.call(this,{text:F,x:$,y:re,scale:_e,renderingMode:"stroke",angle:ie,align:this.textAlign,maxWidth:Ae})}},g.prototype.measureText=function(F){if(typeof F!="string")throw Xr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var $=this.pdf,re=this.pdf.internal.scaleFactor,Ae=$.internal.getFontSize(),ie=$.getStringUnitWidth(F)*Ae/$.internal.scaleFactor;return new function(_e){var ke=(_e=_e||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ke}}),this}({width:ie*=Math.round(96*re/72*1e4)/1e4})},g.prototype.scale=function(F,$){if(isNaN(F)||isNaN($))throw Xr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var re=new f(F,0,0,$,0,0);this.ctx.transform=this.ctx.transform.multiply(re)},g.prototype.rotate=function(F){if(isNaN(F))throw Xr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var $=new f(Math.cos(F),Math.sin(F),-Math.sin(F),Math.cos(F),0,0);this.ctx.transform=this.ctx.transform.multiply($)},g.prototype.translate=function(F,$){if(isNaN(F)||isNaN($))throw Xr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var re=new f(1,0,0,1,F,$);this.ctx.transform=this.ctx.transform.multiply(re)},g.prototype.transform=function(F,$,re,Ae,ie,_e){if(isNaN(F)||isNaN($)||isNaN(re)||isNaN(Ae)||isNaN(ie)||isNaN(_e))throw Xr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ke=new f(F,$,re,Ae,ie,_e);this.ctx.transform=this.ctx.transform.multiply(ke)},g.prototype.setTransform=function(F,$,re,Ae,ie,_e){F=isNaN(F)?1:F,$=isNaN($)?0:$,re=isNaN(re)?0:re,Ae=isNaN(Ae)?1:Ae,ie=isNaN(ie)?0:ie,_e=isNaN(_e)?0:_e,this.ctx.transform=new f(F,$,re,Ae,ie,_e)};var T=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};g.prototype.drawImage=function(F,$,re,Ae,ie,_e,ke,Fe,We){var nt=this.pdf.getImageProperties(F),It=1,wt=1,Je=1,le=1;Ae!==void 0&&Fe!==void 0&&(Je=Fe/Ae,le=We/ie,It=nt.width/Ae*Fe/Ae,wt=nt.height/ie*We/ie),_e===void 0&&(_e=$,ke=re,$=0,re=0),Ae!==void 0&&Fe===void 0&&(Fe=Ae,We=ie),Ae===void 0&&Fe===void 0&&(Fe=nt.width,We=nt.height);var Qe=this.ctx.transform.decompose(),Et=pe(Qe.rotate.shx),we=new f,ot=(we=(we=(we=we.multiply(Qe.translate)).multiply(Qe.skew)).multiply(Qe.scale)).applyToRectangle(new c(_e-$*Je,ke-re*le,Ae*It,ie*wt));if(this.autoPaging){for(var Ct,ht=A.call(this,ot),xt=[],he=0;he<ht.length;he+=1)xt.indexOf(ht[he])===-1&&xt.push(ht[he]);D(xt);for(var Q=xt[0],Be=xt[xt.length-1],ue=Q;ue<Be+1;ue++){this.pdf.setPage(ue);var je=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ye=ue===1?this.posY+this.margin[0]:this.margin[0],ft=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],gt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Lt=ue===1?0:ft+(ue-2)*gt;if(this.ctx.clip_path.length!==0){var un=this.path;Ct=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=R(Ct,this.posX+this.margin[3],-Lt+Ye+this.ctx.prevPageLastElemOffset),z.call(this,"fill",!0),this.path=un}var bt=JSON.parse(JSON.stringify(ot));bt=R([bt],this.posX+this.margin[3],-Lt+Ye+this.ctx.prevPageLastElemOffset)[0];var dt=(ue>Q||ue<Be)&&T.call(this);dt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],je,gt,null).clip().discardPath()),this.pdf.addImage(F,"JPEG",bt.x,bt.y,bt.w,bt.h,null,null,Et),dt&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(F,"JPEG",ot.x,ot.y,ot.w,ot.h,null,null,Et)};var A=function(F,$,re){var Ae=[];$=$||this.pdf.internal.pageSize.width,re=re||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ie=this.posY+this.ctx.prevPageLastElemOffset;switch(F.type){default:case"mt":case"lt":Ae.push(Math.floor((F.y+ie)/re)+1);break;case"arc":Ae.push(Math.floor((F.y+ie-F.radius)/re)+1),Ae.push(Math.floor((F.y+ie+F.radius)/re)+1);break;case"qct":var _e=Re(this.ctx.lastPoint.x,this.ctx.lastPoint.y,F.x1,F.y1,F.x,F.y);Ae.push(Math.floor((_e.y+ie)/re)+1),Ae.push(Math.floor((_e.y+_e.h+ie)/re)+1);break;case"bct":var ke=Te(this.ctx.lastPoint.x,this.ctx.lastPoint.y,F.x1,F.y1,F.x2,F.y2,F.x,F.y);Ae.push(Math.floor((ke.y+ie)/re)+1),Ae.push(Math.floor((ke.y+ke.h+ie)/re)+1);break;case"rect":Ae.push(Math.floor((F.y+ie)/re)+1),Ae.push(Math.floor((F.y+F.h+ie)/re)+1)}for(var Fe=0;Fe<Ae.length;Fe+=1)for(;this.pdf.internal.getNumberOfPages()<Ae[Fe];)w.call(this);return Ae},w=function(){var F=this.fillStyle,$=this.strokeStyle,re=this.font,Ae=this.lineCap,ie=this.lineWidth,_e=this.lineJoin;this.pdf.addPage(),this.fillStyle=F,this.strokeStyle=$,this.font=re,this.lineCap=Ae,this.lineWidth=ie,this.lineJoin=_e},R=function(F,$,re){for(var Ae=0;Ae<F.length;Ae++)switch(F[Ae].type){case"bct":F[Ae].x2+=$,F[Ae].y2+=re;case"qct":F[Ae].x1+=$,F[Ae].y1+=re;default:F[Ae].x+=$,F[Ae].y+=re}return F},D=function(F){return F.sort(function($,re){return $-re})},I=function(F,$){var re=this.fillStyle,Ae=this.strokeStyle,ie=this.lineCap,_e=this.lineWidth,ke=Math.abs(_e*this.ctx.transform.scaleX),Fe=this.lineJoin;if(this.autoPaging){for(var We,nt,It=JSON.parse(JSON.stringify(this.path)),wt=JSON.parse(JSON.stringify(this.path)),Je=[],le=0;le<wt.length;le++)if(wt[le].x!==void 0)for(var Qe=A.call(this,wt[le]),Et=0;Et<Qe.length;Et+=1)Je.indexOf(Qe[Et])===-1&&Je.push(Qe[Et]);for(var we=0;we<Je.length;we++)for(;this.pdf.internal.getNumberOfPages()<Je[we];)w.call(this);D(Je);for(var ot=Je[0],Ct=Je[Je.length-1],ht=ot;ht<Ct+1;ht++){this.pdf.setPage(ht),this.fillStyle=re,this.strokeStyle=Ae,this.lineCap=ie,this.lineWidth=ke,this.lineJoin=Fe;var xt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],he=ht===1?this.posY+this.margin[0]:this.margin[0],Q=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Be=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ue=ht===1?0:Q+(ht-2)*Be;if(this.ctx.clip_path.length!==0){var je=this.path;We=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=R(We,this.posX+this.margin[3],-ue+he+this.ctx.prevPageLastElemOffset),z.call(this,F,!0),this.path=je}if(nt=JSON.parse(JSON.stringify(It)),this.path=R(nt,this.posX+this.margin[3],-ue+he+this.ctx.prevPageLastElemOffset),$===!1||ht===0){var Ye=(ht>ot||ht<Ct)&&T.call(this);Ye&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],xt,Be,null).clip().discardPath()),z.call(this,F,$),Ye&&this.pdf.restoreGraphicsState()}this.lineWidth=_e}this.path=It}else this.lineWidth=ke,z.call(this,F,$),this.lineWidth=_e},z=function(F,$){if((F!=="stroke"||$||!S.call(this))&&(F==="stroke"||$||!v.call(this))){for(var re,Ae,ie=[],_e=this.path,ke=0;ke<_e.length;ke++){var Fe=_e[ke];switch(Fe.type){case"begin":ie.push({begin:!0});break;case"close":ie.push({close:!0});break;case"mt":ie.push({start:Fe,deltas:[],abs:[]});break;case"lt":var We=ie.length;if(_e[ke-1]&&!isNaN(_e[ke-1].x)&&(re=[Fe.x-_e[ke-1].x,Fe.y-_e[ke-1].y],We>0)){for(;We>=0;We--)if(ie[We-1].close!==!0&&ie[We-1].begin!==!0){ie[We-1].deltas.push(re),ie[We-1].abs.push(Fe);break}}break;case"bct":re=[Fe.x1-_e[ke-1].x,Fe.y1-_e[ke-1].y,Fe.x2-_e[ke-1].x,Fe.y2-_e[ke-1].y,Fe.x-_e[ke-1].x,Fe.y-_e[ke-1].y],ie[ie.length-1].deltas.push(re);break;case"qct":var nt=_e[ke-1].x+2/3*(Fe.x1-_e[ke-1].x),It=_e[ke-1].y+2/3*(Fe.y1-_e[ke-1].y),wt=Fe.x+2/3*(Fe.x1-Fe.x),Je=Fe.y+2/3*(Fe.y1-Fe.y),le=Fe.x,Qe=Fe.y;re=[nt-_e[ke-1].x,It-_e[ke-1].y,wt-_e[ke-1].x,Je-_e[ke-1].y,le-_e[ke-1].x,Qe-_e[ke-1].y],ie[ie.length-1].deltas.push(re);break;case"arc":ie.push({deltas:[],abs:[],arc:!0}),Array.isArray(ie[ie.length-1].abs)&&ie[ie.length-1].abs.push(Fe)}}Ae=$?null:F==="stroke"?"stroke":"fill";for(var Et=!1,we=0;we<ie.length;we++)if(ie[we].arc)for(var ot=ie[we].abs,Ct=0;Ct<ot.length;Ct++){var ht=ot[Ct];ht.type==="arc"?G.call(this,ht.x,ht.y,ht.radius,ht.startAngle,ht.endAngle,ht.counterclockwise,void 0,$,!Et):W.call(this,ht.x,ht.y),Et=!0}else if(ie[we].close===!0)this.pdf.internal.out("h"),Et=!1;else if(ie[we].begin!==!0){var xt=ie[we].start.x,he=ie[we].start.y;J.call(this,ie[we].deltas,xt,he),Et=!0}Ae&&L.call(this,Ae),$&&k.call(this)}},j=function(F){var $=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,re=$*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return F-re;case"top":return F+$-re;case"hanging":return F+$-2*re;case"middle":return F+$/2-re;default:return F}},X=function(F){return F+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};g.prototype.createLinearGradient=function(){var F=function(){};return F.colorStops=[],F.addColorStop=function($,re){this.colorStops.push([$,re])},F.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},F.isCanvasGradient=!0,F},g.prototype.createPattern=function(){return this.createLinearGradient()},g.prototype.createRadialGradient=function(){return this.createLinearGradient()};var G=function(F,$,re,Ae,ie,_e,ke,Fe,We){for(var nt=K.call(this,re,Ae,ie,_e),It=0;It<nt.length;It++){var wt=nt[It];It===0&&(We?U.call(this,wt.x1+F,wt.y1+$):W.call(this,wt.x1+F,wt.y1+$)),ce.call(this,F,$,wt.x2,wt.y2,wt.x3,wt.y3,wt.x4,wt.y4)}Fe?k.call(this):L.call(this,ke)},L=function(F){switch(F){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},k=function(){this.pdf.clip(),this.pdf.discardPath()},U=function(F,$){this.pdf.internal.out(t(F)+" "+n($)+" m")},q=function(F){var $;switch(F.align){case"right":case"end":$="right";break;case"center":$="center";break;default:$="left"}var re,Ae,ie,_e=this.pdf.getTextDimensions(F.text),ke=j.call(this,F.y),Fe=X.call(this,ke)-_e.h,We=this.ctx.transform.applyToPoint(new l(F.x,ke));if(this.autoPaging){var nt=this.ctx.transform.decompose(),It=new f;It=(It=(It=It.multiply(nt.translate)).multiply(nt.skew)).multiply(nt.scale);for(var wt=this.ctx.transform.applyToRectangle(new c(F.x,ke,_e.w,_e.h)),Je=It.applyToRectangle(new c(F.x,Fe,_e.w,_e.h)),le=A.call(this,Je),Qe=[],Et=0;Et<le.length;Et+=1)Qe.indexOf(le[Et])===-1&&Qe.push(le[Et]);D(Qe);for(var we=Qe[0],ot=Qe[Qe.length-1],Ct=we;Ct<ot+1;Ct++){this.pdf.setPage(Ct);var ht=Ct===1?this.posY+this.margin[0]:this.margin[0],xt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],he=this.pdf.internal.pageSize.height-this.margin[2],Q=he-this.margin[0],Be=this.pdf.internal.pageSize.width-this.margin[1],ue=Be-this.margin[3],je=Ct===1?0:xt+(Ct-2)*Q;if(this.ctx.clip_path.length!==0){var Ye=this.path;re=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=R(re,this.posX+this.margin[3],-1*je+ht),z.call(this,"fill",!0),this.path=Ye}var ft=R([JSON.parse(JSON.stringify(Je))],this.posX+this.margin[3],-je+ht+this.ctx.prevPageLastElemOffset)[0];F.scale>=.01&&(Ae=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ae*F.scale),ie=this.lineWidth,this.lineWidth=ie*F.scale);var gt=this.autoPaging!=="text";if(gt||ft.y+ft.h<=he){if(gt||ft.y>=ht&&ft.x<=Be){var Lt=gt?F.text:this.pdf.splitTextToSize(F.text,F.maxWidth||Be-ft.x)[0],un=R([JSON.parse(JSON.stringify(wt))],this.posX+this.margin[3],-je+ht+this.ctx.prevPageLastElemOffset)[0],bt=gt&&(Ct>we||Ct<ot)&&T.call(this);bt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ue,Q,null).clip().discardPath()),this.pdf.text(Lt,un.x,un.y,{angle:F.angle,align:$,renderingMode:F.renderingMode}),bt&&this.pdf.restoreGraphicsState()}}else ft.y<he&&(this.ctx.prevPageLastElemOffset+=he-ft.y);F.scale>=.01&&(this.pdf.setFontSize(Ae),this.lineWidth=ie)}}else F.scale>=.01&&(Ae=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ae*F.scale),ie=this.lineWidth,this.lineWidth=ie*F.scale),this.pdf.text(F.text,We.x+this.posX,We.y+this.posY,{angle:F.angle,align:$,renderingMode:F.renderingMode,maxWidth:F.maxWidth}),F.scale>=.01&&(this.pdf.setFontSize(Ae),this.lineWidth=ie)},W=function(F,$,re,Ae){re=re||0,Ae=Ae||0,this.pdf.internal.out(t(F+re)+" "+n($+Ae)+" l")},J=function(F,$,re){return this.pdf.lines(F,$,re,null,null)},ce=function(F,$,re,Ae,ie,_e,ke,Fe){this.pdf.internal.out([e(r(re+F)),e(s(Ae+$)),e(r(ie+F)),e(s(_e+$)),e(r(ke+F)),e(s(Fe+$)),"c"].join(" "))},K=function(F,$,re,Ae){for(var ie=2*Math.PI,_e=Math.PI/2;$>re;)$-=ie;var ke=Math.abs(re-$);ke<ie&&Ae&&(ke=ie-ke);for(var Fe=[],We=Ae?-1:1,nt=$;ke>1e-5;){var It=nt+We*Math.min(ke,_e);Fe.push(ne.call(this,F,nt,It)),ke-=Math.abs(It-nt),nt=It}return Fe},ne=function(F,$,re){var Ae=(re-$)/2,ie=F*Math.cos(Ae),_e=F*Math.sin(Ae),ke=ie,Fe=-_e,We=ke*ke+Fe*Fe,nt=We+ke*ie+Fe*_e,It=4/3*(Math.sqrt(2*We*nt)-nt)/(ke*_e-Fe*ie),wt=ke-It*Fe,Je=Fe+It*ke,le=wt,Qe=-Je,Et=Ae+$,we=Math.cos(Et),ot=Math.sin(Et);return{x1:F*Math.cos($),y1:F*Math.sin($),x2:wt*we-Je*ot,y2:wt*ot+Je*we,x3:le*we-Qe*ot,y3:le*ot+Qe*we,x4:F*Math.cos(re),y4:F*Math.sin(re)}},pe=function(F){return 180*F/Math.PI},Re=function(F,$,re,Ae,ie,_e){var ke=F+.5*(re-F),Fe=$+.5*(Ae-$),We=ie+.5*(re-ie),nt=_e+.5*(Ae-_e),It=Math.min(F,ie,ke,We),wt=Math.max(F,ie,ke,We),Je=Math.min($,_e,Fe,nt),le=Math.max($,_e,Fe,nt);return new c(It,Je,wt-It,le-Je)},Te=function(F,$,re,Ae,ie,_e,ke,Fe){var We,nt,It,wt,Je,le,Qe,Et,we,ot,Ct,ht,xt,he,Q=re-F,Be=Ae-$,ue=ie-re,je=_e-Ae,Ye=ke-ie,ft=Fe-_e;for(nt=0;nt<41;nt++)we=(Qe=(It=F+(We=nt/40)*Q)+We*((Je=re+We*ue)-It))+We*(Je+We*(ie+We*Ye-Je)-Qe),ot=(Et=(wt=$+We*Be)+We*((le=Ae+We*je)-wt))+We*(le+We*(_e+We*ft-le)-Et),nt==0?(Ct=we,ht=ot,xt=we,he=ot):(Ct=Math.min(Ct,we),ht=Math.min(ht,ot),xt=Math.max(xt,we),he=Math.max(he,ot));return new c(Math.round(Ct),Math.round(ht),Math.round(xt-Ct),Math.round(he-ht))},ee=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var F,$,re=(F=this.ctx.lineDash,$=this.ctx.lineDashOffset,JSON.stringify({lineDash:F,lineDashOffset:$}));this.prevLineDash!==re&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=re)}}})(jn.API),(function(i){var e=function(l){var c,f,d,m,g,y,v,S,T,A;for(f=[],d=0,m=(l+=c="\0\0\0\0".slice(l.length%4||4)).length;m>d;d+=4)(g=(l.charCodeAt(d)<<24)+(l.charCodeAt(d+1)<<16)+(l.charCodeAt(d+2)<<8)+l.charCodeAt(d+3))!==0?(y=(g=((g=((g=((g=(g-(A=g%85))/85)-(T=g%85))/85)-(S=g%85))/85)-(v=g%85))/85)%85,f.push(y+33,v+33,S+33,T+33,A+33)):f.push(122);return(function(w,R){for(var D=R;D>0;D--)w.pop()})(f,c.length),String.fromCharCode.apply(String,f)+"~>"},t=function(l){var c,f,d,m,g,y=String,v="length",S=255,T="charCodeAt",A="slice",w="replace";for(l[A](-2),l=l[A](0,-2)[w](/\s/g,"")[w]("z","!!!!!"),d=[],m=0,g=(l+=c="uuuuu"[A](l[v]%5||5))[v];g>m;m+=5)f=52200625*(l[T](m)-33)+614125*(l[T](m+1)-33)+7225*(l[T](m+2)-33)+85*(l[T](m+3)-33)+(l[T](m+4)-33),d.push(S&f>>24,S&f>>16,S&f>>8,S&f);return(function(R,D){for(var I=D;I>0;I--)R.pop()})(d,c[v]),y.fromCharCode.apply(y,d)},n=function(l){return l.split("").map(function(c){return("0"+c.charCodeAt().toString(16)).slice(-2)}).join("")+">"},r=function(l){var c=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((l=l.replace(/\s/g,"")).indexOf(">")!==-1&&(l=l.substr(0,l.indexOf(">"))),l.length%2&&(l+="0"),c.test(l)===!1)return"";for(var f="",d=0;d<l.length;d+=2)f+=String.fromCharCode("0x"+(l[d]+l[d+1]));return f},s=function(l){for(var c=new Uint8Array(l.length),f=l.length;f--;)c[f]=l.charCodeAt(f);return(c=iS(c)).reduce(function(d,m){return d+String.fromCharCode(m)},"")};i.processDataByFilters=function(l,c){var f=0,d=l||"",m=[];for(typeof(c=c||[])=="string"&&(c=[c]),f=0;f<c.length;f+=1)switch(c[f]){case"ASCII85Decode":case"/ASCII85Decode":d=t(d),m.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=e(d),m.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=r(d),m.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=n(d),m.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=s(d),m.push("/FlateDecode");break;default:throw new Error('The filter: "'+c[f]+'" is not implemented')}return{data:d,reverseChain:m.reverse().join(" ")}}})(jn.API),(function(i){i.loadFile=function(e,t,n){return(function(r,s,l){s=s!==!1,l=typeof l=="function"?l:function(){};var c=void 0;try{c=(function(f,d,m){var g=new XMLHttpRequest,y=0,v=function(S){var T=S.length,A=[],w=String.fromCharCode;for(y=0;y<T;y+=1)A.push(w(255&S.charCodeAt(y)));return A.join("")};if(g.open("GET",f,!d),g.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(g.onload=function(){g.status===200?m(v(this.responseText)):m(void 0)}),g.send(null),d&&g.status===200)return v(g.responseText)})(r,s,l)}catch{}return c})(e,t,n)},i.loadImageFile=i.loadFile})(jn.API),(function(i){function e(){return(hi.html2canvas?Promise.resolve(hi.html2canvas):Qm(()=>import("./html2canvas.esm-DXEQVQnt.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load html2canvas: "+c))}).then(function(c){return c.default?c.default:c})}function t(){return(hi.DOMPurify?Promise.resolve(hi.DOMPurify):Qm(()=>import("./purify.es-Bzr520pe.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load dompurify: "+c))}).then(function(c){return c.default?c.default:c})}var n=function(c){var f=Rr(c);return f==="undefined"?"undefined":f==="string"||c instanceof String?"string":f==="number"||c instanceof Number?"number":f==="function"||c instanceof Function?"function":c&&c.constructor===Array?"array":c&&c.nodeType===1?"element":f==="object"?"object":"unknown"},r=function(c,f){var d=document.createElement(c);for(var m in f.className&&(d.className=f.className),f.innerHTML&&f.dompurify&&(d.innerHTML=f.dompurify.sanitize(f.innerHTML)),f.style)d.style[m]=f.style[m];return d},s=function c(f,d){for(var m=f.nodeType===3?document.createTextNode(f.nodeValue):f.cloneNode(!1),g=f.firstChild;g;g=g.nextSibling)d!==!0&&g.nodeType===1&&g.nodeName==="SCRIPT"||m.appendChild(c(g,d));return f.nodeType===1&&(f.nodeName==="CANVAS"?(m.width=f.width,m.height=f.height,m.getContext("2d").drawImage(f,0,0)):f.nodeName!=="TEXTAREA"&&f.nodeName!=="SELECT"||(m.value=f.value),m.addEventListener("load",function(){m.scrollTop=f.scrollTop,m.scrollLeft=f.scrollLeft},!0)),m},l=function c(f){var d=Object.assign(c.convert(Promise.resolve()),JSON.parse(JSON.stringify(c.template))),m=c.convert(Promise.resolve(),d);return(m=m.setProgress(1,c,1,[c])).set(f)};(l.prototype=Object.create(Promise.prototype)).constructor=l,l.convert=function(c,f){return c.__proto__=f||l.prototype,c},l.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},l.prototype.from=function(c,f){return this.then(function(){switch(f=f||(function(d){switch(n(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(c),f){case"string":return this.then(t).then(function(d){return this.set({src:r("div",{innerHTML:c,dompurify:d})})});case"element":return this.set({src:c});case"canvas":return this.set({canvas:c});case"img":return this.set({img:c});default:return this.error("Unknown source type.")}})},l.prototype.to=function(c){switch(c){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},l.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var c={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},f=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);f.tagName==="BODY"&&(c.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=r("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=r("div",{className:"html2pdf__container",style:c}),this.prop.container.appendChild(f),this.prop.container.firstChild.appendChild(r("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},l.prototype.toCanvas=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(e).then(function(f){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,f(this.prop.container,d)}).then(function(f){(this.opt.html2canvas.onrendered||function(){})(f),this.prop.canvas=f,document.body.removeChild(this.prop.overlay)})},l.prototype.toContext2d=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(e).then(function(f){var d=this.opt.jsPDF,m=this.opt.fontFaces,g=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,y=Object.assign({async:!0,allowTaint:!0,scale:g,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete y.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=m,m)for(var v=0;v<m.length;++v){var S=m[v],T=S.src.find(function(A){return A.format==="truetype"});T&&d.addFont(T.url,S.ref.name,S.ref.style)}return y.windowHeight=y.windowHeight||0,y.windowHeight=y.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):y.windowHeight,d.context2d.save(!0),f(this.prop.container,y)}).then(function(f){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(f),this.prop.canvas=f,document.body.removeChild(this.prop.overlay)})},l.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var c=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=c})},l.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},l.prototype.output=function(c,f,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(c,f):this.outputPdf(c,f)},l.prototype.outputPdf=function(c,f){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(c,f)})},l.prototype.outputImg=function(c){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(c){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+c+'" is not supported.'}})},l.prototype.save=function(c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(c?{filename:c}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},l.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},l.prototype.set=function(c){if(n(c)!=="object")return this;var f=Object.keys(c||{}).map(function(d){if(d in l.template.prop)return function(){this.prop[d]=c[d]};switch(d){case"margin":return this.setMargin.bind(this,c.margin);case"jsPDF":return function(){return this.opt.jsPDF=c.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,c.pageSize);default:return function(){this.opt[d]=c[d]}}},this);return this.then(function(){return this.thenList(f)})},l.prototype.get=function(c,f){return this.then(function(){var d=c in l.template.prop?this.prop[c]:this.opt[c];return f?f(d):d})},l.prototype.setMargin=function(c){return this.then(function(){switch(n(c)){case"number":c=[c,c,c,c];case"array":if(c.length===2&&(c=[c[0],c[1],c[0],c[1]]),c.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=c}).then(this.setPageSize)},l.prototype.setPageSize=function(c){function f(d,m){return Math.floor(d*m/72*96)}return this.then(function(){(c=c||jn.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(c.inner={width:c.width-this.opt.margin[1]-this.opt.margin[3],height:c.height-this.opt.margin[0]-this.opt.margin[2]},c.inner.px={width:f(c.inner.width,c.k),height:f(c.inner.height,c.k)},c.inner.ratio=c.inner.height/c.inner.width),this.prop.pageSize=c})},l.prototype.setProgress=function(c,f,d,m){return c!=null&&(this.progress.val=c),f!=null&&(this.progress.state=f),d!=null&&(this.progress.n=d),m!=null&&(this.progress.stack=m),this.progress.ratio=this.progress.val/this.progress.state,this},l.prototype.updateProgress=function(c,f,d,m){return this.setProgress(c?this.progress.val+c:null,f||null,d?this.progress.n+d:null,m?this.progress.stack.concat(m):null)},l.prototype.then=function(c,f){var d=this;return this.thenCore(c,f,function(m,g){return d.updateProgress(null,null,1,[m]),Promise.prototype.then.call(this,function(y){return d.updateProgress(null,m),y}).then(m,g).then(function(y){return d.updateProgress(1),y})})},l.prototype.thenCore=function(c,f,d){d=d||Promise.prototype.then;var m=this;c&&(c=c.bind(m)),f&&(f=f.bind(m));var g=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?m:l.convert(Object.assign({},m),Promise.prototype),y=d.call(g,c,f);return l.convert(y,m.__proto__)},l.prototype.thenExternal=function(c,f){return Promise.prototype.then.call(this,c,f)},l.prototype.thenList=function(c){var f=this;return c.forEach(function(d){f=f.thenCore(d)}),f},l.prototype.catch=function(c){c&&(c=c.bind(this));var f=Promise.prototype.catch.call(this,c);return l.convert(f,this)},l.prototype.catchExternal=function(c){return Promise.prototype.catch.call(this,c)},l.prototype.error=function(c){return this.then(function(){throw new Error(c)})},l.prototype.using=l.prototype.set,l.prototype.saveAs=l.prototype.save,l.prototype.export=l.prototype.output,l.prototype.run=l.prototype.then,jn.getPageSize=function(c,f,d){if(Rr(c)==="object"){var m=c;c=m.orientation,f=m.unit||f,d=m.format||d}f=f||"mm",d=d||"a4",c=(""+(c||"P")).toLowerCase();var g,y=(""+d).toLowerCase(),v={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(f){case"pt":g=1;break;case"mm":g=72/25.4;break;case"cm":g=72/2.54;break;case"in":g=72;break;case"px":g=.75;break;case"pc":case"em":g=12;break;case"ex":g=6;break;default:throw"Invalid unit: "+f}var S,T=0,A=0;if(v.hasOwnProperty(y))T=v[y][1]/g,A=v[y][0]/g;else try{T=d[1],A=d[0]}catch{throw new Error("Invalid format: "+d)}if(c==="p"||c==="portrait")c="p",A>T&&(S=A,A=T,T=S);else{if(c!=="l"&&c!=="landscape")throw"Invalid orientation: "+c;c="l",T>A&&(S=A,A=T,T=S)}return{width:A,height:T,unit:f,k:g,orientation:c}},i.html=function(c,f){(f=f||{}).callback=f.callback||function(){},f.html2canvas=f.html2canvas||{},f.html2canvas.canvas=f.html2canvas.canvas||this.canvas,f.jsPDF=f.jsPDF||this,f.fontFaces=f.fontFaces?f.fontFaces.map(y_):null;var d=new l(f);return f.worker?d:d.from(c).doCallback()}})(jn.API),jn.API.addJS=function(i){return TA=i,this.internal.events.subscribe("postPutResources",function(){vx=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(vx+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),AA=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+TA+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){vx!==void 0&&AA!==void 0&&this.internal.out("/Names <</JavaScript "+vx+" 0 R>>")}),this},(function(i){var e;i.events.push(["postPutResources",function(){var t=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=t.outline.render().split(/\r\n/),s=0;s<r.length;s++){var l=r[s],c=n.exec(l);if(c!=null){var f=c[1];t.internal.newObjectDeferredBegin(f,!1)}t.internal.write(l)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,m=[];for(s=0;s<d;s++){var g=t.internal.newObject();m.push(g);var y=t.internal.getPageInfo(s+1);t.internal.write("<< /D["+y.objId+" 0 R /XYZ null null null]>> endobj")}var v=t.internal.newObject();for(t.internal.write("<< /Names [ "),s=0;s<m.length;s++)t.internal.write("(page_"+(s+1)+")"+m[s]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+v+" 0 R"),t.internal.write(">>","endobj")}}]),i.events.push(["putCatalog",function(){var t=this;t.outline.root.children.length>0&&(t.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&t.internal.write("/Names "+e+" 0 R"))}]),i.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(n,r,s){var l={title:r,options:s,children:[]};return n==null&&(n=this.root),n.children.push(l),l},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(n){n.id=t.internal.newObjectDeferred();for(var r=0;r<n.children.length;r++)this.genIds_r(n.children[r])},t.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},t.outline.renderItems=function(n){for(var r=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var l=n.children[s];this.objStart(l),this.line("/Title "+this.makeString(l.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),l.children.length>0&&(this.line("/First "+this.makeRef(l.children[0])),this.line("/Last "+this.makeRef(l.children[l.children.length-1])));var c=this.count=this.count_r({count:0},l);if(c>0&&this.line("/Count "+c),l.options&&l.options.pageNumber){var f=t.internal.getPageInfo(l.options.pageNumber);this.line("/Dest ["+f.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var d=0;d<n.children.length;d++)this.renderItems(n.children[d])},t.outline.line=function(n){this.ctx.val+=n+`\r
`},t.outline.makeRef=function(n){return n.id+" 0 R"},t.outline.makeString=function(n){return"("+t.internal.pdfEscape(n)+")"},t.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(n,r){for(var s=0;s<r.children.length;s++)n.count++,this.count_r(n,r.children[s]);return n.count}}])})(jn.API),(function(i){var e=[192,193,194,195,196,197,198,199];i.processJPEG=function(t,n,r,s,l,c){var f,d=this.decode.DCT_DECODE,m=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=l||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,f=(function(g){for(var y,v=256*g.charCodeAt(4)+g.charCodeAt(5),S=g.length,T={width:0,height:0,numcomponents:1},A=4;A<S;A+=2){if(A+=v,e.indexOf(g.charCodeAt(A+1))!==-1){y=256*g.charCodeAt(A+5)+g.charCodeAt(A+6),T={width:256*g.charCodeAt(A+7)+g.charCodeAt(A+8),height:y,numcomponents:g.charCodeAt(A+9)};break}v=256*g.charCodeAt(A+2)+g.charCodeAt(A+3)}return T})(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t),f.numcomponents){case 1:c=this.color_spaces.DEVICE_GRAY;break;case 4:c=this.color_spaces.DEVICE_CMYK;break;case 3:c=this.color_spaces.DEVICE_RGB}m={data:t,width:f.width,height:f.height,colorSpace:c,bitsPerComponent:8,filter:d,index:n,alias:r}}return m}})(jn.API),jn.API.processPNG=function(i,e,t,n){if(this.__addimage__.isArrayBuffer(i)&&(i=new Uint8Array(i)),this.__addimage__.isArrayBufferView(i)){var r,s=Iz(i,{checkCrc:!0}),l=s.width,c=s.height,f=s.channels,d=s.palette,m=s.depth;r=d&&f===1?(function(G){for(var L=G.width,k=G.height,U=G.data,q=G.palette,W=G.depth,J=!1,ce=[],K=[],ne=void 0,pe=!1,Re=0,Te=0;Te<q.length;Te++){var ee=RM(q[Te],4),F=ee[0],$=ee[1],re=ee[2],Ae=ee[3];ce.push(F,$,re),Ae!=null&&(Ae===0?(Re++,K.length<1&&K.push(Te)):Ae<255&&(pe=!0))}if(pe||Re>1){J=!0,K=void 0;var ie=L*k;ne=new Uint8Array(ie);for(var _e=new DataView(U.buffer),ke=0;ke<ie;ke++){var Fe=__(_e,ke,W),We=RM(q[Fe],4)[3];ne[ke]=We}}else Re===0&&(K=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:J?8:void 0,colorBytes:U,alphaBytes:ne,needSMask:J,palette:ce,mask:K}})(s):f===2||f===4?(function(G){for(var L=G.data,k=G.width,U=G.height,q=G.channels,W=G.depth,J=q===2?"DeviceGray":"DeviceRGB",ce=q-1,K=k*U,ne=ce,pe=K*ne,Re=1*K,Te=Math.ceil(pe*W/8),ee=Math.ceil(Re*W/8),F=new Uint8Array(Te),$=new Uint8Array(ee),re=new DataView(L.buffer),Ae=new DataView(F.buffer),ie=new DataView($.buffer),_e=!1,ke=0;ke<K;ke++){for(var Fe=ke*q,We=0;We<ne;We++)kA(Ae,__(re,Fe+We,W),ke*ne+We,W);var nt=__(re,Fe+ne,W);nt<(1<<W)-1&&(_e=!0),kA(ie,nt,1*ke,W)}return{colorSpace:J,colorsPerPixel:ce,sMaskBitsPerComponent:_e?W:void 0,colorBytes:F,alphaBytes:$,needSMask:_e}})(s):(function(G){var L=G.data,k=G.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:k,colorsPerPixel:k==="DeviceGray"?1:3,colorBytes:L instanceof Uint16Array?(function(U){for(var q=U.length,W=new Uint8Array(2*q),J=new DataView(W.buffer,W.byteOffset,W.byteLength),ce=0;ce<q;ce++)J.setUint16(2*ce,U[ce],!1);return W})(L):L,needSMask:!1}})(s);var g,y,v,S=r,T=S.colorSpace,A=S.colorsPerPixel,w=S.sMaskBitsPerComponent,R=S.colorBytes,D=S.alphaBytes,I=S.needSMask,z=S.palette,j=S.mask,X=null;return n!==jn.API.image_compression.NONE&&typeof iS=="function"?(X=(function(G){var L;switch(G){case jn.API.image_compression.FAST:L=11;break;case jn.API.image_compression.MEDIUM:L=13;break;case jn.API.image_compression.SLOW:L=14;break;default:L=12}return L})(n),g=this.decode.FLATE_DECODE,y="/Predictor ".concat(X," /Colors ").concat(A," /BitsPerComponent ").concat(m," /Columns ").concat(l),i=RA(R,Math.ceil(l*A*m/8),A,m,n),I&&(v=RA(D,Math.ceil(l*w/8),1,w,n))):(g=void 0,y=void 0,i=R,I&&(v=D)),(this.__addimage__.isArrayBuffer(i)||this.__addimage__.isArrayBufferView(i))&&(i=this.__addimage__.arrayBufferToBinaryString(i)),(v&&this.__addimage__.isArrayBuffer(v)||this.__addimage__.isArrayBufferView(v))&&(v=this.__addimage__.arrayBufferToBinaryString(v)),{alias:t,data:i,index:e,filter:g,decodeParameters:y,transparency:j,palette:z,sMask:v,predictor:X,width:l,height:c,bitsPerComponent:m,sMaskBitsPerComponent:w,colorSpace:T}}},(function(i){i.processGIF89A=function(e,t,n,r){var s=new e9(e),l=s.width,c=s.height,f=[];s.decodeAndBlitFrameRGBA(0,f);var d={data:f,width:l,height:c},m=new S_(100).encode(d,100);return i.processJPEG.call(this,m,t,n,r)},i.processGIF87A=i.processGIF89A})(jn.API),Iu.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var i=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(i);for(var e=0;e<i;e++){var t=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:r,green:n,blue:t,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Iu.prototype.parseBGR=function(){this.pos=this.offset;try{var i="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[i]()}catch(t){Xr.log("bit decode error:"+t)}},Iu.prototype.bit1=function(){var i,e=Math.ceil(this.width/8),t=e%4;for(i=this.height-1;i>=0;i--){for(var n=this.bottom_up?i:this.height-1-i,r=0;r<e;r++)for(var s=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+8*r*4,c=0;c<8&&8*r+c<this.width;c++){var f=this.palette[s>>7-c&1];this.data[l+4*c]=f.blue,this.data[l+4*c+1]=f.green,this.data[l+4*c+2]=f.red,this.data[l+4*c+3]=255}t!==0&&(this.pos+=4-t)}},Iu.prototype.bit4=function(){for(var i=Math.ceil(this.width/2),e=i%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,r=0;r<i;r++){var s=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+2*r*4,c=s>>4,f=15&s,d=this.palette[c];if(this.data[l]=d.blue,this.data[l+1]=d.green,this.data[l+2]=d.red,this.data[l+3]=255,2*r+1>=this.width)break;d=this.palette[f],this.data[l+4]=d.blue,this.data[l+4+1]=d.green,this.data[l+4+2]=d.red,this.data[l+4+3]=255}e!==0&&(this.pos+=4-e)}},Iu.prototype.bit8=function(){for(var i=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*n;if(r<this.palette.length){var l=this.palette[r];this.data[s]=l.red,this.data[s+1]=l.green,this.data[s+2]=l.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}i!==0&&(this.pos+=4-i)}},Iu.prototype.bit15=function(){for(var i=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(s&e)/e*255|0,c=(s>>5&e)/e*255|0,f=(s>>10&e)/e*255|0,d=s>>15?255:0,m=n*this.width*4+4*r;this.data[m]=f,this.data[m+1]=c,this.data[m+2]=l,this.data[m+3]=d}this.pos+=i}},Iu.prototype.bit16=function(){for(var i=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var c=(l&e)/e*255|0,f=(l>>5&t)/t*255|0,d=(l>>11)/e*255|0,m=r*this.width*4+4*s;this.data[m]=d,this.data[m+1]=f,this.data[m+2]=c,this.data[m+3]=255}this.pos+=i}},Iu.prototype.bit24=function(){for(var i=this.height-1;i>=0;i--){for(var e=this.bottom_up?i:this.height-1-i,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*t;this.data[l]=s,this.data[l+1]=r,this.data[l+2]=n,this.data[l+3]=255}this.pos+=this.width%4}},Iu.prototype.bit32=function(){for(var i=this.height-1;i>=0;i--)for(var e=this.bottom_up?i:this.height-1-i,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),c=e*this.width*4+4*t;this.data[c]=s,this.data[c+1]=r,this.data[c+2]=n,this.data[c+3]=l}},Iu.prototype.getData=function(){return this.data},(function(i){i.processBMP=function(e,t,n,r){var s=new Iu(e,!1),l=s.width,c=s.height,f={data:s.getData(),width:l,height:c},d=new S_(100).encode(f,100);return i.processJPEG.call(this,d,t,n,r)}})(jn.API),BA.prototype.getData=function(){return this.data},(function(i){i.processWEBP=function(e,t,n,r){var s=new BA(e),l=s.width,c=s.height,f={data:s.getData(),width:l,height:c},d=new S_(100).encode(f,100);return i.processJPEG.call(this,d,t,n,r)}})(jn.API),jn.API.processRGBA=function(i,e,t){for(var n=i.data,r=n.length,s=new Uint8Array(r/4*3),l=new Uint8Array(r/4),c=0,f=0,d=0;d<r;d+=4){var m=n[d],g=n[d+1],y=n[d+2],v=n[d+3];s[c++]=m,s[c++]=g,s[c++]=y,l[f++]=v}var S=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:S,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:i.width,height:i.height}},jn.API.setLanguage=function(i){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[i]!==void 0&&(this.internal.languageSettings.languageCode=i,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},jm=jn.API,xx=jm.getCharWidthsArray=function(i,e){var t,n,r=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),l=e.charSpace||this.internal.getCharSpace(),c=e.widths?e.widths:r.metadata.Unicode.widths,f=c.fof?c.fof:1,d=e.kerning?e.kerning:r.metadata.Unicode.kerning,m=d.fof?d.fof:1,g=e.doKerning!==!1,y=0,v=i.length,S=0,T=c[0]||f,A=[];for(t=0;t<v;t++)n=i.charCodeAt(t),typeof r.metadata.widthOfString=="function"?A.push((r.metadata.widthOfGlyph(r.metadata.characterToGlyph(n))+l*(1e3/s)||0)/1e3):(y=g&&Rr(d[n])==="object"&&!isNaN(parseInt(d[n][S],10))?d[n][S]/m:0,A.push((c[n]||T)/f+y)),S=n;return A},EA=jm.getStringUnitWidth=function(i,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),r=e.charSpace||this.internal.getCharSpace();return jm.processArabic&&(i=jm.processArabic(i)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(i,t,r)/t:xx.apply(this,arguments).reduce(function(s,l){return s+l},0)},CA=function(i,e,t,n){for(var r=[],s=0,l=i.length,c=0;s!==l&&c+e[s]<t;)c+=e[s],s++;r.push(i.slice(0,s));var f=s;for(c=0;s!==l;)c+e[s]>n&&(r.push(i.slice(f,s)),c=0,f=s),c+=e[s],s++;return f!==s&&r.push(i.slice(f,s)),r},NA=function(i,e,t){t||(t={});var n,r,s,l,c,f,d,m=[],g=[m],y=t.textIndent||0,v=0,S=0,T=i.split(" "),A=xx.apply(this,[" ",t])[0];if(f=t.lineIndent===-1?T[0].length+2:t.lineIndent||0){var w=Array(f).join(" "),R=[];T.map(function(I){(I=I.split(/\s*\n/)).length>1?R=R.concat(I.map(function(z,j){return(j&&z.length?`
`:"")+z})):R.push(I[0])}),T=R,f=EA.apply(this,[w,t])}for(s=0,l=T.length;s<l;s++){var D=0;if(n=T[s],f&&n[0]==`
`&&(n=n.substr(1),D=1),y+v+(S=(r=xx.apply(this,[n,t])).reduce(function(I,z){return I+z},0))>e||D){if(S>e){for(c=CA.apply(this,[n,r,e-(y+v),e]),m.push(c.shift()),m=[c.pop()];c.length;)g.push([c.shift()]);S=r.slice(n.length-(m[0]?m[0].length:0)).reduce(function(I,z){return I+z},0)}else m=[n];g.push(m),y=S+f,v=A}else m.push(n),y+=v+S,v=A}return d=f?function(I,z){return(z?w:"")+I.join(" ")}:function(I){return I.join(" ")},g.map(d)},jm.splitTextToSize=function(i,e,t){var n,r=(t=t||{}).fontSize||this.internal.getFontSize(),s=(function(m){if(m.widths&&m.kerning)return{widths:m.widths,kerning:m.kerning};var g=this.internal.getFont(m.fontName,m.fontStyle),y="Unicode";return g.metadata[y]?{widths:g.metadata[y].widths||{0:1},kerning:g.metadata[y].kerning||{}}:{font:g.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);n=Array.isArray(i)?i:String(i).split(/\r?\n/);var l=1*this.internal.scaleFactor*e/r;s.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/r:0,s.lineIndent=t.lineIndent;var c,f,d=[];for(c=0,f=n.length;c<f;c++)d=d.concat(NA.apply(this,[n[c],l,s]));return d},(function(i){i.__fontmetrics__=i.__fontmetrics__||{};for(var e="0123456789abcdef",t="klmnopqrstuvwxyz",n={},r={},s=0;s<16;s++)n[t[s]]=e[s],r[e[s]]=t[s];var l=function(y){return"0x"+parseInt(y,10).toString(16)},c=i.__fontmetrics__.compress=function(y){var v,S,T,A,w=["{"];for(var R in y){if(v=y[R],isNaN(parseInt(R,10))?S="'"+R+"'":(R=parseInt(R,10),S=(S=l(R).slice(2)).slice(0,-1)+r[S.slice(-1)]),typeof v=="number")v<0?(T=l(v).slice(3),A="-"):(T=l(v).slice(2),A=""),T=A+T.slice(0,-1)+r[T.slice(-1)];else{if(Rr(v)!=="object")throw new Error("Don't know what to do with value type "+Rr(v)+".");T=c(v)}w.push(S+T)}return w.push("}"),w.join("")},f=i.__fontmetrics__.uncompress=function(y){if(typeof y!="string")throw new Error("Invalid argument passed to uncompress.");for(var v,S,T,A,w={},R=1,D=w,I=[],z="",j="",X=y.length-1,G=1;G<X;G+=1)(A=y[G])=="'"?v?(T=v.join(""),v=void 0):v=[]:v?v.push(A):A=="{"?(I.push([D,T]),D={},T=void 0):A=="}"?((S=I.pop())[0][S[1]]=D,T=void 0,D=S[0]):A=="-"?R=-1:T===void 0?n.hasOwnProperty(A)?(z+=n[A],T=parseInt(z,16)*R,R=1,z=""):z+=A:n.hasOwnProperty(A)?(j+=n[A],D[T]=parseInt(j,16)*R,R=1,T=void 0,j=""):j+=A;return w},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:f("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},m={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},g={Unicode:{"Courier-Oblique":f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":f("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":f("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":f("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:f("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:f("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":f("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:f("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":f("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":f("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":f("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};i.events.push(["addFont",function(y){var v=y.font,S=g.Unicode[v.postScriptName];S&&(v.metadata.Unicode={},v.metadata.Unicode.widths=S.widths,v.metadata.Unicode.kerning=S.kerning);var T=m.Unicode[v.postScriptName];T&&(v.metadata.Unicode.encoding=T,v.encoding=T.codePages[0])}])})(jn.API),(function(i){var e=function(t){for(var n=t.length,r=new Uint8Array(n),s=0;s<n;s++)r[s]=t.charCodeAt(s);return r};i.API.events.push(["addFont",function(t){var n=void 0,r=t.font,s=t.instance;if(!r.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");if(typeof(n=s.existsFileInVFS(r.postScriptName)===!1?s.loadFile(r.postScriptName):s.getFileFromVFS(r.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");(function(l,c){c=/^\x00\x01\x00\x00/.test(c)?e(c):e(Ax(c)),l.metadata=i.API.TTFFont.open(c),l.metadata.Unicode=l.metadata.Unicode||{encoding:{},kerning:{},widths:[]},l.metadata.glyIdsUsed=[0]})(r,n)}}])})(jn),jn.API.addSvgAsImage=function(i,e,t,n,r,s,l,c){if(isNaN(e)||isNaN(t))throw Xr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(r))throw Xr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var f=document.createElement("canvas");f.width=n,f.height=r;var d=f.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,f.width,f.height);var m={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},g=this;return(hi.canvg?Promise.resolve(hi.canvg):Qm(()=>import("./index.es-UrAnlKki.js"),[])).catch(function(y){return Promise.reject(new Error("Could not load canvg: "+y))}).then(function(y){return y.default?y.default:y}).then(function(y){return y.fromString(d,i,m)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(y){return y.render(m)}).then(function(){g.addImage(f.toDataURL("image/jpeg",1),e,t,n,r,l,c)})},jn.API.putTotalPages=function(i){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(i,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(i,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var r=0;r<this.internal.pages[n].length;r++)this.internal.pages[n][r]=this.internal.pages[n][r].replace(e,t);return this},jn.API.viewerPreferences=function(i,e){var t;i=i||{},e=e||!1;var n,r,s,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},c=Object.keys(l),f=[],d=0,m=0,g=0;function y(S,T){var A,w=!1;for(A=0;A<S.length;A+=1)S[A]===T&&(w=!0);return w}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,i==="reset"||e===!0){var v=c.length;for(g=0;g<v;g+=1)t[c[g]].value=t[c[g]].defaultValue,t[c[g]].explicitSet=!1}if(Rr(i)==="object"){for(r in i)if(s=i[r],y(c,r)&&s!==void 0){if(t[r].type==="boolean"&&typeof s=="boolean")t[r].value=s;else if(t[r].type==="name"&&y(t[r].valueSet,s))t[r].value=s;else if(t[r].type==="integer"&&Number.isInteger(s))t[r].value=s;else if(t[r].type==="array"){for(d=0;d<s.length;d+=1)if(n=!0,s[d].length===1&&typeof s[d][0]=="number")f.push(String(s[d]-1));else if(s[d].length>1){for(m=0;m<s[d].length;m+=1)typeof s[d][m]!="number"&&(n=!1);n===!0&&f.push([s[d][0]-1,s[d][1]-1].join(" "))}t[r].value="["+f.join(" ")+"]"}else t[r].value=t[r].defaultValue;t[r].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var S,T=[];for(S in t)t[S].explicitSet===!0&&(t[S].type==="name"?T.push("/"+S+" /"+t[S].value):T.push("/"+S+" "+t[S].value));T.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+T.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},(function(i){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',r=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),l=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),c=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),f=unescape(encodeURIComponent("</x:xmpmeta>")),d=s.length+l.length+c.length+r.length+f.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(r+s+l+c+f),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};i.addMetadata=function(n,r){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:r||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}})(jn.API),(function(i){var e=i.API,t=e.pdfEscape16=function(s,l){for(var c,f=l.metadata.Unicode.widths,d=["","0","00","000","0000"],m=[""],g=0,y=s.length;g<y;++g){if(c=l.metadata.characterToGlyph(s.charCodeAt(g)),l.metadata.glyIdsUsed.push(c),l.metadata.toUnicode[c]=s.charCodeAt(g),f.indexOf(c)==-1&&(f.push(c),f.push([parseInt(l.metadata.widthOfGlyph(c),10)])),c=="0")return m.join("");c=c.toString(16),m.push(d[4-c.length],c)}return m.join("")},n=function(s){var l,c,f,d,m,g,y;for(m=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,f=[],g=0,y=(c=Object.keys(s).sort(function(v,S){return v-S})).length;g<y;g++)l=c[g],f.length>=100&&(m+=`
`+f.length+` beginbfchar
`+f.join(`
`)+`
endbfchar`,f=[]),s[l]!==void 0&&s[l]!==null&&typeof s[l].toString=="function"&&(d=("0000"+s[l].toString(16)).slice(-4),l=("0000"+(+l).toString(16)).slice(-4),f.push("<"+l+"><"+d+">"));return f.length&&(m+=`
`+f.length+` beginbfchar
`+f.join(`
`)+`
endbfchar
`),m+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(l){var c=l.font,f=l.out,d=l.newObject,m=l.putStream;if(c.metadata instanceof i.API.TTFFont&&c.encoding==="Identity-H"){for(var g=c.metadata.Unicode.widths,y=c.metadata.subset.encode(c.metadata.glyIdsUsed,1),v="",S=0;S<y.length;S++)v+=String.fromCharCode(y[S]);var T=d();m({data:v,addLength1:!0,objectId:T}),f("endobj");var A=d();m({data:n(c.metadata.toUnicode),addLength1:!0,objectId:A}),f("endobj");var w=d();f("<<"),f("/Type /FontDescriptor"),f("/FontName /"+qm(c.fontName)),f("/FontFile2 "+T+" 0 R"),f("/FontBBox "+i.API.PDFObject.convert(c.metadata.bbox)),f("/Flags "+c.metadata.flags),f("/StemV "+c.metadata.stemV),f("/ItalicAngle "+c.metadata.italicAngle),f("/Ascent "+c.metadata.ascender),f("/Descent "+c.metadata.decender),f("/CapHeight "+c.metadata.capHeight),f(">>"),f("endobj");var R=d();f("<<"),f("/Type /Font"),f("/BaseFont /"+qm(c.fontName)),f("/FontDescriptor "+w+" 0 R"),f("/W "+i.API.PDFObject.convert(g)),f("/CIDToGIDMap /Identity"),f("/DW 1000"),f("/Subtype /CIDFontType2"),f("/CIDSystemInfo"),f("<<"),f("/Supplement 0"),f("/Registry (Adobe)"),f("/Ordering ("+c.encoding+")"),f(">>"),f(">>"),f("endobj"),c.objectNumber=d(),f("<<"),f("/Type /Font"),f("/Subtype /Type0"),f("/ToUnicode "+A+" 0 R"),f("/BaseFont /"+qm(c.fontName)),f("/Encoding /"+c.encoding),f("/DescendantFonts ["+R+" 0 R]"),f(">>"),f("endobj"),c.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(l){var c=l.font,f=l.out,d=l.newObject,m=l.putStream;if(c.metadata instanceof i.API.TTFFont&&c.encoding==="WinAnsiEncoding"){for(var g=c.metadata.rawData,y="",v=0;v<g.length;v++)y+=String.fromCharCode(g[v]);var S=d();m({data:y,addLength1:!0,objectId:S}),f("endobj");var T=d();m({data:n(c.metadata.toUnicode),addLength1:!0,objectId:T}),f("endobj");var A=d();f("<<"),f("/Descent "+c.metadata.decender),f("/CapHeight "+c.metadata.capHeight),f("/StemV "+c.metadata.stemV),f("/Type /FontDescriptor"),f("/FontFile2 "+S+" 0 R"),f("/Flags 96"),f("/FontBBox "+i.API.PDFObject.convert(c.metadata.bbox)),f("/FontName /"+qm(c.fontName)),f("/ItalicAngle "+c.metadata.italicAngle),f("/Ascent "+c.metadata.ascender),f(">>"),f("endobj"),c.objectNumber=d();for(var w=0;w<c.metadata.hmtx.widths.length;w++)c.metadata.hmtx.widths[w]=parseInt(c.metadata.hmtx.widths[w]*(1e3/c.metadata.head.unitsPerEm));f("<</Subtype/TrueType/Type/Font/ToUnicode "+T+" 0 R/BaseFont/"+qm(c.fontName)+"/FontDescriptor "+A+" 0 R/Encoding/"+c.encoding+" /FirstChar 29 /LastChar 255 /Widths "+i.API.PDFObject.convert(c.metadata.hmtx.widths)+">>"),f("endobj"),c.isAlreadyPutted=!0}})(s)}]);var r=function(s){var l,c=s.text||"",f=s.x,d=s.y,m=s.options||{},g=s.mutex||{},y=g.pdfEscape,v=g.activeFontKey,S=g.fonts,T=v,A="",w=0,R="",D=S[T].encoding;if(S[T].encoding!=="Identity-H")return{text:c,x:f,y:d,options:m,mutex:g};for(R=c,T=v,Array.isArray(c)&&(R=c[0]),w=0;w<R.length;w+=1)S[T].metadata.hasOwnProperty("cmap")&&(l=S[T].metadata.cmap.unicode.codeMap[R[w].charCodeAt(0)]),l||R[w].charCodeAt(0)<256&&S[T].metadata.hasOwnProperty("Unicode")?A+=R[w]:A+="";var I="";return parseInt(T.slice(1))<14||D==="WinAnsiEncoding"?I=y(A,T).split("").map(function(z){return z.charCodeAt(0).toString(16)}).join(""):D==="Identity-H"&&(I=t(A,S[T])),g.isHex=!0,{text:I,x:f,y:d,options:m,mutex:g}};e.events.push(["postProcessText",function(s){var l=s.text||"",c=[],f={text:l,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(l)){var d=0;for(d=0;d<l.length;d+=1)Array.isArray(l[d])&&l[d].length===3?c.push([r(Object.assign({},f,{text:l[d][0]})).text,l[d][1],l[d][2]]):c.push(r(Object.assign({},f,{text:l[d]})).text);s.text=c}else s.text=r(Object.assign({},f,{text:l})).text}])})(jn),(function(i){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};i.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},i.addFileToVFS=function(t,n){return e.call(this),this.internal.vFS[t]=n,this},i.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}})(jn.API),(function(i){i.__bidiEngine__=i.prototype.__bidiEngine__=function(n){var r,s,l,c,f,d,m,g=e,y=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],v=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],S={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},T={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},A=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],w=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),R=!1,D=0;this.__bidiEngine__={};var I=function(U){var q=U.charCodeAt(),W=q>>8,J=T[W];return J!==void 0?g[256*J+(255&q)]:W===252||W===253?"AL":w.test(W)?"L":W===8?"R":"N"},z=function(U){for(var q,W=0;W<U.length;W++){if((q=I(U.charAt(W)))==="L")return!1;if(q==="R")return!0}return!1},j=function(U,q,W,J){var ce,K,ne,pe,Re=q[J];switch(Re){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":R=!1;break;case"N":case"AN":break;case"EN":R&&(Re="AN");break;case"AL":R=!0,Re="R";break;case"WS":case"BN":Re="N";break;case"CS":J<1||J+1>=q.length||(ce=W[J-1])!=="EN"&&ce!=="AN"||(K=q[J+1])!=="EN"&&K!=="AN"?Re="N":R&&(K="AN"),Re=K===ce?K:"N";break;case"ES":Re=(ce=J>0?W[J-1]:"B")==="EN"&&J+1<q.length&&q[J+1]==="EN"?"EN":"N";break;case"ET":if(J>0&&W[J-1]==="EN"){Re="EN";break}if(R){Re="N";break}for(ne=J+1,pe=q.length;ne<pe&&q[ne]==="ET";)ne++;Re=ne<pe&&q[ne]==="EN"?"EN":"N";break;case"NSM":if(l&&!c){for(pe=q.length,ne=J+1;ne<pe&&q[ne]==="NSM";)ne++;if(ne<pe){var Te=U[J],ee=Te>=1425&&Te<=2303||Te===64286;if(ce=q[ne],ee&&(ce==="R"||ce==="AL")){Re="R";break}}}Re=J<1||(ce=q[J-1])==="B"?"N":W[J-1];break;case"B":R=!1,r=!0,Re=D;break;case"S":s=!0,Re="N"}return Re},X=function(U,q,W){var J=U.split("");return W&&G(J,W,{hiLevel:D}),J.reverse(),q&&q.reverse(),J.join("")},G=function(U,q,W){var J,ce,K,ne,pe,Re=-1,Te=U.length,ee=0,F=[],$=D?v:y,re=[];for(R=!1,r=!1,s=!1,ce=0;ce<Te;ce++)re[ce]=I(U[ce]);for(K=0;K<Te;K++){if(pe=ee,F[K]=j(U,re,F,K),J=240&(ee=$[pe][S[F[K]]]),ee&=15,q[K]=ne=$[ee][5],J>0)if(J===16){for(ce=Re;ce<K;ce++)q[ce]=1;Re=-1}else Re=-1;if($[ee][6])Re===-1&&(Re=K);else if(Re>-1){for(ce=Re;ce<K;ce++)q[ce]=ne;Re=-1}re[K]==="B"&&(q[K]=0),W.hiLevel|=ne}s&&(function(Ae,ie,_e){for(var ke=0;ke<_e;ke++)if(Ae[ke]==="S"){ie[ke]=D;for(var Fe=ke-1;Fe>=0&&Ae[Fe]==="WS";Fe--)ie[Fe]=D}})(re,q,Te)},L=function(U,q,W,J,ce){if(!(ce.hiLevel<U)){if(U===1&&D===1&&!r)return q.reverse(),void(W&&W.reverse());for(var K,ne,pe,Re,Te=q.length,ee=0;ee<Te;){if(J[ee]>=U){for(pe=ee+1;pe<Te&&J[pe]>=U;)pe++;for(Re=ee,ne=pe-1;Re<ne;Re++,ne--)K=q[Re],q[Re]=q[ne],q[ne]=K,W&&(K=W[Re],W[Re]=W[ne],W[ne]=K);ee=pe}ee++}}},k=function(U,q,W){var J=U.split(""),ce={hiLevel:D};return W||(W=[]),G(J,W,ce),(function(K,ne,pe){if(pe.hiLevel!==0&&m)for(var Re,Te=0;Te<K.length;Te++)ne[Te]===1&&(Re=A.indexOf(K[Te]))>=0&&(K[Te]=A[Re+1])})(J,W,ce),L(2,J,q,W,ce),L(1,J,q,W,ce),J.join("")};return this.__bidiEngine__.doBidiReorder=function(U,q,W){if((function(ce,K){if(K)for(var ne=0;ne<ce.length;ne++)K[ne]=ne;c===void 0&&(c=z(ce)),d===void 0&&(d=z(ce))})(U,q),l||!f||d)if(l&&f&&c^d)D=c?1:0,U=X(U,q,W);else if(!l&&f&&d)D=c?1:0,U=k(U,q,W),U=X(U,q);else if(!l||c||f||d){if(l&&!f&&c^d)U=X(U,q),c?(D=0,U=k(U,q,W)):(D=1,U=k(U,q,W),U=X(U,q));else if(l&&c&&!f&&d)D=1,U=k(U,q,W),U=X(U,q);else if(!l&&!f&&c^d){var J=m;c?(D=1,U=k(U,q,W),D=0,m=!1,U=k(U,q,W),m=J):(D=0,U=k(U,q,W),U=X(U,q),D=1,m=!1,U=k(U,q,W),m=J,U=X(U,q))}}else D=0,U=k(U,q,W);else D=c?1:0,U=k(U,q,W);return U},this.__bidiEngine__.setOptions=function(U){U&&(l=U.isInputVisual,f=U.isOutputVisual,c=U.isInputRtl,d=U.isOutputRtl,m=U.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new i.__bidiEngine__({isInputVisual:!0});i.API.events.push(["postProcessText",function(n){var r=n.text;n.x,n.y;var s=n.options||{};n.mutex,s.lang;var l=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,t.setOptions(s),Object.prototype.toString.call(r)==="[object Array]"){var c=0;for(l=[],c=0;c<r.length;c+=1)Object.prototype.toString.call(r[c])==="[object Array]"?l.push([t.doBidiReorder(r[c][0]),r[c][1],r[c][2]]):l.push([t.doBidiReorder(r[c])]);n.text=l}else n.text=t.doBidiReorder(r);t.setOptions({isInputVisual:!0})}])})(jn),jn.API.TTFFont=(function(){function i(e){var t;if(this.rawData=e,t=this.contents=new xd(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new m9(this),this.registerTTF()}return i.open=function(e){return new i(e)},i.prototype.parse=function(){return this.directory=new t9(this.contents),this.head=new i9(this),this.name=new l9(this),this.cmap=new cC(this),this.toUnicode={},this.hhea=new r9(this),this.maxp=new c9(this),this.hmtx=new u9(this),this.post=new a9(this),this.os2=new s9(this),this.loca=new p9(this),this.glyf=new f9(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},i.prototype.registerTTF=function(){var e,t,n,r,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var l,c,f,d;for(d=[],l=0,c=(f=this.bbox).length;l<c;l++)e=f[l],d.push(Math.round(e*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(n=255&(r=this.post.italic_angle),32768&(t=r>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},i.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},i.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},i.prototype.widthOfString=function(e,t,n){var r,s,l,c;for(l=0,s=0,c=(e=""+e).length;0<=c?s<c:s>c;s=0<=c?++s:--s)r=e.charCodeAt(s),l+=this.widthOfGlyph(this.characterToGlyph(r))+n*(1e3/t)||0;return l*(t/1e3)},i.prototype.lineHeight=function(e,t){var n;return t==null&&(t=!1),n=t?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},i})();var Vu,xd=(function(){function i(e){this.data=e??[],this.pos=0,this.length=this.data.length}return i.prototype.readByte=function(){return this.data[this.pos++]},i.prototype.writeByte=function(e){return this.data[this.pos++]=e},i.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},i.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},i.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},i.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},i.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},i.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},i.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},i.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},i.prototype.readString=function(e){var t,n;for(n=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)n[t]=String.fromCharCode(this.readByte());return n.join("")},i.prototype.writeString=function(e){var t,n,r;for(r=[],t=0,n=e.length;0<=n?t<n:t>n;t=0<=n?++t:--t)r.push(this.writeByte(e.charCodeAt(t)));return r},i.prototype.readShort=function(){return this.readInt16()},i.prototype.writeShort=function(e){return this.writeInt16(e)},i.prototype.readLongLong=function(){var e,t,n,r,s,l,c,f;return e=this.readByte(),t=this.readByte(),n=this.readByte(),r=this.readByte(),s=this.readByte(),l=this.readByte(),c=this.readByte(),f=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^n)+4294967296*(255^r)+16777216*(255^s)+65536*(255^l)+256*(255^c)+(255^f)+1):72057594037927940*e+281474976710656*t+1099511627776*n+4294967296*r+16777216*s+65536*l+256*c+f},i.prototype.writeLongLong=function(e){var t,n;return t=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},i.prototype.readInt=function(){return this.readInt32()},i.prototype.writeInt=function(e){return this.writeInt32(e)},i.prototype.read=function(e){var t,n;for(t=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)t.push(this.readByte());return t},i.prototype.write=function(e){var t,n,r,s;for(s=[],n=0,r=e.length;n<r;n++)t=e[n],s.push(this.writeByte(t));return s},i})(),t9=(function(){var i;function e(t){var n,r,s;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},r=0,s=this.tableCount;0<=s?r<s:r>s;r=0<=s?++r:--r)n={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(t){var n,r,s,l,c,f,d,m,g,y,v,S,T;for(T in v=Object.keys(t).length,f=Math.log(2),g=16*Math.floor(Math.log(v)/f),l=Math.floor(g/f),m=16*v-g,(r=new xd).writeInt(this.scalarType),r.writeShort(v),r.writeShort(g),r.writeShort(l),r.writeShort(m),s=16*v,d=r.pos+s,c=null,S=[],t)for(y=t[T],r.writeString(T),r.writeInt(i(y)),r.writeInt(d),r.writeInt(y.length),S=S.concat(y),T==="head"&&(c=d),d+=y.length;d%4;)S.push(0),d++;return r.write(S),n=2981146554-i(r.data),r.pos=c+8,r.writeUInt32(n),r.data},i=function(t){var n,r,s,l;for(t=uC.call(t);t.length%4;)t.push(0);for(s=new xd(t),r=0,n=0,l=t.length;n<l;n=n+=4)r+=s.readUInt32();return 4294967295&r},e})(),n9={}.hasOwnProperty,Bf=function(i,e){for(var t in e)n9.call(e,t)&&(i[t]=e[t]);function n(){this.constructor=i}return n.prototype=e.prototype,i.prototype=new n,i.__super__=e.prototype,i};Vu=(function(){function i(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return i.prototype.parse=function(){},i.prototype.encode=function(){},i.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},i})();var i9=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Bf(i,Vu),i.prototype.tag="head",i.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},i.prototype.encode=function(e){var t;return(t=new xd).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},i})(),UA=(function(){function i(e,t){var n,r,s,l,c,f,d,m,g,y,v,S,T,A,w,R,D;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),g=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(f=0;f<256;++f)this.codeMap[f]=e.readByte();break;case 4:for(v=e.readUInt16(),y=v/2,e.pos+=6,s=(function(){var I,z;for(z=[],f=I=0;0<=y?I<y:I>y;f=0<=y?++I:--I)z.push(e.readUInt16());return z})(),e.pos+=2,T=(function(){var I,z;for(z=[],f=I=0;0<=y?I<y:I>y;f=0<=y?++I:--I)z.push(e.readUInt16());return z})(),d=(function(){var I,z;for(z=[],f=I=0;0<=y?I<y:I>y;f=0<=y?++I:--I)z.push(e.readUInt16());return z})(),m=(function(){var I,z;for(z=[],f=I=0;0<=y?I<y:I>y;f=0<=y?++I:--I)z.push(e.readUInt16());return z})(),r=(this.length-e.pos+this.offset)/2,c=(function(){var I,z;for(z=[],f=I=0;0<=r?I<r:I>r;f=0<=r?++I:--I)z.push(e.readUInt16());return z})(),f=w=0,D=s.length;w<D;f=++w)for(A=s[f],n=R=S=T[f];S<=A?R<=A:R>=A;n=S<=A?++R:--R)m[f]===0?l=n+d[f]:(l=c[m[f]/2+(n-S)-(y-f)]||0)!==0&&(l+=d[f]),this.codeMap[n]=65535&l}e.pos=g}return i.encode=function(e,t){var n,r,s,l,c,f,d,m,g,y,v,S,T,A,w,R,D,I,z,j,X,G,L,k,U,q,W,J,ce,K,ne,pe,Re,Te,ee,F,$,re,Ae,ie,_e,ke,Fe,We,nt,It;switch(J=new xd,l=Object.keys(e).sort(function(wt,Je){return wt-Je}),t){case"macroman":for(T=0,A=(function(){var wt=[];for(S=0;S<256;++S)wt.push(0);return wt})(),R={0:0},s={},ce=0,Re=l.length;ce<Re;ce++)R[Fe=e[r=l[ce]]]==null&&(R[Fe]=++T),s[r]={old:e[r],new:R[e[r]]},A[r]=R[e[r]];return J.writeUInt16(1),J.writeUInt16(0),J.writeUInt32(12),J.writeUInt16(0),J.writeUInt16(262),J.writeUInt16(0),J.write(A),{charMap:s,subtable:J.data,maxGlyphID:T+1};case"unicode":for(q=[],g=[],D=0,R={},n={},w=d=null,K=0,Te=l.length;K<Te;K++)R[z=e[r=l[K]]]==null&&(R[z]=++D),n[r]={old:z,new:R[z]},c=R[z]-r,w!=null&&c===d||(w&&g.push(w),q.push(r),d=c),w=r;for(w&&g.push(w),g.push(65535),q.push(65535),k=2*(L=q.length),G=2*Math.pow(Math.log(L)/Math.LN2,2),y=Math.log(G/2)/Math.LN2,X=2*L-G,f=[],j=[],v=[],S=ne=0,ee=q.length;ne<ee;S=++ne){if(U=q[S],m=g[S],U===65535){f.push(0),j.push(0);break}if(U-(W=n[U].new)>=32768)for(f.push(0),j.push(2*(v.length+L-S)),r=pe=U;U<=m?pe<=m:pe>=m;r=U<=m?++pe:--pe)v.push(n[r].new);else f.push(W-U),j.push(0)}for(J.writeUInt16(3),J.writeUInt16(1),J.writeUInt32(12),J.writeUInt16(4),J.writeUInt16(16+8*L+2*v.length),J.writeUInt16(0),J.writeUInt16(k),J.writeUInt16(G),J.writeUInt16(y),J.writeUInt16(X),_e=0,F=g.length;_e<F;_e++)r=g[_e],J.writeUInt16(r);for(J.writeUInt16(0),ke=0,$=q.length;ke<$;ke++)r=q[ke],J.writeUInt16(r);for(We=0,re=f.length;We<re;We++)c=f[We],J.writeUInt16(c);for(nt=0,Ae=j.length;nt<Ae;nt++)I=j[nt],J.writeUInt16(I);for(It=0,ie=v.length;It<ie;It++)T=v[It],J.writeUInt16(T);return{charMap:n,subtable:J.data,maxGlyphID:D+1}}},i})(),cC=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Bf(i,Vu),i.prototype.tag="cmap",i.prototype.parse=function(e){var t,n,r;for(e.pos=this.offset,this.version=e.readUInt16(),r=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=r?n<r:n>r;n=0<=r?++n:--n)t=new UA(e,this.offset),this.tables.push(t),t.isUnicode&&this.unicode==null&&(this.unicode=t);return!0},i.encode=function(e,t){var n,r;return t==null&&(t="macroman"),n=UA.encode(e,t),(r=new xd).writeUInt16(0),r.writeUInt16(1),n.table=r.data.concat(n.subtable),n},i})(),r9=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Bf(i,Vu),i.prototype.tag="hhea",i.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},i})(),s9=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Bf(i,Vu),i.prototype.tag="OS/2",i.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var t,n;for(n=[],t=0;t<10;++t)n.push(e.readByte());return n})(),this.charRange=(function(){var t,n;for(n=[],t=0;t<4;++t)n.push(e.readInt());return n})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var t,n;for(n=[],t=0;t<2;t=++t)n.push(e.readInt());return n})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},i})(),a9=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Bf(i,Vu),i.prototype.tag="post",i.prototype.parse=function(e){var t,n,r;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(n=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],r=[];e.pos<this.offset+this.length;)t=e.readByte(),r.push(this.names.push(e.readString(t)));return r;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var l,c,f;for(f=[],s=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;s=0<=c?++l:--l)f.push(e.readUInt32());return f}).call(this)}},i})(),o9=function(i,e){this.raw=i,this.length=i.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},l9=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Bf(i,Vu),i.prototype.tag="name",i.prototype.parse=function(e){var t,n,r,s,l,c,f,d,m,g,y;for(e.pos=this.offset,e.readShort(),t=e.readShort(),c=e.readShort(),n=[],s=0;0<=t?s<t:s>t;s=0<=t?++s:--s)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+c+e.readShort()});for(f={},s=m=0,g=n.length;m<g;s=++m)r=n[s],e.pos=r.offset,d=e.readString(r.length),l=new o9(d,r),f[y=r.nameID]==null&&(f[y]=[]),f[r.nameID].push(l);this.strings=f,this.copyright=f[0],this.fontFamily=f[1],this.fontSubfamily=f[2],this.uniqueSubfamily=f[3],this.fontName=f[4],this.version=f[5];try{this.postscriptName=f[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=f[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=f[7],this.manufacturer=f[8],this.designer=f[9],this.description=f[10],this.vendorUrl=f[11],this.designerUrl=f[12],this.license=f[13],this.licenseUrl=f[14],this.preferredFamily=f[15],this.preferredSubfamily=f[17],this.compatibleFull=f[18],this.sampleText=f[19]},i})(),c9=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Bf(i,Vu),i.prototype.tag="maxp",i.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},i})(),u9=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Bf(i,Vu),i.prototype.tag="hmtx",i.prototype.parse=function(e){var t,n,r,s,l,c,f;for(e.pos=this.offset,this.metrics=[],t=0,c=this.file.hhea.numberOfMetrics;0<=c?t<c:t>c;t=0<=c?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(r=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var d,m;for(m=[],t=d=0;0<=r?d<r:d>r;t=0<=r?++d:--d)m.push(e.readInt16());return m})(),this.widths=(function(){var d,m,g,y;for(y=[],d=0,m=(g=this.metrics).length;d<m;d++)s=g[d],y.push(s.advance);return y}).call(this),n=this.widths[this.widths.length-1],f=[],t=l=0;0<=r?l<r:l>r;t=0<=r?++l:--l)f.push(this.widths.push(n));return f},i.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},i})(),uC=[].slice,f9=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Bf(i,Vu),i.prototype.tag="glyf",i.prototype.parse=function(){return this.cache={}},i.prototype.glyphFor=function(e){var t,n,r,s,l,c,f,d,m,g;return e in this.cache?this.cache[e]:(s=this.file.loca,t=this.file.contents,n=s.indexOf(e),(r=s.lengthOf(e))===0?this.cache[e]=null:(t.pos=this.offset+n,l=(c=new xd(t.read(r))).readShort(),d=c.readShort(),g=c.readShort(),f=c.readShort(),m=c.readShort(),this.cache[e]=l===-1?new d9(c,d,g,f,m):new h9(c,l,d,g,f,m),this.cache[e]))},i.prototype.encode=function(e,t,n){var r,s,l,c,f;for(l=[],s=[],c=0,f=t.length;c<f;c++)r=e[t[c]],s.push(l.length),r&&(l=l.concat(r.encode(n)));return s.push(l.length),{table:l,offsets:s}},i})(),h9=(function(){function i(e,t,n,r,s,l){this.raw=e,this.numberOfContours=t,this.xMin=n,this.yMin=r,this.xMax=s,this.yMax=l,this.compound=!1}return i.prototype.encode=function(){return this.raw.data},i})(),d9=(function(){function i(e,t,n,r,s){var l,c;for(this.raw=e,this.xMin=t,this.yMin=n,this.xMax=r,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;c=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&c;)l.pos+=1&c?4:2,128&c?l.pos+=8:64&c?l.pos+=4:8&c&&(l.pos+=2)}return i.prototype.encode=function(){var e,t,n;for(t=new xd(uC.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)t.pos=this.glyphOffsets[e];return t.data},i})(),p9=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Bf(i,Vu),i.prototype.tag="loca",i.prototype.parse=function(e){var t,n;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=t===0?(function(){var r,s;for(s=[],n=0,r=this.length;n<r;n+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var r,s;for(s=[],n=0,r=this.length;n<r;n+=4)s.push(e.readUInt32());return s}).call(this)},i.prototype.indexOf=function(e){return this.offsets[e]},i.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},i.prototype.encode=function(e,t){for(var n=new Uint32Array(this.offsets.length),r=0,s=0,l=0;l<n.length;++l)if(n[l]=r,s<t.length&&t[s]==l){++s,n[l]=r;var c=this.offsets[l],f=this.offsets[l+1]-c;f>0&&(r+=f)}for(var d=new Array(4*n.length),m=0;m<n.length;++m)d[4*m+3]=255&n[m],d[4*m+2]=(65280&n[m])>>8,d[4*m+1]=(16711680&n[m])>>16,d[4*m]=(4278190080&n[m])>>24;return d},i})(),m9=(function(){function i(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return i.prototype.generateCmap=function(){var e,t,n,r,s;for(t in r=this.font.cmap.tables[0].codeMap,e={},s=this.subset)n=s[t],e[t]=r[n];return e},i.prototype.glyphsFor=function(e){var t,n,r,s,l,c,f;for(r={},l=0,c=e.length;l<c;l++)r[s=e[l]]=this.font.glyf.glyphFor(s);for(s in t=[],r)(n=r[s])!=null&&n.compound&&t.push.apply(t,n.glyphIDs);if(t.length>0)for(s in f=this.glyphsFor(t))n=f[s],r[s]=n;return r},i.prototype.encode=function(e,t){var n,r,s,l,c,f,d,m,g,y,v,S,T,A,w;for(r in n=cC.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(e),v={0:0},w=n.charMap)v[(f=w[r]).old]=f.new;for(S in y=n.maxGlyphID,l)S in v||(v[S]=y++);return m=(function(R){var D,I;for(D in I={},R)I[R[D]]=D;return I})(v),g=Object.keys(m).sort(function(R,D){return R-D}),T=(function(){var R,D,I;for(I=[],R=0,D=g.length;R<D;R++)c=g[R],I.push(m[c]);return I})(),s=this.font.glyf.encode(l,T,v),d=this.font.loca.encode(s.offsets,T),A={cmap:this.font.cmap.raw(),glyf:s.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(A["OS/2"]=this.font.os2.raw()),this.font.directory.encode(A)},i})();jn.API.PDFObject=(function(){var i;function e(){}return i=function(t,n){return(Array(n+1).join("0")+t).slice(-n)},e.convert=function(t){var n,r,s,l;if(Array.isArray(t))return"["+(function(){var c,f,d;for(d=[],c=0,f=t.length;c<f;c++)n=t[c],d.push(e.convert(n));return d})().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t?.isString)return"("+t+")";if(t instanceof Date)return"(D:"+i(t.getUTCFullYear(),4)+i(t.getUTCMonth(),2)+i(t.getUTCDate(),2)+i(t.getUTCHours(),2)+i(t.getUTCMinutes(),2)+i(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(r in s=["<<"],t)l=t[r],s.push("/"+r+" "+e.convert(l));return s.push(">>"),s.join(`
`)}return""+t},e})();const fC=async(i="Young Scientist")=>{console.log("Generating certificate for:",i);try{const e=new jn({orientation:"landscape",unit:"mm",format:"a4"}),t=e.internal.pageSize.getWidth(),n=e.internal.pageSize.getHeight();e.setFillColor(255,255,255),e.rect(0,0,t,n,"F"),e.setFillColor(240,245,255),e.triangle(0,0,60,0,0,60,"F"),e.triangle(t,n,t-60,n,t,n-60,"F"),e.setDrawColor(20,40,100),e.setLineWidth(3),e.rect(8,8,t-16,n-16,"D"),e.setDrawColor(218,165,32),e.setLineWidth(.5),e.rect(10,10,t-20,n-20,"D"),e.setTextColor(20,40,100),e.setFont("times","bold"),e.setFontSize(40),e.text("CERTIFICATE OF COMPLETION",t/2,45,{align:"center"}),e.setDrawColor(218,165,32),e.setLineWidth(1.2),e.line(t/2-80,50,t/2+80,50),e.setFontSize(20),e.setFont("helvetica","bold"),e.setTextColor(100,100,120),e.text("3D CHEMISTRY LAB",t/2,65,{align:"center"}),e.setTextColor(60,60,60),e.setFontSize(20),e.setFont("helvetica","normal"),e.text("This certificate is proudly presented to",t/2,88,{align:"center"}),e.setTextColor(20,40,100),e.setFontSize(54),e.setFont("times","bolditalic"),e.text(i.toUpperCase(),t/2,115,{align:"center"}),e.setDrawColor(218,165,32),e.setLineWidth(.8),e.line(t/2-90,120,t/2+90,120),e.setTextColor(80,80,80),e.setFontSize(18),e.setFont("helvetica","normal"),e.text("For showing the curiosity and precision of a true Young Scientist",t/2,140,{align:"center"}),e.text("while successfully completing all interactive experiments in the 3D Chemistry Lab.",t/2,150,{align:"center"});const r="https://sciencefunstudents.weebly.com/";e.setTextColor(0,102,204),e.setFontSize(16),e.setFont("helvetica","bold"),e.text(r,t/2,n-32,{align:"center"});const s=e.getTextWidth(r);e.link(t/2-s/2,n-38,s,10,{url:r}),e.setTextColor(120,120,120),e.setFontSize(13),e.setFont("helvetica","normal");const l=new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});e.text(`Official Completion Date: ${l}`,t/2,n-15,{align:"center"}),console.log("Saving PDF..."),e.save(`Completion_Certificate_${i.replace(/\s+/g,"_")}.pdf`),console.log("Certificate generated and download triggered successfully.")}catch(e){console.error("Error generating certificate:",e),alert("Sorry, there was an error generating your certificate. Please check the console for details.")}};function g9(){const[i,e]=ge.useState(6),t=De(A=>A.loadExperiment),n=De(A=>A.completedExperiments),r=De(A=>A.setExperimentMode),[s,l]=ge.useState({x:0,y:0}),c=A=>{const{clientX:w,clientY:R}=A,D=(w/window.innerWidth-.5)*20,I=(R/window.innerHeight-.5)*20;l({x:D,y:I})},f=A=>{const{currentTarget:w,clientX:R,clientY:D}=A,I=w.getBoundingClientRect(),z=R-I.left,j=D-I.top;w.style.setProperty("--mouse-x",`${z}px`),w.style.setProperty("--mouse-y",`${j}px`)},d=rU(i),m=sU(),g=n.length,y=g>=m,v=async()=>{const A=window.prompt("Please enter your full name for the certificate:");A&&A.trim()&&await fC(A.trim())},S=A=>{t(A)},T=()=>{r("sandbox")};return _.jsxs("div",{className:"dashboard-container",onMouseMove:c,children:[_.jsxs("div",{className:"dashboard-layout",children:[_.jsxs("aside",{className:"dashboard-sidebar",children:[_.jsxs("div",{className:"brand-header",children:[_.jsx("div",{className:"brand-logo",children:_.jsx("span",{className:"logo-icon",children:""})}),_.jsx("h1",{className:"brand-title",children:"3D Chemistry Lab"}),_.jsx("p",{className:"brand-subtitle",children:"Interactive Science Simulation"})]}),_.jsxs("div",{className:"hero-card",onClick:T,children:[_.jsxs("div",{className:"hero-content",children:[_.jsx("h2",{className:"hero-title",children:"Mix & Play"}),_.jsx("p",{className:"hero-desc",children:"The open sandbox for your curiosity."}),_.jsx("button",{className:"hero-btn",children:"Enter Sandbox"})]}),_.jsx("div",{className:"hero-visual",children:_.jsxs("svg",{viewBox:"0 0 100 120",className:"beaker-svg",children:[_.jsxs("defs",{children:[_.jsxs("linearGradient",{id:"liquidHero",x1:"0%",y1:"100%",x2:"0%",y2:"0%",children:[_.jsx("stop",{offset:"0%",stopColor:"#FF375F"}),_.jsx("stop",{offset:"100%",stopColor:"#FF9F0A"})]}),_.jsxs("filter",{id:"glowHero",children:[_.jsx("feGaussianBlur",{stdDeviation:"4",result:"coloredBlur"}),_.jsxs("feMerge",{children:[_.jsx("feMergeNode",{in:"coloredBlur"}),_.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),_.jsx("path",{d:"M30 30 L30 45 L25 85 Q23 95 33 95 L67 95 Q77 95 75 85 L70 45 L70 30",fill:"rgba(255,255,255,0.05)",stroke:"rgba(255,255,255,0.4)",strokeWidth:"2"}),_.jsx("path",{d:"M28 30 L72 30",stroke:"rgba(255,255,255,0.4)",strokeWidth:"2",strokeLinecap:"round"}),_.jsx("path",{d:"M29 52 L26 85 Q24 93 33 93 L67 93 Q76 93 74 85 L71 52 Q50 58 29 52",fill:"url(#liquidHero)",opacity:"0.4",style:{filter:"brightness(0.7)"},children:_.jsx("animate",{attributeName:"d",values:`M29 52 L26 85 Q24 93 33 93 L67 93 Q76 93 74 85 L71 52 Q50 58 29 52;\r
                                                M29 50 L26 85 Q24 93 33 93 L67 93 Q76 93 74 85 L71 50 Q50 45 29 50;\r
                                                M29 52 L26 85 Q24 93 33 93 L67 93 Q76 93 74 85 L71 52 Q50 58 29 52`,dur:"5s",repeatCount:"indefinite",begin:"-2s"})}),_.jsx("path",{d:"M29 50 L26 85 Q24 93 33 93 L67 93 Q76 93 74 85 L71 50 Q50 55 29 50",fill:"url(#liquidHero)",opacity:"0.9",filter:"url(#glowHero)",children:_.jsx("animate",{attributeName:"d",values:`M29 50 L26 85 Q24 93 33 93 L67 93 Q76 93 74 85 L71 50 Q50 55 29 50;\r
                                                M29 52 L26 85 Q24 93 33 93 L67 93 Q76 93 74 85 L71 52 Q50 48 29 52;\r
                                                M29 50 L26 85 Q24 93 33 93 L67 93 Q76 93 74 85 L71 50 Q50 55 29 50`,dur:"4s",repeatCount:"indefinite"})}),_.jsxs("circle",{cx:"40",cy:"70",r:"3",fill:"white",opacity:"0.6",children:[_.jsx("animate",{attributeName:"cy",values:"70;40",dur:"2s",repeatCount:"indefinite"}),_.jsx("animate",{attributeName:"opacity",values:"0.6;0",dur:"2s",repeatCount:"indefinite"})]}),_.jsxs("circle",{cx:"60",cy:"80",r:"2",fill:"white",opacity:"0.5",children:[_.jsx("animate",{attributeName:"cy",values:"80;45",dur:"1.5s",repeatCount:"indefinite",begin:"0.5s"}),_.jsx("animate",{attributeName:"opacity",values:"0.5;0",dur:"1.5s",repeatCount:"indefinite",begin:"0.5s"})]}),_.jsx("circle",{cx:"50",cy:"60",r:"4",fill:"white",opacity:"0.4",children:_.jsx("animate",{attributeName:"cy",values:"60;35",dur:"3s",repeatCount:"indefinite",begin:"1s"})})]})})]}),_.jsxs("div",{className:"stats-box",children:[_.jsxs("div",{className:"stat-item",children:[_.jsx("span",{className:"stat-val",children:g}),_.jsx("span",{className:"stat-label",children:"Done"})]}),_.jsx("div",{className:"stat-divider"}),_.jsxs("div",{className:"stat-item",children:[_.jsx("span",{className:"stat-val",children:m}),_.jsx("span",{className:"stat-label",children:"Total"})]}),y&&_.jsx("button",{className:"mini-cert-btn",onClick:v,children:" Get Cert"})]})]}),_.jsxs("main",{className:"dashboard-main",children:[_.jsx("div",{className:"segmented-control",children:[6,7,8,10].map(A=>_.jsxs("button",{className:`segment-btn ${i===A?"active":""}`,onClick:()=>e(A),children:["Class ",A]},A))}),_.jsx("div",{className:"bento-grid",children:d.map((A,w)=>{const R=n.includes(A.id),D=`${w*50}ms`;return _.jsxs("div",{className:`bento-card ${R?"completed":""}`,onClick:()=>S(A.id),onMouseMove:f,style:{animationDelay:D},children:[_.jsx("div",{className:"spotlight-glow"}),_.jsx("div",{className:"bento-icon",children:R?"":w+1}),_.jsxs("div",{className:"bento-info",children:[_.jsx("h3",{className:"bento-title",children:A.title}),_.jsx("p",{className:"bento-chapter",children:A.chapter})]}),_.jsx("div",{className:"bento-status",children:R?_.jsx("span",{className:"status-badge done",children:"Complete"}):_.jsx("span",{className:"status-badge todo",children:"Start"})})]},A.id)})})]})]}),_.jsx("style",{children:`
                /* ALCHEMIST DASHBOARD CSS SYSTEM */
                :root {
                    --bg-dark: #050505;
                    --glass-panel: rgba(20, 20, 23, 0.6);
                    --glass-border: rgba(255, 255, 255, 0.08);
                    --accent: #3b82f6;
                    --text-main: #ffffff;
                    --text-dim: #a1a1aa;
                }

                .dashboard-container {
                    min-height: 100vh;
                    background-color: var(--bg-dark);
                    color: var(--text-main);
                    font-family: 'Inter', system-ui, sans-serif;
                    overflow: hidden;
                    position: relative;
                    /* Cinematic Grain Overlay */
                    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
                }
                
                /* Ambient Background */
                .ambient-background {
                    position: absolute;
                    inset: 0;
                    overflow: hidden;
                    pointer-events: none;
                    perspective: 1000px;
                }
                .orb {
                    position: absolute;
                    border-radius: 50%;
                    filter: blur(80px);
                    opacity: 0.4;
                    /* Animation Removed - Handled via JS Parallax */
                    transition: transform 0.1s linear;
                    will-change: transform;
                }
                .orb-1 { width: 400px; height: 400px; background: #4f46e5; top: -100px; left: -100px; }
                .orb-2 { width: 500px; height: 500px; background: #ec4899; bottom: -100px; right: -100px; animation-delay: -5s; }
                .orb-3 { width: 300px; height: 300px; background: #06b6d4; top: 40%; left: 50%; transform: translate(-50%, -50%); animation-delay: -10s; opacity: 0.2; }
                
                @keyframes orbFloat {
                    0%, 100% { transform: translate(0, 0); }
                    33% { transform: translate(30px, -50px); }
                    66% { transform: translate(-20px, 20px); }
                }

                /* Layout */
                .dashboard-layout {
                    display: grid;
                    grid-template-columns: 320px 1fr;
                    height: 100vh;
                    max-width: 1600px;
                    margin: 0 auto;
                    gap: 2rem;
                    padding: 2rem;
                    position: relative;
                    z-index: 10;
                }

                /* Sidebar */
                .dashboard-sidebar {
                    display: flex;
                    flex-direction: column;
                    gap: 1.5rem;
                }

                .brand-header {
                    padding: 1rem 0;
                }
                .brand-title {
                    font-size: 1.5rem;
                    font-weight: 800;
                    letter-spacing: -0.02em;
                    background: linear-gradient(135deg, #fff 30%, #94a3b8);
                    -webkit-background-clip: text;
                    -webkit-text-fill-color: transparent;
                }
                .brand-subtitle {
                    color: var(--text-dim);
                    font-size: 0.875rem;
                }

                /* Hero Card */
                .hero-card {
                    background: linear-gradient(145deg, rgba(30,30,35,0.8), rgba(20,20,25,0.9));
                    border: 1px solid var(--glass-border);
                    border-radius: 24px;
                    padding: 2rem;
                    flex: 1;
                    position: relative;
                    overflow: hidden;
                    cursor: pointer;
                    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
                    display: flex;
                    flex-direction: column;
                    justify-content: space-between;
                }
                .hero-card:hover {
                    border-color: rgba(255,255,255,0.2);
                    transform: translateY(-4px);
                    box-shadow: 0 20px 40px rgba(0,0,0,0.4);
                }
                .hero-card:hover .beaker-svg {
                    transform: scale(1.1) rotate(5deg);
                }

                .hero-title {
                    font-size: 2rem;
                    font-weight: 700;
                    margin-bottom: 0.5rem;
                }
                .hero-desc {
                    color: var(--text-dim);
                    margin-bottom: 2rem;
                }
                .hero-btn {
                    background: white;
                    color: black;
                    border: none;
                    padding: 0.75rem 1.75rem;
                    border-radius: 99px;
                    font-weight: 700;
                    width: fit-content;
                    cursor: pointer;
                    /* Pulse Animation */
                    box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.4);
                    animation: heroPulse 3s infinite;
                }
                @keyframes heroPulse {
                    0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.4); }
                    70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(255, 255, 255, 0); }
                    100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 255, 255, 0); }
                }
                .hero-visual {
                    position: absolute;
                    bottom: -20px;
                    right: -20px;
                    width: 180px;
                    height: 180px;
                    pointer-events: none;
                }
                .beaker-svg {
                    width: 100%;
                    height: 100%;
                    transition: transform 0.5s ease;
                }

                /* Stats Box */
                .stats-box {
                    background: rgba(255,255,255,0.03);
                    border: 1px solid var(--glass-border);
                    border-radius: 20px;
                    padding: 1.5rem;
                    display: flex;
                    align-items: center;
                    justify-content: space-around;
                    backdrop-filter: blur(10px);
                }
                .stat-item {
                    text-align: center;
                }
                .stat-val {
                    display: block;
                    font-size: 1.5rem;
                    font-weight: 700;
                    color: var(--text-main);
                }
                .stat-label {
                    font-size: 0.75rem;
                    color: var(--text-dim);
                    text-transform: uppercase;
                    letter-spacing: 1px;
                }
                .stat-divider {
                    width: 1px;
                    height: 40px;
                    background: var(--glass-border);
                }
                .mini-cert-btn {
                    font-size: 0.8rem;
                    background: rgba(255,215,0,0.1);
                    color: #ffd700;
                    border: 1px solid rgba(255,215,0,0.3);
                    padding: 0.4rem 0.8rem;
                    border-radius: 8px;
                    cursor: pointer;
                }

                /* Main Content */
                .dashboard-main {
                    overflow-y: auto;
                    padding-right: 1rem;
                    /* Hide scrollbar for cleaner look, but keep functionality */
                    scrollbar-width: none;
                }
                .dashboard-main::-webkit-scrollbar {
                    display: none;
                }

                /* Segmented Control */
                .segmented-control {
                    display: flex;
                    background: rgba(255,255,255,0.05);
                    padding: 0.3rem;
                    border-radius: 16px;
                    margin-bottom: 2rem;
                    width: fit-content;
                }
                .segment-btn {
                    padding: 0.6rem 2rem;
                    border-radius: 12px;
                    border: none;
                    background: transparent;
                    color: var(--text-dim);
                    font-weight: 500;
                    cursor: pointer;
                    transition: all 0.3s ease;
                }
                .segment-btn.active {
                    background: rgba(255,255,255,0.1);
                    color: white;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
                }
                .segment-btn:hover:not(.active) {
                    color: white;
                }

                /* Bento Grid */
                .bento-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                    gap: 1.5rem;
                }
                
                .bento-card {
                    background: var(--glass-panel);
                    border: 1px solid var(--glass-border);
                    border-radius: 20px;
                    padding: 1.5rem;
                    display: flex;
                    flex-direction: column;
                    gap: 1rem;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    position: relative;
                    overflow: hidden;
                    /* Entry Animation */
                    animation: slideUpFade 0.5s cubic-bezier(0.2, 0.8, 0.2, 1) backwards;
                }
                
                @keyframes slideUpFade {
                    from { opacity: 0; transform: translateY(20px); }
                    to { opacity: 1; transform: translateY(0); }
                }

                .bento-card:hover {
                    background: rgba(40,40,45,0.9);
                    border-color: rgba(255,255,255,0.3);
                    transform: translateY(-4px) scale(1.02);
                    box-shadow: 0 20px 40px -10px rgba(0,0,0,0.5);
                }
                /* Glossy Sheen Effect */
                .bento-card::after {
                    content: '';
                    position: absolute;
                    top: 0; left: -100%;
                    width: 50%; height: 100%;
                    background: linear-gradient(to right, transparent, rgba(255,255,255,0.05), transparent);
                    transform: skewX(-25deg);
                    transition: 0.5s;
                    pointer-events: none;
                }
                .bento-card:hover::after {
                    left: 150%;
                    transition: 0.7s ease-in-out;
                }
                
                /* Spotlight Glow Effect */
                .spotlight-glow {
                    position: absolute;
                    inset: 0;
                    background: radial-gradient(
                        600px circle at var(--mouse-x, 0) var(--mouse-y, 0),
                        rgba(255, 255, 255, 0.06),
                        transparent 40%
                    );
                    opacity: 0;
                    transition: opacity 0.3s;
                    pointer-events: none;
                    z-index: 1;
                }
                .bento-card:hover .spotlight-glow {
                    opacity: 1;
                }
                /* Spotlight Border Hack (using before) */
                .bento-card::before {
                    content: "";
                    position: absolute;
                    inset: 0;
                    border-radius: 20px; 
                    padding: 1px; /* border width */
                    background: radial-gradient(
                        300px circle at var(--mouse-x, 0) var(--mouse-y, 0),
                        rgba(255, 255, 255, 0.4),
                        transparent 40%
                    ); 
                    /* Mask for border-only effect */
                    -webkit-mask: 
                       linear-gradient(#fff 0 0) content-box, 
                       linear-gradient(#fff 0 0);
                    -webkit-mask-composite: xor;
                    mask-composite: exclude;
                    opacity: 0;
                    transition: opacity 0.3s;
                    pointer-events: none;
                    z-index: 2;
                }
                .bento-card:hover::before {
                    opacity: 1;
                }

                .bento-card:active {
                    transform: scale(0.98);
                }
                .bento-card.completed {
                    border-color: rgba(16, 185, 129, 0.3);
                    background: rgba(16, 185, 129, 0.05);
                }

                .bento-icon {
                    width: 40px;
                    height: 40px;
                    background: rgba(255,255,255,0.05);
                    border-radius: 10px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: var(--text-dim);
                    font-weight: 700;
                }
                .bento-card.completed .bento-icon {
                    background: rgba(16, 185, 129, 0.2);
                    color: #10b981;
                }

                .bento-title {
                    font-size: 1.1rem;
                    font-weight: 600;
                    line-height: 1.4;
                }
                .bento-chapter {
                    font-size: 0.85rem;
                    color: var(--text-dim);
                }

                .status-badge {
                    display: inline-block;
                    font-size: 0.75rem;
                    padding: 0.25rem 0.75rem;
                    border-radius: 99px;
                    font-weight: 600;
                }
                .status-badge.todo {
                    background: rgba(255,255,255,0.1);
                    color: var(--text-dim);
                }
                .status-badge.done {
                    background: rgba(16, 185, 129, 0.2);
                    color: #10b981;
                }

                /* Responsive - Mobile Optimization (Sliver Header & Single Screen) */
                @media (max-width: 900px) {
                    /* ROOT SCROLLER for Mobile */
                    .dashboard-container {
                        height: 100dvh;
                        overflow: hidden; /* Prevent body scroll */
                    }

                    .dashboard-layout {
                        display: flex;
                        flex-direction: column;
                        height: 100%;
                        padding: 0.75rem;
                        gap: 0.75rem;
                        overflow: hidden; /* Container defines structure */
                        max-width: 100%;
                    }
                    
                    /* TOP SECTION (Fixed) */
                    .dashboard-sidebar {
                        flex: 0 0 auto; /* Don't shrink */
                        flex-direction: column;
                        gap: 0.5rem;
                        width: 100%;
                    }
                    
                    .brand-header {
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        padding: 0 0.25rem;
                    }
                    .brand-title { font-size: 1.1rem; margin: 0; }
                    .brand-subtitle { display: none; }
                    .logo-icon { font-size: 1.2rem; }

                    /* Redesigned Compact Hero (Horizontal) */
                    .hero-card {
                        min-height: 0;
                        padding: 0.75rem 1rem;
                        flex-direction: row;
                        align-items: center;
                        justify-content: space-between;
                        gap: 1rem;
                    }
                    .hero-content {
                        display: flex;
                        align-items: center;
                        gap: 1rem;
                        flex: 1;
                        justify-content: space-between;
                        z-index: 2;
                    }
                    .hero-title { 
                        font-size: 1.2rem; 
                        margin: 0; 
                        white-space: nowrap;
                    }
                    .hero-desc { display: none; } /* Hide description to save space */
                    
                    .hero-btn {
                        padding: 0.35rem 1rem;
                        font-size: 0.75rem;
                        margin: 0;
                        animation: none; /* Reduce distractions */
                        box-shadow: none;
                        background: rgba(255,255,255,0.9);
                        white-space: nowrap;
                    }
                    
                    /* Visual is purely decorative background or tiny icon */
                    .hero-visual { 
                        width: 60px; 
                        height: 60px; 
                        position: absolute;
                        right: -10px;
                        bottom: -10px;
                        opacity: 0.3;
                        transform: rotate(10deg);
                        z-index: 1;
                    }

                    /* Compact Stats Row */
                    .stats-box {
                        padding: 0.5rem 1rem;
                        gap: 0.5rem;
                        justify-content: space-around;
                        background: rgba(255,255,255,0.02);
                    }
                    .stat-val { font-size: 1.1rem; line-height: 1; }
                    .stat-label { font-size: 0.65rem; }
                    .stat-divider { height: 20px; }
                    .mini-cert-btn { padding: 0.25rem 0.5rem; font-size: 0.7rem; }

                    /* BOTTOM SECTION (Elastic) */
                    .dashboard-main {
                        flex: 1;
                        display: flex;
                        flex-direction: column;
                        overflow: hidden; /* Scroll inside bento-grid */
                        padding: 0;
                        height: auto;
                    }

                    /* Fixed Tabs */
                    .segmented-control {
                        width: 100%;
                        flex: 0 0 auto;
                        overflow-x: auto;
                        -webkit-overflow-scrolling: touch;
                        white-space: nowrap;
                        background: rgba(0,0,0,0.3);
                        padding: 0.25rem;
                        margin-bottom: 0.5rem;
                        border-radius: 12px;
                        position: static; /* No sticky needed inside flex column */
                    }
                    
                    .segment-btn {
                        flex: 0 0 auto;
                        padding: 0.4rem 0.8rem;
                        font-size: 0.75rem;
                    }

                    /* Internal Scrollable List */
                    .bento-grid {
                        flex: 1;
                        overflow-y: auto;
                        -webkit-overflow-scrolling: touch;
                        display: flex;
                        flex-direction: column;
                        gap: 0.5rem;
                        padding-bottom: 1rem;
                        /* Hide scrollbar */
                        scrollbar-width: none;
                    }
                    .bento-grid::-webkit-scrollbar { display: none; }

                    /* Compact Row Items */
                    .bento-card {
                        flex-direction: row;
                        align-items: center;
                        padding: 0.75rem 1rem;
                        gap: 0.75rem;
                        min-height: 0; /* Allow auto height */
                        border-radius: 16px;
                    }
                    .bento-info { flex: 1; text-align: left; min-width: 0; }
                    .bento-title {
                        font-size: 0.95rem;
                        margin-bottom: 0.1rem;
                        white-space: nowrap;
                        overflow: hidden;
                        text-overflow: ellipsis;
                    }
                    .bento-chapter { font-size: 0.75rem; truncate: true; }
                    .bento-icon {
                        width: 36px;
                        height: 36px;
                        font-size: 0.85rem;
                        border-radius: 8px;
                    }
                    .status-badge {
                        padding: 0.15rem 0.5rem;
                        font-size: 0.65rem;
                    }
                }

                @media (max-width: 480px) {
                    .dashboard-layout { padding: 0.75rem; }
                }
            `})]})}const FA=({text:i})=>{if(!i)return null;const e=i.split(/(BaSO|BaSO|)/g);return _.jsx("span",{children:e.map((t,n)=>["BaSO","BaSO",""].includes(t)?_.jsx("span",{className:"text-white font-bold drop-shadow-[0_0_2px_rgba(255,255,255,0.5)]",children:t},n):_.jsx("span",{children:t},n))})};function zA({layout:i="desktop"}){const e=De(F=>F.currentExperiment),t=De(F=>F.currentObservation),n=De(F=>F.currentExplanation),r=De(F=>F.showExplanation),s=De(F=>F.experimentActions),l=De(F=>F.addedChemicals),c=De(F=>F.placedApparatus),f=De(F=>F.resetExperiment),d=De(F=>F.completedExperiments),m=De(F=>F.showResetPrompt),g=De(F=>F.resetPromptMessage),y=De(F=>F.isAutoPouring),v=De(F=>F.bunsenBurnerOn),S=De(F=>F.showAssistant),T=De(F=>F.toggleAssistant),A=De(F=>F.saltTested),w=De(F=>F.resetAfterSaltTest),R=De(F=>F.iceTested),D=De(F=>F.paperTested),I=De(F=>F.neutralizationDropCount),z=De(F=>F.neutralizationComplete),j=De(F=>F.vinegarBlueLitmusTested),X=De(F=>F.vinegarRedLitmusTested),G=De(F=>F.lemonJuiceBlueLitmusTested),L=De(F=>F.lemonJuiceRedLitmusTested),k=De(F=>F.soapSolutionBlueLitmusTested),U=De(F=>F.soapSolutionRedLitmusTested),q=De(F=>F.bakingSodaBlueLitmusTested),W=De(F=>F.bakingSodaRedLitmusTested),J=e?d.includes(e.id):!1,[ce,K]=ge.useState(!1);if(!e)return null;let ne=e.procedureSteps||[];if(e.id==="salt-dissolution"&&A&&w&&(ne=["Place the beaker on the lab bench","Add water to the beaker","Add sand to the water","Place the glass rod","Stir the mixture with glass rod","Observe what happens to the sand"]),e.id==="acids-bases"){const F=["Place Test Tube Stand","Place Test Tube"],$=(ke,Fe)=>[...F,`Add ${ke}`,"Place Dropper",`Add ${Fe}`,"Observe Color Change","Click Reset Button"],re=j&&X,Ae=G&&L,ie=k&&U,_e=(ke,Fe)=>!ke&&!Fe?"Blue or Red Litmus":ke?Fe?"Litmus":"Red Litmus":"Blue Litmus";if(re)if(Ae)if(ie){const ke=_e(q,W);ne=$("Baking Soda (Base)",ke)}else{const ke=_e(k,U);ne=$("Soap Solution (Base)",ke)}else{const ke=_e(G,L);ne=$("Lemon Juice (Acid)",ke)}else{const ke=_e(j,X);ne=$("Vinegar (Acid)",ke)}}let pe=c.length+l.length+s.length,Re=0;e.id==="physical-chemical"&&(D?Re=m?6:11:R&&(Re=m?0:6));let Te=Math.min(Re+pe,ne.length);if(e.id==="acids-bases"&&m&&(Te=Math.min(Te+1,ne.length)),e.id==="neutralization"){let F=0;c.includes("beaker")&&(F=1),F===1&&l.includes("naoh")&&(F=2),F===2&&l.includes("phenolphthalein")&&(F=3),F===3&&c.includes("dropper")&&(F=4),F===4&&(I>=5||z)&&(F=5),Te=F}e.id==="physical-chemical"&&console.log(`Step Reset Debug [${i.toUpperCase()}]:`,{iceTested:R,paperTested:D,showResetPrompt:m,stepOffset:Re,currentPhaseActions:pe,totalSteps:ne.length,completedStepsCount:Te}),ge.useEffect(()=>{Te===ne.length&&ne.length>0&&K(!0)},[Te,ne.length]);const ee=()=>{if(e.id!=="neutralization")return null;const F=[];if(l.includes("naoh")&&F.push({step:"Initial Solution",observation:"Clear, colorless NaOH solution",inference:"Sodium Hydroxide is a strong BASE"}),l.includes("phenolphthalein")&&F.push({step:"+ Phenolphthalein",observation:"Solution turns PINK ",inference:"Indicates presence of base"}),I>0){const $=I>=5||z;F.push({step:`+ Dilute HCl (${I}/5 drops)`,observation:$?"Solution turns colorless ":"Solution still pink (waiting for endpoint...)",inference:$?"NEUTRALIZED (Salt + Water formed)":"Acid-base reaction in progress"})}return F.length===0?null:_.jsx("div",{className:"mb-4 rounded-xl overflow-hidden border border-[var(--glass-border)] bg-[rgba(0,0,0,0.2)]",children:_.jsxs("table",{className:"w-full text-sm text-[var(--text-primary)] border-collapse",children:[_.jsx("thead",{children:_.jsxs("tr",{className:"bg-[rgba(34,211,238,0.1)] text-[var(--accent-cyan)] border-b border-[var(--glass-border)]",children:[_.jsx("th",{className:"p-3 text-left font-semibold uppercase tracking-wider text-[11px]",children:"Step"}),_.jsx("th",{className:"p-3 text-left font-semibold uppercase tracking-wider text-[11px]",children:"Observation"}),_.jsx("th",{className:"p-3 text-left font-semibold uppercase tracking-wider text-[11px]",children:"Inference"})]})}),_.jsx("tbody",{className:"divide-y divide-[var(--glass-border)]",children:F.map(($,re)=>_.jsxs("tr",{className:"bg-transparent hover:bg-[rgba(255,255,255,0.02)]",children:[_.jsx("td",{className:"p-3 border-r border-[var(--glass-border)]",children:$.step}),_.jsx("td",{className:"p-3 border-r border-[var(--glass-border)]",children:$.observation}),_.jsx("td",{className:"p-3",children:$.inference})]},re))})]})})};return _.jsxs("div",{className:"glass-panel p-4 h-full flex flex-col pointer-events-auto",children:[_.jsxs("div",{className:"flex items-center justify-between mb-4 shrink-0 border-b border-white/10 pb-3",children:[_.jsxs("div",{className:"flex items-center gap-2 text-cyan-400",children:[_.jsx(m2,{className:"w-5 h-5"}),_.jsx("h2",{className:"text-sm font-bold tracking-wider uppercase",children:"Observation Log"})]}),_.jsx("div",{className:"flex gap-2",children:_.jsxs("button",{onClick:()=>{localStorage.removeItem("completedExperiments"),window.location.reload()},className:"bg-white/5 hover:bg-white/10 text-white/50 hover:text-white px-2 py-1 rounded text-xs transition-colors flex items-center gap-1",title:"Clear Progress (Debug)",children:[_.jsx(lF,{className:"w-3 h-3"}),_.jsx("span",{children:"Clear"})]})})]}),_.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0 space-y-4 pr-1 custom-scrollbar",children:[(J||m&&!J)&&_.jsxs("div",{className:`border rounded-lg p-3 flex items-start gap-3 shrink-0 animate-fade-in ${J?"bg-green-500/20 border-green-500/30":"bg-cyan-900/30 border-cyan-500/30"}`,children:[_.jsx("div",{className:`p-1.5 rounded-full shrink-0 ${J?"bg-green-500/20":"bg-cyan-500/20"}`,children:J?_.jsx(Q_,{className:"w-4 h-4 text-green-400"}):_.jsx(y0,{className:"w-4 h-4 text-cyan-400"})}),_.jsx("div",{children:_.jsxs("p",{className:`${J?"text-green-100":"text-cyan-100"} text-sm font-medium leading-relaxed`,children:[_.jsx("span",{className:`${J?"text-green-400":"text-cyan-400"} font-bold block mb-1`,children:J?"Experiment Complete!":"Phase Complete"}),J?"Great job! Click Reset to try again or choose another experiment.":g||"Click Reset Experiment to continue."]})})]}),ee(),t&&_.jsxs("div",{className:"bg-blue-500/10 border-l-2 border-cyan-400 pl-4 py-2 shrink-0 animate-fade-in relative overflow-hidden",children:[_.jsx("div",{className:"absolute top-0 right-0 p-1 opacity-20",children:_.jsx(vb,{className:"w-12 h-12 text-cyan-400 -rotate-12"})}),_.jsx("p",{className:"text-cyan-50 text-base leading-relaxed font-medium relative z-10",children:_.jsx(FA,{text:t})})]}),r&&n&&_.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-3 animate-fade-in",children:[_.jsxs("div",{className:"flex items-center gap-2 text-yellow-400 mb-2",children:[_.jsx(vF,{className:"w-4 h-4"}),_.jsx("span",{className:"text-xs font-bold uppercase tracking-wide",children:"Scientific Explanation"})]}),_.jsx("p",{className:"text-yellow-100/90 text-sm leading-relaxed",children:_.jsx(FA,{text:n})})]}),ne.length>0&&_.jsxs("div",{className:"mt-2 pt-4 border-t border-white/10 shrink-0",children:[_.jsxs("div",{className:"flex items-center justify-between mb-3 cursor-pointer opacity-80 hover:opacity-100 transition-opacity",onClick:()=>K(!ce),children:[_.jsx("h3",{className:"text-[10px] font-bold text-white/50 uppercase tracking-widest",children:"Experiment Sequence"}),_.jsxs("span",{className:"text-[10px] bg-white/10 px-1.5 py-0.5 rounded text-white/60 font-mono",children:[Te," / ",ne.length]})]}),!ce&&_.jsx("div",{className:"relative ml-3 pl-6 border-l-2 border-white/5 space-y-5 pb-2",children:ne.map((F,$)=>{let re=$<Te;const Ae=$===Te,ie=e.id==="evaporation"&&$===3&&v&&!l.includes("salt-solution");return ie&&(re=!1),_.jsxs("div",{className:"relative pl-4",children:[_.jsx("div",{className:`absolute -left-[31px] top-0.5 w-5 h-5 rounded-full flex items-center justify-center border-2 transition-all duration-300 z-10 ${re?"bg-green-500 border-green-500 text-black":Ae?"bg-cyan-500 border-cyan-500 shadow-[0_0_10px_rgba(34,211,238,0.5)] animate-pulse":ie?"bg-red-500 border-red-500 animate-pulse":"bg-[#0a0a0a] border-white/10"}`,children:re?_.jsx(Q_,{className:"w-3 h-3"}):Ae?_.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full animate-ping"}):_.jsx(iF,{className:"w-1.5 h-1.5 text-transparent"})}),_.jsx("p",{className:`text-sm transition-colors duration-300 ${re?"text-white/30 line-through":Ae?"text-white font-semibold":ie?"text-red-400":"text-white/40"}`,children:F})]},$)})})]})]}),_.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10 flex flex-col gap-2 shrink-0",children:[e?.id==="filtration"&&c.includes("beaker")&&c.includes("funnel")&&c.includes("filter-paper")&&l.includes("muddy-water")&&_.jsxs("button",{className:`w-full py-3 rounded-lg font-bold flex items-center justify-center gap-2 transition-all ${y?"bg-blue-600 scale-95 shadow-inner":"bg-blue-500 hover:bg-blue-400 shadow-lg shadow-blue-500/20"}`,onPointerDown:()=>De.getState().setAutoPouring(!0),onPointerUp:()=>De.getState().setAutoPouring(!1),onPointerLeave:()=>De.getState().setAutoPouring(!1),children:[_.jsx(y4,{className:`w-5 h-5 ${y?"animate-bounce":""}`}),_.jsx("span",{children:y?"Pouring...":"Pour into Funnel"})]}),!(i==="mobile"&&e.id==="acids-bases")&&_.jsxs("button",{onClick:()=>f(),className:`w-full py-2.5 rounded-lg border transition-all flex items-center justify-center gap-2 group ${m?"bg-blue-600/20 hover:bg-blue-600/30 text-blue-200 border-blue-500/30 shadow-[0_0_15px_rgba(59,130,246,0.15)]":"bg-white/5 hover:bg-white/10 text-white/60 hover:text-white border-white/10"}`,children:[_.jsx(y0,{className:`w-4 h-4 transition-transform duration-500 ${m?"group-hover:-rotate-180 text-blue-400":""}`}),_.jsx("span",{className:"font-semibold text-sm",children:"Reset Experiment"})]}),i!=="mobile"&&_.jsx("div",{className:"mt-3 flex items-center justify-center w-full px-4 py-3 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl transition-colors",children:_.jsxs("div",{className:"flex items-center gap-4",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("span",{className:"text-2xl filter drop-shadow-md animate-bounce-slow",children:""}),_.jsx("span",{className:"text-[13px] font-bold text-white/90 tracking-wide",children:"Assistant"})]}),_.jsx("button",{onClick:T,className:`w-14 h-8 rounded-full relative transition-colors border border-white/10 ${S?"bg-cyan-500":"bg-white/5"}`,title:S?"Hide Assistant":"Show Assistant",children:_.jsx("div",{className:`absolute top-1 w-6 h-6 rounded-full bg-white shadow-sm transition-transform duration-300 ${S?"left-7":"left-1"}`})})]})})]})]})}function jA(){const i=De(t=>t.safetyWarning),e=De(t=>t.dismissSafetyWarning);return i?_.jsxs("div",{className:"safety-overlay",children:[_.jsxs("div",{className:"safety-popup",children:[_.jsx("div",{className:"warning-icon",children:""}),_.jsx("h2",{className:"safety-title",children:i.title}),_.jsx("p",{className:"safety-message",children:i.message}),_.jsx("button",{className:"btn-caution",onClick:e,children:"Got it!"})]}),_.jsx("style",{children:`
                /* Styles adapted for Safety-Themed (Amber/Red) Warning */
                .safety-overlay {
                    position: fixed; top: 0; left: 0; right: 0; bottom: 0;
                    background: #1a0f0f; /* Solid opaque dark red-black background */
                    display: flex; align-items: center; justify-content: center;
                    z-index: 2147483646 !important; /* Maximum 32-bit z-index - 1 */
                    animation: fadeIn 0.2s ease;
                }
                .safety-popup {
                    background: linear-gradient(135deg, #2e1a1a 0%, #3e1616 100%);
                    border: 1px solid rgba(255, 69, 0, 0.4);
                    border-radius: 16px;
                    padding: 2rem;
                    text-align: center;
                    max-width: 380px;
                    width: 90%;
                    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.6), 0 0 30px rgba(255, 69, 0, 0.1);
                    animation: popupSlide 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
                }
                @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
                @keyframes popupSlide {
                    0% { transform: scale(0.8) translateY(20px); opacity: 0; }
                    100% { transform: scale(1) translateY(0); opacity: 1; }
                }
                .warning-icon {
                    font-size: 3.5rem; margin-bottom: 0.5rem;
                    animation: wobble 1s ease-in-out infinite;
                }
                @keyframes wobble {
                    0%, 100% { transform: rotate(0deg); }
                    25% { transform: rotate(-10deg); }
                    75% { transform: rotate(10deg); }
                }
                .safety-title {
                    font-size: 1.5rem; font-weight: 700;
                    color: #ff6b6b; margin-bottom: 0.5rem;
                }
                .safety-message {
                    color: #d0d0d0; font-size: 1rem; line-height: 1.5;
                    margin-bottom: 1.5rem;
                }
                .btn-caution {
                    background: linear-gradient(to right, #ff416c, #ff4b2b);
                    border: none; border-radius: 8px;
                    padding: 0.8rem 1.5rem; color: white;
                    font-weight: 600; cursor: pointer;
                    transition: transform 0.2s;
                    box-shadow: 0 4px 15px rgba(255, 75, 43, 0.4);
                }
                .btn-caution:hover { transform: scale(1.05); }
            `})]}):null}function hC(){const i=De(e=>e.currentExperiment);return i?_.jsxs("div",{className:"lab-record-content",children:[_.jsxs("section",{className:"record-section",children:[_.jsxs("h3",{className:"section-title",children:[_.jsx(_F,{size:18,className:"text-cyan-400"})," Aim"]}),_.jsx("p",{className:"section-text",children:i.aim})]}),_.jsxs("section",{className:"record-section",children:[_.jsxs("h3",{className:"section-title",children:[_.jsx(TF,{size:18,className:"text-purple-400"})," Apparatus Required"]}),_.jsx("ul",{className:"item-list",children:i.apparatus.map((e,t)=>_.jsx("li",{children:e.replace(/-/g," ")},t))})]}),_.jsxs("section",{className:"record-section",children:[_.jsxs("h3",{className:"section-title",children:[_.jsx(y4,{size:18,className:"text-pink-400"})," Chemicals Used"]}),_.jsx("ul",{className:"item-list",children:i.chemicals.map((e,t)=>_.jsxs("li",{children:[_.jsx("span",{className:"chem-color",style:{background:e.color}}),e.name]},t))})]}),i.procedureSteps&&_.jsxs("section",{className:"record-section",children:[_.jsxs("h3",{className:"section-title",children:[_.jsx(vb,{size:18,className:"text-amber-400"})," Procedure"]}),_.jsx("ol",{className:"procedure-list",children:i.procedureSteps.map((e,t)=>_.jsx("li",{children:e},t))})]}),_.jsxs("section",{className:"record-section",children:[_.jsxs("h3",{className:"section-title",children:[_.jsx(m2,{size:18,className:"text-blue-400"})," Observations"]}),Object.entries(i.reactions).map(([e,t])=>t.success?_.jsx("div",{className:"observation-item",children:_.jsx("p",{children:t.observation})},e):null)]}),_.jsxs("section",{className:"record-section",children:[_.jsxs("h3",{className:"section-title",children:[_.jsx(Q_,{size:18,className:"text-emerald-400"})," Conclusion"]}),_.jsx("p",{className:"section-text conclusion",children:i.conclusion})]}),_.jsx("style",{children:`
                .lab-record-content {
                    flex: 1;
                    padding: 0.5rem 0;
                }

                .record-section {
                    margin-bottom: 1.5rem;
                }

                .record-section:last-child {
                    margin-bottom: 0;
                }

                .section-title {
                    font-size: 0.85rem;
                    font-weight: 700;
                    color: #fff;
                    margin-bottom: 0.75rem;
                    text-transform: uppercase;
                    letter-spacing: 0.05em;
                    display: flex;
                    align-items: center;
                    gap: 0.6rem;
                    opacity: 0.9;
                }

                .section-text {
                    color: #e2e8f0;
                    font-size: 0.95rem;
                    line-height: 1.6;
                    font-weight: 400;
                }

                .section-text.conclusion {
                    background: rgba(16, 185, 129, 0.08);
                    padding: 1rem;
                    border-radius: 12px;
                    border: 1px solid rgba(16, 185, 129, 0.2);
                    color: #d1fae5;
                }

                .item-list {
                    list-style: none;
                    padding: 0;
                    margin: 0;
                    display: flex;
                    flex-wrap: wrap;
                    gap: 0.5rem;
                }

                .item-list li {
                    display: inline-flex;
                    align-items: center;
                    gap: 0.5rem;
                    background: rgba(255, 255, 255, 0.06);
                    padding: 0.5rem 0.85rem;
                    border-radius: 9999px; /* Pill shape */
                    border: 1px solid rgba(255, 255, 255, 0.08); /* Subtle border */
                    color: #f1f5f9;
                    font-size: 0.85rem;
                    font-weight: 500;
                    text-transform: capitalize;
                }

                .chem-color {
                    width: 10px;
                    height: 10px;
                    border-radius: 50%;
                    box-shadow: 0 0 0 1px rgba(255,255,255,0.2);
                }

                .procedure-list {
                    margin: 0;
                    padding-left: 1.25rem;
                    color: #cbd5e1;
                    font-size: 0.9rem;
                    line-height: 1.7;
                }
                
                .procedure-list li {
                    margin-bottom: 0.25rem;
                }

                .observation-item {
                    background: linear-gradient(90deg, rgba(124, 58, 237, 0.1) 0%, rgba(124, 58, 237, 0.02) 100%);
                    padding: 0.875rem 1rem;
                    border-radius: 12px;
                    margin-bottom: 0.5rem;
                    border-left: 3px solid #8b5cf6;
                }

                .observation-item p {
                    margin: 0;
                    color: #e2e8f0;
                    font-size: 0.9rem;
                    line-height: 1.5;
                }
            `})]}):null}const lp=i=>i?i.replace(/|||||||||/g,"").replace(/[\u2018\u2019]/g,"'").replace(/[\u201C\u201D]/g,'"').replace(/[^\x00-\x7F-]/g,""):"",Vm=(i,e,t,n)=>{const r=e.split(/([-])/);let s=t;const l=i.getFontSize();r.forEach(c=>{if(c)if(/[-]/.test(c)){const f=String.fromCharCode(c.charCodeAt(0)-8320+48);i.setFontSize(l*.7),i.text(f,s,n+1),s+=i.getTextWidth(f)}else if(/[]/.test(c)){const f=c===""?"+":"-";i.setFontSize(l*.6),i.text(f,s,n-1.2),s+=i.getTextWidth(f)}else c===""?(i.setFontSize(l),i.text("->",s,n),s+=i.getTextWidth("->")):c===""?(i.setFontSize(l),i.text(" (ppt)",s,n),s+=i.getTextWidth(" (ppt)")):c===""?(i.setFontSize(l),i.text("-",s,n),s+=i.getTextWidth("- ")):c===""?(i.setFontSize(l),i.text("--",s,n),s+=i.getTextWidth("--")):(i.setFontSize(l),i.text(c,s,n),s+=i.getTextWidth(c))}),i.setFontSize(l)},Hm=(i,e,t)=>{const n=e.split(" "),r=[];let s="";return n.forEach(l=>{const c=(s?s+" "+l:l).replace(/[-]/g,"x");i.getTextWidth(c)>t?(s&&r.push(s),s=l):s=s?s+" "+l:l}),s&&r.push(s),r},dC=async(i,e)=>{try{const t=new jn;t.setFontSize(18),t.setTextColor(0,100,150),t.text("Virtual Chemistry Lab - Lab Record",105,20,{align:"center"}),t.setFontSize(14),t.setTextColor(0,0,0),t.text(lp(i.title),105,35,{align:"center"}),t.setFontSize(10),t.setTextColor(100,100,100),t.text(`Class ${i.classLevel} | ${i.chapter}`,105,42,{align:"center"});let n=55;t.setFontSize(12),t.setTextColor(0,80,120),t.text("AIM:",20,n),t.setTextColor(0,0,0),t.setFontSize(11),Hm(t,lp(i.aim),170).forEach(y=>{Vm(t,y,20,n+7),n+=6}),n+=10,t.setFontSize(12),t.setTextColor(0,80,120),t.text("APPARATUS REQUIRED:",20,n),t.setTextColor(0,0,0),t.setFontSize(11);const s=i.apparatus.map(y=>y.replace(/-/g," ")).join(", ");Hm(t,lp(s),170).forEach(y=>{Vm(t,y,20,n+7),n+=6}),n+=10,t.setFontSize(12),t.setTextColor(0,80,120),t.text("CHEMICALS USED:",20,n),t.setTextColor(0,0,0),t.setFontSize(11);const c=i.chemicals.map(y=>y.name).join(", ");Hm(t,lp(c),170).forEach(y=>{Vm(t,y,20,n+7),n+=6}),n+=10,i.procedureSteps&&i.procedureSteps.length>0&&(t.setFontSize(12),t.setTextColor(0,80,120),t.text("PROCEDURE:",20,n),n+=7,t.setTextColor(0,0,0),t.setFontSize(11),i.procedureSteps.forEach((y,v)=>{const S=`${v+1}. ${lp(y)}`;Hm(t,S,165).forEach(A=>{n>280&&(t.addPage(),n=20),Vm(t,A,25,n),n+=6})}),n+=5),t.setFontSize(12),t.setTextColor(0,80,120),t.text("OBSERVATIONS:",20,n),n+=7,t.setTextColor(0,0,0),t.setFontSize(11),Object.values(i.reactions).forEach(y=>{if(y.success){const v=lp(` ${y.observation}`),S=Hm(t,v,165);n+S.length*6>270&&(t.addPage(),n=20),S.forEach(T=>{Vm(t,T,25,n),n+=6}),n+=2}}),n+=5,n>240&&(t.addPage(),n=20),t.setFontSize(12),t.setTextColor(0,80,120),t.text("CONCLUSION:",20,n),t.setTextColor(0,0,0),t.setFontSize(11),Hm(t,lp(i.conclusion),170).forEach(y=>{n>280&&(t.addPage(),n=20),Vm(t,y,20,n+7),n+=6}),t.setFontSize(8),t.setTextColor(150,150,150),t.text(`Generated by Virtual Chemistry Lab on ${new Date().toLocaleDateString()}`,105,290,{align:"center"});const g=`${i.title.replace(/[^a-z0-9]/gi,"_")}_Lab_Report.pdf`;if(e==="download")t.save(g);else{const y=t.output("blob"),v=URL.createObjectURL(y);window.open(v,"_blank")}}catch(t){throw console.error("PDF generation failed:",t),t}};function VA({isOpen:i,onClose:e,onViewLabRecord:t,onNextExperiment:n}){const r=De(R=>R.currentExperiment),s=De(R=>R.completedExperiments),l=De(R=>R.resetExperiment),[c,f]=ge.useState(!1),[d,m]=ge.useState("initial"),g=p2(),y=s.length>=g.length;if(ge.useEffect(()=>{if(i){if(d!=="initial")return;const R=localStorage.getItem("allCompleteAwarded")==="true";y?R?m("rerun"):(m("ceremony"),localStorage.setItem("allCompleteAwarded","true")):m("regular")}else d!=="initial"&&m("initial")},[i,d,y]),!i||!r||d==="initial")return null;const S=g.findIndex(R=>R.id===r.id)<g.length-1,T=()=>{l(),e()},A=async()=>{const R=window.prompt("Please enter your full name for the certificate:");if(R===null)return;const D=R.trim();if(!D){alert("Please enter a valid name to download your certificate.");return}await fC(D)},w=async()=>{f(!0);try{await dC(r,"download")}catch{alert("Failed to generate PDF. Please try again.")}finally{f(!1)}};return _.jsxs("div",{className:"completion-overlay",children:[_.jsx("div",{className:`completion-popup ${d!=="regular"?"all-complete":""}`,children:d==="ceremony"?_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:"stars",children:[_.jsx(t_,{size:32,className:"star text-yellow-400 fill-yellow-400"}),_.jsx(t_,{size:40,className:"star text-yellow-300 fill-yellow-300"}),_.jsx(t_,{size:32,className:"star text-yellow-400 fill-yellow-400"})]}),_.jsx("div",{className:"trophy-icon all",children:_.jsx(SM,{size:80,className:"text-yellow-400 drop-shadow-glow"})}),_.jsx("h2",{className:"completion-title grand",children:"CONGRATULATIONS!"}),_.jsx("p",{className:"completion-message",children:"Amazing! You've completed ALL experiments in the Virtual Chemistry Lab! You're now a certified young scientist!"}),_.jsxs("button",{className:"btn-certificate",onClick:A,children:[_.jsx(bM,{size:20}),"Download Certificate"]}),_.jsxs("div",{className:"secondary-actions",children:[_.jsxs("button",{className:"btn-secondary",onClick:t,children:[_.jsx(wx,{size:18}),"View Lab Record"]}),_.jsxs("button",{className:"btn-secondary",onClick:e,children:[_.jsx(r1,{size:20}),"Close"]})]}),_.jsx("div",{className:"confetti-container",children:[...Array(30)].map((R,D)=>_.jsx("div",{className:"confetti",style:{left:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`,animationDuration:`${2+Math.random()*2}s`,backgroundColor:["#ff0000","#00ff00","#0000ff","#ffff00","#ff00ff","#00ffff","#ffd700"][Math.floor(Math.random()*7)]}},D))})]}):d==="rerun"?_.jsxs(_.Fragment,{children:[_.jsx("h2",{className:"completion-title",children:"Experiment Complete!"}),_.jsx("div",{className:"rerun-record-container",children:_.jsx(hC,{})}),_.jsxs("div",{className:"secondary-actions mt-4 gap-3",children:[_.jsxs("button",{className:"btn-primary",onClick:A,children:[_.jsx(bM,{size:18}),"Certificate"]}),_.jsxs("button",{className:"btn-secondary",onClick:w,disabled:c,children:[_.jsx(wx,{size:18}),c?"...":"PDF"]}),_.jsxs("button",{className:"btn-secondary",onClick:T,children:[_.jsx(y0,{size:18}),"Rerun"]}),S&&n&&_.jsxs("button",{className:"btn-secondary",onClick:n,children:[_.jsx(yM,{size:18}),"Next"]}),_.jsx("button",{className:"btn-secondary btn-icon-only",onClick:e,children:_.jsx(r1,{size:20})})]})]}):_.jsxs(_.Fragment,{children:[_.jsx("div",{className:"trophy-icon",children:_.jsx(SM,{size:64,className:"text-yellow-400"})}),_.jsx("h2",{className:"completion-title",children:"Experiment Complete!"}),_.jsxs("p",{className:"completion-message",children:[`Great job! You've successfully completed "`,r.title,'"']}),_.jsxs("button",{className:"btn-primary",onClick:t,children:[_.jsx(wx,{size:18}),"View Lab Record"]}),_.jsxs("div",{className:"secondary-actions",children:[_.jsxs("button",{className:"btn-secondary",onClick:T,children:[_.jsx(y0,{size:18}),"Rerun"]}),S&&n&&_.jsxs("button",{className:"btn-secondary",onClick:n,children:[_.jsx(yM,{size:18}),"Next Experiment"]})]})]})}),_.jsx("style",{children:`
                .completion-overlay {
                    position: fixed;
                    top: 0; left: 0; right: 0; bottom: 0;
                    background: rgba(8, 12, 28, 0.7);
                    backdrop-filter: blur(8px);
                    -webkit-backdrop-filter: blur(8px);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 2147483647 !important;
                    animation: fadeIn 0.3s ease;
                }

                @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

                .completion-popup {
                    background: rgba(22, 33, 62, 0.95);
                    backdrop-filter: blur(16px);
                    -webkit-backdrop-filter: blur(16px);
                    border: 1px solid rgba(255, 255, 255, 0.08);
                    border-radius: 24px;
                    padding: 2.5rem;
                    text-align: center;
                    max-width: 500px;
                    width: 90%;
                    max-height: 85vh;
                    box-shadow: 0 25px 60px rgba(0, 0, 0, 0.5), inset 0 0 0 1px rgba(255, 255, 255, 0.05);
                    animation: popupBounce 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
                    position: relative;
                    overflow: hidden;
                    display: flex;
                    flex-direction: column;
                }

                .rerun-record-container {
                    flex: 1;
                    overflow-y: auto;
                    margin-top: 1rem;
                    text-align: left;
                    padding-right: 0.5rem;
                    border-top: 1px solid rgba(255,255,255,0.05);
                    border-bottom: 1px solid rgba(255,255,255,0.05);
                }

                .rerun-record-container::-webkit-scrollbar { width: 4px; }
                .rerun-record-container::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.1); border-radius: 10px; }

                @keyframes popupBounce {
                    0% { transform: scale(0.95); opacity: 0; }
                    100% { transform: scale(1); opacity: 1; }
                }

                .trophy-icon { margin-bottom: 1rem; animation: trophyBounce 0.6s ease-in-out; }
                .drop-shadow-glow { filter: drop-shadow(0 0 15px rgba(250, 204, 21, 0.4)); }

                @keyframes trophyBounce {
                    0% { transform: scale(0) rotate(-10deg); }
                    50% { transform: scale(1.1) rotate(5deg); }
                    100% { transform: scale(1) rotate(0); }
                }

                .completion-title {
                    font-size: 1.75rem;
                    font-weight: 800;
                    letter-spacing: -0.02em;
                    background: linear-gradient(135deg, #22d3ee 0%, #a78bfa 100%);
                    -webkit-background-clip: text;
                    -webkit-text-fill-color: transparent;
                    margin-bottom: 0.5rem;
                }
                
                .completion-title.grand {
                    font-size: 2rem;
                    background: linear-gradient(135deg, #fbbf24 0%, #f472b6 100%);
                    -webkit-background-clip: text;
                }

                .completion-message {
                    color: #94a3b8;
                    font-size: 1rem;
                    line-height: 1.5;
                    margin-bottom: 1.5rem;
                }

                .btn-primary, .btn-certificate {
                    display: inline-flex;
                    align-items: center;
                    justify-content: center;
                    gap: 0.5rem;
                    padding: 0.75rem 1.25rem;
                    background: linear-gradient(135deg, #06b6d4 0%, #7c3aed 100%);
                    border: none;
                    border-radius: 12px;
                    color: white;
                    font-size: 0.95rem;
                    font-weight: 600;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    font-family: inherit;
                    width: 100%;
                    box-shadow: 0 4px 12px rgba(6, 182, 212, 0.25);
                }

                .btn-certificate {
                    background: linear-gradient(135deg, #f59e0b 0%, #ef4444 100%);
                    box-shadow: 0 4px 12px rgba(245, 158, 11, 0.25);
                }

                .btn-primary:hover, .btn-certificate:hover {
                    transform: translateY(-1px);
                    filter: brightness(110%);
                }

                .secondary-actions {
                    display: flex;
                    gap: 0.5rem;
                    margin-top: 1rem;
                    flex-wrap: wrap;
                }

                .btn-secondary {
                    flex: 1;
                    display: inline-flex;
                    align-items: center;
                    justify-content: center;
                    gap: 0.5rem;
                    padding: 0.6rem 0.8rem;
                    background: rgba(255, 255, 255, 0.05);
                    border: 1px solid rgba(255, 255, 255, 0.05);
                    border-radius: 10px;
                    color: #cbd5e1;
                    font-size: 0.9rem;
                    font-weight: 500;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    font-family: inherit;
                    white-space: nowrap;
                }

                .btn-secondary:hover {
                    background: rgba(255, 255, 255, 0.1);
                    color: #fff;
                    border-color: rgba(255, 255, 255, 0.1);
                }
                
                .btn-icon-only {
                    flex: 0 0 auto;
                    padding: 0.6rem;
                    width: 40px;
                }

                .confetti-container { position: absolute; top: 0; left: 0; right: 0; bottom: 0; pointer-events: none; }
                .confetti { position: absolute; width: 8px; height: 8px; top: -10px; animation: confettiFall 3s linear infinite; }
                @keyframes confettiFall {
                    0% { transform: translateY(0) rotate(0deg); opacity: 1; }
                    100% { transform: translateY(500px) rotate(720deg); opacity: 0; }
                }
                
                .stars { display: flex; justify-content: center; gap: 0.5rem; margin-bottom: 1rem; }
                .star { animation: starPulse 1.5s ease-in-out infinite; }
                .star:nth-child(2) { animation-delay: 0.2s; }
                .star:nth-child(3) { animation-delay: 0.4s; }
                @keyframes starPulse { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.15); opacity: 0.8; } }
            `})]})}function HA({isOpen:i,onClose:e}){const t=De(l=>l.currentExperiment),[n,r]=ge.useState(!1);if(!i||!t)return null;const s=async l=>{r(!0);try{await dC(t,l)}catch{alert("Failed to generate PDF. Please try again.")}finally{r(!1)}};return _.jsxs("div",{className:"lab-record-overlay",onClick:e,children:[_.jsxs("div",{className:"lab-record-modal",onClick:l=>l.stopPropagation(),children:[_.jsx("button",{className:"close-btn",onClick:e,children:_.jsx(r1,{size:20})}),_.jsxs("div",{className:"modal-header",children:[_.jsxs("h2",{className:"modal-title",children:[_.jsx(vb,{className:"inline-block mr-2 mb-1",size:24}),"Lab Record"]}),_.jsx("p",{className:"modal-subtitle",children:t.title})]}),_.jsx("div",{className:"modal-content",children:_.jsx(hC,{})}),_.jsxs("div",{className:"modal-footer",children:[_.jsxs("button",{className:"btn-reset-status",onClick:()=>{window.confirm("Reset completion status for this experiment?")&&(De.getState().unmarkExperimentComplete(t.id),alert("Status reset! You can now complete it again."))},title:"Remove completion mark to re-trigger completion popup",children:[_.jsx(y0,{size:16}),"Reset Status"]}),_.jsxs("button",{className:"btn-preview",onClick:()=>s("preview"),disabled:n,children:[_.jsx(m2,{size:18}),"Preview"]}),_.jsxs("button",{className:"btn-export",onClick:()=>s("download"),disabled:n,children:[_.jsx(wx,{size:18}),n?"Generating...":"Download PDF"]})]})]}),_.jsx("style",{children:`
                .lab-record-overlay {
                    position: fixed;
                    top: 0; left: 0; right: 0; bottom: 0;
                    background: rgba(8, 12, 28, 0.7);
                    backdrop-filter: blur(8px);
                    -webkit-backdrop-filter: blur(8px);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 2147483645 !important;
                    padding: 1rem;
                    animation: fadeIn 0.3s ease;
                }

                @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

                .lab-record-modal {
                    background: rgba(22, 33, 62, 0.95);
                    backdrop-filter: blur(16px);
                    -webkit-backdrop-filter: blur(16px);
                    border: 1px solid rgba(255, 255, 255, 0.08);
                    border-radius: 24px;
                    max-width: 600px;
                    width: 100%;
                    max-height: 85vh;
                    display: flex;
                    flex-direction: column;
                    box-shadow: 0 25px 60px rgba(0, 0, 0, 0.5), inset 0 0 0 1px rgba(255, 255, 255, 0.05);
                    animation: slideUp 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
                    position: relative;
                }

                @keyframes slideUp {
                    from { opacity: 0; transform: translateY(20px) scale(0.95); }
                    to { opacity: 1; transform: translateY(0) scale(1); }
                }

                .close-btn {
                    position: absolute;
                    top: 1.25rem;
                    right: 1.25rem;
                    width: 36px;
                    height: 36px;
                    border-radius: 12px;
                    background: rgba(255, 255, 255, 0.05);
                    border: 1px solid rgba(255, 255, 255, 0.05);
                    color: #a0a0c0;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    z-index: 10;
                }

                .close-btn:hover {
                    background: rgba(255, 255, 255, 0.1);
                    color: white;
                    transform: rotate(90deg);
                }

                .modal-header {
                    padding: 1.5rem 2rem 1rem;
                    border-bottom: 1px solid rgba(255, 255, 255, 0.08);
                    text-align: left;
                }

                .modal-title {
                    font-size: 1.5rem;
                    font-weight: 700;
                    color: white;
                    display: flex;
                    align-items: center;
                    letter-spacing: -0.02em;
                    margin-bottom: 0.25rem;
                }

                .modal-subtitle {
                    color: #94a3b8;
                    font-size: 0.95rem;
                    font-weight: 500;
                }

                .modal-content {
                    padding: 0 2rem;
                    overflow-y: auto;
                    flex: 1;
                }
                
                .modal-content::-webkit-scrollbar { width: 4px; }
                .modal-content::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.1); border-radius: 10px; }

                .modal-footer {
                    padding: 1.25rem 2rem 1.75rem;
                    border-top: 1px solid rgba(255, 255, 255, 0.08);
                    display: flex;
                    gap: 0.75rem;
                }

                .btn-export, .btn-preview {
                    flex: 1;
                    display: inline-flex;
                    align-items: center;
                    justify-content: center;
                    gap: 0.5rem;
                    padding: 0.875rem 1rem;
                    border: none;
                    border-radius: 12px;
                    font-size: 0.95rem;
                    font-weight: 600;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    font-family: inherit;
                    color: white;
                }

                .btn-preview {
                    background: rgba(255, 255, 255, 0.05);
                    border: 1px solid rgba(255, 255, 255, 0.1);
                    color: #cbd5e1;
                }

                .btn-export {
                    background: linear-gradient(135deg, #06b6d4 0%, #7c3aed 100%);
                    box-shadow: 0 4px 12px rgba(6, 182, 212, 0.25);
                }

                .btn-export:hover {
                    transform: translateY(-1px);
                    filter: brightness(110%);
                }
                
                .btn-preview:hover {
                    background: rgba(255, 255, 255, 0.1);
                    color: white;
                    border-color: rgba(255, 255, 255, 0.2);
                }

                .btn-export:disabled, .btn-preview:disabled {
                    opacity: 0.6;
                    cursor: not-allowed;
                    transform: none;
                }

                .btn-reset-status {
                    display: inline-flex;
                    align-items: center;
                    justify-content: center;
                    gap: 0.5rem;
                    padding: 0.875rem 1rem;
                    border: 1px solid rgba(255, 99, 71, 0.3);
                    border-radius: 12px;
                    font-size: 0.85rem;
                    font-weight: 600;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    font-family: inherit;
                    background: rgba(255, 99, 71, 0.1);
                    color: #ff6347;
                    margin-right: auto; /* Push to left */
                }

                .btn-reset-status:hover {
                    background: rgba(255, 99, 71, 0.2);
                    border-color: rgba(255, 99, 71, 0.5);
                }

                @media (max-width: 600px) {
                    .modal-footer {
                        flex-direction: column;
                    }
                    .btn-reset-status {
                        margin-right: 0;
                        margin-bottom: 0.5rem;
                    }
                }
            `})]})}function v9(){const i=De(W=>W.currentExperiment),e=De(W=>W.placedApparatus),t=De(W=>W.addedChemicals),n=De(W=>W.experimentActions),r=De(W=>W.bunsenBurnerOn),s=De(W=>W.saltTested),l=De(W=>W.resetAfterSaltTest),c=De(W=>W.iceTested),f=De(W=>W.paperTested),d=De(W=>W.showResetPrompt),m=De(W=>W.neutralizationDropCount),g=De(W=>W.neutralizationComplete),y=De(W=>W.vinegarBlueLitmusTested),v=De(W=>W.vinegarRedLitmusTested),S=De(W=>W.lemonJuiceBlueLitmusTested),T=De(W=>W.lemonJuiceRedLitmusTested),A=De(W=>W.soapSolutionBlueLitmusTested),w=De(W=>W.soapSolutionRedLitmusTested),R=De(W=>W.bakingSodaBlueLitmusTested),D=De(W=>W.bakingSodaRedLitmusTested),I=De(W=>W.isNeutralizationAudioDone);if(i?.id==="neutralization"&&g&&m>=5&&I||!i)return null;let j=i.procedureSteps||[];if(i.id==="salt-dissolution"&&s&&l&&(j=["Place the beaker on the lab bench","Add water to the beaker","Add sand to the water","Place the glass rod","Stir the mixture with glass rod","Observe what happens to the sand"]),i.id==="acids-bases"){const W=["Place Test Tube Stand","Place Test Tube"],J=(Re,Te)=>[...W,`Add ${Re}`,"Place Dropper",`Add ${Te}`,"Observe Color Change","Click Reset Button"],ce=y&&v,K=S&&T,ne=A&&w,pe=(Re,Te)=>!Re&&!Te?"Blue or Red Litmus":Re?Te?"Litmus":"Red Litmus":"Blue Litmus";if(ce)if(K)if(ne){const Re=pe(R,D);j=J("Baking Soda (Base)",Re)}else{const Re=pe(A,w);j=J("Soap Solution (Base)",Re)}else{const Re=pe(S,T);j=J("Lemon Juice (Acid)",Re)}else{const Re=pe(y,v);j=J("Vinegar (Acid)",Re)}}let X=e.length+t.length+n.length,G=0;i.id==="physical-chemical"&&(f?G=d?6:11:c&&(G=d?0:6));let L=Math.min(G+X,j.length);if(i.id==="acids-bases"&&d&&(L=Math.min(L+1,j.length)),i.id==="neutralization"){let W=0;e.includes("beaker")&&(W=1),W===1&&t.includes("naoh")&&(W=2),W===2&&t.includes("phenolphthalein")&&(W=3),W===3&&e.includes("dropper")&&(W=4),W===4&&(m>=5||g)&&(W=5),L=W}const k=L>=j.length,U=k?" Experiment complete!":j[L],q=i.id==="evaporation"&&r&&!t.includes("salt-solution");return _.jsx("div",{className:`absolute bottom-5 left-4 right-4 z-30 p-4 rounded-[24px] backdrop-blur-2xl border transition-all duration-500 cubic-bezier(0.32, 0.72, 0, 1) shadow-[0_8px_32px_rgba(0,0,0,0.5)]
            ${q?"bg-red-500/80 border-red-400 text-white animate-pulse":"bg-black/60 border-white/10 text-white"}`,children:_.jsxs("div",{className:"flex items-center gap-3.5",children:[_.jsx("div",{className:`shrink-0 w-10 h-10 rounded-2xl flex items-center justify-center text-lg shadow-sm
                    ${q?"bg-red-600 text-white":k?"bg-green-500 text-white":"bg-white/10 text-cyan-400"}`,children:q?"":k?"":""}),_.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-center",children:[q?_.jsx("p",{className:"font-bold text-[15px] leading-tight tracking-wide",children:"Missed Salt Solution!"}):_.jsx("p",{className:`text-[15px] font-semibold leading-tight tracking-wide truncate ${k?"text-green-400":"text-zinc-100"}`,children:U}),!k&&!q&&_.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[_.jsx("div",{className:"flex-1 h-1 bg-white/10 rounded-full overflow-hidden",children:_.jsx("div",{className:"h-full bg-cyan-400 transition-all duration-500 ease-out",style:{width:`${L/j.length*100}%`}})}),_.jsxs("span",{className:"text-[10px] text-cyan-400/70 font-mono",children:[L+1,"/",j.length]})]})]})]})})}const Ya={hi:{idle:[" Volcano  ? Baking Soda  Vinegar !"," Elephant Toothpaste   Hydrogen Peroxide  Potassium Iodide !","   (Pink Magic)   Base  Indicator !"," Chemistry  ?   Physics !","     Scientist ,   !","           !","  !  experiment !"," Science   ,     !"],reactions:{volcano_reaction:" !   ! Volcano  ! ",elephant_toothpaste:" !    (Foam)!    Scientist ! ",acid_base_neutralization:" !  Acid  Base     ! ",acid_metal_reaction:"  (Bubbles)!  Hydrogen  ! ",indicator_base:"!   !   Science  ! ",barium_sulfate_precipitation:",    !  Precipitate  ! ",generic:"!   !   ! ",clean_slate:" !      ! ",burner_on:"   !   ! "},chemicals:{baking_soda:["Baking Soda  !   Vinegar   ! ","Baking Soda !   ? "],vinegar:["Vinegar ()  !    ! ","Acid  !   Base ! "],hydrogen_peroxide:["Peroxide  !    ! ","  Powerful !  ! "],potassium_iodide:["Potassium Iodide  !   ! ","Catalyst ready !   Foam  ! "],phenolphthalein:["Indicator  !  Base    ! ","   ...   ! "],sodium_hydroxide:["Sodium Hydroxide!    Base ! ","Base !   Pink  ! "],hydrochloric_acid:["Hydrochloric Acid!    ! ","Strong Acid  !  ! "],water:["   (Water)!       ","Water  !    ? "],default:["!   ?   ! "," !   ? ","  ! Science Rock! ","   ! "]},welcome:" Lab   !      ! "},kok:{idle:[" Volcano  ? Baking Soda  Vinegar !"," Elephant Toothpaste  Hydrogen Peroxide  Potassium Iodide !","   (Pink Magic)  Base  Indicator !"," Chemistry  ?   Physics!","     Scientist !","       !","  !  !"," Science  ,   !"],reactions:{volcano_reaction:" !   ! Volcano ! ",elephant_toothpaste:" !   (Foam) !   Scientist! ",acid_base_neutralization:" ! Acid  Base  Balance ! ",acid_metal_reaction:"  (Bubbles)!  Hydrogen Gas! ",indicator_base:"!    !  Science  ! ",barium_sulfate_precipitation:",   !  Precipitate ! ",generic:"!   !  ! ",clean_slate:" !    ! ",burner_on:"  !   ! "},chemicals:{baking_soda:["Baking Soda !  Vinegar  ! ","Baking Soda !   ? "],vinegar:["Vinegar () !   ! ","Acid !  Base ! "],hydrogen_peroxide:["Peroxide !   ! ","  Strong ! ! "],potassium_iodide:["Potassium Iodide !   ! ","Catalyst ready!   Foam! "],phenolphthalein:["Indicator !  Base    ! ","  ,  ! "],sodium_hydroxide:["Sodium Hydroxide!   Strong Base! ","Base !  Pink ! "],hydrochloric_acid:["Hydrochloric Acid!   ! ","Strong Acid ! ! "],water:["  (Water)!     ","Water !   ? "],default:["!  ? ! "," Choice!   ? ","! Science ! ","   Try ! "]},welcome:" Lab- !     ! "}},x9=[" Try mixing Baking Soda + Vinegar!"," Add Hydrogen Peroxide and see what happens!"," Use an Indicator to check for Acid or Base!"," Chemistry is fun!"," You are a great scientist!"," Science begins with a question!"," Don't be afraid to try new things!"," Science is like real magic!"],y9={volcano_reaction:{text:"Boom! That's a Volcano! Awesome! ",emotion:"excited",priority:10},elephant_toothpaste:{text:"Wow! Look at all that foam! Amazing! ",emotion:"surprised",priority:10},acid_base_neutralization:{text:"Good job! Acid and Base mixed to become neutral! ",emotion:"cool",priority:8},acid_metal_reaction:{text:"Look! Bubbles! That is Hydrogen gas! ",emotion:"happy",priority:8},indicator_base:{text:"Pink color! That means it is a Base! ",emotion:"happy",priority:7},barium_sulfate_precipitation:{text:"White powder forming! That is a precipitate! ",emotion:"excited",priority:8}},w_={baking_soda:["Baking Soda taken! Mix it with Vinegar! ","Baking Soda ready! What's next? "],vinegar:["Vinegar is here! It is an Acid! ","Vinegar added! Add Baking Soda! "],hydrogen_peroxide:["Hydrogen Peroxide! It is very strong! ","Peroxide added! Watch out! "],potassium_iodide:["Potassium Iodide! This will make foam! ","Catalyst ready! Let's make bubbles! "],phenolphthalein:["Indicator added! Add Base to see pink color! ","It is clear now. Wait for the magic! "],naoh:["Sodium Hydroxide! It is a strong Base! ","Strong Base! Add Indicator! "],sodium_hydroxide:["Sodium Hydroxide! It is a strong Base! ","Strong Base! Add Indicator! "],hcl:["Hydrochloric Acid! It is a strong Acid! ","Strong Acid! Be careful! "],hydrochloric_acid:["Hydrochloric Acid! It is a strong Acid! ","Strong Acid! Be careful! "],water:["Water! We can mix things in it! ","Water added! What should we dissolve? "]},b9=["Good choice! What next? ","Let's see what happens! ","Added to the beaker! ","Keep experimenting! "];function GA(){const i=De(se=>se.experimentMode),e=De(se=>se.ttsLanguage),t=De(se=>se.setTtsLanguage),n=De(se=>se.currentExperiment),r=De(se=>se.reactionNotification),s=De(se=>se.bunsenBurnerOn),l=De(se=>se.vessels),c=De(se=>se.activeEffects),f=De(se=>se.placedApparatus),d=De(se=>se.addedChemicals),m=De(se=>se.experimentActions),g=De(se=>se.isStirring),y=De(se=>se.showExplanation),v=De(se=>se.saltTested),S=De(se=>se.sandTested),T=De(se=>se.iceTested),A=De(se=>se.paperTested),w=De(se=>se.magnesiumTested),R=De(se=>se.dishCracked),D=De(se=>se.dishCrackedAcknowledged),I=De(se=>se.vinegarBlueLitmusTested),z=De(se=>se.vinegarRedLitmusTested),j=De(se=>se.lemonJuiceBlueLitmusTested),X=De(se=>se.lemonJuiceRedLitmusTested),G=De(se=>se.soapSolutionBlueLitmusTested),L=De(se=>se.soapSolutionRedLitmusTested),k=De(se=>se.bakingSodaBlueLitmusTested),U=De(se=>se.bakingSodaRedLitmusTested),q=["salt-dissolution","filtration","evaporation","physical-chemical","acids-bases","neutralization","double-displacement"],W=De(se=>se.isAutoPouring),J=De(se=>se.setShowAssistant),ce=De(se=>se.setAssistantSpeaking),[K,ne]=ge.useState({text:"",emotion:"happy",priority:0}),[pe,Re]=ge.useState(""),[Te,ee]=ge.useState(!0),[F,$]=ge.useState("open"),[re,Ae]=ge.useState(!0),[ie,_e]=ge.useState(1),[ke,Fe]=ge.useState("bubbles"),We=ge.useRef(null),nt=ge.useRef(0),It=ge.useRef(!1),wt=ge.useRef(null),Je=ge.useRef(1),le=ge.useRef(!1),Qe=()=>{Fe(se=>se==="bubbles"?"sparkle":"bubbles"),$s.playRobotClick(),le.current||(le.current=!0,setTimeout(()=>{let se="Hello! Ready for science?";e==="hi"&&(se=Ya.hi.welcome),e==="kok"&&(se=Ya.kok.welcome),ht({text:se,emotion:"happy",priority:2},"none")},300))},[Et,we]=ge.useState([]);ge.useEffect(()=>{const se=()=>{const Ve=window.speechSynthesis.getVoices();Ve.length>0&&we(Ve)};se(),window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=se)},[]);const ot=ge.useCallback((se,Ve,vt=!0,Dt)=>{if(!("speechSynthesis"in window)){Dt?.(),Ve?.();return}vt&&window.speechSynthesis.cancel();const bn=se.replace(/[\u{1F300}-\u{1F9FF}]/gu,"").replace(/[]/g,"").replace(/|/g,"").replace(/\s+/g," ").trim();if(!bn){Dt?.(),Ve?.();return}const dn=new SpeechSynthesisUtterance(bn);e==="hi"||e==="kok"?dn.lang="hi-IN":dn.lang="en-US",dn.rate=1,dn.pitch=1.2,dn.volume=1;const tn=Et.length>0?Et:window.speechSynthesis.getVoices();let gn;e==="hi"||e==="kok"?gn=tn.find(Pn=>(Pn.lang.includes("hi")||Pn.lang.includes("kok"))&&Pn.name.includes("Google"))||tn.find(Pn=>Pn.lang.includes("hi")||Pn.lang.includes("kok")||Pn.lang.includes("mr"))||tn.find(Pn=>Pn.lang==="hi-IN")||tn.find(Pn=>Pn.lang.startsWith("hi")):gn=tn.find(Pn=>Pn.name.includes("Google")&&Pn.lang.startsWith("en"))||tn.find(Pn=>Pn.name==="Samantha")||tn.find(Pn=>Pn.name.includes("Zira"))||tn.find(Pn=>Pn.name.includes("Karen"))||tn.find(Pn=>Pn.name.includes("Female")&&Pn.lang.startsWith("en"))||tn.find(Pn=>Pn.lang==="en-US")||tn.find(Pn=>Pn.lang.startsWith("en"))||tn[0],gn&&(dn.voice=gn),dn.onstart=()=>{ce(!0),Dt?.()},Ve?(dn.onend=()=>{ce(!1),Ve()},dn.onerror=()=>{ce(!1),Ve()}):(dn.onend=()=>ce(!1),dn.onerror=()=>ce(!1)),window.speechSynthesis.speak(dn)},[ce,e,Et]),Ct=n?.id&&q.includes(n.id);if(i!=="sandbox"&&!Ct)return null;const ht=ge.useCallback((se,Ve="beep",vt,Dt=!0)=>{if(se.priority>=Je.current){Je.current=se.priority;const bn=()=>{switch(ne(se),Re(""),ee(!0),_e(se.priority>7?2:1.5),Ve){case"cheer":$s.playRobotCheer();break;case"excited":$s.playRobotExcited();break;case"thinking":$s.playRobotThinking();break;case"click":$s.playRobotClick();break;case"beep":$s.playRobotBeep();break}};ot(se.text,()=>{setTimeout(()=>{Je.current===se.priority&&(Je.current=0,_e(1))},1e3),vt?.()},Dt,bn)}},[ot]);ge.useEffect(()=>{if(!Te)return;const se=K.text;let Ve=0;const vt=setInterval(()=>{Ve<=se.length?(Re(se.slice(0,Ve)),Ve++):(ee(!1),clearInterval(vt))},25);return()=>clearInterval(vt)},[K,Te]),ge.useEffect(()=>{if(!Te)return;const se=K.text;let Ve=0;const vt=setInterval(()=>{Ve<=se.length?(Re(se.slice(0,Ve)),Ve++):(ee(!1),clearInterval(vt))},25);return()=>clearInterval(vt)},[K,Te]),ge.useEffect(()=>{const se=setInterval(()=>{$("closed"),setTimeout(()=>$("open"),120)},2500+Math.random()*2e3);return()=>clearInterval(se)},[]),ge.useEffect(()=>{const se=setTimeout(()=>{$s.playRobotWelcome()},500);return()=>clearTimeout(se)},[]),ge.useEffect(()=>{const se=setTimeout(()=>{$s.playRobotWelcome()},500);return()=>clearTimeout(se)},[]),ge.useEffect(()=>{if(!Ct&&i==="sandbox"){let se="Welcome to my lab!  Let's make science happen!";e==="hi"&&(se=Ya.hi.welcome),e==="kok"&&(se=Ya.kok.welcome),ht({text:se,emotion:"happy",priority:1},"none")}},[Ct,i,ht,e]),ge.useEffect(()=>{if(!Ct&&r&&r.reaction.id!==We.current){We.current=r.reaction.id;let se=y9[r.reaction.id];if(e==="hi"){const Ve=Ya.hi.reactions[r.reaction.id];se&&Ve&&(se={...se,text:Ve})}if(e==="kok"){const Ve=Ya.kok.reactions[r.reaction.id];se&&Ve&&(se={...se,text:Ve})}if(se){const Ve=se.priority>=10?"excited":"cheer";ht(se,Ve),$("star"),Ae(!0),setTimeout(()=>$("open"),2500)}else{const Ve=e==="hi"?Ya.hi.reactions.generic:e==="kok"?Ya.kok.reactions.generic:"Whoa! A reaction! Look at it go! ";ht({text:Ve,emotion:"excited",priority:6},"cheer")}}},[r,ht,n,e]),ge.useEffect(()=>{if(Ct)return;let se=0,Ve=null;if(l.forEach(vt=>{vt.contents.length>0&&(se+=vt.contents.length,Ve=vt.contents[vt.contents.length-1].chemical.id)}),se>nt.current&&Ve){let vt=w_[Ve]||b9;if(e==="hi"){const Dt=Ya.hi.chemicals[Ve];Dt?vt=Dt:w_[Ve]||(vt=Ya.hi.chemicals.default)}if(e==="kok"){const Dt=Ya.kok.chemicals[Ve];Dt?vt=Dt:w_[Ve]||(vt=Ya.kok.chemicals.default)}ht({text:vt[Math.floor(Math.random()*vt.length)],emotion:"happy",priority:3},"click")}else if(se===0&&nt.current>0){const vt=e==="hi"?Ya.hi.reactions.clean_slate:e==="kok"?Ya.kok.reactions.clean_slate:"Clean slate! What experiment next? ";ht({text:vt,emotion:"happy",priority:4},"beep")}nt.current=se},[l,ht,n,e]),ge.useEffect(()=>{if(!Ct&&s!==It.current&&(It.current=s,s)){let se=" FIRE ON! Things are heating up! ";e==="hi"&&(se=Ya.hi.reactions.burner_on),e==="kok"&&(se=Ya.kok.reactions.burner_on),ht({text:se,emotion:"excited",priority:5})}},[s,ht,n,e]),ge.useEffect(()=>{if(c.length>0){const se=c.map(Ve=>Ve.type);(se.includes("massive_foam")||se.includes("foam"))&&($("heart"),setTimeout(()=>$("open"),3e3))}},[c]);const xt=ge.useRef(-1);ge.useEffect(()=>{if(n?.id!=="salt-dissolution")return;let se=0;const Ve=v&&!S,vt=f.includes("beaker"),Dt=d.includes("water"),bn=d.includes("salt"),dn=d.includes("sand"),tn=f.includes("glass-rod"),gn=m.includes("stir");if(vt?Dt?!bn&&!dn?se=2:tn?!gn&&!g?se=4:g?se=5:y?v&&S?se=7:v||S?se=6:se=5:gn&&(se=5):se=3:se=1:se=0,se!==xt.current){xt.current=se,Je.current=0;const $n={0:{text:Ve?" Round 2! Click 'Beaker' to place it on the bench! ":" Welcome! First, click 'Beaker' to place it on the bench! ",emotion:"happy",priority:8},1:{text:"Great! Now click 'Water' to add water to the beaker! ",emotion:"happy",priority:8},2:{text:Ve?"Perfect! Now click 'Sand' to add it to the water! ":"Perfect! Now click 'Salt' to add it to the water! ",emotion:"excited",priority:8},3:{text:"Nice! Click 'Glass Rod' to place it for stirring! ",emotion:"happy",priority:8},4:{text:"Click on the 'Stir' button to stir! ",emotion:"excited",priority:8},5:{text:"Stirring... Watch what happens to the mixture! ",emotion:"thinking",priority:6},6:{text:" Great job! Now click 'Reset' and try with Sand! ",emotion:"excited",priority:9},7:{text:" AMAZING! You completed both tests! Salt dissolves, sand doesn't! ",emotion:"surprised",priority:10}}[se];if($n){const ii=se===7?"cheer":se>=5?"excited":"beep";ht($n,ii)}}},[n,f,d,m,g,y,v,S,ht]);const he=ge.useRef(-1);ge.useEffect(()=>{if(n?.id!=="filtration")return;let se=0;const Ve=f.includes("beaker"),vt=f.includes("funnel"),Dt=f.includes("filter-paper"),bn=d.includes("muddy-water"),dn=m.includes("pour");if(Ve?vt?Dt?bn?!dn&&!W?se=4:W||dn&&!y?se=5:y&&(se=6):se=3:se=2:se=1:se=0,se!==he.current){he.current=se,Je.current=0;const gn={0:{text:" Welcome! Click 'Beaker' to place it on the bench! ",emotion:"happy",priority:8},1:{text:"Great! Click 'Funnel' to set up the filtration! ",emotion:"happy",priority:8},2:{text:"Click 'Filter Paper' to place it in the funnel! ",emotion:"happy",priority:8},3:{text:"Click 'Muddy Water' to add it to the beaker! ",emotion:"excited",priority:8},4:{text:"Click the 'Pour' button to pour muddy water through the funnel! ",emotion:"excited",priority:8},5:{text:"Watch the filtration! Clear water passes! ",emotion:"thinking",priority:6},6:{text:" Filtration complete! The mud is trapped, water is clean! ",emotion:"surprised",priority:10}}[se];gn&&ht(gn,se===6?"cheer":se===5?"excited":"beep")}},[n,f,d,m,W,y,ht]);const Q=ge.useRef(-1),Be=ge.useRef(!1),ue=ge.useRef(!1);ge.useEffect(()=>{if(n?.id!=="evaporation")return;let se=0;const Ve=f.includes("tripod-stand"),vt=f.includes("burner"),Dt=f.includes("china-dish"),bn=d.includes("salt-solution"),dn=m.includes("heat");if(f.length===0&&(Q.current=-1,Be.current=!1,ue.current=!1),s&&Dt&&!bn&&!Be.current){Be.current=!0,_e(3),ht({text:" WARNING! Add 'Salt Solution' to the dish BEFORE heating! Turn off burner! ",emotion:"warning",priority:10},"excited"),setTimeout(()=>_e(1.5),3e3);return}if(bn&&(Be.current=!1),R&&D?se=7:Ve?vt?Dt?bn?!dn&&!s?(se=4,ue.current=!1):(s||dn)&&(ue.current&&y?se=6:se=5):se=3:se=2:se=1:se=0,se!==Q.current){Q.current=se,Je.current=0,se===5&&(ue.current=!0);const gn={0:{text:" Welcome! Click 'Tripod Stand' to place it on the bench! ",emotion:"happy",priority:8},1:{text:"Great! Click 'Burner' to place it under the stand! ",emotion:"happy",priority:8},2:{text:"Click 'China Dish' to place it on the stand! ",emotion:"happy",priority:8},3:{text:"Click 'Salt Solution' to add it to the dish! ",emotion:"excited",priority:8},4:{text:"Click on 'Start Burner' button to turn it on and heat! ",emotion:"excited",priority:8},5:{text:"Heating... Watch the steam rising! ",emotion:"thinking",priority:6},6:{text:" Salt crystals formed! Water evaporated completely! ",emotion:"surprised",priority:10},7:{text:" Oh no! The dish cracked! Click 'Reset' to try again! ",emotion:"warning",priority:10}}[se];gn&&ht(gn,se===6?"cheer":se===7||se===5?"excited":"beep")}},[n,f,d,m,s,y,R,D,ht]);const je=ge.useRef(-1),[Ye,ft]=ge.useState(!1),gt=ge.useRef(null),[Lt,un]=ge.useState(s);ge.useEffect(()=>{if(s)un(!0);else{const se=setTimeout(()=>un(!1),500);return()=>clearTimeout(se)}},[s]),ge.useEffect(()=>()=>{gt.current&&clearTimeout(gt.current)},[]),ge.useEffect(()=>{if(n?.id!=="physical-chemical")return;f.length===0&&(je.current=-1,ft(!1),gt.current&&clearTimeout(gt.current));const se=d.includes("ice"),Ve=d.includes("paper");let vt=1;T&&!se&&(vt=2,A&&!Ve&&(vt=3));let Dt=0;const bn=f.includes("tripod-stand"),dn=f.includes("burner"),tn=f.includes("beaker"),gn=f.includes("tongs"),Pn=d.includes("ice"),Bi=d.includes("paper"),xi=d.includes("magnesium");if(vt===1?bn?dn?tn?Pn?(s||Lt)&&!T?Dt=5:T||y?Ye?Dt=6:Dt=5:gt.current?Dt=5:(Dt=4,ft(!1)):Dt=3:Dt=2:Dt=1:Dt=0:vt===2?dn?gn?Bi?(s||Lt)&&!A?Dt=14:A||y?Dt=15:gt.current?Dt=14:Dt=13:Dt=12:Dt=11:Dt=10:dn?gn?xi?(s||Lt)&&!w?Dt=24:w||y?Dt=25:gt.current?Dt=24:Dt=23:Dt=22:Dt=21:Dt=20,Dt!==je.current){je.current=Dt,Je.current=0,[5,14,24].includes(Dt)&&!Ye&&!gt.current&&(gt.current=setTimeout(()=>{ft(!0),gt.current=null},3500));const ii={0:{text:" Round 1: ICE MELTING! Click 'Tripod Stand'! ",emotion:"happy",priority:8},1:{text:"Click 'Burner' to place it under the stand! ",emotion:"happy",priority:8},2:{text:"Click 'Beaker' to place it on the stand! ",emotion:"happy",priority:8},3:{text:"Click 'Ice Cubes' to add them to the beaker! ",emotion:"excited",priority:8},4:{text:"Click on 'Start Burner' button to turn it on! ",emotion:"excited",priority:8},5:{text:"Heating... Watch the ice melt! ",emotion:"thinking",priority:6},6:{text:" Ice melted! PHYSICAL CHANGE! Click 'Reset' for Round 2! ",emotion:"excited",priority:9},10:{text:" Round 2: PAPER BURNING! Click 'Burner'! ",emotion:"happy",priority:8},11:{text:"Click 'Tongs' to place them! ",emotion:"happy",priority:8},12:{text:"Click 'Paper Strip' to hold it with tongs! ",emotion:"excited",priority:8},13:{text:"Click on 'Start Burner' button to turn it on! ",emotion:"excited",priority:8},14:{text:"Burning... Watch the paper turn to ash! ",emotion:"thinking",priority:6},15:{text:" Paper burned! CHEMICAL CHANGE! Click 'Reset' for Round 3! ",emotion:"excited",priority:9},20:{text:" Round 3: MAGNESIUM! Click 'Burner'! ",emotion:"happy",priority:8},21:{text:"Click 'Tongs' to place them! ",emotion:"happy",priority:8},22:{text:"Click 'Magnesium Ribbon' to hold it! ",emotion:"excited",priority:8},23:{text:"Click on 'Start Burner' button to turn it on! ",emotion:"excited",priority:8},24:{text:"Burning... Watch the bright white flash! ",emotion:"thinking",priority:6},25:{text:" AMAZING! All 3 tests complete! Physical vs Chemical! ",emotion:"surprised",priority:10}}[Dt];if(ii){const wi=Dt===25?"cheer":[6,15].includes(Dt)?"excited":"beep";ht(ii,wi)}}},[n,f,d,s,y,T,A,w,Ye,ht]);const bt=ge.useRef(-1);ge.useEffect(()=>{if(n?.id!=="acids-bases")return;let se=0;const Ve=f.includes("test-tube-stand"),vt=f.includes("test-tube"),Dt=d.includes("vinegar"),bn=d.includes("lemon-juice"),dn=d.includes("soap-solution"),tn=d.includes("baking-soda"),gn=Dt||bn||dn||tn,Pn=d.includes("blue-litmus"),Bi=d.includes("red-litmus"),xi=Dt||bn,$n=dn||tn,ii=[I,z,j,X,G,L,k,U].filter(Boolean).length,wi=f.includes("dropper");let Rn=!1,ir=!1;Dt?(Rn=!I,ir=!z):bn?(Rn=!j,ir=!X):dn?(Rn=!G,ir=!L):tn&&(Rn=!k,ir=!U);let Mi="Choose 'Blue Litmus' OR 'Red Litmus'! ";Rn&&!ir?Mi="Now test with 'Blue Litmus'! ":ir&&!Rn&&(Mi="Now test with 'Red Litmus'! ");const te=I&&z,be=j&&X,Ue=G&&L,lt=k&&U;let Tt="Click 'Vinegar' to start testing! ";if(te?be?Ue?lt||(Tt="Click 'Baking Soda' - last one! "):Tt="Click 'Soap Solution' next! ":Tt="Click 'Lemon Juice' next! ":Tt="Click 'Vinegar' to test! ",y?xi&&Pn?se=5:xi&&Bi?se=6:$n&&Pn?se=7:$n&&Bi&&(se=8):ii>=8?se=10:Ve?vt?gn?wi?!Pn&&!Bi&&(se=4):se=3:se=2:se=1:se=0,se!==bt.current){bt.current=se,Je.current=0;const St=!Rn&&!ir;let Xt="";te&&!be?Xt="Lemon Juice":be&&!Ue?Xt="Soap Solution":Ue&&!lt&&(Xt="Baking Soda");const qt=lt||tn&&St;let an=qt?" Blue turned RED! ACID! All tests complete! ":St?` Blue turned RED! ACID! Reset and test ${Xt}! `:" Blue turned RED! ACID! Reset and test with Red Litmus! ",sn=qt?"Red stays RED! All tests complete! ":St?`Red stays RED! Both done! Reset and test ${Xt}! `:"Red stays RED! Reset and test with Blue Litmus! ",ln=qt?"Blue stays BLUE! All tests complete! ":St?`Blue stays BLUE! Both done! Reset and test ${Xt}! `:"Blue stays BLUE! Reset and test with Red Litmus! ",rn=qt?" Red turned BLUE! BASE! All tests complete! ":St?` Red turned BLUE! BASE! Reset and test ${Xt}! `:" Red turned BLUE! BASE! Reset and test with Blue Litmus! ";const Oe={0:{text:" Click 'Test Tube Stand' to place it! ",emotion:"happy",priority:8},1:{text:"Great! Now click 'Test Tube' to place it on the stand! ",emotion:"happy",priority:8},2:{text:Tt,emotion:"happy",priority:8},3:{text:"Click 'Dropper' to pick it up! ",emotion:"happy",priority:8},4:{text:Mi,emotion:"excited",priority:8},5:{text:an,emotion:"excited",priority:9},6:{text:sn,emotion:"happy",priority:9},7:{text:ln,emotion:"happy",priority:9},8:{text:rn,emotion:"excited",priority:9},10:{text:" All acids & bases identified! Amazing work! ",emotion:"surprised",priority:10}}[se];if(Oe){const $e=se===10?"cheer":se>=3?"excited":"beep";qt&&[5,6,7,8].includes(se)?ht(Oe,$e,()=>{ht({text:" All acids & bases identified! Amazing work! ",emotion:"surprised",priority:10},"cheer",()=>{De.setState({showCompletionPopup:!0})})}):ht(Oe,$e)}}},[n,f,d,y,I,z,j,X,G,L,k,U,ht]);const dt=ge.useRef(-1),Ge=ge.useRef(-1),xe=De(se=>se.neutralizationDropCount),Pe=De(se=>se.neutralizationComplete);ge.useEffect(()=>{if(n?.id!=="neutralization")return;let se=0;const Ve=f.includes("beaker"),vt=d.includes("naoh"),Dt=d.includes("phenolphthalein"),bn=f.includes("dropper");Pe?se=5:Ve?vt?Dt?bn?xe>=0&&xe<5&&(se=4):se=3:se=2:se=1:se=0;const dn=se===4&&xe!==Ge.current;if(se!==dt.current||dn){dt.current=se,Ge.current=xe,Je.current=0,se===5&&De.getState().setNeutralizationAudioDone(!1);const gn={0:{text:" Click 'Beaker' to place it! ",emotion:"happy",priority:8},1:{text:"Great! Click 'NaOH Solution' to add the base! ",emotion:"happy",priority:8},2:{text:"Click 'Phenolphthalein'. Watch for PINK! ",emotion:"excited",priority:8},3:{text:"It's PINK! Click 'Dropper' to pick it up! ",emotion:"excited",priority:8},4:{text:xe===0?"Now click 'Dilute HCl' to START drops! ":`Drop ${xe}...`,emotion:"thinking",priority:xe===0?8:7},5:{text:" NEUTRALIZED! Pink turns COLORLESS! Acid + Base = Salt + Water! Click 'Done'!",emotion:"surprised",priority:10}}[se];gn&&ht(gn,se===5?"cheer":se===4?"click":"beep",()=>{se===5&&setTimeout(()=>{De.getState().setNeutralizationAudioDone(!0)},2e3)},se!==4||xe===0)}},[n,f,d,xe,Pe,ht]);const rt=ge.useRef(-1);ge.useEffect(()=>{if(n?.id!=="double-displacement")return;let se=0;const Ve=f.includes("beaker"),vt=d.includes("sodium-sulphate"),Dt=d.includes("barium-chloride");if(!Ve)se=0;else if(!vt)se=1;else if(!Dt)se=2;else return;if(se!==rt.current){rt.current=se,Je.current=0;const dn={0:{text:" Click 'Beaker' to place it! ",emotion:"happy",priority:8},1:{text:"Click 'Sodium Sulphate' to add it! ",emotion:"happy",priority:8},2:{text:"Now add 'Barium Chloride' and watch the magic! ",emotion:"excited",priority:8}}[se];dn&&ht(dn,"beep")}},[n,f,d,ht]);const Me=De(se=>se.precipitateAnimationPhase),ze=ge.useRef("idle");ge.useEffect(()=>{if(n?.id!=="double-displacement"||Me==="idle"||Me==="intro"||Me===ze.current)return;ze.current=Me;const Ve={mixing:{text:"Step 1: Watch the ions mixing! Sodium, Sulphate, Barium, and Chloride ions are floating around. Click 'Next' when ready! ",emotion:"excited",priority:9},bonding:{text:"Step 2: Barium and Sulphate ions are attracting each other! They're forming bonds. Click 'Next'! ",emotion:"excited",priority:9},precipitating:{text:"Step 3: Barium Sulphate precipitates as white solid, Sodium Chloride remains dissolved! Click 'Done'! ",emotion:"happy",priority:9},complete:{text:" Reaction complete! Click 'Done'! ",emotion:"surprised",priority:10}}[Me];Ve&&ht(Ve,Me==="complete"?"cheer":"excited")},[n,Me,ht]),ge.useEffect(()=>Ct?void 0:(wt.current&&clearTimeout(wt.current),wt.current=setTimeout(()=>{let Ve=x9;e==="hi"&&(Ve=Ya.hi.idle),e==="kok"&&(Ve=Ya.kok.idle),ht({text:Ve[Math.floor(Math.random()*Ve.length)],emotion:"thinking",priority:1},"thinking")},15e3),()=>{wt.current&&clearTimeout(wt.current)}),[K,ht,n,e]);const Mt={happy:{primary:"#00d4ff",secondary:"#0099cc",glow:"rgba(0, 212, 255, 0.6)",bg:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},excited:{primary:"#ff6b6b",secondary:"#ee5a5a",glow:"rgba(255, 107, 107, 0.7)",bg:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"},surprised:{primary:"#ffd93d",secondary:"#ffcc00",glow:"rgba(255, 217, 61, 0.7)",bg:"linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%)"},thinking:{primary:"#a855f7",secondary:"#9333ea",glow:"rgba(168, 85, 247, 0.6)",bg:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},cool:{primary:"#10b981",secondary:"#059669",glow:"rgba(16, 185, 129, 0.6)",bg:"linear-gradient(135deg, #11998e 0%, #38ef7d 100%)"},warning:{primary:"#ff3333",secondary:"#cc0000",glow:"rgba(255, 51, 51, 0.9)",bg:"linear-gradient(135deg, #ff4444 0%, #cc0000 100%)"}},Rt=Mt[K.emotion]||Mt.happy;return _.jsxs("div",{className:"lab-assistant-wrapper",children:[_.jsx("div",{className:"ambient-glow",style:{background:`radial-gradient(ellipse at center, ${Rt.glow} 0%, transparent 70%)`,transform:`scale(${ie})`}}),_.jsxs("div",{className:"premium-bubble",style:{"--bubble-glow":Rt.glow,"--bubble-border":Rt.primary},children:[_.jsx("div",{className:"bubble-shine"}),_.jsxs("div",{className:"bubble-text",children:[pe,Te&&_.jsx("span",{className:"cursor-blink",children:""})]}),_.jsx("div",{className:"bubble-pointer",style:{borderTopColor:Rt.primary}})]}),_.jsxs("div",{className:`premium-robot group ${re?"floating":""}`,style:{pointerEvents:"auto"},children:[_.jsxs("div",{className:"w-full h-full cursor-pointer",onClick:Qe,title:"Click me to change style!",children:[ke==="bubbles"?_.jsxs("svg",{viewBox:"0 0 140 180",className:"robot-svg-premium",children:[_.jsxs("defs",{children:[_.jsxs("linearGradient",{id:"robotHeadGrad",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[_.jsx("stop",{offset:"0%",stopColor:"#5DADE2"}),_.jsx("stop",{offset:"30%",stopColor:"#3498DB"}),_.jsx("stop",{offset:"70%",stopColor:"#2980B9"}),_.jsx("stop",{offset:"100%",stopColor:"#1F618D"})]}),_.jsxs("linearGradient",{id:"robotBodyGrad",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[_.jsx("stop",{offset:"0%",stopColor:"#48C9B0"}),_.jsx("stop",{offset:"50%",stopColor:"#1ABC9C"}),_.jsx("stop",{offset:"100%",stopColor:"#16A085"})]}),_.jsxs("linearGradient",{id:"faceScreenGrad",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[_.jsx("stop",{offset:"0%",stopColor:"#1a1a3e"}),_.jsx("stop",{offset:"100%",stopColor:"#0d0d2b"})]}),_.jsxs("linearGradient",{id:"eyeWhiteGrad",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[_.jsx("stop",{offset:"0%",stopColor:"#ffffff"}),_.jsx("stop",{offset:"100%",stopColor:"#e8e8e8"})]}),_.jsxs("linearGradient",{id:"antennaGrad",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[_.jsx("stop",{offset:"0%",stopColor:"#F39C12"}),_.jsx("stop",{offset:"100%",stopColor:"#E67E22"})]}),_.jsxs("linearGradient",{id:"cheekGrad",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[_.jsx("stop",{offset:"0%",stopColor:"#FFB6C1",stopOpacity:"0.8"}),_.jsx("stop",{offset:"100%",stopColor:"#FF69B4",stopOpacity:"0.4"})]}),_.jsxs("radialGradient",{id:"glowCore",cx:"50%",cy:"50%",r:"50%",children:[_.jsx("stop",{offset:"0%",stopColor:"#00ffcc"}),_.jsx("stop",{offset:"50%",stopColor:"#00d4aa"}),_.jsx("stop",{offset:"100%",stopColor:"#00a080"})]}),_.jsxs("filter",{id:"softGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[_.jsx("feGaussianBlur",{stdDeviation:"4",result:"blur"}),_.jsx("feComposite",{in:"SourceGraphic",in2:"blur",operator:"over"})]}),_.jsxs("filter",{id:"strongGlow",x:"-100%",y:"-100%",width:"300%",height:"300%",children:[_.jsx("feGaussianBlur",{stdDeviation:"6",result:"blur"}),_.jsxs("feMerge",{children:[_.jsx("feMergeNode",{in:"blur"}),_.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),_.jsx("filter",{id:"dropShadow",children:_.jsx("feDropShadow",{dx:"0",dy:"4",stdDeviation:"3",floodOpacity:"0.3"})})]}),_.jsx("g",{className:"sparkle-particles",children:[0,1,2,3,4,5].map(se=>_.jsx("g",{children:_.jsxs("circle",{cx:20+se*20,cy:15+se%2*10,r:"3",fill:"#FFD700",opacity:"0.8",children:[_.jsx("animate",{attributeName:"opacity",values:"0.8;0.2;0.8",dur:`${1.2+se*.2}s`,repeatCount:"indefinite"}),_.jsx("animate",{attributeName:"r",values:"3;4;3",dur:`${1.2+se*.2}s`,repeatCount:"indefinite"})]})},se))}),_.jsxs("g",{className:"antenna-bounce",children:[_.jsx("ellipse",{cx:"70",cy:"28",rx:"4",ry:"12",fill:"url(#antennaGrad)",filter:"url(#dropShadow)",children:_.jsx("animate",{attributeName:"ry",values:"12;14;12",dur:"0.8s",repeatCount:"indefinite"})}),_.jsx("circle",{cx:"70",cy:"12",r:"10",fill:"#FFD700",filter:"url(#strongGlow)",children:_.jsx("animate",{attributeName:"r",values:"10;12;10",dur:"1s",repeatCount:"indefinite"})}),_.jsx("circle",{cx:"70",cy:"12",r:"6",fill:"#FFF8DC"}),_.jsx("circle",{cx:"67",cy:"9",r:"2.5",fill:"white",opacity:"0.9"})]}),_.jsx("ellipse",{cx:"70",cy:"72",rx:"52",ry:"42",fill:"url(#robotHeadGrad)",filter:"url(#dropShadow)"}),_.jsx("ellipse",{cx:"55",cy:"55",rx:"25",ry:"15",fill:"white",opacity:"0.15"}),_.jsx("ellipse",{cx:"70",cy:"72",rx:"50",ry:"40",fill:"none",stroke:"rgba(255,255,255,0.2)",strokeWidth:"2"}),_.jsx("ellipse",{cx:"22",cy:"60",rx:"10",ry:"12",fill:"url(#robotHeadGrad)",filter:"url(#dropShadow)"}),_.jsx("ellipse",{cx:"22",cy:"58",rx:"5",ry:"6",fill:"#5DADE2",opacity:"0.5"}),_.jsx("ellipse",{cx:"118",cy:"60",rx:"10",ry:"12",fill:"url(#robotHeadGrad)",filter:"url(#dropShadow)"}),_.jsx("ellipse",{cx:"118",cy:"58",rx:"5",ry:"6",fill:"#5DADE2",opacity:"0.5"}),_.jsx("rect",{x:"32",y:"48",width:"76",height:"52",rx:"16",fill:"url(#faceScreenGrad)"}),_.jsx("rect",{x:"34",y:"50",width:"72",height:"48",rx:"14",fill:"none",stroke:"#00d4ff",strokeWidth:"1.5",opacity:"0.6"}),_.jsx("g",{className:"pixar-eyes",children:F==="star"?_.jsxs(_.Fragment,{children:[_.jsx("text",{x:"50",y:"80",fontSize:"28",fill:"#FFD700",textAnchor:"middle",filter:"url(#strongGlow)",children:""}),_.jsx("text",{x:"90",y:"80",fontSize:"28",fill:"#FFD700",textAnchor:"middle",filter:"url(#strongGlow)",children:""})]}):F==="heart"?_.jsxs(_.Fragment,{children:[_.jsx("text",{x:"50",y:"80",fontSize:"26",fill:"#FF69B4",textAnchor:"middle",filter:"url(#strongGlow)",children:""}),_.jsx("text",{x:"90",y:"80",fontSize:"26",fill:"#FF69B4",textAnchor:"middle",filter:"url(#strongGlow)",children:""})]}):F==="closed"?_.jsxs(_.Fragment,{children:[_.jsx("path",{d:"M 38 72 Q 50 80 62 72",stroke:"#00d4ff",strokeWidth:"4",fill:"none",strokeLinecap:"round"}),_.jsx("path",{d:"M 78 72 Q 90 80 102 72",stroke:"#00d4ff",strokeWidth:"4",fill:"none",strokeLinecap:"round"})]}):_.jsxs(_.Fragment,{children:[_.jsx("ellipse",{cx:"50",cy:"72",rx:"16",ry:"18",fill:"url(#eyeWhiteGrad)"}),_.jsx("ellipse",{cx:"52",cy:"73",rx:"9",ry:"10",fill:"#1a1a3e",children:_.jsx("animate",{attributeName:"cx",values:"52;50;52",dur:"4s",repeatCount:"indefinite"})}),_.jsx("ellipse",{cx:"53",cy:"74",rx:"5",ry:"6",fill:"#000",children:_.jsx("animate",{attributeName:"ry",values:"6;5;6",dur:"2s",repeatCount:"indefinite"})}),_.jsx("circle",{cx:"46",cy:"68",r:"4",fill:"white"}),_.jsx("circle",{cx:"55",cy:"76",r:"2",fill:"white",opacity:"0.8"}),_.jsx("ellipse",{cx:"90",cy:"72",rx:"16",ry:"18",fill:"url(#eyeWhiteGrad)"}),_.jsx("ellipse",{cx:"92",cy:"73",rx:"9",ry:"10",fill:"#1a1a3e",children:_.jsx("animate",{attributeName:"cx",values:"92;90;92",dur:"4s",repeatCount:"indefinite"})}),_.jsx("ellipse",{cx:"93",cy:"74",rx:"5",ry:"6",fill:"#000",children:_.jsx("animate",{attributeName:"ry",values:"6;5;6",dur:"2s",repeatCount:"indefinite"})}),_.jsx("circle",{cx:"86",cy:"68",r:"4",fill:"white"}),_.jsx("circle",{cx:"95",cy:"76",r:"2",fill:"white",opacity:"0.8"})]})}),_.jsx("ellipse",{cx:"30",cy:"85",rx:"8",ry:"5",fill:"url(#cheekGrad)",opacity:"0.7",children:_.jsx("animate",{attributeName:"opacity",values:"0.7;0.5;0.7",dur:"2s",repeatCount:"indefinite"})}),_.jsx("ellipse",{cx:"110",cy:"85",rx:"8",ry:"5",fill:"url(#cheekGrad)",opacity:"0.7",children:_.jsx("animate",{attributeName:"opacity",values:"0.7;0.5;0.7",dur:"2s",repeatCount:"indefinite"})}),_.jsx("g",{className:"cute-mouth",children:K.emotion==="excited"||K.emotion==="surprised"?_.jsx("ellipse",{cx:"70",cy:"95",rx:"10",ry:"8",fill:"#00d4ff",filter:"url(#softGlow)",children:_.jsx("animate",{attributeName:"ry",values:"8;10;8",dur:"0.4s",repeatCount:"indefinite"})}):_.jsx("path",{d:"M 58 92 Q 70 102 82 92",stroke:"#00d4ff",strokeWidth:"4",fill:"none",strokeLinecap:"round",filter:"url(#softGlow)"})}),_.jsx("ellipse",{cx:"70",cy:"140",rx:"38",ry:"32",fill:"url(#robotBodyGrad)",filter:"url(#dropShadow)"}),_.jsx("ellipse",{cx:"58",cy:"128",rx:"18",ry:"12",fill:"white",opacity:"0.12"}),_.jsx("ellipse",{cx:"70",cy:"140",rx:"14",ry:"12",fill:"url(#glowCore)",filter:"url(#strongGlow)",children:_.jsx("animate",{attributeName:"rx",values:"14;16;14",dur:"1.5s",repeatCount:"indefinite"})}),_.jsx("ellipse",{cx:"70",cy:"140",rx:"8",ry:"6",fill:"white",opacity:"0.9",children:_.jsx("animate",{attributeName:"opacity",values:"0.9;0.6;0.9",dur:"0.8s",repeatCount:"indefinite"})}),_.jsx("text",{x:"70",y:"144",fontSize:"10",fill:"#006655",textAnchor:"middle",fontWeight:"bold",children:""}),_.jsx("ellipse",{cx:"28",cy:"138",rx:"10",ry:"8",fill:"url(#robotBodyGrad)",filter:"url(#dropShadow)",children:_.jsx("animate",{attributeName:"cy",values:"138;136;138",dur:"2s",repeatCount:"indefinite"})}),_.jsx("ellipse",{cx:"112",cy:"138",rx:"10",ry:"8",fill:"url(#robotBodyGrad)",filter:"url(#dropShadow)",children:_.jsx("animate",{attributeName:"cy",values:"138;140;138",dur:"2s",repeatCount:"indefinite"})}),_.jsx("ellipse",{cx:"52",cy:"170",rx:"12",ry:"6",fill:"url(#robotHeadGrad)",filter:"url(#dropShadow)"}),_.jsx("ellipse",{cx:"88",cy:"170",rx:"12",ry:"6",fill:"url(#robotHeadGrad)",filter:"url(#dropShadow)"})]}):_.jsxs("svg",{viewBox:"0 0 140 180",className:"robot-svg-premium",children:[_.jsxs("defs",{children:[_.jsxs("linearGradient",{id:"sparkleHeadGrad",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[_.jsx("stop",{offset:"0%",stopColor:"#F8BBD9"}),_.jsx("stop",{offset:"30%",stopColor:"#E91E9C"}),_.jsx("stop",{offset:"70%",stopColor:"#C2185B"}),_.jsx("stop",{offset:"100%",stopColor:"#880E4F"})]}),_.jsxs("linearGradient",{id:"sparkleBodyGrad",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[_.jsx("stop",{offset:"0%",stopColor:"#CE93D8"}),_.jsx("stop",{offset:"50%",stopColor:"#AB47BC"}),_.jsx("stop",{offset:"100%",stopColor:"#7B1FA2"})]}),_.jsxs("linearGradient",{id:"sparkleFaceGrad",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[_.jsx("stop",{offset:"0%",stopColor:"#2a1a3e"}),_.jsx("stop",{offset:"100%",stopColor:"#1a0d2b"})]}),_.jsxs("linearGradient",{id:"sparkleEyeGrad",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[_.jsx("stop",{offset:"0%",stopColor:"#ffffff"}),_.jsx("stop",{offset:"100%",stopColor:"#f0e8f8"})]}),_.jsxs("linearGradient",{id:"catEarGrad",x1:"0%",y1:"100%",x2:"0%",y2:"0%",children:[_.jsx("stop",{offset:"0%",stopColor:"#E91E9C"}),_.jsx("stop",{offset:"100%",stopColor:"#F48FB1"})]}),_.jsxs("linearGradient",{id:"catEarInner",x1:"0%",y1:"100%",x2:"0%",y2:"0%",children:[_.jsx("stop",{offset:"0%",stopColor:"#FFB6C1"}),_.jsx("stop",{offset:"100%",stopColor:"#FFC1E3"})]}),_.jsxs("radialGradient",{id:"sparkleCore",cx:"50%",cy:"50%",r:"50%",children:[_.jsx("stop",{offset:"0%",stopColor:"#FF69B4"}),_.jsx("stop",{offset:"50%",stopColor:"#E91E9C"}),_.jsx("stop",{offset:"100%",stopColor:"#C2185B"})]}),_.jsxs("filter",{id:"pinkGlow",x:"-100%",y:"-100%",width:"300%",height:"300%",children:[_.jsx("feGaussianBlur",{stdDeviation:"5",result:"blur"}),_.jsxs("feMerge",{children:[_.jsx("feMergeNode",{in:"blur"}),_.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),_.jsxs("filter",{id:"starGlow",x:"-100%",y:"-100%",width:"300%",height:"300%",children:[_.jsx("feGaussianBlur",{stdDeviation:"3",result:"blur"}),_.jsxs("feMerge",{children:[_.jsx("feMergeNode",{in:"blur"}),_.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),_.jsx("filter",{id:"softShadow",children:_.jsx("feDropShadow",{dx:"0",dy:"4",stdDeviation:"3",floodOpacity:"0.4"})})]}),_.jsx("g",{className:"magic-stars",children:[0,1,2,3,4,5,6].map(se=>_.jsxs("text",{x:15+se*18,y:12+se%3*8,fontSize:"10",fill:"#FFD700",opacity:"0.9",filter:"url(#starGlow)",children:[_.jsx("animate",{attributeName:"opacity",values:"0.9;0.3;0.9",dur:`${1+se*.15}s`,repeatCount:"indefinite"}),_.jsx("animate",{attributeName:"y",values:`${12+se%3*8};${8+se%3*8};${12+se%3*8}`,dur:`${1.5+se*.2}s`,repeatCount:"indefinite"}),""]},se))}),_.jsx("polygon",{points:"25,45 40,75 10,75",fill:"url(#catEarGrad)",filter:"url(#softShadow)"}),_.jsx("polygon",{points:"28,52 37,70 18,70",fill:"url(#catEarInner)"}),_.jsx("polygon",{points:"115,45 130,75 100,75",fill:"url(#catEarGrad)",filter:"url(#softShadow)"}),_.jsx("polygon",{points:"112,52 122,70 102,70",fill:"url(#catEarInner)"}),_.jsxs("g",{className:"tiara",children:[_.jsx("ellipse",{cx:"70",cy:"38",rx:"25",ry:"8",fill:"#FFD700",filter:"url(#starGlow)"}),_.jsx("circle",{cx:"70",cy:"32",r:"6",fill:"#FF69B4",filter:"url(#pinkGlow)",children:_.jsx("animate",{attributeName:"r",values:"6;7;6",dur:"1s",repeatCount:"indefinite"})}),_.jsx("text",{x:"70",y:"36",fontSize:"8",fill:"#FFD700",textAnchor:"middle",children:""})]}),_.jsx("ellipse",{cx:"70",cy:"78",rx:"48",ry:"40",fill:"url(#sparkleHeadGrad)",filter:"url(#softShadow)"}),_.jsx("ellipse",{cx:"55",cy:"62",rx:"22",ry:"14",fill:"white",opacity:"0.18"}),_.jsx("ellipse",{cx:"70",cy:"78",rx:"46",ry:"38",fill:"none",stroke:"rgba(255,255,255,0.25)",strokeWidth:"2"}),_.jsx("rect",{x:"32",y:"55",width:"76",height:"48",rx:"18",fill:"url(#sparkleFaceGrad)"}),_.jsx("rect",{x:"34",y:"57",width:"72",height:"44",rx:"16",fill:"none",stroke:"#FF69B4",strokeWidth:"1.5",opacity:"0.6"}),_.jsx("g",{className:"sparkle-eyes",children:F==="star"?_.jsxs(_.Fragment,{children:[_.jsx("text",{x:"50",y:"86",fontSize:"30",fill:"#FFD700",textAnchor:"middle",filter:"url(#pinkGlow)",children:""}),_.jsx("text",{x:"90",y:"86",fontSize:"30",fill:"#FFD700",textAnchor:"middle",filter:"url(#pinkGlow)",children:""})]}):F==="heart"?_.jsxs(_.Fragment,{children:[_.jsx("text",{x:"50",y:"86",fontSize:"28",fill:"#FF1493",textAnchor:"middle",filter:"url(#pinkGlow)",children:""}),_.jsx("text",{x:"90",y:"86",fontSize:"28",fill:"#FF1493",textAnchor:"middle",filter:"url(#pinkGlow)",children:""})]}):F==="closed"?_.jsxs(_.Fragment,{children:[_.jsx("path",{d:"M 36 78 Q 50 88 64 78",stroke:"#FF69B4",strokeWidth:"4",fill:"none",strokeLinecap:"round"}),_.jsx("path",{d:"M 76 78 Q 90 88 104 78",stroke:"#FF69B4",strokeWidth:"4",fill:"none",strokeLinecap:"round"})]}):_.jsxs(_.Fragment,{children:[_.jsx("ellipse",{cx:"50",cy:"78",rx:"16",ry:"18",fill:"url(#sparkleEyeGrad)"}),_.jsx("ellipse",{cx:"52",cy:"79",rx:"10",ry:"11",fill:"#6A1B9A",children:_.jsx("animate",{attributeName:"cx",values:"52;50;52",dur:"3.5s",repeatCount:"indefinite"})}),_.jsx("ellipse",{cx:"53",cy:"80",rx:"5",ry:"6",fill:"#1a0a2e",children:_.jsx("animate",{attributeName:"ry",values:"6;5;6",dur:"2s",repeatCount:"indefinite"})}),_.jsx("text",{x:"47",y:"76",fontSize:"10",fill:"#FFD700",filter:"url(#starGlow)",children:""}),_.jsx("circle",{cx:"56",cy:"83",r:"2",fill:"white",opacity:"0.8"}),_.jsx("ellipse",{cx:"90",cy:"78",rx:"16",ry:"18",fill:"url(#sparkleEyeGrad)"}),_.jsx("ellipse",{cx:"92",cy:"79",rx:"10",ry:"11",fill:"#6A1B9A",children:_.jsx("animate",{attributeName:"cx",values:"92;90;92",dur:"3.5s",repeatCount:"indefinite"})}),_.jsx("ellipse",{cx:"93",cy:"80",rx:"5",ry:"6",fill:"#1a0a2e",children:_.jsx("animate",{attributeName:"ry",values:"6;5;6",dur:"2s",repeatCount:"indefinite"})}),_.jsx("text",{x:"87",y:"76",fontSize:"10",fill:"#FFD700",filter:"url(#starGlow)",children:""}),_.jsx("circle",{cx:"96",cy:"83",r:"2",fill:"white",opacity:"0.8"})]})}),_.jsx("ellipse",{cx:"28",cy:"92",rx:"9",ry:"6",fill:"#FFB6C1",opacity:"0.8",children:_.jsx("animate",{attributeName:"opacity",values:"0.8;0.5;0.8",dur:"2s",repeatCount:"indefinite"})}),_.jsx("ellipse",{cx:"112",cy:"92",rx:"9",ry:"6",fill:"#FFB6C1",opacity:"0.8",children:_.jsx("animate",{attributeName:"opacity",values:"0.8;0.5;0.8",dur:"2s",repeatCount:"indefinite"})}),_.jsx("ellipse",{cx:"70",cy:"95",rx:"4",ry:"3",fill:"#FF69B4"}),_.jsx("g",{className:"cat-mouth",children:K.emotion==="excited"||K.emotion==="surprised"?_.jsx("ellipse",{cx:"70",cy:"102",rx:"8",ry:"6",fill:"#FF69B4",filter:"url(#pinkGlow)",children:_.jsx("animate",{attributeName:"ry",values:"6;8;6",dur:"0.4s",repeatCount:"indefinite"})}):_.jsx("path",{d:"M 62 100 Q 66 106 70 100 Q 74 106 78 100",stroke:"#FF69B4",strokeWidth:"2.5",fill:"none",strokeLinecap:"round"})}),_.jsxs("g",{className:"whiskers",opacity:"0.6",children:[_.jsx("line",{x1:"20",y1:"88",x2:"30",y2:"90",stroke:"#FFB6C1",strokeWidth:"1.5",strokeLinecap:"round"}),_.jsx("line",{x1:"18",y1:"94",x2:"28",y2:"94",stroke:"#FFB6C1",strokeWidth:"1.5",strokeLinecap:"round"}),_.jsx("line",{x1:"20",y1:"100",x2:"30",y2:"98",stroke:"#FFB6C1",strokeWidth:"1.5",strokeLinecap:"round"}),_.jsx("line",{x1:"120",y1:"88",x2:"110",y2:"90",stroke:"#FFB6C1",strokeWidth:"1.5",strokeLinecap:"round"}),_.jsx("line",{x1:"122",y1:"94",x2:"112",y2:"94",stroke:"#FFB6C1",strokeWidth:"1.5",strokeLinecap:"round"}),_.jsx("line",{x1:"120",y1:"100",x2:"110",y2:"98",stroke:"#FFB6C1",strokeWidth:"1.5",strokeLinecap:"round"})]}),_.jsx("ellipse",{cx:"70",cy:"145",rx:"36",ry:"30",fill:"url(#sparkleBodyGrad)",filter:"url(#softShadow)"}),_.jsx("ellipse",{cx:"56",cy:"132",rx:"16",ry:"10",fill:"white",opacity:"0.15"}),_.jsx("ellipse",{cx:"70",cy:"145",rx:"14",ry:"12",fill:"url(#sparkleCore)",filter:"url(#pinkGlow)",children:_.jsx("animate",{attributeName:"rx",values:"14;16;14",dur:"1.2s",repeatCount:"indefinite"})}),_.jsxs("text",{x:"70",y:"150",fontSize:"14",fill:"#FFD700",textAnchor:"middle",filter:"url(#starGlow)",children:[_.jsx("animate",{attributeName:"opacity",values:"1;0.6;1",dur:"0.8s",repeatCount:"indefinite"}),""]}),_.jsx("ellipse",{cx:"30",cy:"142",rx:"11",ry:"9",fill:"url(#sparkleBodyGrad)",filter:"url(#softShadow)",children:_.jsx("animate",{attributeName:"cy",values:"142;140;142",dur:"2s",repeatCount:"indefinite"})}),_.jsx("ellipse",{cx:"28",cy:"144",rx:"4",ry:"3",fill:"#FFB6C1",opacity:"0.7"}),_.jsx("ellipse",{cx:"110",cy:"142",rx:"11",ry:"9",fill:"url(#sparkleBodyGrad)",filter:"url(#softShadow)",children:_.jsx("animate",{attributeName:"cy",values:"142;144;142",dur:"2s",repeatCount:"indefinite"})}),_.jsx("ellipse",{cx:"112",cy:"144",rx:"4",ry:"3",fill:"#FFB6C1",opacity:"0.7"}),_.jsx("ellipse",{cx:"52",cy:"172",rx:"12",ry:"6",fill:"url(#sparkleHeadGrad)",filter:"url(#softShadow)"}),_.jsx("ellipse",{cx:"88",cy:"172",rx:"12",ry:"6",fill:"url(#sparkleHeadGrad)",filter:"url(#softShadow)"})]}),_.jsxs("div",{className:"holo-badge",style:{background:ke==="bubbles"?Rt.bg:"linear-gradient(135deg, #FF69B4 0%, #9C27B0 100%)"},children:[_.jsx("span",{className:"badge-text",children:ke==="bubbles"?"BUBBLES":"SPARKLE"}),_.jsx("div",{className:"badge-shine"})]})]}),(K.emotion==="excited"||K.emotion==="surprised")&&_.jsx("div",{className:"sparkle-container",children:[...Array(8)].map((se,Ve)=>_.jsx("span",{className:"sparkle",style:{"--i":Ve,"--color":Rt.primary},children:""},Ve))}),_.jsx("button",{className:"absolute -top-2 left-0 z-50 flex items-center justify-center h-6 px-2 text-[10px] font-bold text-white transition-all bg-indigo-600 border rounded-full shadow-lg cursor-pointer hover:bg-indigo-500 hover:scale-110 active:scale-95 border-white/20",onClick:se=>{se.stopPropagation(),t(e==="en"?"hi":e==="hi"?"kok":"en"),setTimeout(()=>{ht({text:{en:"English selected!",hi:"  !",kok:" !"}[e==="en"?"hi":e==="hi"?"kok":"en"],emotion:"happy",priority:10},"none")},100)},title:"Switch Language",children:e==="en"?"EN":e==="hi"?"HI":"KOK"}),_.jsx("button",{onClick:se=>{se.stopPropagation(),se.preventDefault(),J(!1),$s.playDropSound()},onTouchEnd:se=>{se.stopPropagation(),se.preventDefault(),J(!1),$s.playDropSound()},className:"flex absolute -top-2 -right-2 z-50 w-6 h-6 rounded-full bg-red-500 hover:bg-red-600 text-white items-center justify-center shadow-lg border border-white/20 transition-all hover:scale-110 active:scale-95 cursor-pointer",title:"Close Assistant",children:_.jsx(r1,{size:14,strokeWidth:3})})]})]})}function _9(){const i=De(r=>r.vessels),e=De(r=>r.selectedVesselId),t=De(r=>r.selectVessel),n=De(r=>r.clearVessel);return _.jsx("div",{className:"w-full relative space-y-3",children:_.jsx("div",{className:"space-y-3",children:Array.from(i.values()).map((r,s)=>{const l=r.id===e,f=Array.from(i.values()).filter(v=>v.type===r.type),d=f.findIndex(v=>v.id===r.id)+1,m=f.length>1,g=v=>v.charAt(0).toUpperCase()+v.slice(1).replace(/_/g," "),y=r.name||`${g(r.type)}${m?" "+d:""} `;return _.jsxs("div",{className:`p-4 rounded-[20px] cursor-pointer transition-all duration-300 relative overflow-hidden group
                ${l?"bg-gradient-to-br from-cyan-500/10 to-blue-600/10 border border-cyan-400/30":"bg-white/5 border border-white/5 hover:bg-white/10 hover:border-white/10"}`,onClick:()=>t(r.id),children:[l&&_.jsx("div",{className:"absolute inset-0 bg-cyan-400/5 animate-pulse-slow"}),_.jsxs("div",{className:"flex flex-col items-center justify-center mb-2 relative z-10 w-full text-center",children:[_.jsx("div",{className:"flex flex-col items-center",children:_.jsx("span",{className:`font - semibold tracking - wide text - sm ${l?"text-white":"text-white/70"} `,children:y})}),l&&_.jsx("div",{className:"mt-2 w-1.5 h-1.5 rounded-full bg-cyan-400 box-shadow-[0_0_10px_rgba(34,211,238,0.6)] animate-pulse"})]}),_.jsx("div",{className:"relative z-10 mt-2 flex justify-center",children:_.jsx("div",{className:`text-[11px] px-3 py-2 rounded-lg ${l?"bg-black/40 text-cyan-100/90":"bg-black/20 text-white/50"}`,children:r.contents.length>0?_.jsx("div",{className:"flex flex-wrap gap-1.5",children:r.contents.map((v,S)=>_.jsxs("span",{className:"inline-flex items-center gap-1",children:[S>0&&_.jsx("span",{className:"opacity-30",children:""}),_.jsx("span",{children:v.chemical.name})]},S))}):_.jsx("span",{className:"italic opacity-60",children:"Empty Container"})})}),l&&r.contents.length>0&&_.jsx("div",{className:"flex gap-2 mt-3 relative z-10 animate-in slide-in-from-top-2 fade-in duration-300",children:_.jsx("button",{onClick:v=>{v.stopPropagation(),n(r.id)},className:"w-full text-xs bg-red-500/10 hover:bg-red-500/20 text-red-400 hover:text-red-300 py-2.5 px-3 rounded-xl border border-red-500/20 hover:border-red-500/40 transition-all font-semibold flex items-center justify-center gap-2 active:scale-95",children:" Empty Contents"})})]},r.id)})})})}function S9(){const i=De(k=>k.isPouringActive),e=De(k=>k.activeEffects),t=De(k=>k.bunsenBurnerOn),n=De(k=>k.toggleBunsenBurner),r=De(k=>k.experimentMode),s=De(k=>k.showLab),l=De(k=>k.currentExperiment),c=De(k=>k.goToHomeScreen),f=De(k=>k.loadExperiment),d=De(k=>k.showCompletionPopup),m=De(k=>k.selectedVesselId),g=De(k=>k.clearVessel),y=De(k=>k.showAssistant),v=De(k=>k.toggleAssistant),[S,T]=ge.useState(!1),[A,w]=ge.useState(!1),[R,D]=ge.useState(!1),[I,z]=ge.useState("chemicals"),[j,X]=ge.useState(!0);ge.useEffect(()=>{const k=()=>D(window.innerWidth<768);return k(),window.addEventListener("resize",k),()=>window.removeEventListener("resize",k)},[]),ge.useEffect(()=>{console.log("deployment-version-check: v4.9-mobile-fix-"+Date.now())},[]),ge.useEffect(()=>{if(d){const k=setTimeout(()=>{T(!0),De.setState({showCompletionPopup:!1})},3e3);return()=>clearTimeout(k)}},[d]),ge.useEffect(()=>{const k=()=>{$s.initialize(),document.removeEventListener("click",k),document.removeEventListener("keydown",k)};return document.addEventListener("click",k),document.addEventListener("keydown",k),()=>{document.removeEventListener("click",k),document.removeEventListener("keydown",k)}},[]);const G=()=>{if(l){const k=p2(),U=k.findIndex(q=>q.id===l.id);U<k.length-1&&(T(!1),f(k[U+1].id))}};if(!s)return _.jsx(g9,{});const L=r==="guided"&&l!==null;return R?_.jsxs("div",{className:"w-full h-full relative flex flex-col pt-[env(safe-area-inset-top)] bg-black/20",children:[_.jsxs("div",{className:"flex items-center justify-between z-10 shrink-0 px-2 py-1 bg-black/30 backdrop-blur-xl border-b border-white/10",style:{minHeight:"48px"},children:[_.jsxs("button",{onClick:c,className:"text-cyan-400/90 hover:text-cyan-400 transition-colors text-base font-medium px-3 py-2 flex items-center gap-1 active:opacity-50",children:[_.jsx("span",{className:"text-xl leading-none mb-0.5",children:""})," Back"]}),_.jsx("h1",{className:"brand-title text-[15px] font-semibold text-white tracking-wide truncate flex-1 text-center px-1",children:L?l?.title:"3D Chemistry Lab"}),_.jsx("button",{onClick:()=>X(!j),className:"text-cyan-400/90 text-lg px-3 py-2 active:opacity-50",children:j?"":""})]}),_.jsxs("div",{className:"flex-1 relative",style:{minHeight:"200px"},children:[L&&_.jsx(v9,{}),_.jsx(vM,{className:"w-full h-full",isMobile:!0}),_.jsx(MM,{}),i&&_.jsxs("div",{className:"absolute top-3 left-3 bg-orange-500/90 backdrop-blur-md text-white text-[11px] font-bold px-3 py-1.5 rounded-full shadow-lg flex items-center gap-1.5 animate-pulse",children:[_.jsx("span",{className:"w-1.5 h-1.5 bg-white rounded-full"})," Pouring..."]}),e.length>0&&_.jsxs("div",{className:"absolute top-3 right-3 bg-purple-500/90 backdrop-blur-md text-white text-[11px] font-bold px-3 py-1.5 rounded-full shadow-lg flex items-center gap-1.5",children:["Reacting ",_.jsx("span",{className:"text-xs",children:""})]})]}),_.jsxs("div",{className:`z-20 w-full rounded-t-[32px] border-t border-white/15 bg-[#0f1115]/85 backdrop-blur-2xl shadow-[0_-8px_32px_rgba(0,0,0,0.6)] transition-all duration-500 cubic-bezier(0.32, 0.72, 0, 1) flex flex-col shrink-0 ${j?"h-[46vh]":"h-14"}`,children:[_.jsx("div",{className:"w-full h-7 flex items-center justify-center shrink-0 cursor-pointer active:bg-white/5",onClick:()=>X(!j),children:_.jsx("div",{className:"w-12 h-1.5 bg-zinc-600/60 rounded-full mt-1"})}),_.jsxs("div",{className:"flex-1 overflow-y-auto px-2 pb-2 pt-1",children:[(!L||I==="chemicals")&&_.jsxs("div",{className:"mobile-shelf animate-in fade-in duration-300",children:[!L&&_.jsx("div",{className:"mt-4 pt-4 border-t border-white/5",children:_.jsxs("button",{onClick:()=>m&&g(m),className:"w-full flex items-center justify-center gap-2 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-400 rounded-lg text-xs font-bold uppercase tracking-wider transition-colors",children:[_.jsx(wF,{className:"w-3.5 h-3.5"}),"Empty Vessel"]})}),_.jsx(wM,{})]}),I==="steps"&&_.jsx("div",{className:"mobile-steps animate-in fade-in duration-300",children:L?_.jsx(zA,{layout:"mobile"}):_.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-2xl p-5 mb-4",children:[_.jsx("h3",{className:"text-[13px] font-bold text-zinc-400 uppercase tracking-wider mb-3",children:"Quick Guide"}),_.jsxs("div",{className:"space-y-3 text-[14px] text-zinc-300 leading-relaxed font-normal",children:[_.jsxs("p",{children:[" Tap default ",_.jsx("strong",{children:"Power"})," to heat."]}),_.jsxs("p",{children:[" Add ",_.jsx("strong",{children:"Chemicals"})," from the grid."]}),_.jsxs("p",{children:[" ",_.jsx("strong",{children:"Reset"})," anytime to clear."]})]})]})}),I==="burner"&&_.jsxs("div",{className:"p-2",children:[_.jsx("button",{onClick:n,className:`w-full py-4 px-4 rounded-2xl font-bold text-lg transition-all active:scale-95 shadow-lg ${t?"bg-gradient-to-r from-orange-500 to-red-600 text-white shadow-orange-500/20":"bg-zinc-800 text-zinc-400 border border-white/5"}`,children:t?"Turn Burner OFF":"Turn Burner ON"}),_.jsx("p",{className:"text-[13px] text-zinc-500 mt-3 text-center font-medium",children:"Controls the heating plate temperature"})]})]}),L&&_.jsxs("div",{className:"grid grid-cols-2 bg-black/20 border-t border-white/5 shrink-0 pb-safe backdrop-blur-md",children:[_.jsxs("button",{onClick:()=>{z("chemicals"),j||X(!0)},className:`group py-2 transition-all flex flex-row justify-center items-center gap-2 active:scale-95 ${I==="chemicals"?"text-cyan-400":"text-zinc-500"}`,children:[_.jsx("div",{className:`p-1 rounded-full transition-colors ${I==="chemicals"?"bg-cyan-400/10":"bg-transparent"}`,children:_.jsx("span",{className:"text-lg block",children:""})}),_.jsx("span",{className:"text-[11px] font-semibold tracking-wide",children:"Chemicals"})]}),_.jsxs("button",{onClick:()=>{z("steps"),j||X(!0)},className:`group py-2 transition-all flex flex-row justify-center items-center gap-2 active:scale-95 ${I==="steps"?"text-cyan-400":"text-zinc-500"}`,children:[_.jsx("div",{className:`p-1 rounded-full transition-colors ${I==="steps"?"bg-cyan-400/10":"bg-transparent"}`,children:_.jsx("span",{className:"text-lg block",children:""})}),_.jsx("span",{className:"text-[11px] font-semibold tracking-wide",children:"Steps"})]})]})]}),_.jsx(VA,{isOpen:S,onClose:()=>T(!1),onViewLabRecord:()=>{T(!1),w(!0)},onNextExperiment:G}),_.jsx(jA,{}),y&&_.jsx(GA,{}),_.jsx(HA,{isOpen:A,onClose:()=>w(!1)})]}):_.jsxs("div",{className:"w-full h-full relative",children:[_.jsxs("div",{className:"ambient-background",children:[_.jsx("div",{className:"orb orb-1"}),_.jsx("div",{className:"orb orb-2"}),_.jsx("div",{className:"orb orb-3"})]}),_.jsx(vM,{className:"w-full h-full"}),_.jsx("div",{className:"absolute inset-0 pointer-events-none z-0",style:{background:"radial-gradient(circle at 50% 50%, transparent 10%, rgba(5,5,5,0.6) 90%)"}}),_.jsx(MM,{}),_.jsxs("div",{className:"absolute inset-0 pointer-events-none p-8 flex flex-col justify-between",children:[_.jsxs("div",{className:"flex justify-between items-start w-full",children:[_.jsxs("div",{className:"pointer-events-auto",children:[_.jsxs("div",{className:"glass-panel px-6 py-4 rounded-[24px] backdrop-blur-2xl bg-black/40 border-white/10 shadow-2xl flex items-center gap-6 animate-in slide-in-from-top-4 duration-700",children:[_.jsx("button",{onClick:()=>{c()},className:"w-10 h-10 rounded-full bg-white/5 hover:bg-white/10 border border-white/10 flex items-center justify-center text-white/80 hover:text-white transition-all active:scale-95 group",title:"Back to Experiments",children:_.jsx(JU,{className:"w-4 h-4 group-hover:-translate-x-0.5 transition-transform"})}),_.jsx("div",{className:"h-8 w-[1px] bg-white/10"}),_.jsxs("div",{children:[_.jsx("h1",{className:"text-xl font-bold text-white tracking-tight leading-none bg-gradient-to-r from-white to-white/70 bg-clip-text text-transparent",children:l?.title||"3D Chemistry Lab"}),l&&_.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[_.jsxs("span",{className:"text-xs font-medium text-cyan-400/90 tracking-wide uppercase px-2 py-0.5 rounded-full bg-cyan-500/10 border border-cyan-500/20",children:["Class ",l.classLevel]}),_.jsx("span",{className:"text-xs text-white/40",children:""}),_.jsx("span",{className:"text-xs text-white/60 font-medium",children:l.chapter})]})]}),l&&_.jsxs(_.Fragment,{children:[_.jsx("div",{className:"h-8 w-[1px] bg-white/10"}),_.jsx("button",{onClick:()=>w(!0),className:"w-10 h-10 rounded-full bg-white/5 hover:bg-white/10 border border-white/10 flex items-center justify-center text-cyan-400/80 hover:text-cyan-400 transition-all active:scale-95 group",title:"View Lab Record",children:_.jsx(vb,{className:"w-4 h-4 group-hover:scale-110 transition-transform"})})]})]}),_.jsxs("div",{className:"mt-4 flex gap-3",children:[i&&_.jsxs("div",{className:"backdrop-blur-xl bg-orange-500/10 border border-orange-500/20 text-orange-200 text-xs font-bold px-4 py-2 rounded-full shadow-lg flex items-center gap-2 animate-pulse",children:[_.jsx("span",{className:"w-2 h-2 bg-orange-400 rounded-full animate-ping"}),"Pouring Sequence"]}),e.length>0&&_.jsxs("div",{className:"backdrop-blur-xl bg-purple-500/10 border border-purple-500/20 text-purple-200 text-xs font-bold px-4 py-2 rounded-full shadow-lg flex items-center gap-2",children:[_.jsx("span",{className:"text-sm",children:""}),"Reaction Active"]})]})]}),_.jsx("div",{className:"pointer-events-auto flex flex-col gap-4 w-[340px]",children:_.jsxs("div",{className:"glass-panel p-1 rounded-[32px] backdrop-blur-2xl bg-[#0f1115]/80 border-white/10 shadow-[0_20px_40px_rgba(0,0,0,0.5)] overflow-hidden",children:[_.jsxs("div",{className:"px-6 py-4 border-b border-white/5 bg-gradient-to-b from-white/10 to-transparent flex justify-center items-center relative",children:[_.jsx("div",{className:"flex items-center gap-2",children:_.jsx("span",{className:"text-[10px] font-bold text-white/90 tracking-[0.2em] font-mono",children:"LAB CONTROLS"})}),_.jsxs("div",{className:"absolute right-5 flex gap-2 opacity-80",children:[_.jsx("div",{className:"w-3 h-3 rounded-full bg-[#ff5f56] border border-[#e0443e]/50 shadow-inner"}),_.jsx("div",{className:"w-3 h-3 rounded-full bg-[#ffbd2e] border border-[#d89e24]/50 shadow-inner"}),_.jsx("div",{className:"w-3 h-3 rounded-full bg-[#27c93f] border border-[#2a9e36]/50 shadow-inner"})]})]}),_.jsxs("div",{className:"p-5 space-y-6",children:[_.jsx(_9,{}),_.jsx("div",{className:"h-[1px] bg-gradient-to-r from-transparent via-white/10 to-transparent w-full"}),_.jsx(wM,{})]})]})})]}),_.jsx("div",{className:"pointer-events-auto max-w-[400px]",children:L?_.jsx("div",{className:"glass-panel rounded-[24px] backdrop-blur-2xl bg-black/40 border-white/10 shadow-2xl overflow-hidden animate-in slide-in-from-bottom-8 duration-700",children:_.jsx(zA,{})}):_.jsxs("div",{className:"glass-panel rounded-[24px] backdrop-blur-2xl bg-black/40 border-white/10 shadow-2xl p-6",children:[_.jsxs("h3",{className:"text-sm font-bold text-white mb-4 flex items-center gap-2",children:[_.jsx("span",{className:"text-xl",children:""})," Lab Guide"]}),_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{className:"space-y-2",children:[_.jsxs("div",{className:"flex items-start gap-3 text-sm text-gray-300",children:[_.jsx("div",{className:"w-5 h-5 rounded-full bg-white/5 flex items-center justify-center text-xs font-bold text-white/50 mt-0.5",children:"1"}),_.jsx("p",{children:"Select a beaker to focus camera."})]}),_.jsxs("div",{className:"flex items-start gap-3 text-sm text-gray-300",children:[_.jsx("div",{className:"w-5 h-5 rounded-full bg-white/5 flex items-center justify-center text-xs font-bold text-white/50 mt-0.5",children:"2"}),_.jsx("p",{children:"Add chemicals from the Inspector panel."})]}),_.jsxs("div",{className:"flex items-start gap-3 text-sm text-gray-300",children:[_.jsx("div",{className:"w-5 h-5 rounded-full bg-white/5 flex items-center justify-center text-xs font-bold text-white/50 mt-0.5",children:"3"}),_.jsx("p",{children:"Observe reactions and record data."})]})]}),_.jsxs("div",{className:"pt-4 border-t border-white/10",children:[_.jsx("div",{className:"text-[10px] font-bold text-white/30 uppercase tracking-widest mb-2",children:"Shortcuts"}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx("span",{className:"px-2 py-1 rounded bg-white/5 border border-white/5 text-xs text-white/60 font-mono",children:"Reset"}),_.jsx("span",{className:"px-2 py-1 rounded bg-white/5 border border-white/5 text-xs text-white/60 font-mono",children:"Empty"})]})]}),_.jsx("div",{className:"mt-3 flex items-center justify-center w-full px-4 py-3 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl transition-colors",children:_.jsxs("div",{className:"flex items-center gap-4",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("span",{className:"text-2xl filter drop-shadow-md animate-bounce-slow",children:""}),_.jsx("span",{className:"text-[13px] font-bold text-white/90 tracking-wide",children:"Assistant"})]}),_.jsx("button",{onClick:v,className:`w-14 h-8 rounded-full relative transition-colors border border-white/10 ${y?"bg-cyan-500":"bg-white/5"}`,title:y?"Hide Assistant":"Show Assistant",children:_.jsx("div",{className:`absolute top-1 w-6 h-6 rounded-full bg-white shadow-sm transition-transform duration-300 ${y?"left-7":"left-1"}`})})]})})]})]})})]}),_.jsx(VA,{isOpen:S,onClose:()=>T(!1),onViewLabRecord:()=>{T(!1),w(!0)},onNextExperiment:G}),_.jsx(jA,{}),y&&_.jsx(GA,{}),_.jsx(HA,{isOpen:A,onClose:()=>w(!1)})]})}WA.createRoot(document.getElementById("root")).render(_.jsx(ge.StrictMode,{children:_.jsx(S9,{})}));export{Rr as _,w9 as c,fS as g};
