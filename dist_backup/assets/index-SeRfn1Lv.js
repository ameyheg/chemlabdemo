(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();var lz=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function q_(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var ub={exports:{}},Zp={};var PS;function o3(){if(PS)return Zp;PS=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,r,o){var u=null;if(o!==void 0&&(u=""+o),r.key!==void 0&&(u=""+r.key),"key"in r){o={};for(var h in r)h!=="key"&&(o[h]=r[h])}else o=r;return r=o.ref,{$$typeof:s,type:n,key:u,ref:r!==void 0?r:null,props:o}}return Zp.Fragment=e,Zp.jsx=t,Zp.jsxs=t,Zp}var US;function l3(){return US||(US=1,ub.exports=o3()),ub.exports}var w=l3(),fb={exports:{}},gn={};var OS;function c3(){if(OS)return gn;OS=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),u=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),y=Symbol.iterator;function _(j){return j===null||typeof j!="object"?null:(j=y&&j[y]||j["@@iterator"],typeof j=="function"?j:null)}var M={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},R=Object.assign,A={};function E(j,le,Me){this.props=j,this.context=le,this.refs=A,this.updater=Me||M}E.prototype.isReactComponent={},E.prototype.setState=function(j,le){if(typeof j!="object"&&typeof j!="function"&&j!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,j,le,"setState")},E.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function N(){}N.prototype=E.prototype;function I(j,le,Me){this.props=j,this.context=le,this.refs=A,this.updater=Me||M}var P=I.prototype=new N;P.constructor=I,R(P,E.prototype),P.isPureReactComponent=!0;var z=Array.isArray;function U(){}var H={H:null,A:null,T:null,S:null},V=Object.prototype.hasOwnProperty;function L(j,le,Me){var Ue=Me.ref;return{$$typeof:s,type:j,key:le,ref:Ue!==void 0?Ue:null,props:Me}}function B(j,le){return L(j.type,le,j.props)}function W(j){return typeof j=="object"&&j!==null&&j.$$typeof===s}function ie(j){var le={"=":"=0",":":"=2"};return"$"+j.replace(/[=:]/g,function(Me){return le[Me]})}var J=/\/+/g;function se(j,le){return typeof j=="object"&&j!==null&&j.key!=null?ie(""+j.key):le.toString(36)}function ce(j){switch(j.status){case"fulfilled":return j.value;case"rejected":throw j.reason;default:switch(typeof j.status=="string"?j.then(U,U):(j.status="pending",j.then(function(le){j.status==="pending"&&(j.status="fulfilled",j.value=le)},function(le){j.status==="pending"&&(j.status="rejected",j.reason=le)})),j.status){case"fulfilled":return j.value;case"rejected":throw j.reason}}throw j}function Y(j,le,Me,Ue,lt){var pe=typeof j;(pe==="undefined"||pe==="boolean")&&(j=null);var Re=!1;if(j===null)Re=!0;else switch(pe){case"bigint":case"string":case"number":Re=!0;break;case"object":switch(j.$$typeof){case s:case e:Re=!0;break;case v:return Re=j._init,Y(Re(j._payload),le,Me,Ue,lt)}}if(Re)return lt=lt(j),Re=Ue===""?"."+se(j,0):Ue,z(lt)?(Me="",Re!=null&&(Me=Re.replace(J,"$&/")+"/"),Y(lt,le,Me,"",function(dt){return dt})):lt!=null&&(W(lt)&&(lt=B(lt,Me+(lt.key==null||j&&j.key===lt.key?"":(""+lt.key).replace(J,"$&/")+"/")+Re)),le.push(lt)),1;Re=0;var it=Ue===""?".":Ue+":";if(z(j))for(var xt=0;xt<j.length;xt++)Ue=j[xt],pe=it+se(Ue,xt),Re+=Y(Ue,le,Me,pe,lt);else if(xt=_(j),typeof xt=="function")for(j=xt.call(j),xt=0;!(Ue=j.next()).done;)Ue=Ue.value,pe=it+se(Ue,xt++),Re+=Y(Ue,le,Me,pe,lt);else if(pe==="object"){if(typeof j.then=="function")return Y(ce(j),le,Me,Ue,lt);throw le=String(j),Error("Objects are not valid as a React child (found: "+(le==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":le)+"). If you meant to render a collection of children, use an array instead.")}return Re}function ne(j,le,Me){if(j==null)return j;var Ue=[],lt=0;return Y(j,Ue,"","",function(pe){return le.call(Me,pe,lt++)}),Ue}function ve(j){if(j._status===-1){var le=j._result;le=le(),le.then(function(Me){(j._status===0||j._status===-1)&&(j._status=1,j._result=Me)},function(Me){(j._status===0||j._status===-1)&&(j._status=2,j._result=Me)}),j._status===-1&&(j._status=0,j._result=le)}if(j._status===1)return j._result.default;throw j._result}var ae=typeof reportError=="function"?reportError:function(j){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var le=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof j=="object"&&j!==null&&typeof j.message=="string"?String(j.message):String(j),error:j});if(!window.dispatchEvent(le))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",j);return}console.error(j)},re={map:ne,forEach:function(j,le,Me){ne(j,function(){le.apply(this,arguments)},Me)},count:function(j){var le=0;return ne(j,function(){le++}),le},toArray:function(j){return ne(j,function(le){return le})||[]},only:function(j){if(!W(j))throw Error("React.Children.only expected to receive a single React element child.");return j}};return gn.Activity=x,gn.Children=re,gn.Component=E,gn.Fragment=t,gn.Profiler=r,gn.PureComponent=I,gn.StrictMode=n,gn.Suspense=d,gn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=H,gn.__COMPILER_RUNTIME={__proto__:null,c:function(j){return H.H.useMemoCache(j)}},gn.cache=function(j){return function(){return j.apply(null,arguments)}},gn.cacheSignal=function(){return null},gn.cloneElement=function(j,le,Me){if(j==null)throw Error("The argument must be a React element, but you passed "+j+".");var Ue=R({},j.props),lt=j.key;if(le!=null)for(pe in le.key!==void 0&&(lt=""+le.key),le)!V.call(le,pe)||pe==="key"||pe==="__self"||pe==="__source"||pe==="ref"&&le.ref===void 0||(Ue[pe]=le[pe]);var pe=arguments.length-2;if(pe===1)Ue.children=Me;else if(1<pe){for(var Re=Array(pe),it=0;it<pe;it++)Re[it]=arguments[it+2];Ue.children=Re}return L(j.type,lt,Ue)},gn.createContext=function(j){return j={$$typeof:u,_currentValue:j,_currentValue2:j,_threadCount:0,Provider:null,Consumer:null},j.Provider=j,j.Consumer={$$typeof:o,_context:j},j},gn.createElement=function(j,le,Me){var Ue,lt={},pe=null;if(le!=null)for(Ue in le.key!==void 0&&(pe=""+le.key),le)V.call(le,Ue)&&Ue!=="key"&&Ue!=="__self"&&Ue!=="__source"&&(lt[Ue]=le[Ue]);var Re=arguments.length-2;if(Re===1)lt.children=Me;else if(1<Re){for(var it=Array(Re),xt=0;xt<Re;xt++)it[xt]=arguments[xt+2];lt.children=it}if(j&&j.defaultProps)for(Ue in Re=j.defaultProps,Re)lt[Ue]===void 0&&(lt[Ue]=Re[Ue]);return L(j,pe,lt)},gn.createRef=function(){return{current:null}},gn.forwardRef=function(j){return{$$typeof:h,render:j}},gn.isValidElement=W,gn.lazy=function(j){return{$$typeof:v,_payload:{_status:-1,_result:j},_init:ve}},gn.memo=function(j,le){return{$$typeof:m,type:j,compare:le===void 0?null:le}},gn.startTransition=function(j){var le=H.T,Me={};H.T=Me;try{var Ue=j(),lt=H.S;lt!==null&&lt(Me,Ue),typeof Ue=="object"&&Ue!==null&&typeof Ue.then=="function"&&Ue.then(U,ae)}catch(pe){ae(pe)}finally{le!==null&&Me.types!==null&&(le.types=Me.types),H.T=le}},gn.unstable_useCacheRefresh=function(){return H.H.useCacheRefresh()},gn.use=function(j){return H.H.use(j)},gn.useActionState=function(j,le,Me){return H.H.useActionState(j,le,Me)},gn.useCallback=function(j,le){return H.H.useCallback(j,le)},gn.useContext=function(j){return H.H.useContext(j)},gn.useDebugValue=function(){},gn.useDeferredValue=function(j,le){return H.H.useDeferredValue(j,le)},gn.useEffect=function(j,le){return H.H.useEffect(j,le)},gn.useEffectEvent=function(j){return H.H.useEffectEvent(j)},gn.useId=function(){return H.H.useId()},gn.useImperativeHandle=function(j,le,Me){return H.H.useImperativeHandle(j,le,Me)},gn.useInsertionEffect=function(j,le){return H.H.useInsertionEffect(j,le)},gn.useLayoutEffect=function(j,le){return H.H.useLayoutEffect(j,le)},gn.useMemo=function(j,le){return H.H.useMemo(j,le)},gn.useOptimistic=function(j,le){return H.H.useOptimistic(j,le)},gn.useReducer=function(j,le,Me){return H.H.useReducer(j,le,Me)},gn.useRef=function(j){return H.H.useRef(j)},gn.useState=function(j){return H.H.useState(j)},gn.useSyncExternalStore=function(j,le,Me){return H.H.useSyncExternalStore(j,le,Me)},gn.useTransition=function(){return H.H.useTransition()},gn.version="19.2.3",gn}var zS;function jm(){return zS||(zS=1,fb.exports=c3()),fb.exports}var te=jm();const $h=q_(te);var hb={exports:{}},Kp={},db={exports:{}},pb={};var BS;function u3(){return BS||(BS=1,(function(s){function e(Y,ne){var ve=Y.length;Y.push(ne);e:for(;0<ve;){var ae=ve-1>>>1,re=Y[ae];if(0<r(re,ne))Y[ae]=ne,Y[ve]=re,ve=ae;else break e}}function t(Y){return Y.length===0?null:Y[0]}function n(Y){if(Y.length===0)return null;var ne=Y[0],ve=Y.pop();if(ve!==ne){Y[0]=ve;e:for(var ae=0,re=Y.length,j=re>>>1;ae<j;){var le=2*(ae+1)-1,Me=Y[le],Ue=le+1,lt=Y[Ue];if(0>r(Me,ve))Ue<re&&0>r(lt,Me)?(Y[ae]=lt,Y[Ue]=ve,ae=Ue):(Y[ae]=Me,Y[le]=ve,ae=le);else if(Ue<re&&0>r(lt,ve))Y[ae]=lt,Y[Ue]=ve,ae=Ue;else break e}}return ne}function r(Y,ne){var ve=Y.sortIndex-ne.sortIndex;return ve!==0?ve:Y.id-ne.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;s.unstable_now=function(){return o.now()}}else{var u=Date,h=u.now();s.unstable_now=function(){return u.now()-h}}var d=[],m=[],v=1,x=null,y=3,_=!1,M=!1,R=!1,A=!1,E=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;function P(Y){for(var ne=t(m);ne!==null;){if(ne.callback===null)n(m);else if(ne.startTime<=Y)n(m),ne.sortIndex=ne.expirationTime,e(d,ne);else break;ne=t(m)}}function z(Y){if(R=!1,P(Y),!M)if(t(d)!==null)M=!0,U||(U=!0,ie());else{var ne=t(m);ne!==null&&ce(z,ne.startTime-Y)}}var U=!1,H=-1,V=5,L=-1;function B(){return A?!0:!(s.unstable_now()-L<V)}function W(){if(A=!1,U){var Y=s.unstable_now();L=Y;var ne=!0;try{e:{M=!1,R&&(R=!1,N(H),H=-1),_=!0;var ve=y;try{t:{for(P(Y),x=t(d);x!==null&&!(x.expirationTime>Y&&B());){var ae=x.callback;if(typeof ae=="function"){x.callback=null,y=x.priorityLevel;var re=ae(x.expirationTime<=Y);if(Y=s.unstable_now(),typeof re=="function"){x.callback=re,P(Y),ne=!0;break t}x===t(d)&&n(d),P(Y)}else n(d);x=t(d)}if(x!==null)ne=!0;else{var j=t(m);j!==null&&ce(z,j.startTime-Y),ne=!1}}break e}finally{x=null,y=ve,_=!1}ne=void 0}}finally{ne?ie():U=!1}}}var ie;if(typeof I=="function")ie=function(){I(W)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,se=J.port2;J.port1.onmessage=W,ie=function(){se.postMessage(null)}}else ie=function(){E(W,0)};function ce(Y,ne){H=E(function(){Y(s.unstable_now())},ne)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(Y){Y.callback=null},s.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<Y?Math.floor(1e3/Y):5},s.unstable_getCurrentPriorityLevel=function(){return y},s.unstable_next=function(Y){switch(y){case 1:case 2:case 3:var ne=3;break;default:ne=y}var ve=y;y=ne;try{return Y()}finally{y=ve}},s.unstable_requestPaint=function(){A=!0},s.unstable_runWithPriority=function(Y,ne){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var ve=y;y=Y;try{return ne()}finally{y=ve}},s.unstable_scheduleCallback=function(Y,ne,ve){var ae=s.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?ae+ve:ae):ve=ae,Y){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=ve+re,Y={id:v++,callback:ne,priorityLevel:Y,startTime:ve,expirationTime:re,sortIndex:-1},ve>ae?(Y.sortIndex=ve,e(m,Y),t(d)===null&&Y===t(m)&&(R?(N(H),H=-1):R=!0,ce(z,ve-ae))):(Y.sortIndex=re,e(d,Y),M||_||(M=!0,U||(U=!0,ie()))),Y},s.unstable_shouldYield=B,s.unstable_wrapCallback=function(Y){var ne=y;return function(){var ve=y;y=ne;try{return Y.apply(this,arguments)}finally{y=ve}}}})(pb)),pb}var FS;function tT(){return FS||(FS=1,db.exports=u3()),db.exports}var mb={exports:{}},ts={};var kS;function f3(){if(kS)return ts;kS=1;var s=jm();function e(d){var m="https://react.dev/errors/"+d;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)m+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+d+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function o(d,m,v){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:x==null?null:""+x,children:d,containerInfo:m,implementation:v}}var u=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(d,m){if(d==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return ts.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,ts.createPortal=function(d,m){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return o(d,m,null,v)},ts.flushSync=function(d){var m=u.T,v=n.p;try{if(u.T=null,n.p=2,d)return d()}finally{u.T=m,n.p=v,n.d.f()}},ts.preconnect=function(d,m){typeof d=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,n.d.C(d,m))},ts.prefetchDNS=function(d){typeof d=="string"&&n.d.D(d)},ts.preinit=function(d,m){if(typeof d=="string"&&m&&typeof m.as=="string"){var v=m.as,x=h(v,m.crossOrigin),y=typeof m.integrity=="string"?m.integrity:void 0,_=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;v==="style"?n.d.S(d,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:x,integrity:y,fetchPriority:_}):v==="script"&&n.d.X(d,{crossOrigin:x,integrity:y,fetchPriority:_,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},ts.preinitModule=function(d,m){if(typeof d=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var v=h(m.as,m.crossOrigin);n.d.M(d,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&n.d.M(d)},ts.preload=function(d,m){if(typeof d=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var v=m.as,x=h(v,m.crossOrigin);n.d.L(d,v,{crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},ts.preloadModule=function(d,m){if(typeof d=="string")if(m){var v=h(m.as,m.crossOrigin);n.d.m(d,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else n.d.m(d)},ts.requestFormReset=function(d){n.d.r(d)},ts.unstable_batchedUpdates=function(d,m){return d(m)},ts.useFormState=function(d,m,v){return u.H.useFormState(d,m,v)},ts.useFormStatus=function(){return u.H.useHostTransitionStatus()},ts.version="19.2.3",ts}var VS;function h3(){if(VS)return mb.exports;VS=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),mb.exports=f3(),mb.exports}var HS;function d3(){if(HS)return Kp;HS=1;var s=tT(),e=jm(),t=h3();function n(i){var a="https://react.dev/errors/"+i;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)a+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+i+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var a=i,f=i;if(i.alternate)for(;a.return;)a=a.return;else{i=a;do a=i,(a.flags&4098)!==0&&(f=a.return),i=a.return;while(i)}return a.tag===3?f:null}function u(i){if(i.tag===13){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function h(i){if(i.tag===31){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function d(i){if(o(i)!==i)throw Error(n(188))}function m(i){var a=i.alternate;if(!a){if(a=o(i),a===null)throw Error(n(188));return a!==i?null:i}for(var f=i,p=a;;){var S=f.return;if(S===null)break;var T=S.alternate;if(T===null){if(p=S.return,p!==null){f=p;continue}break}if(S.child===T.child){for(T=S.child;T;){if(T===f)return d(S),i;if(T===p)return d(S),a;T=T.sibling}throw Error(n(188))}if(f.return!==p.return)f=S,p=T;else{for(var O=!1,q=S.child;q;){if(q===f){O=!0,f=S,p=T;break}if(q===p){O=!0,p=S,f=T;break}q=q.sibling}if(!O){for(q=T.child;q;){if(q===f){O=!0,f=T,p=S;break}if(q===p){O=!0,p=T,f=S;break}q=q.sibling}if(!O)throw Error(n(189))}}if(f.alternate!==p)throw Error(n(190))}if(f.tag!==3)throw Error(n(188));return f.stateNode.current===f?i:a}function v(i){var a=i.tag;if(a===5||a===26||a===27||a===6)return i;for(i=i.child;i!==null;){if(a=v(i),a!==null)return a;i=i.sibling}return null}var x=Object.assign,y=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),M=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),N=Symbol.for("react.consumer"),I=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),U=Symbol.for("react.suspense_list"),H=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),W=Symbol.iterator;function ie(i){return i===null||typeof i!="object"?null:(i=W&&i[W]||i["@@iterator"],typeof i=="function"?i:null)}var J=Symbol.for("react.client.reference");function se(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===J?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case R:return"Fragment";case E:return"Profiler";case A:return"StrictMode";case z:return"Suspense";case U:return"SuspenseList";case L:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case M:return"Portal";case I:return i.displayName||"Context";case N:return(i._context.displayName||"Context")+".Consumer";case P:var a=i.render;return i=i.displayName,i||(i=a.displayName||a.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case H:return a=i.displayName||null,a!==null?a:se(i.type)||"Memo";case V:a=i._payload,i=i._init;try{return se(i(a))}catch{}}return null}var ce=Array.isArray,Y=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ve={pending:!1,data:null,method:null,action:null},ae=[],re=-1;function j(i){return{current:i}}function le(i){0>re||(i.current=ae[re],ae[re]=null,re--)}function Me(i,a){re++,ae[re]=i.current,i.current=a}var Ue=j(null),lt=j(null),pe=j(null),Re=j(null);function it(i,a){switch(Me(pe,a),Me(lt,i),Me(Ue,null),a.nodeType){case 9:case 11:i=(i=a.documentElement)&&(i=i.namespaceURI)?iS(i):0;break;default:if(i=a.tagName,a=a.namespaceURI)a=iS(a),i=rS(a,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}le(Ue),Me(Ue,i)}function xt(){le(Ue),le(lt),le(pe)}function dt(i){i.memoizedState!==null&&Me(Re,i);var a=Ue.current,f=rS(a,i.type);a!==f&&(Me(lt,i),Me(Ue,f))}function Ut(i){lt.current===i&&(le(Ue),le(lt)),Re.current===i&&(le(Re),Wp._currentValue=ve)}var xe,rt;function Le(i){if(xe===void 0)try{throw Error()}catch(f){var a=f.stack.trim().match(/\n( *(at )?)/);xe=a&&a[1]||"",rt=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+xe+i+rt}var Xe=!1;function qe(i,a){if(!i||Xe)return"";Xe=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(a){var st=function(){throw Error()};if(Object.defineProperty(st.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(st,[])}catch(je){var Oe=je}Reflect.construct(i,[],st)}else{try{st.call()}catch(je){Oe=je}i.call(st.prototype)}}else{try{throw Error()}catch(je){Oe=je}(st=i())&&typeof st.catch=="function"&&st.catch(function(){})}}catch(je){if(je&&Oe&&typeof je.stack=="string")return[je.stack,Oe.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=p.DetermineComponentFrameRoot(),O=T[0],q=T[1];if(O&&q){var fe=O.split(`
`),Ie=q.split(`
`);for(S=p=0;p<fe.length&&!fe[p].includes("DetermineComponentFrameRoot");)p++;for(;S<Ie.length&&!Ie[S].includes("DetermineComponentFrameRoot");)S++;if(p===fe.length||S===Ie.length)for(p=fe.length-1,S=Ie.length-1;1<=p&&0<=S&&fe[p]!==Ie[S];)S--;for(;1<=p&&0<=S;p--,S--)if(fe[p]!==Ie[S]){if(p!==1||S!==1)do if(p--,S--,0>S||fe[p]!==Ie[S]){var Ke=`
`+fe[p].replace(" at new "," at ");return i.displayName&&Ke.includes("<anonymous>")&&(Ke=Ke.replace("<anonymous>",i.displayName)),Ke}while(1<=p&&0<=S);break}}}finally{Xe=!1,Error.prepareStackTrace=f}return(f=i?i.displayName||i.name:"")?Le(f):""}function ot(i,a){switch(i.tag){case 26:case 27:case 5:return Le(i.type);case 16:return Le("Lazy");case 13:return i.child!==a&&a!==null?Le("Suspense Fallback"):Le("Suspense");case 19:return Le("SuspenseList");case 0:case 15:return qe(i.type,!1);case 11:return qe(i.type.render,!1);case 1:return qe(i.type,!0);case 31:return Le("Activity");default:return""}}function $(i){try{var a="",f=null;do a+=ot(i,f),f=i,i=i.return;while(i);return a}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var Pt=Object.prototype.hasOwnProperty,St=s.unstable_scheduleCallback,Ft=s.unstable_cancelCallback,ht=s.unstable_shouldYield,K=s.unstable_requestPaint,F=s.unstable_now,ge=s.unstable_getCurrentPriorityLevel,ze=s.unstable_ImmediatePriority,Ye=s.unstable_UserBlockingPriority,Be=s.unstable_NormalPriority,Dt=s.unstable_LowPriority,yt=s.unstable_IdlePriority,kt=s.log,ke=s.unstable_setDisableYieldValue,Ce=null,Fe=null;function Ze(i){if(typeof kt=="function"&&ke(i),Fe&&typeof Fe.setStrictMode=="function")try{Fe.setStrictMode(Ce,i)}catch{}}var ee=Math.clz32?Math.clz32:ue,Se=Math.log,$e=Math.LN2;function ue(i){return i>>>=0,i===0?32:31-(Se(i)/$e|0)|0}var we=256,at=262144,Ct=4194304;function ct(i){var a=i&42;if(a!==0)return a;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Qe(i,a,f){var p=i.pendingLanes;if(p===0)return 0;var S=0,T=i.suspendedLanes,O=i.pingedLanes;i=i.warmLanes;var q=p&134217727;return q!==0?(p=q&~T,p!==0?S=ct(p):(O&=q,O!==0?S=ct(O):f||(f=q&~i,f!==0&&(S=ct(f))))):(q=p&~T,q!==0?S=ct(q):O!==0?S=ct(O):f||(f=p&~i,f!==0&&(S=ct(f)))),S===0?0:a!==0&&a!==S&&(a&T)===0&&(T=S&-S,f=a&-a,T>=f||T===32&&(f&4194048)!==0)?a:S}function gt(i,a){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&a)===0}function qt(i,a){switch(i){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function un(){var i=Ct;return Ct<<=1,(Ct&62914560)===0&&(Ct=4194304),i}function dn(i){for(var a=[],f=0;31>f;f++)a.push(i);return a}function ci(i,a){i.pendingLanes|=a,a!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Pi(i,a,f,p,S,T){var O=i.pendingLanes;i.pendingLanes=f,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=f,i.entangledLanes&=f,i.errorRecoveryDisabledLanes&=f,i.shellSuspendCounter=0;var q=i.entanglements,fe=i.expirationTimes,Ie=i.hiddenUpdates;for(f=O&~f;0<f;){var Ke=31-ee(f),st=1<<Ke;q[Ke]=0,fe[Ke]=-1;var Oe=Ie[Ke];if(Oe!==null)for(Ie[Ke]=null,Ke=0;Ke<Oe.length;Ke++){var je=Oe[Ke];je!==null&&(je.lane&=-536870913)}f&=~st}p!==0&&fa(i,p,0),T!==0&&S===0&&i.tag!==0&&(i.suspendedLanes|=T&~(O&~a))}function fa(i,a,f){i.pendingLanes|=a,i.suspendedLanes&=~a;var p=31-ee(a);i.entangledLanes|=a,i.entanglements[p]=i.entanglements[p]|1073741824|f&261930}function ha(i,a){var f=i.entangledLanes|=a;for(i=i.entanglements;f;){var p=31-ee(f),S=1<<p;S&a|i[p]&a&&(i[p]|=a),f&=~S}}function Cs(i,a){var f=a&-a;return f=(f&42)!==0?1:da(f),(f&(i.suspendedLanes|a))!==0?0:f}function da(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Ir(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function us(){var i=ne.p;return i!==0?i:(i=window.event,i===void 0?32:AS(i.type))}function en(i,a){var f=ne.p;try{return ne.p=i,a()}finally{ne.p=f}}var Tr=Math.random().toString(36).slice(2),ui="__reactFiber$"+Tr,k="__reactProps$"+Tr,Z="__reactContainer$"+Tr,he="__reactEvents$"+Tr,Ne="__reactListeners$"+Tr,Ge="__reactHandles$"+Tr,We="__reactResources$"+Tr,pt="__reactMarker$"+Tr;function ut(i){delete i[ui],delete i[k],delete i[he],delete i[Ne],delete i[Ge]}function Tt(i){var a=i[ui];if(a)return a;for(var f=i.parentNode;f;){if(a=f[Z]||f[ui]){if(f=a.alternate,a.child!==null||f!==null&&f.child!==null)for(i=fS(i);i!==null;){if(f=i[ui])return f;i=fS(i)}return a}i=f,f=i.parentNode}return null}function Mt(i){if(i=i[ui]||i[Z]){var a=i.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return i}return null}function Rt(i){var a=i.tag;if(a===5||a===26||a===27||a===6)return i.stateNode;throw Error(n(33))}function _t(i){var a=i[We];return a||(a=i[We]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function G(i){i[pt]=!0}var oe=new Set,be={};function _e(i,a){me(i,a),me(i+"Capture",a)}function me(i,a){for(be[i]=a,i=0;i<a.length;i++)oe.add(a[i])}var et=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),mt={},tt={};function It(i){return Pt.call(tt,i)?!0:Pt.call(mt,i)?!1:et.test(i)?tt[i]=!0:(mt[i]=!0,!1)}function Et(i,a,f){if(It(a))if(f===null)i.removeAttribute(a);else{switch(typeof f){case"undefined":case"function":case"symbol":i.removeAttribute(a);return;case"boolean":var p=a.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(a);return}}i.setAttribute(a,""+f)}}function jt(i,a,f){if(f===null)i.removeAttribute(a);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(a);return}i.setAttribute(a,""+f)}}function At(i,a,f,p){if(p===null)i.removeAttribute(f);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(f);return}i.setAttributeNS(a,f,""+p)}}function Gt(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function fn(i){var a=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function jn(i,a,f){var p=Object.getOwnPropertyDescriptor(i.constructor.prototype,a);if(!i.hasOwnProperty(a)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var S=p.get,T=p.set;return Object.defineProperty(i,a,{configurable:!0,get:function(){return S.call(this)},set:function(O){f=""+O,T.call(this,O)}}),Object.defineProperty(i,a,{enumerable:p.enumerable}),{getValue:function(){return f},setValue:function(O){f=""+O},stopTracking:function(){i._valueTracker=null,delete i[a]}}}}function xn(i){if(!i._valueTracker){var a=fn(i)?"checked":"value";i._valueTracker=jn(i,a,""+i[a])}}function Vt(i){if(!i)return!1;var a=i._valueTracker;if(!a)return!0;var f=a.getValue(),p="";return i&&(p=fn(i)?i.checked?"true":"false":i.value),i=p,i!==f?(a.setValue(i),!0):!1}function bt(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Yt=/[\n"\\]/g;function Ot(i){return i.replace(Yt,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Vn(i,a,f,p,S,T,O,q){i.name="",O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?i.type=O:i.removeAttribute("type"),a!=null?O==="number"?(a===0&&i.value===""||i.value!=a)&&(i.value=""+Gt(a)):i.value!==""+Gt(a)&&(i.value=""+Gt(a)):O!=="submit"&&O!=="reset"||i.removeAttribute("value"),a!=null?Tn(i,O,Gt(a)):f!=null?Tn(i,O,Gt(f)):p!=null&&i.removeAttribute("value"),S==null&&T!=null&&(i.defaultChecked=!!T),S!=null&&(i.checked=S&&typeof S!="function"&&typeof S!="symbol"),q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?i.name=""+Gt(q):i.removeAttribute("name")}function Ji(i,a,f,p,S,T,O,q){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(i.type=T),a!=null||f!=null){if(!(T!=="submit"&&T!=="reset"||a!=null)){xn(i);return}f=f!=null?""+Gt(f):"",a=a!=null?""+Gt(a):f,q||a===i.value||(i.value=a),i.defaultValue=a}p=p??S,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=q?i.checked:!!p,i.defaultChecked=!!p,O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"&&(i.name=O),xn(i)}function Tn(i,a,f){a==="number"&&bt(i.ownerDocument)===i||i.defaultValue===""+f||(i.defaultValue=""+f)}function di(i,a,f,p){if(i=i.options,a){a={};for(var S=0;S<f.length;S++)a["$"+f[S]]=!0;for(f=0;f<i.length;f++)S=a.hasOwnProperty("$"+i[f].value),i[f].selected!==S&&(i[f].selected=S),S&&p&&(i[f].defaultSelected=!0)}else{for(f=""+Gt(f),a=null,S=0;S<i.length;S++){if(i[S].value===f){i[S].selected=!0,p&&(i[S].defaultSelected=!0);return}a!==null||i[S].disabled||(a=i[S])}a!==null&&(a.selected=!0)}}function Xn(i,a,f){if(a!=null&&(a=""+Gt(a),a!==i.value&&(i.value=a),f==null)){i.defaultValue!==a&&(i.defaultValue=a);return}i.defaultValue=f!=null?""+Gt(f):""}function $i(i,a,f,p){if(a==null){if(p!=null){if(f!=null)throw Error(n(92));if(ce(p)){if(1<p.length)throw Error(n(93));p=p[0]}f=p}f==null&&(f=""),a=f}f=Gt(a),i.defaultValue=f,p=i.textContent,p===f&&p!==""&&p!==null&&(i.value=p),xn(i)}function ji(i,a){if(a){var f=i.firstChild;if(f&&f===i.lastChild&&f.nodeType===3){f.nodeValue=a;return}}i.textContent=a}var lr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function cr(i,a,f){var p=a.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?p?i.setProperty(a,""):a==="float"?i.cssFloat="":i[a]="":p?i.setProperty(a,f):typeof f!="number"||f===0||lr.has(a)?a==="float"?i.cssFloat=f:i[a]=(""+f).trim():i[a]=f+"px"}function nl(i,a,f){if(a!=null&&typeof a!="object")throw Error(n(62));if(i=i.style,f!=null){for(var p in f)!f.hasOwnProperty(p)||a!=null&&a.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var S in a)p=a[S],a.hasOwnProperty(S)&&f[S]!==p&&cr(i,S,p)}else for(var T in a)a.hasOwnProperty(T)&&cr(i,T,a[T])}function Rs(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var o0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Td=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function eu(i){return Td.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function ja(){}var Mf=null;function Ef(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var il=null,yo=null;function wd(i){var a=Mt(i);if(a&&(i=a.stateNode)){var f=i[k]||null;e:switch(i=a.stateNode,a.type){case"input":if(Vn(i,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),a=f.name,f.type==="radio"&&a!=null){for(f=i;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Ot(""+a)+'"][type="radio"]'),a=0;a<f.length;a++){var p=f[a];if(p!==i&&p.form===i.form){var S=p[k]||null;if(!S)throw Error(n(90));Vn(p,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(a=0;a<f.length;a++)p=f[a],p.form===i.form&&Vt(p)}break e;case"textarea":Xn(i,f.value,f.defaultValue);break e;case"select":a=f.value,a!=null&&di(i,!!f.multiple,a,!1)}}}var Tf=!1;function Ad(i,a,f){if(Tf)return i(a,f);Tf=!0;try{var p=i(a);return p}finally{if(Tf=!1,(il!==null||yo!==null)&&(na(),il&&(a=il,i=yo,yo=il=null,wd(a),i)))for(a=0;a<i.length;a++)wd(i[a])}}function jl(i,a){var f=i.stateNode;if(f===null)return null;var p=f[k]||null;if(p===null)return null;f=p[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(f&&typeof f!="function")throw Error(n(231,a,typeof f));return f}var pa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Cd=!1;if(pa)try{var Wl={};Object.defineProperty(Wl,"passive",{get:function(){Cd=!0}}),window.addEventListener("test",Wl,Wl),window.removeEventListener("test",Wl,Wl)}catch{Cd=!1}var fs=null,wf=null,rl=null;function tu(){if(rl)return rl;var i,a=wf,f=a.length,p,S="value"in fs?fs.value:fs.textContent,T=S.length;for(i=0;i<f&&a[i]===S[i];i++);var O=f-i;for(p=1;p<=O&&a[f-p]===S[T-p];p++);return rl=S.slice(i,1<p?1-p:void 0)}function nu(i){var a=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&a===13&&(i=13)):i=a,i===10&&(i=13),32<=i||i===13?i:0}function Xl(){return!0}function l0(){return!1}function Lr(i){function a(f,p,S,T,O){this._reactName=f,this._targetInst=S,this.type=p,this.nativeEvent=T,this.target=O,this.currentTarget=null;for(var q in i)i.hasOwnProperty(q)&&(f=i[q],this[q]=f?f(T):T[q]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?Xl:l0,this.isPropagationStopped=l0,this}return x(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=Xl)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=Xl)},persist:function(){},isPersistent:Xl}),a}var bo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},iu=Lr(bo),ql=x({},bo,{view:0,detail:0}),c0=Lr(ql),ru,Af,Yl,Zl=x({},ql,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Df,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Yl&&(Yl&&i.type==="mousemove"?(ru=i.screenX-Yl.screenX,Af=i.screenY-Yl.screenY):Af=ru=0,Yl=i),ru)},movementY:function(i){return"movementY"in i?i.movementY:Af}}),Rd=Lr(Zl),u0=x({},Zl,{dataTransfer:0}),f0=Lr(u0),Nd=x({},ql,{relatedTarget:0}),Cf=Lr(Nd),h0=x({},bo,{animationName:0,elapsedTime:0,pseudoElement:0}),Ny=Lr(h0),Dy=x({},bo,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),d0=Lr(Dy),su=x({},bo,{data:0}),Rf=Lr(su),Nf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},p0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},m0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Dd(i){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(i):(i=m0[i])?!!a[i]:!1}function Df(){return Dd}var g0=x({},ql,{key:function(i){if(i.key){var a=Nf[i.key]||i.key;if(a!=="Unidentified")return a}return i.type==="keypress"?(i=nu(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?p0[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Df,charCode:function(i){return i.type==="keypress"?nu(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?nu(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),sl=Lr(g0),If=x({},Zl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Id=Lr(If),Ld=x({},ql,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Df}),v0=Lr(Ld),x0=x({},bo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Iy=Lr(x0),vr=x({},Zl,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),y0=Lr(vr),b0=x({},bo,{newState:0,oldState:0}),_0=Lr(b0),S0=[9,13,27,32],al=pa&&"CompositionEvent"in window,Kl=null;pa&&"documentMode"in document&&(Kl=document.documentMode);var Lf=pa&&"TextEvent"in window&&!Kl,Pd=pa&&(!al||Kl&&8<Kl&&11>=Kl),M0=" ",au=!1;function Pf(i,a){switch(i){case"keyup":return S0.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ud(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ol=!1;function E0(i,a){switch(i){case"compositionend":return Ud(a);case"keypress":return a.which!==32?null:(au=!0,M0);case"textInput":return i=a.data,i===M0&&au?null:i;default:return null}}function Od(i,a){if(ol)return i==="compositionend"||!al&&Pf(i,a)?(i=tu(),rl=wf=fs=null,ol=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Pd&&a.locale!=="ko"?null:a.data;default:return null}}var zd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Bd(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a==="input"?!!zd[i.type]:a==="textarea"}function Uf(i,a,f,p){il?yo?yo.push(p):yo=[p]:il=p,a=Rg(a,"onChange"),0<a.length&&(f=new iu("onChange","change",null,f,p),i.push({event:f,listeners:a}))}var _o=null,ll=null;function T0(i){Q1(i,0)}function Ql(i){var a=Rt(i);if(Vt(a))return i}function Fd(i,a){if(i==="change")return a}var ma=!1;if(pa){var ou;if(pa){var kd="oninput"in document;if(!kd){var Vd=document.createElement("div");Vd.setAttribute("oninput","return;"),kd=typeof Vd.oninput=="function"}ou=kd}else ou=!1;ma=ou&&(!document.documentMode||9<document.documentMode)}function Ns(){_o&&(_o.detachEvent("onpropertychange",lu),ll=_o=null)}function lu(i){if(i.propertyName==="value"&&Ql(ll)){var a=[];Uf(a,ll,i,Ef(i)),Ad(T0,a)}}function w0(i,a,f){i==="focusin"?(Ns(),_o=a,ll=f,_o.attachEvent("onpropertychange",lu)):i==="focusout"&&Ns()}function Hd(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Ql(ll)}function A0(i,a){if(i==="click")return Ql(a)}function C0(i,a){if(i==="input"||i==="change")return Ql(a)}function Gd(i,a){return i===a&&(i!==0||1/i===1/a)||i!==i&&a!==a}var Pr=typeof Object.is=="function"?Object.is:Gd;function Jl(i,a){if(Pr(i,a))return!0;if(typeof i!="object"||i===null||typeof a!="object"||a===null)return!1;var f=Object.keys(i),p=Object.keys(a);if(f.length!==p.length)return!1;for(p=0;p<f.length;p++){var S=f[p];if(!Pt.call(a,S)||!Pr(i[S],a[S]))return!1}return!0}function cu(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function $l(i,a){var f=cu(i);i=0;for(var p;f;){if(f.nodeType===3){if(p=i+f.textContent.length,i<=a&&p>=a)return{node:f,offset:a-i};i=p}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=cu(f)}}function ni(i,a){return i&&a?i===a?!0:i&&i.nodeType===3?!1:a&&a.nodeType===3?ni(i,a.parentNode):"contains"in i?i.contains(a):i.compareDocumentPosition?!!(i.compareDocumentPosition(a)&16):!1:!1}function R0(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var a=bt(i.document);a instanceof i.HTMLIFrameElement;){try{var f=typeof a.contentWindow.location.href=="string"}catch{f=!1}if(f)i=a.contentWindow;else break;a=bt(i.document)}return a}function jd(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a&&(a==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||a==="textarea"||i.contentEditable==="true")}var N0=pa&&"documentMode"in document&&11>=document.documentMode,ga=null,va=null,ec=null,Of=!1;function tc(i,a,f){var p=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Of||ga==null||ga!==bt(p)||(p=ga,"selectionStart"in p&&jd(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),ec&&Jl(ec,p)||(ec=p,p=Rg(va,"onSelect"),0<p.length&&(a=new iu("onSelect","select",null,a,f),i.push({event:a,listeners:p}),a.target=ga)))}function wr(i,a){var f={};return f[i.toLowerCase()]=a.toLowerCase(),f["Webkit"+i]="webkit"+a,f["Moz"+i]="moz"+a,f}var cl={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionrun:wr("Transition","TransitionRun"),transitionstart:wr("Transition","TransitionStart"),transitioncancel:wr("Transition","TransitionCancel"),transitionend:wr("Transition","TransitionEnd")},uu={},Wd={};pa&&(Wd=document.createElement("div").style,"AnimationEvent"in window||(delete cl.animationend.animation,delete cl.animationiteration.animation,delete cl.animationstart.animation),"TransitionEvent"in window||delete cl.transitionend.transition);function Wa(i){if(uu[i])return uu[i];if(!cl[i])return i;var a=cl[i],f;for(f in a)if(a.hasOwnProperty(f)&&f in Wd)return uu[i]=a[f];return i}var zf=Wa("animationend"),fu=Wa("animationiteration"),Xd=Wa("animationstart"),D0=Wa("transitionrun"),Ly=Wa("transitionstart"),I0=Wa("transitioncancel"),qd=Wa("transitionend"),Ds=new Map,hu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");hu.push("scrollEnd");function Is(i,a){Ds.set(i,a),_e(a,[i])}var du=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Ls=[],Xa=0,ur=0;function pu(){for(var i=Xa,a=ur=Xa=0;a<i;){var f=Ls[a];Ls[a++]=null;var p=Ls[a];Ls[a++]=null;var S=Ls[a];Ls[a++]=null;var T=Ls[a];if(Ls[a++]=null,p!==null&&S!==null){var O=p.pending;O===null?S.next=S:(S.next=O.next,O.next=S),p.pending=S}T!==0&&So(f,S,T)}}function fr(i,a,f,p){Ls[Xa++]=i,Ls[Xa++]=a,Ls[Xa++]=f,Ls[Xa++]=p,ur|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function Bf(i,a,f,p){return fr(i,a,f,p),Ps(i)}function Ur(i,a){return fr(i,null,null,a),Ps(i)}function So(i,a,f){i.lanes|=f;var p=i.alternate;p!==null&&(p.lanes|=f);for(var S=!1,T=i.return;T!==null;)T.childLanes|=f,p=T.alternate,p!==null&&(p.childLanes|=f),T.tag===22&&(i=T.stateNode,i===null||i._visibility&1||(S=!0)),i=T,T=T.return;return i.tag===3?(T=i.stateNode,S&&a!==null&&(S=31-ee(f),i=T.hiddenUpdates,p=i[S],p===null?i[S]=[a]:p.push(a),a.lane=f|536870912),T):null}function Ps(i){if(50<Vo)throw Vo=0,Cl=null,Error(n(185));for(var a=i.return;a!==null;)i=a,a=i.return;return i.tag===3?i.stateNode:null}var Mo={};function Yd(i,a,f,p){this.tag=i,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yi(i,a,f,p){return new Yd(i,a,f,p)}function Ff(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Wr(i,a){var f=i.alternate;return f===null?(f=yi(i.tag,a,i.key,i.mode),f.elementType=i.elementType,f.type=i.type,f.stateNode=i.stateNode,f.alternate=i,i.alternate=f):(f.pendingProps=a,f.type=i.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=i.flags&65011712,f.childLanes=i.childLanes,f.lanes=i.lanes,f.child=i.child,f.memoizedProps=i.memoizedProps,f.memoizedState=i.memoizedState,f.updateQueue=i.updateQueue,a=i.dependencies,f.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},f.sibling=i.sibling,f.index=i.index,f.ref=i.ref,f.refCleanup=i.refCleanup,f}function nc(i,a){i.flags&=65011714;var f=i.alternate;return f===null?(i.childLanes=0,i.lanes=a,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=f.childLanes,i.lanes=f.lanes,i.child=f.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=f.memoizedProps,i.memoizedState=f.memoizedState,i.updateQueue=f.updateQueue,i.type=f.type,a=f.dependencies,i.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),i}function xa(i,a,f,p,S,T){var O=0;if(p=i,typeof i=="function")Ff(i)&&(O=1);else if(typeof i=="string")O=ZA(i,f,Ue.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case L:return i=yi(31,f,a,S),i.elementType=L,i.lanes=T,i;case R:return Eo(f.children,S,T,a);case A:O=8,S|=24;break;case E:return i=yi(12,f,a,S|2),i.elementType=E,i.lanes=T,i;case z:return i=yi(13,f,a,S),i.elementType=z,i.lanes=T,i;case U:return i=yi(19,f,a,S),i.elementType=U,i.lanes=T,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case I:O=10;break e;case N:O=9;break e;case P:O=11;break e;case H:O=14;break e;case V:O=16,p=null;break e}O=29,f=Error(n(130,i===null?"null":typeof i,"")),p=null}return a=yi(O,f,a,S),a.elementType=i,a.type=p,a.lanes=T,a}function Eo(i,a,f,p){return i=yi(7,i,p,a),i.lanes=f,i}function kf(i,a,f){return i=yi(6,i,null,a),i.lanes=f,i}function ic(i){var a=yi(18,null,null,0);return a.stateNode=i,a}function Vf(i,a,f){return a=yi(4,i.children!==null?i.children:[],i.key,a),a.lanes=f,a.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},a}var mu=new WeakMap;function hs(i,a){if(typeof i=="object"&&i!==null){var f=mu.get(i);return f!==void 0?f:(a={value:i,source:a,stack:$(a)},mu.set(i,a),a)}return{value:i,source:a,stack:$(a)}}var To=[],wo=0,rc=null,sc=0,Xr=[],pi=0,qa=null,bi=1,Js="";function ya(i,a){To[wo++]=sc,To[wo++]=rc,rc=i,sc=a}function L0(i,a,f){Xr[pi++]=bi,Xr[pi++]=Js,Xr[pi++]=qa,qa=i;var p=bi;i=Js;var S=32-ee(p)-1;p&=~(1<<S),f+=1;var T=32-ee(a)+S;if(30<T){var O=S-S%5;T=(p&(1<<O)-1).toString(32),p>>=O,S-=O,bi=1<<32-ee(a)+S|f<<S|p,Js=T+i}else bi=1<<T|f<<S|p,Js=i}function ba(i){i.return!==null&&(ya(i,1),L0(i,1,0))}function Hf(i){for(;i===rc;)rc=To[--wo],To[wo]=null,sc=To[--wo],To[wo]=null;for(;i===qa;)qa=Xr[--pi],Xr[pi]=null,Js=Xr[--pi],Xr[pi]=null,bi=Xr[--pi],Xr[pi]=null}function Gf(i,a){Xr[pi++]=bi,Xr[pi++]=Js,Xr[pi++]=qa,bi=a.id,Js=a.overflow,qa=i}var Ai=null,ii=null,Pn=!1,Ya=null,ds=!1,ac=Error(n(519));function _a(i){var a=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Sa(hs(a,i)),ac}function P0(i){var a=i.stateNode,f=i.type,p=i.memoizedProps;switch(a[ui]=i,a[k]=p,f){case"dialog":zn("cancel",a),zn("close",a);break;case"iframe":case"object":case"embed":zn("load",a);break;case"video":case"audio":for(f=0;f<qs.length;f++)zn(qs[f],a);break;case"source":zn("error",a);break;case"img":case"image":case"link":zn("error",a),zn("load",a);break;case"details":zn("toggle",a);break;case"input":zn("invalid",a),Ji(a,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":zn("invalid",a);break;case"textarea":zn("invalid",a),$i(a,p.value,p.defaultValue,p.children)}f=p.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||a.textContent===""+f||p.suppressHydrationWarning===!0||tS(a.textContent,f)?(p.popover!=null&&(zn("beforetoggle",a),zn("toggle",a)),p.onScroll!=null&&zn("scroll",a),p.onScrollEnd!=null&&zn("scrollend",a),p.onClick!=null&&(a.onclick=ja),a=!0):a=!1,a||_a(i,!0)}function U0(i){for(Ai=i.return;Ai;)switch(Ai.tag){case 5:case 31:case 13:ds=!1;return;case 27:case 3:ds=!0;return;default:Ai=Ai.return}}function oc(i){if(i!==Ai)return!1;if(!Pn)return U0(i),Pn=!0,!1;var a=i.tag,f;if((f=a!==3&&a!==27)&&((f=a===5)&&(f=i.type,f=!(f!=="form"&&f!=="button")||Zy(i.type,i.memoizedProps)),f=!f),f&&ii&&_a(i),U0(i),a===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));ii=uS(i)}else if(a===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));ii=uS(i)}else a===27?(a=ii,Ac(i.type)?(i=eb,eb=null,ii=i):ii=a):ii=Ai?Oa(i.stateNode.nextSibling):null;return!0}function Ao(){ii=Ai=null,Pn=!1}function jf(){var i=Ya;return i!==null&&(Ri===null?Ri=i:Ri.push.apply(Ri,i),Ya=null),i}function Sa(i){Ya===null?Ya=[i]:Ya.push(i)}var lc=j(null),Co=null,Ma=null;function Za(i,a,f){Me(lc,a._currentValue),a._currentValue=f}function Ea(i){i._currentValue=lc.current,le(lc)}function Wf(i,a,f){for(;i!==null;){var p=i.alternate;if((i.childLanes&a)!==a?(i.childLanes|=a,p!==null&&(p.childLanes|=a)):p!==null&&(p.childLanes&a)!==a&&(p.childLanes|=a),i===f)break;i=i.return}}function Xf(i,a,f,p){var S=i.child;for(S!==null&&(S.return=i);S!==null;){var T=S.dependencies;if(T!==null){var O=S.child;T=T.firstContext;e:for(;T!==null;){var q=T;T=S;for(var fe=0;fe<a.length;fe++)if(q.context===a[fe]){T.lanes|=f,q=T.alternate,q!==null&&(q.lanes|=f),Wf(T.return,f,i),p||(O=null);break e}T=q.next}}else if(S.tag===18){if(O=S.return,O===null)throw Error(n(341));O.lanes|=f,T=O.alternate,T!==null&&(T.lanes|=f),Wf(O,f,i),O=null}else O=S.child;if(O!==null)O.return=S;else for(O=S;O!==null;){if(O===i){O=null;break}if(S=O.sibling,S!==null){S.return=O.return,O=S;break}O=O.return}S=O}}function Ta(i,a,f,p){i=null;for(var S=a,T=!1;S!==null;){if(!T){if((S.flags&524288)!==0)T=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var O=S.alternate;if(O===null)throw Error(n(387));if(O=O.memoizedProps,O!==null){var q=S.type;Pr(S.pendingProps.value,O.value)||(i!==null?i.push(q):i=[q])}}else if(S===Re.current){if(O=S.alternate,O===null)throw Error(n(387));O.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(i!==null?i.push(Wp):i=[Wp])}S=S.return}i!==null&&Xf(a,i,f,p),a.flags|=262144}function gu(i){for(i=i.firstContext;i!==null;){if(!Pr(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Ro(i){Co=i,Ma=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function an(i){return O0(Co,i)}function cc(i,a){return Co===null&&Ro(i),O0(i,a)}function O0(i,a){var f=a._currentValue;if(a={context:a,memoizedValue:f,next:null},Ma===null){if(i===null)throw Error(n(308));Ma=a,i.dependencies={lanes:0,firstContext:a},i.flags|=524288}else Ma=Ma.next=a;return f}var z0=typeof AbortController<"u"?AbortController:function(){var i=[],a=this.signal={aborted:!1,addEventListener:function(f,p){i.push(p)}};this.abort=function(){a.aborted=!0,i.forEach(function(f){return f()})}},Py=s.unstable_scheduleCallback,Uy=s.unstable_NormalPriority,Wi={$$typeof:I,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Zd(){return{controller:new z0,data:new Map,refCount:0}}function ul(i){i.refCount--,i.refCount===0&&Py(Uy,function(){i.controller.abort()})}var ps=null,qf=0,Ka=0,Us=null;function Kd(i,a){if(ps===null){var f=ps=[];qf=0,Ka=Ve(),Us={status:"pending",value:void 0,then:function(p){f.push(p)}}}return qf++,a.then(Qd,Qd),a}function Qd(){if(--qf===0&&ps!==null){Us!==null&&(Us.status="fulfilled");var i=ps;ps=null,Ka=0,Us=null;for(var a=0;a<i.length;a++)(0,i[a])()}}function Jd(i,a){var f=[],p={status:"pending",value:null,reason:null,then:function(S){f.push(S)}};return i.then(function(){p.status="fulfilled",p.value=a;for(var S=0;S<f.length;S++)(0,f[S])(a)},function(S){for(p.status="rejected",p.reason=S,S=0;S<f.length;S++)(0,f[S])(void 0)}),p}var B0=Y.S;Y.S=function(i,a){Fp=F(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&Kd(i,a),B0!==null&&B0(i,a)};var No=j(null);function Yf(){var i=No.current;return i!==null?i:ln.pooledCache}function vu(i,a){a===null?Me(No,No.current):Me(No,a.pool)}function $d(){var i=Yf();return i===null?null:{parent:Wi._currentValue,pool:i}}var fl=Error(n(460)),xu=Error(n(474)),_n=Error(n(542)),Zf={then:function(){}};function qr(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Kf(i,a,f){switch(f=i[f],f===void 0?i.push(a):f!==a&&(a.then(ja,ja),a=f),a.status){case"fulfilled":return a.value;case"rejected":throw i=a.reason,pl(i),i;default:if(typeof a.status=="string")a.then(ja,ja);else{if(i=ln,i!==null&&100<i.shellSuspendCounter)throw Error(n(482));i=a,i.status="pending",i.then(function(p){if(a.status==="pending"){var S=a;S.status="fulfilled",S.value=p}},function(p){if(a.status==="pending"){var S=a;S.status="rejected",S.reason=p}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw i=a.reason,pl(i),i}throw wa=a,fl}}function hl(i){try{var a=i._init;return a(i._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(wa=f,fl):f}}var wa=null;function dl(){if(wa===null)throw Error(n(459));var i=wa;return wa=null,i}function pl(i){if(i===fl||i===_n)throw Error(n(483))}var ml=null,gl=0;function yu(i){var a=gl;return gl+=1,ml===null&&(ml=[]),Kf(ml,i,a)}function Os(i,a){a=a.props.ref,i.ref=a!==void 0?a:null}function uc(i,a){throw a.$$typeof===y?Error(n(525)):(i=Object.prototype.toString.call(a),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":i)))}function Qf(i){function a(Te,ye){if(i){var De=Te.deletions;De===null?(Te.deletions=[ye],Te.flags|=16):De.push(ye)}}function f(Te,ye){if(!i)return null;for(;ye!==null;)a(Te,ye),ye=ye.sibling;return null}function p(Te){for(var ye=new Map;Te!==null;)Te.key!==null?ye.set(Te.key,Te):ye.set(Te.index,Te),Te=Te.sibling;return ye}function S(Te,ye){return Te=Wr(Te,ye),Te.index=0,Te.sibling=null,Te}function T(Te,ye,De){return Te.index=De,i?(De=Te.alternate,De!==null?(De=De.index,De<ye?(Te.flags|=67108866,ye):De):(Te.flags|=67108866,ye)):(Te.flags|=1048576,ye)}function O(Te){return i&&Te.alternate===null&&(Te.flags|=67108866),Te}function q(Te,ye,De,nt){return ye===null||ye.tag!==6?(ye=kf(De,Te.mode,nt),ye.return=Te,ye):(ye=S(ye,De),ye.return=Te,ye)}function fe(Te,ye,De,nt){var $t=De.type;return $t===R?Ke(Te,ye,De.props.children,nt,De.key):ye!==null&&(ye.elementType===$t||typeof $t=="object"&&$t!==null&&$t.$$typeof===V&&hl($t)===ye.type)?(ye=S(ye,De.props),Os(ye,De),ye.return=Te,ye):(ye=xa(De.type,De.key,De.props,null,Te.mode,nt),Os(ye,De),ye.return=Te,ye)}function Ie(Te,ye,De,nt){return ye===null||ye.tag!==4||ye.stateNode.containerInfo!==De.containerInfo||ye.stateNode.implementation!==De.implementation?(ye=Vf(De,Te.mode,nt),ye.return=Te,ye):(ye=S(ye,De.children||[]),ye.return=Te,ye)}function Ke(Te,ye,De,nt,$t){return ye===null||ye.tag!==7?(ye=Eo(De,Te.mode,nt,$t),ye.return=Te,ye):(ye=S(ye,De),ye.return=Te,ye)}function st(Te,ye,De){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return ye=kf(""+ye,Te.mode,De),ye.return=Te,ye;if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case _:return De=xa(ye.type,ye.key,ye.props,null,Te.mode,De),Os(De,ye),De.return=Te,De;case M:return ye=Vf(ye,Te.mode,De),ye.return=Te,ye;case V:return ye=hl(ye),st(Te,ye,De)}if(ce(ye)||ie(ye))return ye=Eo(ye,Te.mode,De,null),ye.return=Te,ye;if(typeof ye.then=="function")return st(Te,yu(ye),De);if(ye.$$typeof===I)return st(Te,cc(Te,ye),De);uc(Te,ye)}return null}function Oe(Te,ye,De,nt){var $t=ye!==null?ye.key:null;if(typeof De=="string"&&De!==""||typeof De=="number"||typeof De=="bigint")return $t!==null?null:q(Te,ye,""+De,nt);if(typeof De=="object"&&De!==null){switch(De.$$typeof){case _:return De.key===$t?fe(Te,ye,De,nt):null;case M:return De.key===$t?Ie(Te,ye,De,nt):null;case V:return De=hl(De),Oe(Te,ye,De,nt)}if(ce(De)||ie(De))return $t!==null?null:Ke(Te,ye,De,nt,null);if(typeof De.then=="function")return Oe(Te,ye,yu(De),nt);if(De.$$typeof===I)return Oe(Te,ye,cc(Te,De),nt);uc(Te,De)}return null}function je(Te,ye,De,nt,$t){if(typeof nt=="string"&&nt!==""||typeof nt=="number"||typeof nt=="bigint")return Te=Te.get(De)||null,q(ye,Te,""+nt,$t);if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case _:return Te=Te.get(nt.key===null?De:nt.key)||null,fe(ye,Te,nt,$t);case M:return Te=Te.get(nt.key===null?De:nt.key)||null,Ie(ye,Te,nt,$t);case V:return nt=hl(nt),je(Te,ye,De,nt,$t)}if(ce(nt)||ie(nt))return Te=Te.get(De)||null,Ke(ye,Te,nt,$t,null);if(typeof nt.then=="function")return je(Te,ye,De,yu(nt),$t);if(nt.$$typeof===I)return je(Te,ye,De,cc(ye,nt),$t);uc(ye,nt)}return null}function Xt(Te,ye,De,nt){for(var $t=null,Yn=null,Zt=ye,wn=ye=0,Fn=null;Zt!==null&&wn<De.length;wn++){Zt.index>wn?(Fn=Zt,Zt=null):Fn=Zt.sibling;var Zn=Oe(Te,Zt,De[wn],nt);if(Zn===null){Zt===null&&(Zt=Fn);break}i&&Zt&&Zn.alternate===null&&a(Te,Zt),ye=T(Zn,ye,wn),Yn===null?$t=Zn:Yn.sibling=Zn,Yn=Zn,Zt=Fn}if(wn===De.length)return f(Te,Zt),Pn&&ya(Te,wn),$t;if(Zt===null){for(;wn<De.length;wn++)Zt=st(Te,De[wn],nt),Zt!==null&&(ye=T(Zt,ye,wn),Yn===null?$t=Zt:Yn.sibling=Zt,Yn=Zt);return Pn&&ya(Te,wn),$t}for(Zt=p(Zt);wn<De.length;wn++)Fn=je(Zt,Te,wn,De[wn],nt),Fn!==null&&(i&&Fn.alternate!==null&&Zt.delete(Fn.key===null?wn:Fn.key),ye=T(Fn,ye,wn),Yn===null?$t=Fn:Yn.sibling=Fn,Yn=Fn);return i&&Zt.forEach(function(Ic){return a(Te,Ic)}),Pn&&ya(Te,wn),$t}function sn(Te,ye,De,nt){if(De==null)throw Error(n(151));for(var $t=null,Yn=null,Zt=ye,wn=ye=0,Fn=null,Zn=De.next();Zt!==null&&!Zn.done;wn++,Zn=De.next()){Zt.index>wn?(Fn=Zt,Zt=null):Fn=Zt.sibling;var Ic=Oe(Te,Zt,Zn.value,nt);if(Ic===null){Zt===null&&(Zt=Fn);break}i&&Zt&&Ic.alternate===null&&a(Te,Zt),ye=T(Ic,ye,wn),Yn===null?$t=Ic:Yn.sibling=Ic,Yn=Ic,Zt=Fn}if(Zn.done)return f(Te,Zt),Pn&&ya(Te,wn),$t;if(Zt===null){for(;!Zn.done;wn++,Zn=De.next())Zn=st(Te,Zn.value,nt),Zn!==null&&(ye=T(Zn,ye,wn),Yn===null?$t=Zn:Yn.sibling=Zn,Yn=Zn);return Pn&&ya(Te,wn),$t}for(Zt=p(Zt);!Zn.done;wn++,Zn=De.next())Zn=je(Zt,Te,wn,Zn.value,nt),Zn!==null&&(i&&Zn.alternate!==null&&Zt.delete(Zn.key===null?wn:Zn.key),ye=T(Zn,ye,wn),Yn===null?$t=Zn:Yn.sibling=Zn,Yn=Zn);return i&&Zt.forEach(function(a3){return a(Te,a3)}),Pn&&ya(Te,wn),$t}function ai(Te,ye,De,nt){if(typeof De=="object"&&De!==null&&De.type===R&&De.key===null&&(De=De.props.children),typeof De=="object"&&De!==null){switch(De.$$typeof){case _:e:{for(var $t=De.key;ye!==null;){if(ye.key===$t){if($t=De.type,$t===R){if(ye.tag===7){f(Te,ye.sibling),nt=S(ye,De.props.children),nt.return=Te,Te=nt;break e}}else if(ye.elementType===$t||typeof $t=="object"&&$t!==null&&$t.$$typeof===V&&hl($t)===ye.type){f(Te,ye.sibling),nt=S(ye,De.props),Os(nt,De),nt.return=Te,Te=nt;break e}f(Te,ye);break}else a(Te,ye);ye=ye.sibling}De.type===R?(nt=Eo(De.props.children,Te.mode,nt,De.key),nt.return=Te,Te=nt):(nt=xa(De.type,De.key,De.props,null,Te.mode,nt),Os(nt,De),nt.return=Te,Te=nt)}return O(Te);case M:e:{for($t=De.key;ye!==null;){if(ye.key===$t)if(ye.tag===4&&ye.stateNode.containerInfo===De.containerInfo&&ye.stateNode.implementation===De.implementation){f(Te,ye.sibling),nt=S(ye,De.children||[]),nt.return=Te,Te=nt;break e}else{f(Te,ye);break}else a(Te,ye);ye=ye.sibling}nt=Vf(De,Te.mode,nt),nt.return=Te,Te=nt}return O(Te);case V:return De=hl(De),ai(Te,ye,De,nt)}if(ce(De))return Xt(Te,ye,De,nt);if(ie(De)){if($t=ie(De),typeof $t!="function")throw Error(n(150));return De=$t.call(De),sn(Te,ye,De,nt)}if(typeof De.then=="function")return ai(Te,ye,yu(De),nt);if(De.$$typeof===I)return ai(Te,ye,cc(Te,De),nt);uc(Te,De)}return typeof De=="string"&&De!==""||typeof De=="number"||typeof De=="bigint"?(De=""+De,ye!==null&&ye.tag===6?(f(Te,ye.sibling),nt=S(ye,De),nt.return=Te,Te=nt):(f(Te,ye),nt=kf(De,Te.mode,nt),nt.return=Te,Te=nt),O(Te)):f(Te,ye)}return function(Te,ye,De,nt){try{gl=0;var $t=ai(Te,ye,De,nt);return ml=null,$t}catch(Zt){if(Zt===fl||Zt===_n)throw Zt;var Yn=yi(29,Zt,null,Te.mode);return Yn.lanes=nt,Yn.return=Te,Yn}}}var Qa=Qf(!0),Jf=Qf(!1),Or=!1;function bu(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ep(i,a){i=i.updateQueue,a.updateQueue===i&&(a.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Ja(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Do(i,a,f){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(Kt&2)!==0){var S=p.pending;return S===null?a.next=a:(a.next=S.next,S.next=a),p.pending=a,a=Ps(i),So(i,null,f),a}return fr(i,p,a,f),Ps(i)}function Io(i,a,f){if(a=a.updateQueue,a!==null&&(a=a.shared,(f&4194048)!==0)){var p=a.lanes;p&=i.pendingLanes,f|=p,a.lanes=f,ha(i,f)}}function Jt(i,a){var f=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,f===p)){var S=null,T=null;if(f=f.firstBaseUpdate,f!==null){do{var O={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};T===null?S=T=O:T=T.next=O,f=f.next}while(f!==null);T===null?S=T=a:T=T.next=a}else S=T=a;f={baseState:p.baseState,firstBaseUpdate:S,lastBaseUpdate:T,shared:p.shared,callbacks:p.callbacks},i.updateQueue=f;return}i=f.lastBaseUpdate,i===null?f.firstBaseUpdate=a:i.next=a,f.lastBaseUpdate=a}var tp=!1;function _u(){if(tp){var i=Us;if(i!==null)throw i}}function fc(i,a,f,p){tp=!1;var S=i.updateQueue;Or=!1;var T=S.firstBaseUpdate,O=S.lastBaseUpdate,q=S.shared.pending;if(q!==null){S.shared.pending=null;var fe=q,Ie=fe.next;fe.next=null,O===null?T=Ie:O.next=Ie,O=fe;var Ke=i.alternate;Ke!==null&&(Ke=Ke.updateQueue,q=Ke.lastBaseUpdate,q!==O&&(q===null?Ke.firstBaseUpdate=Ie:q.next=Ie,Ke.lastBaseUpdate=fe))}if(T!==null){var st=S.baseState;O=0,Ke=Ie=fe=null,q=T;do{var Oe=q.lane&-536870913,je=Oe!==q.lane;if(je?(yn&Oe)===Oe:(p&Oe)===Oe){Oe!==0&&Oe===Ka&&(tp=!0),Ke!==null&&(Ke=Ke.next={lane:0,tag:q.tag,payload:q.payload,callback:null,next:null});e:{var Xt=i,sn=q;Oe=a;var ai=f;switch(sn.tag){case 1:if(Xt=sn.payload,typeof Xt=="function"){st=Xt.call(ai,st,Oe);break e}st=Xt;break e;case 3:Xt.flags=Xt.flags&-65537|128;case 0:if(Xt=sn.payload,Oe=typeof Xt=="function"?Xt.call(ai,st,Oe):Xt,Oe==null)break e;st=x({},st,Oe);break e;case 2:Or=!0}}Oe=q.callback,Oe!==null&&(i.flags|=64,je&&(i.flags|=8192),je=S.callbacks,je===null?S.callbacks=[Oe]:je.push(Oe))}else je={lane:Oe,tag:q.tag,payload:q.payload,callback:q.callback,next:null},Ke===null?(Ie=Ke=je,fe=st):Ke=Ke.next=je,O|=Oe;if(q=q.next,q===null){if(q=S.shared.pending,q===null)break;je=q,q=je.next,je.next=null,S.lastBaseUpdate=je,S.shared.pending=null}}while(!0);Ke===null&&(fe=st),S.baseState=fe,S.firstBaseUpdate=Ie,S.lastBaseUpdate=Ke,T===null&&(S.shared.lanes=0),La|=O,i.lanes=O,i.memoizedState=st}}function hc(i,a){if(typeof i!="function")throw Error(n(191,i));i.call(a)}function F0(i,a){var f=i.callbacks;if(f!==null)for(i.callbacks=null,i=0;i<f.length;i++)hc(f[i],a)}var dc=j(null),$f=j(0);function k0(i,a){i=xs,Me($f,i),Me(dc,a),xs=i|a.baseLanes}function np(){Me($f,xs),Me(dc,dc.current)}function Su(){xs=$f.current,le(dc),le($f)}var Yr=j(null),zr=null;function $a(i){var a=i.alternate;Me(Un,Un.current&1),Me(Yr,i),zr===null&&(a===null||dc.current!==null||a.memoizedState!==null)&&(zr=i)}function ip(i){Me(Un,Un.current),Me(Yr,i),zr===null&&(zr=i)}function V0(i){i.tag===22?(Me(Un,Un.current),Me(Yr,i),zr===null&&(zr=i)):Zr()}function Zr(){Me(Un,Un.current),Me(Yr,Yr.current)}function Ui(i){le(Yr),zr===i&&(zr=null),le(Un)}var Un=j(0);function ms(i){for(var a=i;a!==null;){if(a.tag===13){var f=a.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||Jy(f)||$y(f)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var mi=0,pn=null,$n=null,Dn=null,zs=!1,pc=!1,vl=!1,eh=0,Mu=0,mc=null,rp=0;function _i(){throw Error(n(321))}function sp(i,a){if(a===null)return!1;for(var f=0;f<a.length&&f<i.length;f++)if(!Pr(i[f],a[f]))return!1;return!0}function th(i,a,f,p,S,T){return mi=T,pn=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Y.H=i===null||i.memoizedState===null?yg:Tp,vl=!1,T=f(p,S),vl=!1,pc&&(T=xl(a,f,p,S)),H0(i),T}function H0(i){Y.H=gc;var a=$n!==null&&$n.next!==null;if(mi=0,Dn=$n=pn=null,zs=!1,Mu=0,mc=null,a)throw Error(n(300));i===null||Xi||(i=i.dependencies,i!==null&&gu(i)&&(Xi=!0))}function xl(i,a,f,p){pn=i;var S=0;do{if(pc&&(mc=null),Mu=0,pc=!1,25<=S)throw Error(n(301));if(S+=1,Dn=$n=null,i.updateQueue!=null){var T=i.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}Y.H=Bs,T=a(f,p)}while(pc);return T}function yl(){var i=Y.H,a=i.useState()[0];return a=typeof a.then=="function"?Eu(a):a,i=i.useState()[0],($n!==null?$n.memoizedState:null)!==i&&(pn.flags|=1024),a}function ap(){var i=eh!==0;return eh=0,i}function op(i,a,f){a.updateQueue=i.updateQueue,a.flags&=-2053,i.lanes&=~f}function lp(i){if(zs){for(i=i.memoizedState;i!==null;){var a=i.queue;a!==null&&(a.pending=null),i=i.next}zs=!1}mi=0,Dn=$n=pn=null,pc=!1,Mu=eh=0,mc=null}function er(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dn===null?pn.memoizedState=Dn=i:Dn=Dn.next=i,Dn}function Oi(){if($n===null){var i=pn.alternate;i=i!==null?i.memoizedState:null}else i=$n.next;var a=Dn===null?pn.memoizedState:Dn.next;if(a!==null)Dn=a,$n=i;else{if(i===null)throw pn.alternate===null?Error(n(467)):Error(n(310));$n=i,i={memoizedState:$n.memoizedState,baseState:$n.baseState,baseQueue:$n.baseQueue,queue:$n.queue,next:null},Dn===null?pn.memoizedState=Dn=i:Dn=Dn.next=i}return Dn}function nh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Eu(i){var a=Mu;return Mu+=1,mc===null&&(mc=[]),i=Kf(mc,i,a),a=pn,(Dn===null?a.memoizedState:Dn.next)===null&&(a=a.alternate,Y.H=a===null||a.memoizedState===null?yg:Tp),i}function Lo(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Eu(i);if(i.$$typeof===I)return an(i)}throw Error(n(438,String(i)))}function cp(i){var a=null,f=pn.updateQueue;if(f!==null&&(a=f.memoCache),a==null){var p=pn.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(a={data:p.data.map(function(S){return S.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),f===null&&(f=nh(),pn.updateQueue=f),f.memoCache=a,f=a.data[a.index],f===void 0)for(f=a.data[a.index]=Array(i),p=0;p<i;p++)f[p]=B;return a.index++,f}function eo(i,a){return typeof a=="function"?a(i):a}function ih(i){var a=Oi();return up(a,$n,i)}function up(i,a,f){var p=i.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=f;var S=i.baseQueue,T=p.pending;if(T!==null){if(S!==null){var O=S.next;S.next=T.next,T.next=O}a.baseQueue=S=T,p.pending=null}if(T=i.baseState,S===null)i.memoizedState=T;else{a=S.next;var q=O=null,fe=null,Ie=a,Ke=!1;do{var st=Ie.lane&-536870913;if(st!==Ie.lane?(yn&st)===st:(mi&st)===st){var Oe=Ie.revertLane;if(Oe===0)fe!==null&&(fe=fe.next={lane:0,revertLane:0,gesture:null,action:Ie.action,hasEagerState:Ie.hasEagerState,eagerState:Ie.eagerState,next:null}),st===Ka&&(Ke=!0);else if((mi&Oe)===Oe){Ie=Ie.next,Oe===Ka&&(Ke=!0);continue}else st={lane:0,revertLane:Ie.revertLane,gesture:null,action:Ie.action,hasEagerState:Ie.hasEagerState,eagerState:Ie.eagerState,next:null},fe===null?(q=fe=st,O=T):fe=fe.next=st,pn.lanes|=Oe,La|=Oe;st=Ie.action,vl&&f(T,st),T=Ie.hasEagerState?Ie.eagerState:f(T,st)}else Oe={lane:st,revertLane:Ie.revertLane,gesture:Ie.gesture,action:Ie.action,hasEagerState:Ie.hasEagerState,eagerState:Ie.eagerState,next:null},fe===null?(q=fe=Oe,O=T):fe=fe.next=Oe,pn.lanes|=st,La|=st;Ie=Ie.next}while(Ie!==null&&Ie!==a);if(fe===null?O=T:fe.next=q,!Pr(T,i.memoizedState)&&(Xi=!0,Ke&&(f=Us,f!==null)))throw f;i.memoizedState=T,i.baseState=O,i.baseQueue=fe,p.lastRenderedState=T}return S===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function fp(i){var a=Oi(),f=a.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=i;var p=f.dispatch,S=f.pending,T=a.memoizedState;if(S!==null){f.pending=null;var O=S=S.next;do T=i(T,O.action),O=O.next;while(O!==S);Pr(T,a.memoizedState)||(Xi=!0),a.memoizedState=T,a.baseQueue===null&&(a.baseState=T),f.lastRenderedState=T}return[T,p]}function G0(i,a,f){var p=pn,S=Oi(),T=Pn;if(T){if(f===void 0)throw Error(n(407));f=f()}else f=a();var O=!Pr(($n||S).memoizedState,f);if(O&&(S.memoizedState=f,Xi=!0),S=S.queue,yp(X0.bind(null,p,S,i),[i]),S.getSnapshot!==a||O||Dn!==null&&Dn.memoizedState.tag&1){if(p.flags|=2048,Po(9,{destroy:void 0},W0.bind(null,p,S,f,a),null),ln===null)throw Error(n(349));T||(mi&127)!==0||j0(p,a,f)}return f}function j0(i,a,f){i.flags|=16384,i={getSnapshot:a,value:f},a=pn.updateQueue,a===null?(a=nh(),pn.updateQueue=a,a.stores=[i]):(f=a.stores,f===null?a.stores=[i]:f.push(i))}function W0(i,a,f,p){a.value=f,a.getSnapshot=p,q0(a)&&Y0(i)}function X0(i,a,f){return f(function(){q0(a)&&Y0(i)})}function q0(i){var a=i.getSnapshot;i=i.value;try{var f=a();return!Pr(i,f)}catch{return!0}}function Y0(i){var a=Ur(i,2);a!==null&&Mn(a,i,2)}function hp(i){var a=er();if(typeof i=="function"){var f=i;if(i=f(),vl){Ze(!0);try{f()}finally{Ze(!1)}}}return a.memoizedState=a.baseState=i,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:eo,lastRenderedState:i},a}function dp(i,a,f,p){return i.baseState=f,up(i,$n,typeof p=="function"?p:eo)}function Oy(i,a,f,p,S){if(oh(i))throw Error(n(485));if(i=a.action,i!==null){var T={payload:S,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(O){T.listeners.push(O)}};Y.T!==null?f(!0):T.isTransition=!1,p(T),f=a.pending,f===null?(T.next=a.pending=T,Z0(a,T)):(T.next=f.next,a.pending=f.next=T)}}function Z0(i,a){var f=a.action,p=a.payload,S=i.state;if(a.isTransition){var T=Y.T,O={};Y.T=O;try{var q=f(S,p),fe=Y.S;fe!==null&&fe(O,q),K0(i,a,q)}catch(Ie){pp(i,a,Ie)}finally{T!==null&&O.types!==null&&(T.types=O.types),Y.T=T}}else try{T=f(S,p),K0(i,a,T)}catch(Ie){pp(i,a,Ie)}}function K0(i,a,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(p){Q0(i,a,p)},function(p){return pp(i,a,p)}):Q0(i,a,f)}function Q0(i,a,f){a.status="fulfilled",a.value=f,J0(a),i.state=f,a=i.pending,a!==null&&(f=a.next,f===a?i.pending=null:(f=f.next,a.next=f,Z0(i,f)))}function pp(i,a,f){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do a.status="rejected",a.reason=f,J0(a),a=a.next;while(a!==p)}i.action=null}function J0(i){i=i.listeners;for(var a=0;a<i.length;a++)(0,i[a])()}function mp(i,a){return a}function gp(i,a){if(Pn){var f=ln.formState;if(f!==null){e:{var p=pn;if(Pn){if(ii){t:{for(var S=ii,T=ds;S.nodeType!==8;){if(!T){S=null;break t}if(S=Oa(S.nextSibling),S===null){S=null;break t}}T=S.data,S=T==="F!"||T==="F"?S:null}if(S){ii=Oa(S.nextSibling),p=S.data==="F!";break e}}_a(p)}p=!1}p&&(a=f[0])}}return f=er(),f.memoizedState=f.baseState=a,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mp,lastRenderedState:a},f.queue=p,f=gg.bind(null,pn,p),p.dispatch=f,p=hp(!1),T=Ep.bind(null,pn,!1,p.queue),p=er(),S={state:a,dispatch:null,action:i,pending:null},p.queue=S,f=Oy.bind(null,pn,S,T,f),S.dispatch=f,p.memoizedState=i,[a,f,!1]}function $0(i){var a=Oi();return vp(a,$n,i)}function vp(i,a,f){if(a=up(i,a,mp)[0],i=ih(eo)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var p=Eu(a)}catch(O){throw O===fl?_n:O}else p=a;a=Oi();var S=a.queue,T=S.dispatch;return f!==a.memoizedState&&(pn.flags|=2048,Po(9,{destroy:void 0},eg.bind(null,S,f),null)),[p,T,i]}function eg(i,a){i.action=a}function xp(i){var a=Oi(),f=$n;if(f!==null)return vp(a,f,i);Oi(),a=a.memoizedState,f=Oi();var p=f.queue.dispatch;return f.memoizedState=i,[a,p,!1]}function Po(i,a,f,p){return i={tag:i,create:f,deps:p,inst:a,next:null},a=pn.updateQueue,a===null&&(a=nh(),pn.updateQueue=a),f=a.lastEffect,f===null?a.lastEffect=i.next=i:(p=f.next,f.next=i,i.next=p,a.lastEffect=i),i}function rh(){return Oi().memoizedState}function sh(i,a,f,p){var S=er();pn.flags|=i,S.memoizedState=Po(1|a,{destroy:void 0},f,p===void 0?null:p)}function ah(i,a,f,p){var S=Oi();p=p===void 0?null:p;var T=S.memoizedState.inst;$n!==null&&p!==null&&sp(p,$n.memoizedState.deps)?S.memoizedState=Po(a,T,f,p):(pn.flags|=i,S.memoizedState=Po(1|a,T,f,p))}function tg(i,a){sh(8390656,8,i,a)}function yp(i,a){ah(2048,8,i,a)}function ng(i){pn.flags|=4;var a=pn.updateQueue;if(a===null)a=nh(),pn.updateQueue=a,a.events=[i];else{var f=a.events;f===null?a.events=[i]:f.push(i)}}function ig(i){var a=Oi().memoizedState;return ng({ref:a,nextImpl:i}),function(){if((Kt&2)!==0)throw Error(n(440));return a.impl.apply(void 0,arguments)}}function rg(i,a){return ah(4,2,i,a)}function sg(i,a){return ah(4,4,i,a)}function ag(i,a){if(typeof a=="function"){i=i();var f=a(i);return function(){typeof f=="function"?f():a(null)}}if(a!=null)return i=i(),a.current=i,function(){a.current=null}}function og(i,a,f){f=f!=null?f.concat([i]):null,ah(4,4,ag.bind(null,a,i),f)}function bp(){}function lg(i,a){var f=Oi();a=a===void 0?null:a;var p=f.memoizedState;return a!==null&&sp(a,p[1])?p[0]:(f.memoizedState=[i,a],i)}function cg(i,a){var f=Oi();a=a===void 0?null:a;var p=f.memoizedState;if(a!==null&&sp(a,p[1]))return p[0];if(p=i(),vl){Ze(!0);try{i()}finally{Ze(!1)}}return f.memoizedState=[p,a],p}function _p(i,a,f){return f===void 0||(mi&1073741824)!==0&&(yn&261930)===0?i.memoizedState=a:(i.memoizedState=f,i=Cn(),pn.lanes|=i,La|=i,f)}function ug(i,a,f,p){return Pr(f,a)?f:dc.current!==null?(i=_p(i,f,p),Pr(i,a)||(Xi=!0),i):(mi&42)===0||(mi&1073741824)!==0&&(yn&261930)===0?(Xi=!0,i.memoizedState=f):(i=Cn(),pn.lanes|=i,La|=i,a)}function fg(i,a,f,p,S){var T=ne.p;ne.p=T!==0&&8>T?T:8;var O=Y.T,q={};Y.T=q,Ep(i,!1,a,f);try{var fe=S(),Ie=Y.S;if(Ie!==null&&Ie(q,fe),fe!==null&&typeof fe=="object"&&typeof fe.then=="function"){var Ke=Jd(fe,p);Tu(i,a,Ke,bs(i))}else Tu(i,a,p,bs(i))}catch(st){Tu(i,a,{then:function(){},status:"rejected",reason:st},bs())}finally{ne.p=T,O!==null&&q.types!==null&&(O.types=q.types),Y.T=O}}function zy(){}function Sp(i,a,f,p){if(i.tag!==5)throw Error(n(476));var S=hg(i).queue;fg(i,S,a,ve,f===null?zy:function(){return dg(i),f(p)})}function hg(i){var a=i.memoizedState;if(a!==null)return a;a={memoizedState:ve,baseState:ve,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:eo,lastRenderedState:ve},next:null};var f={};return a.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:eo,lastRenderedState:f},next:null},i.memoizedState=a,i=i.alternate,i!==null&&(i.memoizedState=a),a}function dg(i){var a=hg(i);a.next===null&&(a=i.alternate.memoizedState),Tu(i,a.next.queue,{},bs())}function Mp(){return an(Wp)}function pg(){return Oi().memoizedState}function mg(){return Oi().memoizedState}function By(i){for(var a=i.return;a!==null;){switch(a.tag){case 24:case 3:var f=bs();i=Ja(f);var p=Do(a,i,f);p!==null&&(Mn(p,a,f),Io(p,a,f)),a={cache:Zd()},i.payload=a;return}a=a.return}}function Fy(i,a,f){var p=bs();f={lane:p,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},oh(i)?vg(a,f):(f=Bf(i,a,f,p),f!==null&&(Mn(f,i,p),xg(f,a,p)))}function gg(i,a,f){var p=bs();Tu(i,a,f,p)}function Tu(i,a,f,p){var S={lane:p,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(oh(i))vg(a,S);else{var T=i.alternate;if(i.lanes===0&&(T===null||T.lanes===0)&&(T=a.lastRenderedReducer,T!==null))try{var O=a.lastRenderedState,q=T(O,f);if(S.hasEagerState=!0,S.eagerState=q,Pr(q,O))return fr(i,a,S,0),ln===null&&pu(),!1}catch{}if(f=Bf(i,a,S,p),f!==null)return Mn(f,i,p),xg(f,a,p),!0}return!1}function Ep(i,a,f,p){if(p={lane:2,revertLane:Ve(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},oh(i)){if(a)throw Error(n(479))}else a=Bf(i,f,p,2),a!==null&&Mn(a,i,2)}function oh(i){var a=i.alternate;return i===pn||a!==null&&a===pn}function vg(i,a){pc=zs=!0;var f=i.pending;f===null?a.next=a:(a.next=f.next,f.next=a),i.pending=a}function xg(i,a,f){if((f&4194048)!==0){var p=a.lanes;p&=i.pendingLanes,f|=p,a.lanes=f,ha(i,f)}}var gc={readContext:an,use:Lo,useCallback:_i,useContext:_i,useEffect:_i,useImperativeHandle:_i,useLayoutEffect:_i,useInsertionEffect:_i,useMemo:_i,useReducer:_i,useRef:_i,useState:_i,useDebugValue:_i,useDeferredValue:_i,useTransition:_i,useSyncExternalStore:_i,useId:_i,useHostTransitionStatus:_i,useFormState:_i,useActionState:_i,useOptimistic:_i,useMemoCache:_i,useCacheRefresh:_i};gc.useEffectEvent=_i;var yg={readContext:an,use:Lo,useCallback:function(i,a){return er().memoizedState=[i,a===void 0?null:a],i},useContext:an,useEffect:tg,useImperativeHandle:function(i,a,f){f=f!=null?f.concat([i]):null,sh(4194308,4,ag.bind(null,a,i),f)},useLayoutEffect:function(i,a){return sh(4194308,4,i,a)},useInsertionEffect:function(i,a){sh(4,2,i,a)},useMemo:function(i,a){var f=er();a=a===void 0?null:a;var p=i();if(vl){Ze(!0);try{i()}finally{Ze(!1)}}return f.memoizedState=[p,a],p},useReducer:function(i,a,f){var p=er();if(f!==void 0){var S=f(a);if(vl){Ze(!0);try{f(a)}finally{Ze(!1)}}}else S=a;return p.memoizedState=p.baseState=S,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:S},p.queue=i,i=i.dispatch=Fy.bind(null,pn,i),[p.memoizedState,i]},useRef:function(i){var a=er();return i={current:i},a.memoizedState=i},useState:function(i){i=hp(i);var a=i.queue,f=gg.bind(null,pn,a);return a.dispatch=f,[i.memoizedState,f]},useDebugValue:bp,useDeferredValue:function(i,a){var f=er();return _p(f,i,a)},useTransition:function(){var i=hp(!1);return i=fg.bind(null,pn,i.queue,!0,!1),er().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,a,f){var p=pn,S=er();if(Pn){if(f===void 0)throw Error(n(407));f=f()}else{if(f=a(),ln===null)throw Error(n(349));(yn&127)!==0||j0(p,a,f)}S.memoizedState=f;var T={value:f,getSnapshot:a};return S.queue=T,tg(X0.bind(null,p,T,i),[i]),p.flags|=2048,Po(9,{destroy:void 0},W0.bind(null,p,T,f,a),null),f},useId:function(){var i=er(),a=ln.identifierPrefix;if(Pn){var f=Js,p=bi;f=(p&~(1<<32-ee(p)-1)).toString(32)+f,a="_"+a+"R_"+f,f=eh++,0<f&&(a+="H"+f.toString(32)),a+="_"}else f=rp++,a="_"+a+"r_"+f.toString(32)+"_";return i.memoizedState=a},useHostTransitionStatus:Mp,useFormState:gp,useActionState:gp,useOptimistic:function(i){var a=er();a.memoizedState=a.baseState=i;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=f,a=Ep.bind(null,pn,!0,f),f.dispatch=a,[i,a]},useMemoCache:cp,useCacheRefresh:function(){return er().memoizedState=By.bind(null,pn)},useEffectEvent:function(i){var a=er(),f={impl:i};return a.memoizedState=f,function(){if((Kt&2)!==0)throw Error(n(440));return f.impl.apply(void 0,arguments)}}},Tp={readContext:an,use:Lo,useCallback:lg,useContext:an,useEffect:yp,useImperativeHandle:og,useInsertionEffect:rg,useLayoutEffect:sg,useMemo:cg,useReducer:ih,useRef:rh,useState:function(){return ih(eo)},useDebugValue:bp,useDeferredValue:function(i,a){var f=Oi();return ug(f,$n.memoizedState,i,a)},useTransition:function(){var i=ih(eo)[0],a=Oi().memoizedState;return[typeof i=="boolean"?i:Eu(i),a]},useSyncExternalStore:G0,useId:pg,useHostTransitionStatus:Mp,useFormState:$0,useActionState:$0,useOptimistic:function(i,a){var f=Oi();return dp(f,$n,i,a)},useMemoCache:cp,useCacheRefresh:mg};Tp.useEffectEvent=ig;var Bs={readContext:an,use:Lo,useCallback:lg,useContext:an,useEffect:yp,useImperativeHandle:og,useInsertionEffect:rg,useLayoutEffect:sg,useMemo:cg,useReducer:fp,useRef:rh,useState:function(){return fp(eo)},useDebugValue:bp,useDeferredValue:function(i,a){var f=Oi();return $n===null?_p(f,i,a):ug(f,$n.memoizedState,i,a)},useTransition:function(){var i=fp(eo)[0],a=Oi().memoizedState;return[typeof i=="boolean"?i:Eu(i),a]},useSyncExternalStore:G0,useId:pg,useHostTransitionStatus:Mp,useFormState:xp,useActionState:xp,useOptimistic:function(i,a){var f=Oi();return $n!==null?dp(f,$n,i,a):(f.baseState=i,[i,f.queue.dispatch])},useMemoCache:cp,useCacheRefresh:mg};Bs.useEffectEvent=ig;function lh(i,a,f,p){a=i.memoizedState,f=f(p,a),f=f==null?a:x({},a,f),i.memoizedState=f,i.lanes===0&&(i.updateQueue.baseState=f)}var wu={enqueueSetState:function(i,a,f){i=i._reactInternals;var p=bs(),S=Ja(p);S.payload=a,f!=null&&(S.callback=f),a=Do(i,S,p),a!==null&&(Mn(a,i,p),Io(a,i,p))},enqueueReplaceState:function(i,a,f){i=i._reactInternals;var p=bs(),S=Ja(p);S.tag=1,S.payload=a,f!=null&&(S.callback=f),a=Do(i,S,p),a!==null&&(Mn(a,i,p),Io(a,i,p))},enqueueForceUpdate:function(i,a){i=i._reactInternals;var f=bs(),p=Ja(f);p.tag=2,a!=null&&(p.callback=a),a=Do(i,p,f),a!==null&&(Mn(a,i,f),Io(a,i,f))}};function wp(i,a,f,p,S,T,O){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,T,O):a.prototype&&a.prototype.isPureReactComponent?!Jl(f,p)||!Jl(S,T):!0}function Ap(i,a,f,p){i=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(f,p),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(f,p),a.state!==i&&wu.enqueueReplaceState(a,a.state,null)}function Uo(i,a){var f=a;if("ref"in a){f={};for(var p in a)p!=="ref"&&(f[p]=a[p])}if(i=i.defaultProps){f===a&&(f=x({},f));for(var S in i)f[S]===void 0&&(f[S]=i[S])}return f}function bg(i){du(i)}function Cp(i){console.error(i)}function Rp(i){du(i)}function ch(i,a){try{var f=i.onUncaughtError;f(a.value,{componentStack:a.stack})}catch(p){setTimeout(function(){throw p})}}function _g(i,a,f){try{var p=i.onCaughtError;p(f.value,{componentStack:f.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function Np(i,a,f){return f=Ja(f),f.tag=3,f.payload={element:null},f.callback=function(){ch(i,a)},f}function Dp(i){return i=Ja(i),i.tag=3,i}function Sg(i,a,f,p){var S=f.type.getDerivedStateFromError;if(typeof S=="function"){var T=p.value;i.payload=function(){return S(T)},i.callback=function(){_g(a,f,p)}}var O=f.stateNode;O!==null&&typeof O.componentDidCatch=="function"&&(i.callback=function(){_g(a,f,p),typeof S!="function"&&(Fi===null?Fi=new Set([this]):Fi.add(this));var q=p.stack;this.componentDidCatch(p.value,{componentStack:q!==null?q:""})})}function tr(i,a,f,p,S){if(f.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(a=f.alternate,a!==null&&Ta(a,f,S,!0),f=Yr.current,f!==null){switch(f.tag){case 31:case 13:return zr===null?Mc():f.alternate===null&&Si===0&&(Si=3),f.flags&=-257,f.flags|=65536,f.lanes=S,p===Zf?f.flags|=16384:(a=f.updateQueue,a===null?f.updateQueue=new Set([p]):a.add(p),Bu(i,p,S)),!1;case 22:return f.flags|=65536,p===Zf?f.flags|=16384:(a=f.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([p])},f.updateQueue=a):(f=a.retryQueue,f===null?a.retryQueue=new Set([p]):f.add(p)),Bu(i,p,S)),!1}throw Error(n(435,f.tag))}return Bu(i,p,S),Mc(),!1}if(Pn)return a=Yr.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=S,p!==ac&&(i=Error(n(422),{cause:p}),Sa(hs(i,f)))):(p!==ac&&(a=Error(n(423),{cause:p}),Sa(hs(a,f))),i=i.current.alternate,i.flags|=65536,S&=-S,i.lanes|=S,p=hs(p,f),S=Np(i.stateNode,p,S),Jt(i,S),Si!==4&&(Si=2)),!1;var T=Error(n(520),{cause:p});if(T=hs(T,f),Al===null?Al=[T]:Al.push(T),Si!==4&&(Si=2),a===null)return!0;p=hs(p,f),f=a;do{switch(f.tag){case 3:return f.flags|=65536,i=S&-S,f.lanes|=i,i=Np(f.stateNode,p,i),Jt(f,i),!1;case 1:if(a=f.type,T=f.stateNode,(f.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Fi===null||!Fi.has(T))))return f.flags|=65536,S&=-S,f.lanes|=S,S=Dp(S),Sg(S,i,f,p),Jt(f,S),!1}f=f.return}while(f!==null);return!1}var uh=Error(n(461)),Xi=!1;function hr(i,a,f,p){a.child=i===null?Jf(a,null,f,p):Qa(a,i.child,f,p)}function Ip(i,a,f,p,S){f=f.render;var T=a.ref;if("ref"in p){var O={};for(var q in p)q!=="ref"&&(O[q]=p[q])}else O=p;return Ro(a),p=th(i,a,f,O,T,S),q=ap(),i!==null&&!Xi?(op(i,a,S),zi(i,a,S)):(Pn&&q&&ba(a),a.flags|=1,hr(i,a,p,S),a.child)}function bl(i,a,f,p,S){if(i===null){var T=f.type;return typeof T=="function"&&!Ff(T)&&T.defaultProps===void 0&&f.compare===null?(a.tag=15,a.type=T,fh(i,a,T,p,S)):(i=xa(f.type,null,p,a,a.mode,S),i.ref=a.ref,i.return=a,a.child=i)}if(T=i.child,!vh(i,S)){var O=T.memoizedProps;if(f=f.compare,f=f!==null?f:Jl,f(O,p)&&i.ref===a.ref)return zi(i,a,S)}return a.flags|=1,i=Wr(T,p),i.ref=a.ref,i.return=a,a.child=i}function fh(i,a,f,p,S){if(i!==null){var T=i.memoizedProps;if(Jl(T,p)&&i.ref===a.ref)if(Xi=!1,a.pendingProps=p=T,vh(i,S))(i.flags&131072)!==0&&(Xi=!0);else return a.lanes=i.lanes,zi(i,a,S)}return vc(i,a,f,p,S)}function _l(i,a,f,p){var S=p.children,T=i!==null?i.memoizedState:null;if(i===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((a.flags&128)!==0){if(T=T!==null?T.baseLanes|f:f,i!==null){for(p=a.child=i.child,S=0;p!==null;)S=S|p.lanes|p.childLanes,p=p.sibling;p=S&~T}else p=0,a.child=null;return Kr(i,a,T,f,p)}if((f&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},i!==null&&vu(a,T!==null?T.cachePool:null),T!==null?k0(a,T):np(),V0(a);else return p=a.lanes=536870912,Kr(i,a,T!==null?T.baseLanes|f:f,f,p)}else T!==null?(vu(a,T.cachePool),k0(a,T),Zr(),a.memoizedState=null):(i!==null&&vu(a,null),np(),Zr());return hr(i,a,S,f),a.child}function Aa(i,a){return i!==null&&i.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Kr(i,a,f,p,S){var T=Yf();return T=T===null?null:{parent:Wi._currentValue,pool:T},a.memoizedState={baseLanes:f,cachePool:T},i!==null&&vu(a,null),np(),V0(a),i!==null&&Ta(i,a,p,!0),a.childLanes=S,null}function hh(i,a){return a=gh({mode:a.mode,children:a.children},i.mode),a.ref=i.ref,i.child=a,a.return=i,a}function Mg(i,a,f){return Qa(a,i.child,null,f),i=hh(a,a.pendingProps),i.flags|=2,Ui(a),a.memoizedState=null,i}function dh(i,a,f){var p=a.pendingProps,S=(a.flags&128)!==0;if(a.flags&=-129,i===null){if(Pn){if(p.mode==="hidden")return i=hh(a,p),a.lanes=536870912,Aa(null,i);if(ip(a),(i=ii)?(i=cS(i,ds),i=i!==null&&i.data==="&"?i:null,i!==null&&(a.memoizedState={dehydrated:i,treeContext:qa!==null?{id:bi,overflow:Js}:null,retryLane:536870912,hydrationErrors:null},f=ic(i),f.return=a,a.child=f,Ai=a,ii=null)):i=null,i===null)throw _a(a);return a.lanes=536870912,null}return hh(a,p)}var T=i.memoizedState;if(T!==null){var O=T.dehydrated;if(ip(a),S)if(a.flags&256)a.flags&=-257,a=Mg(i,a,f);else if(a.memoizedState!==null)a.child=i.child,a.flags|=128,a=null;else throw Error(n(558));else if(Xi||Ta(i,a,f,!1),S=(f&i.childLanes)!==0,Xi||S){if(p=ln,p!==null&&(O=Cs(p,f),O!==0&&O!==T.retryLane))throw T.retryLane=O,Ur(i,O),Mn(p,i,O),uh;Mc(),a=Mg(i,a,f)}else i=T.treeContext,ii=Oa(O.nextSibling),Ai=a,Pn=!0,Ya=null,ds=!1,i!==null&&Gf(a,i),a=hh(a,p),a.flags|=4096;return a}return i=Wr(i.child,{mode:p.mode,children:p.children}),i.ref=a.ref,a.child=i,i.return=a,i}function Sl(i,a){var f=a.ref;if(f===null)i!==null&&i.ref!==null&&(a.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(n(284));(i===null||i.ref!==f)&&(a.flags|=4194816)}}function vc(i,a,f,p,S){return Ro(a),f=th(i,a,f,p,void 0,S),p=ap(),i!==null&&!Xi?(op(i,a,S),zi(i,a,S)):(Pn&&p&&ba(a),a.flags|=1,hr(i,a,f,S),a.child)}function Au(i,a,f,p,S,T){return Ro(a),a.updateQueue=null,f=xl(a,p,f,S),H0(i),p=ap(),i!==null&&!Xi?(op(i,a,T),zi(i,a,T)):(Pn&&p&&ba(a),a.flags|=1,hr(i,a,f,T),a.child)}function ph(i,a,f,p,S){if(Ro(a),a.stateNode===null){var T=Mo,O=f.contextType;typeof O=="object"&&O!==null&&(T=an(O)),T=new f(p,T),a.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=wu,a.stateNode=T,T._reactInternals=a,T=a.stateNode,T.props=p,T.state=a.memoizedState,T.refs={},bu(a),O=f.contextType,T.context=typeof O=="object"&&O!==null?an(O):Mo,T.state=a.memoizedState,O=f.getDerivedStateFromProps,typeof O=="function"&&(lh(a,f,O,p),T.state=a.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(O=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),O!==T.state&&wu.enqueueReplaceState(T,T.state,null),fc(a,p,T,S),_u(),T.state=a.memoizedState),typeof T.componentDidMount=="function"&&(a.flags|=4194308),p=!0}else if(i===null){T=a.stateNode;var q=a.memoizedProps,fe=Uo(f,q);T.props=fe;var Ie=T.context,Ke=f.contextType;O=Mo,typeof Ke=="object"&&Ke!==null&&(O=an(Ke));var st=f.getDerivedStateFromProps;Ke=typeof st=="function"||typeof T.getSnapshotBeforeUpdate=="function",q=a.pendingProps!==q,Ke||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(q||Ie!==O)&&Ap(a,T,p,O),Or=!1;var Oe=a.memoizedState;T.state=Oe,fc(a,p,T,S),_u(),Ie=a.memoizedState,q||Oe!==Ie||Or?(typeof st=="function"&&(lh(a,f,st,p),Ie=a.memoizedState),(fe=Or||wp(a,f,fe,p,Oe,Ie,O))?(Ke||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(a.flags|=4194308)):(typeof T.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=p,a.memoizedState=Ie),T.props=p,T.state=Ie,T.context=O,p=fe):(typeof T.componentDidMount=="function"&&(a.flags|=4194308),p=!1)}else{T=a.stateNode,ep(i,a),O=a.memoizedProps,Ke=Uo(f,O),T.props=Ke,st=a.pendingProps,Oe=T.context,Ie=f.contextType,fe=Mo,typeof Ie=="object"&&Ie!==null&&(fe=an(Ie)),q=f.getDerivedStateFromProps,(Ie=typeof q=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(O!==st||Oe!==fe)&&Ap(a,T,p,fe),Or=!1,Oe=a.memoizedState,T.state=Oe,fc(a,p,T,S),_u();var je=a.memoizedState;O!==st||Oe!==je||Or||i!==null&&i.dependencies!==null&&gu(i.dependencies)?(typeof q=="function"&&(lh(a,f,q,p),je=a.memoizedState),(Ke=Or||wp(a,f,Ke,p,Oe,je,fe)||i!==null&&i.dependencies!==null&&gu(i.dependencies))?(Ie||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(p,je,fe),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(p,je,fe)),typeof T.componentDidUpdate=="function"&&(a.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof T.componentDidUpdate!="function"||O===i.memoizedProps&&Oe===i.memoizedState||(a.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||O===i.memoizedProps&&Oe===i.memoizedState||(a.flags|=1024),a.memoizedProps=p,a.memoizedState=je),T.props=p,T.state=je,T.context=fe,p=Ke):(typeof T.componentDidUpdate!="function"||O===i.memoizedProps&&Oe===i.memoizedState||(a.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||O===i.memoizedProps&&Oe===i.memoizedState||(a.flags|=1024),p=!1)}return T=p,Sl(i,a),p=(a.flags&128)!==0,T||p?(T=a.stateNode,f=p&&typeof f.getDerivedStateFromError!="function"?null:T.render(),a.flags|=1,i!==null&&p?(a.child=Qa(a,i.child,null,S),a.child=Qa(a,null,f,S)):hr(i,a,f,S),a.memoizedState=T.state,i=a.child):i=zi(i,a,S),i}function Eg(i,a,f,p){return Ao(),a.flags|=256,hr(i,a,f,p),a.child}var Lp={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ar(i){return{baseLanes:i,cachePool:$d()}}function mh(i,a,f){return i=i!==null?i.childLanes&~f:0,a&&(i|=kr),i}function Tg(i,a,f){var p=a.pendingProps,S=!1,T=(a.flags&128)!==0,O;if((O=T)||(O=i!==null&&i.memoizedState===null?!1:(Un.current&2)!==0),O&&(S=!0,a.flags&=-129),O=(a.flags&32)!==0,a.flags&=-33,i===null){if(Pn){if(S?$a(a):Zr(),(i=ii)?(i=cS(i,ds),i=i!==null&&i.data!=="&"?i:null,i!==null&&(a.memoizedState={dehydrated:i,treeContext:qa!==null?{id:bi,overflow:Js}:null,retryLane:536870912,hydrationErrors:null},f=ic(i),f.return=a,a.child=f,Ai=a,ii=null)):i=null,i===null)throw _a(a);return $y(i)?a.lanes=32:a.lanes=536870912,null}var q=p.children;return p=p.fallback,S?(Zr(),S=a.mode,q=gh({mode:"hidden",children:q},S),p=Eo(p,S,f,null),q.return=a,p.return=a,q.sibling=p,a.child=q,p=a.child,p.memoizedState=Ar(f),p.childLanes=mh(i,O,f),a.memoizedState=Lp,Aa(null,p)):($a(a),Cu(a,q))}var fe=i.memoizedState;if(fe!==null&&(q=fe.dehydrated,q!==null)){if(T)a.flags&256?($a(a),a.flags&=-257,a=Pp(i,a,f)):a.memoizedState!==null?(Zr(),a.child=i.child,a.flags|=128,a=null):(Zr(),q=p.fallback,S=a.mode,p=gh({mode:"visible",children:p.children},S),q=Eo(q,S,f,null),q.flags|=2,p.return=a,q.return=a,p.sibling=q,a.child=p,Qa(a,i.child,null,f),p=a.child,p.memoizedState=Ar(f),p.childLanes=mh(i,O,f),a.memoizedState=Lp,a=Aa(null,p));else if($a(a),$y(q)){if(O=q.nextSibling&&q.nextSibling.dataset,O)var Ie=O.dgst;O=Ie,p=Error(n(419)),p.stack="",p.digest=O,Sa({value:p,source:null,stack:null}),a=Pp(i,a,f)}else if(Xi||Ta(i,a,f,!1),O=(f&i.childLanes)!==0,Xi||O){if(O=ln,O!==null&&(p=Cs(O,f),p!==0&&p!==fe.retryLane))throw fe.retryLane=p,Ur(i,p),Mn(O,i,p),uh;Jy(q)||Mc(),a=Pp(i,a,f)}else Jy(q)?(a.flags|=192,a.child=i.child,a=null):(i=fe.treeContext,ii=Oa(q.nextSibling),Ai=a,Pn=!0,Ya=null,ds=!1,i!==null&&Gf(a,i),a=Cu(a,p.children),a.flags|=4096);return a}return S?(Zr(),q=p.fallback,S=a.mode,fe=i.child,Ie=fe.sibling,p=Wr(fe,{mode:"hidden",children:p.children}),p.subtreeFlags=fe.subtreeFlags&65011712,Ie!==null?q=Wr(Ie,q):(q=Eo(q,S,f,null),q.flags|=2),q.return=a,p.return=a,p.sibling=q,a.child=p,Aa(null,p),p=a.child,q=i.child.memoizedState,q===null?q=Ar(f):(S=q.cachePool,S!==null?(fe=Wi._currentValue,S=S.parent!==fe?{parent:fe,pool:fe}:S):S=$d(),q={baseLanes:q.baseLanes|f,cachePool:S}),p.memoizedState=q,p.childLanes=mh(i,O,f),a.memoizedState=Lp,Aa(i.child,p)):($a(a),f=i.child,i=f.sibling,f=Wr(f,{mode:"visible",children:p.children}),f.return=a,f.sibling=null,i!==null&&(O=a.deletions,O===null?(a.deletions=[i],a.flags|=16):O.push(i)),a.child=f,a.memoizedState=null,f)}function Cu(i,a){return a=gh({mode:"visible",children:a},i.mode),a.return=i,i.child=a}function gh(i,a){return i=yi(22,i,null,a),i.lanes=0,i}function Pp(i,a,f){return Qa(a,i.child,null,f),i=Cu(a,a.pendingProps.children),i.flags|=2,a.memoizedState=null,i}function wg(i,a,f){i.lanes|=a;var p=i.alternate;p!==null&&(p.lanes|=a),Wf(i.return,a,f)}function Ml(i,a,f,p,S,T){var O=i.memoizedState;O===null?i.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:p,tail:f,tailMode:S,treeForkCount:T}:(O.isBackwards=a,O.rendering=null,O.renderingStartTime=0,O.last=p,O.tail=f,O.tailMode=S,O.treeForkCount=T)}function Qr(i,a,f){var p=a.pendingProps,S=p.revealOrder,T=p.tail;p=p.children;var O=Un.current,q=(O&2)!==0;if(q?(O=O&1|2,a.flags|=128):O&=1,Me(Un,O),hr(i,a,p,f),p=Pn?sc:0,!q&&i!==null&&(i.flags&128)!==0)e:for(i=a.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&wg(i,f,a);else if(i.tag===19)wg(i,f,a);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break e;for(;i.sibling===null;){if(i.return===null||i.return===a)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(S){case"forwards":for(f=a.child,S=null;f!==null;)i=f.alternate,i!==null&&ms(i)===null&&(S=f),f=f.sibling;f=S,f===null?(S=a.child,a.child=null):(S=f.sibling,f.sibling=null),Ml(a,!1,S,f,T,p);break;case"backwards":case"unstable_legacy-backwards":for(f=null,S=a.child,a.child=null;S!==null;){if(i=S.alternate,i!==null&&ms(i)===null){a.child=S;break}i=S.sibling,S.sibling=f,f=S,S=i}Ml(a,!0,f,null,T,p);break;case"together":Ml(a,!1,null,null,void 0,p);break;default:a.memoizedState=null}return a.child}function zi(i,a,f){if(i!==null&&(a.dependencies=i.dependencies),La|=a.lanes,(f&a.childLanes)===0)if(i!==null){if(Ta(i,a,f,!1),(f&a.childLanes)===0)return null}else return null;if(i!==null&&a.child!==i.child)throw Error(n(153));if(a.child!==null){for(i=a.child,f=Wr(i,i.pendingProps),a.child=f,f.return=a;i.sibling!==null;)i=i.sibling,f=f.sibling=Wr(i,i.pendingProps),f.return=a;f.sibling=null}return a.child}function vh(i,a){return(i.lanes&a)!==0?!0:(i=i.dependencies,!!(i!==null&&gu(i)))}function ky(i,a,f){switch(a.tag){case 3:it(a,a.stateNode.containerInfo),Za(a,Wi,i.memoizedState.cache),Ao();break;case 27:case 5:dt(a);break;case 4:it(a,a.stateNode.containerInfo);break;case 10:Za(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,ip(a),null;break;case 13:var p=a.memoizedState;if(p!==null)return p.dehydrated!==null?($a(a),a.flags|=128,null):(f&a.child.childLanes)!==0?Tg(i,a,f):($a(a),i=zi(i,a,f),i!==null?i.sibling:null);$a(a);break;case 19:var S=(i.flags&128)!==0;if(p=(f&a.childLanes)!==0,p||(Ta(i,a,f,!1),p=(f&a.childLanes)!==0),S){if(p)return Qr(i,a,f);a.flags|=128}if(S=a.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),Me(Un,Un.current),p)break;return null;case 22:return a.lanes=0,_l(i,a,f,a.pendingProps);case 24:Za(a,Wi,i.memoizedState.cache)}return zi(i,a,f)}function xh(i,a,f){if(i!==null)if(i.memoizedProps!==a.pendingProps)Xi=!0;else{if(!vh(i,f)&&(a.flags&128)===0)return Xi=!1,ky(i,a,f);Xi=(i.flags&131072)!==0}else Xi=!1,Pn&&(a.flags&1048576)!==0&&L0(a,sc,a.index);switch(a.lanes=0,a.tag){case 16:e:{var p=a.pendingProps;if(i=hl(a.elementType),a.type=i,typeof i=="function")Ff(i)?(p=Uo(i,p),a.tag=1,a=ph(null,a,i,p,f)):(a.tag=0,a=vc(null,a,i,p,f));else{if(i!=null){var S=i.$$typeof;if(S===P){a.tag=11,a=Ip(null,a,i,p,f);break e}else if(S===H){a.tag=14,a=bl(null,a,i,p,f);break e}}throw a=se(i)||i,Error(n(306,a,""))}}return a;case 0:return vc(i,a,a.type,a.pendingProps,f);case 1:return p=a.type,S=Uo(p,a.pendingProps),ph(i,a,p,S,f);case 3:e:{if(it(a,a.stateNode.containerInfo),i===null)throw Error(n(387));p=a.pendingProps;var T=a.memoizedState;S=T.element,ep(i,a),fc(a,p,null,f);var O=a.memoizedState;if(p=O.cache,Za(a,Wi,p),p!==T.cache&&Xf(a,[Wi],f,!0),_u(),p=O.element,T.isDehydrated)if(T={element:p,isDehydrated:!1,cache:O.cache},a.updateQueue.baseState=T,a.memoizedState=T,a.flags&256){a=Eg(i,a,p,f);break e}else if(p!==S){S=hs(Error(n(424)),a),Sa(S),a=Eg(i,a,p,f);break e}else for(i=a.stateNode.containerInfo,i.nodeType===9?i=i.body:i=i.nodeName==="HTML"?i.ownerDocument.body:i,ii=Oa(i.firstChild),Ai=a,Pn=!0,Ya=null,ds=!0,f=Jf(a,null,p,f),a.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Ao(),p===S){a=zi(i,a,f);break e}hr(i,a,p,f)}a=a.child}return a;case 26:return Sl(i,a),i===null?(f=mS(a.type,null,a.pendingProps,null))?a.memoizedState=f:Pn||(f=a.type,i=a.pendingProps,p=Ng(pe.current).createElement(f),p[ui]=a,p[k]=i,Hr(p,f,i),G(p),a.stateNode=p):a.memoizedState=mS(a.type,i.memoizedProps,a.pendingProps,i.memoizedState),null;case 27:return dt(a),i===null&&Pn&&(p=a.stateNode=hS(a.type,a.pendingProps,pe.current),Ai=a,ds=!0,S=ii,Ac(a.type)?(eb=S,ii=Oa(p.firstChild)):ii=S),hr(i,a,a.pendingProps.children,f),Sl(i,a),i===null&&(a.flags|=4194304),a.child;case 5:return i===null&&Pn&&((S=p=ii)&&(p=OA(p,a.type,a.pendingProps,ds),p!==null?(a.stateNode=p,Ai=a,ii=Oa(p.firstChild),ds=!1,S=!0):S=!1),S||_a(a)),dt(a),S=a.type,T=a.pendingProps,O=i!==null?i.memoizedProps:null,p=T.children,Zy(S,T)?p=null:O!==null&&Zy(S,O)&&(a.flags|=32),a.memoizedState!==null&&(S=th(i,a,yl,null,null,f),Wp._currentValue=S),Sl(i,a),hr(i,a,p,f),a.child;case 6:return i===null&&Pn&&((i=f=ii)&&(f=zA(f,a.pendingProps,ds),f!==null?(a.stateNode=f,Ai=a,ii=null,i=!0):i=!1),i||_a(a)),null;case 13:return Tg(i,a,f);case 4:return it(a,a.stateNode.containerInfo),p=a.pendingProps,i===null?a.child=Qa(a,null,p,f):hr(i,a,p,f),a.child;case 11:return Ip(i,a,a.type,a.pendingProps,f);case 7:return hr(i,a,a.pendingProps,f),a.child;case 8:return hr(i,a,a.pendingProps.children,f),a.child;case 12:return hr(i,a,a.pendingProps.children,f),a.child;case 10:return p=a.pendingProps,Za(a,a.type,p.value),hr(i,a,p.children,f),a.child;case 9:return S=a.type._context,p=a.pendingProps.children,Ro(a),S=an(S),p=p(S),a.flags|=1,hr(i,a,p,f),a.child;case 14:return bl(i,a,a.type,a.pendingProps,f);case 15:return fh(i,a,a.type,a.pendingProps,f);case 19:return Qr(i,a,f);case 31:return dh(i,a,f);case 22:return _l(i,a,f,a.pendingProps);case 24:return Ro(a),p=an(Wi),i===null?(S=Yf(),S===null&&(S=ln,T=Zd(),S.pooledCache=T,T.refCount++,T!==null&&(S.pooledCacheLanes|=f),S=T),a.memoizedState={parent:p,cache:S},bu(a),Za(a,Wi,S)):((i.lanes&f)!==0&&(ep(i,a),fc(a,null,null,f),_u()),S=i.memoizedState,T=a.memoizedState,S.parent!==p?(S={parent:p,cache:p},a.memoizedState=S,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=S),Za(a,Wi,p)):(p=T.cache,Za(a,Wi,p),p!==S.cache&&Xf(a,[Wi],f,!0))),hr(i,a,a.pendingProps.children,f),a.child;case 29:throw a.pendingProps}throw Error(n(156,a.tag))}function Ca(i){i.flags|=4}function Ru(i,a,f,p,S){if((a=(i.mode&32)!==0)&&(a=!1),a){if(i.flags|=16777216,(S&335544128)===S)if(i.stateNode.complete)i.flags|=8192;else if(Ei())i.flags|=8192;else throw wa=Zf,xu}else i.flags&=-16777217}function Up(i,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!bS(a))if(Ei())i.flags|=8192;else throw wa=Zf,xu}function to(i,a){a!==null&&(i.flags|=4),i.flags&16384&&(a=i.tag!==22?un():536870912,i.lanes|=a,fi|=a)}function Ra(i,a){if(!Pn)switch(i.tailMode){case"hidden":a=i.tail;for(var f=null;a!==null;)a.alternate!==null&&(f=a),a=a.sibling;f===null?i.tail=null:f.sibling=null;break;case"collapsed":f=i.tail;for(var p=null;f!==null;)f.alternate!==null&&(p=f),f=f.sibling;p===null?a||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function ei(i){var a=i.alternate!==null&&i.alternate.child===i.child,f=0,p=0;if(a)for(var S=i.child;S!==null;)f|=S.lanes|S.childLanes,p|=S.subtreeFlags&65011712,p|=S.flags&65011712,S.return=i,S=S.sibling;else for(S=i.child;S!==null;)f|=S.lanes|S.childLanes,p|=S.subtreeFlags,p|=S.flags,S.return=i,S=S.sibling;return i.subtreeFlags|=p,i.childLanes=f,a}function Nu(i,a,f){var p=a.pendingProps;switch(Hf(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ei(a),null;case 1:return ei(a),null;case 3:return f=a.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),a.memoizedState.cache!==p&&(a.flags|=2048),Ea(Wi),xt(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(i===null||i.child===null)&&(oc(a)?Ca(a):i===null||i.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,jf())),ei(a),null;case 26:var S=a.type,T=a.memoizedState;return i===null?(Ca(a),T!==null?(ei(a),Up(a,T)):(ei(a),Ru(a,S,null,p,f))):T?T!==i.memoizedState?(Ca(a),ei(a),Up(a,T)):(ei(a),a.flags&=-16777217):(i=i.memoizedProps,i!==p&&Ca(a),ei(a),Ru(a,S,i,p,f)),null;case 27:if(Ut(a),f=pe.current,S=a.type,i!==null&&a.stateNode!=null)i.memoizedProps!==p&&Ca(a);else{if(!p){if(a.stateNode===null)throw Error(n(166));return ei(a),null}i=Ue.current,oc(a)?P0(a):(i=hS(S,p,f),a.stateNode=i,Ca(a))}return ei(a),null;case 5:if(Ut(a),S=a.type,i!==null&&a.stateNode!=null)i.memoizedProps!==p&&Ca(a);else{if(!p){if(a.stateNode===null)throw Error(n(166));return ei(a),null}if(T=Ue.current,oc(a))P0(a);else{var O=Ng(pe.current);switch(T){case 1:T=O.createElementNS("http://www.w3.org/2000/svg",S);break;case 2:T=O.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;default:switch(S){case"svg":T=O.createElementNS("http://www.w3.org/2000/svg",S);break;case"math":T=O.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;case"script":T=O.createElement("div"),T.innerHTML="<script><\/script>",T=T.removeChild(T.firstChild);break;case"select":T=typeof p.is=="string"?O.createElement("select",{is:p.is}):O.createElement("select"),p.multiple?T.multiple=!0:p.size&&(T.size=p.size);break;default:T=typeof p.is=="string"?O.createElement(S,{is:p.is}):O.createElement(S)}}T[ui]=a,T[k]=p;e:for(O=a.child;O!==null;){if(O.tag===5||O.tag===6)T.appendChild(O.stateNode);else if(O.tag!==4&&O.tag!==27&&O.child!==null){O.child.return=O,O=O.child;continue}if(O===a)break e;for(;O.sibling===null;){if(O.return===null||O.return===a)break e;O=O.return}O.sibling.return=O.return,O=O.sibling}a.stateNode=T;e:switch(Hr(T,S,p),S){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&Ca(a)}}return ei(a),Ru(a,a.type,i===null?null:i.memoizedProps,a.pendingProps,f),null;case 6:if(i&&a.stateNode!=null)i.memoizedProps!==p&&Ca(a);else{if(typeof p!="string"&&a.stateNode===null)throw Error(n(166));if(i=pe.current,oc(a)){if(i=a.stateNode,f=a.memoizedProps,p=null,S=Ai,S!==null)switch(S.tag){case 27:case 5:p=S.memoizedProps}i[ui]=a,i=!!(i.nodeValue===f||p!==null&&p.suppressHydrationWarning===!0||tS(i.nodeValue,f)),i||_a(a,!0)}else i=Ng(i).createTextNode(p),i[ui]=a,a.stateNode=i}return ei(a),null;case 31:if(f=a.memoizedState,i===null||i.memoizedState!==null){if(p=oc(a),f!==null){if(i===null){if(!p)throw Error(n(318));if(i=a.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(557));i[ui]=a}else Ao(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;ei(a),i=!1}else f=jf(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=f),i=!0;if(!i)return a.flags&256?(Ui(a),a):(Ui(a),null);if((a.flags&128)!==0)throw Error(n(558))}return ei(a),null;case 13:if(p=a.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(S=oc(a),p!==null&&p.dehydrated!==null){if(i===null){if(!S)throw Error(n(318));if(S=a.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(n(317));S[ui]=a}else Ao(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;ei(a),S=!1}else S=jf(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=S),S=!0;if(!S)return a.flags&256?(Ui(a),a):(Ui(a),null)}return Ui(a),(a.flags&128)!==0?(a.lanes=f,a):(f=p!==null,i=i!==null&&i.memoizedState!==null,f&&(p=a.child,S=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(S=p.alternate.memoizedState.cachePool.pool),T=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(T=p.memoizedState.cachePool.pool),T!==S&&(p.flags|=2048)),f!==i&&f&&(a.child.flags|=8192),to(a,a.updateQueue),ei(a),null);case 4:return xt(),i===null&&jy(a.stateNode.containerInfo),ei(a),null;case 10:return Ea(a.type),ei(a),null;case 19:if(le(Un),p=a.memoizedState,p===null)return ei(a),null;if(S=(a.flags&128)!==0,T=p.rendering,T===null)if(S)Ra(p,!1);else{if(Si!==0||i!==null&&(i.flags&128)!==0)for(i=a.child;i!==null;){if(T=ms(i),T!==null){for(a.flags|=128,Ra(p,!1),i=T.updateQueue,a.updateQueue=i,to(a,i),a.subtreeFlags=0,i=f,f=a.child;f!==null;)nc(f,i),f=f.sibling;return Me(Un,Un.current&1|2),Pn&&ya(a,p.treeForkCount),a.child}i=i.sibling}p.tail!==null&&F()>Bi&&(a.flags|=128,S=!0,Ra(p,!1),a.lanes=4194304)}else{if(!S)if(i=ms(T),i!==null){if(a.flags|=128,S=!0,i=i.updateQueue,a.updateQueue=i,to(a,i),Ra(p,!0),p.tail===null&&p.tailMode==="hidden"&&!T.alternate&&!Pn)return ei(a),null}else 2*F()-p.renderingStartTime>Bi&&f!==536870912&&(a.flags|=128,S=!0,Ra(p,!1),a.lanes=4194304);p.isBackwards?(T.sibling=a.child,a.child=T):(i=p.last,i!==null?i.sibling=T:a.child=T,p.last=T)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=F(),i.sibling=null,f=Un.current,Me(Un,S?f&1|2:f&1),Pn&&ya(a,p.treeForkCount),i):(ei(a),null);case 22:case 23:return Ui(a),Su(),p=a.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(a.flags|=8192):p&&(a.flags|=8192),p?(f&536870912)!==0&&(a.flags&128)===0&&(ei(a),a.subtreeFlags&6&&(a.flags|=8192)):ei(a),f=a.updateQueue,f!==null&&to(a,f.retryQueue),f=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),p=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(p=a.memoizedState.cachePool.pool),p!==f&&(a.flags|=2048),i!==null&&le(No),null;case 24:return f=null,i!==null&&(f=i.memoizedState.cache),a.memoizedState.cache!==f&&(a.flags|=2048),Ea(Wi),ei(a),null;case 25:return null;case 30:return null}throw Error(n(156,a.tag))}function Fs(i,a){switch(Hf(a),a.tag){case 1:return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 3:return Ea(Wi),xt(),i=a.flags,(i&65536)!==0&&(i&128)===0?(a.flags=i&-65537|128,a):null;case 26:case 27:case 5:return Ut(a),null;case 31:if(a.memoizedState!==null){if(Ui(a),a.alternate===null)throw Error(n(340));Ao()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 13:if(Ui(a),i=a.memoizedState,i!==null&&i.dehydrated!==null){if(a.alternate===null)throw Error(n(340));Ao()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 19:return le(Un),null;case 4:return xt(),null;case 10:return Ea(a.type),null;case 22:case 23:return Ui(a),Su(),i!==null&&le(No),i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 24:return Ea(Wi),null;case 25:return null;default:return null}}function gs(i,a){switch(Hf(a),a.tag){case 3:Ea(Wi),xt();break;case 26:case 27:case 5:Ut(a);break;case 4:xt();break;case 31:a.memoizedState!==null&&Ui(a);break;case 13:Ui(a);break;case 19:le(Un);break;case 10:Ea(a.type);break;case 22:case 23:Ui(a),Su(),i!==null&&le(No);break;case 24:Ea(Wi)}}function ks(i,a){try{var f=a.updateQueue,p=f!==null?f.lastEffect:null;if(p!==null){var S=p.next;f=S;do{if((f.tag&i)===i){p=void 0;var T=f.create,O=f.inst;p=T(),O.destroy=p}f=f.next}while(f!==S)}}catch(q){Hn(a,a.return,q)}}function xr(i,a,f){try{var p=a.updateQueue,S=p!==null?p.lastEffect:null;if(S!==null){var T=S.next;p=T;do{if((p.tag&i)===i){var O=p.inst,q=O.destroy;if(q!==void 0){O.destroy=void 0,S=a;var fe=f,Ie=q;try{Ie()}catch(Ke){Hn(S,fe,Ke)}}}p=p.next}while(p!==T)}}catch(Ke){Hn(a,a.return,Ke)}}function $s(i){var a=i.updateQueue;if(a!==null){var f=i.stateNode;try{F0(a,f)}catch(p){Hn(i,i.return,p)}}}function dr(i,a,f){f.props=Uo(i.type,i.memoizedProps),f.state=i.memoizedState;try{f.componentWillUnmount()}catch(p){Hn(i,a,p)}}function no(i,a){try{var f=i.ref;if(f!==null){switch(i.tag){case 26:case 27:case 5:var p=i.stateNode;break;case 30:p=i.stateNode;break;default:p=i.stateNode}typeof f=="function"?i.refCleanup=f(p):f.current=p}}catch(S){Hn(i,a,S)}}function yr(i,a){var f=i.ref,p=i.refCleanup;if(f!==null)if(typeof p=="function")try{p()}catch(S){Hn(i,a,S)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(S){Hn(i,a,S)}else f.current=null}function Du(i){var a=i.type,f=i.memoizedProps,p=i.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":f.autoFocus&&p.focus();break e;case"img":f.src?p.src=f.src:f.srcSet&&(p.srcset=f.srcSet)}}catch(S){Hn(i,i.return,S)}}function nr(i,a,f){try{var p=i.stateNode;NA(p,i.type,f,a),p[k]=a}catch(S){Hn(i,i.return,S)}}function gi(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Ac(i.type)||i.tag===4}function In(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||gi(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Ac(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Na(i,a,f){var p=i.tag;if(p===5||p===6)i=i.stateNode,a?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(i,a):(a=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,a.appendChild(i),f=f._reactRootContainer,f!=null||a.onclick!==null||(a.onclick=ja));else if(p!==4&&(p===27&&Ac(i.type)&&(f=i.stateNode,a=null),i=i.child,i!==null))for(Na(i,a,f),i=i.sibling;i!==null;)Na(i,a,f),i=i.sibling}function Br(i,a,f){var p=i.tag;if(p===5||p===6)i=i.stateNode,a?f.insertBefore(i,a):f.appendChild(i);else if(p!==4&&(p===27&&Ac(i.type)&&(f=i.stateNode),i=i.child,i!==null))for(Br(i,a,f),i=i.sibling;i!==null;)Br(i,a,f),i=i.sibling}function yh(i){var a=i.stateNode,f=i.memoizedProps;try{for(var p=i.type,S=a.attributes;S.length;)a.removeAttributeNode(S[0]);Hr(a,p,f),a[ui]=i,a[k]=f}catch(T){Hn(i,i.return,T)}}var Vs=!1,ri=!1,ea=!1,Ag=typeof WeakSet=="function"?WeakSet:Set,pr=null;function Vy(i,a){if(i=i.containerInfo,qy=zg,i=R0(i),jd(i)){if("selectionStart"in i)var f={start:i.selectionStart,end:i.selectionEnd};else e:{f=(f=i.ownerDocument)&&f.defaultView||window;var p=f.getSelection&&f.getSelection();if(p&&p.rangeCount!==0){f=p.anchorNode;var S=p.anchorOffset,T=p.focusNode;p=p.focusOffset;try{f.nodeType,T.nodeType}catch{f=null;break e}var O=0,q=-1,fe=-1,Ie=0,Ke=0,st=i,Oe=null;t:for(;;){for(var je;st!==f||S!==0&&st.nodeType!==3||(q=O+S),st!==T||p!==0&&st.nodeType!==3||(fe=O+p),st.nodeType===3&&(O+=st.nodeValue.length),(je=st.firstChild)!==null;)Oe=st,st=je;for(;;){if(st===i)break t;if(Oe===f&&++Ie===S&&(q=O),Oe===T&&++Ke===p&&(fe=O),(je=st.nextSibling)!==null)break;st=Oe,Oe=st.parentNode}st=je}f=q===-1||fe===-1?null:{start:q,end:fe}}else f=null}f=f||{start:0,end:0}}else f=null;for(Yy={focusedElem:i,selectionRange:f},zg=!1,pr=a;pr!==null;)if(a=pr,i=a.child,(a.subtreeFlags&1028)!==0&&i!==null)i.return=a,pr=i;else for(;pr!==null;){switch(a=pr,T=a.alternate,i=a.flags,a.tag){case 0:if((i&4)!==0&&(i=a.updateQueue,i=i!==null?i.events:null,i!==null))for(f=0;f<i.length;f++)S=i[f],S.ref.impl=S.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&T!==null){i=void 0,f=a,S=T.memoizedProps,T=T.memoizedState,p=f.stateNode;try{var Xt=Uo(f.type,S);i=p.getSnapshotBeforeUpdate(Xt,T),p.__reactInternalSnapshotBeforeUpdate=i}catch(sn){Hn(f,f.return,sn)}}break;case 3:if((i&1024)!==0){if(i=a.stateNode.containerInfo,f=i.nodeType,f===9)Qy(i);else if(f===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Qy(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(n(163))}if(i=a.sibling,i!==null){i.return=a.return,pr=i;break}pr=a.return}}function vi(i,a,f){var p=f.flags;switch(f.tag){case 0:case 11:case 15:js(i,f),p&4&&ks(5,f);break;case 1:if(js(i,f),p&4)if(i=f.stateNode,a===null)try{i.componentDidMount()}catch(O){Hn(f,f.return,O)}else{var S=Uo(f.type,a.memoizedProps);a=a.memoizedState;try{i.componentDidUpdate(S,a,i.__reactInternalSnapshotBeforeUpdate)}catch(O){Hn(f,f.return,O)}}p&64&&$s(f),p&512&&no(f,f.return);break;case 3:if(js(i,f),p&64&&(i=f.updateQueue,i!==null)){if(a=null,f.child!==null)switch(f.child.tag){case 27:case 5:a=f.child.stateNode;break;case 1:a=f.child.stateNode}try{F0(i,a)}catch(O){Hn(f,f.return,O)}}break;case 27:a===null&&p&4&&yh(f);case 26:case 5:js(i,f),a===null&&p&4&&Du(f),p&512&&no(f,f.return);break;case 12:js(i,f);break;case 31:js(i,f),p&4&&Oo(i,f);break;case 13:js(i,f),p&4&&xc(i,f),p&64&&(i=f.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(f=g.bind(null,f),BA(i,f))));break;case 22:if(p=f.memoizedState!==null||Vs,!p){a=a!==null&&a.memoizedState!==null||ri,S=Vs;var T=ri;Vs=p,(ri=a)&&!T?Fr(i,f,(f.subtreeFlags&8772)!==0):js(i,f),Vs=S,ri=T}break;case 30:break;default:js(i,f)}}function Iu(i){var a=i.alternate;a!==null&&(i.alternate=null,Iu(a)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(a=i.stateNode,a!==null&&ut(a)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Kn=null,Cr=!1;function Hs(i,a,f){for(f=f.child;f!==null;)bh(i,a,f),f=f.sibling}function bh(i,a,f){if(Fe&&typeof Fe.onCommitFiberUnmount=="function")try{Fe.onCommitFiberUnmount(Ce,f)}catch{}switch(f.tag){case 26:ri||yr(f,a),Hs(i,a,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:ri||yr(f,a);var p=Kn,S=Cr;Ac(f.type)&&(Kn=f.stateNode,Cr=!1),Hs(i,a,f),Hp(f.stateNode),Kn=p,Cr=S;break;case 5:ri||yr(f,a);case 6:if(p=Kn,S=Cr,Kn=null,Hs(i,a,f),Kn=p,Cr=S,Kn!==null)if(Cr)try{(Kn.nodeType===9?Kn.body:Kn.nodeName==="HTML"?Kn.ownerDocument.body:Kn).removeChild(f.stateNode)}catch(T){Hn(f,a,T)}else try{Kn.removeChild(f.stateNode)}catch(T){Hn(f,a,T)}break;case 18:Kn!==null&&(Cr?(i=Kn,oS(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,f.stateNode),Ch(i)):oS(Kn,f.stateNode));break;case 4:p=Kn,S=Cr,Kn=f.stateNode.containerInfo,Cr=!0,Hs(i,a,f),Kn=p,Cr=S;break;case 0:case 11:case 14:case 15:xr(2,f,a),ri||xr(4,f,a),Hs(i,a,f);break;case 1:ri||(yr(f,a),p=f.stateNode,typeof p.componentWillUnmount=="function"&&dr(f,a,p)),Hs(i,a,f);break;case 21:Hs(i,a,f);break;case 22:ri=(p=ri)||f.memoizedState!==null,Hs(i,a,f),ri=p;break;default:Hs(i,a,f)}}function Oo(i,a){if(a.memoizedState===null&&(i=a.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Ch(i)}catch(f){Hn(a,a.return,f)}}}function xc(i,a){if(a.memoizedState===null&&(i=a.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Ch(i)}catch(f){Hn(a,a.return,f)}}function Op(i){switch(i.tag){case 31:case 13:case 19:var a=i.stateNode;return a===null&&(a=i.stateNode=new Ag),a;case 22:return i=i.stateNode,a=i._retryCache,a===null&&(a=i._retryCache=new Ag),a;default:throw Error(n(435,i.tag))}}function io(i,a){var f=Op(i);a.forEach(function(p){if(!f.has(p)){f.add(p);var S=b.bind(null,i,p);p.then(S,S)}})}function ir(i,a){var f=a.deletions;if(f!==null)for(var p=0;p<f.length;p++){var S=f[p],T=i,O=a,q=O;e:for(;q!==null;){switch(q.tag){case 27:if(Ac(q.type)){Kn=q.stateNode,Cr=!1;break e}break;case 5:Kn=q.stateNode,Cr=!1;break e;case 3:case 4:Kn=q.stateNode.containerInfo,Cr=!0;break e}q=q.return}if(Kn===null)throw Error(n(160));bh(T,O,S),Kn=null,Cr=!1,T=S.alternate,T!==null&&(T.return=null),S.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)zo(a,i),a=a.sibling}var Gs=null;function zo(i,a){var f=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:ir(a,i),rr(i),p&4&&(xr(3,i,i.return),ks(3,i),xr(5,i,i.return));break;case 1:ir(a,i),rr(i),p&512&&(ri||f===null||yr(f,f.return)),p&64&&Vs&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(f=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=f===null?p:f.concat(p))));break;case 26:var S=Gs;if(ir(a,i),rr(i),p&512&&(ri||f===null||yr(f,f.return)),p&4){var T=f!==null?f.memoizedState:null;if(p=i.memoizedState,f===null)if(p===null)if(i.stateNode===null){e:{p=i.type,f=i.memoizedProps,S=S.ownerDocument||S;t:switch(p){case"title":T=S.getElementsByTagName("title")[0],(!T||T[pt]||T[ui]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=S.createElement(p),S.head.insertBefore(T,S.querySelector("head > title"))),Hr(T,p,f),T[ui]=i,G(T),p=T;break e;case"link":var O=xS("link","href",S).get(p+(f.href||""));if(O){for(var q=0;q<O.length;q++)if(T=O[q],T.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&T.getAttribute("rel")===(f.rel==null?null:f.rel)&&T.getAttribute("title")===(f.title==null?null:f.title)&&T.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){O.splice(q,1);break t}}T=S.createElement(p),Hr(T,p,f),S.head.appendChild(T);break;case"meta":if(O=xS("meta","content",S).get(p+(f.content||""))){for(q=0;q<O.length;q++)if(T=O[q],T.getAttribute("content")===(f.content==null?null:""+f.content)&&T.getAttribute("name")===(f.name==null?null:f.name)&&T.getAttribute("property")===(f.property==null?null:f.property)&&T.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&T.getAttribute("charset")===(f.charSet==null?null:f.charSet)){O.splice(q,1);break t}}T=S.createElement(p),Hr(T,p,f),S.head.appendChild(T);break;default:throw Error(n(468,p))}T[ui]=i,G(T),p=T}i.stateNode=p}else yS(S,i.type,i.stateNode);else i.stateNode=vS(S,p,i.memoizedProps);else T!==p?(T===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):T.count--,p===null?yS(S,i.type,i.stateNode):vS(S,p,i.memoizedProps)):p===null&&i.stateNode!==null&&nr(i,i.memoizedProps,f.memoizedProps)}break;case 27:ir(a,i),rr(i),p&512&&(ri||f===null||yr(f,f.return)),f!==null&&p&4&&nr(i,i.memoizedProps,f.memoizedProps);break;case 5:if(ir(a,i),rr(i),p&512&&(ri||f===null||yr(f,f.return)),i.flags&32){S=i.stateNode;try{ji(S,"")}catch(Xt){Hn(i,i.return,Xt)}}p&4&&i.stateNode!=null&&(S=i.memoizedProps,nr(i,S,f!==null?f.memoizedProps:S)),p&1024&&(ea=!0);break;case 6:if(ir(a,i),rr(i),p&4){if(i.stateNode===null)throw Error(n(162));p=i.memoizedProps,f=i.stateNode;try{f.nodeValue=p}catch(Xt){Hn(i,i.return,Xt)}}break;case 3:if(Lg=null,S=Gs,Gs=Dg(a.containerInfo),ir(a,i),Gs=S,rr(i),p&4&&f!==null&&f.memoizedState.isDehydrated)try{Ch(a.containerInfo)}catch(Xt){Hn(i,i.return,Xt)}ea&&(ea=!1,_h(i));break;case 4:p=Gs,Gs=Dg(i.stateNode.containerInfo),ir(a,i),rr(i),Gs=p;break;case 12:ir(a,i),rr(i);break;case 31:ir(a,i),rr(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,io(i,p)));break;case 13:ir(a,i),rr(i),i.child.flags&8192&&i.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(yc=F()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,io(i,p)));break;case 22:S=i.memoizedState!==null;var fe=f!==null&&f.memoizedState!==null,Ie=Vs,Ke=ri;if(Vs=Ie||S,ri=Ke||fe,ir(a,i),ri=Ke,Vs=Ie,rr(i),p&8192)e:for(a=i.stateNode,a._visibility=S?a._visibility&-2:a._visibility|1,S&&(f===null||fe||Vs||ri||Da(i)),f=null,a=i;;){if(a.tag===5||a.tag===26){if(f===null){fe=f=a;try{if(T=fe.stateNode,S)O=T.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none";else{q=fe.stateNode;var st=fe.memoizedProps.style,Oe=st!=null&&st.hasOwnProperty("display")?st.display:null;q.style.display=Oe==null||typeof Oe=="boolean"?"":(""+Oe).trim()}}catch(Xt){Hn(fe,fe.return,Xt)}}}else if(a.tag===6){if(f===null){fe=a;try{fe.stateNode.nodeValue=S?"":fe.memoizedProps}catch(Xt){Hn(fe,fe.return,Xt)}}}else if(a.tag===18){if(f===null){fe=a;try{var je=fe.stateNode;S?lS(je,!0):lS(fe.stateNode,!1)}catch(Xt){Hn(fe,fe.return,Xt)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===i)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break e;for(;a.sibling===null;){if(a.return===null||a.return===i)break e;f===a&&(f=null),a=a.return}f===a&&(f=null),a.sibling.return=a.return,a=a.sibling}p&4&&(p=i.updateQueue,p!==null&&(f=p.retryQueue,f!==null&&(p.retryQueue=null,io(i,f))));break;case 19:ir(a,i),rr(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,io(i,p)));break;case 30:break;case 21:break;default:ir(a,i),rr(i)}}function rr(i){var a=i.flags;if(a&2){try{for(var f,p=i.return;p!==null;){if(gi(p)){f=p;break}p=p.return}if(f==null)throw Error(n(160));switch(f.tag){case 27:var S=f.stateNode,T=In(i);Br(i,T,S);break;case 5:var O=f.stateNode;f.flags&32&&(ji(O,""),f.flags&=-33);var q=In(i);Br(i,q,O);break;case 3:case 4:var fe=f.stateNode.containerInfo,Ie=In(i);Na(i,Ie,fe);break;default:throw Error(n(161))}}catch(Ke){Hn(i,i.return,Ke)}i.flags&=-3}a&4096&&(i.flags&=-4097)}function _h(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var a=i;_h(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),i=i.sibling}}function js(i,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)vi(i,a.alternate,a),a=a.sibling}function Da(i){for(i=i.child;i!==null;){var a=i;switch(a.tag){case 0:case 11:case 14:case 15:xr(4,a,a.return),Da(a);break;case 1:yr(a,a.return);var f=a.stateNode;typeof f.componentWillUnmount=="function"&&dr(a,a.return,f),Da(a);break;case 27:Hp(a.stateNode);case 26:case 5:yr(a,a.return),Da(a);break;case 22:a.memoizedState===null&&Da(a);break;case 30:Da(a);break;default:Da(a)}i=i.sibling}}function Fr(i,a,f){for(f=f&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var p=a.alternate,S=i,T=a,O=T.flags;switch(T.tag){case 0:case 11:case 15:Fr(S,T,f),ks(4,T);break;case 1:if(Fr(S,T,f),p=T,S=p.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(Ie){Hn(p,p.return,Ie)}if(p=T,S=p.updateQueue,S!==null){var q=p.stateNode;try{var fe=S.shared.hiddenCallbacks;if(fe!==null)for(S.shared.hiddenCallbacks=null,S=0;S<fe.length;S++)hc(fe[S],q)}catch(Ie){Hn(p,p.return,Ie)}}f&&O&64&&$s(T),no(T,T.return);break;case 27:yh(T);case 26:case 5:Fr(S,T,f),f&&p===null&&O&4&&Du(T),no(T,T.return);break;case 12:Fr(S,T,f);break;case 31:Fr(S,T,f),f&&O&4&&Oo(S,T);break;case 13:Fr(S,T,f),f&&O&4&&xc(S,T);break;case 22:T.memoizedState===null&&Fr(S,T,f),no(T,T.return);break;case 30:break;default:Fr(S,T,f)}a=a.sibling}}function Bo(i,a){var f=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),i=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(i=a.memoizedState.cachePool.pool),i!==f&&(i!=null&&i.refCount++,f!=null&&ul(f))}function El(i,a){i=null,a.alternate!==null&&(i=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==i&&(a.refCount++,i!=null&&ul(i))}function br(i,a,f,p){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)zp(i,a,f,p),a=a.sibling}function zp(i,a,f,p){var S=a.flags;switch(a.tag){case 0:case 11:case 15:br(i,a,f,p),S&2048&&ks(9,a);break;case 1:br(i,a,f,p);break;case 3:br(i,a,f,p),S&2048&&(i=null,a.alternate!==null&&(i=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==i&&(a.refCount++,i!=null&&ul(i)));break;case 12:if(S&2048){br(i,a,f,p),i=a.stateNode;try{var T=a.memoizedProps,O=T.id,q=T.onPostCommit;typeof q=="function"&&q(O,a.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(fe){Hn(a,a.return,fe)}}else br(i,a,f,p);break;case 31:br(i,a,f,p);break;case 13:br(i,a,f,p);break;case 23:break;case 22:T=a.stateNode,O=a.alternate,a.memoizedState!==null?T._visibility&2?br(i,a,f,p):Ia(i,a):T._visibility&2?br(i,a,f,p):(T._visibility|=2,_r(i,a,f,p,(a.subtreeFlags&10256)!==0||!1)),S&2048&&Bo(O,a);break;case 24:br(i,a,f,p),S&2048&&El(a.alternate,a);break;default:br(i,a,f,p)}}function _r(i,a,f,p,S){for(S=S&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var T=i,O=a,q=f,fe=p,Ie=O.flags;switch(O.tag){case 0:case 11:case 15:_r(T,O,q,fe,S),ks(8,O);break;case 23:break;case 22:var Ke=O.stateNode;O.memoizedState!==null?Ke._visibility&2?_r(T,O,q,fe,S):Ia(T,O):(Ke._visibility|=2,_r(T,O,q,fe,S)),S&&Ie&2048&&Bo(O.alternate,O);break;case 24:_r(T,O,q,fe,S),S&&Ie&2048&&El(O.alternate,O);break;default:_r(T,O,q,fe,S)}a=a.sibling}}function Ia(i,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var f=i,p=a,S=p.flags;switch(p.tag){case 22:Ia(f,p),S&2048&&Bo(p.alternate,p);break;case 24:Ia(f,p),S&2048&&El(p.alternate,p);break;default:Ia(f,p)}a=a.sibling}}var Tl=8192;function vs(i,a,f){if(i.subtreeFlags&Tl)for(i=i.child;i!==null;)Sh(i,a,f),i=i.sibling}function Sh(i,a,f){switch(i.tag){case 26:vs(i,a,f),i.flags&Tl&&i.memoizedState!==null&&KA(f,Gs,i.memoizedState,i.memoizedProps);break;case 5:vs(i,a,f);break;case 3:case 4:var p=Gs;Gs=Dg(i.stateNode.containerInfo),vs(i,a,f),Gs=p;break;case 22:i.memoizedState===null&&(p=i.alternate,p!==null&&p.memoizedState!==null?(p=Tl,Tl=16777216,vs(i,a,f),Tl=p):vs(i,a,f));break;default:vs(i,a,f)}}function wl(i){var a=i.alternate;if(a!==null&&(i=a.child,i!==null)){a.child=null;do a=i.sibling,i.sibling=null,i=a;while(i!==null)}}function Fo(i){var a=i.deletions;if((i.flags&16)!==0){if(a!==null)for(var f=0;f<a.length;f++){var p=a[f];pr=p,Ci(p,i)}wl(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Jr(i),i=i.sibling}function Jr(i){switch(i.tag){case 0:case 11:case 15:Fo(i),i.flags&2048&&xr(9,i,i.return);break;case 3:Fo(i);break;case 12:Fo(i);break;case 22:var a=i.stateNode;i.memoizedState!==null&&a._visibility&2&&(i.return===null||i.return.tag!==13)?(a._visibility&=-3,$r(i)):Fo(i);break;default:Fo(i)}}function $r(i){var a=i.deletions;if((i.flags&16)!==0){if(a!==null)for(var f=0;f<a.length;f++){var p=a[f];pr=p,Ci(p,i)}wl(i)}for(i=i.child;i!==null;){switch(a=i,a.tag){case 0:case 11:case 15:xr(8,a,a.return),$r(a);break;case 22:f=a.stateNode,f._visibility&2&&(f._visibility&=-3,$r(a));break;default:$r(a)}i=i.sibling}}function Ci(i,a){for(;pr!==null;){var f=pr;switch(f.tag){case 0:case 11:case 15:xr(8,f,a);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var p=f.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:ul(f.memoizedState.cache)}if(p=f.child,p!==null)p.return=f,pr=p;else e:for(f=i;pr!==null;){p=pr;var S=p.sibling,T=p.return;if(Iu(p),p===f){pr=null;break e}if(S!==null){S.return=T,pr=S;break e}pr=T}}}var ro={getCacheForType:function(i){var a=an(Wi),f=a.data.get(i);return f===void 0&&(f=i(),a.data.set(i,f)),f},cacheSignal:function(){return an(Wi).controller.signal}},mn=typeof WeakMap=="function"?WeakMap:Map,Kt=0,ln=null,Sn=null,yn=0,On=0,Rr=null,Ws=!1,ta=!1,Bp=!1,xs=0,Si=0,La=0,ko=0,Lu=0,kr=0,fi=0,Al=null,Ri=null,Ni=!1,yc=0,Fp=0,Bi=1/0,Mi=null,Fi=null,Qn=0,ys=null,bc=null,Xs=0,_c=0,Sc=null,Pu=null,Vo=0,Cl=null;function bs(){return(Kt&2)!==0&&yn!==0?yn&-yn:Y.T!==null?Ve():us()}function Cn(){if(kr===0)if((yn&536870912)===0||Pn){var i=at;at<<=1,(at&3932160)===0&&(at=262144),kr=i}else kr=536870912;return i=Yr.current,i!==null&&(i.flags|=32),kr}function Mn(i,a,f){(i===ln&&(On===2||On===9)||i.cancelPendingCommit!==null)&&(Go(i,0),qi(i,yn,kr,!1)),ci(i,f),((Kt&2)===0||i!==ln)&&(i===ln&&((Kt&2)===0&&(ko|=f),Si===4&&qi(i,yn,kr,!1)),vt(i))}function Rn(i,a,f){if((Kt&6)!==0)throw Error(n(327));var p=!f&&(a&127)===0&&(a&i.expiredLanes)===0||gt(i,a),S=p?Uu(i,a):Vr(i,a,!0),T=p;do{if(S===0){ta&&!p&&qi(i,a,0,!1);break}else{if(f=i.current.alternate,T&&!Jn(f)){S=Vr(i,a,!1),T=!1;continue}if(S===2){if(T=a,i.errorRecoveryDisabledLanes&T)var O=0;else O=i.pendingLanes&-536870913,O=O!==0?O:O&536870912?536870912:0;if(O!==0){a=O;e:{var q=i;S=Al;var fe=q.current.memoizedState.isDehydrated;if(fe&&(Go(q,O).flags|=256),O=Vr(q,O,!1),O!==2){if(Bp&&!fe){q.errorRecoveryDisabledLanes|=T,ko|=T,S=4;break e}T=Ri,Ri=S,T!==null&&(Ri===null?Ri=T:Ri.push.apply(Ri,T))}S=O}if(T=!1,S!==2)continue}}if(S===1){Go(i,0),qi(i,a,0,!0);break}e:{switch(p=i,T=S,T){case 0:case 1:throw Error(n(345));case 4:if((a&4194048)!==a)break;case 6:qi(p,a,kr,!Ws);break e;case 2:Ri=null;break;case 3:case 5:break;default:throw Error(n(329))}if((a&62914560)===a&&(S=yc+300-F(),10<S)){if(qi(p,a,kr,!Ws),Qe(p,0,!0)!==0)break e;Xs=a,p.timeoutHandle=sS(Ln.bind(null,p,f,Ri,Mi,Ni,a,kr,ko,fi,Ws,T,"Throttled",-0,0),S);break e}Ln(p,f,Ri,Mi,Ni,a,kr,ko,fi,Ws,T,null,-0,0)}}break}while(!0);vt(i)}function Ln(i,a,f,p,S,T,O,q,fe,Ie,Ke,st,Oe,je){if(i.timeoutHandle=-1,st=a.subtreeFlags,st&8192||(st&16785408)===16785408){st={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ja},Sh(a,T,st);var Xt=(T&62914560)===T?yc-F():(T&4194048)===T?Fp-F():0;if(Xt=QA(st,Xt),Xt!==null){Xs=T,i.cancelPendingCommit=Xt(ao.bind(null,i,a,T,f,p,S,O,q,fe,Ke,st,null,Oe,je)),qi(i,T,O,!Ie);return}}ao(i,a,T,f,p,S,O,q,fe)}function Jn(i){for(var a=i;;){var f=a.tag;if((f===0||f===11||f===15)&&a.flags&16384&&(f=a.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var p=0;p<f.length;p++){var S=f[p],T=S.getSnapshot;S=S.value;try{if(!Pr(T(),S))return!1}catch{return!1}}if(f=a.child,a.subtreeFlags&16384&&f!==null)f.return=a,a=f;else{if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function qi(i,a,f,p){a&=~Lu,a&=~ko,i.suspendedLanes|=a,i.pingedLanes&=~a,p&&(i.warmLanes|=a),p=i.expirationTimes;for(var S=a;0<S;){var T=31-ee(S),O=1<<T;p[T]=-1,S&=~O}f!==0&&fa(i,f,a)}function na(){return(Kt&6)===0?(Ht(0),!1):!0}function Ho(){if(Sn!==null){if(On===0)var i=Sn.return;else i=Sn,Ma=Co=null,lp(i),ml=null,gl=0,i=Sn;for(;i!==null;)gs(i.alternate,i),i=i.return;Sn=null}}function Go(i,a){var f=i.timeoutHandle;f!==-1&&(i.timeoutHandle=-1,LA(f)),f=i.cancelPendingCommit,f!==null&&(i.cancelPendingCommit=null,f()),Xs=0,Ho(),ln=i,Sn=f=Wr(i.current,null),yn=a,On=0,Rr=null,Ws=!1,ta=gt(i,a),Bp=!1,fi=kr=Lu=ko=La=Si=0,Ri=Al=null,Ni=!1,(a&8)!==0&&(a|=a&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=a;0<p;){var S=31-ee(p),T=1<<S;a|=i[S],p&=~T}return xs=a,pu(),f}function Pa(i,a){pn=null,Y.H=gc,a===fl||a===_n?(a=dl(),On=3):a===xu?(a=dl(),On=4):On=a===uh?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Rr=a,Sn===null&&(Si=1,ch(i,hs(a,i.current)))}function Ei(){var i=Yr.current;return i===null?!0:(yn&4194048)===yn?zr===null:(yn&62914560)===yn||(yn&536870912)!==0?i===zr:!1}function so(){var i=Y.H;return Y.H=gc,i===null?gc:i}function jo(){var i=Y.A;return Y.A=ro,i}function Mc(){Si=4,Ws||(yn&4194048)!==yn&&Yr.current!==null||(ta=!0),(La&134217727)===0&&(ko&134217727)===0||ln===null||qi(ln,yn,kr,!1)}function Vr(i,a,f){var p=Kt;Kt|=2;var S=so(),T=jo();(ln!==i||yn!==a)&&(Mi=null,Go(i,a)),a=!1;var O=Si;e:do try{if(On!==0&&Sn!==null){var q=Sn,fe=Rr;switch(On){case 8:Ho(),O=6;break e;case 3:case 2:case 9:case 6:Yr.current===null&&(a=!0);var Ie=On;if(On=0,Rr=null,Rl(i,q,fe,Ie),f&&ta){O=0;break e}break;default:Ie=On,On=0,Rr=null,Rl(i,q,fe,Ie)}}Ec(),O=Si;break}catch(Ke){Pa(i,Ke)}while(!0);return a&&i.shellSuspendCounter++,Ma=Co=null,Kt=p,Y.H=S,Y.A=T,Sn===null&&(ln=null,yn=0,pu()),O}function Ec(){for(;Sn!==null;)Mh(Sn)}function Uu(i,a){var f=Kt;Kt|=2;var p=so(),S=jo();ln!==i||yn!==a?(Mi=null,Bi=F()+500,Go(i,a)):ta=gt(i,a);e:do try{if(On!==0&&Sn!==null){a=Sn;var T=Rr;t:switch(On){case 1:On=0,Rr=null,Rl(i,a,T,1);break;case 2:case 9:if(qr(T)){On=0,Rr=null,Ou(a);break}a=function(){On!==2&&On!==9||ln!==i||(On=7),vt(i)},T.then(a,a);break e;case 3:On=7;break e;case 4:On=5;break e;case 7:qr(T)?(On=0,Rr=null,Ou(a)):(On=0,Rr=null,Rl(i,a,T,7));break;case 5:var O=null;switch(Sn.tag){case 26:O=Sn.memoizedState;case 5:case 27:var q=Sn;if(O?bS(O):q.stateNode.complete){On=0,Rr=null;var fe=q.sibling;if(fe!==null)Sn=fe;else{var Ie=q.return;Ie!==null?(Sn=Ie,Wo(Ie)):Sn=null}break t}}On=0,Rr=null,Rl(i,a,T,5);break;case 6:On=0,Rr=null,Rl(i,a,T,6);break;case 8:Ho(),Si=6;break e;default:throw Error(n(462))}}es();break}catch(Ke){Pa(i,Ke)}while(!0);return Ma=Co=null,Y.H=p,Y.A=S,Kt=f,Sn!==null?0:(ln=null,yn=0,pu(),Si)}function es(){for(;Sn!==null&&!ht();)Mh(Sn)}function Mh(i){var a=xh(i.alternate,i,xs);i.memoizedProps=i.pendingProps,a===null?Wo(i):Sn=a}function Ou(i){var a=i,f=a.alternate;switch(a.tag){case 15:case 0:a=Au(f,a,a.pendingProps,a.type,void 0,yn);break;case 11:a=Au(f,a,a.pendingProps,a.type.render,a.ref,yn);break;case 5:lp(a);default:gs(f,a),a=Sn=nc(a,xs),a=xh(f,a,xs)}i.memoizedProps=i.pendingProps,a===null?Wo(i):Sn=a}function Rl(i,a,f,p){Ma=Co=null,lp(a),ml=null,gl=0;var S=a.return;try{if(tr(i,S,a,f,yn)){Si=1,ch(i,hs(f,i.current)),Sn=null;return}}catch(T){if(S!==null)throw Sn=S,T;Si=1,ch(i,hs(f,i.current)),Sn=null;return}a.flags&32768?(Pn||p===1?i=!0:ta||(yn&536870912)!==0?i=!1:(Ws=i=!0,(p===2||p===9||p===3||p===6)&&(p=Yr.current,p!==null&&p.tag===13&&(p.flags|=16384))),zu(a,i)):Wo(a)}function Wo(i){var a=i;do{if((a.flags&32768)!==0){zu(a,Ws);return}i=a.return;var f=Nu(a.alternate,a,xs);if(f!==null){Sn=f;return}if(a=a.sibling,a!==null){Sn=a;return}Sn=a=i}while(a!==null);Si===0&&(Si=5)}function zu(i,a){do{var f=Fs(i.alternate,i);if(f!==null){f.flags&=32767,Sn=f;return}if(f=i.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!a&&(i=i.sibling,i!==null)){Sn=i;return}Sn=i=f}while(i!==null);Si=6,Sn=null}function ao(i,a,f,p,S,T,O,q,fe){i.cancelPendingCommit=null;do Tc();while(Qn!==0);if((Kt&6)!==0)throw Error(n(327));if(a!==null){if(a===i.current)throw Error(n(177));if(T=a.lanes|a.childLanes,T|=ur,Pi(i,f,T,O,q,fe),i===ln&&(Sn=ln=null,yn=0),bc=a,ys=i,Xs=f,_c=T,Sc=S,Pu=p,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,C(Be,function(){return Eh(),null})):(i.callbackNode=null,i.callbackPriority=0),p=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||p){p=Y.T,Y.T=null,S=ne.p,ne.p=2,O=Kt,Kt|=4;try{Vy(i,a,f)}finally{Kt=O,ne.p=S,Y.T=p}}Qn=1,Yi(),oo(),Nl()}}function Yi(){if(Qn===1){Qn=0;var i=ys,a=bc,f=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||f){f=Y.T,Y.T=null;var p=ne.p;ne.p=2;var S=Kt;Kt|=4;try{zo(a,i);var T=Yy,O=R0(i.containerInfo),q=T.focusedElem,fe=T.selectionRange;if(O!==q&&q&&q.ownerDocument&&ni(q.ownerDocument.documentElement,q)){if(fe!==null&&jd(q)){var Ie=fe.start,Ke=fe.end;if(Ke===void 0&&(Ke=Ie),"selectionStart"in q)q.selectionStart=Ie,q.selectionEnd=Math.min(Ke,q.value.length);else{var st=q.ownerDocument||document,Oe=st&&st.defaultView||window;if(Oe.getSelection){var je=Oe.getSelection(),Xt=q.textContent.length,sn=Math.min(fe.start,Xt),ai=fe.end===void 0?sn:Math.min(fe.end,Xt);!je.extend&&sn>ai&&(O=ai,ai=sn,sn=O);var Te=$l(q,sn),ye=$l(q,ai);if(Te&&ye&&(je.rangeCount!==1||je.anchorNode!==Te.node||je.anchorOffset!==Te.offset||je.focusNode!==ye.node||je.focusOffset!==ye.offset)){var De=st.createRange();De.setStart(Te.node,Te.offset),je.removeAllRanges(),sn>ai?(je.addRange(De),je.extend(ye.node,ye.offset)):(De.setEnd(ye.node,ye.offset),je.addRange(De))}}}}for(st=[],je=q;je=je.parentNode;)je.nodeType===1&&st.push({element:je,left:je.scrollLeft,top:je.scrollTop});for(typeof q.focus=="function"&&q.focus(),q=0;q<st.length;q++){var nt=st[q];nt.element.scrollLeft=nt.left,nt.element.scrollTop=nt.top}}zg=!!qy,Yy=qy=null}finally{Kt=S,ne.p=p,Y.T=f}}i.current=a,Qn=2}}function oo(){if(Qn===2){Qn=0;var i=ys,a=bc,f=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||f){f=Y.T,Y.T=null;var p=ne.p;ne.p=2;var S=Kt;Kt|=4;try{vi(i,a.alternate,a)}finally{Kt=S,ne.p=p,Y.T=f}}Qn=3}}function Nl(){if(Qn===4||Qn===3){Qn=0,K();var i=ys,a=bc,f=Xs,p=Pu;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Qn=5:(Qn=0,bc=ys=null,Ua(i,i.pendingLanes));var S=i.pendingLanes;if(S===0&&(Fi=null),Ir(f),a=a.stateNode,Fe&&typeof Fe.onCommitFiberRoot=="function")try{Fe.onCommitFiberRoot(Ce,a,void 0,(a.current.flags&128)===128)}catch{}if(p!==null){a=Y.T,S=ne.p,ne.p=2,Y.T=null;try{for(var T=i.onRecoverableError,O=0;O<p.length;O++){var q=p[O];T(q.value,{componentStack:q.stack})}}finally{Y.T=a,ne.p=S}}(Xs&3)!==0&&Tc(),vt(i),S=i.pendingLanes,(f&261930)!==0&&(S&42)!==0?i===Cl?Vo++:(Vo=0,Cl=i):Vo=0,Ht(0)}}function Ua(i,a){(i.pooledCacheLanes&=a)===0&&(a=i.pooledCache,a!=null&&(i.pooledCache=null,ul(a)))}function Tc(){return Yi(),oo(),Nl(),Eh()}function Eh(){if(Qn!==5)return!1;var i=ys,a=_c;_c=0;var f=Ir(Xs),p=Y.T,S=ne.p;try{ne.p=32>f?32:f,Y.T=null,f=Sc,Sc=null;var T=ys,O=Xs;if(Qn=0,bc=ys=null,Xs=0,(Kt&6)!==0)throw Error(n(331));var q=Kt;if(Kt|=4,Jr(T.current),zp(T,T.current,O,f),Kt=q,Ht(0,!1),Fe&&typeof Fe.onPostCommitFiberRoot=="function")try{Fe.onPostCommitFiberRoot(Ce,T)}catch{}return!0}finally{ne.p=S,Y.T=p,Ua(i,a)}}function kp(i,a,f){a=hs(f,a),a=Np(i.stateNode,a,2),i=Do(i,a,2),i!==null&&(ci(i,2),vt(i))}function Hn(i,a,f){if(i.tag===3)kp(i,i,f);else for(;a!==null;){if(a.tag===3){kp(a,i,f);break}else if(a.tag===1){var p=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Fi===null||!Fi.has(p))){i=hs(f,i),f=Dp(2),p=Do(a,f,2),p!==null&&(Sg(f,p,a,i),ci(p,2),vt(p));break}}a=a.return}}function Bu(i,a,f){var p=i.pingCache;if(p===null){p=i.pingCache=new mn;var S=new Set;p.set(a,S)}else S=p.get(a),S===void 0&&(S=new Set,p.set(a,S));S.has(f)||(Bp=!0,S.add(f),i=l.bind(null,i,a,f),a.then(i,i))}function l(i,a,f){var p=i.pingCache;p!==null&&p.delete(a),i.pingedLanes|=i.suspendedLanes&f,i.warmLanes&=~f,ln===i&&(yn&f)===f&&(Si===4||Si===3&&(yn&62914560)===yn&&300>F()-yc?(Kt&2)===0&&Go(i,0):Lu|=f,fi===yn&&(fi=0)),vt(i)}function c(i,a){a===0&&(a=un()),i=Ur(i,a),i!==null&&(ci(i,a),vt(i))}function g(i){var a=i.memoizedState,f=0;a!==null&&(f=a.retryLane),c(i,f)}function b(i,a){var f=0;switch(i.tag){case 31:case 13:var p=i.stateNode,S=i.memoizedState;S!==null&&(f=S.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(n(314))}p!==null&&p.delete(a),c(i,f)}function C(i,a){return St(i,a)}var D=null,X=null,de=!1,He=!1,ft=!1,Nt=0;function vt(i){i!==X&&i.next===null&&(X===null?D=X=i:X=X.next=i),He=!0,de||(de=!0,Ae())}function Ht(i,a){if(!ft&&He){ft=!0;do for(var f=!1,p=D;p!==null;){if(i!==0){var S=p.pendingLanes;if(S===0)var T=0;else{var O=p.suspendedLanes,q=p.pingedLanes;T=(1<<31-ee(42|i)+1)-1,T&=S&~(O&~q),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(f=!0,Pe(p,T))}else T=yn,T=Qe(p,p===ln?T:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(T&3)===0||gt(p,T)||(f=!0,Pe(p,T));p=p.next}while(f);ft=!1}}function hn(){ki()}function ki(){He=de=!1;var i=0;Nt!==0&&IA()&&(i=Nt);for(var a=F(),f=null,p=D;p!==null;){var S=p.next,T=wc(p,a);T===0?(p.next=null,f===null?D=S:f.next=S,S===null&&(X=f)):(f=p,(i!==0||(T&3)!==0)&&(He=!0)),p=S}Qn!==0&&Qn!==5||Ht(i),Nt!==0&&(Nt=0)}function wc(i,a){for(var f=i.suspendedLanes,p=i.pingedLanes,S=i.expirationTimes,T=i.pendingLanes&-62914561;0<T;){var O=31-ee(T),q=1<<O,fe=S[O];fe===-1?((q&f)===0||(q&p)!==0)&&(S[O]=qt(q,a)):fe<=a&&(i.expiredLanes|=q),T&=~q}if(a=ln,f=yn,f=Qe(i,i===a?f:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p=i.callbackNode,f===0||i===a&&(On===2||On===9)||i.cancelPendingCommit!==null)return p!==null&&p!==null&&Ft(p),i.callbackNode=null,i.callbackPriority=0;if((f&3)===0||gt(i,f)){if(a=f&-f,a===i.callbackPriority)return a;switch(p!==null&&Ft(p),Ir(f)){case 2:case 8:f=Ye;break;case 32:f=Be;break;case 268435456:f=yt;break;default:f=Be}return p=Xo.bind(null,i),f=St(f,p),i.callbackPriority=a,i.callbackNode=f,a}return p!==null&&p!==null&&Ft(p),i.callbackPriority=2,i.callbackNode=null,2}function Xo(i,a){if(Qn!==0&&Qn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var f=i.callbackNode;if(Tc()&&i.callbackNode!==f)return null;var p=yn;return p=Qe(i,i===ln?p:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p===0?null:(Rn(i,p,a),wc(i,F()),i.callbackNode!=null&&i.callbackNode===f?Xo.bind(null,i):null)}function Pe(i,a){if(Tc())return null;Rn(i,a,!0)}function Ae(){PA(function(){(Kt&6)!==0?St(ze,hn):ki()})}function Ve(){if(Nt===0){var i=Ka;i===0&&(i=we,we<<=1,(we&261888)===0&&(we=256)),Nt=i}return Nt}function wt(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:eu(""+i)}function tn(i,a){var f=a.ownerDocument.createElement("input");return f.name=a.name,f.value=a.value,i.id&&f.setAttribute("form",i.id),a.parentNode.insertBefore(f,a),i=new FormData(i),f.parentNode.removeChild(f),i}function Ti(i,a,f,p,S){if(a==="submit"&&f&&f.stateNode===S){var T=wt((S[k]||null).action),O=p.submitter;O&&(a=(a=O[k]||null)?wt(a.formAction):O.getAttribute("formAction"),a!==null&&(T=a,O=null));var q=new iu("action","action",null,p,S);i.push({event:q,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Nt!==0){var fe=O?tn(S,O):new FormData(S);Sp(f,{pending:!0,data:fe,method:S.method,action:T},null,fe)}}else typeof T=="function"&&(q.preventDefault(),fe=O?tn(S,O):new FormData(S),Sp(f,{pending:!0,data:fe,method:S.method,action:T},T,fe))},currentTarget:S}]})}}for(var nn=0;nn<hu.length;nn++){var Bn=hu[nn],mr=Bn.toLowerCase(),Wn=Bn[0].toUpperCase()+Bn.slice(1);Is(mr,"on"+Wn)}Is(zf,"onAnimationEnd"),Is(fu,"onAnimationIteration"),Is(Xd,"onAnimationStart"),Is("dblclick","onDoubleClick"),Is("focusin","onFocus"),Is("focusout","onBlur"),Is(D0,"onTransitionRun"),Is(Ly,"onTransitionStart"),Is(I0,"onTransitionCancel"),Is(qd,"onTransitionEnd"),me("onMouseEnter",["mouseout","mouseover"]),me("onMouseLeave",["mouseout","mouseover"]),me("onPointerEnter",["pointerout","pointerover"]),me("onPointerLeave",["pointerout","pointerover"]),_e("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),_e("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),_e("onBeforeInput",["compositionend","keypress","textInput","paste"]),_e("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),_e("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),_e("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Hy=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(qs));function Q1(i,a){a=(a&4)!==0;for(var f=0;f<i.length;f++){var p=i[f],S=p.event;p=p.listeners;e:{var T=void 0;if(a)for(var O=p.length-1;0<=O;O--){var q=p[O],fe=q.instance,Ie=q.currentTarget;if(q=q.listener,fe!==T&&S.isPropagationStopped())break e;T=q,S.currentTarget=Ie;try{T(S)}catch(Ke){du(Ke)}S.currentTarget=null,T=fe}else for(O=0;O<p.length;O++){if(q=p[O],fe=q.instance,Ie=q.currentTarget,q=q.listener,fe!==T&&S.isPropagationStopped())break e;T=q,S.currentTarget=Ie;try{T(S)}catch(Ke){du(Ke)}S.currentTarget=null,T=fe}}}}function zn(i,a){var f=a[he];f===void 0&&(f=a[he]=new Set);var p=i+"__bubble";f.has(p)||(J1(a,i,2,!1),f.add(p))}function Gy(i,a,f){var p=0;a&&(p|=4),J1(f,i,p,a)}var Cg="_reactListening"+Math.random().toString(36).slice(2);function jy(i){if(!i[Cg]){i[Cg]=!0,oe.forEach(function(f){f!=="selectionchange"&&(Hy.has(f)||Gy(f,!1,i),Gy(f,!0,i))});var a=i.nodeType===9?i:i.ownerDocument;a===null||a[Cg]||(a[Cg]=!0,Gy("selectionchange",!1,a))}}function J1(i,a,f,p){switch(AS(a)){case 2:var S=e3;break;case 8:S=t3;break;default:S=sb}f=S.bind(null,a,f,i),S=void 0,!Cd||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(S=!0),p?S!==void 0?i.addEventListener(a,f,{capture:!0,passive:S}):i.addEventListener(a,f,!0):S!==void 0?i.addEventListener(a,f,{passive:S}):i.addEventListener(a,f,!1)}function Wy(i,a,f,p,S){var T=p;if((a&1)===0&&(a&2)===0&&p!==null)e:for(;;){if(p===null)return;var O=p.tag;if(O===3||O===4){var q=p.stateNode.containerInfo;if(q===S)break;if(O===4)for(O=p.return;O!==null;){var fe=O.tag;if((fe===3||fe===4)&&O.stateNode.containerInfo===S)return;O=O.return}for(;q!==null;){if(O=Tt(q),O===null)return;if(fe=O.tag,fe===5||fe===6||fe===26||fe===27){p=T=O;continue e}q=q.parentNode}}p=p.return}Ad(function(){var Ie=T,Ke=Ef(f),st=[];e:{var Oe=Ds.get(i);if(Oe!==void 0){var je=iu,Xt=i;switch(i){case"keypress":if(nu(f)===0)break e;case"keydown":case"keyup":je=sl;break;case"focusin":Xt="focus",je=Cf;break;case"focusout":Xt="blur",je=Cf;break;case"beforeblur":case"afterblur":je=Cf;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":je=Rd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":je=f0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":je=v0;break;case zf:case fu:case Xd:je=Ny;break;case qd:je=Iy;break;case"scroll":case"scrollend":je=c0;break;case"wheel":je=y0;break;case"copy":case"cut":case"paste":je=d0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":je=Id;break;case"toggle":case"beforetoggle":je=_0}var sn=(a&4)!==0,ai=!sn&&(i==="scroll"||i==="scrollend"),Te=sn?Oe!==null?Oe+"Capture":null:Oe;sn=[];for(var ye=Ie,De;ye!==null;){var nt=ye;if(De=nt.stateNode,nt=nt.tag,nt!==5&&nt!==26&&nt!==27||De===null||Te===null||(nt=jl(ye,Te),nt!=null&&sn.push(Vp(ye,nt,De))),ai)break;ye=ye.return}0<sn.length&&(Oe=new je(Oe,Xt,null,f,Ke),st.push({event:Oe,listeners:sn}))}}if((a&7)===0){e:{if(Oe=i==="mouseover"||i==="pointerover",je=i==="mouseout"||i==="pointerout",Oe&&f!==Mf&&(Xt=f.relatedTarget||f.fromElement)&&(Tt(Xt)||Xt[Z]))break e;if((je||Oe)&&(Oe=Ke.window===Ke?Ke:(Oe=Ke.ownerDocument)?Oe.defaultView||Oe.parentWindow:window,je?(Xt=f.relatedTarget||f.toElement,je=Ie,Xt=Xt?Tt(Xt):null,Xt!==null&&(ai=o(Xt),sn=Xt.tag,Xt!==ai||sn!==5&&sn!==27&&sn!==6)&&(Xt=null)):(je=null,Xt=Ie),je!==Xt)){if(sn=Rd,nt="onMouseLeave",Te="onMouseEnter",ye="mouse",(i==="pointerout"||i==="pointerover")&&(sn=Id,nt="onPointerLeave",Te="onPointerEnter",ye="pointer"),ai=je==null?Oe:Rt(je),De=Xt==null?Oe:Rt(Xt),Oe=new sn(nt,ye+"leave",je,f,Ke),Oe.target=ai,Oe.relatedTarget=De,nt=null,Tt(Ke)===Ie&&(sn=new sn(Te,ye+"enter",Xt,f,Ke),sn.target=De,sn.relatedTarget=ai,nt=sn),ai=nt,je&&Xt)t:{for(sn=AA,Te=je,ye=Xt,De=0,nt=Te;nt;nt=sn(nt))De++;nt=0;for(var $t=ye;$t;$t=sn($t))nt++;for(;0<De-nt;)Te=sn(Te),De--;for(;0<nt-De;)ye=sn(ye),nt--;for(;De--;){if(Te===ye||ye!==null&&Te===ye.alternate){sn=Te;break t}Te=sn(Te),ye=sn(ye)}sn=null}else sn=null;je!==null&&$1(st,Oe,je,sn,!1),Xt!==null&&ai!==null&&$1(st,ai,Xt,sn,!0)}}e:{if(Oe=Ie?Rt(Ie):window,je=Oe.nodeName&&Oe.nodeName.toLowerCase(),je==="select"||je==="input"&&Oe.type==="file")var Yn=Fd;else if(Bd(Oe))if(ma)Yn=C0;else{Yn=Hd;var Zt=w0}else je=Oe.nodeName,!je||je.toLowerCase()!=="input"||Oe.type!=="checkbox"&&Oe.type!=="radio"?Ie&&Rs(Ie.elementType)&&(Yn=Fd):Yn=A0;if(Yn&&(Yn=Yn(i,Ie))){Uf(st,Yn,f,Ke);break e}Zt&&Zt(i,Oe,Ie),i==="focusout"&&Ie&&Oe.type==="number"&&Ie.memoizedProps.value!=null&&Tn(Oe,"number",Oe.value)}switch(Zt=Ie?Rt(Ie):window,i){case"focusin":(Bd(Zt)||Zt.contentEditable==="true")&&(ga=Zt,va=Ie,ec=null);break;case"focusout":ec=va=ga=null;break;case"mousedown":Of=!0;break;case"contextmenu":case"mouseup":case"dragend":Of=!1,tc(st,f,Ke);break;case"selectionchange":if(N0)break;case"keydown":case"keyup":tc(st,f,Ke)}var wn;if(al)e:{switch(i){case"compositionstart":var Fn="onCompositionStart";break e;case"compositionend":Fn="onCompositionEnd";break e;case"compositionupdate":Fn="onCompositionUpdate";break e}Fn=void 0}else ol?Pf(i,f)&&(Fn="onCompositionEnd"):i==="keydown"&&f.keyCode===229&&(Fn="onCompositionStart");Fn&&(Pd&&f.locale!=="ko"&&(ol||Fn!=="onCompositionStart"?Fn==="onCompositionEnd"&&ol&&(wn=tu()):(fs=Ke,wf="value"in fs?fs.value:fs.textContent,ol=!0)),Zt=Rg(Ie,Fn),0<Zt.length&&(Fn=new Rf(Fn,i,null,f,Ke),st.push({event:Fn,listeners:Zt}),wn?Fn.data=wn:(wn=Ud(f),wn!==null&&(Fn.data=wn)))),(wn=Lf?E0(i,f):Od(i,f))&&(Fn=Rg(Ie,"onBeforeInput"),0<Fn.length&&(Zt=new Rf("onBeforeInput","beforeinput",null,f,Ke),st.push({event:Zt,listeners:Fn}),Zt.data=wn)),Ti(st,i,Ie,f,Ke)}Q1(st,a)})}function Vp(i,a,f){return{instance:i,listener:a,currentTarget:f}}function Rg(i,a){for(var f=a+"Capture",p=[];i!==null;){var S=i,T=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||T===null||(S=jl(i,f),S!=null&&p.unshift(Vp(i,S,T)),S=jl(i,a),S!=null&&p.push(Vp(i,S,T))),i.tag===3)return p;i=i.return}return[]}function AA(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function $1(i,a,f,p,S){for(var T=a._reactName,O=[];f!==null&&f!==p;){var q=f,fe=q.alternate,Ie=q.stateNode;if(q=q.tag,fe!==null&&fe===p)break;q!==5&&q!==26&&q!==27||Ie===null||(fe=Ie,S?(Ie=jl(f,T),Ie!=null&&O.unshift(Vp(f,Ie,fe))):S||(Ie=jl(f,T),Ie!=null&&O.push(Vp(f,Ie,fe)))),f=f.return}O.length!==0&&i.push({event:a,listeners:O})}var CA=/\r\n?/g,RA=/\u0000|\uFFFD/g;function eS(i){return(typeof i=="string"?i:""+i).replace(CA,`
`).replace(RA,"")}function tS(i,a){return a=eS(a),eS(i)===a}function si(i,a,f,p,S,T){switch(f){case"children":typeof p=="string"?a==="body"||a==="textarea"&&p===""||ji(i,p):(typeof p=="number"||typeof p=="bigint")&&a!=="body"&&ji(i,""+p);break;case"className":jt(i,"class",p);break;case"tabIndex":jt(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":jt(i,f,p);break;case"style":nl(i,p,T);break;case"data":if(a!=="object"){jt(i,"data",p);break}case"src":case"href":if(p===""&&(a!=="a"||f!=="href")){i.removeAttribute(f);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(f);break}p=eu(""+p),i.setAttribute(f,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(f==="formAction"?(a!=="input"&&si(i,a,"name",S.name,S,null),si(i,a,"formEncType",S.formEncType,S,null),si(i,a,"formMethod",S.formMethod,S,null),si(i,a,"formTarget",S.formTarget,S,null)):(si(i,a,"encType",S.encType,S,null),si(i,a,"method",S.method,S,null),si(i,a,"target",S.target,S,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(f);break}p=eu(""+p),i.setAttribute(f,p);break;case"onClick":p!=null&&(i.onclick=ja);break;case"onScroll":p!=null&&zn("scroll",i);break;case"onScrollEnd":p!=null&&zn("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(f=p.__html,f!=null){if(S.children!=null)throw Error(n(60));i.innerHTML=f}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}f=eu(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(f,""+p):i.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(f,""):i.removeAttribute(f);break;case"capture":case"download":p===!0?i.setAttribute(f,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(f,p):i.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(f,p):i.removeAttribute(f);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(f):i.setAttribute(f,p);break;case"popover":zn("beforetoggle",i),zn("toggle",i),Et(i,"popover",p);break;case"xlinkActuate":At(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":At(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":At(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":At(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":At(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":At(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":At(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":At(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":At(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Et(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=o0.get(f)||f,Et(i,f,p))}}function Xy(i,a,f,p,S,T){switch(f){case"style":nl(i,p,T);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(f=p.__html,f!=null){if(S.children!=null)throw Error(n(60));i.innerHTML=f}}break;case"children":typeof p=="string"?ji(i,p):(typeof p=="number"||typeof p=="bigint")&&ji(i,""+p);break;case"onScroll":p!=null&&zn("scroll",i);break;case"onScrollEnd":p!=null&&zn("scrollend",i);break;case"onClick":p!=null&&(i.onclick=ja);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!be.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(S=f.endsWith("Capture"),a=f.slice(2,S?f.length-7:void 0),T=i[k]||null,T=T!=null?T[f]:null,typeof T=="function"&&i.removeEventListener(a,T,S),typeof p=="function")){typeof T!="function"&&T!==null&&(f in i?i[f]=null:i.hasAttribute(f)&&i.removeAttribute(f)),i.addEventListener(a,p,S);break e}f in i?i[f]=p:p===!0?i.setAttribute(f,""):Et(i,f,p)}}}function Hr(i,a,f){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":zn("error",i),zn("load",i);var p=!1,S=!1,T;for(T in f)if(f.hasOwnProperty(T)){var O=f[T];if(O!=null)switch(T){case"src":p=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:si(i,a,T,O,f,null)}}S&&si(i,a,"srcSet",f.srcSet,f,null),p&&si(i,a,"src",f.src,f,null);return;case"input":zn("invalid",i);var q=T=O=S=null,fe=null,Ie=null;for(p in f)if(f.hasOwnProperty(p)){var Ke=f[p];if(Ke!=null)switch(p){case"name":S=Ke;break;case"type":O=Ke;break;case"checked":fe=Ke;break;case"defaultChecked":Ie=Ke;break;case"value":T=Ke;break;case"defaultValue":q=Ke;break;case"children":case"dangerouslySetInnerHTML":if(Ke!=null)throw Error(n(137,a));break;default:si(i,a,p,Ke,f,null)}}Ji(i,T,q,fe,Ie,O,S,!1);return;case"select":zn("invalid",i),p=O=T=null;for(S in f)if(f.hasOwnProperty(S)&&(q=f[S],q!=null))switch(S){case"value":T=q;break;case"defaultValue":O=q;break;case"multiple":p=q;default:si(i,a,S,q,f,null)}a=T,f=O,i.multiple=!!p,a!=null?di(i,!!p,a,!1):f!=null&&di(i,!!p,f,!0);return;case"textarea":zn("invalid",i),T=S=p=null;for(O in f)if(f.hasOwnProperty(O)&&(q=f[O],q!=null))switch(O){case"value":p=q;break;case"defaultValue":S=q;break;case"children":T=q;break;case"dangerouslySetInnerHTML":if(q!=null)throw Error(n(91));break;default:si(i,a,O,q,f,null)}$i(i,p,S,T);return;case"option":for(fe in f)f.hasOwnProperty(fe)&&(p=f[fe],p!=null)&&(fe==="selected"?i.selected=p&&typeof p!="function"&&typeof p!="symbol":si(i,a,fe,p,f,null));return;case"dialog":zn("beforetoggle",i),zn("toggle",i),zn("cancel",i),zn("close",i);break;case"iframe":case"object":zn("load",i);break;case"video":case"audio":for(p=0;p<qs.length;p++)zn(qs[p],i);break;case"image":zn("error",i),zn("load",i);break;case"details":zn("toggle",i);break;case"embed":case"source":case"link":zn("error",i),zn("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ie in f)if(f.hasOwnProperty(Ie)&&(p=f[Ie],p!=null))switch(Ie){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:si(i,a,Ie,p,f,null)}return;default:if(Rs(a)){for(Ke in f)f.hasOwnProperty(Ke)&&(p=f[Ke],p!==void 0&&Xy(i,a,Ke,p,f,void 0));return}}for(q in f)f.hasOwnProperty(q)&&(p=f[q],p!=null&&si(i,a,q,p,f,null))}function NA(i,a,f,p){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,T=null,O=null,q=null,fe=null,Ie=null,Ke=null;for(je in f){var st=f[je];if(f.hasOwnProperty(je)&&st!=null)switch(je){case"checked":break;case"value":break;case"defaultValue":fe=st;default:p.hasOwnProperty(je)||si(i,a,je,null,p,st)}}for(var Oe in p){var je=p[Oe];if(st=f[Oe],p.hasOwnProperty(Oe)&&(je!=null||st!=null))switch(Oe){case"type":T=je;break;case"name":S=je;break;case"checked":Ie=je;break;case"defaultChecked":Ke=je;break;case"value":O=je;break;case"defaultValue":q=je;break;case"children":case"dangerouslySetInnerHTML":if(je!=null)throw Error(n(137,a));break;default:je!==st&&si(i,a,Oe,je,p,st)}}Vn(i,O,q,fe,Ie,Ke,T,S);return;case"select":je=O=q=Oe=null;for(T in f)if(fe=f[T],f.hasOwnProperty(T)&&fe!=null)switch(T){case"value":break;case"multiple":je=fe;default:p.hasOwnProperty(T)||si(i,a,T,null,p,fe)}for(S in p)if(T=p[S],fe=f[S],p.hasOwnProperty(S)&&(T!=null||fe!=null))switch(S){case"value":Oe=T;break;case"defaultValue":q=T;break;case"multiple":O=T;default:T!==fe&&si(i,a,S,T,p,fe)}a=q,f=O,p=je,Oe!=null?di(i,!!f,Oe,!1):!!p!=!!f&&(a!=null?di(i,!!f,a,!0):di(i,!!f,f?[]:"",!1));return;case"textarea":je=Oe=null;for(q in f)if(S=f[q],f.hasOwnProperty(q)&&S!=null&&!p.hasOwnProperty(q))switch(q){case"value":break;case"children":break;default:si(i,a,q,null,p,S)}for(O in p)if(S=p[O],T=f[O],p.hasOwnProperty(O)&&(S!=null||T!=null))switch(O){case"value":Oe=S;break;case"defaultValue":je=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(n(91));break;default:S!==T&&si(i,a,O,S,p,T)}Xn(i,Oe,je);return;case"option":for(var Xt in f)Oe=f[Xt],f.hasOwnProperty(Xt)&&Oe!=null&&!p.hasOwnProperty(Xt)&&(Xt==="selected"?i.selected=!1:si(i,a,Xt,null,p,Oe));for(fe in p)Oe=p[fe],je=f[fe],p.hasOwnProperty(fe)&&Oe!==je&&(Oe!=null||je!=null)&&(fe==="selected"?i.selected=Oe&&typeof Oe!="function"&&typeof Oe!="symbol":si(i,a,fe,Oe,p,je));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var sn in f)Oe=f[sn],f.hasOwnProperty(sn)&&Oe!=null&&!p.hasOwnProperty(sn)&&si(i,a,sn,null,p,Oe);for(Ie in p)if(Oe=p[Ie],je=f[Ie],p.hasOwnProperty(Ie)&&Oe!==je&&(Oe!=null||je!=null))switch(Ie){case"children":case"dangerouslySetInnerHTML":if(Oe!=null)throw Error(n(137,a));break;default:si(i,a,Ie,Oe,p,je)}return;default:if(Rs(a)){for(var ai in f)Oe=f[ai],f.hasOwnProperty(ai)&&Oe!==void 0&&!p.hasOwnProperty(ai)&&Xy(i,a,ai,void 0,p,Oe);for(Ke in p)Oe=p[Ke],je=f[Ke],!p.hasOwnProperty(Ke)||Oe===je||Oe===void 0&&je===void 0||Xy(i,a,Ke,Oe,p,je);return}}for(var Te in f)Oe=f[Te],f.hasOwnProperty(Te)&&Oe!=null&&!p.hasOwnProperty(Te)&&si(i,a,Te,null,p,Oe);for(st in p)Oe=p[st],je=f[st],!p.hasOwnProperty(st)||Oe===je||Oe==null&&je==null||si(i,a,st,Oe,p,je)}function nS(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function DA(){if(typeof performance.getEntriesByType=="function"){for(var i=0,a=0,f=performance.getEntriesByType("resource"),p=0;p<f.length;p++){var S=f[p],T=S.transferSize,O=S.initiatorType,q=S.duration;if(T&&q&&nS(O)){for(O=0,q=S.responseEnd,p+=1;p<f.length;p++){var fe=f[p],Ie=fe.startTime;if(Ie>q)break;var Ke=fe.transferSize,st=fe.initiatorType;Ke&&nS(st)&&(fe=fe.responseEnd,O+=Ke*(fe<q?1:(q-Ie)/(fe-Ie)))}if(--p,a+=8*(T+O)/(S.duration/1e3),i++,10<i)break}}if(0<i)return a/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var qy=null,Yy=null;function Ng(i){return i.nodeType===9?i:i.ownerDocument}function iS(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function rS(i,a){if(i===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&a==="foreignObject"?0:i}function Zy(i,a){return i==="textarea"||i==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Ky=null;function IA(){var i=window.event;return i&&i.type==="popstate"?i===Ky?!1:(Ky=i,!0):(Ky=null,!1)}var sS=typeof setTimeout=="function"?setTimeout:void 0,LA=typeof clearTimeout=="function"?clearTimeout:void 0,aS=typeof Promise=="function"?Promise:void 0,PA=typeof queueMicrotask=="function"?queueMicrotask:typeof aS<"u"?function(i){return aS.resolve(null).then(i).catch(UA)}:sS;function UA(i){setTimeout(function(){throw i})}function Ac(i){return i==="head"}function oS(i,a){var f=a,p=0;do{var S=f.nextSibling;if(i.removeChild(f),S&&S.nodeType===8)if(f=S.data,f==="/$"||f==="/&"){if(p===0){i.removeChild(S),Ch(a);return}p--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")p++;else if(f==="html")Hp(i.ownerDocument.documentElement);else if(f==="head"){f=i.ownerDocument.head,Hp(f);for(var T=f.firstChild;T;){var O=T.nextSibling,q=T.nodeName;T[pt]||q==="SCRIPT"||q==="STYLE"||q==="LINK"&&T.rel.toLowerCase()==="stylesheet"||f.removeChild(T),T=O}}else f==="body"&&Hp(i.ownerDocument.body);f=S}while(f);Ch(a)}function lS(i,a){var f=i;i=0;do{var p=f.nextSibling;if(f.nodeType===1?a?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(a?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),p&&p.nodeType===8)if(f=p.data,f==="/$"){if(i===0)break;i--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||i++;f=p}while(f)}function Qy(i){var a=i.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var f=a;switch(a=a.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":Qy(f),ut(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}i.removeChild(f)}}function OA(i,a,f,p){for(;i.nodeType===1;){var S=f;if(i.nodeName.toLowerCase()!==a.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[pt])switch(a){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(T=i.getAttribute("rel"),T==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(T!==S.rel||i.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||i.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||i.getAttribute("title")!==(S.title==null?null:S.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(T=i.getAttribute("src"),(T!==(S.src==null?null:S.src)||i.getAttribute("type")!==(S.type==null?null:S.type)||i.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&T&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(a==="input"&&i.type==="hidden"){var T=S.name==null?null:""+S.name;if(S.type==="hidden"&&i.getAttribute("name")===T)return i}else return i;if(i=Oa(i.nextSibling),i===null)break}return null}function zA(i,a,f){if(a==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!f||(i=Oa(i.nextSibling),i===null))return null;return i}function cS(i,a){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!a||(i=Oa(i.nextSibling),i===null))return null;return i}function Jy(i){return i.data==="$?"||i.data==="$~"}function $y(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function BA(i,a){var f=i.ownerDocument;if(i.data==="$~")i._reactRetry=a;else if(i.data!=="$?"||f.readyState!=="loading")a();else{var p=function(){a(),f.removeEventListener("DOMContentLoaded",p)};f.addEventListener("DOMContentLoaded",p),i._reactRetry=p}}function Oa(i){for(;i!=null;i=i.nextSibling){var a=i.nodeType;if(a===1||a===3)break;if(a===8){if(a=i.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return i}var eb=null;function uS(i){i=i.nextSibling;for(var a=0;i;){if(i.nodeType===8){var f=i.data;if(f==="/$"||f==="/&"){if(a===0)return Oa(i.nextSibling);a--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||a++}i=i.nextSibling}return null}function fS(i){i=i.previousSibling;for(var a=0;i;){if(i.nodeType===8){var f=i.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(a===0)return i;a--}else f!=="/$"&&f!=="/&"||a++}i=i.previousSibling}return null}function hS(i,a,f){switch(a=Ng(f),i){case"html":if(i=a.documentElement,!i)throw Error(n(452));return i;case"head":if(i=a.head,!i)throw Error(n(453));return i;case"body":if(i=a.body,!i)throw Error(n(454));return i;default:throw Error(n(451))}}function Hp(i){for(var a=i.attributes;a.length;)i.removeAttributeNode(a[0]);ut(i)}var za=new Map,dS=new Set;function Dg(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Dl=ne.d;ne.d={f:FA,r:kA,D:VA,C:HA,L:GA,m:jA,X:XA,S:WA,M:qA};function FA(){var i=Dl.f(),a=na();return i||a}function kA(i){var a=Mt(i);a!==null&&a.tag===5&&a.type==="form"?dg(a):Dl.r(i)}var Th=typeof document>"u"?null:document;function pS(i,a,f){var p=Th;if(p&&typeof a=="string"&&a){var S=Ot(a);S='link[rel="'+i+'"][href="'+S+'"]',typeof f=="string"&&(S+='[crossorigin="'+f+'"]'),dS.has(S)||(dS.add(S),i={rel:i,crossOrigin:f,href:a},p.querySelector(S)===null&&(a=p.createElement("link"),Hr(a,"link",i),G(a),p.head.appendChild(a)))}}function VA(i){Dl.D(i),pS("dns-prefetch",i,null)}function HA(i,a){Dl.C(i,a),pS("preconnect",i,a)}function GA(i,a,f){Dl.L(i,a,f);var p=Th;if(p&&i&&a){var S='link[rel="preload"][as="'+Ot(a)+'"]';a==="image"&&f&&f.imageSrcSet?(S+='[imagesrcset="'+Ot(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(S+='[imagesizes="'+Ot(f.imageSizes)+'"]')):S+='[href="'+Ot(i)+'"]';var T=S;switch(a){case"style":T=wh(i);break;case"script":T=Ah(i)}za.has(T)||(i=x({rel:"preload",href:a==="image"&&f&&f.imageSrcSet?void 0:i,as:a},f),za.set(T,i),p.querySelector(S)!==null||a==="style"&&p.querySelector(Gp(T))||a==="script"&&p.querySelector(jp(T))||(a=p.createElement("link"),Hr(a,"link",i),G(a),p.head.appendChild(a)))}}function jA(i,a){Dl.m(i,a);var f=Th;if(f&&i){var p=a&&typeof a.as=="string"?a.as:"script",S='link[rel="modulepreload"][as="'+Ot(p)+'"][href="'+Ot(i)+'"]',T=S;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=Ah(i)}if(!za.has(T)&&(i=x({rel:"modulepreload",href:i},a),za.set(T,i),f.querySelector(S)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(jp(T)))return}p=f.createElement("link"),Hr(p,"link",i),G(p),f.head.appendChild(p)}}}function WA(i,a,f){Dl.S(i,a,f);var p=Th;if(p&&i){var S=_t(p).hoistableStyles,T=wh(i);a=a||"default";var O=S.get(T);if(!O){var q={loading:0,preload:null};if(O=p.querySelector(Gp(T)))q.loading=5;else{i=x({rel:"stylesheet",href:i,"data-precedence":a},f),(f=za.get(T))&&tb(i,f);var fe=O=p.createElement("link");G(fe),Hr(fe,"link",i),fe._p=new Promise(function(Ie,Ke){fe.onload=Ie,fe.onerror=Ke}),fe.addEventListener("load",function(){q.loading|=1}),fe.addEventListener("error",function(){q.loading|=2}),q.loading|=4,Ig(O,a,p)}O={type:"stylesheet",instance:O,count:1,state:q},S.set(T,O)}}}function XA(i,a){Dl.X(i,a);var f=Th;if(f&&i){var p=_t(f).hoistableScripts,S=Ah(i),T=p.get(S);T||(T=f.querySelector(jp(S)),T||(i=x({src:i,async:!0},a),(a=za.get(S))&&nb(i,a),T=f.createElement("script"),G(T),Hr(T,"link",i),f.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},p.set(S,T))}}function qA(i,a){Dl.M(i,a);var f=Th;if(f&&i){var p=_t(f).hoistableScripts,S=Ah(i),T=p.get(S);T||(T=f.querySelector(jp(S)),T||(i=x({src:i,async:!0,type:"module"},a),(a=za.get(S))&&nb(i,a),T=f.createElement("script"),G(T),Hr(T,"link",i),f.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},p.set(S,T))}}function mS(i,a,f,p){var S=(S=pe.current)?Dg(S):null;if(!S)throw Error(n(446));switch(i){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(a=wh(f.href),f=_t(S).hoistableStyles,p=f.get(a),p||(p={type:"style",instance:null,count:0,state:null},f.set(a,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){i=wh(f.href);var T=_t(S).hoistableStyles,O=T.get(i);if(O||(S=S.ownerDocument||S,O={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(i,O),(T=S.querySelector(Gp(i)))&&!T._p&&(O.instance=T,O.state.loading=5),za.has(i)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},za.set(i,f),T||YA(S,i,f,O.state))),a&&p===null)throw Error(n(528,""));return O}if(a&&p!==null)throw Error(n(529,""));return null;case"script":return a=f.async,f=f.src,typeof f=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Ah(f),f=_t(S).hoistableScripts,p=f.get(a),p||(p={type:"script",instance:null,count:0,state:null},f.set(a,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,i))}}function wh(i){return'href="'+Ot(i)+'"'}function Gp(i){return'link[rel="stylesheet"]['+i+"]"}function gS(i){return x({},i,{"data-precedence":i.precedence,precedence:null})}function YA(i,a,f,p){i.querySelector('link[rel="preload"][as="style"]['+a+"]")?p.loading=1:(a=i.createElement("link"),p.preload=a,a.addEventListener("load",function(){return p.loading|=1}),a.addEventListener("error",function(){return p.loading|=2}),Hr(a,"link",f),G(a),i.head.appendChild(a))}function Ah(i){return'[src="'+Ot(i)+'"]'}function jp(i){return"script[async]"+i}function vS(i,a,f){if(a.count++,a.instance===null)switch(a.type){case"style":var p=i.querySelector('style[data-href~="'+Ot(f.href)+'"]');if(p)return a.instance=p,G(p),p;var S=x({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),G(p),Hr(p,"style",S),Ig(p,f.precedence,i),a.instance=p;case"stylesheet":S=wh(f.href);var T=i.querySelector(Gp(S));if(T)return a.state.loading|=4,a.instance=T,G(T),T;p=gS(f),(S=za.get(S))&&tb(p,S),T=(i.ownerDocument||i).createElement("link"),G(T);var O=T;return O._p=new Promise(function(q,fe){O.onload=q,O.onerror=fe}),Hr(T,"link",p),a.state.loading|=4,Ig(T,f.precedence,i),a.instance=T;case"script":return T=Ah(f.src),(S=i.querySelector(jp(T)))?(a.instance=S,G(S),S):(p=f,(S=za.get(T))&&(p=x({},f),nb(p,S)),i=i.ownerDocument||i,S=i.createElement("script"),G(S),Hr(S,"link",p),i.head.appendChild(S),a.instance=S);case"void":return null;default:throw Error(n(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(p=a.instance,a.state.loading|=4,Ig(p,f.precedence,i));return a.instance}function Ig(i,a,f){for(var p=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=p.length?p[p.length-1]:null,T=S,O=0;O<p.length;O++){var q=p[O];if(q.dataset.precedence===a)T=q;else if(T!==S)break}T?T.parentNode.insertBefore(i,T.nextSibling):(a=f.nodeType===9?f.head:f,a.insertBefore(i,a.firstChild))}function tb(i,a){i.crossOrigin==null&&(i.crossOrigin=a.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=a.referrerPolicy),i.title==null&&(i.title=a.title)}function nb(i,a){i.crossOrigin==null&&(i.crossOrigin=a.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=a.referrerPolicy),i.integrity==null&&(i.integrity=a.integrity)}var Lg=null;function xS(i,a,f){if(Lg===null){var p=new Map,S=Lg=new Map;S.set(f,p)}else S=Lg,p=S.get(f),p||(p=new Map,S.set(f,p));if(p.has(i))return p;for(p.set(i,null),f=f.getElementsByTagName(i),S=0;S<f.length;S++){var T=f[S];if(!(T[pt]||T[ui]||i==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var O=T.getAttribute(a)||"";O=i+O;var q=p.get(O);q?q.push(T):p.set(O,[T])}}return p}function yS(i,a,f){i=i.ownerDocument||i,i.head.insertBefore(f,a==="title"?i.querySelector("head > title"):null)}function ZA(i,a,f){if(f===1||a.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(i=a.disabled,typeof a.precedence=="string"&&i==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function bS(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function KA(i,a,f,p){if(f.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var S=wh(p.href),T=a.querySelector(Gp(S));if(T){a=T._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(i.count++,i=Pg.bind(i),a.then(i,i)),f.state.loading|=4,f.instance=T,G(T);return}T=a.ownerDocument||a,p=gS(p),(S=za.get(S))&&tb(p,S),T=T.createElement("link"),G(T);var O=T;O._p=new Promise(function(q,fe){O.onload=q,O.onerror=fe}),Hr(T,"link",p),f.instance=T}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(f,a),(a=f.state.preload)&&(f.state.loading&3)===0&&(i.count++,f=Pg.bind(i),a.addEventListener("load",f),a.addEventListener("error",f))}}var ib=0;function QA(i,a){return i.stylesheets&&i.count===0&&Og(i,i.stylesheets),0<i.count||0<i.imgCount?function(f){var p=setTimeout(function(){if(i.stylesheets&&Og(i,i.stylesheets),i.unsuspend){var T=i.unsuspend;i.unsuspend=null,T()}},6e4+a);0<i.imgBytes&&ib===0&&(ib=62500*DA());var S=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Og(i,i.stylesheets),i.unsuspend)){var T=i.unsuspend;i.unsuspend=null,T()}},(i.imgBytes>ib?50:800)+a);return i.unsuspend=f,function(){i.unsuspend=null,clearTimeout(p),clearTimeout(S)}}:null}function Pg(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Og(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Ug=null;function Og(i,a){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Ug=new Map,a.forEach(JA,i),Ug=null,Pg.call(i))}function JA(i,a){if(!(a.state.loading&4)){var f=Ug.get(i);if(f)var p=f.get(null);else{f=new Map,Ug.set(i,f);for(var S=i.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<S.length;T++){var O=S[T];(O.nodeName==="LINK"||O.getAttribute("media")!=="not all")&&(f.set(O.dataset.precedence,O),p=O)}p&&f.set(null,p)}S=a.instance,O=S.getAttribute("data-precedence"),T=f.get(O)||p,T===p&&f.set(null,S),f.set(O,S),this.count++,p=Pg.bind(this),S.addEventListener("load",p),S.addEventListener("error",p),T?T.parentNode.insertBefore(S,T.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(S,i.firstChild)),a.state.loading|=4}}var Wp={$$typeof:I,Provider:null,Consumer:null,_currentValue:ve,_currentValue2:ve,_threadCount:0};function $A(i,a,f,p,S,T,O,q,fe){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=dn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dn(0),this.hiddenUpdates=dn(null),this.identifierPrefix=p,this.onUncaughtError=S,this.onCaughtError=T,this.onRecoverableError=O,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=fe,this.incompleteTransitions=new Map}function _S(i,a,f,p,S,T,O,q,fe,Ie,Ke,st){return i=new $A(i,a,f,O,fe,Ie,Ke,st,q),a=1,T===!0&&(a|=24),T=yi(3,null,null,a),i.current=T,T.stateNode=i,a=Zd(),a.refCount++,i.pooledCache=a,a.refCount++,T.memoizedState={element:p,isDehydrated:f,cache:a},bu(T),i}function SS(i){return i?(i=Mo,i):Mo}function MS(i,a,f,p,S,T){S=SS(S),p.context===null?p.context=S:p.pendingContext=S,p=Ja(a),p.payload={element:f},T=T===void 0?null:T,T!==null&&(p.callback=T),f=Do(i,p,a),f!==null&&(Mn(f,i,a),Io(f,i,a))}function ES(i,a){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var f=i.retryLane;i.retryLane=f!==0&&f<a?f:a}}function rb(i,a){ES(i,a),(i=i.alternate)&&ES(i,a)}function TS(i){if(i.tag===13||i.tag===31){var a=Ur(i,67108864);a!==null&&Mn(a,i,67108864),rb(i,67108864)}}function wS(i){if(i.tag===13||i.tag===31){var a=bs();a=da(a);var f=Ur(i,a);f!==null&&Mn(f,i,a),rb(i,a)}}var zg=!0;function e3(i,a,f,p){var S=Y.T;Y.T=null;var T=ne.p;try{ne.p=2,sb(i,a,f,p)}finally{ne.p=T,Y.T=S}}function t3(i,a,f,p){var S=Y.T;Y.T=null;var T=ne.p;try{ne.p=8,sb(i,a,f,p)}finally{ne.p=T,Y.T=S}}function sb(i,a,f,p){if(zg){var S=ab(p);if(S===null)Wy(i,a,p,Bg,f),CS(i,p);else if(i3(S,i,a,f,p))p.stopPropagation();else if(CS(i,p),a&4&&-1<n3.indexOf(i)){for(;S!==null;){var T=Mt(S);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var O=ct(T.pendingLanes);if(O!==0){var q=T;for(q.pendingLanes|=2,q.entangledLanes|=2;O;){var fe=1<<31-ee(O);q.entanglements[1]|=fe,O&=~fe}vt(T),(Kt&6)===0&&(Bi=F()+500,Ht(0))}}break;case 31:case 13:q=Ur(T,2),q!==null&&Mn(q,T,2),na(),rb(T,2)}if(T=ab(p),T===null&&Wy(i,a,p,Bg,f),T===S)break;S=T}S!==null&&p.stopPropagation()}else Wy(i,a,p,null,f)}}function ab(i){return i=Ef(i),ob(i)}var Bg=null;function ob(i){if(Bg=null,i=Tt(i),i!==null){var a=o(i);if(a===null)i=null;else{var f=a.tag;if(f===13){if(i=u(a),i!==null)return i;i=null}else if(f===31){if(i=h(a),i!==null)return i;i=null}else if(f===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;i=null}else a!==i&&(i=null)}}return Bg=i,null}function AS(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ge()){case ze:return 2;case Ye:return 8;case Be:case Dt:return 32;case yt:return 268435456;default:return 32}default:return 32}}var lb=!1,Cc=null,Rc=null,Nc=null,Xp=new Map,qp=new Map,Dc=[],n3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function CS(i,a){switch(i){case"focusin":case"focusout":Cc=null;break;case"dragenter":case"dragleave":Rc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Xp.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":qp.delete(a.pointerId)}}function Yp(i,a,f,p,S,T){return i===null||i.nativeEvent!==T?(i={blockedOn:a,domEventName:f,eventSystemFlags:p,nativeEvent:T,targetContainers:[S]},a!==null&&(a=Mt(a),a!==null&&TS(a)),i):(i.eventSystemFlags|=p,a=i.targetContainers,S!==null&&a.indexOf(S)===-1&&a.push(S),i)}function i3(i,a,f,p,S){switch(a){case"focusin":return Cc=Yp(Cc,i,a,f,p,S),!0;case"dragenter":return Rc=Yp(Rc,i,a,f,p,S),!0;case"mouseover":return Nc=Yp(Nc,i,a,f,p,S),!0;case"pointerover":var T=S.pointerId;return Xp.set(T,Yp(Xp.get(T)||null,i,a,f,p,S)),!0;case"gotpointercapture":return T=S.pointerId,qp.set(T,Yp(qp.get(T)||null,i,a,f,p,S)),!0}return!1}function RS(i){var a=Tt(i.target);if(a!==null){var f=o(a);if(f!==null){if(a=f.tag,a===13){if(a=u(f),a!==null){i.blockedOn=a,en(i.priority,function(){wS(f)});return}}else if(a===31){if(a=h(f),a!==null){i.blockedOn=a,en(i.priority,function(){wS(f)});return}}else if(a===3&&f.stateNode.current.memoizedState.isDehydrated){i.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Fg(i){if(i.blockedOn!==null)return!1;for(var a=i.targetContainers;0<a.length;){var f=ab(i.nativeEvent);if(f===null){f=i.nativeEvent;var p=new f.constructor(f.type,f);Mf=p,f.target.dispatchEvent(p),Mf=null}else return a=Mt(f),a!==null&&TS(a),i.blockedOn=f,!1;a.shift()}return!0}function NS(i,a,f){Fg(i)&&f.delete(a)}function r3(){lb=!1,Cc!==null&&Fg(Cc)&&(Cc=null),Rc!==null&&Fg(Rc)&&(Rc=null),Nc!==null&&Fg(Nc)&&(Nc=null),Xp.forEach(NS),qp.forEach(NS)}function kg(i,a){i.blockedOn===a&&(i.blockedOn=null,lb||(lb=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,r3)))}var Vg=null;function DS(i){Vg!==i&&(Vg=i,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Vg===i&&(Vg=null);for(var a=0;a<i.length;a+=3){var f=i[a],p=i[a+1],S=i[a+2];if(typeof p!="function"){if(ob(p||f)===null)continue;break}var T=Mt(f);T!==null&&(i.splice(a,3),a-=3,Sp(T,{pending:!0,data:S,method:f.method,action:p},p,S))}}))}function Ch(i){function a(fe){return kg(fe,i)}Cc!==null&&kg(Cc,i),Rc!==null&&kg(Rc,i),Nc!==null&&kg(Nc,i),Xp.forEach(a),qp.forEach(a);for(var f=0;f<Dc.length;f++){var p=Dc[f];p.blockedOn===i&&(p.blockedOn=null)}for(;0<Dc.length&&(f=Dc[0],f.blockedOn===null);)RS(f),f.blockedOn===null&&Dc.shift();if(f=(i.ownerDocument||i).$$reactFormReplay,f!=null)for(p=0;p<f.length;p+=3){var S=f[p],T=f[p+1],O=S[k]||null;if(typeof T=="function")O||DS(f);else if(O){var q=null;if(T&&T.hasAttribute("formAction")){if(S=T,O=T[k]||null)q=O.formAction;else if(ob(S)!==null)continue}else q=O.action;typeof q=="function"?f[p+1]=q:(f.splice(p,3),p-=3),DS(f)}}}function IS(){function i(T){T.canIntercept&&T.info==="react-transition"&&T.intercept({handler:function(){return new Promise(function(O){return S=O})},focusReset:"manual",scroll:"manual"})}function a(){S!==null&&(S(),S=null),p||setTimeout(f,20)}function f(){if(!p&&!navigation.transition){var T=navigation.currentEntry;T&&T.url!=null&&navigation.navigate(T.url,{state:T.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,S=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(f,100),function(){p=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),S!==null&&(S(),S=null)}}}function cb(i){this._internalRoot=i}Hg.prototype.render=cb.prototype.render=function(i){var a=this._internalRoot;if(a===null)throw Error(n(409));var f=a.current,p=bs();MS(f,p,i,a,null,null)},Hg.prototype.unmount=cb.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var a=i.containerInfo;MS(i.current,2,null,i,null,null),na(),a[Z]=null}};function Hg(i){this._internalRoot=i}Hg.prototype.unstable_scheduleHydration=function(i){if(i){var a=us();i={blockedOn:null,target:i,priority:a};for(var f=0;f<Dc.length&&a!==0&&a<Dc[f].priority;f++);Dc.splice(f,0,i),f===0&&RS(i)}};var LS=e.version;if(LS!=="19.2.3")throw Error(n(527,LS,"19.2.3"));ne.findDOMNode=function(i){var a=i._reactInternals;if(a===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=m(a),i=i!==null?v(i):null,i=i===null?null:i.stateNode,i};var s3={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:Y,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Gg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Gg.isDisabled&&Gg.supportsFiber)try{Ce=Gg.inject(s3),Fe=Gg}catch{}}return Kp.createRoot=function(i,a){if(!r(i))throw Error(n(299));var f=!1,p="",S=bg,T=Cp,O=Rp;return a!=null&&(a.unstable_strictMode===!0&&(f=!0),a.identifierPrefix!==void 0&&(p=a.identifierPrefix),a.onUncaughtError!==void 0&&(S=a.onUncaughtError),a.onCaughtError!==void 0&&(T=a.onCaughtError),a.onRecoverableError!==void 0&&(O=a.onRecoverableError)),a=_S(i,1,!1,null,null,f,p,null,S,T,O,IS),i[Z]=a.current,jy(i),new cb(a)},Kp.hydrateRoot=function(i,a,f){if(!r(i))throw Error(n(299));var p=!1,S="",T=bg,O=Cp,q=Rp,fe=null;return f!=null&&(f.unstable_strictMode===!0&&(p=!0),f.identifierPrefix!==void 0&&(S=f.identifierPrefix),f.onUncaughtError!==void 0&&(T=f.onUncaughtError),f.onCaughtError!==void 0&&(O=f.onCaughtError),f.onRecoverableError!==void 0&&(q=f.onRecoverableError),f.formState!==void 0&&(fe=f.formState)),a=_S(i,1,!0,a,f??null,p,S,fe,T,O,q,IS),a.context=SS(null),f=a.current,p=bs(),p=da(p),S=Ja(p),S.callback=null,Do(f,S,p),f=p,a.current.lanes=f,ci(a,f),vt(a),i[Z]=a.current,jy(i),new Hg(a)},Kp.version="19.2.3",Kp}var GS;function p3(){if(GS)return hb.exports;GS=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),hb.exports=d3(),hb.exports}var nT=p3();const yd="182",$u={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},ef={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},iT=0,x_=1,rT=2,m3=3,sT=0,id=1,mm=2,rf=3,Hl=0,ss=1,Ii=2,mo=0,uf=1,y_=2,b_=3,__=4,aT=5,Vc=100,oT=101,lT=102,cT=103,uT=104,fT=200,hT=201,dT=202,pT=203,Gv=204,jv=205,mT=206,gT=207,vT=208,xT=209,yT=210,bT=211,_T=212,ST=213,MT=214,Wv=0,Xv=1,qv=2,df=3,Yv=4,Zv=5,Kv=6,Qv=7,Wm=0,ET=1,TT=2,ka=0,Y_=1,Z_=2,K_=3,Hx=4,Q_=5,J_=6,$_=7,S_="attached",wT="detached",Xc=300,go=301,qc=302,ad=303,wm=304,bd=306,Am=1e3,Ki=1001,Cm=1002,ar=1003,e1=1004,g3=1004,ed=1005,v3=1005,Gn=1006,gm=1007,x3=1007,Qo=1008,M_=1008,Dr=1009,Gx=1010,jx=1011,od=1012,Xm=1013,ca=1014,Li=1015,Qi=1016,Wx=1017,Xx=1018,ld=1020,t1=35902,n1=35899,i1=1021,r1=1022,or=1023,$o=1026,Hc=1027,qm=1028,Ym=1029,pf=1030,qx=1031,y3=1032,Yx=1033,vm=33776,xm=33777,ym=33778,bm=33779,Jv=35840,$v=35841,ex=35842,tx=35843,nx=36196,ix=37492,rx=37496,sx=37488,ax=37489,ox=37490,lx=37491,cx=37808,ux=37809,fx=37810,hx=37811,dx=37812,px=37813,mx=37814,gx=37815,vx=37816,xx=37817,yx=37818,bx=37819,_x=37820,Sx=37821,Mx=36492,Ex=36494,Tx=36495,wx=36283,Ax=36284,Cx=36285,Rx=36286,AT=2200,CT=2201,RT=2202,Rm=2300,Nx=2301,Fv=2302,sf=2400,af=2401,Nm=2402,Zx=2500,s1=2501,b3=0,_3=1,S3=2,NT=3200,M3=3201,E3=3202,T3=3203,Kc=0,DT=1,Bl="",Gr="srgb",vo="srgb-linear",Dm="linear",ti="srgb",w3="",A3="rg",C3="ga",R3=0,tf=7680,N3=7681,D3=7682,I3=7683,L3=34055,P3=34056,U3=5386,O3=512,z3=513,B3=514,F3=515,k3=516,V3=517,H3=518,E_=519,IT=512,LT=513,PT=514,Kx=515,UT=516,OT=517,Qx=518,zT=519,Im=35044,G3=35048,j3=35040,W3=35045,X3=35049,q3=35041,Y3=35046,Z3=35050,K3=35042,Q3="100",T_="300 es",aa=2e3,cd=2001,J3={COMPUTE:"compute",RENDER:"render"},$3={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},eC={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};function BT(s){for(let e=s.length-1;e>=0;--e)if(s[e]>=65535)return!0;return!1}const tC={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function td(s,e){return new tC[s](e)}function FT(s){return ArrayBuffer.isView(s)&&!(s instanceof DataView)}function Lm(s){return document.createElementNS("http://www.w3.org/1999/xhtml",s)}function kT(){const s=Lm("canvas");return s.style.display="block",s}const jS={};let Yc=null;function nC(s){Yc=s}function iC(){return Yc}function Pm(...s){const e="THREE."+s.shift();Yc?Yc("log",e,...s):console.log(e,...s)}function zt(...s){const e="THREE."+s.shift();Yc?Yc("warn",e,...s):console.warn(e,...s)}function Qt(...s){const e="THREE."+s.shift();Yc?Yc("error",e,...s):console.error(e,...s)}function ud(...s){const e=s.join(" ");e in jS||(jS[e]=!0,zt(...s))}function rC(s,e,t){return new Promise(function(n,r){function o(){switch(s.clientWaitSync(e,s.SYNC_FLUSH_COMMANDS_BIT,0)){case s.WAIT_FAILED:r();break;case s.TIMEOUT_EXPIRED:setTimeout(o,t);break;default:n()}}setTimeout(o,t)})}let el=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const r=n[e];if(r!==void 0){const o=r.indexOf(t);o!==-1&&r.splice(o,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let o=0,u=r.length;o<u;o++)r[o].call(this,e);e.target=null}}};const ns=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let WS=1234567;const ff=Math.PI/180,fd=180/Math.PI;function oa(){const s=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(ns[s&255]+ns[s>>8&255]+ns[s>>16&255]+ns[s>>24&255]+"-"+ns[e&255]+ns[e>>8&255]+"-"+ns[e>>16&15|64]+ns[e>>24&255]+"-"+ns[t&63|128]+ns[t>>8&255]+"-"+ns[t>>16&255]+ns[t>>24&255]+ns[n&255]+ns[n>>8&255]+ns[n>>16&255]+ns[n>>24&255]).toLowerCase()}function on(s,e,t){return Math.max(e,Math.min(t,s))}function a1(s,e){return(s%e+e)%e}function sC(s,e,t,n,r){return n+(s-e)*(r-n)/(t-e)}function aC(s,e,t){return s!==e?(t-s)/(e-s):0}function _m(s,e,t){return(1-t)*s+t*e}function oC(s,e,t,n){return _m(s,e,1-Math.exp(-t*n))}function lC(s,e=1){return e-Math.abs(a1(s,e*2)-e)}function cC(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e),s*s*(3-2*s))}function uC(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e),s*s*s*(s*(s*6-15)+10))}function fC(s,e){return s+Math.floor(Math.random()*(e-s+1))}function hC(s,e){return s+Math.random()*(e-s)}function dC(s){return s*(.5-Math.random())}function pC(s){s!==void 0&&(WS=s);let e=WS+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function mC(s){return s*ff}function gC(s){return s*fd}function vC(s){return(s&s-1)===0&&s!==0}function xC(s){return Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function yC(s){return Math.pow(2,Math.floor(Math.log(s)/Math.LN2))}function bC(s,e,t,n,r){const o=Math.cos,u=Math.sin,h=o(t/2),d=u(t/2),m=o((e+n)/2),v=u((e+n)/2),x=o((e-n)/2),y=u((e-n)/2),_=o((n-e)/2),M=u((n-e)/2);switch(r){case"XYX":s.set(h*v,d*x,d*y,h*m);break;case"YZY":s.set(d*y,h*v,d*x,h*m);break;case"ZXZ":s.set(d*x,d*y,h*v,h*m);break;case"XZX":s.set(h*v,d*M,d*_,h*m);break;case"YXY":s.set(d*_,h*v,d*M,h*m);break;case"ZYZ":s.set(d*M,d*_,h*v,h*m);break;default:zt("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Es(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return s/4294967295;case Uint16Array:return s/65535;case Uint8Array:return s/255;case Int32Array:return Math.max(s/2147483647,-1);case Int16Array:return Math.max(s/32767,-1);case Int8Array:return Math.max(s/127,-1);default:throw new Error("Invalid component type.")}}function En(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return Math.round(s*4294967295);case Uint16Array:return Math.round(s*65535);case Uint8Array:return Math.round(s*255);case Int32Array:return Math.round(s*2147483647);case Int16Array:return Math.round(s*32767);case Int8Array:return Math.round(s*127);default:throw new Error("Invalid component type.")}}const Jx={DEG2RAD:ff,RAD2DEG:fd,generateUUID:oa,clamp:on,euclideanModulo:a1,mapLinear:sC,inverseLerp:aC,lerp:_m,damp:oC,pingpong:lC,smoothstep:cC,smootherstep:uC,randInt:fC,randFloat:hC,randFloatSpread:dC,seededRandom:pC,degToRad:mC,radToDeg:gC,isPowerOfTwo:vC,ceilPowerOfTwo:xC,floorPowerOfTwo:yC,setQuaternionFromProperEuler:bC,normalize:En,denormalize:Es};class Je{constructor(e=0,t=0){Je.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=on(this.x,e.x,t.x),this.y=on(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=on(this.x,e,t),this.y=on(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(on(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(on(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),o=this.x-e.x,u=this.y-e.y;return this.x=o*n-u*r+e.x,this.y=o*r+u*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class as{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,o,u,h){let d=n[r+0],m=n[r+1],v=n[r+2],x=n[r+3],y=o[u+0],_=o[u+1],M=o[u+2],R=o[u+3];if(h<=0){e[t+0]=d,e[t+1]=m,e[t+2]=v,e[t+3]=x;return}if(h>=1){e[t+0]=y,e[t+1]=_,e[t+2]=M,e[t+3]=R;return}if(x!==R||d!==y||m!==_||v!==M){let A=d*y+m*_+v*M+x*R;A<0&&(y=-y,_=-_,M=-M,R=-R,A=-A);let E=1-h;if(A<.9995){const N=Math.acos(A),I=Math.sin(N);E=Math.sin(E*N)/I,h=Math.sin(h*N)/I,d=d*E+y*h,m=m*E+_*h,v=v*E+M*h,x=x*E+R*h}else{d=d*E+y*h,m=m*E+_*h,v=v*E+M*h,x=x*E+R*h;const N=1/Math.sqrt(d*d+m*m+v*v+x*x);d*=N,m*=N,v*=N,x*=N}}e[t]=d,e[t+1]=m,e[t+2]=v,e[t+3]=x}static multiplyQuaternionsFlat(e,t,n,r,o,u){const h=n[r],d=n[r+1],m=n[r+2],v=n[r+3],x=o[u],y=o[u+1],_=o[u+2],M=o[u+3];return e[t]=h*M+v*x+d*_-m*y,e[t+1]=d*M+v*y+m*x-h*_,e[t+2]=m*M+v*_+h*y-d*x,e[t+3]=v*M-h*x-d*y-m*_,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,o=e._z,u=e._order,h=Math.cos,d=Math.sin,m=h(n/2),v=h(r/2),x=h(o/2),y=d(n/2),_=d(r/2),M=d(o/2);switch(u){case"XYZ":this._x=y*v*x+m*_*M,this._y=m*_*x-y*v*M,this._z=m*v*M+y*_*x,this._w=m*v*x-y*_*M;break;case"YXZ":this._x=y*v*x+m*_*M,this._y=m*_*x-y*v*M,this._z=m*v*M-y*_*x,this._w=m*v*x+y*_*M;break;case"ZXY":this._x=y*v*x-m*_*M,this._y=m*_*x+y*v*M,this._z=m*v*M+y*_*x,this._w=m*v*x-y*_*M;break;case"ZYX":this._x=y*v*x-m*_*M,this._y=m*_*x+y*v*M,this._z=m*v*M-y*_*x,this._w=m*v*x+y*_*M;break;case"YZX":this._x=y*v*x+m*_*M,this._y=m*_*x+y*v*M,this._z=m*v*M-y*_*x,this._w=m*v*x-y*_*M;break;case"XZY":this._x=y*v*x-m*_*M,this._y=m*_*x-y*v*M,this._z=m*v*M+y*_*x,this._w=m*v*x+y*_*M;break;default:zt("Quaternion: .setFromEuler() encountered an unknown order: "+u)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],o=t[8],u=t[1],h=t[5],d=t[9],m=t[2],v=t[6],x=t[10],y=n+h+x;if(y>0){const _=.5/Math.sqrt(y+1);this._w=.25/_,this._x=(v-d)*_,this._y=(o-m)*_,this._z=(u-r)*_}else if(n>h&&n>x){const _=2*Math.sqrt(1+n-h-x);this._w=(v-d)/_,this._x=.25*_,this._y=(r+u)/_,this._z=(o+m)/_}else if(h>x){const _=2*Math.sqrt(1+h-n-x);this._w=(o-m)/_,this._x=(r+u)/_,this._y=.25*_,this._z=(d+v)/_}else{const _=2*Math.sqrt(1+x-n-h);this._w=(u-r)/_,this._x=(o+m)/_,this._y=(d+v)/_,this._z=.25*_}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(on(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,o=e._z,u=e._w,h=t._x,d=t._y,m=t._z,v=t._w;return this._x=n*v+u*h+r*m-o*d,this._y=r*v+u*d+o*h-n*m,this._z=o*v+u*m+n*d-r*h,this._w=u*v-n*h-r*d-o*m,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let n=e._x,r=e._y,o=e._z,u=e._w,h=this.dot(e);h<0&&(n=-n,r=-r,o=-o,u=-u,h=-h);let d=1-t;if(h<.9995){const m=Math.acos(h),v=Math.sin(m);d=Math.sin(d*m)/v,t=Math.sin(t*m)/v,this._x=this._x*d+n*t,this._y=this._y*d+r*t,this._z=this._z*d+o*t,this._w=this._w*d+u*t,this._onChangeCallback()}else this._x=this._x*d+n*t,this._y=this._y*d+r*t,this._z=this._z*d+o*t,this._w=this._w*d+u*t,this.normalize();return this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),o=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),o*Math.sin(t),o*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Q{constructor(e=0,t=0,n=0){Q.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(XS.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(XS.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[3]*n+o[6]*r,this.y=o[1]*t+o[4]*n+o[7]*r,this.z=o[2]*t+o[5]*n+o[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,o=e.elements,u=1/(o[3]*t+o[7]*n+o[11]*r+o[15]);return this.x=(o[0]*t+o[4]*n+o[8]*r+o[12])*u,this.y=(o[1]*t+o[5]*n+o[9]*r+o[13])*u,this.z=(o[2]*t+o[6]*n+o[10]*r+o[14])*u,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,o=e.x,u=e.y,h=e.z,d=e.w,m=2*(u*r-h*n),v=2*(h*t-o*r),x=2*(o*n-u*t);return this.x=t+d*m+u*x-h*v,this.y=n+d*v+h*m-o*x,this.z=r+d*x+o*v-u*m,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r,this.y=o[1]*t+o[5]*n+o[9]*r,this.z=o[2]*t+o[6]*n+o[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=on(this.x,e.x,t.x),this.y=on(this.y,e.y,t.y),this.z=on(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=on(this.x,e,t),this.y=on(this.y,e,t),this.z=on(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(on(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,o=e.z,u=t.x,h=t.y,d=t.z;return this.x=r*d-o*h,this.y=o*u-n*d,this.z=n*h-r*u,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return gb.copy(this).projectOnVector(e),this.sub(gb)}reflect(e){return this.sub(gb.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(on(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const gb=new Q,XS=new as;class bn{constructor(e,t,n,r,o,u,h,d,m){bn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,o,u,h,d,m)}set(e,t,n,r,o,u,h,d,m){const v=this.elements;return v[0]=e,v[1]=r,v[2]=h,v[3]=t,v[4]=o,v[5]=d,v[6]=n,v[7]=u,v[8]=m,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,o=this.elements,u=n[0],h=n[3],d=n[6],m=n[1],v=n[4],x=n[7],y=n[2],_=n[5],M=n[8],R=r[0],A=r[3],E=r[6],N=r[1],I=r[4],P=r[7],z=r[2],U=r[5],H=r[8];return o[0]=u*R+h*N+d*z,o[3]=u*A+h*I+d*U,o[6]=u*E+h*P+d*H,o[1]=m*R+v*N+x*z,o[4]=m*A+v*I+x*U,o[7]=m*E+v*P+x*H,o[2]=y*R+_*N+M*z,o[5]=y*A+_*I+M*U,o[8]=y*E+_*P+M*H,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],o=e[3],u=e[4],h=e[5],d=e[6],m=e[7],v=e[8];return t*u*v-t*h*m-n*o*v+n*h*d+r*o*m-r*u*d}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],o=e[3],u=e[4],h=e[5],d=e[6],m=e[7],v=e[8],x=v*u-h*m,y=h*d-v*o,_=m*o-u*d,M=t*x+n*y+r*_;if(M===0)return this.set(0,0,0,0,0,0,0,0,0);const R=1/M;return e[0]=x*R,e[1]=(r*m-v*n)*R,e[2]=(h*n-r*u)*R,e[3]=y*R,e[4]=(v*t-r*d)*R,e[5]=(r*o-h*t)*R,e[6]=_*R,e[7]=(n*d-m*t)*R,e[8]=(u*t-n*o)*R,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,o,u,h){const d=Math.cos(o),m=Math.sin(o);return this.set(n*d,n*m,-n*(d*u+m*h)+u+e,-r*m,r*d,-r*(-m*u+d*h)+h+t,0,0,1),this}scale(e,t){return this.premultiply(vb.makeScale(e,t)),this}rotate(e){return this.premultiply(vb.makeRotation(-e)),this}translate(e,t){return this.premultiply(vb.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const vb=new bn,qS=new bn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),YS=new bn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function _C(){const s={enabled:!0,workingColorSpace:vo,spaces:{},convert:function(r,o,u){return this.enabled===!1||o===u||!o||!u||(this.spaces[o].transfer===ti&&(r.r=kl(r.r),r.g=kl(r.g),r.b=kl(r.b)),this.spaces[o].primaries!==this.spaces[u].primaries&&(r.applyMatrix3(this.spaces[o].toXYZ),r.applyMatrix3(this.spaces[u].fromXYZ)),this.spaces[u].transfer===ti&&(r.r=rd(r.r),r.g=rd(r.g),r.b=rd(r.b))),r},workingToColorSpace:function(r,o){return this.convert(r,this.workingColorSpace,o)},colorSpaceToWorking:function(r,o){return this.convert(r,o,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===Bl?Dm:this.spaces[r].transfer},getToneMappingMode:function(r){return this.spaces[r].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(r,o=this.workingColorSpace){return r.fromArray(this.spaces[o].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,o,u){return r.copy(this.spaces[o].toXYZ).multiply(this.spaces[u].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(r,o){return ud("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),s.workingToColorSpace(r,o)},toWorkingColorSpace:function(r,o){return ud("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),s.colorSpaceToWorking(r,o)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return s.define({[vo]:{primaries:e,whitePoint:n,transfer:Dm,toXYZ:qS,fromXYZ:YS,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:Gr},outputColorSpaceConfig:{drawingBufferColorSpace:Gr}},[Gr]:{primaries:e,whitePoint:n,transfer:ti,toXYZ:qS,fromXYZ:YS,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:Gr}}}),s}const kn=_C();function kl(s){return s<.04045?s*.0773993808:Math.pow(s*.9478672986+.0521327014,2.4)}function rd(s){return s<.0031308?s*12.92:1.055*Math.pow(s,.41666)-.055}let Rh;class VT{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{Rh===void 0&&(Rh=Lm("canvas")),Rh.width=e.width,Rh.height=e.height;const r=Rh.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),n=Rh}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Lm("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),o=r.data;for(let u=0;u<o.length;u++)o[u]=kl(o[u]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(kl(t[n]/255)*255):t[n]=kl(t[n]);return{data:t,width:e.width,height:e.height}}else return zt("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let SC=0;class Gc{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:SC++}),this.uuid=oa(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):typeof VideoFrame<"u"&&t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let o;if(Array.isArray(r)){o=[];for(let u=0,h=r.length;u<h;u++)r[u].isDataTexture?o.push(xb(r[u].image)):o.push(xb(r[u]))}else o=xb(r);n.url=o}return t||(e.images[this.uuid]=n),n}}function xb(s){return typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&s instanceof ImageBitmap?VT.getDataURL(s):s.data?{data:Array.from(s.data),width:s.width,height:s.height,type:s.data.constructor.name}:(zt("Texture: Unable to serialize Texture."),{})}let MC=0;const yb=new Q;class oi extends el{constructor(e=oi.DEFAULT_IMAGE,t=oi.DEFAULT_MAPPING,n=Ki,r=Ki,o=Gn,u=Qo,h=or,d=Dr,m=oi.DEFAULT_ANISOTROPY,v=Bl){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:MC++}),this.uuid=oa(),this.name="",this.source=new Gc(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=o,this.minFilter=u,this.anisotropy=m,this.format=h,this.internalFormat=null,this.type=d,this.offset=new Je(0,0),this.repeat=new Je(1,1),this.center=new Je(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new bn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=v,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(yb).x}get height(){return this.source.getSize(yb).y}get depth(){return this.source.getSize(yb).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){zt(`Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){zt(`Texture.setValues(): property '${t}' does not exist.`);continue}r&&n&&r.isVector2&&n.isVector2||r&&n&&r.isVector3&&n.isVector3||r&&n&&r.isMatrix3&&n.isMatrix3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Xc)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Am:e.x=e.x-Math.floor(e.x);break;case Ki:e.x=e.x<0?0:1;break;case Cm:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Am:e.y=e.y-Math.floor(e.y);break;case Ki:e.y=e.y<0?0:1;break;case Cm:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}oi.DEFAULT_IMAGE=null;oi.DEFAULT_MAPPING=Xc;oi.DEFAULT_ANISOTROPY=1;class hi{constructor(e=0,t=0,n=0,r=1){hi.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,o=this.w,u=e.elements;return this.x=u[0]*t+u[4]*n+u[8]*r+u[12]*o,this.y=u[1]*t+u[5]*n+u[9]*r+u[13]*o,this.z=u[2]*t+u[6]*n+u[10]*r+u[14]*o,this.w=u[3]*t+u[7]*n+u[11]*r+u[15]*o,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,o;const d=e.elements,m=d[0],v=d[4],x=d[8],y=d[1],_=d[5],M=d[9],R=d[2],A=d[6],E=d[10];if(Math.abs(v-y)<.01&&Math.abs(x-R)<.01&&Math.abs(M-A)<.01){if(Math.abs(v+y)<.1&&Math.abs(x+R)<.1&&Math.abs(M+A)<.1&&Math.abs(m+_+E-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const I=(m+1)/2,P=(_+1)/2,z=(E+1)/2,U=(v+y)/4,H=(x+R)/4,V=(M+A)/4;return I>P&&I>z?I<.01?(n=0,r=.707106781,o=.707106781):(n=Math.sqrt(I),r=U/n,o=H/n):P>z?P<.01?(n=.707106781,r=0,o=.707106781):(r=Math.sqrt(P),n=U/r,o=V/r):z<.01?(n=.707106781,r=.707106781,o=0):(o=Math.sqrt(z),n=H/o,r=V/o),this.set(n,r,o,t),this}let N=Math.sqrt((A-M)*(A-M)+(x-R)*(x-R)+(y-v)*(y-v));return Math.abs(N)<.001&&(N=1),this.x=(A-M)/N,this.y=(x-R)/N,this.z=(y-v)/N,this.w=Math.acos((m+_+E-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=on(this.x,e.x,t.x),this.y=on(this.y,e.y,t.y),this.z=on(this.z,e.z,t.z),this.w=on(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=on(this.x,e,t),this.y=on(this.y,e,t),this.z=on(this.z,e,t),this.w=on(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(on(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class o1 extends el{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Gn,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new hi(0,0,e,t),this.scissorTest=!1,this.viewport=new hi(0,0,e,t);const r={width:e,height:t,depth:n.depth},o=new oi(r);this.textures=[];const u=n.count;for(let h=0;h<u;h++)this.textures[h]=o.clone(),this.textures[h].isRenderTargetTexture=!0,this.textures[h].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:Gn,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,o=this.textures.length;r<o;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n,this.textures[r].isData3DTexture!==!0&&(this.textures[r].isArrayTexture=this.textures[r].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const r=Object.assign({},e.textures[t].image);this.textures[t].source=new Gc(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Ts extends o1{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class $x extends oi{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=ar,this.minFilter=ar,this.wrapR=Ki,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class EC extends Ts{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new $x(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class ey extends oi{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=ar,this.minFilter=ar,this.wrapR=Ki,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class TC extends Ts{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new ey(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class os{constructor(e=new Q(1/0,1/0,1/0),t=new Q(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(lo.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(lo.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=lo.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const o=n.getAttribute("position");if(t===!0&&o!==void 0&&e.isInstancedMesh!==!0)for(let u=0,h=o.count;u<h;u++)e.isMesh===!0?e.getVertexPosition(u,lo):lo.fromBufferAttribute(o,u),lo.applyMatrix4(e.matrixWorld),this.expandByPoint(lo);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),jg.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),jg.copy(n.boundingBox)),jg.applyMatrix4(e.matrixWorld),this.union(jg)}const r=e.children;for(let o=0,u=r.length;o<u;o++)this.expandByObject(r[o],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,lo),lo.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Qp),Wg.subVectors(this.max,Qp),Nh.subVectors(e.a,Qp),Dh.subVectors(e.b,Qp),Ih.subVectors(e.c,Qp),Lc.subVectors(Dh,Nh),Pc.subVectors(Ih,Dh),Fu.subVectors(Nh,Ih);let t=[0,-Lc.z,Lc.y,0,-Pc.z,Pc.y,0,-Fu.z,Fu.y,Lc.z,0,-Lc.x,Pc.z,0,-Pc.x,Fu.z,0,-Fu.x,-Lc.y,Lc.x,0,-Pc.y,Pc.x,0,-Fu.y,Fu.x,0];return!bb(t,Nh,Dh,Ih,Wg)||(t=[1,0,0,0,1,0,0,0,1],!bb(t,Nh,Dh,Ih,Wg))?!1:(Xg.crossVectors(Lc,Pc),t=[Xg.x,Xg.y,Xg.z],bb(t,Nh,Dh,Ih,Wg))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,lo).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(lo).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Il[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Il[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Il[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Il[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Il[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Il[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Il[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Il[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Il),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const Il=[new Q,new Q,new Q,new Q,new Q,new Q,new Q,new Q],lo=new Q,jg=new os,Nh=new Q,Dh=new Q,Ih=new Q,Lc=new Q,Pc=new Q,Fu=new Q,Qp=new Q,Wg=new Q,Xg=new Q,ku=new Q;function bb(s,e,t,n,r){for(let o=0,u=s.length-3;o<=u;o+=3){ku.fromArray(s,o);const h=r.x*Math.abs(ku.x)+r.y*Math.abs(ku.y)+r.z*Math.abs(ku.z),d=e.dot(ku),m=t.dot(ku),v=n.dot(ku);if(Math.max(-Math.max(d,m,v),Math.min(d,m,v))>h)return!1}return!0}const wC=new os,Jp=new Q,_b=new Q;class jr{constructor(e=new Q,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):wC.setFromPoints(e).getCenter(n);let r=0;for(let o=0,u=e.length;o<u;o++)r=Math.max(r,n.distanceToSquared(e[o]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Jp.subVectors(e,this.center);const t=Jp.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(Jp,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(_b.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Jp.copy(e.center).add(_b)),this.expandByPoint(Jp.copy(e.center).sub(_b))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const Ll=new Q,Sb=new Q,qg=new Q,Uc=new Q,Mb=new Q,Yg=new Q,Eb=new Q;class yf{constructor(e=new Q,t=new Q(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ll)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Ll.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Ll.copy(this.origin).addScaledVector(this.direction,t),Ll.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){Sb.copy(e).add(t).multiplyScalar(.5),qg.copy(t).sub(e).normalize(),Uc.copy(this.origin).sub(Sb);const o=e.distanceTo(t)*.5,u=-this.direction.dot(qg),h=Uc.dot(this.direction),d=-Uc.dot(qg),m=Uc.lengthSq(),v=Math.abs(1-u*u);let x,y,_,M;if(v>0)if(x=u*d-h,y=u*h-d,M=o*v,x>=0)if(y>=-M)if(y<=M){const R=1/v;x*=R,y*=R,_=x*(x+u*y+2*h)+y*(u*x+y+2*d)+m}else y=o,x=Math.max(0,-(u*y+h)),_=-x*x+y*(y+2*d)+m;else y=-o,x=Math.max(0,-(u*y+h)),_=-x*x+y*(y+2*d)+m;else y<=-M?(x=Math.max(0,-(-u*o+h)),y=x>0?-o:Math.min(Math.max(-o,-d),o),_=-x*x+y*(y+2*d)+m):y<=M?(x=0,y=Math.min(Math.max(-o,-d),o),_=y*(y+2*d)+m):(x=Math.max(0,-(u*o+h)),y=x>0?o:Math.min(Math.max(-o,-d),o),_=-x*x+y*(y+2*d)+m);else y=u>0?-o:o,x=Math.max(0,-(u*y+h)),_=-x*x+y*(y+2*d)+m;return n&&n.copy(this.origin).addScaledVector(this.direction,x),r&&r.copy(Sb).addScaledVector(qg,y),_}intersectSphere(e,t){Ll.subVectors(e.center,this.origin);const n=Ll.dot(this.direction),r=Ll.dot(Ll)-n*n,o=e.radius*e.radius;if(r>o)return null;const u=Math.sqrt(o-r),h=n-u,d=n+u;return d<0?null:h<0?this.at(d,t):this.at(h,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,o,u,h,d;const m=1/this.direction.x,v=1/this.direction.y,x=1/this.direction.z,y=this.origin;return m>=0?(n=(e.min.x-y.x)*m,r=(e.max.x-y.x)*m):(n=(e.max.x-y.x)*m,r=(e.min.x-y.x)*m),v>=0?(o=(e.min.y-y.y)*v,u=(e.max.y-y.y)*v):(o=(e.max.y-y.y)*v,u=(e.min.y-y.y)*v),n>u||o>r||((o>n||isNaN(n))&&(n=o),(u<r||isNaN(r))&&(r=u),x>=0?(h=(e.min.z-y.z)*x,d=(e.max.z-y.z)*x):(h=(e.max.z-y.z)*x,d=(e.min.z-y.z)*x),n>d||h>r)||((h>n||n!==n)&&(n=h),(d<r||r!==r)&&(r=d),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,Ll)!==null}intersectTriangle(e,t,n,r,o){Mb.subVectors(t,e),Yg.subVectors(n,e),Eb.crossVectors(Mb,Yg);let u=this.direction.dot(Eb),h;if(u>0){if(r)return null;h=1}else if(u<0)h=-1,u=-u;else return null;Uc.subVectors(this.origin,e);const d=h*this.direction.dot(Yg.crossVectors(Uc,Yg));if(d<0)return null;const m=h*this.direction.dot(Mb.cross(Uc));if(m<0||d+m>u)return null;const v=-h*Uc.dot(Eb);return v<0?null:this.at(v/u,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class cn{constructor(e,t,n,r,o,u,h,d,m,v,x,y,_,M,R,A){cn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,o,u,h,d,m,v,x,y,_,M,R,A)}set(e,t,n,r,o,u,h,d,m,v,x,y,_,M,R,A){const E=this.elements;return E[0]=e,E[4]=t,E[8]=n,E[12]=r,E[1]=o,E[5]=u,E[9]=h,E[13]=d,E[2]=m,E[6]=v,E[10]=x,E[14]=y,E[3]=_,E[7]=M,E[11]=R,E[15]=A,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new cn().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return this.determinant()===0?(e.set(1,0,0),t.set(0,1,0),n.set(0,0,1),this):(e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this)}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){if(e.determinant()===0)return this.identity();const t=this.elements,n=e.elements,r=1/Lh.setFromMatrixColumn(e,0).length(),o=1/Lh.setFromMatrixColumn(e,1).length(),u=1/Lh.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*o,t[5]=n[5]*o,t[6]=n[6]*o,t[7]=0,t[8]=n[8]*u,t[9]=n[9]*u,t[10]=n[10]*u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,o=e.z,u=Math.cos(n),h=Math.sin(n),d=Math.cos(r),m=Math.sin(r),v=Math.cos(o),x=Math.sin(o);if(e.order==="XYZ"){const y=u*v,_=u*x,M=h*v,R=h*x;t[0]=d*v,t[4]=-d*x,t[8]=m,t[1]=_+M*m,t[5]=y-R*m,t[9]=-h*d,t[2]=R-y*m,t[6]=M+_*m,t[10]=u*d}else if(e.order==="YXZ"){const y=d*v,_=d*x,M=m*v,R=m*x;t[0]=y+R*h,t[4]=M*h-_,t[8]=u*m,t[1]=u*x,t[5]=u*v,t[9]=-h,t[2]=_*h-M,t[6]=R+y*h,t[10]=u*d}else if(e.order==="ZXY"){const y=d*v,_=d*x,M=m*v,R=m*x;t[0]=y-R*h,t[4]=-u*x,t[8]=M+_*h,t[1]=_+M*h,t[5]=u*v,t[9]=R-y*h,t[2]=-u*m,t[6]=h,t[10]=u*d}else if(e.order==="ZYX"){const y=u*v,_=u*x,M=h*v,R=h*x;t[0]=d*v,t[4]=M*m-_,t[8]=y*m+R,t[1]=d*x,t[5]=R*m+y,t[9]=_*m-M,t[2]=-m,t[6]=h*d,t[10]=u*d}else if(e.order==="YZX"){const y=u*d,_=u*m,M=h*d,R=h*m;t[0]=d*v,t[4]=R-y*x,t[8]=M*x+_,t[1]=x,t[5]=u*v,t[9]=-h*v,t[2]=-m*v,t[6]=_*x+M,t[10]=y-R*x}else if(e.order==="XZY"){const y=u*d,_=u*m,M=h*d,R=h*m;t[0]=d*v,t[4]=-x,t[8]=m*v,t[1]=y*x+R,t[5]=u*v,t[9]=_*x-M,t[2]=M*x-_,t[6]=h*v,t[10]=R*x+y}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(AC,e,CC)}lookAt(e,t,n){const r=this.elements;return ia.subVectors(e,t),ia.lengthSq()===0&&(ia.z=1),ia.normalize(),Oc.crossVectors(n,ia),Oc.lengthSq()===0&&(Math.abs(n.z)===1?ia.x+=1e-4:ia.z+=1e-4,ia.normalize(),Oc.crossVectors(n,ia)),Oc.normalize(),Zg.crossVectors(ia,Oc),r[0]=Oc.x,r[4]=Zg.x,r[8]=ia.x,r[1]=Oc.y,r[5]=Zg.y,r[9]=ia.y,r[2]=Oc.z,r[6]=Zg.z,r[10]=ia.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,o=this.elements,u=n[0],h=n[4],d=n[8],m=n[12],v=n[1],x=n[5],y=n[9],_=n[13],M=n[2],R=n[6],A=n[10],E=n[14],N=n[3],I=n[7],P=n[11],z=n[15],U=r[0],H=r[4],V=r[8],L=r[12],B=r[1],W=r[5],ie=r[9],J=r[13],se=r[2],ce=r[6],Y=r[10],ne=r[14],ve=r[3],ae=r[7],re=r[11],j=r[15];return o[0]=u*U+h*B+d*se+m*ve,o[4]=u*H+h*W+d*ce+m*ae,o[8]=u*V+h*ie+d*Y+m*re,o[12]=u*L+h*J+d*ne+m*j,o[1]=v*U+x*B+y*se+_*ve,o[5]=v*H+x*W+y*ce+_*ae,o[9]=v*V+x*ie+y*Y+_*re,o[13]=v*L+x*J+y*ne+_*j,o[2]=M*U+R*B+A*se+E*ve,o[6]=M*H+R*W+A*ce+E*ae,o[10]=M*V+R*ie+A*Y+E*re,o[14]=M*L+R*J+A*ne+E*j,o[3]=N*U+I*B+P*se+z*ve,o[7]=N*H+I*W+P*ce+z*ae,o[11]=N*V+I*ie+P*Y+z*re,o[15]=N*L+I*J+P*ne+z*j,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],o=e[12],u=e[1],h=e[5],d=e[9],m=e[13],v=e[2],x=e[6],y=e[10],_=e[14],M=e[3],R=e[7],A=e[11],E=e[15],N=d*_-m*y,I=h*_-m*x,P=h*y-d*x,z=u*_-m*v,U=u*y-d*v,H=u*x-h*v;return t*(R*N-A*I+E*P)-n*(M*N-A*z+E*U)+r*(M*I-R*z+E*H)-o*(M*P-R*U+A*H)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],o=e[3],u=e[4],h=e[5],d=e[6],m=e[7],v=e[8],x=e[9],y=e[10],_=e[11],M=e[12],R=e[13],A=e[14],E=e[15],N=x*A*m-R*y*m+R*d*_-h*A*_-x*d*E+h*y*E,I=M*y*m-v*A*m-M*d*_+u*A*_+v*d*E-u*y*E,P=v*R*m-M*x*m+M*h*_-u*R*_-v*h*E+u*x*E,z=M*x*d-v*R*d-M*h*y+u*R*y+v*h*A-u*x*A,U=t*N+n*I+r*P+o*z;if(U===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const H=1/U;return e[0]=N*H,e[1]=(R*y*o-x*A*o-R*r*_+n*A*_+x*r*E-n*y*E)*H,e[2]=(h*A*o-R*d*o+R*r*m-n*A*m-h*r*E+n*d*E)*H,e[3]=(x*d*o-h*y*o-x*r*m+n*y*m+h*r*_-n*d*_)*H,e[4]=I*H,e[5]=(v*A*o-M*y*o+M*r*_-t*A*_-v*r*E+t*y*E)*H,e[6]=(M*d*o-u*A*o-M*r*m+t*A*m+u*r*E-t*d*E)*H,e[7]=(u*y*o-v*d*o+v*r*m-t*y*m-u*r*_+t*d*_)*H,e[8]=P*H,e[9]=(M*x*o-v*R*o-M*n*_+t*R*_+v*n*E-t*x*E)*H,e[10]=(u*R*o-M*h*o+M*n*m-t*R*m-u*n*E+t*h*E)*H,e[11]=(v*h*o-u*x*o-v*n*m+t*x*m+u*n*_-t*h*_)*H,e[12]=z*H,e[13]=(v*R*r-M*x*r+M*n*y-t*R*y-v*n*A+t*x*A)*H,e[14]=(M*h*r-u*R*r-M*n*d+t*R*d+u*n*A-t*h*A)*H,e[15]=(u*x*r-v*h*r+v*n*d-t*x*d-u*n*y+t*h*y)*H,this}scale(e){const t=this.elements,n=e.x,r=e.y,o=e.z;return t[0]*=n,t[4]*=r,t[8]*=o,t[1]*=n,t[5]*=r,t[9]*=o,t[2]*=n,t[6]*=r,t[10]*=o,t[3]*=n,t[7]*=r,t[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),o=1-n,u=e.x,h=e.y,d=e.z,m=o*u,v=o*h;return this.set(m*u+n,m*h-r*d,m*d+r*h,0,m*h+r*d,v*h+n,v*d-r*u,0,m*d-r*h,v*d+r*u,o*d*d+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,o,u){return this.set(1,n,o,0,e,1,u,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,o=t._x,u=t._y,h=t._z,d=t._w,m=o+o,v=u+u,x=h+h,y=o*m,_=o*v,M=o*x,R=u*v,A=u*x,E=h*x,N=d*m,I=d*v,P=d*x,z=n.x,U=n.y,H=n.z;return r[0]=(1-(R+E))*z,r[1]=(_+P)*z,r[2]=(M-I)*z,r[3]=0,r[4]=(_-P)*U,r[5]=(1-(y+E))*U,r[6]=(A+N)*U,r[7]=0,r[8]=(M+I)*H,r[9]=(A-N)*H,r[10]=(1-(y+R))*H,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;if(e.x=r[12],e.y=r[13],e.z=r[14],this.determinant()===0)return n.set(1,1,1),t.identity(),this;let o=Lh.set(r[0],r[1],r[2]).length();const u=Lh.set(r[4],r[5],r[6]).length(),h=Lh.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),co.copy(this);const m=1/o,v=1/u,x=1/h;return co.elements[0]*=m,co.elements[1]*=m,co.elements[2]*=m,co.elements[4]*=v,co.elements[5]*=v,co.elements[6]*=v,co.elements[8]*=x,co.elements[9]*=x,co.elements[10]*=x,t.setFromRotationMatrix(co),n.x=o,n.y=u,n.z=h,this}makePerspective(e,t,n,r,o,u,h=aa,d=!1){const m=this.elements,v=2*o/(t-e),x=2*o/(n-r),y=(t+e)/(t-e),_=(n+r)/(n-r);let M,R;if(d)M=o/(u-o),R=u*o/(u-o);else if(h===aa)M=-(u+o)/(u-o),R=-2*u*o/(u-o);else if(h===cd)M=-u/(u-o),R=-u*o/(u-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+h);return m[0]=v,m[4]=0,m[8]=y,m[12]=0,m[1]=0,m[5]=x,m[9]=_,m[13]=0,m[2]=0,m[6]=0,m[10]=M,m[14]=R,m[3]=0,m[7]=0,m[11]=-1,m[15]=0,this}makeOrthographic(e,t,n,r,o,u,h=aa,d=!1){const m=this.elements,v=2/(t-e),x=2/(n-r),y=-(t+e)/(t-e),_=-(n+r)/(n-r);let M,R;if(d)M=1/(u-o),R=u/(u-o);else if(h===aa)M=-2/(u-o),R=-(u+o)/(u-o);else if(h===cd)M=-1/(u-o),R=-o/(u-o);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+h);return m[0]=v,m[4]=0,m[8]=0,m[12]=y,m[1]=0,m[5]=x,m[9]=0,m[13]=_,m[2]=0,m[6]=0,m[10]=M,m[14]=R,m[3]=0,m[7]=0,m[11]=0,m[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const Lh=new Q,co=new cn,AC=new Q(0,0,0),CC=new Q(1,1,1),Oc=new Q,Zg=new Q,ia=new Q,ZS=new cn,KS=new as;class ua{constructor(e=0,t=0,n=0,r=ua.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,o=r[0],u=r[4],h=r[8],d=r[1],m=r[5],v=r[9],x=r[2],y=r[6],_=r[10];switch(t){case"XYZ":this._y=Math.asin(on(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-v,_),this._z=Math.atan2(-u,o)):(this._x=Math.atan2(y,m),this._z=0);break;case"YXZ":this._x=Math.asin(-on(v,-1,1)),Math.abs(v)<.9999999?(this._y=Math.atan2(h,_),this._z=Math.atan2(d,m)):(this._y=Math.atan2(-x,o),this._z=0);break;case"ZXY":this._x=Math.asin(on(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(-x,_),this._z=Math.atan2(-u,m)):(this._y=0,this._z=Math.atan2(d,o));break;case"ZYX":this._y=Math.asin(-on(x,-1,1)),Math.abs(x)<.9999999?(this._x=Math.atan2(y,_),this._z=Math.atan2(d,o)):(this._x=0,this._z=Math.atan2(-u,m));break;case"YZX":this._z=Math.asin(on(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-v,m),this._y=Math.atan2(-x,o)):(this._x=0,this._y=Math.atan2(h,_));break;case"XZY":this._z=Math.asin(-on(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(y,m),this._y=Math.atan2(h,o)):(this._x=Math.atan2(-v,_),this._y=0);break;default:zt("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return ZS.makeRotationFromQuaternion(e),this.setFromRotationMatrix(ZS,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return KS.setFromEuler(this),this.setFromQuaternion(KS,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ua.DEFAULT_ORDER="XYZ";class hd{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let RC=0;const QS=new Q,Ph=new as,Pl=new cn,Kg=new Q,$p=new Q,NC=new Q,DC=new as,JS=new Q(1,0,0),$S=new Q(0,1,0),eM=new Q(0,0,1),tM={type:"added"},IC={type:"removed"},Uh={type:"childadded",child:null},Tb={type:"childremoved",child:null};class Nn extends el{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:RC++}),this.uuid=oa(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Nn.DEFAULT_UP.clone();const e=new Q,t=new ua,n=new as,r=new Q(1,1,1);function o(){n.setFromEuler(t,!1)}function u(){t.setFromQuaternion(n,void 0,!1)}t._onChange(o),n._onChange(u),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new cn},normalMatrix:{value:new bn}}),this.matrix=new cn,this.matrixWorld=new cn,this.matrixAutoUpdate=Nn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Nn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new hd,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Ph.setFromAxisAngle(e,t),this.quaternion.multiply(Ph),this}rotateOnWorldAxis(e,t){return Ph.setFromAxisAngle(e,t),this.quaternion.premultiply(Ph),this}rotateX(e){return this.rotateOnAxis(JS,e)}rotateY(e){return this.rotateOnAxis($S,e)}rotateZ(e){return this.rotateOnAxis(eM,e)}translateOnAxis(e,t){return QS.copy(e).applyQuaternion(this.quaternion),this.position.add(QS.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(JS,e)}translateY(e){return this.translateOnAxis($S,e)}translateZ(e){return this.translateOnAxis(eM,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Pl.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Kg.copy(e):Kg.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),$p.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Pl.lookAt($p,Kg,this.up):Pl.lookAt(Kg,$p,this.up),this.quaternion.setFromRotationMatrix(Pl),r&&(Pl.extractRotation(r.matrixWorld),Ph.setFromRotationMatrix(Pl),this.quaternion.premultiply(Ph.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(Qt("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(tM),Uh.child=e,this.dispatchEvent(Uh),Uh.child=null):Qt("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(IC),Tb.child=e,this.dispatchEvent(Tb),Tb.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Pl.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Pl.multiply(e.parent.matrixWorld)),e.applyMatrix4(Pl),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(tM),Uh.child=e,this.dispatchEvent(Uh),Uh.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const u=this.children[n].getObjectByProperty(e,t);if(u!==void 0)return u}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let o=0,u=r.length;o<u;o++)r[o].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose($p,e,NC),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose($p,DC,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let o=0,u=r.length;o<u;o++)r[o].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(h=>({...h,boundingBox:h.boundingBox?h.boundingBox.toJSON():void 0,boundingSphere:h.boundingSphere?h.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(h=>({...h})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(r.boundingBox=this.boundingBox.toJSON()));function o(h,d){return h[d.uuid]===void 0&&(h[d.uuid]=d.toJSON(e)),d.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=o(e.geometries,this.geometry);const h=this.geometry.parameters;if(h!==void 0&&h.shapes!==void 0){const d=h.shapes;if(Array.isArray(d))for(let m=0,v=d.length;m<v;m++){const x=d[m];o(e.shapes,x)}else o(e.shapes,d)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const h=[];for(let d=0,m=this.material.length;d<m;d++)h.push(o(e.materials,this.material[d]));r.material=h}else r.material=o(e.materials,this.material);if(this.children.length>0){r.children=[];for(let h=0;h<this.children.length;h++)r.children.push(this.children[h].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let h=0;h<this.animations.length;h++){const d=this.animations[h];r.animations.push(o(e.animations,d))}}if(t){const h=u(e.geometries),d=u(e.materials),m=u(e.textures),v=u(e.images),x=u(e.shapes),y=u(e.skeletons),_=u(e.animations),M=u(e.nodes);h.length>0&&(n.geometries=h),d.length>0&&(n.materials=d),m.length>0&&(n.textures=m),v.length>0&&(n.images=v),x.length>0&&(n.shapes=x),y.length>0&&(n.skeletons=y),_.length>0&&(n.animations=_),M.length>0&&(n.nodes=M)}return n.object=r,n;function u(h){const d=[];for(const m in h){const v=h[m];delete v.metadata,d.push(v)}return d}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}}Nn.DEFAULT_UP=new Q(0,1,0);Nn.DEFAULT_MATRIX_AUTO_UPDATE=!0;Nn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const uo=new Q,Ul=new Q,wb=new Q,Ol=new Q,Oh=new Q,zh=new Q,nM=new Q,Ab=new Q,Cb=new Q,Rb=new Q,Nb=new hi,Db=new hi,Ib=new hi;class Qs{constructor(e=new Q,t=new Q,n=new Q){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),uo.subVectors(e,t),r.cross(uo);const o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}static getBarycoord(e,t,n,r,o){uo.subVectors(r,t),Ul.subVectors(n,t),wb.subVectors(e,t);const u=uo.dot(uo),h=uo.dot(Ul),d=uo.dot(wb),m=Ul.dot(Ul),v=Ul.dot(wb),x=u*m-h*h;if(x===0)return o.set(0,0,0),null;const y=1/x,_=(m*d-h*v)*y,M=(u*v-h*d)*y;return o.set(1-_-M,M,_)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,Ol)===null?!1:Ol.x>=0&&Ol.y>=0&&Ol.x+Ol.y<=1}static getInterpolation(e,t,n,r,o,u,h,d){return this.getBarycoord(e,t,n,r,Ol)===null?(d.x=0,d.y=0,"z"in d&&(d.z=0),"w"in d&&(d.w=0),null):(d.setScalar(0),d.addScaledVector(o,Ol.x),d.addScaledVector(u,Ol.y),d.addScaledVector(h,Ol.z),d)}static getInterpolatedAttribute(e,t,n,r,o,u){return Nb.setScalar(0),Db.setScalar(0),Ib.setScalar(0),Nb.fromBufferAttribute(e,t),Db.fromBufferAttribute(e,n),Ib.fromBufferAttribute(e,r),u.setScalar(0),u.addScaledVector(Nb,o.x),u.addScaledVector(Db,o.y),u.addScaledVector(Ib,o.z),u}static isFrontFacing(e,t,n,r){return uo.subVectors(n,t),Ul.subVectors(e,t),uo.cross(Ul).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return uo.subVectors(this.c,this.b),Ul.subVectors(this.a,this.b),uo.cross(Ul).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Qs.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Qs.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,o){return Qs.getInterpolation(e,this.a,this.b,this.c,t,n,r,o)}containsPoint(e){return Qs.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Qs.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,o=this.c;let u,h;Oh.subVectors(r,n),zh.subVectors(o,n),Ab.subVectors(e,n);const d=Oh.dot(Ab),m=zh.dot(Ab);if(d<=0&&m<=0)return t.copy(n);Cb.subVectors(e,r);const v=Oh.dot(Cb),x=zh.dot(Cb);if(v>=0&&x<=v)return t.copy(r);const y=d*x-v*m;if(y<=0&&d>=0&&v<=0)return u=d/(d-v),t.copy(n).addScaledVector(Oh,u);Rb.subVectors(e,o);const _=Oh.dot(Rb),M=zh.dot(Rb);if(M>=0&&_<=M)return t.copy(o);const R=_*m-d*M;if(R<=0&&m>=0&&M<=0)return h=m/(m-M),t.copy(n).addScaledVector(zh,h);const A=v*M-_*x;if(A<=0&&x-v>=0&&_-M>=0)return nM.subVectors(o,r),h=(x-v)/(x-v+(_-M)),t.copy(r).addScaledVector(nM,h);const E=1/(A+R+y);return u=R*E,h=y*E,t.copy(n).addScaledVector(Oh,u).addScaledVector(zh,h)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const HT={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},zc={h:0,s:0,l:0},Qg={h:0,s:0,l:0};function Lb(s,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?s+(e-s)*6*t:t<1/2?e:t<2/3?s+(e-s)*6*(2/3-t):s}class Lt{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Gr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,kn.colorSpaceToWorking(this,t),this}setRGB(e,t,n,r=kn.workingColorSpace){return this.r=e,this.g=t,this.b=n,kn.colorSpaceToWorking(this,r),this}setHSL(e,t,n,r=kn.workingColorSpace){if(e=a1(e,1),t=on(t,0,1),n=on(n,0,1),t===0)this.r=this.g=this.b=n;else{const o=n<=.5?n*(1+t):n+t-n*t,u=2*n-o;this.r=Lb(u,o,e+1/3),this.g=Lb(u,o,e),this.b=Lb(u,o,e-1/3)}return kn.colorSpaceToWorking(this,r),this}setStyle(e,t=Gr){function n(o){o!==void 0&&parseFloat(o)<1&&zt("Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let o;const u=r[1],h=r[2];switch(u){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return n(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,t);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return n(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,t);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return n(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,t);break;default:zt("Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const o=r[1],u=o.length;if(u===3)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,t);if(u===6)return this.setHex(parseInt(o,16),t);zt("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Gr){const n=HT[e.toLowerCase()];return n!==void 0?this.setHex(n,t):zt("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=kl(e.r),this.g=kl(e.g),this.b=kl(e.b),this}copyLinearToSRGB(e){return this.r=rd(e.r),this.g=rd(e.g),this.b=rd(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Gr){return kn.workingToColorSpace(is.copy(this),e),Math.round(on(is.r*255,0,255))*65536+Math.round(on(is.g*255,0,255))*256+Math.round(on(is.b*255,0,255))}getHexString(e=Gr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=kn.workingColorSpace){kn.workingToColorSpace(is.copy(this),t);const n=is.r,r=is.g,o=is.b,u=Math.max(n,r,o),h=Math.min(n,r,o);let d,m;const v=(h+u)/2;if(h===u)d=0,m=0;else{const x=u-h;switch(m=v<=.5?x/(u+h):x/(2-u-h),u){case n:d=(r-o)/x+(r<o?6:0);break;case r:d=(o-n)/x+2;break;case o:d=(n-r)/x+4;break}d/=6}return e.h=d,e.s=m,e.l=v,e}getRGB(e,t=kn.workingColorSpace){return kn.workingToColorSpace(is.copy(this),t),e.r=is.r,e.g=is.g,e.b=is.b,e}getStyle(e=Gr){kn.workingToColorSpace(is.copy(this),e);const t=is.r,n=is.g,r=is.b;return e!==Gr?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(zc),this.setHSL(zc.h+e,zc.s+t,zc.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(zc),e.getHSL(Qg);const n=_m(zc.h,Qg.h,t),r=_m(zc.s,Qg.s,t),o=_m(zc.l,Qg.l,t);return this.setHSL(n,r,o),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,o=e.elements;return this.r=o[0]*t+o[3]*n+o[6]*r,this.g=o[1]*t+o[4]*n+o[7]*r,this.b=o[2]*t+o[5]*n+o[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const is=new Lt;Lt.NAMES=HT;let LC=0;class cs extends el{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:LC++}),this.uuid=oa(),this.name="",this.type="Material",this.blending=uf,this.side=Hl,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Gv,this.blendDst=jv,this.blendEquation=Vc,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Lt(0,0,0),this.blendAlpha=0,this.depthFunc=df,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=E_,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=tf,this.stencilZFail=tf,this.stencilZPass=tf,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){zt(`Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){zt(`Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==uf&&(n.blending=this.blending),this.side!==Hl&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==Gv&&(n.blendSrc=this.blendSrc),this.blendDst!==jv&&(n.blendDst=this.blendDst),this.blendEquation!==Vc&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==df&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==E_&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==tf&&(n.stencilFail=this.stencilFail),this.stencilZFail!==tf&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==tf&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.allowOverride===!1&&(n.allowOverride=!1),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(o){const u=[];for(const h in o){const d=o[h];delete d.metadata,u.push(d)}return u}if(t){const o=r(e.textures),u=r(e.images);o.length>0&&(n.textures=o),u.length>0&&(n.images=u)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const r=t.length;n=new Array(r);for(let o=0;o!==r;++o)n[o]=t[o].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Gl extends cs{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Lt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ua,this.combine=Wm,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Fl=PC();function PC(){const s=new ArrayBuffer(4),e=new Float32Array(s),t=new Uint32Array(s),n=new Uint32Array(512),r=new Uint32Array(512);for(let d=0;d<256;++d){const m=d-127;m<-27?(n[d]=0,n[d|256]=32768,r[d]=24,r[d|256]=24):m<-14?(n[d]=1024>>-m-14,n[d|256]=1024>>-m-14|32768,r[d]=-m-1,r[d|256]=-m-1):m<=15?(n[d]=m+15<<10,n[d|256]=m+15<<10|32768,r[d]=13,r[d|256]=13):m<128?(n[d]=31744,n[d|256]=64512,r[d]=24,r[d|256]=24):(n[d]=31744,n[d|256]=64512,r[d]=13,r[d|256]=13)}const o=new Uint32Array(2048),u=new Uint32Array(64),h=new Uint32Array(64);for(let d=1;d<1024;++d){let m=d<<13,v=0;for(;(m&8388608)===0;)m<<=1,v-=8388608;m&=-8388609,v+=947912704,o[d]=m|v}for(let d=1024;d<2048;++d)o[d]=939524096+(d-1024<<13);for(let d=1;d<31;++d)u[d]=d<<23;u[31]=1199570944,u[32]=2147483648;for(let d=33;d<63;++d)u[d]=2147483648+(d-32<<23);u[63]=3347054592;for(let d=1;d<64;++d)d!==32&&(h[d]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:o,exponentTable:u,offsetTable:h}}function Zs(s){Math.abs(s)>65504&&zt("DataUtils.toHalfFloat(): Value out of range."),s=on(s,-65504,65504),Fl.floatView[0]=s;const e=Fl.uint32View[0],t=e>>23&511;return Fl.baseTable[t]+((e&8388607)>>Fl.shiftTable[t])}function hm(s){const e=s>>10;return Fl.uint32View[0]=Fl.mantissaTable[Fl.offsetTable[e]+(s&1023)]+Fl.exponentTable[e],Fl.floatView[0]}class of{static toHalfFloat(e){return Zs(e)}static fromHalfFloat(e){return hm(e)}}const gr=new Q,Jg=new Je;let UC=0;class li{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:UC++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=Im,this.updateRanges=[],this.gpuType=Li,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,o=this.itemSize;r<o;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)Jg.fromBufferAttribute(this,t),Jg.applyMatrix3(e),this.setXY(t,Jg.x,Jg.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)gr.fromBufferAttribute(this,t),gr.applyMatrix3(e),this.setXYZ(t,gr.x,gr.y,gr.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)gr.fromBufferAttribute(this,t),gr.applyMatrix4(e),this.setXYZ(t,gr.x,gr.y,gr.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)gr.fromBufferAttribute(this,t),gr.applyNormalMatrix(e),this.setXYZ(t,gr.x,gr.y,gr.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)gr.fromBufferAttribute(this,t),gr.transformDirection(e),this.setXYZ(t,gr.x,gr.y,gr.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=Es(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=En(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Es(t,this.array)),t}setX(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Es(t,this.array)),t}setY(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Es(t,this.array)),t}setZ(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Es(t,this.array)),t}setW(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),n=En(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),n=En(n,this.array),r=En(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,o){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),n=En(n,this.array),r=En(r,this.array),o=En(o,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Im&&(e.usage=this.usage),e}}class OC extends li{constructor(e,t,n){super(new Int8Array(e),t,n)}}class zC extends li{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class BC extends li{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class FC extends li{constructor(e,t,n){super(new Int16Array(e),t,n)}}class l1 extends li{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class kC extends li{constructor(e,t,n){super(new Int32Array(e),t,n)}}class c1 extends li{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class VC extends li{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=hm(this.array[e*this.itemSize]);return this.normalized&&(t=Es(t,this.array)),t}setX(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize]=Zs(t),this}getY(e){let t=hm(this.array[e*this.itemSize+1]);return this.normalized&&(t=Es(t,this.array)),t}setY(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+1]=Zs(t),this}getZ(e){let t=hm(this.array[e*this.itemSize+2]);return this.normalized&&(t=Es(t,this.array)),t}setZ(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+2]=Zs(t),this}getW(e){let t=hm(this.array[e*this.itemSize+3]);return this.normalized&&(t=Es(t,this.array)),t}setW(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+3]=Zs(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),n=En(n,this.array)),this.array[e+0]=Zs(t),this.array[e+1]=Zs(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),n=En(n,this.array),r=En(r,this.array)),this.array[e+0]=Zs(t),this.array[e+1]=Zs(n),this.array[e+2]=Zs(r),this}setXYZW(e,t,n,r,o){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),n=En(n,this.array),r=En(r,this.array),o=En(o,this.array)),this.array[e+0]=Zs(t),this.array[e+1]=Zs(n),this.array[e+2]=Zs(r),this.array[e+3]=Zs(o),this}}class Wt extends li{constructor(e,t,n){super(new Float32Array(e),t,n)}}let HC=0;const Ba=new cn,Pb=new Nn,Bh=new Q,ra=new os,em=new os,Nr=new Q;class vn extends el{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:HC++}),this.uuid=oa(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(BT(e)?c1:l1)(e,1):this.index=e,this}setIndirect(e,t=0){return this.indirect=e,this.indirectOffset=t,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const o=new bn().getNormalMatrix(e);n.applyNormalMatrix(o),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Ba.makeRotationFromQuaternion(e),this.applyMatrix4(Ba),this}rotateX(e){return Ba.makeRotationX(e),this.applyMatrix4(Ba),this}rotateY(e){return Ba.makeRotationY(e),this.applyMatrix4(Ba),this}rotateZ(e){return Ba.makeRotationZ(e),this.applyMatrix4(Ba),this}translate(e,t,n){return Ba.makeTranslation(e,t,n),this.applyMatrix4(Ba),this}scale(e,t,n){return Ba.makeScale(e,t,n),this.applyMatrix4(Ba),this}lookAt(e){return Pb.lookAt(e),Pb.updateMatrix(),this.applyMatrix4(Pb.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Bh).negate(),this.translate(Bh.x,Bh.y,Bh.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let r=0,o=e.length;r<o;r++){const u=e[r];n.push(u.x,u.y,u.z||0)}this.setAttribute("position",new Wt(n,3))}else{const n=Math.min(e.length,t.count);for(let r=0;r<n;r++){const o=e[r];t.setXYZ(r,o.x,o.y,o.z||0)}e.length>t.count&&zt("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new os);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Qt("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Q(-1/0,-1/0,-1/0),new Q(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const o=t[n];ra.setFromBufferAttribute(o),this.morphTargetsRelative?(Nr.addVectors(this.boundingBox.min,ra.min),this.boundingBox.expandByPoint(Nr),Nr.addVectors(this.boundingBox.max,ra.max),this.boundingBox.expandByPoint(Nr)):(this.boundingBox.expandByPoint(ra.min),this.boundingBox.expandByPoint(ra.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&Qt('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new jr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Qt("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Q,1/0);return}if(e){const n=this.boundingSphere.center;if(ra.setFromBufferAttribute(e),t)for(let o=0,u=t.length;o<u;o++){const h=t[o];em.setFromBufferAttribute(h),this.morphTargetsRelative?(Nr.addVectors(ra.min,em.min),ra.expandByPoint(Nr),Nr.addVectors(ra.max,em.max),ra.expandByPoint(Nr)):(ra.expandByPoint(em.min),ra.expandByPoint(em.max))}ra.getCenter(n);let r=0;for(let o=0,u=e.count;o<u;o++)Nr.fromBufferAttribute(e,o),r=Math.max(r,n.distanceToSquared(Nr));if(t)for(let o=0,u=t.length;o<u;o++){const h=t[o],d=this.morphTargetsRelative;for(let m=0,v=h.count;m<v;m++)Nr.fromBufferAttribute(h,m),d&&(Bh.fromBufferAttribute(e,m),Nr.add(Bh)),r=Math.max(r,n.distanceToSquared(Nr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&Qt('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){Qt("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,r=t.normal,o=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new li(new Float32Array(4*n.count),4));const u=this.getAttribute("tangent"),h=[],d=[];for(let V=0;V<n.count;V++)h[V]=new Q,d[V]=new Q;const m=new Q,v=new Q,x=new Q,y=new Je,_=new Je,M=new Je,R=new Q,A=new Q;function E(V,L,B){m.fromBufferAttribute(n,V),v.fromBufferAttribute(n,L),x.fromBufferAttribute(n,B),y.fromBufferAttribute(o,V),_.fromBufferAttribute(o,L),M.fromBufferAttribute(o,B),v.sub(m),x.sub(m),_.sub(y),M.sub(y);const W=1/(_.x*M.y-M.x*_.y);isFinite(W)&&(R.copy(v).multiplyScalar(M.y).addScaledVector(x,-_.y).multiplyScalar(W),A.copy(x).multiplyScalar(_.x).addScaledVector(v,-M.x).multiplyScalar(W),h[V].add(R),h[L].add(R),h[B].add(R),d[V].add(A),d[L].add(A),d[B].add(A))}let N=this.groups;N.length===0&&(N=[{start:0,count:e.count}]);for(let V=0,L=N.length;V<L;++V){const B=N[V],W=B.start,ie=B.count;for(let J=W,se=W+ie;J<se;J+=3)E(e.getX(J+0),e.getX(J+1),e.getX(J+2))}const I=new Q,P=new Q,z=new Q,U=new Q;function H(V){z.fromBufferAttribute(r,V),U.copy(z);const L=h[V];I.copy(L),I.sub(z.multiplyScalar(z.dot(L))).normalize(),P.crossVectors(U,L);const W=P.dot(d[V])<0?-1:1;u.setXYZW(V,I.x,I.y,I.z,W)}for(let V=0,L=N.length;V<L;++V){const B=N[V],W=B.start,ie=B.count;for(let J=W,se=W+ie;J<se;J+=3)H(e.getX(J+0)),H(e.getX(J+1)),H(e.getX(J+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new li(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let y=0,_=n.count;y<_;y++)n.setXYZ(y,0,0,0);const r=new Q,o=new Q,u=new Q,h=new Q,d=new Q,m=new Q,v=new Q,x=new Q;if(e)for(let y=0,_=e.count;y<_;y+=3){const M=e.getX(y+0),R=e.getX(y+1),A=e.getX(y+2);r.fromBufferAttribute(t,M),o.fromBufferAttribute(t,R),u.fromBufferAttribute(t,A),v.subVectors(u,o),x.subVectors(r,o),v.cross(x),h.fromBufferAttribute(n,M),d.fromBufferAttribute(n,R),m.fromBufferAttribute(n,A),h.add(v),d.add(v),m.add(v),n.setXYZ(M,h.x,h.y,h.z),n.setXYZ(R,d.x,d.y,d.z),n.setXYZ(A,m.x,m.y,m.z)}else for(let y=0,_=t.count;y<_;y+=3)r.fromBufferAttribute(t,y+0),o.fromBufferAttribute(t,y+1),u.fromBufferAttribute(t,y+2),v.subVectors(u,o),x.subVectors(r,o),v.cross(x),n.setXYZ(y+0,v.x,v.y,v.z),n.setXYZ(y+1,v.x,v.y,v.z),n.setXYZ(y+2,v.x,v.y,v.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Nr.fromBufferAttribute(e,t),Nr.normalize(),e.setXYZ(t,Nr.x,Nr.y,Nr.z)}toNonIndexed(){function e(h,d){const m=h.array,v=h.itemSize,x=h.normalized,y=new m.constructor(d.length*v);let _=0,M=0;for(let R=0,A=d.length;R<A;R++){h.isInterleavedBufferAttribute?_=d[R]*h.data.stride+h.offset:_=d[R]*v;for(let E=0;E<v;E++)y[M++]=m[_++]}return new li(y,v,x)}if(this.index===null)return zt("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new vn,n=this.index.array,r=this.attributes;for(const h in r){const d=r[h],m=e(d,n);t.setAttribute(h,m)}const o=this.morphAttributes;for(const h in o){const d=[],m=o[h];for(let v=0,x=m.length;v<x;v++){const y=m[v],_=e(y,n);d.push(_)}t.morphAttributes[h]=d}t.morphTargetsRelative=this.morphTargetsRelative;const u=this.groups;for(let h=0,d=u.length;h<d;h++){const m=u[h];t.addGroup(m.start,m.count,m.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const d=this.parameters;for(const m in d)d[m]!==void 0&&(e[m]=d[m]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const d in n){const m=n[d];e.data.attributes[d]=m.toJSON(e.data)}const r={};let o=!1;for(const d in this.morphAttributes){const m=this.morphAttributes[d],v=[];for(let x=0,y=m.length;x<y;x++){const _=m[x];v.push(_.toJSON(e.data))}v.length>0&&(r[d]=v,o=!0)}o&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const u=this.groups;u.length>0&&(e.data.groups=JSON.parse(JSON.stringify(u)));const h=this.boundingSphere;return h!==null&&(e.data.boundingSphere=h.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const r=e.attributes;for(const m in r){const v=r[m];this.setAttribute(m,v.clone(t))}const o=e.morphAttributes;for(const m in o){const v=[],x=o[m];for(let y=0,_=x.length;y<_;y++)v.push(x[y].clone(t));this.morphAttributes[m]=v}this.morphTargetsRelative=e.morphTargetsRelative;const u=e.groups;for(let m=0,v=u.length;m<v;m++){const x=u[m];this.addGroup(x.start,x.count,x.materialIndex)}const h=e.boundingBox;h!==null&&(this.boundingBox=h.clone());const d=e.boundingSphere;return d!==null&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const iM=new cn,Vu=new yf,$g=new jr,rM=new Q,ev=new Q,tv=new Q,nv=new Q,Ub=new Q,iv=new Q,sM=new Q,rv=new Q;class Gi extends Nn{constructor(e=new vn,t=new Gl){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,u=r.length;o<u;o++){const h=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=o}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,o=n.morphAttributes.position,u=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const h=this.morphTargetInfluences;if(o&&h){iv.set(0,0,0);for(let d=0,m=o.length;d<m;d++){const v=h[d],x=o[d];v!==0&&(Ub.fromBufferAttribute(x,e),u?iv.addScaledVector(Ub,v):iv.addScaledVector(Ub.sub(t),v))}t.add(iv)}return t}raycast(e,t){const n=this.geometry,r=this.material,o=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),$g.copy(n.boundingSphere),$g.applyMatrix4(o),Vu.copy(e.ray).recast(e.near),!($g.containsPoint(Vu.origin)===!1&&(Vu.intersectSphere($g,rM)===null||Vu.origin.distanceToSquared(rM)>(e.far-e.near)**2))&&(iM.copy(o).invert(),Vu.copy(e.ray).applyMatrix4(iM),!(n.boundingBox!==null&&Vu.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,Vu)))}_computeIntersections(e,t,n){let r;const o=this.geometry,u=this.material,h=o.index,d=o.attributes.position,m=o.attributes.uv,v=o.attributes.uv1,x=o.attributes.normal,y=o.groups,_=o.drawRange;if(h!==null)if(Array.isArray(u))for(let M=0,R=y.length;M<R;M++){const A=y[M],E=u[A.materialIndex],N=Math.max(A.start,_.start),I=Math.min(h.count,Math.min(A.start+A.count,_.start+_.count));for(let P=N,z=I;P<z;P+=3){const U=h.getX(P),H=h.getX(P+1),V=h.getX(P+2);r=sv(this,E,e,n,m,v,x,U,H,V),r&&(r.faceIndex=Math.floor(P/3),r.face.materialIndex=A.materialIndex,t.push(r))}}else{const M=Math.max(0,_.start),R=Math.min(h.count,_.start+_.count);for(let A=M,E=R;A<E;A+=3){const N=h.getX(A),I=h.getX(A+1),P=h.getX(A+2);r=sv(this,u,e,n,m,v,x,N,I,P),r&&(r.faceIndex=Math.floor(A/3),t.push(r))}}else if(d!==void 0)if(Array.isArray(u))for(let M=0,R=y.length;M<R;M++){const A=y[M],E=u[A.materialIndex],N=Math.max(A.start,_.start),I=Math.min(d.count,Math.min(A.start+A.count,_.start+_.count));for(let P=N,z=I;P<z;P+=3){const U=P,H=P+1,V=P+2;r=sv(this,E,e,n,m,v,x,U,H,V),r&&(r.faceIndex=Math.floor(P/3),r.face.materialIndex=A.materialIndex,t.push(r))}}else{const M=Math.max(0,_.start),R=Math.min(d.count,_.start+_.count);for(let A=M,E=R;A<E;A+=3){const N=A,I=A+1,P=A+2;r=sv(this,u,e,n,m,v,x,N,I,P),r&&(r.faceIndex=Math.floor(A/3),t.push(r))}}}}function GC(s,e,t,n,r,o,u,h){let d;if(e.side===ss?d=n.intersectTriangle(u,o,r,!0,h):d=n.intersectTriangle(r,o,u,e.side===Hl,h),d===null)return null;rv.copy(h),rv.applyMatrix4(s.matrixWorld);const m=t.ray.origin.distanceTo(rv);return m<t.near||m>t.far?null:{distance:m,point:rv.clone(),object:s}}function sv(s,e,t,n,r,o,u,h,d,m){s.getVertexPosition(h,ev),s.getVertexPosition(d,tv),s.getVertexPosition(m,nv);const v=GC(s,e,t,n,ev,tv,nv,sM);if(v){const x=new Q;Qs.getBarycoord(sM,ev,tv,nv,x),r&&(v.uv=Qs.getInterpolatedAttribute(r,h,d,m,x,new Je)),o&&(v.uv1=Qs.getInterpolatedAttribute(o,h,d,m,x,new Je)),u&&(v.normal=Qs.getInterpolatedAttribute(u,h,d,m,x,new Q),v.normal.dot(n.direction)>0&&v.normal.multiplyScalar(-1));const y={a:h,b:d,c:m,normal:new Q,materialIndex:0};Qs.getNormal(ev,tv,nv,y.normal),v.face=y,v.barycoord=x}return v}class bf extends vn{constructor(e=1,t=1,n=1,r=1,o=1,u=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:o,depthSegments:u};const h=this;r=Math.floor(r),o=Math.floor(o),u=Math.floor(u);const d=[],m=[],v=[],x=[];let y=0,_=0;M("z","y","x",-1,-1,n,t,e,u,o,0),M("z","y","x",1,-1,n,t,-e,u,o,1),M("x","z","y",1,1,e,n,t,r,u,2),M("x","z","y",1,-1,e,n,-t,r,u,3),M("x","y","z",1,-1,e,t,n,r,o,4),M("x","y","z",-1,-1,e,t,-n,r,o,5),this.setIndex(d),this.setAttribute("position",new Wt(m,3)),this.setAttribute("normal",new Wt(v,3)),this.setAttribute("uv",new Wt(x,2));function M(R,A,E,N,I,P,z,U,H,V,L){const B=P/H,W=z/V,ie=P/2,J=z/2,se=U/2,ce=H+1,Y=V+1;let ne=0,ve=0;const ae=new Q;for(let re=0;re<Y;re++){const j=re*W-J;for(let le=0;le<ce;le++){const Me=le*B-ie;ae[R]=Me*N,ae[A]=j*I,ae[E]=se,m.push(ae.x,ae.y,ae.z),ae[R]=0,ae[A]=0,ae[E]=U>0?1:-1,v.push(ae.x,ae.y,ae.z),x.push(le/H),x.push(1-re/V),ne+=1}}for(let re=0;re<V;re++)for(let j=0;j<H;j++){const le=y+j+ce*re,Me=y+j+ce*(re+1),Ue=y+(j+1)+ce*(re+1),lt=y+(j+1)+ce*re;d.push(le,Me,lt),d.push(Me,Ue,lt),ve+=6}h.addGroup(_,ve,L),_+=ve,y+=ne}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new bf(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function dd(s){const e={};for(const t in s){e[t]={};for(const n in s[t]){const r=s[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(zt("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function Ss(s){const e={};for(let t=0;t<s.length;t++){const n=dd(s[t]);for(const r in n)e[r]=n[r]}return e}function jC(s){const e=[];for(let t=0;t<s.length;t++)e.push(s[t].clone());return e}function GT(s){const e=s.getRenderTarget();return e===null?s.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:kn.workingColorSpace}const u1={clone:dd,merge:Ss};var WC=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,XC=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ls extends cs{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=WC,this.fragmentShader=XC,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=dd(e.uniforms),this.uniformsGroups=jC(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const u=this.uniforms[r].value;u&&u.isTexture?t.uniforms[r]={type:"t",value:u.toJSON(e).uuid}:u&&u.isColor?t.uniforms[r]={type:"c",value:u.getHex()}:u&&u.isVector2?t.uniforms[r]={type:"v2",value:u.toArray()}:u&&u.isVector3?t.uniforms[r]={type:"v3",value:u.toArray()}:u&&u.isVector4?t.uniforms[r]={type:"v4",value:u.toArray()}:u&&u.isMatrix3?t.uniforms[r]={type:"m3",value:u.toArray()}:u&&u.isMatrix4?t.uniforms[r]={type:"m4",value:u.toArray()}:t.uniforms[r]={value:u}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class ty extends Nn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new cn,this.projectionMatrix=new cn,this.projectionMatrixInverse=new cn,this.coordinateSystem=aa,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Bc=new Q,aM=new Je,oM=new Je;class Vi extends ty{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=fd*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(ff*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return fd*2*Math.atan(Math.tan(ff*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Bc.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Bc.x,Bc.y).multiplyScalar(-e/Bc.z),Bc.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Bc.x,Bc.y).multiplyScalar(-e/Bc.z)}getViewSize(e,t){return this.getViewBounds(e,aM,oM),t.subVectors(oM,aM)}setViewOffset(e,t,n,r,o,u){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=o,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(ff*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,o=-.5*r;const u=this.view;if(this.view!==null&&this.view.enabled){const d=u.fullWidth,m=u.fullHeight;o+=u.offsetX*r/d,t-=u.offsetY*n/m,r*=u.width/d,n*=u.height/m}const h=this.filmOffset;h!==0&&(o+=e*h/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+r,t,t-n,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Fh=-90,kh=1;class jT extends Nn{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Vi(Fh,kh,e,t);r.layers=this.layers,this.add(r);const o=new Vi(Fh,kh,e,t);o.layers=this.layers,this.add(o);const u=new Vi(Fh,kh,e,t);u.layers=this.layers,this.add(u);const h=new Vi(Fh,kh,e,t);h.layers=this.layers,this.add(h);const d=new Vi(Fh,kh,e,t);d.layers=this.layers,this.add(d);const m=new Vi(Fh,kh,e,t);m.layers=this.layers,this.add(m)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,o,u,h,d]=t;for(const m of t)this.remove(m);if(e===aa)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),u.up.set(0,0,1),u.lookAt(0,-1,0),h.up.set(0,1,0),h.lookAt(0,0,1),d.up.set(0,1,0),d.lookAt(0,0,-1);else if(e===cd)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),u.up.set(0,0,-1),u.lookAt(0,-1,0),h.up.set(0,-1,0),h.lookAt(0,0,1),d.up.set(0,-1,0),d.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const m of t)this.add(m),m.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[o,u,h,d,m,v]=this.children,x=e.getRenderTarget(),y=e.getActiveCubeFace(),_=e.getActiveMipmapLevel(),M=e.xr.enabled;e.xr.enabled=!1;const R=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,o),e.setRenderTarget(n,1,r),e.render(t,u),e.setRenderTarget(n,2,r),e.render(t,h),e.setRenderTarget(n,3,r),e.render(t,d),e.setRenderTarget(n,4,r),e.render(t,m),n.texture.generateMipmaps=R,e.setRenderTarget(n,5,r),e.render(t,v),e.setRenderTarget(x,y,_),e.xr.enabled=M,n.texture.needsPMREMUpdate=!0}}class Zm extends oi{constructor(e=[],t=go,n,r,o,u,h,d,m,v){super(e,t,n,r,o,u,h,d,m,v),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class ny extends Ts{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new Zm(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new bf(5,5,5),o=new ls({name:"CubemapFromEquirect",uniforms:dd(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:ss,blending:mo});o.uniforms.tEquirect.value=t;const u=new Gi(r,o),h=t.minFilter;return t.minFilter===Qo&&(t.minFilter=Gn),new jT(1,10,this).update(e,u),t.minFilter=h,u.geometry.dispose(),u.material.dispose(),this}clear(e,t=!0,n=!0,r=!0){const o=e.getRenderTarget();for(let u=0;u<6;u++)e.setRenderTarget(this,u),e.clear(t,n,r);e.setRenderTarget(o)}}class nd extends Nn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const qC={type:"move"};class kv{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new nd,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new nd,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Q,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Q),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new nd,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Q,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Q),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,o=null,u=null;const h=this._targetRay,d=this._grip,m=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(m&&e.hand){u=!0;for(const R of e.hand.values()){const A=t.getJointPose(R,n),E=this._getHandJoint(m,R);A!==null&&(E.matrix.fromArray(A.transform.matrix),E.matrix.decompose(E.position,E.rotation,E.scale),E.matrixWorldNeedsUpdate=!0,E.jointRadius=A.radius),E.visible=A!==null}const v=m.joints["index-finger-tip"],x=m.joints["thumb-tip"],y=v.position.distanceTo(x.position),_=.02,M=.005;m.inputState.pinching&&y>_+M?(m.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!m.inputState.pinching&&y<=_-M&&(m.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else d!==null&&e.gripSpace&&(o=t.getPose(e.gripSpace,n),o!==null&&(d.matrix.fromArray(o.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale),d.matrixWorldNeedsUpdate=!0,o.linearVelocity?(d.hasLinearVelocity=!0,d.linearVelocity.copy(o.linearVelocity)):d.hasLinearVelocity=!1,o.angularVelocity?(d.hasAngularVelocity=!0,d.angularVelocity.copy(o.angularVelocity)):d.hasAngularVelocity=!1));h!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&o!==null&&(r=o),r!==null&&(h.matrix.fromArray(r.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.matrixWorldNeedsUpdate=!0,r.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(r.linearVelocity)):h.hasLinearVelocity=!1,r.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(r.angularVelocity)):h.hasAngularVelocity=!1,this.dispatchEvent(qC)))}return h!==null&&(h.visible=r!==null),d!==null&&(d.visible=o!==null),m!==null&&(m.visible=u!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new nd;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class iy{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Lt(e),this.density=t}clone(){return new iy(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class ry{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new Lt(e),this.near=t,this.far=n}clone(){return new ry(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}let Km=class extends Nn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ua,this.environmentIntensity=1,this.environmentRotation=new ua,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}};class sy{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Im,this.updateRanges=[],this.version=0,this.uuid=oa()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,o=this.stride;r<o;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=oa()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=oa()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const _s=new Q;class mf{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)_s.fromBufferAttribute(this,t),_s.applyMatrix4(e),this.setXYZ(t,_s.x,_s.y,_s.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)_s.fromBufferAttribute(this,t),_s.applyNormalMatrix(e),this.setXYZ(t,_s.x,_s.y,_s.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)_s.fromBufferAttribute(this,t),_s.transformDirection(e),this.setXYZ(t,_s.x,_s.y,_s.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=Es(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=En(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=En(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=En(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=En(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=En(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Es(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Es(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Es(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Es(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=En(t,this.array),n=En(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=En(t,this.array),n=En(n,this.array),r=En(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,o){return e=e*this.data.stride+this.offset,this.normalized&&(t=En(t,this.array),n=En(n,this.array),r=En(r,this.array),o=En(o,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=o,this}clone(e){if(e===void 0){Pm("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[r+o])}return new li(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new mf(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){Pm("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[r+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class f1 extends cs{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Lt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Vh;const tm=new Q,Hh=new Q,Gh=new Q,jh=new Je,nm=new Je,WT=new cn,av=new Q,im=new Q,ov=new Q,lM=new Je,Ob=new Je,cM=new Je;class XT extends Nn{constructor(e=new f1){if(super(),this.isSprite=!0,this.type="Sprite",Vh===void 0){Vh=new vn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new sy(t,5);Vh.setIndex([0,1,2,0,2,3]),Vh.setAttribute("position",new mf(n,3,0,!1)),Vh.setAttribute("uv",new mf(n,2,3,!1))}this.geometry=Vh,this.material=e,this.center=new Je(.5,.5),this.count=1}raycast(e,t){e.camera===null&&Qt('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Hh.setFromMatrixScale(this.matrixWorld),WT.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Gh.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Hh.multiplyScalar(-Gh.z);const n=this.material.rotation;let r,o;n!==0&&(o=Math.cos(n),r=Math.sin(n));const u=this.center;lv(av.set(-.5,-.5,0),Gh,u,Hh,r,o),lv(im.set(.5,-.5,0),Gh,u,Hh,r,o),lv(ov.set(.5,.5,0),Gh,u,Hh,r,o),lM.set(0,0),Ob.set(1,0),cM.set(1,1);let h=e.ray.intersectTriangle(av,im,ov,!1,tm);if(h===null&&(lv(im.set(-.5,.5,0),Gh,u,Hh,r,o),Ob.set(0,1),h=e.ray.intersectTriangle(av,ov,im,!1,tm),h===null))return;const d=e.ray.origin.distanceTo(tm);d<e.near||d>e.far||t.push({distance:d,point:tm.clone(),uv:Qs.getInterpolation(tm,av,im,ov,lM,Ob,cM,new Je),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function lv(s,e,t,n,r,o){jh.subVectors(s,t).addScalar(.5).multiply(n),r!==void 0?(nm.x=o*jh.x-r*jh.y,nm.y=r*jh.x+o*jh.y):nm.copy(jh),s.copy(e),s.x+=nm.x,s.y+=nm.y,s.applyMatrix4(WT)}const cv=new Q,uM=new Q;class qT extends Nn{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,r=t.length;n<r;n++){const o=t[n];this.addLevel(o.object.clone(),o.distance,o.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const r=this.levels;let o;for(o=0;o<r.length&&!(t<r[o].distance);o++);return r.splice(o,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const r=t.splice(n,1);return this.remove(r[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r;n++){let o=t[n].distance;if(t[n].object.visible&&(o-=o*t[n].hysteresis),e<o)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){cv.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(cv);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){cv.setFromMatrixPosition(e.matrixWorld),uM.setFromMatrixPosition(this.matrixWorld);const n=cv.distanceTo(uM)/e.zoom;t[0].object.visible=!0;let r,o;for(r=1,o=t.length;r<o;r++){let u=t[r].distance;if(t[r].object.visible&&(u-=u*t[r].hysteresis),n>=u)t[r-1].object.visible=!1,t[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<o;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let r=0,o=n.length;r<o;r++){const u=n[r];t.object.levels.push({object:u.object.uuid,distance:u.distance,hysteresis:u.hysteresis})}return t}}const fM=new Q,hM=new hi,dM=new hi,YC=new Q,pM=new cn,uv=new Q,zb=new jr,mM=new cn,Bb=new yf;class YT extends Gi{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=S_,this.bindMatrix=new cn,this.bindMatrixInverse=new cn,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new os),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,uv),this.boundingBox.expandByPoint(uv)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new jr),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,uv),this.boundingSphere.expandByPoint(uv)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,r=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),zb.copy(this.boundingSphere),zb.applyMatrix4(r),e.ray.intersectsSphere(zb)!==!1&&(mM.copy(r).invert(),Bb.copy(e.ray).applyMatrix4(mM),!(this.boundingBox!==null&&Bb.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,Bb)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new hi,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===S_?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===wT?this.bindMatrixInverse.copy(this.bindMatrix).invert():zt("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,r=this.geometry;hM.fromBufferAttribute(r.attributes.skinIndex,e),dM.fromBufferAttribute(r.attributes.skinWeight,e),fM.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let o=0;o<4;o++){const u=dM.getComponent(o);if(u!==0){const h=hM.getComponent(o);pM.multiplyMatrices(n.bones[h].matrixWorld,n.boneInverses[h]),t.addScaledVector(YC.copy(fM).applyMatrix4(pM),u)}}return t.applyMatrix4(this.bindMatrixInverse)}}class h1 extends Nn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Va extends oi{constructor(e=null,t=1,n=1,r,o,u,h,d,m=ar,v=ar,x,y){super(null,u,h,d,m,v,r,o,x,y),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const gM=new cn,ZC=new cn;class ay{constructor(e=[],t=[]){this.uuid=oa(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.previousBoneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){zt("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new cn)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new cn;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let o=0,u=e.length;o<u;o++){const h=e[o]?e[o].matrixWorld:ZC;gM.multiplyMatrices(h,t[o]),gM.toArray(n,o*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new ay(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Va(t,e,e,or,Li);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const o=e.bones[n];let u=t[o];u===void 0&&(zt("Skeleton: No bone found with UUID:",o),u=new h1),this.bones.push(u),this.boneInverses.push(new cn().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,o=t.length;r<o;r++){const u=t[r];e.bones.push(u.uuid);const h=n[r];e.boneInverses.push(h.toArray())}return e}}class pd extends li{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Wh=new cn,vM=new cn,fv=[],xM=new os,KC=new cn,rm=new Gi,sm=new jr;class ZT extends Gi{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new pd(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,KC)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new os),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Wh),xM.copy(e.boundingBox).applyMatrix4(Wh),this.boundingBox.union(xM)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new jr),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Wh),sm.copy(e.boundingSphere).applyMatrix4(Wh),this.boundingSphere.union(sm)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences,r=this.morphTexture.source.data.data,o=n.length+1,u=e*o+1;for(let h=0;h<n.length;h++)n[h]=r[u+h]}raycast(e,t){const n=this.matrixWorld,r=this.count;if(rm.geometry=this.geometry,rm.material=this.material,rm.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),sm.copy(this.boundingSphere),sm.applyMatrix4(n),e.ray.intersectsSphere(sm)!==!1))for(let o=0;o<r;o++){this.getMatrixAt(o,Wh),vM.multiplyMatrices(n,Wh),rm.matrixWorld=vM,rm.raycast(e,fv);for(let u=0,h=fv.length;u<h;u++){const d=fv[u];d.instanceId=o,d.object=this,t.push(d)}fv.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new pd(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences,r=n.length+1;this.morphTexture===null&&(this.morphTexture=new Va(new Float32Array(r*this.count),r,this.count,qm,Li));const o=this.morphTexture.source.data.data;let u=0;for(let m=0;m<n.length;m++)u+=n[m];const h=this.geometry.morphTargetsRelative?1:1-u,d=r*e;o[d]=h,o.set(n,d+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const Fb=new Q,QC=new Q,JC=new bn;class sa{constructor(e=new Q(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=Fb.subVectors(n,t).cross(QC.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(Fb),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/r;return o<0||o>1?null:t.copy(e.start).addScaledVector(n,o)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||JC.getNormalMatrix(e),r=this.coplanarPoint(Fb).applyMatrix4(e),o=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Hu=new jr,$C=new Je(.5,.5),hv=new Q;class _d{constructor(e=new sa,t=new sa,n=new sa,r=new sa,o=new sa,u=new sa){this.planes=[e,t,n,r,o,u]}set(e,t,n,r,o,u){const h=this.planes;return h[0].copy(e),h[1].copy(t),h[2].copy(n),h[3].copy(r),h[4].copy(o),h[5].copy(u),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=aa,n=!1){const r=this.planes,o=e.elements,u=o[0],h=o[1],d=o[2],m=o[3],v=o[4],x=o[5],y=o[6],_=o[7],M=o[8],R=o[9],A=o[10],E=o[11],N=o[12],I=o[13],P=o[14],z=o[15];if(r[0].setComponents(m-u,_-v,E-M,z-N).normalize(),r[1].setComponents(m+u,_+v,E+M,z+N).normalize(),r[2].setComponents(m+h,_+x,E+R,z+I).normalize(),r[3].setComponents(m-h,_-x,E-R,z-I).normalize(),n)r[4].setComponents(d,y,A,P).normalize(),r[5].setComponents(m-d,_-y,E-A,z-P).normalize();else if(r[4].setComponents(m-d,_-y,E-A,z-P).normalize(),t===aa)r[5].setComponents(m+d,_+y,E+A,z+P).normalize();else if(t===cd)r[5].setComponents(d,y,A,P).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Hu.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Hu.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Hu)}intersectsSprite(e){Hu.center.set(0,0,0);const t=$C.distanceTo(e.center);return Hu.radius=.7071067811865476+t,Hu.applyMatrix4(e.matrixWorld),this.intersectsSphere(Hu)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let o=0;o<6;o++)if(t[o].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(hv.x=r.normal.x>0?e.max.x:e.min.x,hv.y=r.normal.y>0?e.max.y:e.min.y,hv.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(hv)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const qo=new cn,Yo=new _d;class oy{constructor(){this.coordinateSystem=aa}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(qo.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Yo.setFromProjectionMatrix(qo,r.coordinateSystem,r.reversedDepth),Yo.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(qo.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Yo.setFromProjectionMatrix(qo,r.coordinateSystem,r.reversedDepth),Yo.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(qo.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Yo.setFromProjectionMatrix(qo,r.coordinateSystem,r.reversedDepth),Yo.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(qo.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Yo.setFromProjectionMatrix(qo,r.coordinateSystem,r.reversedDepth),Yo.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(qo.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Yo.setFromProjectionMatrix(qo,r.coordinateSystem,r.reversedDepth),Yo.containsPoint(e))return!0}return!1}clone(){return new oy}}function kb(s,e){return s-e}function eR(s,e){return s.z-e.z}function tR(s,e){return e.z-s.z}class nR{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,r){const o=this.pool,u=this.list;this.index>=o.length&&o.push({start:-1,count:-1,z:-1,index:-1});const h=o[this.index];u.push(h),this.index++,h.start=e,h.count=t,h.z=n,h.index=r}reset(){this.list.length=0,this.index=0}}const Ys=new cn,iR=new Lt(1,1,1),yM=new _d,rR=new oy,dv=new os,Gu=new jr,am=new Q,bM=new Q,sR=new Q,Vb=new nR,rs=new Gi,pv=[];function aR(s,e,t=0){const n=e.itemSize;if(s.isInterleavedBufferAttribute||s.array.constructor!==e.array.constructor){const r=s.count;for(let o=0;o<r;o++)for(let u=0;u<n;u++)e.setComponent(o+t,u,s.getComponent(o,u))}else e.array.set(s.array,t*n);e.needsUpdate=!0}function ju(s,e){if(s.constructor!==e.constructor){const t=Math.min(s.length,e.length);for(let n=0;n<t;n++)e[n]=s[n]}else{const t=Math.min(s.length,e.length);e.set(new s.constructor(s.buffer,0,t))}}class KT extends Gi{constructor(e,t,n=t*2,r){super(new vn,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new Va(t,e,e,or,Li);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new Va(t,e,e,Ym,ca);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new Va(t,e,e,or,Li);n.colorSpace=kn.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,r=this._maxIndexCount;if(this._geometryInitialized===!1){for(const o in e.attributes){const u=e.getAttribute(o),{array:h,itemSize:d,normalized:m}=u,v=new h.constructor(n*d),x=new li(v,d,m);t.setAttribute(o,x)}if(e.getIndex()!==null){const o=n>65535?new Uint32Array(r):new Uint16Array(r);t.setIndex(new li(o,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const r=e.getAttribute(n),o=t.getAttribute(n);if(r.itemSize!==o.itemSize||r.normalized!==o.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new os);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(t[n].active===!1)continue;const o=t[n].geometryIndex;this.getMatrixAt(n,Ys),this.getBoundingBoxAt(o,dv).applyMatrix4(Ys),e.union(dv)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new jr);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(t[n].active===!1)continue;const o=t[n].geometryIndex;this.getMatrixAt(n,Ys),this.getBoundingSphereAt(o,Gu).applyMatrix4(Ys),e.union(Gu)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const n={visible:!0,active:!0,geometryIndex:e};let r=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(kb),r=this._availableInstanceIds.shift(),this._instanceInfo[r]=n):(r=this._instanceInfo.length,this._instanceInfo.push(n));const o=this._matricesTexture;Ys.identity().toArray(o.image.data,r*16),o.needsUpdate=!0;const u=this._colorsTexture;return u&&(iR.toArray(u.image.data,r*4),u.needsUpdate=!0),this._visibilityChanged=!0,r}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);const r={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},o=this._geometryInfo;r.vertexStart=this._nextVertexStart,r.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const u=e.getIndex();if(u!==null&&(r.indexStart=this._nextIndexStart,r.reservedIndexCount=n===-1?u.count:n),r.indexStart!==-1&&r.indexStart+r.reservedIndexCount>this._maxIndexCount||r.vertexStart+r.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let d;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(kb),d=this._availableGeometryIds.shift(),o[d]=r):(d=this._geometryCount,this._geometryCount++,o.push(r)),this.setGeometryAt(d,e),this._nextIndexStart=r.indexStart+r.reservedIndexCount,this._nextVertexStart=r.vertexStart+r.reservedVertexCount,d}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,r=n.getIndex()!==null,o=n.getIndex(),u=t.getIndex(),h=this._geometryInfo[e];if(r&&u.count>h.reservedIndexCount||t.attributes.position.count>h.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const d=h.vertexStart,m=h.reservedVertexCount;h.vertexCount=t.getAttribute("position").count;for(const v in n.attributes){const x=t.getAttribute(v),y=n.getAttribute(v);aR(x,y,d);const _=x.itemSize;for(let M=x.count,R=m;M<R;M++){const A=d+M;for(let E=0;E<_;E++)y.setComponent(A,E,0)}y.needsUpdate=!0,y.addUpdateRange(d*_,m*_)}if(r){const v=h.indexStart,x=h.reservedIndexCount;h.indexCount=t.getIndex().count;for(let y=0;y<u.count;y++)o.setX(v+y,d+u.getX(y));for(let y=u.count,_=x;y<_;y++)o.setX(v+y,d);o.needsUpdate=!0,o.addUpdateRange(v,h.reservedIndexCount)}return h.start=r?h.indexStart:h.vertexStart,h.count=r?h.indexCount:h.vertexCount,h.boundingBox=null,t.boundingBox!==null&&(h.boundingBox=t.boundingBox.clone()),h.boundingSphere=null,t.boundingSphere!==null&&(h.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const n=this._instanceInfo;for(let r=0,o=n.length;r<o;r++)n[r].active&&n[r].geometryIndex===e&&this.deleteInstance(r);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,r=n.map((u,h)=>h).sort((u,h)=>n[u].vertexStart-n[h].vertexStart),o=this.geometry;for(let u=0,h=n.length;u<h;u++){const d=r[u],m=n[d];if(m.active!==!1){if(o.index!==null){if(m.indexStart!==t){const{indexStart:v,vertexStart:x,reservedIndexCount:y}=m,_=o.index,M=_.array,R=e-x;for(let A=v;A<v+y;A++)M[A]=M[A]+R;_.array.copyWithin(t,v,v+y),_.addUpdateRange(t,y),_.needsUpdate=!0,m.indexStart=t}t+=m.reservedIndexCount}if(m.vertexStart!==e){const{vertexStart:v,reservedVertexCount:x}=m,y=o.attributes;for(const _ in y){const M=y[_],{array:R,itemSize:A}=M;R.copyWithin(e*A,v*A,(v+x)*A),M.addUpdateRange(e*A,x*A),M.needsUpdate=!0}m.vertexStart=e}e+=m.reservedVertexCount,m.start=o.index?m.indexStart:m.vertexStart,this._nextIndexStart=o.index?m.indexStart+m.reservedIndexCount:0,this._nextVertexStart=m.vertexStart+m.reservedVertexCount}}return this._visibilityChanged=!0,this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,r=this._geometryInfo[e];if(r.boundingBox===null){const o=new os,u=n.index,h=n.attributes.position;for(let d=r.start,m=r.start+r.count;d<m;d++){let v=d;u&&(v=u.getX(v)),o.expandByPoint(am.fromBufferAttribute(h,v))}r.boundingBox=o}return t.copy(r.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,r=this._geometryInfo[e];if(r.boundingSphere===null){const o=new jr;this.getBoundingBoxAt(e,dv),dv.getCenter(o.center);const u=n.index,h=n.attributes.position;let d=0;for(let m=r.start,v=r.start+r.count;m<v;m++){let x=m;u&&(x=u.getX(x)),am.fromBufferAttribute(h,x),d=Math.max(d,o.center.distanceToSquared(am))}o.radius=Math.sqrt(d),r.boundingSphere=o}return t.copy(r.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,r=this._matricesTexture.image.data;return t.toArray(r,e*16),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(kb);t[t.length-1]===n.length-1;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const r=new Int32Array(e),o=new Int32Array(e);ju(this._multiDrawCounts,r),ju(this._multiDrawStarts,o),this._multiDrawCounts=r,this._multiDrawStarts=o,this._maxInstanceCount=e;const u=this._indirectTexture,h=this._matricesTexture,d=this._colorsTexture;u.dispose(),this._initIndirectTexture(),ju(u.image.data,this._indirectTexture.image.data),h.dispose(),this._initMatricesTexture(),ju(h.image.data,this._matricesTexture.image.data),d&&(d.dispose(),this._initColorsTexture(),ju(d.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter(h=>h.active);if(Math.max(...n.map(h=>h.vertexStart+h.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...n.map(d=>d.indexStart+d.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const o=this.geometry;o.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new vn,this._initializeGeometry(o));const u=this.geometry;o.index&&ju(o.index.array,u.index.array);for(const h in o.attributes)ju(o.attributes[h].array,u.attributes[h].array)}raycast(e,t){const n=this._instanceInfo,r=this._geometryInfo,o=this.matrixWorld,u=this.geometry;rs.material=this.material,rs.geometry.index=u.index,rs.geometry.attributes=u.attributes,rs.geometry.boundingBox===null&&(rs.geometry.boundingBox=new os),rs.geometry.boundingSphere===null&&(rs.geometry.boundingSphere=new jr);for(let h=0,d=n.length;h<d;h++){if(!n[h].visible||!n[h].active)continue;const m=n[h].geometryIndex,v=r[m];rs.geometry.setDrawRange(v.start,v.count),this.getMatrixAt(h,rs.matrixWorld).premultiply(o),this.getBoundingBoxAt(m,rs.geometry.boundingBox),this.getBoundingSphereAt(m,rs.geometry.boundingSphere),rs.raycast(e,pv);for(let x=0,y=pv.length;x<y;x++){const _=pv[x];_.object=this,_.batchId=h,t.push(_)}pv.length=0}rs.material=null,rs.geometry.index=null,rs.geometry.attributes={},rs.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,r,o){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const u=r.getIndex(),h=u===null?1:u.array.BYTES_PER_ELEMENT,d=this._instanceInfo,m=this._multiDrawStarts,v=this._multiDrawCounts,x=this._geometryInfo,y=this.perObjectFrustumCulled,_=this._indirectTexture,M=_.image.data,R=n.isArrayCamera?rR:yM;y&&!n.isArrayCamera&&(Ys.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),yM.setFromProjectionMatrix(Ys,n.coordinateSystem,n.reversedDepth));let A=0;if(this.sortObjects){Ys.copy(this.matrixWorld).invert(),am.setFromMatrixPosition(n.matrixWorld).applyMatrix4(Ys),bM.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(Ys);for(let I=0,P=d.length;I<P;I++)if(d[I].visible&&d[I].active){const z=d[I].geometryIndex;this.getMatrixAt(I,Ys),this.getBoundingSphereAt(z,Gu).applyMatrix4(Ys);let U=!1;if(y&&(U=!R.intersectsSphere(Gu,n)),!U){const H=x[z],V=sR.subVectors(Gu.center,am).dot(bM);Vb.push(H.start,H.count,V,I)}}const E=Vb.list,N=this.customSort;N===null?E.sort(o.transparent?tR:eR):N.call(this,E,n);for(let I=0,P=E.length;I<P;I++){const z=E[I];m[A]=z.start*h,v[A]=z.count,M[A]=z.index,A++}Vb.reset()}else for(let E=0,N=d.length;E<N;E++)if(d[E].visible&&d[E].active){const I=d[E].geometryIndex;let P=!1;if(y&&(this.getMatrixAt(E,Ys),this.getBoundingSphereAt(I,Gu).applyMatrix4(Ys),P=!R.intersectsSphere(Gu,n)),!P){const z=x[I];m[A]=z.start*h,v[A]=z.count,M[A]=E,A++}}_.needsUpdate=!0,this._multiDrawCount=A,this._visibilityChanged=!1}onBeforeShadow(e,t,n,r,o,u){this.onBeforeRender(e,null,r,o,u)}}class ws extends cs{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Lt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Dx=new Q,Ix=new Q,_M=new cn,om=new yf,mv=new jr,Hb=new Q,SM=new Q;class Zc extends Nn{constructor(e=new vn,t=new ws){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let r=1,o=t.count;r<o;r++)Dx.fromBufferAttribute(t,r-1),Ix.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=Dx.distanceTo(Ix);e.setAttribute("lineDistance",new Wt(n,1))}else zt("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,o=e.params.Line.threshold,u=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),mv.copy(n.boundingSphere),mv.applyMatrix4(r),mv.radius+=o,e.ray.intersectsSphere(mv)===!1)return;_M.copy(r).invert(),om.copy(e.ray).applyMatrix4(_M);const h=o/((this.scale.x+this.scale.y+this.scale.z)/3),d=h*h,m=this.isLineSegments?2:1,v=n.index,y=n.attributes.position;if(v!==null){const _=Math.max(0,u.start),M=Math.min(v.count,u.start+u.count);for(let R=_,A=M-1;R<A;R+=m){const E=v.getX(R),N=v.getX(R+1),I=gv(this,e,om,d,E,N,R);I&&t.push(I)}if(this.isLineLoop){const R=v.getX(M-1),A=v.getX(_),E=gv(this,e,om,d,R,A,M-1);E&&t.push(E)}}else{const _=Math.max(0,u.start),M=Math.min(y.count,u.start+u.count);for(let R=_,A=M-1;R<A;R+=m){const E=gv(this,e,om,d,R,R+1,R);E&&t.push(E)}if(this.isLineLoop){const R=gv(this,e,om,d,M-1,_,M-1);R&&t.push(R)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,u=r.length;o<u;o++){const h=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=o}}}}}function gv(s,e,t,n,r,o,u){const h=s.geometry.attributes.position;if(Dx.fromBufferAttribute(h,r),Ix.fromBufferAttribute(h,o),t.distanceSqToSegment(Dx,Ix,Hb,SM)>n)return;Hb.applyMatrix4(s.matrixWorld);const m=e.ray.origin.distanceTo(Hb);if(!(m<e.near||m>e.far))return{distance:m,point:SM.clone().applyMatrix4(s.matrixWorld),index:u,face:null,faceIndex:null,barycoord:null,object:s}}const MM=new Q,EM=new Q;class tl extends Zc{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let r=0,o=t.count;r<o;r+=2)MM.fromBufferAttribute(t,r),EM.fromBufferAttribute(t,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+MM.distanceTo(EM);e.setAttribute("lineDistance",new Wt(n,1))}else zt("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class QT extends Zc{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class d1 extends cs{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Lt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const TM=new cn,w_=new yf,vv=new jr,xv=new Q;class JT extends Nn{constructor(e=new vn,t=new d1){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,o=e.params.Points.threshold,u=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),vv.copy(n.boundingSphere),vv.applyMatrix4(r),vv.radius+=o,e.ray.intersectsSphere(vv)===!1)return;TM.copy(r).invert(),w_.copy(e.ray).applyMatrix4(TM);const h=o/((this.scale.x+this.scale.y+this.scale.z)/3),d=h*h,m=n.index,x=n.attributes.position;if(m!==null){const y=Math.max(0,u.start),_=Math.min(m.count,u.start+u.count);for(let M=y,R=_;M<R;M++){const A=m.getX(M);xv.fromBufferAttribute(x,A),wM(xv,A,d,r,e,t,this)}}else{const y=Math.max(0,u.start),_=Math.min(x.count,u.start+u.count);for(let M=y,R=_;M<R;M++)xv.fromBufferAttribute(x,M),wM(xv,M,d,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,u=r.length;o<u;o++){const h=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=o}}}}}function wM(s,e,t,n,r,o,u){const h=w_.distanceSqToPoint(s);if(h<t){const d=new Q;w_.closestPointToPoint(s,d),d.applyMatrix4(n);const m=r.ray.origin.distanceTo(d);if(m<r.near||m>r.far)return;o.push({distance:m,distanceToRay:Math.sqrt(h),point:d,index:e,face:null,faceIndex:null,barycoord:null,object:u})}}class $T extends oi{constructor(e,t,n,r,o=Gn,u=Gn,h,d,m){super(e,t,n,r,o,u,h,d,m),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const v=this;function x(){v.needsUpdate=!0,v._requestVideoFrameCallbackId=e.requestVideoFrameCallback(x)}"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(x))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){this._requestVideoFrameCallbackId!==0&&(this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),this._requestVideoFrameCallbackId=0),super.dispose()}}class oR extends $T{constructor(e,t,n,r,o,u,h,d){super({},e,t,n,r,o,u,h,d),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class lR extends oi{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=ar,this.minFilter=ar,this.generateMipmaps=!1,this.needsUpdate=!0}}class ly extends oi{constructor(e,t,n,r,o,u,h,d,m,v,x,y){super(null,u,h,d,m,v,r,o,x,y),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class cR extends ly{constructor(e,t,n,r,o,u){super(e,t,n,o,u),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=Ki,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class uR extends ly{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,go),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class fR extends oi{constructor(e,t,n,r,o,u,h,d,m){super(e,t,n,r,o,u,h,d,m),this.isCanvasTexture=!0,this.needsUpdate=!0}}class md extends oi{constructor(e,t,n=ca,r,o,u,h=ar,d=ar,m,v=$o,x=1){if(v!==$o&&v!==Hc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const y={width:e,height:t,depth:x};super(y,r,o,u,h,d,v,n,m),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new Gc(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class ew extends md{constructor(e,t=ca,n=go,r,o,u=ar,h=ar,d,m=$o){const v={width:e,height:e,depth:1},x=[v,v,v,v,v,v];super(e,e,t,n,r,o,u,h,d,m),this.image=x,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}}class p1 extends oi{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class cy extends vn{constructor(e=1,t=1,n=4,r=8,o=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:r,heightSegments:o},t=Math.max(0,t),n=Math.max(1,Math.floor(n)),r=Math.max(3,Math.floor(r)),o=Math.max(1,Math.floor(o));const u=[],h=[],d=[],m=[],v=t/2,x=Math.PI/2*e,y=t,_=2*x+y,M=n*2+o,R=r+1,A=new Q,E=new Q;for(let N=0;N<=M;N++){let I=0,P=0,z=0,U=0;if(N<=n){const L=N/n,B=L*Math.PI/2;P=-v-e*Math.cos(B),z=e*Math.sin(B),U=-e*Math.cos(B),I=L*x}else if(N<=n+o){const L=(N-n)/o;P=-v+L*t,z=e,U=0,I=x+L*y}else{const L=(N-n-o)/n,B=L*Math.PI/2;P=v+e*Math.sin(B),z=e*Math.cos(B),U=e*Math.sin(B),I=x+y+L*x}const H=Math.max(0,Math.min(1,I/_));let V=0;N===0?V=.5/r:N===M&&(V=-.5/r);for(let L=0;L<=r;L++){const B=L/r,W=B*Math.PI*2,ie=Math.sin(W),J=Math.cos(W);E.x=-z*J,E.y=P,E.z=z*ie,h.push(E.x,E.y,E.z),A.set(-z*J,U,z*ie),A.normalize(),d.push(A.x,A.y,A.z),m.push(B+V,H)}if(N>0){const L=(N-1)*R;for(let B=0;B<r;B++){const W=L+B,ie=L+B+1,J=N*R+B,se=N*R+B+1;u.push(W,ie,J),u.push(ie,se,J)}}}this.setIndex(u),this.setAttribute("position",new Wt(h,3)),this.setAttribute("normal",new Wt(d,3)),this.setAttribute("uv",new Wt(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new cy(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class uy extends vn{constructor(e=1,t=32,n=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const o=[],u=[],h=[],d=[],m=new Q,v=new Je;u.push(0,0,0),h.push(0,0,1),d.push(.5,.5);for(let x=0,y=3;x<=t;x++,y+=3){const _=n+x/t*r;m.x=e*Math.cos(_),m.y=e*Math.sin(_),u.push(m.x,m.y,m.z),h.push(0,0,1),v.x=(u[y]/e+1)/2,v.y=(u[y+1]/e+1)/2,d.push(v.x,v.y)}for(let x=1;x<=t;x++)o.push(x,x+1,0);this.setIndex(o),this.setAttribute("position",new Wt(u,3)),this.setAttribute("normal",new Wt(h,3)),this.setAttribute("uv",new Wt(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new uy(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Qm extends vn{constructor(e=1,t=1,n=1,r=32,o=1,u=!1,h=0,d=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:o,openEnded:u,thetaStart:h,thetaLength:d};const m=this;r=Math.floor(r),o=Math.floor(o);const v=[],x=[],y=[],_=[];let M=0;const R=[],A=n/2;let E=0;N(),u===!1&&(e>0&&I(!0),t>0&&I(!1)),this.setIndex(v),this.setAttribute("position",new Wt(x,3)),this.setAttribute("normal",new Wt(y,3)),this.setAttribute("uv",new Wt(_,2));function N(){const P=new Q,z=new Q;let U=0;const H=(t-e)/n;for(let V=0;V<=o;V++){const L=[],B=V/o,W=B*(t-e)+e;for(let ie=0;ie<=r;ie++){const J=ie/r,se=J*d+h,ce=Math.sin(se),Y=Math.cos(se);z.x=W*ce,z.y=-B*n+A,z.z=W*Y,x.push(z.x,z.y,z.z),P.set(ce,H,Y).normalize(),y.push(P.x,P.y,P.z),_.push(J,1-B),L.push(M++)}R.push(L)}for(let V=0;V<r;V++)for(let L=0;L<o;L++){const B=R[L][V],W=R[L+1][V],ie=R[L+1][V+1],J=R[L][V+1];(e>0||L!==0)&&(v.push(B,W,J),U+=3),(t>0||L!==o-1)&&(v.push(W,ie,J),U+=3)}m.addGroup(E,U,0),E+=U}function I(P){const z=M,U=new Je,H=new Q;let V=0;const L=P===!0?e:t,B=P===!0?1:-1;for(let ie=1;ie<=r;ie++)x.push(0,A*B,0),y.push(0,B,0),_.push(.5,.5),M++;const W=M;for(let ie=0;ie<=r;ie++){const se=ie/r*d+h,ce=Math.cos(se),Y=Math.sin(se);H.x=L*Y,H.y=A*B,H.z=L*ce,x.push(H.x,H.y,H.z),y.push(0,B,0),U.x=ce*.5+.5,U.y=Y*.5*B+.5,_.push(U.x,U.y),M++}for(let ie=0;ie<r;ie++){const J=z+ie,se=W+ie;P===!0?v.push(se,se+1,J):v.push(se+1,se,J),V+=3}m.addGroup(E,V,P===!0?1:2),E+=V}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Qm(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Jm extends Qm{constructor(e=1,t=1,n=32,r=1,o=!1,u=0,h=Math.PI*2){super(0,e,t,n,r,o,u,h),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:o,thetaStart:u,thetaLength:h}}static fromJSON(e){return new Jm(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Qc extends vn{constructor(e=[],t=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const o=[],u=[];h(r),m(n),v(),this.setAttribute("position",new Wt(o,3)),this.setAttribute("normal",new Wt(o.slice(),3)),this.setAttribute("uv",new Wt(u,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function h(N){const I=new Q,P=new Q,z=new Q;for(let U=0;U<t.length;U+=3)_(t[U+0],I),_(t[U+1],P),_(t[U+2],z),d(I,P,z,N)}function d(N,I,P,z){const U=z+1,H=[];for(let V=0;V<=U;V++){H[V]=[];const L=N.clone().lerp(P,V/U),B=I.clone().lerp(P,V/U),W=U-V;for(let ie=0;ie<=W;ie++)ie===0&&V===U?H[V][ie]=L:H[V][ie]=L.clone().lerp(B,ie/W)}for(let V=0;V<U;V++)for(let L=0;L<2*(U-V)-1;L++){const B=Math.floor(L/2);L%2===0?(y(H[V][B+1]),y(H[V+1][B]),y(H[V][B])):(y(H[V][B+1]),y(H[V+1][B+1]),y(H[V+1][B]))}}function m(N){const I=new Q;for(let P=0;P<o.length;P+=3)I.x=o[P+0],I.y=o[P+1],I.z=o[P+2],I.normalize().multiplyScalar(N),o[P+0]=I.x,o[P+1]=I.y,o[P+2]=I.z}function v(){const N=new Q;for(let I=0;I<o.length;I+=3){N.x=o[I+0],N.y=o[I+1],N.z=o[I+2];const P=A(N)/2/Math.PI+.5,z=E(N)/Math.PI+.5;u.push(P,1-z)}M(),x()}function x(){for(let N=0;N<u.length;N+=6){const I=u[N+0],P=u[N+2],z=u[N+4],U=Math.max(I,P,z),H=Math.min(I,P,z);U>.9&&H<.1&&(I<.2&&(u[N+0]+=1),P<.2&&(u[N+2]+=1),z<.2&&(u[N+4]+=1))}}function y(N){o.push(N.x,N.y,N.z)}function _(N,I){const P=N*3;I.x=e[P+0],I.y=e[P+1],I.z=e[P+2]}function M(){const N=new Q,I=new Q,P=new Q,z=new Q,U=new Je,H=new Je,V=new Je;for(let L=0,B=0;L<o.length;L+=9,B+=6){N.set(o[L+0],o[L+1],o[L+2]),I.set(o[L+3],o[L+4],o[L+5]),P.set(o[L+6],o[L+7],o[L+8]),U.set(u[B+0],u[B+1]),H.set(u[B+2],u[B+3]),V.set(u[B+4],u[B+5]),z.copy(N).add(I).add(P).divideScalar(3);const W=A(z);R(U,B+0,N,W),R(H,B+2,I,W),R(V,B+4,P,W)}}function R(N,I,P,z){z<0&&N.x===1&&(u[I]=N.x-1),P.x===0&&P.z===0&&(u[I]=z/2/Math.PI+.5)}function A(N){return Math.atan2(N.z,-N.x)}function E(N){return Math.atan2(-N.y,Math.sqrt(N.x*N.x+N.z*N.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Qc(e.vertices,e.indices,e.radius,e.detail)}}class fy extends Qc{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=1/n,o=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],u=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(o,u,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new fy(e.radius,e.detail)}}const yv=new Q,bv=new Q,Gb=new Q,_v=new Qs;class tw extends vn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const r=Math.pow(10,4),o=Math.cos(ff*t),u=e.getIndex(),h=e.getAttribute("position"),d=u?u.count:h.count,m=[0,0,0],v=["a","b","c"],x=new Array(3),y={},_=[];for(let M=0;M<d;M+=3){u?(m[0]=u.getX(M),m[1]=u.getX(M+1),m[2]=u.getX(M+2)):(m[0]=M,m[1]=M+1,m[2]=M+2);const{a:R,b:A,c:E}=_v;if(R.fromBufferAttribute(h,m[0]),A.fromBufferAttribute(h,m[1]),E.fromBufferAttribute(h,m[2]),_v.getNormal(Gb),x[0]=`${Math.round(R.x*r)},${Math.round(R.y*r)},${Math.round(R.z*r)}`,x[1]=`${Math.round(A.x*r)},${Math.round(A.y*r)},${Math.round(A.z*r)}`,x[2]=`${Math.round(E.x*r)},${Math.round(E.y*r)},${Math.round(E.z*r)}`,!(x[0]===x[1]||x[1]===x[2]||x[2]===x[0]))for(let N=0;N<3;N++){const I=(N+1)%3,P=x[N],z=x[I],U=_v[v[N]],H=_v[v[I]],V=`${P}_${z}`,L=`${z}_${P}`;L in y&&y[L]?(Gb.dot(y[L].normal)<=o&&(_.push(U.x,U.y,U.z),_.push(H.x,H.y,H.z)),y[L]=null):V in y||(y[V]={index0:m[N],index1:m[I],normal:Gb.clone()})}}for(const M in y)if(y[M]){const{index0:R,index1:A}=y[M];yv.fromBufferAttribute(h,R),bv.fromBufferAttribute(h,A),_.push(yv.x,yv.y,yv.z),_.push(bv.x,bv.y,bv.z)}this.setAttribute("position",new Wt(_,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class xo{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){zt("Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),o=0;t.push(0);for(let u=1;u<=e;u++)n=this.getPoint(u/e),o+=n.distanceTo(r),t.push(o),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let r=0;const o=n.length;let u;t?u=t:u=e*n[o-1];let h=0,d=o-1,m;for(;h<=d;)if(r=Math.floor(h+(d-h)/2),m=n[r]-u,m<0)h=r+1;else if(m>0)d=r-1;else{d=r;break}if(r=d,n[r]===u)return r/(o-1);const v=n[r],y=n[r+1]-v,_=(u-v)/y;return(r+_)/(o-1)}getTangent(e,t){let r=e-1e-4,o=e+1e-4;r<0&&(r=0),o>1&&(o=1);const u=this.getPoint(r),h=this.getPoint(o),d=t||(u.isVector2?new Je:new Q);return d.copy(h).sub(u).normalize(),d}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new Q,r=[],o=[],u=[],h=new Q,d=new cn;for(let _=0;_<=e;_++){const M=_/e;r[_]=this.getTangentAt(M,new Q)}o[0]=new Q,u[0]=new Q;let m=Number.MAX_VALUE;const v=Math.abs(r[0].x),x=Math.abs(r[0].y),y=Math.abs(r[0].z);v<=m&&(m=v,n.set(1,0,0)),x<=m&&(m=x,n.set(0,1,0)),y<=m&&n.set(0,0,1),h.crossVectors(r[0],n).normalize(),o[0].crossVectors(r[0],h),u[0].crossVectors(r[0],o[0]);for(let _=1;_<=e;_++){if(o[_]=o[_-1].clone(),u[_]=u[_-1].clone(),h.crossVectors(r[_-1],r[_]),h.length()>Number.EPSILON){h.normalize();const M=Math.acos(on(r[_-1].dot(r[_]),-1,1));o[_].applyMatrix4(d.makeRotationAxis(h,M))}u[_].crossVectors(r[_],o[_])}if(t===!0){let _=Math.acos(on(o[0].dot(o[e]),-1,1));_/=e,r[0].dot(h.crossVectors(o[0],o[e]))>0&&(_=-_);for(let M=1;M<=e;M++)o[M].applyMatrix4(d.makeRotationAxis(r[M],_*M)),u[M].crossVectors(r[M],o[M])}return{tangents:r,normals:o,binormals:u}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class hy extends xo{constructor(e=0,t=0,n=1,r=1,o=0,u=Math.PI*2,h=!1,d=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=o,this.aEndAngle=u,this.aClockwise=h,this.aRotation=d}getPoint(e,t=new Je){const n=t,r=Math.PI*2;let o=this.aEndAngle-this.aStartAngle;const u=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=r;for(;o>r;)o-=r;o<Number.EPSILON&&(u?o=0:o=r),this.aClockwise===!0&&!u&&(o===r?o=-r:o=o-r);const h=this.aStartAngle+e*o;let d=this.aX+this.xRadius*Math.cos(h),m=this.aY+this.yRadius*Math.sin(h);if(this.aRotation!==0){const v=Math.cos(this.aRotation),x=Math.sin(this.aRotation),y=d-this.aX,_=m-this.aY;d=y*v-_*x+this.aX,m=y*x+_*v+this.aY}return n.set(d,m)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class nw extends hy{constructor(e,t,n,r,o,u){super(e,t,n,n,r,o,u),this.isArcCurve=!0,this.type="ArcCurve"}}function m1(){let s=0,e=0,t=0,n=0;function r(o,u,h,d){s=o,e=h,t=-3*o+3*u-2*h-d,n=2*o-2*u+h+d}return{initCatmullRom:function(o,u,h,d,m){r(u,h,m*(h-o),m*(d-u))},initNonuniformCatmullRom:function(o,u,h,d,m,v,x){let y=(u-o)/m-(h-o)/(m+v)+(h-u)/v,_=(h-u)/v-(d-u)/(v+x)+(d-h)/x;y*=v,_*=v,r(u,h,y,_)},calc:function(o){const u=o*o,h=u*o;return s+e*o+t*u+n*h}}}const Sv=new Q,jb=new m1,Wb=new m1,Xb=new m1;class iw extends xo{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new Q){const n=t,r=this.points,o=r.length,u=(o-(this.closed?0:1))*e;let h=Math.floor(u),d=u-h;this.closed?h+=h>0?0:(Math.floor(Math.abs(h)/o)+1)*o:d===0&&h===o-1&&(h=o-2,d=1);let m,v;this.closed||h>0?m=r[(h-1)%o]:(Sv.subVectors(r[0],r[1]).add(r[0]),m=Sv);const x=r[h%o],y=r[(h+1)%o];if(this.closed||h+2<o?v=r[(h+2)%o]:(Sv.subVectors(r[o-1],r[o-2]).add(r[o-1]),v=Sv),this.curveType==="centripetal"||this.curveType==="chordal"){const _=this.curveType==="chordal"?.5:.25;let M=Math.pow(m.distanceToSquared(x),_),R=Math.pow(x.distanceToSquared(y),_),A=Math.pow(y.distanceToSquared(v),_);R<1e-4&&(R=1),M<1e-4&&(M=R),A<1e-4&&(A=R),jb.initNonuniformCatmullRom(m.x,x.x,y.x,v.x,M,R,A),Wb.initNonuniformCatmullRom(m.y,x.y,y.y,v.y,M,R,A),Xb.initNonuniformCatmullRom(m.z,x.z,y.z,v.z,M,R,A)}else this.curveType==="catmullrom"&&(jb.initCatmullRom(m.x,x.x,y.x,v.x,this.tension),Wb.initCatmullRom(m.y,x.y,y.y,v.y,this.tension),Xb.initCatmullRom(m.z,x.z,y.z,v.z,this.tension));return n.set(jb.calc(d),Wb.calc(d),Xb.calc(d)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new Q().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function AM(s,e,t,n,r){const o=(n-e)*.5,u=(r-t)*.5,h=s*s,d=s*h;return(2*t-2*n+o+u)*d+(-3*t+3*n-2*o-u)*h+o*s+t}function hR(s,e){const t=1-s;return t*t*e}function dR(s,e){return 2*(1-s)*s*e}function pR(s,e){return s*s*e}function Sm(s,e,t,n){return hR(s,e)+dR(s,t)+pR(s,n)}function mR(s,e){const t=1-s;return t*t*t*e}function gR(s,e){const t=1-s;return 3*t*t*s*e}function vR(s,e){return 3*(1-s)*s*s*e}function xR(s,e){return s*s*s*e}function Mm(s,e,t,n,r){return mR(s,e)+gR(s,t)+vR(s,n)+xR(s,r)}class g1 extends xo{constructor(e=new Je,t=new Je,n=new Je,r=new Je){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new Je){const n=t,r=this.v0,o=this.v1,u=this.v2,h=this.v3;return n.set(Mm(e,r.x,o.x,u.x,h.x),Mm(e,r.y,o.y,u.y,h.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class rw extends xo{constructor(e=new Q,t=new Q,n=new Q,r=new Q){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new Q){const n=t,r=this.v0,o=this.v1,u=this.v2,h=this.v3;return n.set(Mm(e,r.x,o.x,u.x,h.x),Mm(e,r.y,o.y,u.y,h.y),Mm(e,r.z,o.z,u.z,h.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class v1 extends xo{constructor(e=new Je,t=new Je){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Je){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Je){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class sw extends xo{constructor(e=new Q,t=new Q){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new Q){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Q){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class x1 extends xo{constructor(e=new Je,t=new Je,n=new Je){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Je){const n=t,r=this.v0,o=this.v1,u=this.v2;return n.set(Sm(e,r.x,o.x,u.x),Sm(e,r.y,o.y,u.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class y1 extends xo{constructor(e=new Q,t=new Q,n=new Q){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Q){const n=t,r=this.v0,o=this.v1,u=this.v2;return n.set(Sm(e,r.x,o.x,u.x),Sm(e,r.y,o.y,u.y),Sm(e,r.z,o.z,u.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class b1 extends xo{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Je){const n=t,r=this.points,o=(r.length-1)*e,u=Math.floor(o),h=o-u,d=r[u===0?u:u-1],m=r[u],v=r[u>r.length-2?r.length-1:u+1],x=r[u>r.length-3?r.length-1:u+2];return n.set(AM(h,d.x,m.x,v.x,x.x),AM(h,d.y,m.y,v.y,x.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new Je().fromArray(r))}return this}}var Lx=Object.freeze({__proto__:null,ArcCurve:nw,CatmullRomCurve3:iw,CubicBezierCurve:g1,CubicBezierCurve3:rw,EllipseCurve:hy,LineCurve:v1,LineCurve3:sw,QuadraticBezierCurve:x1,QuadraticBezierCurve3:y1,SplineCurve:b1});class aw extends xo{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Lx[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),r=this.getCurveLengths();let o=0;for(;o<r.length;){if(r[o]>=n){const u=r[o]-n,h=this.curves[o],d=h.getLength(),m=d===0?0:1-u/d;return h.getPointAt(m,t)}o++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let r=0,o=this.curves;r<o.length;r++){const u=o[r],h=u.isEllipseCurve?e*2:u.isLineCurve||u.isLineCurve3?1:u.isSplineCurve?e*u.points.length:e,d=u.getPoints(h);for(let m=0;m<d.length;m++){const v=d[m];n&&n.equals(v)||(t.push(v),n=v)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push(new Lx[r.type]().fromJSON(r))}return this}}class Px extends aw{constructor(e){super(),this.type="Path",this.currentPoint=new Je,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new v1(this.currentPoint.clone(),new Je(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){const o=new x1(this.currentPoint.clone(),new Je(e,t),new Je(n,r));return this.curves.push(o),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,o,u){const h=new g1(this.currentPoint.clone(),new Je(e,t),new Je(n,r),new Je(o,u));return this.curves.push(h),this.currentPoint.set(o,u),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new b1(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,o,u){const h=this.currentPoint.x,d=this.currentPoint.y;return this.absarc(e+h,t+d,n,r,o,u),this}absarc(e,t,n,r,o,u){return this.absellipse(e,t,n,n,r,o,u),this}ellipse(e,t,n,r,o,u,h,d){const m=this.currentPoint.x,v=this.currentPoint.y;return this.absellipse(e+m,t+v,n,r,o,u,h,d),this}absellipse(e,t,n,r,o,u,h,d){const m=new hy(e,t,n,r,o,u,h,d);if(this.curves.length>0){const x=m.getPoint(0);x.equals(this.currentPoint)||this.lineTo(x.x,x.y)}this.curves.push(m);const v=m.getPoint(1);return this.currentPoint.copy(v),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class hf extends Px{constructor(e){super(e),this.uuid=oa(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push(new Px().fromJSON(r))}return this}}function yR(s,e,t=2){const n=e&&e.length,r=n?e[0]*t:s.length;let o=ow(s,0,r,t,!0);const u=[];if(!o||o.next===o.prev)return u;let h,d,m;if(n&&(o=ER(s,e,o,t)),s.length>80*t){h=s[0],d=s[1];let v=h,x=d;for(let y=t;y<r;y+=t){const _=s[y],M=s[y+1];_<h&&(h=_),M<d&&(d=M),_>v&&(v=_),M>x&&(x=M)}m=Math.max(v-h,x-d),m=m!==0?32767/m:0}return Um(o,u,t,h,d,m,0),u}function ow(s,e,t,n,r){let o;if(r===UR(s,e,t,n)>0)for(let u=e;u<t;u+=n)o=CM(u/n|0,s[u],s[u+1],o);else for(let u=t-n;u>=e;u-=n)o=CM(u/n|0,s[u],s[u+1],o);return o&&gd(o,o.next)&&(zm(o),o=o.next),o}function gf(s,e){if(!s)return s;e||(e=s);let t=s,n;do if(n=!1,!t.steiner&&(gd(t,t.next)||Hi(t.prev,t,t.next)===0)){if(zm(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function Um(s,e,t,n,r,o,u){if(!s)return;!u&&o&&RR(s,n,r,o);let h=s;for(;s.prev!==s.next;){const d=s.prev,m=s.next;if(o?_R(s,n,r,o):bR(s)){e.push(d.i,s.i,m.i),zm(s),s=m.next,h=m.next;continue}if(s=m,s===h){u?u===1?(s=SR(gf(s),e),Um(s,e,t,n,r,o,2)):u===2&&MR(s,e,t,n,r,o):Um(gf(s),e,t,n,r,o,1);break}}}function bR(s){const e=s.prev,t=s,n=s.next;if(Hi(e,t,n)>=0)return!1;const r=e.x,o=t.x,u=n.x,h=e.y,d=t.y,m=n.y,v=Math.min(r,o,u),x=Math.min(h,d,m),y=Math.max(r,o,u),_=Math.max(h,d,m);let M=n.next;for(;M!==e;){if(M.x>=v&&M.x<=y&&M.y>=x&&M.y<=_&&dm(r,h,o,d,u,m,M.x,M.y)&&Hi(M.prev,M,M.next)>=0)return!1;M=M.next}return!0}function _R(s,e,t,n){const r=s.prev,o=s,u=s.next;if(Hi(r,o,u)>=0)return!1;const h=r.x,d=o.x,m=u.x,v=r.y,x=o.y,y=u.y,_=Math.min(h,d,m),M=Math.min(v,x,y),R=Math.max(h,d,m),A=Math.max(v,x,y),E=A_(_,M,e,t,n),N=A_(R,A,e,t,n);let I=s.prevZ,P=s.nextZ;for(;I&&I.z>=E&&P&&P.z<=N;){if(I.x>=_&&I.x<=R&&I.y>=M&&I.y<=A&&I!==r&&I!==u&&dm(h,v,d,x,m,y,I.x,I.y)&&Hi(I.prev,I,I.next)>=0||(I=I.prevZ,P.x>=_&&P.x<=R&&P.y>=M&&P.y<=A&&P!==r&&P!==u&&dm(h,v,d,x,m,y,P.x,P.y)&&Hi(P.prev,P,P.next)>=0))return!1;P=P.nextZ}for(;I&&I.z>=E;){if(I.x>=_&&I.x<=R&&I.y>=M&&I.y<=A&&I!==r&&I!==u&&dm(h,v,d,x,m,y,I.x,I.y)&&Hi(I.prev,I,I.next)>=0)return!1;I=I.prevZ}for(;P&&P.z<=N;){if(P.x>=_&&P.x<=R&&P.y>=M&&P.y<=A&&P!==r&&P!==u&&dm(h,v,d,x,m,y,P.x,P.y)&&Hi(P.prev,P,P.next)>=0)return!1;P=P.nextZ}return!0}function SR(s,e){let t=s;do{const n=t.prev,r=t.next.next;!gd(n,r)&&cw(n,t,t.next,r)&&Om(n,r)&&Om(r,n)&&(e.push(n.i,t.i,r.i),zm(t),zm(t.next),t=s=r),t=t.next}while(t!==s);return gf(t)}function MR(s,e,t,n,r,o){let u=s;do{let h=u.next.next;for(;h!==u.prev;){if(u.i!==h.i&&IR(u,h)){let d=uw(u,h);u=gf(u,u.next),d=gf(d,d.next),Um(u,e,t,n,r,o,0),Um(d,e,t,n,r,o,0);return}h=h.next}u=u.next}while(u!==s)}function ER(s,e,t,n){const r=[];for(let o=0,u=e.length;o<u;o++){const h=e[o]*n,d=o<u-1?e[o+1]*n:s.length,m=ow(s,h,d,n,!1);m===m.next&&(m.steiner=!0),r.push(DR(m))}r.sort(TR);for(let o=0;o<r.length;o++)t=wR(r[o],t);return t}function TR(s,e){let t=s.x-e.x;if(t===0&&(t=s.y-e.y,t===0)){const n=(s.next.y-s.y)/(s.next.x-s.x),r=(e.next.y-e.y)/(e.next.x-e.x);t=n-r}return t}function wR(s,e){const t=AR(s,e);if(!t)return e;const n=uw(t,s);return gf(n,n.next),gf(t,t.next)}function AR(s,e){let t=e;const n=s.x,r=s.y;let o=-1/0,u;if(gd(s,t))return t;do{if(gd(s,t.next))return t.next;if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const x=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(x<=n&&x>o&&(o=x,u=t.x<t.next.x?t:t.next,x===n))return u}t=t.next}while(t!==e);if(!u)return null;const h=u,d=u.x,m=u.y;let v=1/0;t=u;do{if(n>=t.x&&t.x>=d&&n!==t.x&&lw(r<m?n:o,r,d,m,r<m?o:n,r,t.x,t.y)){const x=Math.abs(r-t.y)/(n-t.x);Om(t,s)&&(x<v||x===v&&(t.x>u.x||t.x===u.x&&CR(u,t)))&&(u=t,v=x)}t=t.next}while(t!==h);return u}function CR(s,e){return Hi(s.prev,s,e.prev)<0&&Hi(e.next,s,s.next)<0}function RR(s,e,t,n){let r=s;do r.z===0&&(r.z=A_(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==s);r.prevZ.nextZ=null,r.prevZ=null,NR(r)}function NR(s){let e,t=1;do{let n=s,r;s=null;let o=null;for(e=0;n;){e++;let u=n,h=0;for(let m=0;m<t&&(h++,u=u.nextZ,!!u);m++);let d=t;for(;h>0||d>0&&u;)h!==0&&(d===0||!u||n.z<=u.z)?(r=n,n=n.nextZ,h--):(r=u,u=u.nextZ,d--),o?o.nextZ=r:s=r,r.prevZ=o,o=r;n=u}o.nextZ=null,t*=2}while(e>1);return s}function A_(s,e,t,n,r){return s=(s-t)*r|0,e=(e-n)*r|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,s|e<<1}function DR(s){let e=s,t=s;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==s);return t}function lw(s,e,t,n,r,o,u,h){return(r-u)*(e-h)>=(s-u)*(o-h)&&(s-u)*(n-h)>=(t-u)*(e-h)&&(t-u)*(o-h)>=(r-u)*(n-h)}function dm(s,e,t,n,r,o,u,h){return!(s===u&&e===h)&&lw(s,e,t,n,r,o,u,h)}function IR(s,e){return s.next.i!==e.i&&s.prev.i!==e.i&&!LR(s,e)&&(Om(s,e)&&Om(e,s)&&PR(s,e)&&(Hi(s.prev,s,e.prev)||Hi(s,e.prev,e))||gd(s,e)&&Hi(s.prev,s,s.next)>0&&Hi(e.prev,e,e.next)>0)}function Hi(s,e,t){return(e.y-s.y)*(t.x-e.x)-(e.x-s.x)*(t.y-e.y)}function gd(s,e){return s.x===e.x&&s.y===e.y}function cw(s,e,t,n){const r=Ev(Hi(s,e,t)),o=Ev(Hi(s,e,n)),u=Ev(Hi(t,n,s)),h=Ev(Hi(t,n,e));return!!(r!==o&&u!==h||r===0&&Mv(s,t,e)||o===0&&Mv(s,n,e)||u===0&&Mv(t,s,n)||h===0&&Mv(t,e,n))}function Mv(s,e,t){return e.x<=Math.max(s.x,t.x)&&e.x>=Math.min(s.x,t.x)&&e.y<=Math.max(s.y,t.y)&&e.y>=Math.min(s.y,t.y)}function Ev(s){return s>0?1:s<0?-1:0}function LR(s,e){let t=s;do{if(t.i!==s.i&&t.next.i!==s.i&&t.i!==e.i&&t.next.i!==e.i&&cw(t,t.next,s,e))return!0;t=t.next}while(t!==s);return!1}function Om(s,e){return Hi(s.prev,s,s.next)<0?Hi(s,e,s.next)>=0&&Hi(s,s.prev,e)>=0:Hi(s,e,s.prev)<0||Hi(s,s.next,e)<0}function PR(s,e){let t=s,n=!1;const r=(s.x+e.x)/2,o=(s.y+e.y)/2;do t.y>o!=t.next.y>o&&t.next.y!==t.y&&r<(t.next.x-t.x)*(o-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==s);return n}function uw(s,e){const t=C_(s.i,s.x,s.y),n=C_(e.i,e.x,e.y),r=s.next,o=e.prev;return s.next=e,e.prev=s,t.next=r,r.prev=t,n.next=t,t.prev=n,o.next=n,n.prev=o,n}function CM(s,e,t,n){const r=C_(s,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function zm(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function C_(s,e,t){return{i:s,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function UR(s,e,t,n){let r=0;for(let o=e,u=t-n;o<t;o+=n)r+=(s[u]-s[o])*(s[o+1]+s[u+1]),u=o;return r}class OR{static triangulate(e,t,n=2){return yR(e,t,n)}}class po{static area(e){const t=e.length;let n=0;for(let r=t-1,o=0;o<t;r=o++)n+=e[r].x*e[o].y-e[o].x*e[r].y;return n*.5}static isClockWise(e){return po.area(e)<0}static triangulateShape(e,t){const n=[],r=[],o=[];RM(e),NM(n,e);let u=e.length;t.forEach(RM);for(let d=0;d<t.length;d++)r.push(u),u+=t[d].length,NM(n,t[d]);const h=OR.triangulate(n,r);for(let d=0;d<h.length;d+=3)o.push(h.slice(d,d+3));return o}}function RM(s){const e=s.length;e>2&&s[e-1].equals(s[0])&&s.pop()}function NM(s,e){for(let t=0;t<e.length;t++)s.push(e[t].x),s.push(e[t].y)}class dy extends vn{constructor(e=new hf([new Je(.5,.5),new Je(-.5,.5),new Je(-.5,-.5),new Je(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],o=[];for(let h=0,d=e.length;h<d;h++){const m=e[h];u(m)}this.setAttribute("position",new Wt(r,3)),this.setAttribute("uv",new Wt(o,2)),this.computeVertexNormals();function u(h){const d=[],m=t.curveSegments!==void 0?t.curveSegments:12,v=t.steps!==void 0?t.steps:1,x=t.depth!==void 0?t.depth:1;let y=t.bevelEnabled!==void 0?t.bevelEnabled:!0,_=t.bevelThickness!==void 0?t.bevelThickness:.2,M=t.bevelSize!==void 0?t.bevelSize:_-.1,R=t.bevelOffset!==void 0?t.bevelOffset:0,A=t.bevelSegments!==void 0?t.bevelSegments:3;const E=t.extrudePath,N=t.UVGenerator!==void 0?t.UVGenerator:zR;let I,P=!1,z,U,H,V;if(E){I=E.getSpacedPoints(v),P=!0,y=!1;const Le=E.isCatmullRomCurve3?E.closed:!1;z=E.computeFrenetFrames(v,Le),U=new Q,H=new Q,V=new Q}y||(A=0,_=0,M=0,R=0);const L=h.extractPoints(m);let B=L.shape;const W=L.holes;if(!po.isClockWise(B)){B=B.reverse();for(let Le=0,Xe=W.length;Le<Xe;Le++){const qe=W[Le];po.isClockWise(qe)&&(W[Le]=qe.reverse())}}function J(Le){const qe=10000000000000001e-36;let ot=Le[0];for(let $=1;$<=Le.length;$++){const Pt=$%Le.length,St=Le[Pt],Ft=St.x-ot.x,ht=St.y-ot.y,K=Ft*Ft+ht*ht,F=Math.max(Math.abs(St.x),Math.abs(St.y),Math.abs(ot.x),Math.abs(ot.y)),ge=qe*F*F;if(K<=ge){Le.splice(Pt,1),$--;continue}ot=St}}J(B),W.forEach(J);const se=W.length,ce=B;for(let Le=0;Le<se;Le++){const Xe=W[Le];B=B.concat(Xe)}function Y(Le,Xe,qe){return Xe||Qt("ExtrudeGeometry: vec does not exist"),Le.clone().addScaledVector(Xe,qe)}const ne=B.length;function ve(Le,Xe,qe){let ot,$,Pt;const St=Le.x-Xe.x,Ft=Le.y-Xe.y,ht=qe.x-Le.x,K=qe.y-Le.y,F=St*St+Ft*Ft,ge=St*K-Ft*ht;if(Math.abs(ge)>Number.EPSILON){const ze=Math.sqrt(F),Ye=Math.sqrt(ht*ht+K*K),Be=Xe.x-Ft/ze,Dt=Xe.y+St/ze,yt=qe.x-K/Ye,kt=qe.y+ht/Ye,ke=((yt-Be)*K-(kt-Dt)*ht)/(St*K-Ft*ht);ot=Be+St*ke-Le.x,$=Dt+Ft*ke-Le.y;const Ce=ot*ot+$*$;if(Ce<=2)return new Je(ot,$);Pt=Math.sqrt(Ce/2)}else{let ze=!1;St>Number.EPSILON?ht>Number.EPSILON&&(ze=!0):St<-Number.EPSILON?ht<-Number.EPSILON&&(ze=!0):Math.sign(Ft)===Math.sign(K)&&(ze=!0),ze?(ot=-Ft,$=St,Pt=Math.sqrt(F)):(ot=St,$=Ft,Pt=Math.sqrt(F/2))}return new Je(ot/Pt,$/Pt)}const ae=[];for(let Le=0,Xe=ce.length,qe=Xe-1,ot=Le+1;Le<Xe;Le++,qe++,ot++)qe===Xe&&(qe=0),ot===Xe&&(ot=0),ae[Le]=ve(ce[Le],ce[qe],ce[ot]);const re=[];let j,le=ae.concat();for(let Le=0,Xe=se;Le<Xe;Le++){const qe=W[Le];j=[];for(let ot=0,$=qe.length,Pt=$-1,St=ot+1;ot<$;ot++,Pt++,St++)Pt===$&&(Pt=0),St===$&&(St=0),j[ot]=ve(qe[ot],qe[Pt],qe[St]);re.push(j),le=le.concat(j)}let Me;if(A===0)Me=po.triangulateShape(ce,W);else{const Le=[],Xe=[];for(let qe=0;qe<A;qe++){const ot=qe/A,$=_*Math.cos(ot*Math.PI/2),Pt=M*Math.sin(ot*Math.PI/2)+R;for(let St=0,Ft=ce.length;St<Ft;St++){const ht=Y(ce[St],ae[St],Pt);xt(ht.x,ht.y,-$),ot===0&&Le.push(ht)}for(let St=0,Ft=se;St<Ft;St++){const ht=W[St];j=re[St];const K=[];for(let F=0,ge=ht.length;F<ge;F++){const ze=Y(ht[F],j[F],Pt);xt(ze.x,ze.y,-$),ot===0&&K.push(ze)}ot===0&&Xe.push(K)}}Me=po.triangulateShape(Le,Xe)}const Ue=Me.length,lt=M+R;for(let Le=0;Le<ne;Le++){const Xe=y?Y(B[Le],le[Le],lt):B[Le];P?(H.copy(z.normals[0]).multiplyScalar(Xe.x),U.copy(z.binormals[0]).multiplyScalar(Xe.y),V.copy(I[0]).add(H).add(U),xt(V.x,V.y,V.z)):xt(Xe.x,Xe.y,0)}for(let Le=1;Le<=v;Le++)for(let Xe=0;Xe<ne;Xe++){const qe=y?Y(B[Xe],le[Xe],lt):B[Xe];P?(H.copy(z.normals[Le]).multiplyScalar(qe.x),U.copy(z.binormals[Le]).multiplyScalar(qe.y),V.copy(I[Le]).add(H).add(U),xt(V.x,V.y,V.z)):xt(qe.x,qe.y,x/v*Le)}for(let Le=A-1;Le>=0;Le--){const Xe=Le/A,qe=_*Math.cos(Xe*Math.PI/2),ot=M*Math.sin(Xe*Math.PI/2)+R;for(let $=0,Pt=ce.length;$<Pt;$++){const St=Y(ce[$],ae[$],ot);xt(St.x,St.y,x+qe)}for(let $=0,Pt=W.length;$<Pt;$++){const St=W[$];j=re[$];for(let Ft=0,ht=St.length;Ft<ht;Ft++){const K=Y(St[Ft],j[Ft],ot);P?xt(K.x,K.y+I[v-1].y,I[v-1].x+qe):xt(K.x,K.y,x+qe)}}}pe(),Re();function pe(){const Le=r.length/3;if(y){let Xe=0,qe=ne*Xe;for(let ot=0;ot<Ue;ot++){const $=Me[ot];dt($[2]+qe,$[1]+qe,$[0]+qe)}Xe=v+A*2,qe=ne*Xe;for(let ot=0;ot<Ue;ot++){const $=Me[ot];dt($[0]+qe,$[1]+qe,$[2]+qe)}}else{for(let Xe=0;Xe<Ue;Xe++){const qe=Me[Xe];dt(qe[2],qe[1],qe[0])}for(let Xe=0;Xe<Ue;Xe++){const qe=Me[Xe];dt(qe[0]+ne*v,qe[1]+ne*v,qe[2]+ne*v)}}n.addGroup(Le,r.length/3-Le,0)}function Re(){const Le=r.length/3;let Xe=0;it(ce,Xe),Xe+=ce.length;for(let qe=0,ot=W.length;qe<ot;qe++){const $=W[qe];it($,Xe),Xe+=$.length}n.addGroup(Le,r.length/3-Le,1)}function it(Le,Xe){let qe=Le.length;for(;--qe>=0;){const ot=qe;let $=qe-1;$<0&&($=Le.length-1);for(let Pt=0,St=v+A*2;Pt<St;Pt++){const Ft=ne*Pt,ht=ne*(Pt+1),K=Xe+ot+Ft,F=Xe+$+Ft,ge=Xe+$+ht,ze=Xe+ot+ht;Ut(K,F,ge,ze)}}}function xt(Le,Xe,qe){d.push(Le),d.push(Xe),d.push(qe)}function dt(Le,Xe,qe){xe(Le),xe(Xe),xe(qe);const ot=r.length/3,$=N.generateTopUV(n,r,ot-3,ot-2,ot-1);rt($[0]),rt($[1]),rt($[2])}function Ut(Le,Xe,qe,ot){xe(Le),xe(Xe),xe(ot),xe(Xe),xe(qe),xe(ot);const $=r.length/3,Pt=N.generateSideWallUV(n,r,$-6,$-3,$-2,$-1);rt(Pt[0]),rt(Pt[1]),rt(Pt[3]),rt(Pt[1]),rt(Pt[2]),rt(Pt[3])}function xe(Le){r.push(d[Le*3+0]),r.push(d[Le*3+1]),r.push(d[Le*3+2])}function rt(Le){o.push(Le.x),o.push(Le.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return BR(t,n,e)}static fromJSON(e,t){const n=[];for(let o=0,u=e.shapes.length;o<u;o++){const h=t[e.shapes[o]];n.push(h)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new Lx[r.type]().fromJSON(r)),new dy(n,e.options)}}const zR={generateTopUV:function(s,e,t,n,r){const o=e[t*3],u=e[t*3+1],h=e[n*3],d=e[n*3+1],m=e[r*3],v=e[r*3+1];return[new Je(o,u),new Je(h,d),new Je(m,v)]},generateSideWallUV:function(s,e,t,n,r,o){const u=e[t*3],h=e[t*3+1],d=e[t*3+2],m=e[n*3],v=e[n*3+1],x=e[n*3+2],y=e[r*3],_=e[r*3+1],M=e[r*3+2],R=e[o*3],A=e[o*3+1],E=e[o*3+2];return Math.abs(h-v)<Math.abs(u-m)?[new Je(u,1-d),new Je(m,1-x),new Je(y,1-M),new Je(R,1-E)]:[new Je(h,1-d),new Je(v,1-x),new Je(_,1-M),new Je(A,1-E)]}};function BR(s,e,t){if(t.shapes=[],Array.isArray(s))for(let n=0,r=s.length;n<r;n++){const o=s[n];t.shapes.push(o.uuid)}else t.shapes.push(s.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class $m extends Qc{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],o=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,o,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new $m(e.radius,e.detail)}}class py extends vn{constructor(e=[new Je(0,-.5),new Je(.5,0),new Je(0,.5)],t=12,n=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=on(r,0,Math.PI*2);const o=[],u=[],h=[],d=[],m=[],v=1/t,x=new Q,y=new Je,_=new Q,M=new Q,R=new Q;let A=0,E=0;for(let N=0;N<=e.length-1;N++)switch(N){case 0:A=e[N+1].x-e[N].x,E=e[N+1].y-e[N].y,_.x=E*1,_.y=-A,_.z=E*0,R.copy(_),_.normalize(),d.push(_.x,_.y,_.z);break;case e.length-1:d.push(R.x,R.y,R.z);break;default:A=e[N+1].x-e[N].x,E=e[N+1].y-e[N].y,_.x=E*1,_.y=-A,_.z=E*0,M.copy(_),_.x+=R.x,_.y+=R.y,_.z+=R.z,_.normalize(),d.push(_.x,_.y,_.z),R.copy(M)}for(let N=0;N<=t;N++){const I=n+N*v*r,P=Math.sin(I),z=Math.cos(I);for(let U=0;U<=e.length-1;U++){x.x=e[U].x*P,x.y=e[U].y,x.z=e[U].x*z,u.push(x.x,x.y,x.z),y.x=N/t,y.y=U/(e.length-1),h.push(y.x,y.y);const H=d[3*U+0]*P,V=d[3*U+1],L=d[3*U+0]*z;m.push(H,V,L)}}for(let N=0;N<t;N++)for(let I=0;I<e.length-1;I++){const P=I+N*e.length,z=P,U=P+e.length,H=P+e.length+1,V=P+1;o.push(z,U,V),o.push(H,V,U)}this.setIndex(o),this.setAttribute("position",new Wt(u,3)),this.setAttribute("uv",new Wt(h,2)),this.setAttribute("normal",new Wt(m,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new py(e.points,e.segments,e.phiStart,e.phiLength)}}class e0 extends Qc{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,r,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new e0(e.radius,e.detail)}}class Jc extends vn{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const o=e/2,u=t/2,h=Math.floor(n),d=Math.floor(r),m=h+1,v=d+1,x=e/h,y=t/d,_=[],M=[],R=[],A=[];for(let E=0;E<v;E++){const N=E*y-u;for(let I=0;I<m;I++){const P=I*x-o;M.push(P,-N,0),R.push(0,0,1),A.push(I/h),A.push(1-E/d)}}for(let E=0;E<d;E++)for(let N=0;N<h;N++){const I=N+m*E,P=N+m*(E+1),z=N+1+m*(E+1),U=N+1+m*E;_.push(I,P,U),_.push(P,z,U)}this.setIndex(_),this.setAttribute("position",new Wt(M,3)),this.setAttribute("normal",new Wt(R,3)),this.setAttribute("uv",new Wt(A,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Jc(e.width,e.height,e.widthSegments,e.heightSegments)}}class my extends vn{constructor(e=.5,t=1,n=32,r=1,o=0,u=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:o,thetaLength:u},n=Math.max(3,n),r=Math.max(1,r);const h=[],d=[],m=[],v=[];let x=e;const y=(t-e)/r,_=new Q,M=new Je;for(let R=0;R<=r;R++){for(let A=0;A<=n;A++){const E=o+A/n*u;_.x=x*Math.cos(E),_.y=x*Math.sin(E),d.push(_.x,_.y,_.z),m.push(0,0,1),M.x=(_.x/t+1)/2,M.y=(_.y/t+1)/2,v.push(M.x,M.y)}x+=y}for(let R=0;R<r;R++){const A=R*(n+1);for(let E=0;E<n;E++){const N=E+A,I=N,P=N+n+1,z=N+n+2,U=N+1;h.push(I,P,U),h.push(P,z,U)}}this.setIndex(h),this.setAttribute("position",new Wt(d,3)),this.setAttribute("normal",new Wt(m,3)),this.setAttribute("uv",new Wt(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new my(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class gy extends vn{constructor(e=new hf([new Je(0,.5),new Je(-.5,-.5),new Je(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],r=[],o=[],u=[];let h=0,d=0;if(Array.isArray(e)===!1)m(e);else for(let v=0;v<e.length;v++)m(e[v]),this.addGroup(h,d,v),h+=d,d=0;this.setIndex(n),this.setAttribute("position",new Wt(r,3)),this.setAttribute("normal",new Wt(o,3)),this.setAttribute("uv",new Wt(u,2));function m(v){const x=r.length/3,y=v.extractPoints(t);let _=y.shape;const M=y.holes;po.isClockWise(_)===!1&&(_=_.reverse());for(let A=0,E=M.length;A<E;A++){const N=M[A];po.isClockWise(N)===!0&&(M[A]=N.reverse())}const R=po.triangulateShape(_,M);for(let A=0,E=M.length;A<E;A++){const N=M[A];_=_.concat(N)}for(let A=0,E=_.length;A<E;A++){const N=_[A];r.push(N.x,N.y,0),o.push(0,0,1),u.push(N.x,N.y)}for(let A=0,E=R.length;A<E;A++){const N=R[A],I=N[0]+x,P=N[1]+x,z=N[2]+x;n.push(I,P,z),d+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return FR(t,e)}static fromJSON(e,t){const n=[];for(let r=0,o=e.shapes.length;r<o;r++){const u=t[e.shapes[r]];n.push(u)}return new gy(n,e.curveSegments)}}function FR(s,e){if(e.shapes=[],Array.isArray(s))for(let t=0,n=s.length;t<n;t++){const r=s[t];e.shapes.push(r.uuid)}else e.shapes.push(s.uuid);return e}class t0 extends vn{constructor(e=1,t=32,n=16,r=0,o=Math.PI*2,u=0,h=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:o,thetaStart:u,thetaLength:h},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const d=Math.min(u+h,Math.PI);let m=0;const v=[],x=new Q,y=new Q,_=[],M=[],R=[],A=[];for(let E=0;E<=n;E++){const N=[],I=E/n;let P=0;E===0&&u===0?P=.5/t:E===n&&d===Math.PI&&(P=-.5/t);for(let z=0;z<=t;z++){const U=z/t;x.x=-e*Math.cos(r+U*o)*Math.sin(u+I*h),x.y=e*Math.cos(u+I*h),x.z=e*Math.sin(r+U*o)*Math.sin(u+I*h),M.push(x.x,x.y,x.z),y.copy(x).normalize(),R.push(y.x,y.y,y.z),A.push(U+P,1-I),N.push(m++)}v.push(N)}for(let E=0;E<n;E++)for(let N=0;N<t;N++){const I=v[E][N+1],P=v[E][N],z=v[E+1][N],U=v[E+1][N+1];(E!==0||u>0)&&_.push(I,P,U),(E!==n-1||d<Math.PI)&&_.push(P,z,U)}this.setIndex(_),this.setAttribute("position",new Wt(M,3)),this.setAttribute("normal",new Wt(R,3)),this.setAttribute("uv",new Wt(A,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new t0(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class vy extends Qc{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,r,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new vy(e.radius,e.detail)}}class xy extends vn{constructor(e=1,t=.4,n=12,r=48,o=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:o},n=Math.floor(n),r=Math.floor(r);const u=[],h=[],d=[],m=[],v=new Q,x=new Q,y=new Q;for(let _=0;_<=n;_++)for(let M=0;M<=r;M++){const R=M/r*o,A=_/n*Math.PI*2;x.x=(e+t*Math.cos(A))*Math.cos(R),x.y=(e+t*Math.cos(A))*Math.sin(R),x.z=t*Math.sin(A),h.push(x.x,x.y,x.z),v.x=e*Math.cos(R),v.y=e*Math.sin(R),y.subVectors(x,v).normalize(),d.push(y.x,y.y,y.z),m.push(M/r),m.push(_/n)}for(let _=1;_<=n;_++)for(let M=1;M<=r;M++){const R=(r+1)*_+M-1,A=(r+1)*(_-1)+M-1,E=(r+1)*(_-1)+M,N=(r+1)*_+M;u.push(R,A,N),u.push(A,E,N)}this.setIndex(u),this.setAttribute("position",new Wt(h,3)),this.setAttribute("normal",new Wt(d,3)),this.setAttribute("uv",new Wt(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new xy(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class yy extends vn{constructor(e=1,t=.4,n=64,r=8,o=2,u=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:o,q:u},n=Math.floor(n),r=Math.floor(r);const h=[],d=[],m=[],v=[],x=new Q,y=new Q,_=new Q,M=new Q,R=new Q,A=new Q,E=new Q;for(let I=0;I<=n;++I){const P=I/n*o*Math.PI*2;N(P,o,u,e,_),N(P+.01,o,u,e,M),A.subVectors(M,_),E.addVectors(M,_),R.crossVectors(A,E),E.crossVectors(R,A),R.normalize(),E.normalize();for(let z=0;z<=r;++z){const U=z/r*Math.PI*2,H=-t*Math.cos(U),V=t*Math.sin(U);x.x=_.x+(H*E.x+V*R.x),x.y=_.y+(H*E.y+V*R.y),x.z=_.z+(H*E.z+V*R.z),d.push(x.x,x.y,x.z),y.subVectors(x,_).normalize(),m.push(y.x,y.y,y.z),v.push(I/n),v.push(z/r)}}for(let I=1;I<=n;I++)for(let P=1;P<=r;P++){const z=(r+1)*(I-1)+(P-1),U=(r+1)*I+(P-1),H=(r+1)*I+P,V=(r+1)*(I-1)+P;h.push(z,U,V),h.push(U,H,V)}this.setIndex(h),this.setAttribute("position",new Wt(d,3)),this.setAttribute("normal",new Wt(m,3)),this.setAttribute("uv",new Wt(v,2));function N(I,P,z,U,H){const V=Math.cos(I),L=Math.sin(I),B=z/P*I,W=Math.cos(B);H.x=U*(2+W)*.5*V,H.y=U*(2+W)*L*.5,H.z=U*Math.sin(B)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new yy(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class by extends vn{constructor(e=new y1(new Q(-1,-1,0),new Q(-1,1,0),new Q(1,1,0)),t=64,n=1,r=8,o=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:o};const u=e.computeFrenetFrames(t,o);this.tangents=u.tangents,this.normals=u.normals,this.binormals=u.binormals;const h=new Q,d=new Q,m=new Je;let v=new Q;const x=[],y=[],_=[],M=[];R(),this.setIndex(M),this.setAttribute("position",new Wt(x,3)),this.setAttribute("normal",new Wt(y,3)),this.setAttribute("uv",new Wt(_,2));function R(){for(let I=0;I<t;I++)A(I);A(o===!1?t:0),N(),E()}function A(I){v=e.getPointAt(I/t,v);const P=u.normals[I],z=u.binormals[I];for(let U=0;U<=r;U++){const H=U/r*Math.PI*2,V=Math.sin(H),L=-Math.cos(H);d.x=L*P.x+V*z.x,d.y=L*P.y+V*z.y,d.z=L*P.z+V*z.z,d.normalize(),y.push(d.x,d.y,d.z),h.x=v.x+n*d.x,h.y=v.y+n*d.y,h.z=v.z+n*d.z,x.push(h.x,h.y,h.z)}}function E(){for(let I=1;I<=t;I++)for(let P=1;P<=r;P++){const z=(r+1)*(I-1)+(P-1),U=(r+1)*I+(P-1),H=(r+1)*I+P,V=(r+1)*(I-1)+P;M.push(z,U,V),M.push(U,H,V)}}function N(){for(let I=0;I<=t;I++)for(let P=0;P<=r;P++)m.x=I/t,m.y=P/r,_.push(m.x,m.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new by(new Lx[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class fw extends vn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,r=new Q,o=new Q;if(e.index!==null){const u=e.attributes.position,h=e.index;let d=e.groups;d.length===0&&(d=[{start:0,count:h.count,materialIndex:0}]);for(let m=0,v=d.length;m<v;++m){const x=d[m],y=x.start,_=x.count;for(let M=y,R=y+_;M<R;M+=3)for(let A=0;A<3;A++){const E=h.getX(M+A),N=h.getX(M+(A+1)%3);r.fromBufferAttribute(u,E),o.fromBufferAttribute(u,N),DM(r,o,n)===!0&&(t.push(r.x,r.y,r.z),t.push(o.x,o.y,o.z))}}}else{const u=e.attributes.position;for(let h=0,d=u.count/3;h<d;h++)for(let m=0;m<3;m++){const v=3*h+m,x=3*h+(m+1)%3;r.fromBufferAttribute(u,v),o.fromBufferAttribute(u,x),DM(r,o,n)===!0&&(t.push(r.x,r.y,r.z),t.push(o.x,o.y,o.z))}}this.setAttribute("position",new Wt(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function DM(s,e,t){const n=`${s.x},${s.y},${s.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${s.x},${s.y},${s.z}`;return t.has(n)===!0||t.has(r)===!0?!1:(t.add(n),t.add(r),!0)}var IM=Object.freeze({__proto__:null,BoxGeometry:bf,CapsuleGeometry:cy,CircleGeometry:uy,ConeGeometry:Jm,CylinderGeometry:Qm,DodecahedronGeometry:fy,EdgesGeometry:tw,ExtrudeGeometry:dy,IcosahedronGeometry:$m,LatheGeometry:py,OctahedronGeometry:e0,PlaneGeometry:Jc,PolyhedronGeometry:Qc,RingGeometry:my,ShapeGeometry:gy,SphereGeometry:t0,TetrahedronGeometry:vy,TorusGeometry:xy,TorusKnotGeometry:yy,TubeGeometry:by,WireframeGeometry:fw});class hw extends cs{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Lt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class _1 extends ls{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class _y extends cs{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Lt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Lt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Kc,this.normalScale=new Je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ua,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Ux extends _y{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Je(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return on(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Lt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Lt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Lt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class dw extends cs{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Lt(16777215),this.specular=new Lt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Lt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Kc,this.normalScale=new Je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ua,this.combine=Wm,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class pw extends cs{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Lt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Lt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Kc,this.normalScale=new Je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class mw extends cs{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Kc,this.normalScale=new Je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class gw extends cs{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Lt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Lt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Kc,this.normalScale=new Je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ua,this.combine=Wm,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class S1 extends cs{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=NT,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class M1 extends cs{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class vw extends cs{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Lt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Kc,this.normalScale=new Je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}}class xw extends ws{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function lf(s,e){return!s||s.constructor===e?s:typeof e.BYTES_PER_ELEMENT=="number"?new e(s):Array.prototype.slice.call(s)}function yw(s){function e(r,o){return s[r]-s[o]}const t=s.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(e),n}function R_(s,e,t){const n=s.length,r=new s.constructor(n);for(let o=0,u=0;u!==n;++o){const h=t[o]*e;for(let d=0;d!==e;++d)r[u++]=s[h+d]}return r}function E1(s,e,t,n){let r=1,o=s[0];for(;o!==void 0&&o[n]===void 0;)o=s[r++];if(o===void 0)return;let u=o[n];if(u!==void 0)if(Array.isArray(u))do u=o[n],u!==void 0&&(e.push(o.time),t.push(...u)),o=s[r++];while(o!==void 0);else if(u.toArray!==void 0)do u=o[n],u!==void 0&&(e.push(o.time),u.toArray(t,t.length)),o=s[r++];while(o!==void 0);else do u=o[n],u!==void 0&&(e.push(o.time),t.push(u)),o=s[r++];while(o!==void 0)}function kR(s,e,t,n,r=30){const o=s.clone();o.name=e;const u=[];for(let d=0;d<o.tracks.length;++d){const m=o.tracks[d],v=m.getValueSize(),x=[],y=[];for(let _=0;_<m.times.length;++_){const M=m.times[_]*r;if(!(M<t||M>=n)){x.push(m.times[_]);for(let R=0;R<v;++R)y.push(m.values[_*v+R])}}x.length!==0&&(m.times=lf(x,m.times.constructor),m.values=lf(y,m.values.constructor),u.push(m))}o.tracks=u;let h=1/0;for(let d=0;d<o.tracks.length;++d)h>o.tracks[d].times[0]&&(h=o.tracks[d].times[0]);for(let d=0;d<o.tracks.length;++d)o.tracks[d].shift(-1*h);return o.resetDuration(),o}function VR(s,e=0,t=s,n=30){n<=0&&(n=30);const r=t.tracks.length,o=e/n;for(let u=0;u<r;++u){const h=t.tracks[u],d=h.ValueTypeName;if(d==="bool"||d==="string")continue;const m=s.tracks.find(function(E){return E.name===h.name&&E.ValueTypeName===d});if(m===void 0)continue;let v=0;const x=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(v=x/3);let y=0;const _=m.getValueSize();m.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(y=_/3);const M=h.times.length-1;let R;if(o<=h.times[0]){const E=v,N=x-v;R=h.values.slice(E,N)}else if(o>=h.times[M]){const E=M*x+v,N=E+x-v;R=h.values.slice(E,N)}else{const E=h.createInterpolant(),N=v,I=x-v;E.evaluate(o),R=E.resultBuffer.slice(N,I)}d==="quaternion"&&new as().fromArray(R).normalize().conjugate().toArray(R);const A=m.times.length;for(let E=0;E<A;++E){const N=E*_+y;if(d==="quaternion")as.multiplyQuaternionsFlat(m.values,N,R,0,m.values,N);else{const I=_-y*2;for(let P=0;P<I;++P)m.values[N+P]-=R[P]}}}return s.blendMode=s1,s}class HR{static convertArray(e,t){return lf(e,t)}static isTypedArray(e){return FT(e)}static getKeyframeOrder(e){return yw(e)}static sortedArray(e,t,n){return R_(e,t,n)}static flattenJSON(e,t,n,r){E1(e,t,n,r)}static subclip(e,t,n,r,o=30){return kR(e,t,n,r,o)}static makeClipAdditive(e,t=0,n=e,r=30){return VR(e,t,n,r)}}class n0{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],o=t[n-1];e:{t:{let u;n:{i:if(!(e<r)){for(let h=n+2;;){if(r===void 0){if(e<o)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===h)break;if(o=r,r=t[++n],e<r)break t}u=t.length;break n}if(!(e>=o)){const h=t[1];e<h&&(n=2,o=h);for(let d=n-2;;){if(o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===d)break;if(r=o,o=t[--n-1],e>=o)break t}u=n,n=0;break n}break e}for(;n<u;){const h=n+u>>>1;e<t[h]?u=h:n=h+1}if(r=t[n],o=t[n-1],o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,o,r)}return this.interpolate_(n,o,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,o=e*r;for(let u=0;u!==r;++u)t[u]=n[o+u];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class bw extends n0{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:sf,endingEnd:sf}}intervalChanged_(e,t,n){const r=this.parameterPositions;let o=e-2,u=e+1,h=r[o],d=r[u];if(h===void 0)switch(this.getSettings_().endingStart){case af:o=e,h=2*t-n;break;case Nm:o=r.length-2,h=t+r[o]-r[o+1];break;default:o=e,h=n}if(d===void 0)switch(this.getSettings_().endingEnd){case af:u=e,d=2*n-t;break;case Nm:u=1,d=n+r[1]-r[0];break;default:u=e-1,d=t}const m=(n-t)*.5,v=this.valueSize;this._weightPrev=m/(t-h),this._weightNext=m/(d-n),this._offsetPrev=o*v,this._offsetNext=u*v}interpolate_(e,t,n,r){const o=this.resultBuffer,u=this.sampleValues,h=this.valueSize,d=e*h,m=d-h,v=this._offsetPrev,x=this._offsetNext,y=this._weightPrev,_=this._weightNext,M=(n-t)/(r-t),R=M*M,A=R*M,E=-y*A+2*y*R-y*M,N=(1+y)*A+(-1.5-2*y)*R+(-.5+y)*M+1,I=(-1-_)*A+(1.5+_)*R+.5*M,P=_*A-_*R;for(let z=0;z!==h;++z)o[z]=E*u[v+z]+N*u[m+z]+I*u[d+z]+P*u[x+z];return o}}class T1 extends n0{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const o=this.resultBuffer,u=this.sampleValues,h=this.valueSize,d=e*h,m=d-h,v=(n-t)/(r-t),x=1-v;for(let y=0;y!==h;++y)o[y]=u[m+y]*x+u[d+y]*v;return o}}class _w extends n0{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Ga{constructor(e,t,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=lf(t,this.TimeBufferType),this.values=lf(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:lf(e.times,Array),values:lf(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new _w(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new T1(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new bw(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Rm:t=this.InterpolantFactoryMethodDiscrete;break;case Nx:t=this.InterpolantFactoryMethodLinear;break;case Fv:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return zt("KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Rm;case this.InterpolantFactoryMethodLinear:return Nx;case this.InterpolantFactoryMethodSmooth:return Fv}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let o=0,u=r-1;for(;o!==r&&n[o]<e;)++o;for(;u!==-1&&n[u]>t;)--u;if(++u,o!==0||u!==r){o>=u&&(u=Math.max(u,1),o=u-1);const h=this.getValueSize();this.times=n.slice(o,u),this.values=this.values.slice(o*h,u*h)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(Qt("KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,o=n.length;o===0&&(Qt("KeyframeTrack: Track is empty.",this),e=!1);let u=null;for(let h=0;h!==o;h++){const d=n[h];if(typeof d=="number"&&isNaN(d)){Qt("KeyframeTrack: Time is not a valid number.",this,h,d),e=!1;break}if(u!==null&&u>d){Qt("KeyframeTrack: Out of order keys.",this,h,d,u),e=!1;break}u=d}if(r!==void 0&&FT(r))for(let h=0,d=r.length;h!==d;++h){const m=r[h];if(isNaN(m)){Qt("KeyframeTrack: Value is not a valid number.",this,h,m),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===Fv,o=e.length-1;let u=1;for(let h=1;h<o;++h){let d=!1;const m=e[h],v=e[h+1];if(m!==v&&(h!==1||m!==e[0]))if(r)d=!0;else{const x=h*n,y=x-n,_=x+n;for(let M=0;M!==n;++M){const R=t[x+M];if(R!==t[y+M]||R!==t[_+M]){d=!0;break}}}if(d){if(h!==u){e[u]=e[h];const x=h*n,y=u*n;for(let _=0;_!==n;++_)t[y+_]=t[x+_]}++u}}if(o>0){e[u]=e[o];for(let h=o*n,d=u*n,m=0;m!==n;++m)t[d+m]=t[h+m];++u}return u!==e.length?(this.times=e.slice(0,u),this.values=t.slice(0,u*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,r=new n(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Ga.prototype.ValueTypeName="";Ga.prototype.TimeBufferType=Float32Array;Ga.prototype.ValueBufferType=Float32Array;Ga.prototype.DefaultInterpolation=Nx;class _f extends Ga{constructor(e,t,n){super(e,t,n)}}_f.prototype.ValueTypeName="bool";_f.prototype.ValueBufferType=Array;_f.prototype.DefaultInterpolation=Rm;_f.prototype.InterpolantFactoryMethodLinear=void 0;_f.prototype.InterpolantFactoryMethodSmooth=void 0;class w1 extends Ga{constructor(e,t,n,r){super(e,t,n,r)}}w1.prototype.ValueTypeName="color";class Bm extends Ga{constructor(e,t,n,r){super(e,t,n,r)}}Bm.prototype.ValueTypeName="number";class Sw extends n0{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const o=this.resultBuffer,u=this.sampleValues,h=this.valueSize,d=(n-t)/(r-t);let m=e*h;for(let v=m+h;m!==v;m+=4)as.slerpFlat(o,0,u,m-h,u,m,d);return o}}class i0 extends Ga{constructor(e,t,n,r){super(e,t,n,r)}InterpolantFactoryMethodLinear(e){return new Sw(this.times,this.values,this.getValueSize(),e)}}i0.prototype.ValueTypeName="quaternion";i0.prototype.InterpolantFactoryMethodSmooth=void 0;class Sf extends Ga{constructor(e,t,n){super(e,t,n)}}Sf.prototype.ValueTypeName="string";Sf.prototype.ValueBufferType=Array;Sf.prototype.DefaultInterpolation=Rm;Sf.prototype.InterpolantFactoryMethodLinear=void 0;Sf.prototype.InterpolantFactoryMethodSmooth=void 0;class Fm extends Ga{constructor(e,t,n,r){super(e,t,n,r)}}Fm.prototype.ValueTypeName="vector";class km{constructor(e="",t=-1,n=[],r=Zx){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=oa(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let u=0,h=n.length;u!==h;++u)t.push(jR(n[u]).scale(r));const o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o.userData=JSON.parse(e.userData||"{}"),o}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let o=0,u=n.length;o!==u;++o)t.push(Ga.toJSON(n[o]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const o=t.length,u=[];for(let h=0;h<o;h++){let d=[],m=[];d.push((h+o-1)%o,h,(h+1)%o),m.push(0,1,0);const v=yw(d);d=R_(d,1,v),m=R_(m,1,v),!r&&d[0]===0&&(d.push(o),m.push(m[0])),u.push(new Bm(".morphTargetInfluences["+t[h].name+"]",d,m).scale(1/n))}return new this(e,-1,u)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},o=/^([\w-]*?)([\d]+)$/;for(let h=0,d=e.length;h<d;h++){const m=e[h],v=m.name.match(o);if(v&&v.length>1){const x=v[1];let y=r[x];y||(r[x]=y=[]),y.push(m)}}const u=[];for(const h in r)u.push(this.CreateFromMorphTargetSequence(h,r[h],t,n));return u}static parseAnimation(e,t){if(zt("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return Qt("AnimationClip: No animation in JSONLoader data."),null;const n=function(x,y,_,M,R){if(_.length!==0){const A=[],E=[];E1(_,A,E,M),A.length!==0&&R.push(new x(y,A,E))}},r=[],o=e.name||"default",u=e.fps||30,h=e.blendMode;let d=e.length||-1;const m=e.hierarchy||[];for(let x=0;x<m.length;x++){const y=m[x].keys;if(!(!y||y.length===0))if(y[0].morphTargets){const _={};let M;for(M=0;M<y.length;M++)if(y[M].morphTargets)for(let R=0;R<y[M].morphTargets.length;R++)_[y[M].morphTargets[R]]=-1;for(const R in _){const A=[],E=[];for(let N=0;N!==y[M].morphTargets.length;++N){const I=y[M];A.push(I.time),E.push(I.morphTarget===R?1:0)}r.push(new Bm(".morphTargetInfluence["+R+"]",A,E))}d=_.length*u}else{const _=".bones["+t[x].name+"]";n(Fm,_+".position",y,"pos",r),n(i0,_+".quaternion",y,"rot",r),n(Fm,_+".scale",y,"scl",r)}}return r.length===0?null:new this(o,d,r,h)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,r=e.length;n!==r;++n){const o=this.tracks[n];t=Math.max(t,o.times[o.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function GR(s){switch(s.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Bm;case"vector":case"vector2":case"vector3":case"vector4":return Fm;case"color":return w1;case"quaternion":return i0;case"bool":case"boolean":return _f;case"string":return Sf}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+s)}function jR(s){if(s.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=GR(s.type);if(s.times===void 0){const t=[],n=[];E1(s.keys,t,n,"value"),s.times=t,s.values=n}return e.parse!==void 0?e.parse(s):new e(s.name,s.times,s.values,s.interpolation)}const Jo={enabled:!1,files:{},add:function(s,e){this.enabled!==!1&&(this.files[s]=e)},get:function(s){if(this.enabled!==!1)return this.files[s]},remove:function(s){delete this.files[s]},clear:function(){this.files={}}};class Sy{constructor(e,t,n){const r=this;let o=!1,u=0,h=0,d;const m=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this._abortController=null,this.itemStart=function(v){h++,o===!1&&r.onStart!==void 0&&r.onStart(v,u,h),o=!0},this.itemEnd=function(v){u++,r.onProgress!==void 0&&r.onProgress(v,u,h),u===h&&(o=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(v){r.onError!==void 0&&r.onError(v)},this.resolveURL=function(v){return d?d(v):v},this.setURLModifier=function(v){return d=v,this},this.addHandler=function(v,x){return m.push(v,x),this},this.removeHandler=function(v){const x=m.indexOf(v);return x!==-1&&m.splice(x,2),this},this.getHandler=function(v){for(let x=0,y=m.length;x<y;x+=2){const _=m[x],M=m[x+1];if(_.global&&(_.lastIndex=0),_.test(v))return M}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const Mw=new Sy;class As{constructor(e){this.manager=e!==void 0?e:Mw,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,o){n.load(e,r,t,o)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}As.DEFAULT_MATERIAL_NAME="__DEFAULT";const zl={};class WR extends Error{constructor(e,t){super(e),this.response=t}}class la extends As{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=Jo.get(`file:${e}`);if(o!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(o),this.manager.itemEnd(e)},0),o;if(zl[e]!==void 0){zl[e].push({onLoad:t,onProgress:n,onError:r});return}zl[e]=[],zl[e].push({onLoad:t,onProgress:n,onError:r});const u=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),h=this.mimeType,d=this.responseType;fetch(u).then(m=>{if(m.status===200||m.status===0){if(m.status===0&&zt("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||m.body===void 0||m.body.getReader===void 0)return m;const v=zl[e],x=m.body.getReader(),y=m.headers.get("X-File-Size")||m.headers.get("Content-Length"),_=y?parseInt(y):0,M=_!==0;let R=0;const A=new ReadableStream({start(E){N();function N(){x.read().then(({done:I,value:P})=>{if(I)E.close();else{R+=P.byteLength;const z=new ProgressEvent("progress",{lengthComputable:M,loaded:R,total:_});for(let U=0,H=v.length;U<H;U++){const V=v[U];V.onProgress&&V.onProgress(z)}E.enqueue(P),N()}},I=>{E.error(I)})}}});return new Response(A)}else throw new WR(`fetch for "${m.url}" responded with ${m.status}: ${m.statusText}`,m)}).then(m=>{switch(d){case"arraybuffer":return m.arrayBuffer();case"blob":return m.blob();case"document":return m.text().then(v=>new DOMParser().parseFromString(v,h));case"json":return m.json();default:if(h==="")return m.text();{const x=/charset="?([^;"\s]*)"?/i.exec(h),y=x&&x[1]?x[1].toLowerCase():void 0,_=new TextDecoder(y);return m.arrayBuffer().then(M=>_.decode(M))}}}).then(m=>{Jo.add(`file:${e}`,m);const v=zl[e];delete zl[e];for(let x=0,y=v.length;x<y;x++){const _=v[x];_.onLoad&&_.onLoad(m)}}).catch(m=>{const v=zl[e];if(v===void 0)throw this.manager.itemError(e),m;delete zl[e];for(let x=0,y=v.length;x<y;x++){const _=v[x];_.onError&&_.onError(m)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class XR extends As{constructor(e){super(e)}load(e,t,n,r){const o=this,u=new la(this.manager);u.setPath(this.path),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(e,function(h){try{t(o.parse(JSON.parse(h)))}catch(d){r?r(d):Qt(d),o.manager.itemError(e)}},n,r)}parse(e){const t=[];for(let n=0;n<e.length;n++){const r=km.parse(e[n]);t.push(r)}return t}}class qR extends As{constructor(e){super(e)}load(e,t,n,r){const o=this,u=[],h=new ly,d=new la(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(o.withCredentials);let m=0;function v(x){d.load(e[x],function(y){const _=o.parse(y,!0);u[x]={width:_.width,height:_.height,format:_.format,mipmaps:_.mipmaps},m+=1,m===6&&(_.mipmapCount===1&&(h.minFilter=Gn),h.image=u,h.format=_.format,h.needsUpdate=!0,t&&t(h))},n,r)}if(Array.isArray(e))for(let x=0,y=e.length;x<y;++x)v(x);else d.load(e,function(x){const y=o.parse(x,!0);if(y.isCubemap){const _=y.mipmaps.length/y.mipmapCount;for(let M=0;M<_;M++){u[M]={mipmaps:[]};for(let R=0;R<y.mipmapCount;R++)u[M].mipmaps.push(y.mipmaps[M*y.mipmapCount+R]),u[M].format=y.format,u[M].width=y.width,u[M].height=y.height}h.image=u}else h.image.width=y.width,h.image.height=y.height,h.mipmaps=y.mipmaps;y.mipmapCount===1&&(h.minFilter=Gn),h.format=y.format,h.needsUpdate=!0,t&&t(h)},n,r);return h}}const Xh=new WeakMap;class Vm extends As{constructor(e){super(e)}load(e,t,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,u=Jo.get(`image:${e}`);if(u!==void 0){if(u.complete===!0)o.manager.itemStart(e),setTimeout(function(){t&&t(u),o.manager.itemEnd(e)},0);else{let x=Xh.get(u);x===void 0&&(x=[],Xh.set(u,x)),x.push({onLoad:t,onError:r})}return u}const h=Lm("img");function d(){v(),t&&t(this);const x=Xh.get(this)||[];for(let y=0;y<x.length;y++){const _=x[y];_.onLoad&&_.onLoad(this)}Xh.delete(this),o.manager.itemEnd(e)}function m(x){v(),r&&r(x),Jo.remove(`image:${e}`);const y=Xh.get(this)||[];for(let _=0;_<y.length;_++){const M=y[_];M.onError&&M.onError(x)}Xh.delete(this),o.manager.itemError(e),o.manager.itemEnd(e)}function v(){h.removeEventListener("load",d,!1),h.removeEventListener("error",m,!1)}return h.addEventListener("load",d,!1),h.addEventListener("error",m,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(h.crossOrigin=this.crossOrigin),Jo.add(`image:${e}`,h),o.manager.itemStart(e),h.src=e,h}}class Ew extends As{constructor(e){super(e)}load(e,t,n,r){const o=new Zm;o.colorSpace=Gr;const u=new Vm(this.manager);u.setCrossOrigin(this.crossOrigin),u.setPath(this.path);let h=0;function d(m){u.load(e[m],function(v){o.images[m]=v,h++,h===6&&(o.needsUpdate=!0,t&&t(o))},void 0,r)}for(let m=0;m<e.length;++m)d(m);return o}}class A1 extends As{constructor(e){super(e)}load(e,t,n,r){const o=this,u=new Va,h=new la(this.manager);return h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setPath(this.path),h.setWithCredentials(o.withCredentials),h.load(e,function(d){let m;try{m=o.parse(d)}catch(v){if(r!==void 0)r(v);else{v(v);return}}m.image!==void 0?u.image=m.image:m.data!==void 0&&(u.image.width=m.width,u.image.height=m.height,u.image.data=m.data),u.wrapS=m.wrapS!==void 0?m.wrapS:Ki,u.wrapT=m.wrapT!==void 0?m.wrapT:Ki,u.magFilter=m.magFilter!==void 0?m.magFilter:Gn,u.minFilter=m.minFilter!==void 0?m.minFilter:Gn,u.anisotropy=m.anisotropy!==void 0?m.anisotropy:1,m.colorSpace!==void 0&&(u.colorSpace=m.colorSpace),m.flipY!==void 0&&(u.flipY=m.flipY),m.format!==void 0&&(u.format=m.format),m.type!==void 0&&(u.type=m.type),m.mipmaps!==void 0&&(u.mipmaps=m.mipmaps,u.minFilter=Qo),m.mipmapCount===1&&(u.minFilter=Gn),m.generateMipmaps!==void 0&&(u.generateMipmaps=m.generateMipmaps),u.needsUpdate=!0,t&&t(u,m)},n,r),u}}class YR extends As{constructor(e){super(e)}load(e,t,n,r){const o=new oi,u=new Vm(this.manager);return u.setCrossOrigin(this.crossOrigin),u.setPath(this.path),u.load(e,function(h){o.image=h,o.needsUpdate=!0,t!==void 0&&t(o)},n,r),o}}class $c extends Nn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Lt(e),this.intensity=t}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t}}class Tw extends $c{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Nn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Lt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}toJSON(e){const t=super.toJSON(e);return t.object.groundColor=this.groundColor.getHex(),t}}const qb=new cn,LM=new Q,PM=new Q;class C1{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Je(512,512),this.mapType=Dr,this.map=null,this.mapPass=null,this.matrix=new cn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new _d,this._frameExtents=new Je(1,1),this._viewportCount=1,this._viewports=[new hi(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;LM.setFromMatrixPosition(e.matrixWorld),t.position.copy(LM),PM.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(PM),t.updateMatrixWorld(),qb.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(qb,t.coordinateSystem,t.reversedDepth),t.reversedDepth?n.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(qb)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class ZR extends C1{constructor(){super(new Vi(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=fd*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,o=e.distance||t.far;(n!==t.fov||r!==t.aspect||o!==t.far)&&(t.fov=n,t.aspect=r,t.far=o,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class ww extends $c{constructor(e,t,n=0,r=Math.PI/3,o=0,u=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Nn.DEFAULT_UP),this.updateMatrix(),this.target=new Nn,this.distance=n,this.angle=r,this.penumbra=o,this.decay=u,this.map=null,this.shadow=new ZR}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.map=e.map,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.angle=this.angle,t.object.decay=this.decay,t.object.penumbra=this.penumbra,t.object.target=this.target.uuid,this.map&&this.map.isTexture&&(t.object.map=this.map.toJSON(e).uuid),t.object.shadow=this.shadow.toJSON(),t}}class KR extends C1{constructor(){super(new Vi(90,1,.5,500)),this.isPointLightShadow=!0}}class Aw extends $c{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new KR}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.decay=this.decay,t.object.shadow=this.shadow.toJSON(),t}}class Ha extends ty{constructor(e=-1,t=1,n=1,r=-1,o=.1,u=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=o,this.far=u,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,o,u){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=o,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let o=n-e,u=n+e,h=r+t,d=r-t;if(this.view!==null&&this.view.enabled){const m=(this.right-this.left)/this.view.fullWidth/this.zoom,v=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=m*this.view.offsetX,u=o+m*this.view.width,h-=v*this.view.offsetY,d=h-v*this.view.height}this.projectionMatrix.makeOrthographic(o,u,h,d,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class QR extends C1{constructor(){super(new Ha(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Cw extends $c{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Nn.DEFAULT_UP),this.updateMatrix(),this.target=new Nn,this.shadow=new QR}dispose(){super.dispose(),this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.shadow=this.shadow.toJSON(),t.object.target=this.target.uuid,t}}class Rw extends $c{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Nw extends $c{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class R1{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Q)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,o=e.z,u=this.coefficients;return t.copy(u[0]).multiplyScalar(.282095),t.addScaledVector(u[1],.488603*r),t.addScaledVector(u[2],.488603*o),t.addScaledVector(u[3],.488603*n),t.addScaledVector(u[4],1.092548*(n*r)),t.addScaledVector(u[5],1.092548*(r*o)),t.addScaledVector(u[6],.315392*(3*o*o-1)),t.addScaledVector(u[7],1.092548*(n*o)),t.addScaledVector(u[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,o=e.z,u=this.coefficients;return t.copy(u[0]).multiplyScalar(.886227),t.addScaledVector(u[1],2*.511664*r),t.addScaledVector(u[2],2*.511664*o),t.addScaledVector(u[3],2*.511664*n),t.addScaledVector(u[4],2*.429043*n*r),t.addScaledVector(u[5],2*.429043*r*o),t.addScaledVector(u[6],.743125*o*o-.247708),t.addScaledVector(u[7],2*.429043*n*o),t.addScaledVector(u[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const n=e.x,r=e.y,o=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*o,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*o,t[6]=.315392*(3*o*o-1),t[7]=1.092548*n*o,t[8]=.546274*(n*n-r*r)}}class Dw extends $c{constructor(e=new R1,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class My extends As{constructor(e){super(e),this.textures={}}load(e,t,n,r){const o=this,u=new la(o.manager);u.setPath(o.path),u.setRequestHeader(o.requestHeader),u.setWithCredentials(o.withCredentials),u.load(e,function(h){try{t(o.parse(JSON.parse(h)))}catch(d){r?r(d):Qt(d),o.manager.itemError(e)}},n,r)}parse(e){const t=this.textures;function n(o){return t[o]===void 0&&zt("MaterialLoader: Undefined texture",o),t[o]}const r=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new Lt().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(r.dispersion=e.dispersion),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.allowOverride!==void 0&&(r.allowOverride=e.allowOverride),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const o in e.uniforms){const u=e.uniforms[o];switch(r.uniforms[o]={},u.type){case"t":r.uniforms[o].value=n(u.value);break;case"c":r.uniforms[o].value=new Lt().setHex(u.value);break;case"v2":r.uniforms[o].value=new Je().fromArray(u.value);break;case"v3":r.uniforms[o].value=new Q().fromArray(u.value);break;case"v4":r.uniforms[o].value=new hi().fromArray(u.value);break;case"m3":r.uniforms[o].value=new bn().fromArray(u.value);break;case"m4":r.uniforms[o].value=new cn().fromArray(u.value);break;default:r.uniforms[o].value=u.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const o in e.extensions)r.extensions[o]=e.extensions[o];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=n(e.map)),e.matcap!==void 0&&(r.matcap=n(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let o=e.normalScale;Array.isArray(o)===!1&&(o=[o,o]),r.normalScale=new Je().fromArray(o)}return e.displacementMap!==void 0&&(r.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=n(e.envMap)),e.envMapRotation!==void 0&&r.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new Je().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return My.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:hw,SpriteMaterial:f1,RawShaderMaterial:_1,ShaderMaterial:ls,PointsMaterial:d1,MeshPhysicalMaterial:Ux,MeshStandardMaterial:_y,MeshPhongMaterial:dw,MeshToonMaterial:pw,MeshNormalMaterial:mw,MeshLambertMaterial:gw,MeshDepthMaterial:S1,MeshDistanceMaterial:M1,MeshBasicMaterial:Gl,MeshMatcapMaterial:vw,LineDashedMaterial:xw,LineBasicMaterial:ws,Material:cs};return new t[e]}}class N_{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class Iw extends vn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class Lw extends As{constructor(e){super(e)}load(e,t,n,r){const o=this,u=new la(o.manager);u.setPath(o.path),u.setRequestHeader(o.requestHeader),u.setWithCredentials(o.withCredentials),u.load(e,function(h){try{t(o.parse(JSON.parse(h)))}catch(d){r?r(d):Qt(d),o.manager.itemError(e)}},n,r)}parse(e){const t={},n={};function r(_,M){if(t[M]!==void 0)return t[M];const A=_.interleavedBuffers[M],E=o(_,A.buffer),N=td(A.type,E),I=new sy(N,A.stride);return I.uuid=A.uuid,t[M]=I,I}function o(_,M){if(n[M]!==void 0)return n[M];const A=_.arrayBuffers[M],E=new Uint32Array(A).buffer;return n[M]=E,E}const u=e.isInstancedBufferGeometry?new Iw:new vn,h=e.data.index;if(h!==void 0){const _=td(h.type,h.array);u.setIndex(new li(_,1))}const d=e.data.attributes;for(const _ in d){const M=d[_];let R;if(M.isInterleavedBufferAttribute){const A=r(e.data,M.data);R=new mf(A,M.itemSize,M.offset,M.normalized)}else{const A=td(M.type,M.array),E=M.isInstancedBufferAttribute?pd:li;R=new E(A,M.itemSize,M.normalized)}M.name!==void 0&&(R.name=M.name),M.usage!==void 0&&R.setUsage(M.usage),u.setAttribute(_,R)}const m=e.data.morphAttributes;if(m)for(const _ in m){const M=m[_],R=[];for(let A=0,E=M.length;A<E;A++){const N=M[A];let I;if(N.isInterleavedBufferAttribute){const P=r(e.data,N.data);I=new mf(P,N.itemSize,N.offset,N.normalized)}else{const P=td(N.type,N.array);I=new li(P,N.itemSize,N.normalized)}N.name!==void 0&&(I.name=N.name),R.push(I)}u.morphAttributes[_]=R}e.data.morphTargetsRelative&&(u.morphTargetsRelative=!0);const x=e.data.groups||e.data.drawcalls||e.data.offsets;if(x!==void 0)for(let _=0,M=x.length;_!==M;++_){const R=x[_];u.addGroup(R.start,R.count,R.materialIndex)}const y=e.data.boundingSphere;return y!==void 0&&(u.boundingSphere=new jr().fromJSON(y)),e.name&&(u.name=e.name),e.userData&&(u.userData=e.userData),u}}class JR extends As{constructor(e){super(e)}load(e,t,n,r){const o=this,u=this.path===""?N_.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||u;const h=new la(this.manager);h.setPath(this.path),h.setRequestHeader(this.requestHeader),h.setWithCredentials(this.withCredentials),h.load(e,function(d){let m=null;try{m=JSON.parse(d)}catch(x){r!==void 0&&r(x),x("ObjectLoader: Can't parse "+e+".",x.message);return}const v=m.metadata;if(v===void 0||v.type===void 0||v.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),Qt("ObjectLoader: Can't load "+e);return}o.parse(m,t)},n,r)}async loadAsync(e,t){const n=this,r=this.path===""?N_.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const o=new la(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials);const u=await o.loadAsync(e,t),h=JSON.parse(u),d=h.metadata;if(d===void 0||d.type===void 0||d.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(h)}parse(e,t){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),o=this.parseGeometries(e.geometries,r),u=this.parseImages(e.images,function(){t!==void 0&&t(m)}),h=this.parseTextures(e.textures,u),d=this.parseMaterials(e.materials,h),m=this.parseObject(e.object,o,d,h,n),v=this.parseSkeletons(e.skeletons,m);if(this.bindSkeletons(m,v),this.bindLightTargets(m),t!==void 0){let x=!1;for(const y in u)if(u[y].data instanceof HTMLImageElement){x=!0;break}x===!1&&t(m)}return m}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),o=await this.parseImagesAsync(e.images),u=this.parseTextures(e.textures,o),h=this.parseMaterials(e.materials,u),d=this.parseObject(e.object,r,h,u,t),m=this.parseSkeletons(e.skeletons,d);return this.bindSkeletons(d,m),this.bindLightTargets(d),d}parseShapes(e){const t={};if(e!==void 0)for(let n=0,r=e.length;n<r;n++){const o=new hf().fromJSON(e[n]);t[o.uuid]=o}return t}parseSkeletons(e,t){const n={},r={};if(t.traverse(function(o){o.isBone&&(r[o.uuid]=o)}),e!==void 0)for(let o=0,u=e.length;o<u;o++){const h=new ay().fromJSON(e[o],r);n[h.uuid]=h}return n}parseGeometries(e,t){const n={};if(e!==void 0){const r=new Lw;for(let o=0,u=e.length;o<u;o++){let h;const d=e[o];switch(d.type){case"BufferGeometry":case"InstancedBufferGeometry":h=r.parse(d);break;default:d.type in IM?h=IM[d.type].fromJSON(d,t):zt(`ObjectLoader: Unsupported geometry type "${d.type}"`)}h.uuid=d.uuid,d.name!==void 0&&(h.name=d.name),d.userData!==void 0&&(h.userData=d.userData),n[d.uuid]=h}}return n}parseMaterials(e,t){const n={},r={};if(e!==void 0){const o=new My;o.setTextures(t);for(let u=0,h=e.length;u<h;u++){const d=e[u];n[d.uuid]===void 0&&(n[d.uuid]=o.parse(d)),r[d.uuid]=n[d.uuid]}}return r}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const r=e[n],o=km.parse(r);t[o.uuid]=o}return t}parseImages(e,t){const n=this,r={};let o;function u(d){return n.manager.itemStart(d),o.load(d,function(){n.manager.itemEnd(d)},void 0,function(){n.manager.itemError(d),n.manager.itemEnd(d)})}function h(d){if(typeof d=="string"){const m=d,v=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(m)?m:n.resourcePath+m;return u(v)}else return d.data?{data:td(d.type,d.data),width:d.width,height:d.height}:null}if(e!==void 0&&e.length>0){const d=new Sy(t);o=new Vm(d),o.setCrossOrigin(this.crossOrigin);for(let m=0,v=e.length;m<v;m++){const x=e[m],y=x.url;if(Array.isArray(y)){const _=[];for(let M=0,R=y.length;M<R;M++){const A=y[M],E=h(A);E!==null&&(E instanceof HTMLImageElement?_.push(E):_.push(new Va(E.data,E.width,E.height)))}r[x.uuid]=new Gc(_)}else{const _=h(x.url);r[x.uuid]=new Gc(_)}}}return r}async parseImagesAsync(e){const t=this,n={};let r;async function o(u){if(typeof u=="string"){const h=u,d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:t.resourcePath+h;return await r.loadAsync(d)}else return u.data?{data:td(u.type,u.data),width:u.width,height:u.height}:null}if(e!==void 0&&e.length>0){r=new Vm(this.manager),r.setCrossOrigin(this.crossOrigin);for(let u=0,h=e.length;u<h;u++){const d=e[u],m=d.url;if(Array.isArray(m)){const v=[];for(let x=0,y=m.length;x<y;x++){const _=m[x],M=await o(_);M!==null&&(M instanceof HTMLImageElement?v.push(M):v.push(new Va(M.data,M.width,M.height)))}n[d.uuid]=new Gc(v)}else{const v=await o(d.url);n[d.uuid]=new Gc(v)}}}return n}parseTextures(e,t){function n(o,u){return typeof o=="number"?o:(zt("ObjectLoader.parseTexture: Constant should be in numeric form.",o),u[o])}const r={};if(e!==void 0)for(let o=0,u=e.length;o<u;o++){const h=e[o];h.image===void 0&&zt('ObjectLoader: No "image" specified for',h.uuid),t[h.image]===void 0&&zt("ObjectLoader: Undefined image",h.image);const d=t[h.image],m=d.data;let v;Array.isArray(m)?(v=new Zm,m.length===6&&(v.needsUpdate=!0)):(m&&m.data?v=new Va:v=new oi,m&&(v.needsUpdate=!0)),v.source=d,v.uuid=h.uuid,h.name!==void 0&&(v.name=h.name),h.mapping!==void 0&&(v.mapping=n(h.mapping,$R)),h.channel!==void 0&&(v.channel=h.channel),h.offset!==void 0&&v.offset.fromArray(h.offset),h.repeat!==void 0&&v.repeat.fromArray(h.repeat),h.center!==void 0&&v.center.fromArray(h.center),h.rotation!==void 0&&(v.rotation=h.rotation),h.wrap!==void 0&&(v.wrapS=n(h.wrap[0],UM),v.wrapT=n(h.wrap[1],UM)),h.format!==void 0&&(v.format=h.format),h.internalFormat!==void 0&&(v.internalFormat=h.internalFormat),h.type!==void 0&&(v.type=h.type),h.colorSpace!==void 0&&(v.colorSpace=h.colorSpace),h.minFilter!==void 0&&(v.minFilter=n(h.minFilter,OM)),h.magFilter!==void 0&&(v.magFilter=n(h.magFilter,OM)),h.anisotropy!==void 0&&(v.anisotropy=h.anisotropy),h.flipY!==void 0&&(v.flipY=h.flipY),h.generateMipmaps!==void 0&&(v.generateMipmaps=h.generateMipmaps),h.premultiplyAlpha!==void 0&&(v.premultiplyAlpha=h.premultiplyAlpha),h.unpackAlignment!==void 0&&(v.unpackAlignment=h.unpackAlignment),h.compareFunction!==void 0&&(v.compareFunction=h.compareFunction),h.userData!==void 0&&(v.userData=h.userData),r[h.uuid]=v}return r}parseObject(e,t,n,r,o){let u;function h(y){return t[y]===void 0&&zt("ObjectLoader: Undefined geometry",y),t[y]}function d(y){if(y!==void 0){if(Array.isArray(y)){const _=[];for(let M=0,R=y.length;M<R;M++){const A=y[M];n[A]===void 0&&zt("ObjectLoader: Undefined material",A),_.push(n[A])}return _}return n[y]===void 0&&zt("ObjectLoader: Undefined material",y),n[y]}}function m(y){return r[y]===void 0&&zt("ObjectLoader: Undefined texture",y),r[y]}let v,x;switch(e.type){case"Scene":u=new Km,e.background!==void 0&&(Number.isInteger(e.background)?u.background=new Lt(e.background):u.background=m(e.background)),e.environment!==void 0&&(u.environment=m(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?u.fog=new ry(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(u.fog=new iy(e.fog.color,e.fog.density)),e.fog.name!==""&&(u.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(u.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(u.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&u.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(u.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&u.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":u=new Vi(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(u.focus=e.focus),e.zoom!==void 0&&(u.zoom=e.zoom),e.filmGauge!==void 0&&(u.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(u.filmOffset=e.filmOffset),e.view!==void 0&&(u.view=Object.assign({},e.view));break;case"OrthographicCamera":u=new Ha(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(u.zoom=e.zoom),e.view!==void 0&&(u.view=Object.assign({},e.view));break;case"AmbientLight":u=new Rw(e.color,e.intensity);break;case"DirectionalLight":u=new Cw(e.color,e.intensity),u.target=e.target||"";break;case"PointLight":u=new Aw(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":u=new Nw(e.color,e.intensity,e.width,e.height);break;case"SpotLight":u=new ww(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),u.target=e.target||"";break;case"HemisphereLight":u=new Tw(e.color,e.groundColor,e.intensity);break;case"LightProbe":const y=new R1().fromArray(e.sh);u=new Dw(y,e.intensity);break;case"SkinnedMesh":v=h(e.geometry),x=d(e.material),u=new YT(v,x),e.bindMode!==void 0&&(u.bindMode=e.bindMode),e.bindMatrix!==void 0&&u.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(u.skeleton=e.skeleton);break;case"Mesh":v=h(e.geometry),x=d(e.material),u=new Gi(v,x);break;case"InstancedMesh":v=h(e.geometry),x=d(e.material);const _=e.count,M=e.instanceMatrix,R=e.instanceColor;u=new ZT(v,x,_),u.instanceMatrix=new pd(new Float32Array(M.array),16),R!==void 0&&(u.instanceColor=new pd(new Float32Array(R.array),R.itemSize));break;case"BatchedMesh":v=h(e.geometry),x=d(e.material),u=new KT(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,x),u.geometry=v,u.perObjectFrustumCulled=e.perObjectFrustumCulled,u.sortObjects=e.sortObjects,u._drawRanges=e.drawRanges,u._reservedRanges=e.reservedRanges,u._geometryInfo=e.geometryInfo.map(A=>{let E=null,N=null;return A.boundingBox!==void 0&&(E=new os().fromJSON(A.boundingBox)),A.boundingSphere!==void 0&&(N=new jr().fromJSON(A.boundingSphere)),{...A,boundingBox:E,boundingSphere:N}}),u._instanceInfo=e.instanceInfo,u._availableInstanceIds=e._availableInstanceIds,u._availableGeometryIds=e._availableGeometryIds,u._nextIndexStart=e.nextIndexStart,u._nextVertexStart=e.nextVertexStart,u._geometryCount=e.geometryCount,u._maxInstanceCount=e.maxInstanceCount,u._maxVertexCount=e.maxVertexCount,u._maxIndexCount=e.maxIndexCount,u._geometryInitialized=e.geometryInitialized,u._matricesTexture=m(e.matricesTexture.uuid),u._indirectTexture=m(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(u._colorsTexture=m(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(u.boundingSphere=new jr().fromJSON(e.boundingSphere)),e.boundingBox!==void 0&&(u.boundingBox=new os().fromJSON(e.boundingBox));break;case"LOD":u=new qT;break;case"Line":u=new Zc(h(e.geometry),d(e.material));break;case"LineLoop":u=new QT(h(e.geometry),d(e.material));break;case"LineSegments":u=new tl(h(e.geometry),d(e.material));break;case"PointCloud":case"Points":u=new JT(h(e.geometry),d(e.material));break;case"Sprite":u=new XT(d(e.material));break;case"Group":u=new nd;break;case"Bone":u=new h1;break;default:u=new Nn}if(u.uuid=e.uuid,e.name!==void 0&&(u.name=e.name),e.matrix!==void 0?(u.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(u.matrixAutoUpdate=e.matrixAutoUpdate),u.matrixAutoUpdate&&u.matrix.decompose(u.position,u.quaternion,u.scale)):(e.position!==void 0&&u.position.fromArray(e.position),e.rotation!==void 0&&u.rotation.fromArray(e.rotation),e.quaternion!==void 0&&u.quaternion.fromArray(e.quaternion),e.scale!==void 0&&u.scale.fromArray(e.scale)),e.up!==void 0&&u.up.fromArray(e.up),e.castShadow!==void 0&&(u.castShadow=e.castShadow),e.receiveShadow!==void 0&&(u.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(u.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(u.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(u.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(u.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&u.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(u.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(u.visible=e.visible),e.frustumCulled!==void 0&&(u.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(u.renderOrder=e.renderOrder),e.userData!==void 0&&(u.userData=e.userData),e.layers!==void 0&&(u.layers.mask=e.layers),e.children!==void 0){const y=e.children;for(let _=0;_<y.length;_++)u.add(this.parseObject(y[_],t,n,r,o))}if(e.animations!==void 0){const y=e.animations;for(let _=0;_<y.length;_++){const M=y[_];u.animations.push(o[M])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(u.autoUpdate=e.autoUpdate);const y=e.levels;for(let _=0;_<y.length;_++){const M=y[_],R=u.getObjectByProperty("uuid",M.object);R!==void 0&&u.addLevel(R,M.distance,M.hysteresis)}}return u}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const r=t[n.skeleton];r===void 0?zt("ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(r,n.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,r=e.getObjectByProperty("uuid",n);r!==void 0?t.target=r:t.target=new Nn}})}}const $R={UVMapping:Xc,CubeReflectionMapping:go,CubeRefractionMapping:qc,EquirectangularReflectionMapping:ad,EquirectangularRefractionMapping:wm,CubeUVReflectionMapping:bd},UM={RepeatWrapping:Am,ClampToEdgeWrapping:Ki,MirroredRepeatWrapping:Cm},OM={NearestFilter:ar,NearestMipmapNearestFilter:e1,NearestMipmapLinearFilter:ed,LinearFilter:Gn,LinearMipmapNearestFilter:gm,LinearMipmapLinearFilter:Qo},Yb=new WeakMap;class eN extends As{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&zt("ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&zt("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,u=Jo.get(`image-bitmap:${e}`);if(u!==void 0){if(o.manager.itemStart(e),u.then){u.then(m=>{if(Yb.has(u)===!0)r&&r(Yb.get(u)),o.manager.itemError(e),o.manager.itemEnd(e);else return t&&t(m),o.manager.itemEnd(e),m});return}return setTimeout(function(){t&&t(u),o.manager.itemEnd(e)},0),u}const h={};h.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",h.headers=this.requestHeader,h.signal=typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const d=fetch(e,h).then(function(m){return m.blob()}).then(function(m){return createImageBitmap(m,Object.assign(o.options,{colorSpaceConversion:"none"}))}).then(function(m){return Jo.add(`image-bitmap:${e}`,m),t&&t(m),o.manager.itemEnd(e),m}).catch(function(m){r&&r(m),Yb.set(d,m),Jo.remove(`image-bitmap:${e}`),o.manager.itemError(e),o.manager.itemEnd(e)});Jo.add(`image-bitmap:${e}`,d),o.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}let Tv,N1=class{static getContext(){return Tv===void 0&&(Tv=new(window.AudioContext||window.webkitAudioContext)),Tv}static setContext(e){Tv=e}};class tN extends As{constructor(e){super(e)}load(e,t,n,r){const o=this,u=new la(this.manager);u.setResponseType("arraybuffer"),u.setPath(this.path),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(e,function(d){try{const m=d.slice(0);N1.getContext().decodeAudioData(m,function(x){t(x)}).catch(h)}catch(m){h(m)}},n,r);function h(d){r?r(d):Qt(d),o.manager.itemError(e)}}}const zM=new cn,BM=new cn,Wu=new cn;class nN{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Vi,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Vi,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Wu.copy(e.projectionMatrix);const r=t.eyeSep/2,o=r*t.near/t.focus,u=t.near*Math.tan(ff*t.fov*.5)/t.zoom;let h,d;BM.elements[12]=-r,zM.elements[12]=r,h=-u*t.aspect+o,d=u*t.aspect+o,Wu.elements[0]=2*t.near/(d-h),Wu.elements[8]=(d+h)/(d-h),this.cameraL.projectionMatrix.copy(Wu),h=-u*t.aspect-o,d=u*t.aspect-o,Wu.elements[0]=2*t.near/(d-h),Wu.elements[8]=(d+h)/(d-h),this.cameraR.projectionMatrix.copy(Wu)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(BM),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(zM)}}class Pw extends Vi{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class D1{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}const Xu=new Q,Zb=new as,iN=new Q,qu=new Q,Yu=new Q;class rN extends Nn{constructor(){super(),this.type="AudioListener",this.context=N1.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new D1}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Xu,Zb,iN),qu.set(0,0,-1).applyQuaternion(Zb),Yu.set(0,1,0).applyQuaternion(Zb),t.positionX){const n=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Xu.x,n),t.positionY.linearRampToValueAtTime(Xu.y,n),t.positionZ.linearRampToValueAtTime(Xu.z,n),t.forwardX.linearRampToValueAtTime(qu.x,n),t.forwardY.linearRampToValueAtTime(qu.y,n),t.forwardZ.linearRampToValueAtTime(qu.z,n),t.upX.linearRampToValueAtTime(Yu.x,n),t.upY.linearRampToValueAtTime(Yu.y,n),t.upZ.linearRampToValueAtTime(Yu.z,n)}else t.setPosition(Xu.x,Xu.y,Xu.z),t.setOrientation(qu.x,qu.y,qu.z,Yu.x,Yu.y,Yu.z)}}class Uw extends Nn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){zt("Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){zt("Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){zt("Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){zt("Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){zt("Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(zt("Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){zt("Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(zt("Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const Zu=new Q,FM=new as,sN=new Q,Ku=new Q;class aN extends Uw{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Zu,FM,sN),Ku.set(0,0,1).applyQuaternion(FM);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Zu.x,n),t.positionY.linearRampToValueAtTime(Zu.y,n),t.positionZ.linearRampToValueAtTime(Zu.z,n),t.orientationX.linearRampToValueAtTime(Ku.x,n),t.orientationY.linearRampToValueAtTime(Ku.y,n),t.orientationZ.linearRampToValueAtTime(Ku.z,n)}else t.setPosition(Zu.x,Zu.y,Zu.z),t.setOrientation(Ku.x,Ku.y,Ku.z)}}class oN{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class Ow{constructor(e,t,n){this.binding=e,this.valueSize=n;let r,o,u;switch(t){case"quaternion":r=this._slerp,o=this._slerpAdditive,u=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":r=this._select,o=this._select,u=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:r=this._lerp,o=this._lerpAdditive,u=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=o,this._setIdentity=u,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,o=e*r+r;let u=this.cumulativeWeight;if(u===0){for(let h=0;h!==r;++h)n[o+h]=n[h];u=t}else{u+=t;const h=t/u;this._mixBufferRegion(n,o,0,h,r)}this.cumulativeWeight=u}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,o=this.cumulativeWeight,u=this.cumulativeWeightAdditive,h=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){const d=t*this._origIndex;this._mixBufferRegion(n,r,d,1-o,t)}u>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let d=t,m=t+t;d!==m;++d)if(n[d]!==n[d+t]){h.setValue(n,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let o=n,u=r;o!==u;++o)t[o]=t[r+o%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,o){if(r>=.5)for(let u=0;u!==o;++u)e[t+u]=e[n+u]}_slerp(e,t,n,r){as.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,o){const u=this._workIndex*o;as.multiplyQuaternionsFlat(e,u,e,t,e,n),as.slerpFlat(e,t,e,t,e,u,r)}_lerp(e,t,n,r,o){const u=1-r;for(let h=0;h!==o;++h){const d=t+h;e[d]=e[d]*u+e[n+h]*r}}_lerpAdditive(e,t,n,r,o){for(let u=0;u!==o;++u){const h=t+u;e[h]=e[h]+e[n+u]*r}}}const I1="\\[\\]\\.:\\/",lN=new RegExp("["+I1+"]","g"),L1="[^"+I1+"]",cN="[^"+I1.replace("\\.","")+"]",uN=/((?:WC+[\/:])*)/.source.replace("WC",L1),fN=/(WCOD+)?/.source.replace("WCOD",cN),hN=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",L1),dN=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",L1),pN=new RegExp("^"+uN+fN+hN+dN+"$"),mN=["material","materials","bones","map"];class gN{constructor(e,t,n){const r=n||qn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,o=n.length;r!==o;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class qn{constructor(e,t,n){this.path=t,this.parsedPath=n||qn.parseTrackName(t),this.node=qn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new qn.Composite(e,t,n):new qn(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(lN,"")}static parseTrackName(e){const t=pN.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const o=n.nodeName.substring(r+1);mN.indexOf(o)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=o)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(o){for(let u=0;u<o.length;u++){const h=o[u];if(h.name===t||h.uuid===t)return h;const d=n(h.children);if(d)return d}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let o=t.propertyIndex;if(e||(e=qn.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){zt("PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let m=t.objectIndex;switch(n){case"materials":if(!e.material){Qt("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){Qt("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){Qt("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let v=0;v<e.length;v++)if(e[v].name===m){m=v;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){Qt("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){Qt("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){Qt("PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(m!==void 0){if(e[m]===void 0){Qt("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[m]}}const u=e[r];if(u===void 0){const m=t.nodeName;Qt("PropertyBinding: Trying to update property for track: "+m+"."+r+" but it wasn't found.",e);return}let h=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?h=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(h=this.Versioning.MatrixWorldNeedsUpdate);let d=this.BindingType.Direct;if(o!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){Qt("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){Qt("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[o]!==void 0&&(o=e.morphTargetDictionary[o])}d=this.BindingType.ArrayElement,this.resolvedProperty=u,this.propertyIndex=o}else u.fromArray!==void 0&&u.toArray!==void 0?(d=this.BindingType.HasFromToArray,this.resolvedProperty=u):Array.isArray(u)?(d=this.BindingType.EntireArray,this.resolvedProperty=u):this.propertyName=r;this.getValue=this.GetterByBindingType[d],this.setValue=this.SetterByBindingTypeAndVersioning[d][h]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}qn.Composite=gN;qn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};qn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};qn.prototype.GetterByBindingType=[qn.prototype._getValue_direct,qn.prototype._getValue_array,qn.prototype._getValue_arrayElement,qn.prototype._getValue_toArray];qn.prototype.SetterByBindingTypeAndVersioning=[[qn.prototype._setValue_direct,qn.prototype._setValue_direct_setNeedsUpdate,qn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[qn.prototype._setValue_array,qn.prototype._setValue_array_setNeedsUpdate,qn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[qn.prototype._setValue_arrayElement,qn.prototype._setValue_arrayElement_setNeedsUpdate,qn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[qn.prototype._setValue_fromArray,qn.prototype._setValue_fromArray_setNeedsUpdate,qn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class vN{constructor(){this.isAnimationObjectGroup=!0,this.uuid=oa(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,o=this._bindings,u=o.length;let h,d=e.length,m=this.nCachedObjects_;for(let v=0,x=arguments.length;v!==x;++v){const y=arguments[v],_=y.uuid;let M=t[_];if(M===void 0){M=d++,t[_]=M,e.push(y);for(let R=0,A=u;R!==A;++R)o[R].push(new qn(y,n[R],r[R]))}else if(M<m){h=e[M];const R=--m,A=e[R];t[A.uuid]=M,e[M]=A,t[_]=R,e[R]=y;for(let E=0,N=u;E!==N;++E){const I=o[E],P=I[R];let z=I[M];I[M]=P,z===void 0&&(z=new qn(y,n[E],r[E])),I[R]=z}}else e[M]!==h&&Qt("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=m}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let o=this.nCachedObjects_;for(let u=0,h=arguments.length;u!==h;++u){const d=arguments[u],m=d.uuid,v=t[m];if(v!==void 0&&v>=o){const x=o++,y=e[x];t[y.uuid]=v,e[v]=y,t[m]=x,e[x]=d;for(let _=0,M=r;_!==M;++_){const R=n[_],A=R[x],E=R[v];R[v]=A,R[x]=E}}}this.nCachedObjects_=o}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let o=this.nCachedObjects_,u=e.length;for(let h=0,d=arguments.length;h!==d;++h){const m=arguments[h],v=m.uuid,x=t[v];if(x!==void 0)if(delete t[v],x<o){const y=--o,_=e[y],M=--u,R=e[M];t[_.uuid]=x,e[x]=_,t[R.uuid]=y,e[y]=R,e.pop();for(let A=0,E=r;A!==E;++A){const N=n[A],I=N[y],P=N[M];N[x]=I,N[y]=P,N.pop()}}else{const y=--u,_=e[y];y>0&&(t[_.uuid]=x),e[x]=_,e.pop();for(let M=0,R=r;M!==R;++M){const A=n[M];A[x]=A[y],A.pop()}}}this.nCachedObjects_=o}subscribe_(e,t){const n=this._bindingsIndicesByPath;let r=n[e];const o=this._bindings;if(r!==void 0)return o[r];const u=this._paths,h=this._parsedPaths,d=this._objects,m=d.length,v=this.nCachedObjects_,x=new Array(m);r=o.length,n[e]=r,u.push(e),h.push(t),o.push(x);for(let y=v,_=d.length;y!==_;++y){const M=d[y];x[y]=new qn(M,e,t)}return x}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const r=this._paths,o=this._parsedPaths,u=this._bindings,h=u.length-1,d=u[h],m=e[h];t[m]=n,u[n]=d,u.pop(),o[n]=o[h],o.pop(),r[n]=r[h],r.pop()}}}class zw{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const o=t.tracks,u=o.length,h=new Array(u),d={endingStart:sf,endingEnd:sf};for(let m=0;m!==u;++m){const v=o[m].createInterpolant(null);h[m]=v,v.settings=d}this._interpolantSettings=d,this._interpolants=h,this._propertyBindings=new Array(u),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=CT,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n=!1){if(e.fadeOut(t),this.fadeIn(t),n===!0){const r=this._clip.duration,o=e._clip.duration,u=o/r,h=r/o;e.warp(1,u,t),this.warp(h,1,t)}return this}crossFadeTo(e,t,n=!1){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,o=r.time,u=this.timeScale;let h=this._timeScaleInterpolant;h===null&&(h=r._lendControlInterpolant(),this._timeScaleInterpolant=h);const d=h.parameterPositions,m=h.sampleValues;return d[0]=o,d[1]=o+n,m[0]=e/u,m[1]=t/u,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled){this._updateWeight(e);return}const o=this._startTime;if(o!==null){const d=(e-o)*n;d<0||n===0?t=0:(this._startTime=null,t=n*d)}t*=this._updateTimeScale(e);const u=this._updateTime(t),h=this._updateWeight(e);if(h>0){const d=this._interpolants,m=this._propertyBindings;switch(this.blendMode){case s1:for(let v=0,x=d.length;v!==x;++v)d[v].evaluate(u),m[v].accumulateAdditive(h);break;case Zx:default:for(let v=0,x=d.length;v!==x;++v)d[v].evaluate(u),m[v].accumulate(r,h)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,o=this._loopCount;const u=n===RT;if(e===0)return o===-1?r:u&&(o&1)===1?t-r:r;if(n===AT){o===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(o===-1&&(e>=0?(o=0,this._setEndings(!0,this.repetitions===0,u)):this._setEndings(this.repetitions===0,!0,u)),r>=t||r<0){const h=Math.floor(r/t);r-=t*h,o+=Math.abs(h);const d=this.repetitions-o;if(d<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(d===1){const m=e<0;this._setEndings(m,!m,u)}else this._setEndings(!1,!1,u);this._loopCount=o,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:h})}}else this.time=r;if(u&&(o&1)===1)return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=af,r.endingEnd=af):(e?r.endingStart=this.zeroSlopeAtStart?af:sf:r.endingStart=Nm,t?r.endingEnd=this.zeroSlopeAtEnd?af:sf:r.endingEnd=Nm)}_scheduleFading(e,t,n){const r=this._mixer,o=r.time;let u=this._weightInterpolant;u===null&&(u=r._lendControlInterpolant(),this._weightInterpolant=u);const h=u.parameterPositions,d=u.sampleValues;return h[0]=o,d[0]=t,h[1]=o+e,d[1]=n,this}}const xN=new Float32Array(1);class yN extends el{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,o=r.length,u=e._propertyBindings,h=e._interpolants,d=n.uuid,m=this._bindingsByRootAndName;let v=m[d];v===void 0&&(v={},m[d]=v);for(let x=0;x!==o;++x){const y=r[x],_=y.name;let M=v[_];if(M!==void 0)++M.referenceCount,u[x]=M;else{if(M=u[x],M!==void 0){M._cacheIndex===null&&(++M.referenceCount,this._addInactiveBinding(M,d,_));continue}const R=t&&t._propertyBindings[x].binding.parsedPath;M=new Ow(qn.create(n,_,R),y.ValueTypeName,y.getValueSize()),++M.referenceCount,this._addInactiveBinding(M,d,_),u[x]=M}h[x].resultBuffer=M.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,r=e._clip.uuid,o=this._actionsByClip[r];this._bindAction(e,o&&o.knownActions[0]),this._addInactiveAction(e,r,n)}const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const o=t[n];o.useCount++===0&&(this._lendBinding(o),o.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const o=t[n];--o.useCount===0&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,o=this._actionsByClip;let u=o[t];if(u===void 0)u={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,o[t]=u;else{const h=u.knownActions;e._byClipCacheIndex=h.length,h.push(e)}e._cacheIndex=r.length,r.push(e),u.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const o=e._clip.uuid,u=this._actionsByClip,h=u[o],d=h.knownActions,m=d[d.length-1],v=e._byClipCacheIndex;m._byClipCacheIndex=v,d[v]=m,d.pop(),e._byClipCacheIndex=null;const x=h.actionByRoot,y=(e._localRoot||this._root).uuid;delete x[y],d.length===0&&delete u[o],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const o=t[n];--o.referenceCount===0&&this._removeInactiveBinding(o)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=n,t[n]=o}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=n,t[n]=o}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,o=this._bindings;let u=r[t];u===void 0&&(u={},r[t]=u),u[n]=e,e._cacheIndex=o.length,o.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,o=n.path,u=this._bindingsByRootAndName,h=u[r],d=t[t.length-1],m=e._cacheIndex;d._cacheIndex=m,t[m]=d,t.pop(),delete h[o],Object.keys(h).length===0&&delete u[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=n,t[n]=o}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=n,t[n]=o}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new T1(new Float32Array(2),new Float32Array(2),1,xN),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,o=t[r];e.__cacheIndex=r,t[r]=e,o.__cacheIndex=n,t[n]=o}clipAction(e,t,n){const r=t||this._root,o=r.uuid;let u=typeof e=="string"?km.findByName(r,e):e;const h=u!==null?u.uuid:e,d=this._actionsByClip[h];let m=null;if(n===void 0&&(u!==null?n=u.blendMode:n=Zx),d!==void 0){const x=d.actionByRoot[o];if(x!==void 0&&x.blendMode===n)return x;m=d.knownActions[0],u===null&&(u=m._clip)}if(u===null)return null;const v=new zw(this,u,t,n);return this._bindAction(v,m),this._addInactiveAction(v,h,o),v}existingAction(e,t){const n=t||this._root,r=n.uuid,o=typeof e=="string"?km.findByName(n,e):e,u=o?o.uuid:e,h=this._actionsByClip[u];return h!==void 0&&h.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,o=Math.sign(e),u=this._accuIndex^=1;for(let m=0;m!==n;++m)t[m]._update(r,e,o,u);const h=this._bindings,d=this._nActiveBindings;for(let m=0;m!==d;++m)h[m].apply(u);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,o=r[n];if(o!==void 0){const u=o.knownActions;for(let h=0,d=u.length;h!==d;++h){const m=u[h];this._deactivateAction(m);const v=m._cacheIndex,x=t[t.length-1];m._cacheIndex=null,m._byClipCacheIndex=null,x._cacheIndex=v,t[v]=x,t.pop(),this._removeInactiveBindingsForAction(m)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const u in n){const h=n[u].actionByRoot,d=h[t];d!==void 0&&(this._deactivateAction(d),this._removeInactiveAction(d))}const r=this._bindingsByRootAndName,o=r[t];if(o!==void 0)for(const u in o){const h=o[u];h.restoreOriginalState(),this._removeInactiveBinding(h)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class bN extends o1{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isRenderTarget3D=!0,this.depth=n,this.texture=new ey(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class Ey{constructor(e){this.value=e}clone(){return new Ey(this.value.clone===void 0?this.value:this.value.clone())}}let _N=0;class SN extends el{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:_N++}),this.name="",this.usage=Im,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,r=t.length;n<r;n++){const o=Array.isArray(t[n])?t[n]:[t[n]];for(let u=0;u<o.length;u++)this.uniforms.push(o[u].clone())}return this}clone(){return new this.constructor().copy(this)}}class MN extends sy{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class EN{constructor(e,t,n,r,o,u=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=o,this.normalized=u,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const kM=new cn;class Sd{constructor(e,t,n=0,r=1/0){this.ray=new yf(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new hd,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):Qt("Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return kM.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(kM),this}intersectObject(e,t=!0,n=[]){return D_(e,this,n,t),n.sort(VM),n}intersectObjects(e,t=!0,n=[]){for(let r=0,o=e.length;r<o;r++)D_(e[r],this,n,t);return n.sort(VM),n}}function VM(s,e){return s.distance-e.distance}function D_(s,e,t,n){let r=!0;if(s.layers.test(e.layers)&&s.raycast(e,t)===!1&&(r=!1),r===!0&&n===!0){const o=s.children;for(let u=0,h=o.length;u<h;u++)D_(o[u],e,t,!0)}}class TN{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,e.hidden!==void 0&&(this._pageVisibilityHandler=wN.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){this._pageVisibilityHandler!==null&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return this._pageVisibilityHandler!==null&&this._document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(e!==void 0?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}}function wN(){this._document.hidden===!1&&this.reset()}class I_{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=on(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(on(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class AN{constructor(e=1,t=0,n=0){this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}class P1{constructor(e,t,n,r){P1.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,r){const o=this.elements;return o[0]=e,o[2]=t,o[1]=n,o[3]=r,this}}const HM=new Je;class CN{constructor(e=new Je(1/0,1/0),t=new Je(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=HM.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,HM).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const GM=new Q,wv=new Q,qh=new Q,Yh=new Q,Kb=new Q,RN=new Q,NN=new Q;class DN{constructor(e=new Q,t=new Q){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){GM.subVectors(e,this.start),wv.subVectors(this.end,this.start);const n=wv.dot(wv);let o=wv.dot(GM)/n;return t&&(o=on(o,0,1)),o}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}distanceSqToLine3(e,t=RN,n=NN){const r=10000000000000001e-32;let o,u;const h=this.start,d=e.start,m=this.end,v=e.end;qh.subVectors(m,h),Yh.subVectors(v,d),Kb.subVectors(h,d);const x=qh.dot(qh),y=Yh.dot(Yh),_=Yh.dot(Kb);if(x<=r&&y<=r)return t.copy(h),n.copy(d),t.sub(n),t.dot(t);if(x<=r)o=0,u=_/y,u=on(u,0,1);else{const M=qh.dot(Kb);if(y<=r)u=0,o=on(-M/x,0,1);else{const R=qh.dot(Yh),A=x*y-R*R;A!==0?o=on((R*_-M*y)/A,0,1):o=0,u=(R*o+_)/y,u<0?(u=0,o=on(-M/x,0,1)):u>1&&(u=1,o=on((R-M)/x,0,1))}}return t.copy(h).add(qh.multiplyScalar(o)),n.copy(d).add(Yh.multiplyScalar(u)),t.sub(n),t.dot(t)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const jM=new Q;class IN extends Nn{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new vn,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let u=0,h=1,d=32;u<d;u++,h++){const m=u/d*Math.PI*2,v=h/d*Math.PI*2;r.push(Math.cos(m),Math.sin(m),1,Math.cos(v),Math.sin(v),1)}n.setAttribute("position",new Wt(r,3));const o=new ws({fog:!1,toneMapped:!1});this.cone=new tl(n,o),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),jM.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(jM),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Fc=new Q,Av=new cn,Qb=new cn;class LN extends tl{constructor(e){const t=Bw(e),n=new vn,r=[],o=[];for(let m=0;m<t.length;m++){const v=t[m];v.parent&&v.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),o.push(0,0,0),o.push(0,0,0))}n.setAttribute("position",new Wt(r,3)),n.setAttribute("color",new Wt(o,3));const u=new ws({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,u),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const h=new Lt(255),d=new Lt(65280);this.setColors(h,d)}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");Qb.copy(this.root.matrixWorld).invert();for(let o=0,u=0;o<t.length;o++){const h=t[o];h.parent&&h.parent.isBone&&(Av.multiplyMatrices(Qb,h.matrixWorld),Fc.setFromMatrixPosition(Av),r.setXYZ(u,Fc.x,Fc.y,Fc.z),Av.multiplyMatrices(Qb,h.parent.matrixWorld),Fc.setFromMatrixPosition(Av),r.setXYZ(u+1,Fc.x,Fc.y,Fc.z),u+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){const r=this.geometry.getAttribute("color");for(let o=0;o<r.count;o+=2)r.setXYZ(o,e.r,e.g,e.b),r.setXYZ(o+1,t.r,t.g,t.b);return r.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function Bw(s){const e=[];s.isBone===!0&&e.push(s);for(let t=0;t<s.children.length;t++)e.push(...Bw(s.children[t]));return e}class PN extends Gi{constructor(e,t,n){const r=new t0(t,4,2),o=new Gl({wireframe:!0,fog:!1,toneMapped:!1});super(r,o),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const UN=new Q,WM=new Lt,XM=new Lt;class ON extends Nn{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new e0(t);r.rotateY(Math.PI*.5),this.material=new Gl({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const o=r.getAttribute("position"),u=new Float32Array(o.count*3);r.setAttribute("color",new li(u,3)),this.add(new Gi(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");WM.copy(this.light.color),XM.copy(this.light.groundColor);for(let n=0,r=t.count;n<r;n++){const o=n<r/2?WM:XM;t.setXYZ(n,o.r,o.g,o.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(UN.setFromMatrixPosition(this.light.matrixWorld).negate())}}class zN extends tl{constructor(e=10,t=10,n=4473924,r=8947848){n=new Lt(n),r=new Lt(r);const o=t/2,u=e/t,h=e/2,d=[],m=[];for(let y=0,_=0,M=-h;y<=t;y++,M+=u){d.push(-h,0,M,h,0,M),d.push(M,0,-h,M,0,h);const R=y===o?n:r;R.toArray(m,_),_+=3,R.toArray(m,_),_+=3,R.toArray(m,_),_+=3,R.toArray(m,_),_+=3}const v=new vn;v.setAttribute("position",new Wt(d,3)),v.setAttribute("color",new Wt(m,3));const x=new ws({vertexColors:!0,toneMapped:!1});super(v,x),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class BN extends tl{constructor(e=10,t=16,n=8,r=64,o=4473924,u=8947848){o=new Lt(o),u=new Lt(u);const h=[],d=[];if(t>1)for(let x=0;x<t;x++){const y=x/t*(Math.PI*2),_=Math.sin(y)*e,M=Math.cos(y)*e;h.push(0,0,0),h.push(_,0,M);const R=x&1?o:u;d.push(R.r,R.g,R.b),d.push(R.r,R.g,R.b)}for(let x=0;x<n;x++){const y=x&1?o:u,_=e-e/n*x;for(let M=0;M<r;M++){let R=M/r*(Math.PI*2),A=Math.sin(R)*_,E=Math.cos(R)*_;h.push(A,0,E),d.push(y.r,y.g,y.b),R=(M+1)/r*(Math.PI*2),A=Math.sin(R)*_,E=Math.cos(R)*_,h.push(A,0,E),d.push(y.r,y.g,y.b)}}const m=new vn;m.setAttribute("position",new Wt(h,3)),m.setAttribute("color",new Wt(d,3));const v=new ws({vertexColors:!0,toneMapped:!1});super(m,v),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const qM=new Q,Cv=new Q,YM=new Q;class FN extends Nn{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new vn;r.setAttribute("position",new Wt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const o=new ws({fog:!1,toneMapped:!1});this.lightPlane=new Zc(r,o),this.add(this.lightPlane),r=new vn,r.setAttribute("position",new Wt([0,0,0,0,0,1],3)),this.targetLine=new Zc(r,o),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),qM.setFromMatrixPosition(this.light.matrixWorld),Cv.setFromMatrixPosition(this.light.target.matrixWorld),YM.subVectors(Cv,qM),this.lightPlane.lookAt(Cv),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Cv),this.targetLine.scale.z=YM.length()}}const Rv=new Q,Zi=new ty;class kN extends tl{constructor(e){const t=new vn,n=new ws({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],o=[],u={};h("n1","n2"),h("n2","n4"),h("n4","n3"),h("n3","n1"),h("f1","f2"),h("f2","f4"),h("f4","f3"),h("f3","f1"),h("n1","f1"),h("n2","f2"),h("n3","f3"),h("n4","f4"),h("p","n1"),h("p","n2"),h("p","n3"),h("p","n4"),h("u1","u2"),h("u2","u3"),h("u3","u1"),h("c","t"),h("p","c"),h("cn1","cn2"),h("cn3","cn4"),h("cf1","cf2"),h("cf3","cf4");function h(M,R){d(M),d(R)}function d(M){r.push(0,0,0),o.push(0,0,0),u[M]===void 0&&(u[M]=[]),u[M].push(r.length/3-1)}t.setAttribute("position",new Wt(r,3)),t.setAttribute("color",new Wt(o,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=u,this.update();const m=new Lt(16755200),v=new Lt(16711680),x=new Lt(43775),y=new Lt(16777215),_=new Lt(3355443);this.setColors(m,v,x,y,_)}setColors(e,t,n,r,o){const h=this.geometry.getAttribute("color");return h.setXYZ(0,e.r,e.g,e.b),h.setXYZ(1,e.r,e.g,e.b),h.setXYZ(2,e.r,e.g,e.b),h.setXYZ(3,e.r,e.g,e.b),h.setXYZ(4,e.r,e.g,e.b),h.setXYZ(5,e.r,e.g,e.b),h.setXYZ(6,e.r,e.g,e.b),h.setXYZ(7,e.r,e.g,e.b),h.setXYZ(8,e.r,e.g,e.b),h.setXYZ(9,e.r,e.g,e.b),h.setXYZ(10,e.r,e.g,e.b),h.setXYZ(11,e.r,e.g,e.b),h.setXYZ(12,e.r,e.g,e.b),h.setXYZ(13,e.r,e.g,e.b),h.setXYZ(14,e.r,e.g,e.b),h.setXYZ(15,e.r,e.g,e.b),h.setXYZ(16,e.r,e.g,e.b),h.setXYZ(17,e.r,e.g,e.b),h.setXYZ(18,e.r,e.g,e.b),h.setXYZ(19,e.r,e.g,e.b),h.setXYZ(20,e.r,e.g,e.b),h.setXYZ(21,e.r,e.g,e.b),h.setXYZ(22,e.r,e.g,e.b),h.setXYZ(23,e.r,e.g,e.b),h.setXYZ(24,t.r,t.g,t.b),h.setXYZ(25,t.r,t.g,t.b),h.setXYZ(26,t.r,t.g,t.b),h.setXYZ(27,t.r,t.g,t.b),h.setXYZ(28,t.r,t.g,t.b),h.setXYZ(29,t.r,t.g,t.b),h.setXYZ(30,t.r,t.g,t.b),h.setXYZ(31,t.r,t.g,t.b),h.setXYZ(32,n.r,n.g,n.b),h.setXYZ(33,n.r,n.g,n.b),h.setXYZ(34,n.r,n.g,n.b),h.setXYZ(35,n.r,n.g,n.b),h.setXYZ(36,n.r,n.g,n.b),h.setXYZ(37,n.r,n.g,n.b),h.setXYZ(38,r.r,r.g,r.b),h.setXYZ(39,r.r,r.g,r.b),h.setXYZ(40,o.r,o.g,o.b),h.setXYZ(41,o.r,o.g,o.b),h.setXYZ(42,o.r,o.g,o.b),h.setXYZ(43,o.r,o.g,o.b),h.setXYZ(44,o.r,o.g,o.b),h.setXYZ(45,o.r,o.g,o.b),h.setXYZ(46,o.r,o.g,o.b),h.setXYZ(47,o.r,o.g,o.b),h.setXYZ(48,o.r,o.g,o.b),h.setXYZ(49,o.r,o.g,o.b),h.needsUpdate=!0,this}update(){const e=this.geometry,t=this.pointMap,n=1,r=1;let o,u;if(Zi.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),this.camera.reversedDepth===!0)o=1,u=0;else if(this.camera.coordinateSystem===aa)o=-1,u=1;else if(this.camera.coordinateSystem===cd)o=0,u=1;else throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);sr("c",t,e,Zi,0,0,o),sr("t",t,e,Zi,0,0,u),sr("n1",t,e,Zi,-n,-r,o),sr("n2",t,e,Zi,n,-r,o),sr("n3",t,e,Zi,-n,r,o),sr("n4",t,e,Zi,n,r,o),sr("f1",t,e,Zi,-n,-r,u),sr("f2",t,e,Zi,n,-r,u),sr("f3",t,e,Zi,-n,r,u),sr("f4",t,e,Zi,n,r,u),sr("u1",t,e,Zi,n*.7,r*1.1,o),sr("u2",t,e,Zi,-n*.7,r*1.1,o),sr("u3",t,e,Zi,0,r*2,o),sr("cf1",t,e,Zi,-n,0,u),sr("cf2",t,e,Zi,n,0,u),sr("cf3",t,e,Zi,0,-r,u),sr("cf4",t,e,Zi,0,r,u),sr("cn1",t,e,Zi,-n,0,o),sr("cn2",t,e,Zi,n,0,o),sr("cn3",t,e,Zi,0,-r,o),sr("cn4",t,e,Zi,0,r,o),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function sr(s,e,t,n,r,o,u){Rv.set(r,o,u).unproject(n);const h=e[s];if(h!==void 0){const d=t.getAttribute("position");for(let m=0,v=h.length;m<v;m++)d.setXYZ(h[m],Rv.x,Rv.y,Rv.z)}}const Nv=new os;class VN extends tl{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),o=new vn;o.setIndex(new li(n,1)),o.setAttribute("position",new li(r,3)),super(o,new ws({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&Nv.setFromObject(this.object),Nv.isEmpty())return;const e=Nv.min,t=Nv.max,n=this.geometry.attributes.position,r=n.array;r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=e.x,r[4]=t.y,r[5]=t.z,r[6]=e.x,r[7]=e.y,r[8]=t.z,r[9]=t.x,r[10]=e.y,r[11]=t.z,r[12]=t.x,r[13]=t.y,r[14]=e.z,r[15]=e.x,r[16]=t.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=t.x,r[22]=e.y,r[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class HN extends tl{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],o=new vn;o.setIndex(new li(n,1)),o.setAttribute("position",new Wt(r,3)),super(o,new ws({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class GN extends Zc{constructor(e,t=1,n=16776960){const r=n,o=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],u=new vn;u.setAttribute("position",new Wt(o,3)),u.computeBoundingSphere(),super(u,new ws({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const h=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],d=new vn;d.setAttribute("position",new Wt(h,3)),d.computeBoundingSphere(),this.add(new Gi(d,new Gl({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const ZM=new Q;let Dv,Jb;class jN extends Nn{constructor(e=new Q(0,0,1),t=new Q(0,0,0),n=1,r=16776960,o=n*.2,u=o*.2){super(),this.type="ArrowHelper",Dv===void 0&&(Dv=new vn,Dv.setAttribute("position",new Wt([0,0,0,0,1,0],3)),Jb=new Jm(.5,1,5,1),Jb.translate(0,-.5,0)),this.position.copy(t),this.line=new Zc(Dv,new ws({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Gi(Jb,new Gl({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,o,u)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{ZM.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(ZM,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class WN extends tl{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new vn;r.setAttribute("position",new Wt(t,3)),r.setAttribute("color",new Wt(n,3));const o=new ws({vertexColors:!0,toneMapped:!1});super(r,o),this.type="AxesHelper"}setColors(e,t,n){const r=new Lt,o=this.geometry.attributes.color.array;return r.set(e),r.toArray(o,0),r.toArray(o,3),r.set(t),r.toArray(o,6),r.toArray(o,9),r.set(n),r.toArray(o,12),r.toArray(o,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class XN{constructor(){this.type="ShapePath",this.color=new Lt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Px,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,o,u){return this.currentPath.bezierCurveTo(e,t,n,r,o,u),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(E){const N=[];for(let I=0,P=E.length;I<P;I++){const z=E[I],U=new hf;U.curves=z.curves,N.push(U)}return N}function n(E,N){const I=N.length;let P=!1;for(let z=I-1,U=0;U<I;z=U++){let H=N[z],V=N[U],L=V.x-H.x,B=V.y-H.y;if(Math.abs(B)>Number.EPSILON){if(B<0&&(H=N[U],L=-L,V=N[z],B=-B),E.y<H.y||E.y>V.y)continue;if(E.y===H.y){if(E.x===H.x)return!0}else{const W=B*(E.x-H.x)-L*(E.y-H.y);if(W===0)return!0;if(W<0)continue;P=!P}}else{if(E.y!==H.y)continue;if(V.x<=E.x&&E.x<=H.x||H.x<=E.x&&E.x<=V.x)return!0}}return P}const r=po.isClockWise,o=this.subPaths;if(o.length===0)return[];let u,h,d;const m=[];if(o.length===1)return h=o[0],d=new hf,d.curves=h.curves,m.push(d),m;let v=!r(o[0].getPoints());v=e?!v:v;const x=[],y=[];let _=[],M=0,R;y[M]=void 0,_[M]=[];for(let E=0,N=o.length;E<N;E++)h=o[E],R=h.getPoints(),u=r(R),u=e?!u:u,u?(!v&&y[M]&&M++,y[M]={s:new hf,p:R},y[M].s.curves=h.curves,v&&M++,_[M]=[]):_[M].push({h,p:R[0]});if(!y[0])return t(o);if(y.length>1){let E=!1,N=0;for(let I=0,P=y.length;I<P;I++)x[I]=[];for(let I=0,P=y.length;I<P;I++){const z=_[I];for(let U=0;U<z.length;U++){const H=z[U];let V=!0;for(let L=0;L<y.length;L++)n(H.p,y[L].p)&&(I!==L&&N++,V?(V=!1,x[L].push(H)):E=!0);V&&x[I].push(H)}}N>0&&E===!1&&(_=x)}let A;for(let E=0,N=y.length;E<N;E++){d=y[E].s,m.push(d),A=_[E];for(let I=0,P=A.length;I<P;I++)d.holes.push(A[I].h)}return m}}class qN extends el{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){zt("Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function YN(s,e){const t=s.image&&s.image.width?s.image.width/s.image.height:1;return t>e?(s.repeat.x=1,s.repeat.y=t/e,s.offset.x=0,s.offset.y=(1-s.repeat.y)/2):(s.repeat.x=e/t,s.repeat.y=1,s.offset.x=(1-s.repeat.x)/2,s.offset.y=0),s}function ZN(s,e){const t=s.image&&s.image.width?s.image.width/s.image.height:1;return t>e?(s.repeat.x=e/t,s.repeat.y=1,s.offset.x=(1-s.repeat.x)/2,s.offset.y=0):(s.repeat.x=1,s.repeat.y=t/e,s.offset.x=0,s.offset.y=(1-s.repeat.y)/2),s}function KN(s){return s.repeat.x=1,s.repeat.y=1,s.offset.x=0,s.offset.y=0,s}function L_(s,e,t,n){const r=QN(n);switch(t){case i1:return s*e;case qm:return s*e/r.components*r.byteLength;case Ym:return s*e/r.components*r.byteLength;case pf:return s*e*2/r.components*r.byteLength;case qx:return s*e*2/r.components*r.byteLength;case r1:return s*e*3/r.components*r.byteLength;case or:return s*e*4/r.components*r.byteLength;case Yx:return s*e*4/r.components*r.byteLength;case vm:case xm:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*8;case ym:case bm:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*16;case $v:case tx:return Math.max(s,16)*Math.max(e,8)/4;case Jv:case ex:return Math.max(s,8)*Math.max(e,8)/2;case nx:case ix:case sx:case ax:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*8;case rx:case ox:case lx:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*16;case cx:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*16;case ux:return Math.floor((s+4)/5)*Math.floor((e+3)/4)*16;case fx:return Math.floor((s+4)/5)*Math.floor((e+4)/5)*16;case hx:return Math.floor((s+5)/6)*Math.floor((e+4)/5)*16;case dx:return Math.floor((s+5)/6)*Math.floor((e+5)/6)*16;case px:return Math.floor((s+7)/8)*Math.floor((e+4)/5)*16;case mx:return Math.floor((s+7)/8)*Math.floor((e+5)/6)*16;case gx:return Math.floor((s+7)/8)*Math.floor((e+7)/8)*16;case vx:return Math.floor((s+9)/10)*Math.floor((e+4)/5)*16;case xx:return Math.floor((s+9)/10)*Math.floor((e+5)/6)*16;case yx:return Math.floor((s+9)/10)*Math.floor((e+7)/8)*16;case bx:return Math.floor((s+9)/10)*Math.floor((e+9)/10)*16;case _x:return Math.floor((s+11)/12)*Math.floor((e+9)/10)*16;case Sx:return Math.floor((s+11)/12)*Math.floor((e+11)/12)*16;case Mx:case Ex:case Tx:return Math.ceil(s/4)*Math.ceil(e/4)*16;case wx:case Ax:return Math.ceil(s/4)*Math.ceil(e/4)*8;case Cx:case Rx:return Math.ceil(s/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function QN(s){switch(s){case Dr:case Gx:return{byteLength:1,components:1};case od:case jx:case Qi:return{byteLength:2,components:1};case Wx:case Xx:return{byteLength:2,components:4};case ca:case Xm:case Li:return{byteLength:4,components:1};case t1:case n1:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${s}.`)}class JN{static contain(e,t){return YN(e,t)}static cover(e,t){return ZN(e,t)}static fill(e){return KN(e)}static getByteLength(e,t,n,r){return L_(e,t,n,r)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:yd}}));typeof window<"u"&&(window.__THREE__?zt("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=yd);function Fw(){let s=null,e=!1,t=null,n=null;function r(o,u){t(o,u),n=s.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(n=s.requestAnimationFrame(r),e=!0)},stop:function(){s.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(o){t=o},setContext:function(o){s=o}}}function $N(s){const e=new WeakMap;function t(h,d){const m=h.array,v=h.usage,x=m.byteLength,y=s.createBuffer();s.bindBuffer(d,y),s.bufferData(d,m,v),h.onUploadCallback();let _;if(m instanceof Float32Array)_=s.FLOAT;else if(typeof Float16Array<"u"&&m instanceof Float16Array)_=s.HALF_FLOAT;else if(m instanceof Uint16Array)h.isFloat16BufferAttribute?_=s.HALF_FLOAT:_=s.UNSIGNED_SHORT;else if(m instanceof Int16Array)_=s.SHORT;else if(m instanceof Uint32Array)_=s.UNSIGNED_INT;else if(m instanceof Int32Array)_=s.INT;else if(m instanceof Int8Array)_=s.BYTE;else if(m instanceof Uint8Array)_=s.UNSIGNED_BYTE;else if(m instanceof Uint8ClampedArray)_=s.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+m);return{buffer:y,type:_,bytesPerElement:m.BYTES_PER_ELEMENT,version:h.version,size:x}}function n(h,d,m){const v=d.array,x=d.updateRanges;if(s.bindBuffer(m,h),x.length===0)s.bufferSubData(m,0,v);else{x.sort((_,M)=>_.start-M.start);let y=0;for(let _=1;_<x.length;_++){const M=x[y],R=x[_];R.start<=M.start+M.count+1?M.count=Math.max(M.count,R.start+R.count-M.start):(++y,x[y]=R)}x.length=y+1;for(let _=0,M=x.length;_<M;_++){const R=x[_];s.bufferSubData(m,R.start*v.BYTES_PER_ELEMENT,v,R.start,R.count)}d.clearUpdateRanges()}d.onUploadCallback()}function r(h){return h.isInterleavedBufferAttribute&&(h=h.data),e.get(h)}function o(h){h.isInterleavedBufferAttribute&&(h=h.data);const d=e.get(h);d&&(s.deleteBuffer(d.buffer),e.delete(h))}function u(h,d){if(h.isInterleavedBufferAttribute&&(h=h.data),h.isGLBufferAttribute){const v=e.get(h);(!v||v.version<h.version)&&e.set(h,{buffer:h.buffer,type:h.type,bytesPerElement:h.elementSize,version:h.version});return}const m=e.get(h);if(m===void 0)e.set(h,t(h,d));else if(m.version<h.version){if(m.size!==h.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(m.buffer,h,d),m.version=h.version}}return{get:r,remove:o,update:u}}var eD=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,tD=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,nD=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,iD=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,rD=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,sD=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,aD=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,oD=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,lD=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,cD=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,uD=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,fD=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,hD=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,dD=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,pD=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,mD=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,gD=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,vD=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,xD=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,yD=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,bD=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,_D=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,SD=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,MD=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,ED=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,TD=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,wD=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,AD=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,CD=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,RD=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,ND="gl_FragColor = linearToOutputTexel( gl_FragColor );",DD=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,ID=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,LD=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,PD=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,UD=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,OD=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,zD=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,BD=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,FD=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,kD=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,VD=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,HD=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,GD=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,jD=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,WD=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,XD=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,qD=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,YD=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,ZD=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,KD=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,QD=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.metalness = metalnessFactor;
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = vec3( 0.04 );
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,JD=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	vec3 diffuseContribution;
	vec3 specularColor;
	vec3 specularColorBlended;
	float roughness;
	float metalness;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
		vec3 iridescenceFresnelDielectric;
		vec3 iridescenceFresnelMetallic;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return v;
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColorBlended;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float rInv = 1.0 / ( roughness + 0.1 );
	float a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;
	float b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;
	float DG = exp( a * dotNV + b );
	return saturate( DG );
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;
	vec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;
	vec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
 
 		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
 
 		float sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
 		float sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );
 
 		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );
 
 		irradiance *= sheenEnergyComp;
 
 	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		diffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectDiffuse += diffuse;
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;
 	#endif
	vec3 singleScatteringDielectric = vec3( 0.0 );
	vec3 multiScatteringDielectric = vec3( 0.0 );
	vec3 singleScatteringMetallic = vec3( 0.0 );
	vec3 multiScatteringMetallic = vec3( 0.0 );
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#endif
	vec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );
	vec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );
	vec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;
	vec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	vec3 indirectSpecular = radiance * singleScattering;
	indirectSpecular += multiScattering * cosineWeightedIrradiance;
	vec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		indirectSpecular *= sheenEnergyComp;
		indirectDiffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectSpecular += indirectSpecular;
	reflectedLight.indirectDiffuse += indirectDiffuse;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,$D=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );
		material.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,e5=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,t5=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,n5=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,i5=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,r5=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,s5=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,a5=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,o5=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,l5=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,c5=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,u5=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,f5=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,h5=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,d5=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,p5=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,m5=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,g5=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,v5=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,x5=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,y5=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,b5=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,_5=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,S5=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,M5=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,E5=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,T5=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,w5=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,A5=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,C5=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,R5=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,N5=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,D5=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,I5=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,L5=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,P5=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,U5=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#else
			uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#endif
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#else
			uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#endif
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#elif defined( SHADOWMAP_TYPE_BASIC )
			uniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#endif
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float interleavedGradientNoise( vec2 position ) {
			return fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );
		}
		vec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {
			const float goldenAngle = 2.399963229728653;
			float r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );
			float theta = float( sampleIndex ) * goldenAngle + phi;
			return vec2( cos( theta ), sin( theta ) ) * r;
		}
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
				float radius = shadowRadius * texelSize.x;
				float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
				shadow = (
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )
				) * 0.2;
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#elif defined( SHADOWMAP_TYPE_VSM )
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;
				float mean = distribution.x;
				float variance = distribution.y * distribution.y;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					float hard_shadow = step( mean, shadowCoord.z );
				#else
					float hard_shadow = step( shadowCoord.z, mean );
				#endif
				if ( hard_shadow == 1.0 ) {
					shadow = 1.0;
				} else {
					variance = max( variance, 0.0000001 );
					float d = shadowCoord.z - mean;
					float p_max = variance / ( variance + d * d );
					p_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );
					shadow = max( hard_shadow, p_max );
				}
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#else
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				float depth = texture2D( shadowMap, shadowCoord.xy ).r;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					shadow = step( depth, shadowCoord.z );
				#else
					shadow = step( shadowCoord.z, depth );
				#endif
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#if defined( SHADOWMAP_TYPE_PCF )
	float getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float texelSize = shadowRadius / shadowMapSize.x;
			vec3 absDir = abs( bd3D );
			vec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );
			tangent = normalize( cross( bd3D, tangent ) );
			vec3 bitangent = cross( bd3D, tangent );
			float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
			shadow = (
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )
			) * 0.2;
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#elif defined( SHADOWMAP_TYPE_BASIC )
	float getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float depth = textureCube( shadowMap, bd3D ).r;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				shadow = step( depth, dp );
			#else
				shadow = step( dp, depth );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#endif
	#endif
#endif`,O5=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,z5=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,B5=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,F5=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,k5=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,V5=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,H5=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,G5=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,j5=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,W5=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,X5=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,q5=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Y5=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Z5=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,K5=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Q5=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,J5=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const $5=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,eI=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,tI=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,nI=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,iI=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,rI=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,sI=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,aI=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,oI=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,lI=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );
}`,cI=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,uI=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,fI=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,hI=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,dI=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,pI=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,mI=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,gI=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vI=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,xI=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,yI=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,bI=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,_I=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,SI=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,MI=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,EI=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
 
		outgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;
 
 	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,TI=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,wI=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,AI=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,CI=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,RI=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,NI=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,DI=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,II=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,An={alphahash_fragment:eD,alphahash_pars_fragment:tD,alphamap_fragment:nD,alphamap_pars_fragment:iD,alphatest_fragment:rD,alphatest_pars_fragment:sD,aomap_fragment:aD,aomap_pars_fragment:oD,batching_pars_vertex:lD,batching_vertex:cD,begin_vertex:uD,beginnormal_vertex:fD,bsdfs:hD,iridescence_fragment:dD,bumpmap_pars_fragment:pD,clipping_planes_fragment:mD,clipping_planes_pars_fragment:gD,clipping_planes_pars_vertex:vD,clipping_planes_vertex:xD,color_fragment:yD,color_pars_fragment:bD,color_pars_vertex:_D,color_vertex:SD,common:MD,cube_uv_reflection_fragment:ED,defaultnormal_vertex:TD,displacementmap_pars_vertex:wD,displacementmap_vertex:AD,emissivemap_fragment:CD,emissivemap_pars_fragment:RD,colorspace_fragment:ND,colorspace_pars_fragment:DD,envmap_fragment:ID,envmap_common_pars_fragment:LD,envmap_pars_fragment:PD,envmap_pars_vertex:UD,envmap_physical_pars_fragment:XD,envmap_vertex:OD,fog_vertex:zD,fog_pars_vertex:BD,fog_fragment:FD,fog_pars_fragment:kD,gradientmap_pars_fragment:VD,lightmap_pars_fragment:HD,lights_lambert_fragment:GD,lights_lambert_pars_fragment:jD,lights_pars_begin:WD,lights_toon_fragment:qD,lights_toon_pars_fragment:YD,lights_phong_fragment:ZD,lights_phong_pars_fragment:KD,lights_physical_fragment:QD,lights_physical_pars_fragment:JD,lights_fragment_begin:$D,lights_fragment_maps:e5,lights_fragment_end:t5,logdepthbuf_fragment:n5,logdepthbuf_pars_fragment:i5,logdepthbuf_pars_vertex:r5,logdepthbuf_vertex:s5,map_fragment:a5,map_pars_fragment:o5,map_particle_fragment:l5,map_particle_pars_fragment:c5,metalnessmap_fragment:u5,metalnessmap_pars_fragment:f5,morphinstance_vertex:h5,morphcolor_vertex:d5,morphnormal_vertex:p5,morphtarget_pars_vertex:m5,morphtarget_vertex:g5,normal_fragment_begin:v5,normal_fragment_maps:x5,normal_pars_fragment:y5,normal_pars_vertex:b5,normal_vertex:_5,normalmap_pars_fragment:S5,clearcoat_normal_fragment_begin:M5,clearcoat_normal_fragment_maps:E5,clearcoat_pars_fragment:T5,iridescence_pars_fragment:w5,opaque_fragment:A5,packing:C5,premultiplied_alpha_fragment:R5,project_vertex:N5,dithering_fragment:D5,dithering_pars_fragment:I5,roughnessmap_fragment:L5,roughnessmap_pars_fragment:P5,shadowmap_pars_fragment:U5,shadowmap_pars_vertex:O5,shadowmap_vertex:z5,shadowmask_pars_fragment:B5,skinbase_vertex:F5,skinning_pars_vertex:k5,skinning_vertex:V5,skinnormal_vertex:H5,specularmap_fragment:G5,specularmap_pars_fragment:j5,tonemapping_fragment:W5,tonemapping_pars_fragment:X5,transmission_fragment:q5,transmission_pars_fragment:Y5,uv_pars_fragment:Z5,uv_pars_vertex:K5,uv_vertex:Q5,worldpos_vertex:J5,background_vert:$5,background_frag:eI,backgroundCube_vert:tI,backgroundCube_frag:nI,cube_vert:iI,cube_frag:rI,depth_vert:sI,depth_frag:aI,distance_vert:oI,distance_frag:lI,equirect_vert:cI,equirect_frag:uI,linedashed_vert:fI,linedashed_frag:hI,meshbasic_vert:dI,meshbasic_frag:pI,meshlambert_vert:mI,meshlambert_frag:gI,meshmatcap_vert:vI,meshmatcap_frag:xI,meshnormal_vert:yI,meshnormal_frag:bI,meshphong_vert:_I,meshphong_frag:SI,meshphysical_vert:MI,meshphysical_frag:EI,meshtoon_vert:TI,meshtoon_frag:wI,points_vert:AI,points_frag:CI,shadow_vert:RI,shadow_frag:NI,sprite_vert:DI,sprite_frag:II},Bt={common:{diffuse:{value:new Lt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new bn},alphaMap:{value:null},alphaMapTransform:{value:new bn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new bn}},envmap:{envMap:{value:null},envMapRotation:{value:new bn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new bn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new bn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new bn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new bn},normalScale:{value:new Je(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new bn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new bn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new bn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new bn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Lt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Lt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new bn},alphaTest:{value:0},uvTransform:{value:new bn}},sprite:{diffuse:{value:new Lt(16777215)},opacity:{value:1},center:{value:new Je(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new bn},alphaMap:{value:null},alphaMapTransform:{value:new bn},alphaTest:{value:0}}},ho={basic:{uniforms:Ss([Bt.common,Bt.specularmap,Bt.envmap,Bt.aomap,Bt.lightmap,Bt.fog]),vertexShader:An.meshbasic_vert,fragmentShader:An.meshbasic_frag},lambert:{uniforms:Ss([Bt.common,Bt.specularmap,Bt.envmap,Bt.aomap,Bt.lightmap,Bt.emissivemap,Bt.bumpmap,Bt.normalmap,Bt.displacementmap,Bt.fog,Bt.lights,{emissive:{value:new Lt(0)}}]),vertexShader:An.meshlambert_vert,fragmentShader:An.meshlambert_frag},phong:{uniforms:Ss([Bt.common,Bt.specularmap,Bt.envmap,Bt.aomap,Bt.lightmap,Bt.emissivemap,Bt.bumpmap,Bt.normalmap,Bt.displacementmap,Bt.fog,Bt.lights,{emissive:{value:new Lt(0)},specular:{value:new Lt(1118481)},shininess:{value:30}}]),vertexShader:An.meshphong_vert,fragmentShader:An.meshphong_frag},standard:{uniforms:Ss([Bt.common,Bt.envmap,Bt.aomap,Bt.lightmap,Bt.emissivemap,Bt.bumpmap,Bt.normalmap,Bt.displacementmap,Bt.roughnessmap,Bt.metalnessmap,Bt.fog,Bt.lights,{emissive:{value:new Lt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:An.meshphysical_vert,fragmentShader:An.meshphysical_frag},toon:{uniforms:Ss([Bt.common,Bt.aomap,Bt.lightmap,Bt.emissivemap,Bt.bumpmap,Bt.normalmap,Bt.displacementmap,Bt.gradientmap,Bt.fog,Bt.lights,{emissive:{value:new Lt(0)}}]),vertexShader:An.meshtoon_vert,fragmentShader:An.meshtoon_frag},matcap:{uniforms:Ss([Bt.common,Bt.bumpmap,Bt.normalmap,Bt.displacementmap,Bt.fog,{matcap:{value:null}}]),vertexShader:An.meshmatcap_vert,fragmentShader:An.meshmatcap_frag},points:{uniforms:Ss([Bt.points,Bt.fog]),vertexShader:An.points_vert,fragmentShader:An.points_frag},dashed:{uniforms:Ss([Bt.common,Bt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:An.linedashed_vert,fragmentShader:An.linedashed_frag},depth:{uniforms:Ss([Bt.common,Bt.displacementmap]),vertexShader:An.depth_vert,fragmentShader:An.depth_frag},normal:{uniforms:Ss([Bt.common,Bt.bumpmap,Bt.normalmap,Bt.displacementmap,{opacity:{value:1}}]),vertexShader:An.meshnormal_vert,fragmentShader:An.meshnormal_frag},sprite:{uniforms:Ss([Bt.sprite,Bt.fog]),vertexShader:An.sprite_vert,fragmentShader:An.sprite_frag},background:{uniforms:{uvTransform:{value:new bn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:An.background_vert,fragmentShader:An.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new bn}},vertexShader:An.backgroundCube_vert,fragmentShader:An.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:An.cube_vert,fragmentShader:An.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:An.equirect_vert,fragmentShader:An.equirect_frag},distance:{uniforms:Ss([Bt.common,Bt.displacementmap,{referencePosition:{value:new Q},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:An.distance_vert,fragmentShader:An.distance_frag},shadow:{uniforms:Ss([Bt.lights,Bt.fog,{color:{value:new Lt(0)},opacity:{value:1}}]),vertexShader:An.shadow_vert,fragmentShader:An.shadow_frag}};ho.physical={uniforms:Ss([ho.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new bn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new bn},clearcoatNormalScale:{value:new Je(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new bn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new bn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new bn},sheen:{value:0},sheenColor:{value:new Lt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new bn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new bn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new bn},transmissionSamplerSize:{value:new Je},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new bn},attenuationDistance:{value:0},attenuationColor:{value:new Lt(0)},specularColor:{value:new Lt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new bn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new bn},anisotropyVector:{value:new Je},anisotropyMap:{value:null},anisotropyMapTransform:{value:new bn}}]),vertexShader:An.meshphysical_vert,fragmentShader:An.meshphysical_frag};const Iv={r:0,b:0,g:0},Qu=new ua,LI=new cn;function PI(s,e,t,n,r,o,u){const h=new Lt(0);let d=o===!0?0:1,m,v,x=null,y=0,_=null;function M(I){let P=I.isScene===!0?I.background:null;return P&&P.isTexture&&(P=(I.backgroundBlurriness>0?t:e).get(P)),P}function R(I){let P=!1;const z=M(I);z===null?E(h,d):z&&z.isColor&&(E(z,1),P=!0);const U=s.xr.getEnvironmentBlendMode();U==="additive"?n.buffers.color.setClear(0,0,0,1,u):U==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,u),(s.autoClear||P)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),s.clear(s.autoClearColor,s.autoClearDepth,s.autoClearStencil))}function A(I,P){const z=M(P);z&&(z.isCubeTexture||z.mapping===bd)?(v===void 0&&(v=new Gi(new bf(1,1,1),new ls({name:"BackgroundCubeMaterial",uniforms:dd(ho.backgroundCube.uniforms),vertexShader:ho.backgroundCube.vertexShader,fragmentShader:ho.backgroundCube.fragmentShader,side:ss,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),v.geometry.deleteAttribute("normal"),v.geometry.deleteAttribute("uv"),v.onBeforeRender=function(U,H,V){this.matrixWorld.copyPosition(V.matrixWorld)},Object.defineProperty(v.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(v)),Qu.copy(P.backgroundRotation),Qu.x*=-1,Qu.y*=-1,Qu.z*=-1,z.isCubeTexture&&z.isRenderTargetTexture===!1&&(Qu.y*=-1,Qu.z*=-1),v.material.uniforms.envMap.value=z,v.material.uniforms.flipEnvMap.value=z.isCubeTexture&&z.isRenderTargetTexture===!1?-1:1,v.material.uniforms.backgroundBlurriness.value=P.backgroundBlurriness,v.material.uniforms.backgroundIntensity.value=P.backgroundIntensity,v.material.uniforms.backgroundRotation.value.setFromMatrix4(LI.makeRotationFromEuler(Qu)),v.material.toneMapped=kn.getTransfer(z.colorSpace)!==ti,(x!==z||y!==z.version||_!==s.toneMapping)&&(v.material.needsUpdate=!0,x=z,y=z.version,_=s.toneMapping),v.layers.enableAll(),I.unshift(v,v.geometry,v.material,0,0,null)):z&&z.isTexture&&(m===void 0&&(m=new Gi(new Jc(2,2),new ls({name:"BackgroundMaterial",uniforms:dd(ho.background.uniforms),vertexShader:ho.background.vertexShader,fragmentShader:ho.background.fragmentShader,side:Hl,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),m.geometry.deleteAttribute("normal"),Object.defineProperty(m.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(m)),m.material.uniforms.t2D.value=z,m.material.uniforms.backgroundIntensity.value=P.backgroundIntensity,m.material.toneMapped=kn.getTransfer(z.colorSpace)!==ti,z.matrixAutoUpdate===!0&&z.updateMatrix(),m.material.uniforms.uvTransform.value.copy(z.matrix),(x!==z||y!==z.version||_!==s.toneMapping)&&(m.material.needsUpdate=!0,x=z,y=z.version,_=s.toneMapping),m.layers.enableAll(),I.unshift(m,m.geometry,m.material,0,0,null))}function E(I,P){I.getRGB(Iv,GT(s)),n.buffers.color.setClear(Iv.r,Iv.g,Iv.b,P,u)}function N(){v!==void 0&&(v.geometry.dispose(),v.material.dispose(),v=void 0),m!==void 0&&(m.geometry.dispose(),m.material.dispose(),m=void 0)}return{getClearColor:function(){return h},setClearColor:function(I,P=1){h.set(I),d=P,E(h,d)},getClearAlpha:function(){return d},setClearAlpha:function(I){d=I,E(h,d)},render:R,addToRenderList:A,dispose:N}}function UI(s,e){const t=s.getParameter(s.MAX_VERTEX_ATTRIBS),n={},r=y(null);let o=r,u=!1;function h(B,W,ie,J,se){let ce=!1;const Y=x(J,ie,W);o!==Y&&(o=Y,m(o.object)),ce=_(B,J,ie,se),ce&&M(B,J,ie,se),se!==null&&e.update(se,s.ELEMENT_ARRAY_BUFFER),(ce||u)&&(u=!1,P(B,W,ie,J),se!==null&&s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e.get(se).buffer))}function d(){return s.createVertexArray()}function m(B){return s.bindVertexArray(B)}function v(B){return s.deleteVertexArray(B)}function x(B,W,ie){const J=ie.wireframe===!0;let se=n[B.id];se===void 0&&(se={},n[B.id]=se);let ce=se[W.id];ce===void 0&&(ce={},se[W.id]=ce);let Y=ce[J];return Y===void 0&&(Y=y(d()),ce[J]=Y),Y}function y(B){const W=[],ie=[],J=[];for(let se=0;se<t;se++)W[se]=0,ie[se]=0,J[se]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:W,enabledAttributes:ie,attributeDivisors:J,object:B,attributes:{},index:null}}function _(B,W,ie,J){const se=o.attributes,ce=W.attributes;let Y=0;const ne=ie.getAttributes();for(const ve in ne)if(ne[ve].location>=0){const re=se[ve];let j=ce[ve];if(j===void 0&&(ve==="instanceMatrix"&&B.instanceMatrix&&(j=B.instanceMatrix),ve==="instanceColor"&&B.instanceColor&&(j=B.instanceColor)),re===void 0||re.attribute!==j||j&&re.data!==j.data)return!0;Y++}return o.attributesNum!==Y||o.index!==J}function M(B,W,ie,J){const se={},ce=W.attributes;let Y=0;const ne=ie.getAttributes();for(const ve in ne)if(ne[ve].location>=0){let re=ce[ve];re===void 0&&(ve==="instanceMatrix"&&B.instanceMatrix&&(re=B.instanceMatrix),ve==="instanceColor"&&B.instanceColor&&(re=B.instanceColor));const j={};j.attribute=re,re&&re.data&&(j.data=re.data),se[ve]=j,Y++}o.attributes=se,o.attributesNum=Y,o.index=J}function R(){const B=o.newAttributes;for(let W=0,ie=B.length;W<ie;W++)B[W]=0}function A(B){E(B,0)}function E(B,W){const ie=o.newAttributes,J=o.enabledAttributes,se=o.attributeDivisors;ie[B]=1,J[B]===0&&(s.enableVertexAttribArray(B),J[B]=1),se[B]!==W&&(s.vertexAttribDivisor(B,W),se[B]=W)}function N(){const B=o.newAttributes,W=o.enabledAttributes;for(let ie=0,J=W.length;ie<J;ie++)W[ie]!==B[ie]&&(s.disableVertexAttribArray(ie),W[ie]=0)}function I(B,W,ie,J,se,ce,Y){Y===!0?s.vertexAttribIPointer(B,W,ie,se,ce):s.vertexAttribPointer(B,W,ie,J,se,ce)}function P(B,W,ie,J){R();const se=J.attributes,ce=ie.getAttributes(),Y=W.defaultAttributeValues;for(const ne in ce){const ve=ce[ne];if(ve.location>=0){let ae=se[ne];if(ae===void 0&&(ne==="instanceMatrix"&&B.instanceMatrix&&(ae=B.instanceMatrix),ne==="instanceColor"&&B.instanceColor&&(ae=B.instanceColor)),ae!==void 0){const re=ae.normalized,j=ae.itemSize,le=e.get(ae);if(le===void 0)continue;const Me=le.buffer,Ue=le.type,lt=le.bytesPerElement,pe=Ue===s.INT||Ue===s.UNSIGNED_INT||ae.gpuType===Xm;if(ae.isInterleavedBufferAttribute){const Re=ae.data,it=Re.stride,xt=ae.offset;if(Re.isInstancedInterleavedBuffer){for(let dt=0;dt<ve.locationSize;dt++)E(ve.location+dt,Re.meshPerAttribute);B.isInstancedMesh!==!0&&J._maxInstanceCount===void 0&&(J._maxInstanceCount=Re.meshPerAttribute*Re.count)}else for(let dt=0;dt<ve.locationSize;dt++)A(ve.location+dt);s.bindBuffer(s.ARRAY_BUFFER,Me);for(let dt=0;dt<ve.locationSize;dt++)I(ve.location+dt,j/ve.locationSize,Ue,re,it*lt,(xt+j/ve.locationSize*dt)*lt,pe)}else{if(ae.isInstancedBufferAttribute){for(let Re=0;Re<ve.locationSize;Re++)E(ve.location+Re,ae.meshPerAttribute);B.isInstancedMesh!==!0&&J._maxInstanceCount===void 0&&(J._maxInstanceCount=ae.meshPerAttribute*ae.count)}else for(let Re=0;Re<ve.locationSize;Re++)A(ve.location+Re);s.bindBuffer(s.ARRAY_BUFFER,Me);for(let Re=0;Re<ve.locationSize;Re++)I(ve.location+Re,j/ve.locationSize,Ue,re,j*lt,j/ve.locationSize*Re*lt,pe)}}else if(Y!==void 0){const re=Y[ne];if(re!==void 0)switch(re.length){case 2:s.vertexAttrib2fv(ve.location,re);break;case 3:s.vertexAttrib3fv(ve.location,re);break;case 4:s.vertexAttrib4fv(ve.location,re);break;default:s.vertexAttrib1fv(ve.location,re)}}}}N()}function z(){V();for(const B in n){const W=n[B];for(const ie in W){const J=W[ie];for(const se in J)v(J[se].object),delete J[se];delete W[ie]}delete n[B]}}function U(B){if(n[B.id]===void 0)return;const W=n[B.id];for(const ie in W){const J=W[ie];for(const se in J)v(J[se].object),delete J[se];delete W[ie]}delete n[B.id]}function H(B){for(const W in n){const ie=n[W];if(ie[B.id]===void 0)continue;const J=ie[B.id];for(const se in J)v(J[se].object),delete J[se];delete ie[B.id]}}function V(){L(),u=!0,o!==r&&(o=r,m(o.object))}function L(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:h,reset:V,resetDefaultState:L,dispose:z,releaseStatesOfGeometry:U,releaseStatesOfProgram:H,initAttributes:R,enableAttribute:A,disableUnusedAttributes:N}}function OI(s,e,t){let n;function r(m){n=m}function o(m,v){s.drawArrays(n,m,v),t.update(v,n,1)}function u(m,v,x){x!==0&&(s.drawArraysInstanced(n,m,v,x),t.update(v,n,x))}function h(m,v,x){if(x===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,m,0,v,0,x);let _=0;for(let M=0;M<x;M++)_+=v[M];t.update(_,n,1)}function d(m,v,x,y){if(x===0)return;const _=e.get("WEBGL_multi_draw");if(_===null)for(let M=0;M<m.length;M++)u(m[M],v[M],y[M]);else{_.multiDrawArraysInstancedWEBGL(n,m,0,v,0,y,0,x);let M=0;for(let R=0;R<x;R++)M+=v[R]*y[R];t.update(M,n,1)}}this.setMode=r,this.render=o,this.renderInstances=u,this.renderMultiDraw=h,this.renderMultiDrawInstances=d}function zI(s,e,t,n){let r;function o(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const H=e.get("EXT_texture_filter_anisotropic");r=s.getParameter(H.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function u(H){return!(H!==or&&n.convert(H)!==s.getParameter(s.IMPLEMENTATION_COLOR_READ_FORMAT))}function h(H){const V=H===Qi&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(H!==Dr&&n.convert(H)!==s.getParameter(s.IMPLEMENTATION_COLOR_READ_TYPE)&&H!==Li&&!V)}function d(H){if(H==="highp"){if(s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.HIGH_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision>0)return"highp";H="mediump"}return H==="mediump"&&s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.MEDIUM_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let m=t.precision!==void 0?t.precision:"highp";const v=d(m);v!==m&&(zt("WebGLRenderer:",m,"not supported, using",v,"instead."),m=v);const x=t.logarithmicDepthBuffer===!0,y=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),_=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),M=s.getParameter(s.MAX_VERTEX_TEXTURE_IMAGE_UNITS),R=s.getParameter(s.MAX_TEXTURE_SIZE),A=s.getParameter(s.MAX_CUBE_MAP_TEXTURE_SIZE),E=s.getParameter(s.MAX_VERTEX_ATTRIBS),N=s.getParameter(s.MAX_VERTEX_UNIFORM_VECTORS),I=s.getParameter(s.MAX_VARYING_VECTORS),P=s.getParameter(s.MAX_FRAGMENT_UNIFORM_VECTORS),z=s.getParameter(s.MAX_SAMPLES),U=s.getParameter(s.SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:o,getMaxPrecision:d,textureFormatReadable:u,textureTypeReadable:h,precision:m,logarithmicDepthBuffer:x,reversedDepthBuffer:y,maxTextures:_,maxVertexTextures:M,maxTextureSize:R,maxCubemapSize:A,maxAttributes:E,maxVertexUniforms:N,maxVaryings:I,maxFragmentUniforms:P,maxSamples:z,samples:U}}function BI(s){const e=this;let t=null,n=0,r=!1,o=!1;const u=new sa,h=new bn,d={value:null,needsUpdate:!1};this.uniform=d,this.numPlanes=0,this.numIntersection=0,this.init=function(x,y){const _=x.length!==0||y||n!==0||r;return r=y,n=x.length,_},this.beginShadows=function(){o=!0,v(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(x,y){t=v(x,y,0)},this.setState=function(x,y,_){const M=x.clippingPlanes,R=x.clipIntersection,A=x.clipShadows,E=s.get(x);if(!r||M===null||M.length===0||o&&!A)o?v(null):m();else{const N=o?0:n,I=N*4;let P=E.clippingState||null;d.value=P,P=v(M,y,I,_);for(let z=0;z!==I;++z)P[z]=t[z];E.clippingState=P,this.numIntersection=R?this.numPlanes:0,this.numPlanes+=N}};function m(){d.value!==t&&(d.value=t,d.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function v(x,y,_,M){const R=x!==null?x.length:0;let A=null;if(R!==0){if(A=d.value,M!==!0||A===null){const E=_+R*4,N=y.matrixWorldInverse;h.getNormalMatrix(N),(A===null||A.length<E)&&(A=new Float32Array(E));for(let I=0,P=_;I!==R;++I,P+=4)u.copy(x[I]).applyMatrix4(N,h),u.normal.toArray(A,P),A[P+3]=u.constant}d.value=A,d.needsUpdate=!0}return e.numPlanes=R,e.numIntersection=0,A}}function FI(s){let e=new WeakMap;function t(u,h){return h===ad?u.mapping=go:h===wm&&(u.mapping=qc),u}function n(u){if(u&&u.isTexture){const h=u.mapping;if(h===ad||h===wm)if(e.has(u)){const d=e.get(u).texture;return t(d,u.mapping)}else{const d=u.image;if(d&&d.height>0){const m=new ny(d.height);return m.fromEquirectangularTexture(s,u),e.set(u,m),u.addEventListener("dispose",r),t(m.texture,u.mapping)}else return null}}return u}function r(u){const h=u.target;h.removeEventListener("dispose",r);const d=e.get(h);d!==void 0&&(e.delete(h),d.dispose())}function o(){e=new WeakMap}return{get:n,dispose:o}}const jc=4,KM=[.125,.215,.35,.446,.526,.582],nf=20,kI=256,lm=new Ha,QM=new Lt;let $b=null,e_=0,t_=0,n_=!1;const VI=new Q;class P_{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,n=.1,r=100,o={}){const{size:u=256,position:h=VI}=o;$b=this._renderer.getRenderTarget(),e_=this._renderer.getActiveCubeFace(),t_=this._renderer.getActiveMipmapLevel(),n_=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(u);const d=this._allocateTargets();return d.depthBuffer=!0,this._sceneToCubeUV(e,n,r,d,h),t>0&&this._blur(d,0,0,t),this._applyPMREM(d),this._cleanup(d),d}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=eE(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=$M(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget($b,e_,t_),this._renderer.xr.enabled=n_,e.scissorTest=!1,Zh(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===go||e.mapping===qc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),$b=this._renderer.getRenderTarget(),e_=this._renderer.getActiveCubeFace(),t_=this._renderer.getActiveMipmapLevel(),n_=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Gn,minFilter:Gn,generateMipmaps:!1,type:Qi,format:or,colorSpace:vo,depthBuffer:!1},r=JM(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=JM(e,t,n);const{_lodMax:o}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=HI(o)),this._blurMaterial=jI(o,e,t),this._ggxMaterial=GI(o,e,t)}return r}_compileMaterial(e){const t=new Gi(new vn,e);this._renderer.compile(t,lm)}_sceneToCubeUV(e,t,n,r,o){const d=new Vi(90,1,t,n),m=[1,-1,1,1,1,1],v=[1,1,1,-1,-1,-1],x=this._renderer,y=x.autoClear,_=x.toneMapping;x.getClearColor(QM),x.toneMapping=ka,x.autoClear=!1,x.state.buffers.depth.getReversed()&&(x.setRenderTarget(r),x.clearDepth(),x.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new Gi(new bf,new Gl({name:"PMREM.Background",side:ss,depthWrite:!1,depthTest:!1})));const R=this._backgroundBox,A=R.material;let E=!1;const N=e.background;N?N.isColor&&(A.color.copy(N),e.background=null,E=!0):(A.color.copy(QM),E=!0);for(let I=0;I<6;I++){const P=I%3;P===0?(d.up.set(0,m[I],0),d.position.set(o.x,o.y,o.z),d.lookAt(o.x+v[I],o.y,o.z)):P===1?(d.up.set(0,0,m[I]),d.position.set(o.x,o.y,o.z),d.lookAt(o.x,o.y+v[I],o.z)):(d.up.set(0,m[I],0),d.position.set(o.x,o.y,o.z),d.lookAt(o.x,o.y,o.z+v[I]));const z=this._cubeSize;Zh(r,P*z,I>2?z:0,z,z),x.setRenderTarget(r),E&&x.render(R,d),x.render(e,d)}x.toneMapping=_,x.autoClear=y,e.background=N}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===go||e.mapping===qc;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=eE()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=$M());const o=r?this._cubemapMaterial:this._equirectMaterial,u=this._lodMeshes[0];u.material=o;const h=o.uniforms;h.envMap.value=e;const d=this._cubeSize;Zh(t,0,0,3*d,2*d),n.setRenderTarget(t),n.render(u,lm)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodMeshes.length;for(let o=1;o<r;o++)this._applyGGXFilter(e,o-1,o);t.autoClear=n}_applyGGXFilter(e,t,n){const r=this._renderer,o=this._pingPongRenderTarget,u=this._ggxMaterial,h=this._lodMeshes[n];h.material=u;const d=u.uniforms,m=n/(this._lodMeshes.length-1),v=t/(this._lodMeshes.length-1),x=Math.sqrt(m*m-v*v),y=0+m*1.25,_=x*y,{_lodMax:M}=this,R=this._sizeLods[n],A=3*R*(n>M-jc?n-M+jc:0),E=4*(this._cubeSize-R);d.envMap.value=e.texture,d.roughness.value=_,d.mipInt.value=M-t,Zh(o,A,E,3*R,2*R),r.setRenderTarget(o),r.render(h,lm),d.envMap.value=o.texture,d.roughness.value=0,d.mipInt.value=M-n,Zh(e,A,E,3*R,2*R),r.setRenderTarget(e),r.render(h,lm)}_blur(e,t,n,r,o){const u=this._pingPongRenderTarget;this._halfBlur(e,u,t,n,r,"latitudinal",o),this._halfBlur(u,e,n,n,r,"longitudinal",o)}_halfBlur(e,t,n,r,o,u,h){const d=this._renderer,m=this._blurMaterial;u!=="latitudinal"&&u!=="longitudinal"&&Qt("blur direction must be either latitudinal or longitudinal!");const v=3,x=this._lodMeshes[r];x.material=m;const y=m.uniforms,_=this._sizeLods[n]-1,M=isFinite(o)?Math.PI/(2*_):2*Math.PI/(2*nf-1),R=o/M,A=isFinite(o)?1+Math.floor(v*R):nf;A>nf&&zt(`sigmaRadians, ${o}, is too large and will clip, as it requested ${A} samples when the maximum is set to ${nf}`);const E=[];let N=0;for(let H=0;H<nf;++H){const V=H/R,L=Math.exp(-V*V/2);E.push(L),H===0?N+=L:H<A&&(N+=2*L)}for(let H=0;H<E.length;H++)E[H]=E[H]/N;y.envMap.value=e.texture,y.samples.value=A,y.weights.value=E,y.latitudinal.value=u==="latitudinal",h&&(y.poleAxis.value=h);const{_lodMax:I}=this;y.dTheta.value=M,y.mipInt.value=I-n;const P=this._sizeLods[r],z=3*P*(r>I-jc?r-I+jc:0),U=4*(this._cubeSize-P);Zh(t,z,U,3*P,2*P),d.setRenderTarget(t),d.render(x,lm)}}function HI(s){const e=[],t=[],n=[];let r=s;const o=s-jc+1+KM.length;for(let u=0;u<o;u++){const h=Math.pow(2,r);e.push(h);let d=1/h;u>s-jc?d=KM[u-s+jc-1]:u===0&&(d=0),t.push(d);const m=1/(h-2),v=-m,x=1+m,y=[v,v,x,v,x,x,v,v,x,x,v,x],_=6,M=6,R=3,A=2,E=1,N=new Float32Array(R*M*_),I=new Float32Array(A*M*_),P=new Float32Array(E*M*_);for(let U=0;U<_;U++){const H=U%3*2/3-1,V=U>2?0:-1,L=[H,V,0,H+2/3,V,0,H+2/3,V+1,0,H,V,0,H+2/3,V+1,0,H,V+1,0];N.set(L,R*M*U),I.set(y,A*M*U);const B=[U,U,U,U,U,U];P.set(B,E*M*U)}const z=new vn;z.setAttribute("position",new li(N,R)),z.setAttribute("uv",new li(I,A)),z.setAttribute("faceIndex",new li(P,E)),n.push(new Gi(z,null)),r>jc&&r--}return{lodMeshes:n,sizeLods:e,sigmas:t}}function JM(s,e,t){const n=new Ts(s,e,t);return n.texture.mapping=bd,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function Zh(s,e,t,n,r){s.viewport.set(e,t,n,r),s.scissor.set(e,t,n,r)}function GI(s,e,t){return new ls({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:kI,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${s}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:Ty(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 3.2: Transform view direction to hemisphere configuration
				vec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));

				// Section 4.1: Orthonormal basis
				float lensq = Vh.x * Vh.x + Vh.y * Vh.y;
				vec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(Vh, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + Vh.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:mo,depthTest:!1,depthWrite:!1})}function jI(s,e,t){const n=new Float32Array(nf),r=new Q(0,1,0);return new ls({name:"SphericalGaussianBlur",defines:{n:nf,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${s}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:Ty(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:mo,depthTest:!1,depthWrite:!1})}function $M(){return new ls({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Ty(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:mo,depthTest:!1,depthWrite:!1})}function eE(){return new ls({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Ty(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:mo,depthTest:!1,depthWrite:!1})}function Ty(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function WI(s){let e=new WeakMap,t=null;function n(h){if(h&&h.isTexture){const d=h.mapping,m=d===ad||d===wm,v=d===go||d===qc;if(m||v){let x=e.get(h);const y=x!==void 0?x.texture.pmremVersion:0;if(h.isRenderTargetTexture&&h.pmremVersion!==y)return t===null&&(t=new P_(s)),x=m?t.fromEquirectangular(h,x):t.fromCubemap(h,x),x.texture.pmremVersion=h.pmremVersion,e.set(h,x),x.texture;if(x!==void 0)return x.texture;{const _=h.image;return m&&_&&_.height>0||v&&_&&r(_)?(t===null&&(t=new P_(s)),x=m?t.fromEquirectangular(h):t.fromCubemap(h),x.texture.pmremVersion=h.pmremVersion,e.set(h,x),h.addEventListener("dispose",o),x.texture):null}}}return h}function r(h){let d=0;const m=6;for(let v=0;v<m;v++)h[v]!==void 0&&d++;return d===m}function o(h){const d=h.target;d.removeEventListener("dispose",o);const m=e.get(d);m!==void 0&&(e.delete(d),m.dispose())}function u(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:u}}function XI(s){const e={};function t(n){if(e[n]!==void 0)return e[n];const r=s.getExtension(n);return e[n]=r,r}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const r=t(n);return r===null&&ud("WebGLRenderer: "+n+" extension not supported."),r}}}function qI(s,e,t,n){const r={},o=new WeakMap;function u(x){const y=x.target;y.index!==null&&e.remove(y.index);for(const M in y.attributes)e.remove(y.attributes[M]);y.removeEventListener("dispose",u),delete r[y.id];const _=o.get(y);_&&(e.remove(_),o.delete(y)),n.releaseStatesOfGeometry(y),y.isInstancedBufferGeometry===!0&&delete y._maxInstanceCount,t.memory.geometries--}function h(x,y){return r[y.id]===!0||(y.addEventListener("dispose",u),r[y.id]=!0,t.memory.geometries++),y}function d(x){const y=x.attributes;for(const _ in y)e.update(y[_],s.ARRAY_BUFFER)}function m(x){const y=[],_=x.index,M=x.attributes.position;let R=0;if(_!==null){const N=_.array;R=_.version;for(let I=0,P=N.length;I<P;I+=3){const z=N[I+0],U=N[I+1],H=N[I+2];y.push(z,U,U,H,H,z)}}else if(M!==void 0){const N=M.array;R=M.version;for(let I=0,P=N.length/3-1;I<P;I+=3){const z=I+0,U=I+1,H=I+2;y.push(z,U,U,H,H,z)}}else return;const A=new(BT(y)?c1:l1)(y,1);A.version=R;const E=o.get(x);E&&e.remove(E),o.set(x,A)}function v(x){const y=o.get(x);if(y){const _=x.index;_!==null&&y.version<_.version&&m(x)}else m(x);return o.get(x)}return{get:h,update:d,getWireframeAttribute:v}}function YI(s,e,t){let n;function r(y){n=y}let o,u;function h(y){o=y.type,u=y.bytesPerElement}function d(y,_){s.drawElements(n,_,o,y*u),t.update(_,n,1)}function m(y,_,M){M!==0&&(s.drawElementsInstanced(n,_,o,y*u,M),t.update(_,n,M))}function v(y,_,M){if(M===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,_,0,o,y,0,M);let A=0;for(let E=0;E<M;E++)A+=_[E];t.update(A,n,1)}function x(y,_,M,R){if(M===0)return;const A=e.get("WEBGL_multi_draw");if(A===null)for(let E=0;E<y.length;E++)m(y[E]/u,_[E],R[E]);else{A.multiDrawElementsInstancedWEBGL(n,_,0,o,y,0,R,0,M);let E=0;for(let N=0;N<M;N++)E+=_[N]*R[N];t.update(E,n,1)}}this.setMode=r,this.setIndex=h,this.render=d,this.renderInstances=m,this.renderMultiDraw=v,this.renderMultiDrawInstances=x}function ZI(s){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(o,u,h){switch(t.calls++,u){case s.TRIANGLES:t.triangles+=h*(o/3);break;case s.LINES:t.lines+=h*(o/2);break;case s.LINE_STRIP:t.lines+=h*(o-1);break;case s.LINE_LOOP:t.lines+=h*o;break;case s.POINTS:t.points+=h*o;break;default:Qt("WebGLInfo: Unknown draw mode:",u);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:n}}function KI(s,e,t){const n=new WeakMap,r=new hi;function o(u,h,d){const m=u.morphTargetInfluences,v=h.morphAttributes.position||h.morphAttributes.normal||h.morphAttributes.color,x=v!==void 0?v.length:0;let y=n.get(h);if(y===void 0||y.count!==x){let L=function(){H.dispose(),n.delete(h),h.removeEventListener("dispose",L)};y!==void 0&&y.texture.dispose();const _=h.morphAttributes.position!==void 0,M=h.morphAttributes.normal!==void 0,R=h.morphAttributes.color!==void 0,A=h.morphAttributes.position||[],E=h.morphAttributes.normal||[],N=h.morphAttributes.color||[];let I=0;_===!0&&(I=1),M===!0&&(I=2),R===!0&&(I=3);let P=h.attributes.position.count*I,z=1;P>e.maxTextureSize&&(z=Math.ceil(P/e.maxTextureSize),P=e.maxTextureSize);const U=new Float32Array(P*z*4*x),H=new $x(U,P,z,x);H.type=Li,H.needsUpdate=!0;const V=I*4;for(let B=0;B<x;B++){const W=A[B],ie=E[B],J=N[B],se=P*z*4*B;for(let ce=0;ce<W.count;ce++){const Y=ce*V;_===!0&&(r.fromBufferAttribute(W,ce),U[se+Y+0]=r.x,U[se+Y+1]=r.y,U[se+Y+2]=r.z,U[se+Y+3]=0),M===!0&&(r.fromBufferAttribute(ie,ce),U[se+Y+4]=r.x,U[se+Y+5]=r.y,U[se+Y+6]=r.z,U[se+Y+7]=0),R===!0&&(r.fromBufferAttribute(J,ce),U[se+Y+8]=r.x,U[se+Y+9]=r.y,U[se+Y+10]=r.z,U[se+Y+11]=J.itemSize===4?r.w:1)}}y={count:x,texture:H,size:new Je(P,z)},n.set(h,y),h.addEventListener("dispose",L)}if(u.isInstancedMesh===!0&&u.morphTexture!==null)d.getUniforms().setValue(s,"morphTexture",u.morphTexture,t);else{let _=0;for(let R=0;R<m.length;R++)_+=m[R];const M=h.morphTargetsRelative?1:1-_;d.getUniforms().setValue(s,"morphTargetBaseInfluence",M),d.getUniforms().setValue(s,"morphTargetInfluences",m)}d.getUniforms().setValue(s,"morphTargetsTexture",y.texture,t),d.getUniforms().setValue(s,"morphTargetsTextureSize",y.size)}return{update:o}}function QI(s,e,t,n){let r=new WeakMap;function o(d){const m=n.render.frame,v=d.geometry,x=e.get(d,v);if(r.get(x)!==m&&(e.update(x),r.set(x,m)),d.isInstancedMesh&&(d.hasEventListener("dispose",h)===!1&&d.addEventListener("dispose",h),r.get(d)!==m&&(t.update(d.instanceMatrix,s.ARRAY_BUFFER),d.instanceColor!==null&&t.update(d.instanceColor,s.ARRAY_BUFFER),r.set(d,m))),d.isSkinnedMesh){const y=d.skeleton;r.get(y)!==m&&(y.update(),r.set(y,m))}return x}function u(){r=new WeakMap}function h(d){const m=d.target;m.removeEventListener("dispose",h),t.remove(m.instanceMatrix),m.instanceColor!==null&&t.remove(m.instanceColor)}return{update:o,dispose:u}}const JI={[Y_]:"LINEAR_TONE_MAPPING",[Z_]:"REINHARD_TONE_MAPPING",[K_]:"CINEON_TONE_MAPPING",[Hx]:"ACES_FILMIC_TONE_MAPPING",[J_]:"AGX_TONE_MAPPING",[$_]:"NEUTRAL_TONE_MAPPING",[Q_]:"CUSTOM_TONE_MAPPING"};function $I(s,e,t,n,r){const o=new Ts(e,t,{type:s,depthBuffer:n,stencilBuffer:r}),u=new Ts(e,t,{type:Qi,depthBuffer:!1,stencilBuffer:!1}),h=new vn;h.setAttribute("position",new Wt([-1,3,0,-1,-1,0,3,-1,0],3)),h.setAttribute("uv",new Wt([0,2,0,0,2,0],2));const d=new _1({uniforms:{tDiffuse:{value:null}},vertexShader:`
			precision highp float;

			uniform mat4 modelViewMatrix;
			uniform mat4 projectionMatrix;

			attribute vec3 position;
			attribute vec2 uv;

			varying vec2 vUv;

			void main() {
				vUv = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}`,fragmentShader:`
			precision highp float;

			uniform sampler2D tDiffuse;

			varying vec2 vUv;

			#include <tonemapping_pars_fragment>
			#include <colorspace_pars_fragment>

			void main() {
				gl_FragColor = texture2D( tDiffuse, vUv );

				#ifdef LINEAR_TONE_MAPPING
					gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );
				#elif defined( REINHARD_TONE_MAPPING )
					gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );
				#elif defined( CINEON_TONE_MAPPING )
					gl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );
				#elif defined( ACES_FILMIC_TONE_MAPPING )
					gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );
				#elif defined( AGX_TONE_MAPPING )
					gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );
				#elif defined( NEUTRAL_TONE_MAPPING )
					gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );
				#elif defined( CUSTOM_TONE_MAPPING )
					gl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );
				#endif

				#ifdef SRGB_TRANSFER
					gl_FragColor = sRGBTransferOETF( gl_FragColor );
				#endif
			}`,depthTest:!1,depthWrite:!1}),m=new Gi(h,d),v=new Ha(-1,1,1,-1,0,1);let x=null,y=null,_=!1,M,R=null,A=[],E=!1;this.setSize=function(N,I){o.setSize(N,I),u.setSize(N,I);for(let P=0;P<A.length;P++){const z=A[P];z.setSize&&z.setSize(N,I)}},this.setEffects=function(N){A=N,E=A.length>0&&A[0].isRenderPass===!0;const I=o.width,P=o.height;for(let z=0;z<A.length;z++){const U=A[z];U.setSize&&U.setSize(I,P)}},this.begin=function(N,I){if(_||N.toneMapping===ka&&A.length===0)return!1;if(R=I,I!==null){const P=I.width,z=I.height;(o.width!==P||o.height!==z)&&this.setSize(P,z)}return E===!1&&N.setRenderTarget(o),M=N.toneMapping,N.toneMapping=ka,!0},this.hasRenderPass=function(){return E},this.end=function(N,I){N.toneMapping=M,_=!0;let P=o,z=u;for(let U=0;U<A.length;U++){const H=A[U];if(H.enabled!==!1&&(H.render(N,z,P,I),H.needsSwap!==!1)){const V=P;P=z,z=V}}if(x!==N.outputColorSpace||y!==N.toneMapping){x=N.outputColorSpace,y=N.toneMapping,d.defines={},kn.getTransfer(x)===ti&&(d.defines.SRGB_TRANSFER="");const U=JI[y];U&&(d.defines[U]=""),d.needsUpdate=!0}d.uniforms.tDiffuse.value=P.texture,N.setRenderTarget(R),N.render(m,v),R=null,_=!1},this.isCompositing=function(){return _},this.dispose=function(){o.dispose(),u.dispose(),h.dispose(),d.dispose()}}const kw=new oi,U_=new md(1,1),Vw=new $x,Hw=new ey,Gw=new Zm,tE=[],nE=[],iE=new Float32Array(16),rE=new Float32Array(9),sE=new Float32Array(4);function Md(s,e,t){const n=s[0];if(n<=0||n>0)return s;const r=e*t;let o=tE[r];if(o===void 0&&(o=new Float32Array(r),tE[r]=o),e!==0){n.toArray(o,0);for(let u=1,h=0;u!==e;++u)h+=t,s[u].toArray(o,h)}return o}function Mr(s,e){if(s.length!==e.length)return!1;for(let t=0,n=s.length;t<n;t++)if(s[t]!==e[t])return!1;return!0}function Er(s,e){for(let t=0,n=e.length;t<n;t++)s[t]=e[t]}function wy(s,e){let t=nE[e];t===void 0&&(t=new Int32Array(e),nE[e]=t);for(let n=0;n!==e;++n)t[n]=s.allocateTextureUnit();return t}function eL(s,e){const t=this.cache;t[0]!==e&&(s.uniform1f(this.addr,e),t[0]=e)}function tL(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Mr(t,e))return;s.uniform2fv(this.addr,e),Er(t,e)}}function nL(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(s.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Mr(t,e))return;s.uniform3fv(this.addr,e),Er(t,e)}}function iL(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Mr(t,e))return;s.uniform4fv(this.addr,e),Er(t,e)}}function rL(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Mr(t,e))return;s.uniformMatrix2fv(this.addr,!1,e),Er(t,e)}else{if(Mr(t,n))return;sE.set(n),s.uniformMatrix2fv(this.addr,!1,sE),Er(t,n)}}function sL(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Mr(t,e))return;s.uniformMatrix3fv(this.addr,!1,e),Er(t,e)}else{if(Mr(t,n))return;rE.set(n),s.uniformMatrix3fv(this.addr,!1,rE),Er(t,n)}}function aL(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Mr(t,e))return;s.uniformMatrix4fv(this.addr,!1,e),Er(t,e)}else{if(Mr(t,n))return;iE.set(n),s.uniformMatrix4fv(this.addr,!1,iE),Er(t,n)}}function oL(s,e){const t=this.cache;t[0]!==e&&(s.uniform1i(this.addr,e),t[0]=e)}function lL(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Mr(t,e))return;s.uniform2iv(this.addr,e),Er(t,e)}}function cL(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Mr(t,e))return;s.uniform3iv(this.addr,e),Er(t,e)}}function uL(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Mr(t,e))return;s.uniform4iv(this.addr,e),Er(t,e)}}function fL(s,e){const t=this.cache;t[0]!==e&&(s.uniform1ui(this.addr,e),t[0]=e)}function hL(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Mr(t,e))return;s.uniform2uiv(this.addr,e),Er(t,e)}}function dL(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Mr(t,e))return;s.uniform3uiv(this.addr,e),Er(t,e)}}function pL(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Mr(t,e))return;s.uniform4uiv(this.addr,e),Er(t,e)}}function mL(s,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(s.uniform1i(this.addr,r),n[0]=r);let o;this.type===s.SAMPLER_2D_SHADOW?(U_.compareFunction=t.isReversedDepthBuffer()?Qx:Kx,o=U_):o=kw,t.setTexture2D(e||o,r)}function gL(s,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(s.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||Hw,r)}function vL(s,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(s.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||Gw,r)}function xL(s,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(s.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||Vw,r)}function yL(s){switch(s){case 5126:return eL;case 35664:return tL;case 35665:return nL;case 35666:return iL;case 35674:return rL;case 35675:return sL;case 35676:return aL;case 5124:case 35670:return oL;case 35667:case 35671:return lL;case 35668:case 35672:return cL;case 35669:case 35673:return uL;case 5125:return fL;case 36294:return hL;case 36295:return dL;case 36296:return pL;case 35678:case 36198:case 36298:case 36306:case 35682:return mL;case 35679:case 36299:case 36307:return gL;case 35680:case 36300:case 36308:case 36293:return vL;case 36289:case 36303:case 36311:case 36292:return xL}}function bL(s,e){s.uniform1fv(this.addr,e)}function _L(s,e){const t=Md(e,this.size,2);s.uniform2fv(this.addr,t)}function SL(s,e){const t=Md(e,this.size,3);s.uniform3fv(this.addr,t)}function ML(s,e){const t=Md(e,this.size,4);s.uniform4fv(this.addr,t)}function EL(s,e){const t=Md(e,this.size,4);s.uniformMatrix2fv(this.addr,!1,t)}function TL(s,e){const t=Md(e,this.size,9);s.uniformMatrix3fv(this.addr,!1,t)}function wL(s,e){const t=Md(e,this.size,16);s.uniformMatrix4fv(this.addr,!1,t)}function AL(s,e){s.uniform1iv(this.addr,e)}function CL(s,e){s.uniform2iv(this.addr,e)}function RL(s,e){s.uniform3iv(this.addr,e)}function NL(s,e){s.uniform4iv(this.addr,e)}function DL(s,e){s.uniform1uiv(this.addr,e)}function IL(s,e){s.uniform2uiv(this.addr,e)}function LL(s,e){s.uniform3uiv(this.addr,e)}function PL(s,e){s.uniform4uiv(this.addr,e)}function UL(s,e,t){const n=this.cache,r=e.length,o=wy(t,r);Mr(n,o)||(s.uniform1iv(this.addr,o),Er(n,o));let u;this.type===s.SAMPLER_2D_SHADOW?u=U_:u=kw;for(let h=0;h!==r;++h)t.setTexture2D(e[h]||u,o[h])}function OL(s,e,t){const n=this.cache,r=e.length,o=wy(t,r);Mr(n,o)||(s.uniform1iv(this.addr,o),Er(n,o));for(let u=0;u!==r;++u)t.setTexture3D(e[u]||Hw,o[u])}function zL(s,e,t){const n=this.cache,r=e.length,o=wy(t,r);Mr(n,o)||(s.uniform1iv(this.addr,o),Er(n,o));for(let u=0;u!==r;++u)t.setTextureCube(e[u]||Gw,o[u])}function BL(s,e,t){const n=this.cache,r=e.length,o=wy(t,r);Mr(n,o)||(s.uniform1iv(this.addr,o),Er(n,o));for(let u=0;u!==r;++u)t.setTexture2DArray(e[u]||Vw,o[u])}function FL(s){switch(s){case 5126:return bL;case 35664:return _L;case 35665:return SL;case 35666:return ML;case 35674:return EL;case 35675:return TL;case 35676:return wL;case 5124:case 35670:return AL;case 35667:case 35671:return CL;case 35668:case 35672:return RL;case 35669:case 35673:return NL;case 5125:return DL;case 36294:return IL;case 36295:return LL;case 36296:return PL;case 35678:case 36198:case 36298:case 36306:case 35682:return UL;case 35679:case 36299:case 36307:return OL;case 35680:case 36300:case 36308:case 36293:return zL;case 36289:case 36303:case 36311:case 36292:return BL}}class kL{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=yL(t.type)}}class VL{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=FL(t.type)}}class HL{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let o=0,u=r.length;o!==u;++o){const h=r[o];h.setValue(e,t[h.id],n)}}}const i_=/(\w+)(\])?(\[|\.)?/g;function aE(s,e){s.seq.push(e),s.map[e.id]=e}function GL(s,e,t){const n=s.name,r=n.length;for(i_.lastIndex=0;;){const o=i_.exec(n),u=i_.lastIndex;let h=o[1];const d=o[2]==="]",m=o[3];if(d&&(h=h|0),m===void 0||m==="["&&u+2===r){aE(t,m===void 0?new kL(h,s,e):new VL(h,s,e));break}else{let x=t.map[h];x===void 0&&(x=new HL(h),aE(t,x)),t=x}}}class Vv{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let u=0;u<n;++u){const h=e.getActiveUniform(t,u),d=e.getUniformLocation(t,h.name);GL(h,d,this)}const r=[],o=[];for(const u of this.seq)u.type===e.SAMPLER_2D_SHADOW||u.type===e.SAMPLER_CUBE_SHADOW||u.type===e.SAMPLER_2D_ARRAY_SHADOW?r.push(u):o.push(u);r.length>0&&(this.seq=r.concat(o))}setValue(e,t,n,r){const o=this.map[t];o!==void 0&&o.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let o=0,u=t.length;o!==u;++o){const h=t[o],d=n[h.id];d.needsUpdate!==!1&&h.setValue(e,d.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,o=e.length;r!==o;++r){const u=e[r];u.id in t&&n.push(u)}return n}}function oE(s,e,t){const n=s.createShader(e);return s.shaderSource(n,t),s.compileShader(n),n}const jL=37297;let WL=0;function XL(s,e){const t=s.split(`
`),n=[],r=Math.max(e-6,0),o=Math.min(e+6,t.length);for(let u=r;u<o;u++){const h=u+1;n.push(`${h===e?">":" "} ${h}: ${t[u]}`)}return n.join(`
`)}const lE=new bn;function qL(s){kn._getMatrix(lE,kn.workingColorSpace,s);const e=`mat3( ${lE.elements.map(t=>t.toFixed(4))} )`;switch(kn.getTransfer(s)){case Dm:return[e,"LinearTransferOETF"];case ti:return[e,"sRGBTransferOETF"];default:return zt("WebGLProgram: Unsupported color space: ",s),[e,"LinearTransferOETF"]}}function cE(s,e,t){const n=s.getShaderParameter(e,s.COMPILE_STATUS),o=(s.getShaderInfoLog(e)||"").trim();if(n&&o==="")return"";const u=/ERROR: 0:(\d+)/.exec(o);if(u){const h=parseInt(u[1]);return t.toUpperCase()+`

`+o+`

`+XL(s.getShaderSource(e),h)}else return o}function YL(s,e){const t=qL(e);return[`vec4 ${s}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}const ZL={[Y_]:"Linear",[Z_]:"Reinhard",[K_]:"Cineon",[Hx]:"ACESFilmic",[J_]:"AgX",[$_]:"Neutral",[Q_]:"Custom"};function KL(s,e){const t=ZL[e];return t===void 0?(zt("WebGLProgram: Unsupported toneMapping:",e),"vec3 "+s+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+s+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const Lv=new Q;function QL(){kn.getLuminanceCoefficients(Lv);const s=Lv.x.toFixed(4),e=Lv.y.toFixed(4),t=Lv.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${s}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function JL(s){return[s.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",s.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(pm).join(`
`)}function $L(s){const e=[];for(const t in s){const n=s[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function eP(s,e){const t={},n=s.getProgramParameter(e,s.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const o=s.getActiveAttrib(e,r),u=o.name;let h=1;o.type===s.FLOAT_MAT2&&(h=2),o.type===s.FLOAT_MAT3&&(h=3),o.type===s.FLOAT_MAT4&&(h=4),t[u]={type:o.type,location:s.getAttribLocation(e,u),locationSize:h}}return t}function pm(s){return s!==""}function uE(s,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return s.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function fE(s,e){return s.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const tP=/^[ \t]*#include +<([\w\d./]+)>/gm;function O_(s){return s.replace(tP,iP)}const nP=new Map;function iP(s,e){let t=An[e];if(t===void 0){const n=nP.get(e);if(n!==void 0)t=An[n],zt('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return O_(t)}const rP=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function hE(s){return s.replace(rP,sP)}function sP(s,e,t,n){let r="";for(let o=parseInt(e);o<parseInt(t);o++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return r}function dE(s){let e=`precision ${s.precision} float;
	precision ${s.precision} int;
	precision ${s.precision} sampler2D;
	precision ${s.precision} samplerCube;
	precision ${s.precision} sampler3D;
	precision ${s.precision} sampler2DArray;
	precision ${s.precision} sampler2DShadow;
	precision ${s.precision} samplerCubeShadow;
	precision ${s.precision} sampler2DArrayShadow;
	precision ${s.precision} isampler2D;
	precision ${s.precision} isampler3D;
	precision ${s.precision} isamplerCube;
	precision ${s.precision} isampler2DArray;
	precision ${s.precision} usampler2D;
	precision ${s.precision} usampler3D;
	precision ${s.precision} usamplerCube;
	precision ${s.precision} usampler2DArray;
	`;return s.precision==="highp"?e+=`
#define HIGH_PRECISION`:s.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:s.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}const aP={[id]:"SHADOWMAP_TYPE_PCF",[rf]:"SHADOWMAP_TYPE_VSM"};function oP(s){return aP[s.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}const lP={[go]:"ENVMAP_TYPE_CUBE",[qc]:"ENVMAP_TYPE_CUBE",[bd]:"ENVMAP_TYPE_CUBE_UV"};function cP(s){return s.envMap===!1?"ENVMAP_TYPE_CUBE":lP[s.envMapMode]||"ENVMAP_TYPE_CUBE"}const uP={[qc]:"ENVMAP_MODE_REFRACTION"};function fP(s){return s.envMap===!1?"ENVMAP_MODE_REFLECTION":uP[s.envMapMode]||"ENVMAP_MODE_REFLECTION"}const hP={[Wm]:"ENVMAP_BLENDING_MULTIPLY",[ET]:"ENVMAP_BLENDING_MIX",[TT]:"ENVMAP_BLENDING_ADD"};function dP(s){return s.envMap===!1?"ENVMAP_BLENDING_NONE":hP[s.combine]||"ENVMAP_BLENDING_NONE"}function pP(s){const e=s.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}function mP(s,e,t,n){const r=s.getContext(),o=t.defines;let u=t.vertexShader,h=t.fragmentShader;const d=oP(t),m=cP(t),v=fP(t),x=dP(t),y=pP(t),_=JL(t),M=$L(o),R=r.createProgram();let A,E,N=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(A=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,M].filter(pm).join(`
`),A.length>0&&(A+=`
`),E=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,M].filter(pm).join(`
`),E.length>0&&(E+=`
`)):(A=[dE(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,M,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+v:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(pm).join(`
`),E=[dE(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,M,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.envMap?"#define "+v:"",t.envMap?"#define "+x:"",y?"#define CUBEUV_TEXEL_WIDTH "+y.texelWidth:"",y?"#define CUBEUV_TEXEL_HEIGHT "+y.texelHeight:"",y?"#define CUBEUV_MAX_MIP "+y.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==ka?"#define TONE_MAPPING":"",t.toneMapping!==ka?An.tonemapping_pars_fragment:"",t.toneMapping!==ka?KL("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",An.colorspace_pars_fragment,YL("linearToOutputTexel",t.outputColorSpace),QL(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(pm).join(`
`)),u=O_(u),u=uE(u,t),u=fE(u,t),h=O_(h),h=uE(h,t),h=fE(h,t),u=hE(u),h=hE(h),t.isRawShaderMaterial!==!0&&(N=`#version 300 es
`,A=[_,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+A,E=["#define varying in",t.glslVersion===T_?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===T_?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+E);const I=N+A+u,P=N+E+h,z=oE(r,r.VERTEX_SHADER,I),U=oE(r,r.FRAGMENT_SHADER,P);r.attachShader(R,z),r.attachShader(R,U),t.index0AttributeName!==void 0?r.bindAttribLocation(R,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(R,0,"position"),r.linkProgram(R);function H(W){if(s.debug.checkShaderErrors){const ie=r.getProgramInfoLog(R)||"",J=r.getShaderInfoLog(z)||"",se=r.getShaderInfoLog(U)||"",ce=ie.trim(),Y=J.trim(),ne=se.trim();let ve=!0,ae=!0;if(r.getProgramParameter(R,r.LINK_STATUS)===!1)if(ve=!1,typeof s.debug.onShaderError=="function")s.debug.onShaderError(r,R,z,U);else{const re=cE(r,z,"vertex"),j=cE(r,U,"fragment");Qt("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(R,r.VALIDATE_STATUS)+`

Material Name: `+W.name+`
Material Type: `+W.type+`

Program Info Log: `+ce+`
`+re+`
`+j)}else ce!==""?zt("WebGLProgram: Program Info Log:",ce):(Y===""||ne==="")&&(ae=!1);ae&&(W.diagnostics={runnable:ve,programLog:ce,vertexShader:{log:Y,prefix:A},fragmentShader:{log:ne,prefix:E}})}r.deleteShader(z),r.deleteShader(U),V=new Vv(r,R),L=eP(r,R)}let V;this.getUniforms=function(){return V===void 0&&H(this),V};let L;this.getAttributes=function(){return L===void 0&&H(this),L};let B=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return B===!1&&(B=r.getProgramParameter(R,jL)),B},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(R),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=WL++,this.cacheKey=e,this.usedTimes=1,this.program=R,this.vertexShader=z,this.fragmentShader=U,this}let gP=0;class vP{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),o=this._getShaderStage(n),u=this._getShaderCacheForMaterial(e);return u.has(r)===!1&&(u.add(r),r.usedTimes++),u.has(o)===!1&&(u.add(o),o.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new xP(e),t.set(e,n)),n}}class xP{constructor(e){this.id=gP++,this.code=e,this.usedTimes=0}}function yP(s,e,t,n,r,o,u){const h=new hd,d=new vP,m=new Set,v=[],x=new Map,y=r.logarithmicDepthBuffer;let _=r.precision;const M={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function R(L){return m.add(L),L===0?"uv":`uv${L}`}function A(L,B,W,ie,J){const se=ie.fog,ce=J.geometry,Y=L.isMeshStandardMaterial?ie.environment:null,ne=(L.isMeshStandardMaterial?t:e).get(L.envMap||Y),ve=ne&&ne.mapping===bd?ne.image.height:null,ae=M[L.type];L.precision!==null&&(_=r.getMaxPrecision(L.precision),_!==L.precision&&zt("WebGLProgram.getParameters:",L.precision,"not supported, using",_,"instead."));const re=ce.morphAttributes.position||ce.morphAttributes.normal||ce.morphAttributes.color,j=re!==void 0?re.length:0;let le=0;ce.morphAttributes.position!==void 0&&(le=1),ce.morphAttributes.normal!==void 0&&(le=2),ce.morphAttributes.color!==void 0&&(le=3);let Me,Ue,lt,pe;if(ae){const dn=ho[ae];Me=dn.vertexShader,Ue=dn.fragmentShader}else Me=L.vertexShader,Ue=L.fragmentShader,d.update(L),lt=d.getVertexShaderID(L),pe=d.getFragmentShaderID(L);const Re=s.getRenderTarget(),it=s.state.buffers.depth.getReversed(),xt=J.isInstancedMesh===!0,dt=J.isBatchedMesh===!0,Ut=!!L.map,xe=!!L.matcap,rt=!!ne,Le=!!L.aoMap,Xe=!!L.lightMap,qe=!!L.bumpMap,ot=!!L.normalMap,$=!!L.displacementMap,Pt=!!L.emissiveMap,St=!!L.metalnessMap,Ft=!!L.roughnessMap,ht=L.anisotropy>0,K=L.clearcoat>0,F=L.dispersion>0,ge=L.iridescence>0,ze=L.sheen>0,Ye=L.transmission>0,Be=ht&&!!L.anisotropyMap,Dt=K&&!!L.clearcoatMap,yt=K&&!!L.clearcoatNormalMap,kt=K&&!!L.clearcoatRoughnessMap,ke=ge&&!!L.iridescenceMap,Ce=ge&&!!L.iridescenceThicknessMap,Fe=ze&&!!L.sheenColorMap,Ze=ze&&!!L.sheenRoughnessMap,ee=!!L.specularMap,Se=!!L.specularColorMap,$e=!!L.specularIntensityMap,ue=Ye&&!!L.transmissionMap,we=Ye&&!!L.thicknessMap,at=!!L.gradientMap,Ct=!!L.alphaMap,ct=L.alphaTest>0,Qe=!!L.alphaHash,gt=!!L.extensions;let qt=ka;L.toneMapped&&(Re===null||Re.isXRRenderTarget===!0)&&(qt=s.toneMapping);const un={shaderID:ae,shaderType:L.type,shaderName:L.name,vertexShader:Me,fragmentShader:Ue,defines:L.defines,customVertexShaderID:lt,customFragmentShaderID:pe,isRawShaderMaterial:L.isRawShaderMaterial===!0,glslVersion:L.glslVersion,precision:_,batching:dt,batchingColor:dt&&J._colorsTexture!==null,instancing:xt,instancingColor:xt&&J.instanceColor!==null,instancingMorph:xt&&J.morphTexture!==null,outputColorSpace:Re===null?s.outputColorSpace:Re.isXRRenderTarget===!0?Re.texture.colorSpace:vo,alphaToCoverage:!!L.alphaToCoverage,map:Ut,matcap:xe,envMap:rt,envMapMode:rt&&ne.mapping,envMapCubeUVHeight:ve,aoMap:Le,lightMap:Xe,bumpMap:qe,normalMap:ot,displacementMap:$,emissiveMap:Pt,normalMapObjectSpace:ot&&L.normalMapType===DT,normalMapTangentSpace:ot&&L.normalMapType===Kc,metalnessMap:St,roughnessMap:Ft,anisotropy:ht,anisotropyMap:Be,clearcoat:K,clearcoatMap:Dt,clearcoatNormalMap:yt,clearcoatRoughnessMap:kt,dispersion:F,iridescence:ge,iridescenceMap:ke,iridescenceThicknessMap:Ce,sheen:ze,sheenColorMap:Fe,sheenRoughnessMap:Ze,specularMap:ee,specularColorMap:Se,specularIntensityMap:$e,transmission:Ye,transmissionMap:ue,thicknessMap:we,gradientMap:at,opaque:L.transparent===!1&&L.blending===uf&&L.alphaToCoverage===!1,alphaMap:Ct,alphaTest:ct,alphaHash:Qe,combine:L.combine,mapUv:Ut&&R(L.map.channel),aoMapUv:Le&&R(L.aoMap.channel),lightMapUv:Xe&&R(L.lightMap.channel),bumpMapUv:qe&&R(L.bumpMap.channel),normalMapUv:ot&&R(L.normalMap.channel),displacementMapUv:$&&R(L.displacementMap.channel),emissiveMapUv:Pt&&R(L.emissiveMap.channel),metalnessMapUv:St&&R(L.metalnessMap.channel),roughnessMapUv:Ft&&R(L.roughnessMap.channel),anisotropyMapUv:Be&&R(L.anisotropyMap.channel),clearcoatMapUv:Dt&&R(L.clearcoatMap.channel),clearcoatNormalMapUv:yt&&R(L.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:kt&&R(L.clearcoatRoughnessMap.channel),iridescenceMapUv:ke&&R(L.iridescenceMap.channel),iridescenceThicknessMapUv:Ce&&R(L.iridescenceThicknessMap.channel),sheenColorMapUv:Fe&&R(L.sheenColorMap.channel),sheenRoughnessMapUv:Ze&&R(L.sheenRoughnessMap.channel),specularMapUv:ee&&R(L.specularMap.channel),specularColorMapUv:Se&&R(L.specularColorMap.channel),specularIntensityMapUv:$e&&R(L.specularIntensityMap.channel),transmissionMapUv:ue&&R(L.transmissionMap.channel),thicknessMapUv:we&&R(L.thicknessMap.channel),alphaMapUv:Ct&&R(L.alphaMap.channel),vertexTangents:!!ce.attributes.tangent&&(ot||ht),vertexColors:L.vertexColors,vertexAlphas:L.vertexColors===!0&&!!ce.attributes.color&&ce.attributes.color.itemSize===4,pointsUvs:J.isPoints===!0&&!!ce.attributes.uv&&(Ut||Ct),fog:!!se,useFog:L.fog===!0,fogExp2:!!se&&se.isFogExp2,flatShading:L.flatShading===!0&&L.wireframe===!1,sizeAttenuation:L.sizeAttenuation===!0,logarithmicDepthBuffer:y,reversedDepthBuffer:it,skinning:J.isSkinnedMesh===!0,morphTargets:ce.morphAttributes.position!==void 0,morphNormals:ce.morphAttributes.normal!==void 0,morphColors:ce.morphAttributes.color!==void 0,morphTargetsCount:j,morphTextureStride:le,numDirLights:B.directional.length,numPointLights:B.point.length,numSpotLights:B.spot.length,numSpotLightMaps:B.spotLightMap.length,numRectAreaLights:B.rectArea.length,numHemiLights:B.hemi.length,numDirLightShadows:B.directionalShadowMap.length,numPointLightShadows:B.pointShadowMap.length,numSpotLightShadows:B.spotShadowMap.length,numSpotLightShadowsWithMaps:B.numSpotLightShadowsWithMaps,numLightProbes:B.numLightProbes,numClippingPlanes:u.numPlanes,numClipIntersection:u.numIntersection,dithering:L.dithering,shadowMapEnabled:s.shadowMap.enabled&&W.length>0,shadowMapType:s.shadowMap.type,toneMapping:qt,decodeVideoTexture:Ut&&L.map.isVideoTexture===!0&&kn.getTransfer(L.map.colorSpace)===ti,decodeVideoTextureEmissive:Pt&&L.emissiveMap.isVideoTexture===!0&&kn.getTransfer(L.emissiveMap.colorSpace)===ti,premultipliedAlpha:L.premultipliedAlpha,doubleSided:L.side===Ii,flipSided:L.side===ss,useDepthPacking:L.depthPacking>=0,depthPacking:L.depthPacking||0,index0AttributeName:L.index0AttributeName,extensionClipCullDistance:gt&&L.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(gt&&L.extensions.multiDraw===!0||dt)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:L.customProgramCacheKey()};return un.vertexUv1s=m.has(1),un.vertexUv2s=m.has(2),un.vertexUv3s=m.has(3),m.clear(),un}function E(L){const B=[];if(L.shaderID?B.push(L.shaderID):(B.push(L.customVertexShaderID),B.push(L.customFragmentShaderID)),L.defines!==void 0)for(const W in L.defines)B.push(W),B.push(L.defines[W]);return L.isRawShaderMaterial===!1&&(N(B,L),I(B,L),B.push(s.outputColorSpace)),B.push(L.customProgramCacheKey),B.join()}function N(L,B){L.push(B.precision),L.push(B.outputColorSpace),L.push(B.envMapMode),L.push(B.envMapCubeUVHeight),L.push(B.mapUv),L.push(B.alphaMapUv),L.push(B.lightMapUv),L.push(B.aoMapUv),L.push(B.bumpMapUv),L.push(B.normalMapUv),L.push(B.displacementMapUv),L.push(B.emissiveMapUv),L.push(B.metalnessMapUv),L.push(B.roughnessMapUv),L.push(B.anisotropyMapUv),L.push(B.clearcoatMapUv),L.push(B.clearcoatNormalMapUv),L.push(B.clearcoatRoughnessMapUv),L.push(B.iridescenceMapUv),L.push(B.iridescenceThicknessMapUv),L.push(B.sheenColorMapUv),L.push(B.sheenRoughnessMapUv),L.push(B.specularMapUv),L.push(B.specularColorMapUv),L.push(B.specularIntensityMapUv),L.push(B.transmissionMapUv),L.push(B.thicknessMapUv),L.push(B.combine),L.push(B.fogExp2),L.push(B.sizeAttenuation),L.push(B.morphTargetsCount),L.push(B.morphAttributeCount),L.push(B.numDirLights),L.push(B.numPointLights),L.push(B.numSpotLights),L.push(B.numSpotLightMaps),L.push(B.numHemiLights),L.push(B.numRectAreaLights),L.push(B.numDirLightShadows),L.push(B.numPointLightShadows),L.push(B.numSpotLightShadows),L.push(B.numSpotLightShadowsWithMaps),L.push(B.numLightProbes),L.push(B.shadowMapType),L.push(B.toneMapping),L.push(B.numClippingPlanes),L.push(B.numClipIntersection),L.push(B.depthPacking)}function I(L,B){h.disableAll(),B.instancing&&h.enable(0),B.instancingColor&&h.enable(1),B.instancingMorph&&h.enable(2),B.matcap&&h.enable(3),B.envMap&&h.enable(4),B.normalMapObjectSpace&&h.enable(5),B.normalMapTangentSpace&&h.enable(6),B.clearcoat&&h.enable(7),B.iridescence&&h.enable(8),B.alphaTest&&h.enable(9),B.vertexColors&&h.enable(10),B.vertexAlphas&&h.enable(11),B.vertexUv1s&&h.enable(12),B.vertexUv2s&&h.enable(13),B.vertexUv3s&&h.enable(14),B.vertexTangents&&h.enable(15),B.anisotropy&&h.enable(16),B.alphaHash&&h.enable(17),B.batching&&h.enable(18),B.dispersion&&h.enable(19),B.batchingColor&&h.enable(20),B.gradientMap&&h.enable(21),L.push(h.mask),h.disableAll(),B.fog&&h.enable(0),B.useFog&&h.enable(1),B.flatShading&&h.enable(2),B.logarithmicDepthBuffer&&h.enable(3),B.reversedDepthBuffer&&h.enable(4),B.skinning&&h.enable(5),B.morphTargets&&h.enable(6),B.morphNormals&&h.enable(7),B.morphColors&&h.enable(8),B.premultipliedAlpha&&h.enable(9),B.shadowMapEnabled&&h.enable(10),B.doubleSided&&h.enable(11),B.flipSided&&h.enable(12),B.useDepthPacking&&h.enable(13),B.dithering&&h.enable(14),B.transmission&&h.enable(15),B.sheen&&h.enable(16),B.opaque&&h.enable(17),B.pointsUvs&&h.enable(18),B.decodeVideoTexture&&h.enable(19),B.decodeVideoTextureEmissive&&h.enable(20),B.alphaToCoverage&&h.enable(21),L.push(h.mask)}function P(L){const B=M[L.type];let W;if(B){const ie=ho[B];W=u1.clone(ie.uniforms)}else W=L.uniforms;return W}function z(L,B){let W=x.get(B);return W!==void 0?++W.usedTimes:(W=new mP(s,B,L,o),v.push(W),x.set(B,W)),W}function U(L){if(--L.usedTimes===0){const B=v.indexOf(L);v[B]=v[v.length-1],v.pop(),x.delete(L.cacheKey),L.destroy()}}function H(L){d.remove(L)}function V(){d.dispose()}return{getParameters:A,getProgramCacheKey:E,getUniforms:P,acquireProgram:z,releaseProgram:U,releaseShaderCache:H,programs:v,dispose:V}}function bP(){let s=new WeakMap;function e(u){return s.has(u)}function t(u){let h=s.get(u);return h===void 0&&(h={},s.set(u,h)),h}function n(u){s.delete(u)}function r(u,h,d){s.get(u)[h]=d}function o(){s=new WeakMap}return{has:e,get:t,remove:n,update:r,dispose:o}}function _P(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.material.id!==e.material.id?s.material.id-e.material.id:s.z!==e.z?s.z-e.z:s.id-e.id}function pE(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.z!==e.z?e.z-s.z:s.id-e.id}function mE(){const s=[];let e=0;const t=[],n=[],r=[];function o(){e=0,t.length=0,n.length=0,r.length=0}function u(x,y,_,M,R,A){let E=s[e];return E===void 0?(E={id:x.id,object:x,geometry:y,material:_,groupOrder:M,renderOrder:x.renderOrder,z:R,group:A},s[e]=E):(E.id=x.id,E.object=x,E.geometry=y,E.material=_,E.groupOrder=M,E.renderOrder=x.renderOrder,E.z=R,E.group=A),e++,E}function h(x,y,_,M,R,A){const E=u(x,y,_,M,R,A);_.transmission>0?n.push(E):_.transparent===!0?r.push(E):t.push(E)}function d(x,y,_,M,R,A){const E=u(x,y,_,M,R,A);_.transmission>0?n.unshift(E):_.transparent===!0?r.unshift(E):t.unshift(E)}function m(x,y){t.length>1&&t.sort(x||_P),n.length>1&&n.sort(y||pE),r.length>1&&r.sort(y||pE)}function v(){for(let x=e,y=s.length;x<y;x++){const _=s[x];if(_.id===null)break;_.id=null,_.object=null,_.geometry=null,_.material=null,_.group=null}}return{opaque:t,transmissive:n,transparent:r,init:o,push:h,unshift:d,finish:v,sort:m}}function SP(){let s=new WeakMap;function e(n,r){const o=s.get(n);let u;return o===void 0?(u=new mE,s.set(n,[u])):r>=o.length?(u=new mE,o.push(u)):u=o[r],u}function t(){s=new WeakMap}return{get:e,dispose:t}}function MP(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Q,color:new Lt};break;case"SpotLight":t={position:new Q,direction:new Q,color:new Lt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Q,color:new Lt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Q,skyColor:new Lt,groundColor:new Lt};break;case"RectAreaLight":t={color:new Lt,position:new Q,halfWidth:new Q,halfHeight:new Q};break}return s[e.id]=t,t}}}function EP(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Je};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Je};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Je,shadowCameraNear:1,shadowCameraFar:1e3};break}return s[e.id]=t,t}}}let TP=0;function wP(s,e){return(e.castShadow?2:0)-(s.castShadow?2:0)+(e.map?1:0)-(s.map?1:0)}function AP(s){const e=new MP,t=EP(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let m=0;m<9;m++)n.probe.push(new Q);const r=new Q,o=new cn,u=new cn;function h(m){let v=0,x=0,y=0;for(let L=0;L<9;L++)n.probe[L].set(0,0,0);let _=0,M=0,R=0,A=0,E=0,N=0,I=0,P=0,z=0,U=0,H=0;m.sort(wP);for(let L=0,B=m.length;L<B;L++){const W=m[L],ie=W.color,J=W.intensity,se=W.distance;let ce=null;if(W.shadow&&W.shadow.map&&(W.shadow.map.texture.format===pf?ce=W.shadow.map.texture:ce=W.shadow.map.depthTexture||W.shadow.map.texture),W.isAmbientLight)v+=ie.r*J,x+=ie.g*J,y+=ie.b*J;else if(W.isLightProbe){for(let Y=0;Y<9;Y++)n.probe[Y].addScaledVector(W.sh.coefficients[Y],J);H++}else if(W.isDirectionalLight){const Y=e.get(W);if(Y.color.copy(W.color).multiplyScalar(W.intensity),W.castShadow){const ne=W.shadow,ve=t.get(W);ve.shadowIntensity=ne.intensity,ve.shadowBias=ne.bias,ve.shadowNormalBias=ne.normalBias,ve.shadowRadius=ne.radius,ve.shadowMapSize=ne.mapSize,n.directionalShadow[_]=ve,n.directionalShadowMap[_]=ce,n.directionalShadowMatrix[_]=W.shadow.matrix,N++}n.directional[_]=Y,_++}else if(W.isSpotLight){const Y=e.get(W);Y.position.setFromMatrixPosition(W.matrixWorld),Y.color.copy(ie).multiplyScalar(J),Y.distance=se,Y.coneCos=Math.cos(W.angle),Y.penumbraCos=Math.cos(W.angle*(1-W.penumbra)),Y.decay=W.decay,n.spot[R]=Y;const ne=W.shadow;if(W.map&&(n.spotLightMap[z]=W.map,z++,ne.updateMatrices(W),W.castShadow&&U++),n.spotLightMatrix[R]=ne.matrix,W.castShadow){const ve=t.get(W);ve.shadowIntensity=ne.intensity,ve.shadowBias=ne.bias,ve.shadowNormalBias=ne.normalBias,ve.shadowRadius=ne.radius,ve.shadowMapSize=ne.mapSize,n.spotShadow[R]=ve,n.spotShadowMap[R]=ce,P++}R++}else if(W.isRectAreaLight){const Y=e.get(W);Y.color.copy(ie).multiplyScalar(J),Y.halfWidth.set(W.width*.5,0,0),Y.halfHeight.set(0,W.height*.5,0),n.rectArea[A]=Y,A++}else if(W.isPointLight){const Y=e.get(W);if(Y.color.copy(W.color).multiplyScalar(W.intensity),Y.distance=W.distance,Y.decay=W.decay,W.castShadow){const ne=W.shadow,ve=t.get(W);ve.shadowIntensity=ne.intensity,ve.shadowBias=ne.bias,ve.shadowNormalBias=ne.normalBias,ve.shadowRadius=ne.radius,ve.shadowMapSize=ne.mapSize,ve.shadowCameraNear=ne.camera.near,ve.shadowCameraFar=ne.camera.far,n.pointShadow[M]=ve,n.pointShadowMap[M]=ce,n.pointShadowMatrix[M]=W.shadow.matrix,I++}n.point[M]=Y,M++}else if(W.isHemisphereLight){const Y=e.get(W);Y.skyColor.copy(W.color).multiplyScalar(J),Y.groundColor.copy(W.groundColor).multiplyScalar(J),n.hemi[E]=Y,E++}}A>0&&(s.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Bt.LTC_FLOAT_1,n.rectAreaLTC2=Bt.LTC_FLOAT_2):(n.rectAreaLTC1=Bt.LTC_HALF_1,n.rectAreaLTC2=Bt.LTC_HALF_2)),n.ambient[0]=v,n.ambient[1]=x,n.ambient[2]=y;const V=n.hash;(V.directionalLength!==_||V.pointLength!==M||V.spotLength!==R||V.rectAreaLength!==A||V.hemiLength!==E||V.numDirectionalShadows!==N||V.numPointShadows!==I||V.numSpotShadows!==P||V.numSpotMaps!==z||V.numLightProbes!==H)&&(n.directional.length=_,n.spot.length=R,n.rectArea.length=A,n.point.length=M,n.hemi.length=E,n.directionalShadow.length=N,n.directionalShadowMap.length=N,n.pointShadow.length=I,n.pointShadowMap.length=I,n.spotShadow.length=P,n.spotShadowMap.length=P,n.directionalShadowMatrix.length=N,n.pointShadowMatrix.length=I,n.spotLightMatrix.length=P+z-U,n.spotLightMap.length=z,n.numSpotLightShadowsWithMaps=U,n.numLightProbes=H,V.directionalLength=_,V.pointLength=M,V.spotLength=R,V.rectAreaLength=A,V.hemiLength=E,V.numDirectionalShadows=N,V.numPointShadows=I,V.numSpotShadows=P,V.numSpotMaps=z,V.numLightProbes=H,n.version=TP++)}function d(m,v){let x=0,y=0,_=0,M=0,R=0;const A=v.matrixWorldInverse;for(let E=0,N=m.length;E<N;E++){const I=m[E];if(I.isDirectionalLight){const P=n.directional[x];P.direction.setFromMatrixPosition(I.matrixWorld),r.setFromMatrixPosition(I.target.matrixWorld),P.direction.sub(r),P.direction.transformDirection(A),x++}else if(I.isSpotLight){const P=n.spot[_];P.position.setFromMatrixPosition(I.matrixWorld),P.position.applyMatrix4(A),P.direction.setFromMatrixPosition(I.matrixWorld),r.setFromMatrixPosition(I.target.matrixWorld),P.direction.sub(r),P.direction.transformDirection(A),_++}else if(I.isRectAreaLight){const P=n.rectArea[M];P.position.setFromMatrixPosition(I.matrixWorld),P.position.applyMatrix4(A),u.identity(),o.copy(I.matrixWorld),o.premultiply(A),u.extractRotation(o),P.halfWidth.set(I.width*.5,0,0),P.halfHeight.set(0,I.height*.5,0),P.halfWidth.applyMatrix4(u),P.halfHeight.applyMatrix4(u),M++}else if(I.isPointLight){const P=n.point[y];P.position.setFromMatrixPosition(I.matrixWorld),P.position.applyMatrix4(A),y++}else if(I.isHemisphereLight){const P=n.hemi[R];P.direction.setFromMatrixPosition(I.matrixWorld),P.direction.transformDirection(A),R++}}}return{setup:h,setupView:d,state:n}}function gE(s){const e=new AP(s),t=[],n=[];function r(v){m.camera=v,t.length=0,n.length=0}function o(v){t.push(v)}function u(v){n.push(v)}function h(){e.setup(t)}function d(v){e.setupView(t,v)}const m={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:m,setupLights:h,setupLightsView:d,pushLight:o,pushShadow:u}}function CP(s){let e=new WeakMap;function t(r,o=0){const u=e.get(r);let h;return u===void 0?(h=new gE(s),e.set(r,[h])):o>=u.length?(h=new gE(s),u.push(h)):h=u[o],h}function n(){e=new WeakMap}return{get:t,dispose:n}}const RP=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,NP=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );
	gl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );
}`,DP=[new Q(1,0,0),new Q(-1,0,0),new Q(0,1,0),new Q(0,-1,0),new Q(0,0,1),new Q(0,0,-1)],IP=[new Q(0,-1,0),new Q(0,-1,0),new Q(0,0,1),new Q(0,0,-1),new Q(0,-1,0),new Q(0,-1,0)],vE=new cn,cm=new Q,r_=new Q;function LP(s,e,t){let n=new _d;const r=new Je,o=new Je,u=new hi,h=new S1,d=new M1,m={},v=t.maxTextureSize,x={[Hl]:ss,[ss]:Hl,[Ii]:Ii},y=new ls({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Je},radius:{value:4}},vertexShader:RP,fragmentShader:NP}),_=y.clone();_.defines.HORIZONTAL_PASS=1;const M=new vn;M.setAttribute("position",new li(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const R=new Gi(M,y),A=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=id;let E=this.type;this.render=function(U,H,V){if(A.enabled===!1||A.autoUpdate===!1&&A.needsUpdate===!1||U.length===0)return;U.type===mm&&(zt("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),U.type=id);const L=s.getRenderTarget(),B=s.getActiveCubeFace(),W=s.getActiveMipmapLevel(),ie=s.state;ie.setBlending(mo),ie.buffers.depth.getReversed()===!0?ie.buffers.color.setClear(0,0,0,0):ie.buffers.color.setClear(1,1,1,1),ie.buffers.depth.setTest(!0),ie.setScissorTest(!1);const J=E!==this.type;J&&H.traverse(function(se){se.material&&(Array.isArray(se.material)?se.material.forEach(ce=>ce.needsUpdate=!0):se.material.needsUpdate=!0)});for(let se=0,ce=U.length;se<ce;se++){const Y=U[se],ne=Y.shadow;if(ne===void 0){zt("WebGLShadowMap:",Y,"has no shadow.");continue}if(ne.autoUpdate===!1&&ne.needsUpdate===!1)continue;r.copy(ne.mapSize);const ve=ne.getFrameExtents();if(r.multiply(ve),o.copy(ne.mapSize),(r.x>v||r.y>v)&&(r.x>v&&(o.x=Math.floor(v/ve.x),r.x=o.x*ve.x,ne.mapSize.x=o.x),r.y>v&&(o.y=Math.floor(v/ve.y),r.y=o.y*ve.y,ne.mapSize.y=o.y)),ne.map===null||J===!0){if(ne.map!==null&&(ne.map.depthTexture!==null&&(ne.map.depthTexture.dispose(),ne.map.depthTexture=null),ne.map.dispose()),this.type===rf){if(Y.isPointLight){zt("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}ne.map=new Ts(r.x,r.y,{format:pf,type:Qi,minFilter:Gn,magFilter:Gn,generateMipmaps:!1}),ne.map.texture.name=Y.name+".shadowMap",ne.map.depthTexture=new md(r.x,r.y,Li),ne.map.depthTexture.name=Y.name+".shadowMapDepth",ne.map.depthTexture.format=$o,ne.map.depthTexture.compareFunction=null,ne.map.depthTexture.minFilter=ar,ne.map.depthTexture.magFilter=ar}else{Y.isPointLight?(ne.map=new ny(r.x),ne.map.depthTexture=new ew(r.x,ca)):(ne.map=new Ts(r.x,r.y),ne.map.depthTexture=new md(r.x,r.y,ca)),ne.map.depthTexture.name=Y.name+".shadowMap",ne.map.depthTexture.format=$o;const re=s.state.buffers.depth.getReversed();this.type===id?(ne.map.depthTexture.compareFunction=re?Qx:Kx,ne.map.depthTexture.minFilter=Gn,ne.map.depthTexture.magFilter=Gn):(ne.map.depthTexture.compareFunction=null,ne.map.depthTexture.minFilter=ar,ne.map.depthTexture.magFilter=ar)}ne.camera.updateProjectionMatrix()}const ae=ne.map.isWebGLCubeRenderTarget?6:1;for(let re=0;re<ae;re++){if(ne.map.isWebGLCubeRenderTarget)s.setRenderTarget(ne.map,re),s.clear();else{re===0&&(s.setRenderTarget(ne.map),s.clear());const j=ne.getViewport(re);u.set(o.x*j.x,o.y*j.y,o.x*j.z,o.y*j.w),ie.viewport(u)}if(Y.isPointLight){const j=ne.camera,le=ne.matrix,Me=Y.distance||j.far;Me!==j.far&&(j.far=Me,j.updateProjectionMatrix()),cm.setFromMatrixPosition(Y.matrixWorld),j.position.copy(cm),r_.copy(j.position),r_.add(DP[re]),j.up.copy(IP[re]),j.lookAt(r_),j.updateMatrixWorld(),le.makeTranslation(-cm.x,-cm.y,-cm.z),vE.multiplyMatrices(j.projectionMatrix,j.matrixWorldInverse),ne._frustum.setFromProjectionMatrix(vE,j.coordinateSystem,j.reversedDepth)}else ne.updateMatrices(Y);n=ne.getFrustum(),P(H,V,ne.camera,Y,this.type)}ne.isPointLightShadow!==!0&&this.type===rf&&N(ne,V),ne.needsUpdate=!1}E=this.type,A.needsUpdate=!1,s.setRenderTarget(L,B,W)};function N(U,H){const V=e.update(R);y.defines.VSM_SAMPLES!==U.blurSamples&&(y.defines.VSM_SAMPLES=U.blurSamples,_.defines.VSM_SAMPLES=U.blurSamples,y.needsUpdate=!0,_.needsUpdate=!0),U.mapPass===null&&(U.mapPass=new Ts(r.x,r.y,{format:pf,type:Qi})),y.uniforms.shadow_pass.value=U.map.depthTexture,y.uniforms.resolution.value=U.mapSize,y.uniforms.radius.value=U.radius,s.setRenderTarget(U.mapPass),s.clear(),s.renderBufferDirect(H,null,V,y,R,null),_.uniforms.shadow_pass.value=U.mapPass.texture,_.uniforms.resolution.value=U.mapSize,_.uniforms.radius.value=U.radius,s.setRenderTarget(U.map),s.clear(),s.renderBufferDirect(H,null,V,_,R,null)}function I(U,H,V,L){let B=null;const W=V.isPointLight===!0?U.customDistanceMaterial:U.customDepthMaterial;if(W!==void 0)B=W;else if(B=V.isPointLight===!0?d:h,s.localClippingEnabled&&H.clipShadows===!0&&Array.isArray(H.clippingPlanes)&&H.clippingPlanes.length!==0||H.displacementMap&&H.displacementScale!==0||H.alphaMap&&H.alphaTest>0||H.map&&H.alphaTest>0||H.alphaToCoverage===!0){const ie=B.uuid,J=H.uuid;let se=m[ie];se===void 0&&(se={},m[ie]=se);let ce=se[J];ce===void 0&&(ce=B.clone(),se[J]=ce,H.addEventListener("dispose",z)),B=ce}if(B.visible=H.visible,B.wireframe=H.wireframe,L===rf?B.side=H.shadowSide!==null?H.shadowSide:H.side:B.side=H.shadowSide!==null?H.shadowSide:x[H.side],B.alphaMap=H.alphaMap,B.alphaTest=H.alphaToCoverage===!0?.5:H.alphaTest,B.map=H.map,B.clipShadows=H.clipShadows,B.clippingPlanes=H.clippingPlanes,B.clipIntersection=H.clipIntersection,B.displacementMap=H.displacementMap,B.displacementScale=H.displacementScale,B.displacementBias=H.displacementBias,B.wireframeLinewidth=H.wireframeLinewidth,B.linewidth=H.linewidth,V.isPointLight===!0&&B.isMeshDistanceMaterial===!0){const ie=s.properties.get(B);ie.light=V}return B}function P(U,H,V,L,B){if(U.visible===!1)return;if(U.layers.test(H.layers)&&(U.isMesh||U.isLine||U.isPoints)&&(U.castShadow||U.receiveShadow&&B===rf)&&(!U.frustumCulled||n.intersectsObject(U))){U.modelViewMatrix.multiplyMatrices(V.matrixWorldInverse,U.matrixWorld);const J=e.update(U),se=U.material;if(Array.isArray(se)){const ce=J.groups;for(let Y=0,ne=ce.length;Y<ne;Y++){const ve=ce[Y],ae=se[ve.materialIndex];if(ae&&ae.visible){const re=I(U,ae,L,B);U.onBeforeShadow(s,U,H,V,J,re,ve),s.renderBufferDirect(V,null,J,re,U,ve),U.onAfterShadow(s,U,H,V,J,re,ve)}}}else if(se.visible){const ce=I(U,se,L,B);U.onBeforeShadow(s,U,H,V,J,ce,null),s.renderBufferDirect(V,null,J,ce,U,null),U.onAfterShadow(s,U,H,V,J,ce,null)}}const ie=U.children;for(let J=0,se=ie.length;J<se;J++)P(ie[J],H,V,L,B)}function z(U){U.target.removeEventListener("dispose",z);for(const V in m){const L=m[V],B=U.target.uuid;B in L&&(L[B].dispose(),delete L[B])}}}const PP={[Wv]:Xv,[qv]:Kv,[Yv]:Qv,[df]:Zv,[Xv]:Wv,[Kv]:qv,[Qv]:Yv,[Zv]:df};function UP(s,e){function t(){let ue=!1;const we=new hi;let at=null;const Ct=new hi(0,0,0,0);return{setMask:function(ct){at!==ct&&!ue&&(s.colorMask(ct,ct,ct,ct),at=ct)},setLocked:function(ct){ue=ct},setClear:function(ct,Qe,gt,qt,un){un===!0&&(ct*=qt,Qe*=qt,gt*=qt),we.set(ct,Qe,gt,qt),Ct.equals(we)===!1&&(s.clearColor(ct,Qe,gt,qt),Ct.copy(we))},reset:function(){ue=!1,at=null,Ct.set(-1,0,0,0)}}}function n(){let ue=!1,we=!1,at=null,Ct=null,ct=null;return{setReversed:function(Qe){if(we!==Qe){const gt=e.get("EXT_clip_control");Qe?gt.clipControlEXT(gt.LOWER_LEFT_EXT,gt.ZERO_TO_ONE_EXT):gt.clipControlEXT(gt.LOWER_LEFT_EXT,gt.NEGATIVE_ONE_TO_ONE_EXT),we=Qe;const qt=ct;ct=null,this.setClear(qt)}},getReversed:function(){return we},setTest:function(Qe){Qe?Re(s.DEPTH_TEST):it(s.DEPTH_TEST)},setMask:function(Qe){at!==Qe&&!ue&&(s.depthMask(Qe),at=Qe)},setFunc:function(Qe){if(we&&(Qe=PP[Qe]),Ct!==Qe){switch(Qe){case Wv:s.depthFunc(s.NEVER);break;case Xv:s.depthFunc(s.ALWAYS);break;case qv:s.depthFunc(s.LESS);break;case df:s.depthFunc(s.LEQUAL);break;case Yv:s.depthFunc(s.EQUAL);break;case Zv:s.depthFunc(s.GEQUAL);break;case Kv:s.depthFunc(s.GREATER);break;case Qv:s.depthFunc(s.NOTEQUAL);break;default:s.depthFunc(s.LEQUAL)}Ct=Qe}},setLocked:function(Qe){ue=Qe},setClear:function(Qe){ct!==Qe&&(we&&(Qe=1-Qe),s.clearDepth(Qe),ct=Qe)},reset:function(){ue=!1,at=null,Ct=null,ct=null,we=!1}}}function r(){let ue=!1,we=null,at=null,Ct=null,ct=null,Qe=null,gt=null,qt=null,un=null;return{setTest:function(dn){ue||(dn?Re(s.STENCIL_TEST):it(s.STENCIL_TEST))},setMask:function(dn){we!==dn&&!ue&&(s.stencilMask(dn),we=dn)},setFunc:function(dn,ci,Pi){(at!==dn||Ct!==ci||ct!==Pi)&&(s.stencilFunc(dn,ci,Pi),at=dn,Ct=ci,ct=Pi)},setOp:function(dn,ci,Pi){(Qe!==dn||gt!==ci||qt!==Pi)&&(s.stencilOp(dn,ci,Pi),Qe=dn,gt=ci,qt=Pi)},setLocked:function(dn){ue=dn},setClear:function(dn){un!==dn&&(s.clearStencil(dn),un=dn)},reset:function(){ue=!1,we=null,at=null,Ct=null,ct=null,Qe=null,gt=null,qt=null,un=null}}}const o=new t,u=new n,h=new r,d=new WeakMap,m=new WeakMap;let v={},x={},y=new WeakMap,_=[],M=null,R=!1,A=null,E=null,N=null,I=null,P=null,z=null,U=null,H=new Lt(0,0,0),V=0,L=!1,B=null,W=null,ie=null,J=null,se=null;const ce=s.getParameter(s.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Y=!1,ne=0;const ve=s.getParameter(s.VERSION);ve.indexOf("WebGL")!==-1?(ne=parseFloat(/^WebGL (\d)/.exec(ve)[1]),Y=ne>=1):ve.indexOf("OpenGL ES")!==-1&&(ne=parseFloat(/^OpenGL ES (\d)/.exec(ve)[1]),Y=ne>=2);let ae=null,re={};const j=s.getParameter(s.SCISSOR_BOX),le=s.getParameter(s.VIEWPORT),Me=new hi().fromArray(j),Ue=new hi().fromArray(le);function lt(ue,we,at,Ct){const ct=new Uint8Array(4),Qe=s.createTexture();s.bindTexture(ue,Qe),s.texParameteri(ue,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(ue,s.TEXTURE_MAG_FILTER,s.NEAREST);for(let gt=0;gt<at;gt++)ue===s.TEXTURE_3D||ue===s.TEXTURE_2D_ARRAY?s.texImage3D(we,0,s.RGBA,1,1,Ct,0,s.RGBA,s.UNSIGNED_BYTE,ct):s.texImage2D(we+gt,0,s.RGBA,1,1,0,s.RGBA,s.UNSIGNED_BYTE,ct);return Qe}const pe={};pe[s.TEXTURE_2D]=lt(s.TEXTURE_2D,s.TEXTURE_2D,1),pe[s.TEXTURE_CUBE_MAP]=lt(s.TEXTURE_CUBE_MAP,s.TEXTURE_CUBE_MAP_POSITIVE_X,6),pe[s.TEXTURE_2D_ARRAY]=lt(s.TEXTURE_2D_ARRAY,s.TEXTURE_2D_ARRAY,1,1),pe[s.TEXTURE_3D]=lt(s.TEXTURE_3D,s.TEXTURE_3D,1,1),o.setClear(0,0,0,1),u.setClear(1),h.setClear(0),Re(s.DEPTH_TEST),u.setFunc(df),qe(!1),ot(x_),Re(s.CULL_FACE),Le(mo);function Re(ue){v[ue]!==!0&&(s.enable(ue),v[ue]=!0)}function it(ue){v[ue]!==!1&&(s.disable(ue),v[ue]=!1)}function xt(ue,we){return x[ue]!==we?(s.bindFramebuffer(ue,we),x[ue]=we,ue===s.DRAW_FRAMEBUFFER&&(x[s.FRAMEBUFFER]=we),ue===s.FRAMEBUFFER&&(x[s.DRAW_FRAMEBUFFER]=we),!0):!1}function dt(ue,we){let at=_,Ct=!1;if(ue){at=y.get(we),at===void 0&&(at=[],y.set(we,at));const ct=ue.textures;if(at.length!==ct.length||at[0]!==s.COLOR_ATTACHMENT0){for(let Qe=0,gt=ct.length;Qe<gt;Qe++)at[Qe]=s.COLOR_ATTACHMENT0+Qe;at.length=ct.length,Ct=!0}}else at[0]!==s.BACK&&(at[0]=s.BACK,Ct=!0);Ct&&s.drawBuffers(at)}function Ut(ue){return M!==ue?(s.useProgram(ue),M=ue,!0):!1}const xe={[Vc]:s.FUNC_ADD,[oT]:s.FUNC_SUBTRACT,[lT]:s.FUNC_REVERSE_SUBTRACT};xe[cT]=s.MIN,xe[uT]=s.MAX;const rt={[fT]:s.ZERO,[hT]:s.ONE,[dT]:s.SRC_COLOR,[Gv]:s.SRC_ALPHA,[yT]:s.SRC_ALPHA_SATURATE,[vT]:s.DST_COLOR,[mT]:s.DST_ALPHA,[pT]:s.ONE_MINUS_SRC_COLOR,[jv]:s.ONE_MINUS_SRC_ALPHA,[xT]:s.ONE_MINUS_DST_COLOR,[gT]:s.ONE_MINUS_DST_ALPHA,[bT]:s.CONSTANT_COLOR,[_T]:s.ONE_MINUS_CONSTANT_COLOR,[ST]:s.CONSTANT_ALPHA,[MT]:s.ONE_MINUS_CONSTANT_ALPHA};function Le(ue,we,at,Ct,ct,Qe,gt,qt,un,dn){if(ue===mo){R===!0&&(it(s.BLEND),R=!1);return}if(R===!1&&(Re(s.BLEND),R=!0),ue!==aT){if(ue!==A||dn!==L){if((E!==Vc||P!==Vc)&&(s.blendEquation(s.FUNC_ADD),E=Vc,P=Vc),dn)switch(ue){case uf:s.blendFuncSeparate(s.ONE,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case y_:s.blendFunc(s.ONE,s.ONE);break;case b_:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case __:s.blendFuncSeparate(s.DST_COLOR,s.ONE_MINUS_SRC_ALPHA,s.ZERO,s.ONE);break;default:Qt("WebGLState: Invalid blending: ",ue);break}else switch(ue){case uf:s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case y_:s.blendFuncSeparate(s.SRC_ALPHA,s.ONE,s.ONE,s.ONE);break;case b_:Qt("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case __:Qt("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:Qt("WebGLState: Invalid blending: ",ue);break}N=null,I=null,z=null,U=null,H.set(0,0,0),V=0,A=ue,L=dn}return}ct=ct||we,Qe=Qe||at,gt=gt||Ct,(we!==E||ct!==P)&&(s.blendEquationSeparate(xe[we],xe[ct]),E=we,P=ct),(at!==N||Ct!==I||Qe!==z||gt!==U)&&(s.blendFuncSeparate(rt[at],rt[Ct],rt[Qe],rt[gt]),N=at,I=Ct,z=Qe,U=gt),(qt.equals(H)===!1||un!==V)&&(s.blendColor(qt.r,qt.g,qt.b,un),H.copy(qt),V=un),A=ue,L=!1}function Xe(ue,we){ue.side===Ii?it(s.CULL_FACE):Re(s.CULL_FACE);let at=ue.side===ss;we&&(at=!at),qe(at),ue.blending===uf&&ue.transparent===!1?Le(mo):Le(ue.blending,ue.blendEquation,ue.blendSrc,ue.blendDst,ue.blendEquationAlpha,ue.blendSrcAlpha,ue.blendDstAlpha,ue.blendColor,ue.blendAlpha,ue.premultipliedAlpha),u.setFunc(ue.depthFunc),u.setTest(ue.depthTest),u.setMask(ue.depthWrite),o.setMask(ue.colorWrite);const Ct=ue.stencilWrite;h.setTest(Ct),Ct&&(h.setMask(ue.stencilWriteMask),h.setFunc(ue.stencilFunc,ue.stencilRef,ue.stencilFuncMask),h.setOp(ue.stencilFail,ue.stencilZFail,ue.stencilZPass)),Pt(ue.polygonOffset,ue.polygonOffsetFactor,ue.polygonOffsetUnits),ue.alphaToCoverage===!0?Re(s.SAMPLE_ALPHA_TO_COVERAGE):it(s.SAMPLE_ALPHA_TO_COVERAGE)}function qe(ue){B!==ue&&(ue?s.frontFace(s.CW):s.frontFace(s.CCW),B=ue)}function ot(ue){ue!==iT?(Re(s.CULL_FACE),ue!==W&&(ue===x_?s.cullFace(s.BACK):ue===rT?s.cullFace(s.FRONT):s.cullFace(s.FRONT_AND_BACK))):it(s.CULL_FACE),W=ue}function $(ue){ue!==ie&&(Y&&s.lineWidth(ue),ie=ue)}function Pt(ue,we,at){ue?(Re(s.POLYGON_OFFSET_FILL),(J!==we||se!==at)&&(s.polygonOffset(we,at),J=we,se=at)):it(s.POLYGON_OFFSET_FILL)}function St(ue){ue?Re(s.SCISSOR_TEST):it(s.SCISSOR_TEST)}function Ft(ue){ue===void 0&&(ue=s.TEXTURE0+ce-1),ae!==ue&&(s.activeTexture(ue),ae=ue)}function ht(ue,we,at){at===void 0&&(ae===null?at=s.TEXTURE0+ce-1:at=ae);let Ct=re[at];Ct===void 0&&(Ct={type:void 0,texture:void 0},re[at]=Ct),(Ct.type!==ue||Ct.texture!==we)&&(ae!==at&&(s.activeTexture(at),ae=at),s.bindTexture(ue,we||pe[ue]),Ct.type=ue,Ct.texture=we)}function K(){const ue=re[ae];ue!==void 0&&ue.type!==void 0&&(s.bindTexture(ue.type,null),ue.type=void 0,ue.texture=void 0)}function F(){try{s.compressedTexImage2D(...arguments)}catch(ue){Qt("WebGLState:",ue)}}function ge(){try{s.compressedTexImage3D(...arguments)}catch(ue){Qt("WebGLState:",ue)}}function ze(){try{s.texSubImage2D(...arguments)}catch(ue){Qt("WebGLState:",ue)}}function Ye(){try{s.texSubImage3D(...arguments)}catch(ue){Qt("WebGLState:",ue)}}function Be(){try{s.compressedTexSubImage2D(...arguments)}catch(ue){Qt("WebGLState:",ue)}}function Dt(){try{s.compressedTexSubImage3D(...arguments)}catch(ue){Qt("WebGLState:",ue)}}function yt(){try{s.texStorage2D(...arguments)}catch(ue){Qt("WebGLState:",ue)}}function kt(){try{s.texStorage3D(...arguments)}catch(ue){Qt("WebGLState:",ue)}}function ke(){try{s.texImage2D(...arguments)}catch(ue){Qt("WebGLState:",ue)}}function Ce(){try{s.texImage3D(...arguments)}catch(ue){Qt("WebGLState:",ue)}}function Fe(ue){Me.equals(ue)===!1&&(s.scissor(ue.x,ue.y,ue.z,ue.w),Me.copy(ue))}function Ze(ue){Ue.equals(ue)===!1&&(s.viewport(ue.x,ue.y,ue.z,ue.w),Ue.copy(ue))}function ee(ue,we){let at=m.get(we);at===void 0&&(at=new WeakMap,m.set(we,at));let Ct=at.get(ue);Ct===void 0&&(Ct=s.getUniformBlockIndex(we,ue.name),at.set(ue,Ct))}function Se(ue,we){const Ct=m.get(we).get(ue);d.get(we)!==Ct&&(s.uniformBlockBinding(we,Ct,ue.__bindingPointIndex),d.set(we,Ct))}function $e(){s.disable(s.BLEND),s.disable(s.CULL_FACE),s.disable(s.DEPTH_TEST),s.disable(s.POLYGON_OFFSET_FILL),s.disable(s.SCISSOR_TEST),s.disable(s.STENCIL_TEST),s.disable(s.SAMPLE_ALPHA_TO_COVERAGE),s.blendEquation(s.FUNC_ADD),s.blendFunc(s.ONE,s.ZERO),s.blendFuncSeparate(s.ONE,s.ZERO,s.ONE,s.ZERO),s.blendColor(0,0,0,0),s.colorMask(!0,!0,!0,!0),s.clearColor(0,0,0,0),s.depthMask(!0),s.depthFunc(s.LESS),u.setReversed(!1),s.clearDepth(1),s.stencilMask(4294967295),s.stencilFunc(s.ALWAYS,0,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.KEEP),s.clearStencil(0),s.cullFace(s.BACK),s.frontFace(s.CCW),s.polygonOffset(0,0),s.activeTexture(s.TEXTURE0),s.bindFramebuffer(s.FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.useProgram(null),s.lineWidth(1),s.scissor(0,0,s.canvas.width,s.canvas.height),s.viewport(0,0,s.canvas.width,s.canvas.height),v={},ae=null,re={},x={},y=new WeakMap,_=[],M=null,R=!1,A=null,E=null,N=null,I=null,P=null,z=null,U=null,H=new Lt(0,0,0),V=0,L=!1,B=null,W=null,ie=null,J=null,se=null,Me.set(0,0,s.canvas.width,s.canvas.height),Ue.set(0,0,s.canvas.width,s.canvas.height),o.reset(),u.reset(),h.reset()}return{buffers:{color:o,depth:u,stencil:h},enable:Re,disable:it,bindFramebuffer:xt,drawBuffers:dt,useProgram:Ut,setBlending:Le,setMaterial:Xe,setFlipSided:qe,setCullFace:ot,setLineWidth:$,setPolygonOffset:Pt,setScissorTest:St,activeTexture:Ft,bindTexture:ht,unbindTexture:K,compressedTexImage2D:F,compressedTexImage3D:ge,texImage2D:ke,texImage3D:Ce,updateUBOMapping:ee,uniformBlockBinding:Se,texStorage2D:yt,texStorage3D:kt,texSubImage2D:ze,texSubImage3D:Ye,compressedTexSubImage2D:Be,compressedTexSubImage3D:Dt,scissor:Fe,viewport:Ze,reset:$e}}function OP(s,e,t,n,r,o,u){const h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,d=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),m=new Je,v=new WeakMap;let x;const y=new WeakMap;let _=!1;try{_=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function M(K,F){return _?new OffscreenCanvas(K,F):Lm("canvas")}function R(K,F,ge){let ze=1;const Ye=ht(K);if((Ye.width>ge||Ye.height>ge)&&(ze=ge/Math.max(Ye.width,Ye.height)),ze<1)if(typeof HTMLImageElement<"u"&&K instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&K instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&K instanceof ImageBitmap||typeof VideoFrame<"u"&&K instanceof VideoFrame){const Be=Math.floor(ze*Ye.width),Dt=Math.floor(ze*Ye.height);x===void 0&&(x=M(Be,Dt));const yt=F?M(Be,Dt):x;return yt.width=Be,yt.height=Dt,yt.getContext("2d").drawImage(K,0,0,Be,Dt),zt("WebGLRenderer: Texture has been resized from ("+Ye.width+"x"+Ye.height+") to ("+Be+"x"+Dt+")."),yt}else return"data"in K&&zt("WebGLRenderer: Image in DataTexture is too big ("+Ye.width+"x"+Ye.height+")."),K;return K}function A(K){return K.generateMipmaps}function E(K){s.generateMipmap(K)}function N(K){return K.isWebGLCubeRenderTarget?s.TEXTURE_CUBE_MAP:K.isWebGL3DRenderTarget?s.TEXTURE_3D:K.isWebGLArrayRenderTarget||K.isCompressedArrayTexture?s.TEXTURE_2D_ARRAY:s.TEXTURE_2D}function I(K,F,ge,ze,Ye=!1){if(K!==null){if(s[K]!==void 0)return s[K];zt("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+K+"'")}let Be=F;if(F===s.RED&&(ge===s.FLOAT&&(Be=s.R32F),ge===s.HALF_FLOAT&&(Be=s.R16F),ge===s.UNSIGNED_BYTE&&(Be=s.R8)),F===s.RED_INTEGER&&(ge===s.UNSIGNED_BYTE&&(Be=s.R8UI),ge===s.UNSIGNED_SHORT&&(Be=s.R16UI),ge===s.UNSIGNED_INT&&(Be=s.R32UI),ge===s.BYTE&&(Be=s.R8I),ge===s.SHORT&&(Be=s.R16I),ge===s.INT&&(Be=s.R32I)),F===s.RG&&(ge===s.FLOAT&&(Be=s.RG32F),ge===s.HALF_FLOAT&&(Be=s.RG16F),ge===s.UNSIGNED_BYTE&&(Be=s.RG8)),F===s.RG_INTEGER&&(ge===s.UNSIGNED_BYTE&&(Be=s.RG8UI),ge===s.UNSIGNED_SHORT&&(Be=s.RG16UI),ge===s.UNSIGNED_INT&&(Be=s.RG32UI),ge===s.BYTE&&(Be=s.RG8I),ge===s.SHORT&&(Be=s.RG16I),ge===s.INT&&(Be=s.RG32I)),F===s.RGB_INTEGER&&(ge===s.UNSIGNED_BYTE&&(Be=s.RGB8UI),ge===s.UNSIGNED_SHORT&&(Be=s.RGB16UI),ge===s.UNSIGNED_INT&&(Be=s.RGB32UI),ge===s.BYTE&&(Be=s.RGB8I),ge===s.SHORT&&(Be=s.RGB16I),ge===s.INT&&(Be=s.RGB32I)),F===s.RGBA_INTEGER&&(ge===s.UNSIGNED_BYTE&&(Be=s.RGBA8UI),ge===s.UNSIGNED_SHORT&&(Be=s.RGBA16UI),ge===s.UNSIGNED_INT&&(Be=s.RGBA32UI),ge===s.BYTE&&(Be=s.RGBA8I),ge===s.SHORT&&(Be=s.RGBA16I),ge===s.INT&&(Be=s.RGBA32I)),F===s.RGB&&(ge===s.UNSIGNED_INT_5_9_9_9_REV&&(Be=s.RGB9_E5),ge===s.UNSIGNED_INT_10F_11F_11F_REV&&(Be=s.R11F_G11F_B10F)),F===s.RGBA){const Dt=Ye?Dm:kn.getTransfer(ze);ge===s.FLOAT&&(Be=s.RGBA32F),ge===s.HALF_FLOAT&&(Be=s.RGBA16F),ge===s.UNSIGNED_BYTE&&(Be=Dt===ti?s.SRGB8_ALPHA8:s.RGBA8),ge===s.UNSIGNED_SHORT_4_4_4_4&&(Be=s.RGBA4),ge===s.UNSIGNED_SHORT_5_5_5_1&&(Be=s.RGB5_A1)}return(Be===s.R16F||Be===s.R32F||Be===s.RG16F||Be===s.RG32F||Be===s.RGBA16F||Be===s.RGBA32F)&&e.get("EXT_color_buffer_float"),Be}function P(K,F){let ge;return K?F===null||F===ca||F===ld?ge=s.DEPTH24_STENCIL8:F===Li?ge=s.DEPTH32F_STENCIL8:F===od&&(ge=s.DEPTH24_STENCIL8,zt("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):F===null||F===ca||F===ld?ge=s.DEPTH_COMPONENT24:F===Li?ge=s.DEPTH_COMPONENT32F:F===od&&(ge=s.DEPTH_COMPONENT16),ge}function z(K,F){return A(K)===!0||K.isFramebufferTexture&&K.minFilter!==ar&&K.minFilter!==Gn?Math.log2(Math.max(F.width,F.height))+1:K.mipmaps!==void 0&&K.mipmaps.length>0?K.mipmaps.length:K.isCompressedTexture&&Array.isArray(K.image)?F.mipmaps.length:1}function U(K){const F=K.target;F.removeEventListener("dispose",U),V(F),F.isVideoTexture&&v.delete(F)}function H(K){const F=K.target;F.removeEventListener("dispose",H),B(F)}function V(K){const F=n.get(K);if(F.__webglInit===void 0)return;const ge=K.source,ze=y.get(ge);if(ze){const Ye=ze[F.__cacheKey];Ye.usedTimes--,Ye.usedTimes===0&&L(K),Object.keys(ze).length===0&&y.delete(ge)}n.remove(K)}function L(K){const F=n.get(K);s.deleteTexture(F.__webglTexture);const ge=K.source,ze=y.get(ge);delete ze[F.__cacheKey],u.memory.textures--}function B(K){const F=n.get(K);if(K.depthTexture&&(K.depthTexture.dispose(),n.remove(K.depthTexture)),K.isWebGLCubeRenderTarget)for(let ze=0;ze<6;ze++){if(Array.isArray(F.__webglFramebuffer[ze]))for(let Ye=0;Ye<F.__webglFramebuffer[ze].length;Ye++)s.deleteFramebuffer(F.__webglFramebuffer[ze][Ye]);else s.deleteFramebuffer(F.__webglFramebuffer[ze]);F.__webglDepthbuffer&&s.deleteRenderbuffer(F.__webglDepthbuffer[ze])}else{if(Array.isArray(F.__webglFramebuffer))for(let ze=0;ze<F.__webglFramebuffer.length;ze++)s.deleteFramebuffer(F.__webglFramebuffer[ze]);else s.deleteFramebuffer(F.__webglFramebuffer);if(F.__webglDepthbuffer&&s.deleteRenderbuffer(F.__webglDepthbuffer),F.__webglMultisampledFramebuffer&&s.deleteFramebuffer(F.__webglMultisampledFramebuffer),F.__webglColorRenderbuffer)for(let ze=0;ze<F.__webglColorRenderbuffer.length;ze++)F.__webglColorRenderbuffer[ze]&&s.deleteRenderbuffer(F.__webglColorRenderbuffer[ze]);F.__webglDepthRenderbuffer&&s.deleteRenderbuffer(F.__webglDepthRenderbuffer)}const ge=K.textures;for(let ze=0,Ye=ge.length;ze<Ye;ze++){const Be=n.get(ge[ze]);Be.__webglTexture&&(s.deleteTexture(Be.__webglTexture),u.memory.textures--),n.remove(ge[ze])}n.remove(K)}let W=0;function ie(){W=0}function J(){const K=W;return K>=r.maxTextures&&zt("WebGLTextures: Trying to use "+K+" texture units while this GPU supports only "+r.maxTextures),W+=1,K}function se(K){const F=[];return F.push(K.wrapS),F.push(K.wrapT),F.push(K.wrapR||0),F.push(K.magFilter),F.push(K.minFilter),F.push(K.anisotropy),F.push(K.internalFormat),F.push(K.format),F.push(K.type),F.push(K.generateMipmaps),F.push(K.premultiplyAlpha),F.push(K.flipY),F.push(K.unpackAlignment),F.push(K.colorSpace),F.join()}function ce(K,F){const ge=n.get(K);if(K.isVideoTexture&&St(K),K.isRenderTargetTexture===!1&&K.isExternalTexture!==!0&&K.version>0&&ge.__version!==K.version){const ze=K.image;if(ze===null)zt("WebGLRenderer: Texture marked for update but no image data found.");else if(ze.complete===!1)zt("WebGLRenderer: Texture marked for update but image is incomplete");else{pe(ge,K,F);return}}else K.isExternalTexture&&(ge.__webglTexture=K.sourceTexture?K.sourceTexture:null);t.bindTexture(s.TEXTURE_2D,ge.__webglTexture,s.TEXTURE0+F)}function Y(K,F){const ge=n.get(K);if(K.isRenderTargetTexture===!1&&K.version>0&&ge.__version!==K.version){pe(ge,K,F);return}else K.isExternalTexture&&(ge.__webglTexture=K.sourceTexture?K.sourceTexture:null);t.bindTexture(s.TEXTURE_2D_ARRAY,ge.__webglTexture,s.TEXTURE0+F)}function ne(K,F){const ge=n.get(K);if(K.isRenderTargetTexture===!1&&K.version>0&&ge.__version!==K.version){pe(ge,K,F);return}t.bindTexture(s.TEXTURE_3D,ge.__webglTexture,s.TEXTURE0+F)}function ve(K,F){const ge=n.get(K);if(K.isCubeDepthTexture!==!0&&K.version>0&&ge.__version!==K.version){Re(ge,K,F);return}t.bindTexture(s.TEXTURE_CUBE_MAP,ge.__webglTexture,s.TEXTURE0+F)}const ae={[Am]:s.REPEAT,[Ki]:s.CLAMP_TO_EDGE,[Cm]:s.MIRRORED_REPEAT},re={[ar]:s.NEAREST,[e1]:s.NEAREST_MIPMAP_NEAREST,[ed]:s.NEAREST_MIPMAP_LINEAR,[Gn]:s.LINEAR,[gm]:s.LINEAR_MIPMAP_NEAREST,[Qo]:s.LINEAR_MIPMAP_LINEAR},j={[IT]:s.NEVER,[zT]:s.ALWAYS,[LT]:s.LESS,[Kx]:s.LEQUAL,[PT]:s.EQUAL,[Qx]:s.GEQUAL,[UT]:s.GREATER,[OT]:s.NOTEQUAL};function le(K,F){if(F.type===Li&&e.has("OES_texture_float_linear")===!1&&(F.magFilter===Gn||F.magFilter===gm||F.magFilter===ed||F.magFilter===Qo||F.minFilter===Gn||F.minFilter===gm||F.minFilter===ed||F.minFilter===Qo)&&zt("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),s.texParameteri(K,s.TEXTURE_WRAP_S,ae[F.wrapS]),s.texParameteri(K,s.TEXTURE_WRAP_T,ae[F.wrapT]),(K===s.TEXTURE_3D||K===s.TEXTURE_2D_ARRAY)&&s.texParameteri(K,s.TEXTURE_WRAP_R,ae[F.wrapR]),s.texParameteri(K,s.TEXTURE_MAG_FILTER,re[F.magFilter]),s.texParameteri(K,s.TEXTURE_MIN_FILTER,re[F.minFilter]),F.compareFunction&&(s.texParameteri(K,s.TEXTURE_COMPARE_MODE,s.COMPARE_REF_TO_TEXTURE),s.texParameteri(K,s.TEXTURE_COMPARE_FUNC,j[F.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(F.magFilter===ar||F.minFilter!==ed&&F.minFilter!==Qo||F.type===Li&&e.has("OES_texture_float_linear")===!1)return;if(F.anisotropy>1||n.get(F).__currentAnisotropy){const ge=e.get("EXT_texture_filter_anisotropic");s.texParameterf(K,ge.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(F.anisotropy,r.getMaxAnisotropy())),n.get(F).__currentAnisotropy=F.anisotropy}}}function Me(K,F){let ge=!1;K.__webglInit===void 0&&(K.__webglInit=!0,F.addEventListener("dispose",U));const ze=F.source;let Ye=y.get(ze);Ye===void 0&&(Ye={},y.set(ze,Ye));const Be=se(F);if(Be!==K.__cacheKey){Ye[Be]===void 0&&(Ye[Be]={texture:s.createTexture(),usedTimes:0},u.memory.textures++,ge=!0),Ye[Be].usedTimes++;const Dt=Ye[K.__cacheKey];Dt!==void 0&&(Ye[K.__cacheKey].usedTimes--,Dt.usedTimes===0&&L(F)),K.__cacheKey=Be,K.__webglTexture=Ye[Be].texture}return ge}function Ue(K,F,ge){return Math.floor(Math.floor(K/ge)/F)}function lt(K,F,ge,ze){const Be=K.updateRanges;if(Be.length===0)t.texSubImage2D(s.TEXTURE_2D,0,0,0,F.width,F.height,ge,ze,F.data);else{Be.sort((Ce,Fe)=>Ce.start-Fe.start);let Dt=0;for(let Ce=1;Ce<Be.length;Ce++){const Fe=Be[Dt],Ze=Be[Ce],ee=Fe.start+Fe.count,Se=Ue(Ze.start,F.width,4),$e=Ue(Fe.start,F.width,4);Ze.start<=ee+1&&Se===$e&&Ue(Ze.start+Ze.count-1,F.width,4)===Se?Fe.count=Math.max(Fe.count,Ze.start+Ze.count-Fe.start):(++Dt,Be[Dt]=Ze)}Be.length=Dt+1;const yt=s.getParameter(s.UNPACK_ROW_LENGTH),kt=s.getParameter(s.UNPACK_SKIP_PIXELS),ke=s.getParameter(s.UNPACK_SKIP_ROWS);s.pixelStorei(s.UNPACK_ROW_LENGTH,F.width);for(let Ce=0,Fe=Be.length;Ce<Fe;Ce++){const Ze=Be[Ce],ee=Math.floor(Ze.start/4),Se=Math.ceil(Ze.count/4),$e=ee%F.width,ue=Math.floor(ee/F.width),we=Se,at=1;s.pixelStorei(s.UNPACK_SKIP_PIXELS,$e),s.pixelStorei(s.UNPACK_SKIP_ROWS,ue),t.texSubImage2D(s.TEXTURE_2D,0,$e,ue,we,at,ge,ze,F.data)}K.clearUpdateRanges(),s.pixelStorei(s.UNPACK_ROW_LENGTH,yt),s.pixelStorei(s.UNPACK_SKIP_PIXELS,kt),s.pixelStorei(s.UNPACK_SKIP_ROWS,ke)}}function pe(K,F,ge){let ze=s.TEXTURE_2D;(F.isDataArrayTexture||F.isCompressedArrayTexture)&&(ze=s.TEXTURE_2D_ARRAY),F.isData3DTexture&&(ze=s.TEXTURE_3D);const Ye=Me(K,F),Be=F.source;t.bindTexture(ze,K.__webglTexture,s.TEXTURE0+ge);const Dt=n.get(Be);if(Be.version!==Dt.__version||Ye===!0){t.activeTexture(s.TEXTURE0+ge);const yt=kn.getPrimaries(kn.workingColorSpace),kt=F.colorSpace===Bl?null:kn.getPrimaries(F.colorSpace),ke=F.colorSpace===Bl||yt===kt?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,F.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,F.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,F.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,ke);let Ce=R(F.image,!1,r.maxTextureSize);Ce=Ft(F,Ce);const Fe=o.convert(F.format,F.colorSpace),Ze=o.convert(F.type);let ee=I(F.internalFormat,Fe,Ze,F.colorSpace,F.isVideoTexture);le(ze,F);let Se;const $e=F.mipmaps,ue=F.isVideoTexture!==!0,we=Dt.__version===void 0||Ye===!0,at=Be.dataReady,Ct=z(F,Ce);if(F.isDepthTexture)ee=P(F.format===Hc,F.type),we&&(ue?t.texStorage2D(s.TEXTURE_2D,1,ee,Ce.width,Ce.height):t.texImage2D(s.TEXTURE_2D,0,ee,Ce.width,Ce.height,0,Fe,Ze,null));else if(F.isDataTexture)if($e.length>0){ue&&we&&t.texStorage2D(s.TEXTURE_2D,Ct,ee,$e[0].width,$e[0].height);for(let ct=0,Qe=$e.length;ct<Qe;ct++)Se=$e[ct],ue?at&&t.texSubImage2D(s.TEXTURE_2D,ct,0,0,Se.width,Se.height,Fe,Ze,Se.data):t.texImage2D(s.TEXTURE_2D,ct,ee,Se.width,Se.height,0,Fe,Ze,Se.data);F.generateMipmaps=!1}else ue?(we&&t.texStorage2D(s.TEXTURE_2D,Ct,ee,Ce.width,Ce.height),at&&lt(F,Ce,Fe,Ze)):t.texImage2D(s.TEXTURE_2D,0,ee,Ce.width,Ce.height,0,Fe,Ze,Ce.data);else if(F.isCompressedTexture)if(F.isCompressedArrayTexture){ue&&we&&t.texStorage3D(s.TEXTURE_2D_ARRAY,Ct,ee,$e[0].width,$e[0].height,Ce.depth);for(let ct=0,Qe=$e.length;ct<Qe;ct++)if(Se=$e[ct],F.format!==or)if(Fe!==null)if(ue){if(at)if(F.layerUpdates.size>0){const gt=L_(Se.width,Se.height,F.format,F.type);for(const qt of F.layerUpdates){const un=Se.data.subarray(qt*gt/Se.data.BYTES_PER_ELEMENT,(qt+1)*gt/Se.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(s.TEXTURE_2D_ARRAY,ct,0,0,qt,Se.width,Se.height,1,Fe,un)}F.clearLayerUpdates()}else t.compressedTexSubImage3D(s.TEXTURE_2D_ARRAY,ct,0,0,0,Se.width,Se.height,Ce.depth,Fe,Se.data)}else t.compressedTexImage3D(s.TEXTURE_2D_ARRAY,ct,ee,Se.width,Se.height,Ce.depth,0,Se.data,0,0);else zt("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else ue?at&&t.texSubImage3D(s.TEXTURE_2D_ARRAY,ct,0,0,0,Se.width,Se.height,Ce.depth,Fe,Ze,Se.data):t.texImage3D(s.TEXTURE_2D_ARRAY,ct,ee,Se.width,Se.height,Ce.depth,0,Fe,Ze,Se.data)}else{ue&&we&&t.texStorage2D(s.TEXTURE_2D,Ct,ee,$e[0].width,$e[0].height);for(let ct=0,Qe=$e.length;ct<Qe;ct++)Se=$e[ct],F.format!==or?Fe!==null?ue?at&&t.compressedTexSubImage2D(s.TEXTURE_2D,ct,0,0,Se.width,Se.height,Fe,Se.data):t.compressedTexImage2D(s.TEXTURE_2D,ct,ee,Se.width,Se.height,0,Se.data):zt("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ue?at&&t.texSubImage2D(s.TEXTURE_2D,ct,0,0,Se.width,Se.height,Fe,Ze,Se.data):t.texImage2D(s.TEXTURE_2D,ct,ee,Se.width,Se.height,0,Fe,Ze,Se.data)}else if(F.isDataArrayTexture)if(ue){if(we&&t.texStorage3D(s.TEXTURE_2D_ARRAY,Ct,ee,Ce.width,Ce.height,Ce.depth),at)if(F.layerUpdates.size>0){const ct=L_(Ce.width,Ce.height,F.format,F.type);for(const Qe of F.layerUpdates){const gt=Ce.data.subarray(Qe*ct/Ce.data.BYTES_PER_ELEMENT,(Qe+1)*ct/Ce.data.BYTES_PER_ELEMENT);t.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,Qe,Ce.width,Ce.height,1,Fe,Ze,gt)}F.clearLayerUpdates()}else t.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,0,Ce.width,Ce.height,Ce.depth,Fe,Ze,Ce.data)}else t.texImage3D(s.TEXTURE_2D_ARRAY,0,ee,Ce.width,Ce.height,Ce.depth,0,Fe,Ze,Ce.data);else if(F.isData3DTexture)ue?(we&&t.texStorage3D(s.TEXTURE_3D,Ct,ee,Ce.width,Ce.height,Ce.depth),at&&t.texSubImage3D(s.TEXTURE_3D,0,0,0,0,Ce.width,Ce.height,Ce.depth,Fe,Ze,Ce.data)):t.texImage3D(s.TEXTURE_3D,0,ee,Ce.width,Ce.height,Ce.depth,0,Fe,Ze,Ce.data);else if(F.isFramebufferTexture){if(we)if(ue)t.texStorage2D(s.TEXTURE_2D,Ct,ee,Ce.width,Ce.height);else{let ct=Ce.width,Qe=Ce.height;for(let gt=0;gt<Ct;gt++)t.texImage2D(s.TEXTURE_2D,gt,ee,ct,Qe,0,Fe,Ze,null),ct>>=1,Qe>>=1}}else if($e.length>0){if(ue&&we){const ct=ht($e[0]);t.texStorage2D(s.TEXTURE_2D,Ct,ee,ct.width,ct.height)}for(let ct=0,Qe=$e.length;ct<Qe;ct++)Se=$e[ct],ue?at&&t.texSubImage2D(s.TEXTURE_2D,ct,0,0,Fe,Ze,Se):t.texImage2D(s.TEXTURE_2D,ct,ee,Fe,Ze,Se);F.generateMipmaps=!1}else if(ue){if(we){const ct=ht(Ce);t.texStorage2D(s.TEXTURE_2D,Ct,ee,ct.width,ct.height)}at&&t.texSubImage2D(s.TEXTURE_2D,0,0,0,Fe,Ze,Ce)}else t.texImage2D(s.TEXTURE_2D,0,ee,Fe,Ze,Ce);A(F)&&E(ze),Dt.__version=Be.version,F.onUpdate&&F.onUpdate(F)}K.__version=F.version}function Re(K,F,ge){if(F.image.length!==6)return;const ze=Me(K,F),Ye=F.source;t.bindTexture(s.TEXTURE_CUBE_MAP,K.__webglTexture,s.TEXTURE0+ge);const Be=n.get(Ye);if(Ye.version!==Be.__version||ze===!0){t.activeTexture(s.TEXTURE0+ge);const Dt=kn.getPrimaries(kn.workingColorSpace),yt=F.colorSpace===Bl?null:kn.getPrimaries(F.colorSpace),kt=F.colorSpace===Bl||Dt===yt?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,F.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,F.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,F.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,kt);const ke=F.isCompressedTexture||F.image[0].isCompressedTexture,Ce=F.image[0]&&F.image[0].isDataTexture,Fe=[];for(let Qe=0;Qe<6;Qe++)!ke&&!Ce?Fe[Qe]=R(F.image[Qe],!0,r.maxCubemapSize):Fe[Qe]=Ce?F.image[Qe].image:F.image[Qe],Fe[Qe]=Ft(F,Fe[Qe]);const Ze=Fe[0],ee=o.convert(F.format,F.colorSpace),Se=o.convert(F.type),$e=I(F.internalFormat,ee,Se,F.colorSpace),ue=F.isVideoTexture!==!0,we=Be.__version===void 0||ze===!0,at=Ye.dataReady;let Ct=z(F,Ze);le(s.TEXTURE_CUBE_MAP,F);let ct;if(ke){ue&&we&&t.texStorage2D(s.TEXTURE_CUBE_MAP,Ct,$e,Ze.width,Ze.height);for(let Qe=0;Qe<6;Qe++){ct=Fe[Qe].mipmaps;for(let gt=0;gt<ct.length;gt++){const qt=ct[gt];F.format!==or?ee!==null?ue?at&&t.compressedTexSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Qe,gt,0,0,qt.width,qt.height,ee,qt.data):t.compressedTexImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Qe,gt,$e,qt.width,qt.height,0,qt.data):zt("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ue?at&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Qe,gt,0,0,qt.width,qt.height,ee,Se,qt.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Qe,gt,$e,qt.width,qt.height,0,ee,Se,qt.data)}}}else{if(ct=F.mipmaps,ue&&we){ct.length>0&&Ct++;const Qe=ht(Fe[0]);t.texStorage2D(s.TEXTURE_CUBE_MAP,Ct,$e,Qe.width,Qe.height)}for(let Qe=0;Qe<6;Qe++)if(Ce){ue?at&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Qe,0,0,0,Fe[Qe].width,Fe[Qe].height,ee,Se,Fe[Qe].data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Qe,0,$e,Fe[Qe].width,Fe[Qe].height,0,ee,Se,Fe[Qe].data);for(let gt=0;gt<ct.length;gt++){const un=ct[gt].image[Qe].image;ue?at&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Qe,gt+1,0,0,un.width,un.height,ee,Se,un.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Qe,gt+1,$e,un.width,un.height,0,ee,Se,un.data)}}else{ue?at&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Qe,0,0,0,ee,Se,Fe[Qe]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Qe,0,$e,ee,Se,Fe[Qe]);for(let gt=0;gt<ct.length;gt++){const qt=ct[gt];ue?at&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Qe,gt+1,0,0,ee,Se,qt.image[Qe]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Qe,gt+1,$e,ee,Se,qt.image[Qe])}}}A(F)&&E(s.TEXTURE_CUBE_MAP),Be.__version=Ye.version,F.onUpdate&&F.onUpdate(F)}K.__version=F.version}function it(K,F,ge,ze,Ye,Be){const Dt=o.convert(ge.format,ge.colorSpace),yt=o.convert(ge.type),kt=I(ge.internalFormat,Dt,yt,ge.colorSpace),ke=n.get(F),Ce=n.get(ge);if(Ce.__renderTarget=F,!ke.__hasExternalTextures){const Fe=Math.max(1,F.width>>Be),Ze=Math.max(1,F.height>>Be);Ye===s.TEXTURE_3D||Ye===s.TEXTURE_2D_ARRAY?t.texImage3D(Ye,Be,kt,Fe,Ze,F.depth,0,Dt,yt,null):t.texImage2D(Ye,Be,kt,Fe,Ze,0,Dt,yt,null)}t.bindFramebuffer(s.FRAMEBUFFER,K),Pt(F)?h.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,ze,Ye,Ce.__webglTexture,0,$(F)):(Ye===s.TEXTURE_2D||Ye>=s.TEXTURE_CUBE_MAP_POSITIVE_X&&Ye<=s.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&s.framebufferTexture2D(s.FRAMEBUFFER,ze,Ye,Ce.__webglTexture,Be),t.bindFramebuffer(s.FRAMEBUFFER,null)}function xt(K,F,ge){if(s.bindRenderbuffer(s.RENDERBUFFER,K),F.depthBuffer){const ze=F.depthTexture,Ye=ze&&ze.isDepthTexture?ze.type:null,Be=P(F.stencilBuffer,Ye),Dt=F.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT;Pt(F)?h.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,$(F),Be,F.width,F.height):ge?s.renderbufferStorageMultisample(s.RENDERBUFFER,$(F),Be,F.width,F.height):s.renderbufferStorage(s.RENDERBUFFER,Be,F.width,F.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,Dt,s.RENDERBUFFER,K)}else{const ze=F.textures;for(let Ye=0;Ye<ze.length;Ye++){const Be=ze[Ye],Dt=o.convert(Be.format,Be.colorSpace),yt=o.convert(Be.type),kt=I(Be.internalFormat,Dt,yt,Be.colorSpace);Pt(F)?h.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,$(F),kt,F.width,F.height):ge?s.renderbufferStorageMultisample(s.RENDERBUFFER,$(F),kt,F.width,F.height):s.renderbufferStorage(s.RENDERBUFFER,kt,F.width,F.height)}}s.bindRenderbuffer(s.RENDERBUFFER,null)}function dt(K,F,ge){const ze=F.isWebGLCubeRenderTarget===!0;if(t.bindFramebuffer(s.FRAMEBUFFER,K),!(F.depthTexture&&F.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Ye=n.get(F.depthTexture);if(Ye.__renderTarget=F,(!Ye.__webglTexture||F.depthTexture.image.width!==F.width||F.depthTexture.image.height!==F.height)&&(F.depthTexture.image.width=F.width,F.depthTexture.image.height=F.height,F.depthTexture.needsUpdate=!0),ze){if(Ye.__webglInit===void 0&&(Ye.__webglInit=!0,F.depthTexture.addEventListener("dispose",U)),Ye.__webglTexture===void 0){Ye.__webglTexture=s.createTexture(),t.bindTexture(s.TEXTURE_CUBE_MAP,Ye.__webglTexture),le(s.TEXTURE_CUBE_MAP,F.depthTexture);const ke=o.convert(F.depthTexture.format),Ce=o.convert(F.depthTexture.type);let Fe;F.depthTexture.format===$o?Fe=s.DEPTH_COMPONENT24:F.depthTexture.format===Hc&&(Fe=s.DEPTH24_STENCIL8);for(let Ze=0;Ze<6;Ze++)s.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ze,0,Fe,F.width,F.height,0,ke,Ce,null)}}else ce(F.depthTexture,0);const Be=Ye.__webglTexture,Dt=$(F),yt=ze?s.TEXTURE_CUBE_MAP_POSITIVE_X+ge:s.TEXTURE_2D,kt=F.depthTexture.format===Hc?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT;if(F.depthTexture.format===$o)Pt(F)?h.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,kt,yt,Be,0,Dt):s.framebufferTexture2D(s.FRAMEBUFFER,kt,yt,Be,0);else if(F.depthTexture.format===Hc)Pt(F)?h.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,kt,yt,Be,0,Dt):s.framebufferTexture2D(s.FRAMEBUFFER,kt,yt,Be,0);else throw new Error("Unknown depthTexture format")}function Ut(K){const F=n.get(K),ge=K.isWebGLCubeRenderTarget===!0;if(F.__boundDepthTexture!==K.depthTexture){const ze=K.depthTexture;if(F.__depthDisposeCallback&&F.__depthDisposeCallback(),ze){const Ye=()=>{delete F.__boundDepthTexture,delete F.__depthDisposeCallback,ze.removeEventListener("dispose",Ye)};ze.addEventListener("dispose",Ye),F.__depthDisposeCallback=Ye}F.__boundDepthTexture=ze}if(K.depthTexture&&!F.__autoAllocateDepthBuffer)if(ge)for(let ze=0;ze<6;ze++)dt(F.__webglFramebuffer[ze],K,ze);else{const ze=K.texture.mipmaps;ze&&ze.length>0?dt(F.__webglFramebuffer[0],K,0):dt(F.__webglFramebuffer,K,0)}else if(ge){F.__webglDepthbuffer=[];for(let ze=0;ze<6;ze++)if(t.bindFramebuffer(s.FRAMEBUFFER,F.__webglFramebuffer[ze]),F.__webglDepthbuffer[ze]===void 0)F.__webglDepthbuffer[ze]=s.createRenderbuffer(),xt(F.__webglDepthbuffer[ze],K,!1);else{const Ye=K.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,Be=F.__webglDepthbuffer[ze];s.bindRenderbuffer(s.RENDERBUFFER,Be),s.framebufferRenderbuffer(s.FRAMEBUFFER,Ye,s.RENDERBUFFER,Be)}}else{const ze=K.texture.mipmaps;if(ze&&ze.length>0?t.bindFramebuffer(s.FRAMEBUFFER,F.__webglFramebuffer[0]):t.bindFramebuffer(s.FRAMEBUFFER,F.__webglFramebuffer),F.__webglDepthbuffer===void 0)F.__webglDepthbuffer=s.createRenderbuffer(),xt(F.__webglDepthbuffer,K,!1);else{const Ye=K.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,Be=F.__webglDepthbuffer;s.bindRenderbuffer(s.RENDERBUFFER,Be),s.framebufferRenderbuffer(s.FRAMEBUFFER,Ye,s.RENDERBUFFER,Be)}}t.bindFramebuffer(s.FRAMEBUFFER,null)}function xe(K,F,ge){const ze=n.get(K);F!==void 0&&it(ze.__webglFramebuffer,K,K.texture,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,0),ge!==void 0&&Ut(K)}function rt(K){const F=K.texture,ge=n.get(K),ze=n.get(F);K.addEventListener("dispose",H);const Ye=K.textures,Be=K.isWebGLCubeRenderTarget===!0,Dt=Ye.length>1;if(Dt||(ze.__webglTexture===void 0&&(ze.__webglTexture=s.createTexture()),ze.__version=F.version,u.memory.textures++),Be){ge.__webglFramebuffer=[];for(let yt=0;yt<6;yt++)if(F.mipmaps&&F.mipmaps.length>0){ge.__webglFramebuffer[yt]=[];for(let kt=0;kt<F.mipmaps.length;kt++)ge.__webglFramebuffer[yt][kt]=s.createFramebuffer()}else ge.__webglFramebuffer[yt]=s.createFramebuffer()}else{if(F.mipmaps&&F.mipmaps.length>0){ge.__webglFramebuffer=[];for(let yt=0;yt<F.mipmaps.length;yt++)ge.__webglFramebuffer[yt]=s.createFramebuffer()}else ge.__webglFramebuffer=s.createFramebuffer();if(Dt)for(let yt=0,kt=Ye.length;yt<kt;yt++){const ke=n.get(Ye[yt]);ke.__webglTexture===void 0&&(ke.__webglTexture=s.createTexture(),u.memory.textures++)}if(K.samples>0&&Pt(K)===!1){ge.__webglMultisampledFramebuffer=s.createFramebuffer(),ge.__webglColorRenderbuffer=[],t.bindFramebuffer(s.FRAMEBUFFER,ge.__webglMultisampledFramebuffer);for(let yt=0;yt<Ye.length;yt++){const kt=Ye[yt];ge.__webglColorRenderbuffer[yt]=s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,ge.__webglColorRenderbuffer[yt]);const ke=o.convert(kt.format,kt.colorSpace),Ce=o.convert(kt.type),Fe=I(kt.internalFormat,ke,Ce,kt.colorSpace,K.isXRRenderTarget===!0),Ze=$(K);s.renderbufferStorageMultisample(s.RENDERBUFFER,Ze,Fe,K.width,K.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+yt,s.RENDERBUFFER,ge.__webglColorRenderbuffer[yt])}s.bindRenderbuffer(s.RENDERBUFFER,null),K.depthBuffer&&(ge.__webglDepthRenderbuffer=s.createRenderbuffer(),xt(ge.__webglDepthRenderbuffer,K,!0)),t.bindFramebuffer(s.FRAMEBUFFER,null)}}if(Be){t.bindTexture(s.TEXTURE_CUBE_MAP,ze.__webglTexture),le(s.TEXTURE_CUBE_MAP,F);for(let yt=0;yt<6;yt++)if(F.mipmaps&&F.mipmaps.length>0)for(let kt=0;kt<F.mipmaps.length;kt++)it(ge.__webglFramebuffer[yt][kt],K,F,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+yt,kt);else it(ge.__webglFramebuffer[yt],K,F,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+yt,0);A(F)&&E(s.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Dt){for(let yt=0,kt=Ye.length;yt<kt;yt++){const ke=Ye[yt],Ce=n.get(ke);let Fe=s.TEXTURE_2D;(K.isWebGL3DRenderTarget||K.isWebGLArrayRenderTarget)&&(Fe=K.isWebGL3DRenderTarget?s.TEXTURE_3D:s.TEXTURE_2D_ARRAY),t.bindTexture(Fe,Ce.__webglTexture),le(Fe,ke),it(ge.__webglFramebuffer,K,ke,s.COLOR_ATTACHMENT0+yt,Fe,0),A(ke)&&E(Fe)}t.unbindTexture()}else{let yt=s.TEXTURE_2D;if((K.isWebGL3DRenderTarget||K.isWebGLArrayRenderTarget)&&(yt=K.isWebGL3DRenderTarget?s.TEXTURE_3D:s.TEXTURE_2D_ARRAY),t.bindTexture(yt,ze.__webglTexture),le(yt,F),F.mipmaps&&F.mipmaps.length>0)for(let kt=0;kt<F.mipmaps.length;kt++)it(ge.__webglFramebuffer[kt],K,F,s.COLOR_ATTACHMENT0,yt,kt);else it(ge.__webglFramebuffer,K,F,s.COLOR_ATTACHMENT0,yt,0);A(F)&&E(yt),t.unbindTexture()}K.depthBuffer&&Ut(K)}function Le(K){const F=K.textures;for(let ge=0,ze=F.length;ge<ze;ge++){const Ye=F[ge];if(A(Ye)){const Be=N(K),Dt=n.get(Ye).__webglTexture;t.bindTexture(Be,Dt),E(Be),t.unbindTexture()}}}const Xe=[],qe=[];function ot(K){if(K.samples>0){if(Pt(K)===!1){const F=K.textures,ge=K.width,ze=K.height;let Ye=s.COLOR_BUFFER_BIT;const Be=K.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,Dt=n.get(K),yt=F.length>1;if(yt)for(let ke=0;ke<F.length;ke++)t.bindFramebuffer(s.FRAMEBUFFER,Dt.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+ke,s.RENDERBUFFER,null),t.bindFramebuffer(s.FRAMEBUFFER,Dt.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+ke,s.TEXTURE_2D,null,0);t.bindFramebuffer(s.READ_FRAMEBUFFER,Dt.__webglMultisampledFramebuffer);const kt=K.texture.mipmaps;kt&&kt.length>0?t.bindFramebuffer(s.DRAW_FRAMEBUFFER,Dt.__webglFramebuffer[0]):t.bindFramebuffer(s.DRAW_FRAMEBUFFER,Dt.__webglFramebuffer);for(let ke=0;ke<F.length;ke++){if(K.resolveDepthBuffer&&(K.depthBuffer&&(Ye|=s.DEPTH_BUFFER_BIT),K.stencilBuffer&&K.resolveStencilBuffer&&(Ye|=s.STENCIL_BUFFER_BIT)),yt){s.framebufferRenderbuffer(s.READ_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,Dt.__webglColorRenderbuffer[ke]);const Ce=n.get(F[ke]).__webglTexture;s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,Ce,0)}s.blitFramebuffer(0,0,ge,ze,0,0,ge,ze,Ye,s.NEAREST),d===!0&&(Xe.length=0,qe.length=0,Xe.push(s.COLOR_ATTACHMENT0+ke),K.depthBuffer&&K.resolveDepthBuffer===!1&&(Xe.push(Be),qe.push(Be),s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,qe)),s.invalidateFramebuffer(s.READ_FRAMEBUFFER,Xe))}if(t.bindFramebuffer(s.READ_FRAMEBUFFER,null),t.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),yt)for(let ke=0;ke<F.length;ke++){t.bindFramebuffer(s.FRAMEBUFFER,Dt.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+ke,s.RENDERBUFFER,Dt.__webglColorRenderbuffer[ke]);const Ce=n.get(F[ke]).__webglTexture;t.bindFramebuffer(s.FRAMEBUFFER,Dt.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+ke,s.TEXTURE_2D,Ce,0)}t.bindFramebuffer(s.DRAW_FRAMEBUFFER,Dt.__webglMultisampledFramebuffer)}else if(K.depthBuffer&&K.resolveDepthBuffer===!1&&d){const F=K.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT;s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,[F])}}}function $(K){return Math.min(r.maxSamples,K.samples)}function Pt(K){const F=n.get(K);return K.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&F.__useRenderToTexture!==!1}function St(K){const F=u.render.frame;v.get(K)!==F&&(v.set(K,F),K.update())}function Ft(K,F){const ge=K.colorSpace,ze=K.format,Ye=K.type;return K.isCompressedTexture===!0||K.isVideoTexture===!0||ge!==vo&&ge!==Bl&&(kn.getTransfer(ge)===ti?(ze!==or||Ye!==Dr)&&zt("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):Qt("WebGLTextures: Unsupported texture color space:",ge)),F}function ht(K){return typeof HTMLImageElement<"u"&&K instanceof HTMLImageElement?(m.width=K.naturalWidth||K.width,m.height=K.naturalHeight||K.height):typeof VideoFrame<"u"&&K instanceof VideoFrame?(m.width=K.displayWidth,m.height=K.displayHeight):(m.width=K.width,m.height=K.height),m}this.allocateTextureUnit=J,this.resetTextureUnits=ie,this.setTexture2D=ce,this.setTexture2DArray=Y,this.setTexture3D=ne,this.setTextureCube=ve,this.rebindTextures=xe,this.setupRenderTarget=rt,this.updateRenderTargetMipmap=Le,this.updateMultisampleRenderTarget=ot,this.setupDepthRenderbuffer=Ut,this.setupFrameBufferTexture=it,this.useMultisampledRTT=Pt,this.isReversedDepthBuffer=function(){return t.buffers.depth.getReversed()}}function jw(s,e){function t(n,r=Bl){let o;const u=kn.getTransfer(r);if(n===Dr)return s.UNSIGNED_BYTE;if(n===Wx)return s.UNSIGNED_SHORT_4_4_4_4;if(n===Xx)return s.UNSIGNED_SHORT_5_5_5_1;if(n===t1)return s.UNSIGNED_INT_5_9_9_9_REV;if(n===n1)return s.UNSIGNED_INT_10F_11F_11F_REV;if(n===Gx)return s.BYTE;if(n===jx)return s.SHORT;if(n===od)return s.UNSIGNED_SHORT;if(n===Xm)return s.INT;if(n===ca)return s.UNSIGNED_INT;if(n===Li)return s.FLOAT;if(n===Qi)return s.HALF_FLOAT;if(n===i1)return s.ALPHA;if(n===r1)return s.RGB;if(n===or)return s.RGBA;if(n===$o)return s.DEPTH_COMPONENT;if(n===Hc)return s.DEPTH_STENCIL;if(n===qm)return s.RED;if(n===Ym)return s.RED_INTEGER;if(n===pf)return s.RG;if(n===qx)return s.RG_INTEGER;if(n===Yx)return s.RGBA_INTEGER;if(n===vm||n===xm||n===ym||n===bm)if(u===ti)if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(n===vm)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===xm)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===ym)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===bm)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(n===vm)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===xm)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===ym)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===bm)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===Jv||n===$v||n===ex||n===tx)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(n===Jv)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===$v)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===ex)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===tx)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===nx||n===ix||n===rx||n===sx||n===ax||n===ox||n===lx)if(o=e.get("WEBGL_compressed_texture_etc"),o!==null){if(n===nx||n===ix)return u===ti?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(n===rx)return u===ti?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC;if(n===sx)return o.COMPRESSED_R11_EAC;if(n===ax)return o.COMPRESSED_SIGNED_R11_EAC;if(n===ox)return o.COMPRESSED_RG11_EAC;if(n===lx)return o.COMPRESSED_SIGNED_RG11_EAC}else return null;if(n===cx||n===ux||n===fx||n===hx||n===dx||n===px||n===mx||n===gx||n===vx||n===xx||n===yx||n===bx||n===_x||n===Sx)if(o=e.get("WEBGL_compressed_texture_astc"),o!==null){if(n===cx)return u===ti?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===ux)return u===ti?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===fx)return u===ti?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===hx)return u===ti?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===dx)return u===ti?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===px)return u===ti?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===mx)return u===ti?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===gx)return u===ti?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===vx)return u===ti?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===xx)return u===ti?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===yx)return u===ti?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===bx)return u===ti?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===_x)return u===ti?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===Sx)return u===ti?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===Mx||n===Ex||n===Tx)if(o=e.get("EXT_texture_compression_bptc"),o!==null){if(n===Mx)return u===ti?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===Ex)return o.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===Tx)return o.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===wx||n===Ax||n===Cx||n===Rx)if(o=e.get("EXT_texture_compression_rgtc"),o!==null){if(n===wx)return o.COMPRESSED_RED_RGTC1_EXT;if(n===Ax)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===Cx)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===Rx)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===ld?s.UNSIGNED_INT_24_8:s[n]!==void 0?s[n]:null}return{convert:t}}const zP=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,BP=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class FP{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){const n=new p1(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new ls({vertexShader:zP,fragmentShader:BP,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Gi(new Jc(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class kP extends el{constructor(e,t){super();const n=this;let r=null,o=1,u=null,h="local-floor",d=1,m=null,v=null,x=null,y=null,_=null,M=null;const R=typeof XRWebGLBinding<"u",A=new FP,E={},N=t.getContextAttributes();let I=null,P=null;const z=[],U=[],H=new Je;let V=null;const L=new Vi;L.viewport=new hi;const B=new Vi;B.viewport=new hi;const W=[L,B],ie=new Pw;let J=null,se=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(pe){let Re=z[pe];return Re===void 0&&(Re=new kv,z[pe]=Re),Re.getTargetRaySpace()},this.getControllerGrip=function(pe){let Re=z[pe];return Re===void 0&&(Re=new kv,z[pe]=Re),Re.getGripSpace()},this.getHand=function(pe){let Re=z[pe];return Re===void 0&&(Re=new kv,z[pe]=Re),Re.getHandSpace()};function ce(pe){const Re=U.indexOf(pe.inputSource);if(Re===-1)return;const it=z[Re];it!==void 0&&(it.update(pe.inputSource,pe.frame,m||u),it.dispatchEvent({type:pe.type,data:pe.inputSource}))}function Y(){r.removeEventListener("select",ce),r.removeEventListener("selectstart",ce),r.removeEventListener("selectend",ce),r.removeEventListener("squeeze",ce),r.removeEventListener("squeezestart",ce),r.removeEventListener("squeezeend",ce),r.removeEventListener("end",Y),r.removeEventListener("inputsourceschange",ne);for(let pe=0;pe<z.length;pe++){const Re=U[pe];Re!==null&&(U[pe]=null,z[pe].disconnect(Re))}J=null,se=null,A.reset();for(const pe in E)delete E[pe];e.setRenderTarget(I),_=null,y=null,x=null,r=null,P=null,lt.stop(),n.isPresenting=!1,e.setPixelRatio(V),e.setSize(H.width,H.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(pe){o=pe,n.isPresenting===!0&&zt("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(pe){h=pe,n.isPresenting===!0&&zt("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return m||u},this.setReferenceSpace=function(pe){m=pe},this.getBaseLayer=function(){return y!==null?y:_},this.getBinding=function(){return x===null&&R&&(x=new XRWebGLBinding(r,t)),x},this.getFrame=function(){return M},this.getSession=function(){return r},this.setSession=async function(pe){if(r=pe,r!==null){if(I=e.getRenderTarget(),r.addEventListener("select",ce),r.addEventListener("selectstart",ce),r.addEventListener("selectend",ce),r.addEventListener("squeeze",ce),r.addEventListener("squeezestart",ce),r.addEventListener("squeezeend",ce),r.addEventListener("end",Y),r.addEventListener("inputsourceschange",ne),N.xrCompatible!==!0&&await t.makeXRCompatible(),V=e.getPixelRatio(),e.getSize(H),R&&"createProjectionLayer"in XRWebGLBinding.prototype){let it=null,xt=null,dt=null;N.depth&&(dt=N.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,it=N.stencil?Hc:$o,xt=N.stencil?ld:ca);const Ut={colorFormat:t.RGBA8,depthFormat:dt,scaleFactor:o};x=this.getBinding(),y=x.createProjectionLayer(Ut),r.updateRenderState({layers:[y]}),e.setPixelRatio(1),e.setSize(y.textureWidth,y.textureHeight,!1),P=new Ts(y.textureWidth,y.textureHeight,{format:or,type:Dr,depthTexture:new md(y.textureWidth,y.textureHeight,xt,void 0,void 0,void 0,void 0,void 0,void 0,it),stencilBuffer:N.stencil,colorSpace:e.outputColorSpace,samples:N.antialias?4:0,resolveDepthBuffer:y.ignoreDepthValues===!1,resolveStencilBuffer:y.ignoreDepthValues===!1})}else{const it={antialias:N.antialias,alpha:!0,depth:N.depth,stencil:N.stencil,framebufferScaleFactor:o};_=new XRWebGLLayer(r,t,it),r.updateRenderState({baseLayer:_}),e.setPixelRatio(1),e.setSize(_.framebufferWidth,_.framebufferHeight,!1),P=new Ts(_.framebufferWidth,_.framebufferHeight,{format:or,type:Dr,colorSpace:e.outputColorSpace,stencilBuffer:N.stencil,resolveDepthBuffer:_.ignoreDepthValues===!1,resolveStencilBuffer:_.ignoreDepthValues===!1})}P.isXRRenderTarget=!0,this.setFoveation(d),m=null,u=await r.requestReferenceSpace(h),lt.setContext(r),lt.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return A.getDepthTexture()};function ne(pe){for(let Re=0;Re<pe.removed.length;Re++){const it=pe.removed[Re],xt=U.indexOf(it);xt>=0&&(U[xt]=null,z[xt].disconnect(it))}for(let Re=0;Re<pe.added.length;Re++){const it=pe.added[Re];let xt=U.indexOf(it);if(xt===-1){for(let Ut=0;Ut<z.length;Ut++)if(Ut>=U.length){U.push(it),xt=Ut;break}else if(U[Ut]===null){U[Ut]=it,xt=Ut;break}if(xt===-1)break}const dt=z[xt];dt&&dt.connect(it)}}const ve=new Q,ae=new Q;function re(pe,Re,it){ve.setFromMatrixPosition(Re.matrixWorld),ae.setFromMatrixPosition(it.matrixWorld);const xt=ve.distanceTo(ae),dt=Re.projectionMatrix.elements,Ut=it.projectionMatrix.elements,xe=dt[14]/(dt[10]-1),rt=dt[14]/(dt[10]+1),Le=(dt[9]+1)/dt[5],Xe=(dt[9]-1)/dt[5],qe=(dt[8]-1)/dt[0],ot=(Ut[8]+1)/Ut[0],$=xe*qe,Pt=xe*ot,St=xt/(-qe+ot),Ft=St*-qe;if(Re.matrixWorld.decompose(pe.position,pe.quaternion,pe.scale),pe.translateX(Ft),pe.translateZ(St),pe.matrixWorld.compose(pe.position,pe.quaternion,pe.scale),pe.matrixWorldInverse.copy(pe.matrixWorld).invert(),dt[10]===-1)pe.projectionMatrix.copy(Re.projectionMatrix),pe.projectionMatrixInverse.copy(Re.projectionMatrixInverse);else{const ht=xe+St,K=rt+St,F=$-Ft,ge=Pt+(xt-Ft),ze=Le*rt/K*ht,Ye=Xe*rt/K*ht;pe.projectionMatrix.makePerspective(F,ge,ze,Ye,ht,K),pe.projectionMatrixInverse.copy(pe.projectionMatrix).invert()}}function j(pe,Re){Re===null?pe.matrixWorld.copy(pe.matrix):pe.matrixWorld.multiplyMatrices(Re.matrixWorld,pe.matrix),pe.matrixWorldInverse.copy(pe.matrixWorld).invert()}this.updateCamera=function(pe){if(r===null)return;let Re=pe.near,it=pe.far;A.texture!==null&&(A.depthNear>0&&(Re=A.depthNear),A.depthFar>0&&(it=A.depthFar)),ie.near=B.near=L.near=Re,ie.far=B.far=L.far=it,(J!==ie.near||se!==ie.far)&&(r.updateRenderState({depthNear:ie.near,depthFar:ie.far}),J=ie.near,se=ie.far),ie.layers.mask=pe.layers.mask|6,L.layers.mask=ie.layers.mask&3,B.layers.mask=ie.layers.mask&5;const xt=pe.parent,dt=ie.cameras;j(ie,xt);for(let Ut=0;Ut<dt.length;Ut++)j(dt[Ut],xt);dt.length===2?re(ie,L,B):ie.projectionMatrix.copy(L.projectionMatrix),le(pe,ie,xt)};function le(pe,Re,it){it===null?pe.matrix.copy(Re.matrixWorld):(pe.matrix.copy(it.matrixWorld),pe.matrix.invert(),pe.matrix.multiply(Re.matrixWorld)),pe.matrix.decompose(pe.position,pe.quaternion,pe.scale),pe.updateMatrixWorld(!0),pe.projectionMatrix.copy(Re.projectionMatrix),pe.projectionMatrixInverse.copy(Re.projectionMatrixInverse),pe.isPerspectiveCamera&&(pe.fov=fd*2*Math.atan(1/pe.projectionMatrix.elements[5]),pe.zoom=1)}this.getCamera=function(){return ie},this.getFoveation=function(){if(!(y===null&&_===null))return d},this.setFoveation=function(pe){d=pe,y!==null&&(y.fixedFoveation=pe),_!==null&&_.fixedFoveation!==void 0&&(_.fixedFoveation=pe)},this.hasDepthSensing=function(){return A.texture!==null},this.getDepthSensingMesh=function(){return A.getMesh(ie)},this.getCameraTexture=function(pe){return E[pe]};let Me=null;function Ue(pe,Re){if(v=Re.getViewerPose(m||u),M=Re,v!==null){const it=v.views;_!==null&&(e.setRenderTargetFramebuffer(P,_.framebuffer),e.setRenderTarget(P));let xt=!1;it.length!==ie.cameras.length&&(ie.cameras.length=0,xt=!0);for(let rt=0;rt<it.length;rt++){const Le=it[rt];let Xe=null;if(_!==null)Xe=_.getViewport(Le);else{const ot=x.getViewSubImage(y,Le);Xe=ot.viewport,rt===0&&(e.setRenderTargetTextures(P,ot.colorTexture,ot.depthStencilTexture),e.setRenderTarget(P))}let qe=W[rt];qe===void 0&&(qe=new Vi,qe.layers.enable(rt),qe.viewport=new hi,W[rt]=qe),qe.matrix.fromArray(Le.transform.matrix),qe.matrix.decompose(qe.position,qe.quaternion,qe.scale),qe.projectionMatrix.fromArray(Le.projectionMatrix),qe.projectionMatrixInverse.copy(qe.projectionMatrix).invert(),qe.viewport.set(Xe.x,Xe.y,Xe.width,Xe.height),rt===0&&(ie.matrix.copy(qe.matrix),ie.matrix.decompose(ie.position,ie.quaternion,ie.scale)),xt===!0&&ie.cameras.push(qe)}const dt=r.enabledFeatures;if(dt&&dt.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&R){x=n.getBinding();const rt=x.getDepthInformation(it[0]);rt&&rt.isValid&&rt.texture&&A.init(rt,r.renderState)}if(dt&&dt.includes("camera-access")&&R){e.state.unbindTexture(),x=n.getBinding();for(let rt=0;rt<it.length;rt++){const Le=it[rt].camera;if(Le){let Xe=E[Le];Xe||(Xe=new p1,E[Le]=Xe);const qe=x.getCameraImage(Le);Xe.sourceTexture=qe}}}}for(let it=0;it<z.length;it++){const xt=U[it],dt=z[it];xt!==null&&dt!==void 0&&dt.update(xt,Re,m||u)}Me&&Me(pe,Re),Re.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:Re}),M=null}const lt=new Fw;lt.setAnimationLoop(Ue),this.setAnimationLoop=function(pe){Me=pe},this.dispose=function(){}}}const Ju=new ua,VP=new cn;function HP(s,e){function t(A,E){A.matrixAutoUpdate===!0&&A.updateMatrix(),E.value.copy(A.matrix)}function n(A,E){E.color.getRGB(A.fogColor.value,GT(s)),E.isFog?(A.fogNear.value=E.near,A.fogFar.value=E.far):E.isFogExp2&&(A.fogDensity.value=E.density)}function r(A,E,N,I,P){E.isMeshBasicMaterial||E.isMeshLambertMaterial?o(A,E):E.isMeshToonMaterial?(o(A,E),x(A,E)):E.isMeshPhongMaterial?(o(A,E),v(A,E)):E.isMeshStandardMaterial?(o(A,E),y(A,E),E.isMeshPhysicalMaterial&&_(A,E,P)):E.isMeshMatcapMaterial?(o(A,E),M(A,E)):E.isMeshDepthMaterial?o(A,E):E.isMeshDistanceMaterial?(o(A,E),R(A,E)):E.isMeshNormalMaterial?o(A,E):E.isLineBasicMaterial?(u(A,E),E.isLineDashedMaterial&&h(A,E)):E.isPointsMaterial?d(A,E,N,I):E.isSpriteMaterial?m(A,E):E.isShadowMaterial?(A.color.value.copy(E.color),A.opacity.value=E.opacity):E.isShaderMaterial&&(E.uniformsNeedUpdate=!1)}function o(A,E){A.opacity.value=E.opacity,E.color&&A.diffuse.value.copy(E.color),E.emissive&&A.emissive.value.copy(E.emissive).multiplyScalar(E.emissiveIntensity),E.map&&(A.map.value=E.map,t(E.map,A.mapTransform)),E.alphaMap&&(A.alphaMap.value=E.alphaMap,t(E.alphaMap,A.alphaMapTransform)),E.bumpMap&&(A.bumpMap.value=E.bumpMap,t(E.bumpMap,A.bumpMapTransform),A.bumpScale.value=E.bumpScale,E.side===ss&&(A.bumpScale.value*=-1)),E.normalMap&&(A.normalMap.value=E.normalMap,t(E.normalMap,A.normalMapTransform),A.normalScale.value.copy(E.normalScale),E.side===ss&&A.normalScale.value.negate()),E.displacementMap&&(A.displacementMap.value=E.displacementMap,t(E.displacementMap,A.displacementMapTransform),A.displacementScale.value=E.displacementScale,A.displacementBias.value=E.displacementBias),E.emissiveMap&&(A.emissiveMap.value=E.emissiveMap,t(E.emissiveMap,A.emissiveMapTransform)),E.specularMap&&(A.specularMap.value=E.specularMap,t(E.specularMap,A.specularMapTransform)),E.alphaTest>0&&(A.alphaTest.value=E.alphaTest);const N=e.get(E),I=N.envMap,P=N.envMapRotation;I&&(A.envMap.value=I,Ju.copy(P),Ju.x*=-1,Ju.y*=-1,Ju.z*=-1,I.isCubeTexture&&I.isRenderTargetTexture===!1&&(Ju.y*=-1,Ju.z*=-1),A.envMapRotation.value.setFromMatrix4(VP.makeRotationFromEuler(Ju)),A.flipEnvMap.value=I.isCubeTexture&&I.isRenderTargetTexture===!1?-1:1,A.reflectivity.value=E.reflectivity,A.ior.value=E.ior,A.refractionRatio.value=E.refractionRatio),E.lightMap&&(A.lightMap.value=E.lightMap,A.lightMapIntensity.value=E.lightMapIntensity,t(E.lightMap,A.lightMapTransform)),E.aoMap&&(A.aoMap.value=E.aoMap,A.aoMapIntensity.value=E.aoMapIntensity,t(E.aoMap,A.aoMapTransform))}function u(A,E){A.diffuse.value.copy(E.color),A.opacity.value=E.opacity,E.map&&(A.map.value=E.map,t(E.map,A.mapTransform))}function h(A,E){A.dashSize.value=E.dashSize,A.totalSize.value=E.dashSize+E.gapSize,A.scale.value=E.scale}function d(A,E,N,I){A.diffuse.value.copy(E.color),A.opacity.value=E.opacity,A.size.value=E.size*N,A.scale.value=I*.5,E.map&&(A.map.value=E.map,t(E.map,A.uvTransform)),E.alphaMap&&(A.alphaMap.value=E.alphaMap,t(E.alphaMap,A.alphaMapTransform)),E.alphaTest>0&&(A.alphaTest.value=E.alphaTest)}function m(A,E){A.diffuse.value.copy(E.color),A.opacity.value=E.opacity,A.rotation.value=E.rotation,E.map&&(A.map.value=E.map,t(E.map,A.mapTransform)),E.alphaMap&&(A.alphaMap.value=E.alphaMap,t(E.alphaMap,A.alphaMapTransform)),E.alphaTest>0&&(A.alphaTest.value=E.alphaTest)}function v(A,E){A.specular.value.copy(E.specular),A.shininess.value=Math.max(E.shininess,1e-4)}function x(A,E){E.gradientMap&&(A.gradientMap.value=E.gradientMap)}function y(A,E){A.metalness.value=E.metalness,E.metalnessMap&&(A.metalnessMap.value=E.metalnessMap,t(E.metalnessMap,A.metalnessMapTransform)),A.roughness.value=E.roughness,E.roughnessMap&&(A.roughnessMap.value=E.roughnessMap,t(E.roughnessMap,A.roughnessMapTransform)),E.envMap&&(A.envMapIntensity.value=E.envMapIntensity)}function _(A,E,N){A.ior.value=E.ior,E.sheen>0&&(A.sheenColor.value.copy(E.sheenColor).multiplyScalar(E.sheen),A.sheenRoughness.value=E.sheenRoughness,E.sheenColorMap&&(A.sheenColorMap.value=E.sheenColorMap,t(E.sheenColorMap,A.sheenColorMapTransform)),E.sheenRoughnessMap&&(A.sheenRoughnessMap.value=E.sheenRoughnessMap,t(E.sheenRoughnessMap,A.sheenRoughnessMapTransform))),E.clearcoat>0&&(A.clearcoat.value=E.clearcoat,A.clearcoatRoughness.value=E.clearcoatRoughness,E.clearcoatMap&&(A.clearcoatMap.value=E.clearcoatMap,t(E.clearcoatMap,A.clearcoatMapTransform)),E.clearcoatRoughnessMap&&(A.clearcoatRoughnessMap.value=E.clearcoatRoughnessMap,t(E.clearcoatRoughnessMap,A.clearcoatRoughnessMapTransform)),E.clearcoatNormalMap&&(A.clearcoatNormalMap.value=E.clearcoatNormalMap,t(E.clearcoatNormalMap,A.clearcoatNormalMapTransform),A.clearcoatNormalScale.value.copy(E.clearcoatNormalScale),E.side===ss&&A.clearcoatNormalScale.value.negate())),E.dispersion>0&&(A.dispersion.value=E.dispersion),E.iridescence>0&&(A.iridescence.value=E.iridescence,A.iridescenceIOR.value=E.iridescenceIOR,A.iridescenceThicknessMinimum.value=E.iridescenceThicknessRange[0],A.iridescenceThicknessMaximum.value=E.iridescenceThicknessRange[1],E.iridescenceMap&&(A.iridescenceMap.value=E.iridescenceMap,t(E.iridescenceMap,A.iridescenceMapTransform)),E.iridescenceThicknessMap&&(A.iridescenceThicknessMap.value=E.iridescenceThicknessMap,t(E.iridescenceThicknessMap,A.iridescenceThicknessMapTransform))),E.transmission>0&&(A.transmission.value=E.transmission,A.transmissionSamplerMap.value=N.texture,A.transmissionSamplerSize.value.set(N.width,N.height),E.transmissionMap&&(A.transmissionMap.value=E.transmissionMap,t(E.transmissionMap,A.transmissionMapTransform)),A.thickness.value=E.thickness,E.thicknessMap&&(A.thicknessMap.value=E.thicknessMap,t(E.thicknessMap,A.thicknessMapTransform)),A.attenuationDistance.value=E.attenuationDistance,A.attenuationColor.value.copy(E.attenuationColor)),E.anisotropy>0&&(A.anisotropyVector.value.set(E.anisotropy*Math.cos(E.anisotropyRotation),E.anisotropy*Math.sin(E.anisotropyRotation)),E.anisotropyMap&&(A.anisotropyMap.value=E.anisotropyMap,t(E.anisotropyMap,A.anisotropyMapTransform))),A.specularIntensity.value=E.specularIntensity,A.specularColor.value.copy(E.specularColor),E.specularColorMap&&(A.specularColorMap.value=E.specularColorMap,t(E.specularColorMap,A.specularColorMapTransform)),E.specularIntensityMap&&(A.specularIntensityMap.value=E.specularIntensityMap,t(E.specularIntensityMap,A.specularIntensityMapTransform))}function M(A,E){E.matcap&&(A.matcap.value=E.matcap)}function R(A,E){const N=e.get(E).light;A.referencePosition.value.setFromMatrixPosition(N.matrixWorld),A.nearDistance.value=N.shadow.camera.near,A.farDistance.value=N.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function GP(s,e,t,n){let r={},o={},u=[];const h=s.getParameter(s.MAX_UNIFORM_BUFFER_BINDINGS);function d(N,I){const P=I.program;n.uniformBlockBinding(N,P)}function m(N,I){let P=r[N.id];P===void 0&&(M(N),P=v(N),r[N.id]=P,N.addEventListener("dispose",A));const z=I.program;n.updateUBOMapping(N,z);const U=e.render.frame;o[N.id]!==U&&(y(N),o[N.id]=U)}function v(N){const I=x();N.__bindingPointIndex=I;const P=s.createBuffer(),z=N.__size,U=N.usage;return s.bindBuffer(s.UNIFORM_BUFFER,P),s.bufferData(s.UNIFORM_BUFFER,z,U),s.bindBuffer(s.UNIFORM_BUFFER,null),s.bindBufferBase(s.UNIFORM_BUFFER,I,P),P}function x(){for(let N=0;N<h;N++)if(u.indexOf(N)===-1)return u.push(N),N;return Qt("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function y(N){const I=r[N.id],P=N.uniforms,z=N.__cache;s.bindBuffer(s.UNIFORM_BUFFER,I);for(let U=0,H=P.length;U<H;U++){const V=Array.isArray(P[U])?P[U]:[P[U]];for(let L=0,B=V.length;L<B;L++){const W=V[L];if(_(W,U,L,z)===!0){const ie=W.__offset,J=Array.isArray(W.value)?W.value:[W.value];let se=0;for(let ce=0;ce<J.length;ce++){const Y=J[ce],ne=R(Y);typeof Y=="number"||typeof Y=="boolean"?(W.__data[0]=Y,s.bufferSubData(s.UNIFORM_BUFFER,ie+se,W.__data)):Y.isMatrix3?(W.__data[0]=Y.elements[0],W.__data[1]=Y.elements[1],W.__data[2]=Y.elements[2],W.__data[3]=0,W.__data[4]=Y.elements[3],W.__data[5]=Y.elements[4],W.__data[6]=Y.elements[5],W.__data[7]=0,W.__data[8]=Y.elements[6],W.__data[9]=Y.elements[7],W.__data[10]=Y.elements[8],W.__data[11]=0):(Y.toArray(W.__data,se),se+=ne.storage/Float32Array.BYTES_PER_ELEMENT)}s.bufferSubData(s.UNIFORM_BUFFER,ie,W.__data)}}}s.bindBuffer(s.UNIFORM_BUFFER,null)}function _(N,I,P,z){const U=N.value,H=I+"_"+P;if(z[H]===void 0)return typeof U=="number"||typeof U=="boolean"?z[H]=U:z[H]=U.clone(),!0;{const V=z[H];if(typeof U=="number"||typeof U=="boolean"){if(V!==U)return z[H]=U,!0}else if(V.equals(U)===!1)return V.copy(U),!0}return!1}function M(N){const I=N.uniforms;let P=0;const z=16;for(let H=0,V=I.length;H<V;H++){const L=Array.isArray(I[H])?I[H]:[I[H]];for(let B=0,W=L.length;B<W;B++){const ie=L[B],J=Array.isArray(ie.value)?ie.value:[ie.value];for(let se=0,ce=J.length;se<ce;se++){const Y=J[se],ne=R(Y),ve=P%z,ae=ve%ne.boundary,re=ve+ae;P+=ae,re!==0&&z-re<ne.storage&&(P+=z-re),ie.__data=new Float32Array(ne.storage/Float32Array.BYTES_PER_ELEMENT),ie.__offset=P,P+=ne.storage}}}const U=P%z;return U>0&&(P+=z-U),N.__size=P,N.__cache={},this}function R(N){const I={boundary:0,storage:0};return typeof N=="number"||typeof N=="boolean"?(I.boundary=4,I.storage=4):N.isVector2?(I.boundary=8,I.storage=8):N.isVector3||N.isColor?(I.boundary=16,I.storage=12):N.isVector4?(I.boundary=16,I.storage=16):N.isMatrix3?(I.boundary=48,I.storage=48):N.isMatrix4?(I.boundary=64,I.storage=64):N.isTexture?zt("WebGLRenderer: Texture samplers can not be part of an uniforms group."):zt("WebGLRenderer: Unsupported uniform value type.",N),I}function A(N){const I=N.target;I.removeEventListener("dispose",A);const P=u.indexOf(I.__bindingPointIndex);u.splice(P,1),s.deleteBuffer(r[I.id]),delete r[I.id],delete o[I.id]}function E(){for(const N in r)s.deleteBuffer(r[N]);u=[],r={},o={}}return{bind:d,update:m,dispose:E}}const jP=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let Zo=null;function WP(){return Zo===null&&(Zo=new Va(jP,16,16,pf,Qi),Zo.name="DFG_LUT",Zo.minFilter=Gn,Zo.magFilter=Gn,Zo.wrapS=Ki,Zo.wrapT=Ki,Zo.generateMipmaps=!1,Zo.needsUpdate=!0),Zo}class U1{constructor(e={}){const{canvas:t=kT(),context:n=null,depth:r=!0,stencil:o=!1,alpha:u=!1,antialias:h=!1,premultipliedAlpha:d=!0,preserveDrawingBuffer:m=!1,powerPreference:v="default",failIfMajorPerformanceCaveat:x=!1,reversedDepthBuffer:y=!1,outputBufferType:_=Dr}=e;this.isWebGLRenderer=!0;let M;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");M=n.getContextAttributes().alpha}else M=u;const R=_,A=new Set([Yx,qx,Ym]),E=new Set([Dr,ca,od,ld,Wx,Xx]),N=new Uint32Array(4),I=new Int32Array(4);let P=null,z=null;const U=[],H=[];let V=null;this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=ka,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const L=this;let B=!1;this._outputColorSpace=Gr;let W=0,ie=0,J=null,se=-1,ce=null;const Y=new hi,ne=new hi;let ve=null;const ae=new Lt(0);let re=0,j=t.width,le=t.height,Me=1,Ue=null,lt=null;const pe=new hi(0,0,j,le),Re=new hi(0,0,j,le);let it=!1;const xt=new _d;let dt=!1,Ut=!1;const xe=new cn,rt=new Q,Le=new hi,Xe={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let qe=!1;function ot(){return J===null?Me:1}let $=n;function Pt(G,oe){return t.getContext(G,oe)}try{const G={alpha:!0,depth:r,stencil:o,antialias:h,premultipliedAlpha:d,preserveDrawingBuffer:m,powerPreference:v,failIfMajorPerformanceCaveat:x};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${yd}`),t.addEventListener("webglcontextlost",qt,!1),t.addEventListener("webglcontextrestored",un,!1),t.addEventListener("webglcontextcreationerror",dn,!1),$===null){const oe="webgl2";if($=Pt(oe,G),$===null)throw Pt(oe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(G){throw Qt("WebGLRenderer: "+G.message),G}let St,Ft,ht,K,F,ge,ze,Ye,Be,Dt,yt,kt,ke,Ce,Fe,Ze,ee,Se,$e,ue,we,at,Ct,ct;function Qe(){St=new XI($),St.init(),at=new jw($,St),Ft=new zI($,St,e,at),ht=new UP($,St),Ft.reversedDepthBuffer&&y&&ht.buffers.depth.setReversed(!0),K=new ZI($),F=new bP,ge=new OP($,St,ht,F,Ft,at,K),ze=new FI(L),Ye=new WI(L),Be=new $N($),Ct=new UI($,Be),Dt=new qI($,Be,K,Ct),yt=new QI($,Dt,Be,K),$e=new KI($,Ft,ge),Ze=new BI(F),kt=new yP(L,ze,Ye,St,Ft,Ct,Ze),ke=new HP(L,F),Ce=new SP,Fe=new CP(St),Se=new PI(L,ze,Ye,ht,yt,M,d),ee=new LP(L,yt,Ft),ct=new GP($,K,Ft,ht),ue=new OI($,St,K),we=new YI($,St,K),K.programs=kt.programs,L.capabilities=Ft,L.extensions=St,L.properties=F,L.renderLists=Ce,L.shadowMap=ee,L.state=ht,L.info=K}Qe(),R!==Dr&&(V=new $I(R,t.width,t.height,r,o));const gt=new kP(L,$);this.xr=gt,this.getContext=function(){return $},this.getContextAttributes=function(){return $.getContextAttributes()},this.forceContextLoss=function(){const G=St.get("WEBGL_lose_context");G&&G.loseContext()},this.forceContextRestore=function(){const G=St.get("WEBGL_lose_context");G&&G.restoreContext()},this.getPixelRatio=function(){return Me},this.setPixelRatio=function(G){G!==void 0&&(Me=G,this.setSize(j,le,!1))},this.getSize=function(G){return G.set(j,le)},this.setSize=function(G,oe,be=!0){if(gt.isPresenting){zt("WebGLRenderer: Can't change size while VR device is presenting.");return}j=G,le=oe,t.width=Math.floor(G*Me),t.height=Math.floor(oe*Me),be===!0&&(t.style.width=G+"px",t.style.height=oe+"px"),V!==null&&V.setSize(t.width,t.height),this.setViewport(0,0,G,oe)},this.getDrawingBufferSize=function(G){return G.set(j*Me,le*Me).floor()},this.setDrawingBufferSize=function(G,oe,be){j=G,le=oe,Me=be,t.width=Math.floor(G*be),t.height=Math.floor(oe*be),this.setViewport(0,0,G,oe)},this.setEffects=function(G){if(R===Dr){console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.");return}if(G){for(let oe=0;oe<G.length;oe++)if(G[oe].isOutputPass===!0){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}}V.setEffects(G||[])},this.getCurrentViewport=function(G){return G.copy(Y)},this.getViewport=function(G){return G.copy(pe)},this.setViewport=function(G,oe,be,_e){G.isVector4?pe.set(G.x,G.y,G.z,G.w):pe.set(G,oe,be,_e),ht.viewport(Y.copy(pe).multiplyScalar(Me).round())},this.getScissor=function(G){return G.copy(Re)},this.setScissor=function(G,oe,be,_e){G.isVector4?Re.set(G.x,G.y,G.z,G.w):Re.set(G,oe,be,_e),ht.scissor(ne.copy(Re).multiplyScalar(Me).round())},this.getScissorTest=function(){return it},this.setScissorTest=function(G){ht.setScissorTest(it=G)},this.setOpaqueSort=function(G){Ue=G},this.setTransparentSort=function(G){lt=G},this.getClearColor=function(G){return G.copy(Se.getClearColor())},this.setClearColor=function(){Se.setClearColor(...arguments)},this.getClearAlpha=function(){return Se.getClearAlpha()},this.setClearAlpha=function(){Se.setClearAlpha(...arguments)},this.clear=function(G=!0,oe=!0,be=!0){let _e=0;if(G){let me=!1;if(J!==null){const et=J.texture.format;me=A.has(et)}if(me){const et=J.texture.type,mt=E.has(et),tt=Se.getClearColor(),It=Se.getClearAlpha(),Et=tt.r,jt=tt.g,At=tt.b;mt?(N[0]=Et,N[1]=jt,N[2]=At,N[3]=It,$.clearBufferuiv($.COLOR,0,N)):(I[0]=Et,I[1]=jt,I[2]=At,I[3]=It,$.clearBufferiv($.COLOR,0,I))}else _e|=$.COLOR_BUFFER_BIT}oe&&(_e|=$.DEPTH_BUFFER_BIT),be&&(_e|=$.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),$.clear(_e)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",qt,!1),t.removeEventListener("webglcontextrestored",un,!1),t.removeEventListener("webglcontextcreationerror",dn,!1),Se.dispose(),Ce.dispose(),Fe.dispose(),F.dispose(),ze.dispose(),Ye.dispose(),yt.dispose(),Ct.dispose(),ct.dispose(),kt.dispose(),gt.dispose(),gt.removeEventListener("sessionstart",Ir),gt.removeEventListener("sessionend",us),en.stop()};function qt(G){G.preventDefault(),Pm("WebGLRenderer: Context Lost."),B=!0}function un(){Pm("WebGLRenderer: Context Restored."),B=!1;const G=K.autoReset,oe=ee.enabled,be=ee.autoUpdate,_e=ee.needsUpdate,me=ee.type;Qe(),K.autoReset=G,ee.enabled=oe,ee.autoUpdate=be,ee.needsUpdate=_e,ee.type=me}function dn(G){Qt("WebGLRenderer: A WebGL context could not be created. Reason: ",G.statusMessage)}function ci(G){const oe=G.target;oe.removeEventListener("dispose",ci),Pi(oe)}function Pi(G){fa(G),F.remove(G)}function fa(G){const oe=F.get(G).programs;oe!==void 0&&(oe.forEach(function(be){kt.releaseProgram(be)}),G.isShaderMaterial&&kt.releaseShaderCache(G))}this.renderBufferDirect=function(G,oe,be,_e,me,et){oe===null&&(oe=Xe);const mt=me.isMesh&&me.matrixWorld.determinant()<0,tt=pt(G,oe,be,_e,me);ht.setMaterial(_e,mt);let It=be.index,Et=1;if(_e.wireframe===!0){if(It=Dt.getWireframeAttribute(be),It===void 0)return;Et=2}const jt=be.drawRange,At=be.attributes.position;let Gt=jt.start*Et,fn=(jt.start+jt.count)*Et;et!==null&&(Gt=Math.max(Gt,et.start*Et),fn=Math.min(fn,(et.start+et.count)*Et)),It!==null?(Gt=Math.max(Gt,0),fn=Math.min(fn,It.count)):At!=null&&(Gt=Math.max(Gt,0),fn=Math.min(fn,At.count));const jn=fn-Gt;if(jn<0||jn===1/0)return;Ct.setup(me,_e,tt,be,It);let xn,Vt=ue;if(It!==null&&(xn=Be.get(It),Vt=we,Vt.setIndex(xn)),me.isMesh)_e.wireframe===!0?(ht.setLineWidth(_e.wireframeLinewidth*ot()),Vt.setMode($.LINES)):Vt.setMode($.TRIANGLES);else if(me.isLine){let bt=_e.linewidth;bt===void 0&&(bt=1),ht.setLineWidth(bt*ot()),me.isLineSegments?Vt.setMode($.LINES):me.isLineLoop?Vt.setMode($.LINE_LOOP):Vt.setMode($.LINE_STRIP)}else me.isPoints?Vt.setMode($.POINTS):me.isSprite&&Vt.setMode($.TRIANGLES);if(me.isBatchedMesh)if(me._multiDrawInstances!==null)ud("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Vt.renderMultiDrawInstances(me._multiDrawStarts,me._multiDrawCounts,me._multiDrawCount,me._multiDrawInstances);else if(St.get("WEBGL_multi_draw"))Vt.renderMultiDraw(me._multiDrawStarts,me._multiDrawCounts,me._multiDrawCount);else{const bt=me._multiDrawStarts,Yt=me._multiDrawCounts,Ot=me._multiDrawCount,Vn=It?Be.get(It).bytesPerElement:1,Ji=F.get(_e).currentProgram.getUniforms();for(let Tn=0;Tn<Ot;Tn++)Ji.setValue($,"_gl_DrawID",Tn),Vt.render(bt[Tn]/Vn,Yt[Tn])}else if(me.isInstancedMesh)Vt.renderInstances(Gt,jn,me.count);else if(be.isInstancedBufferGeometry){const bt=be._maxInstanceCount!==void 0?be._maxInstanceCount:1/0,Yt=Math.min(be.instanceCount,bt);Vt.renderInstances(Gt,jn,Yt)}else Vt.render(Gt,jn)};function ha(G,oe,be){G.transparent===!0&&G.side===Ii&&G.forceSinglePass===!1?(G.side=ss,G.needsUpdate=!0,Ne(G,oe,be),G.side=Hl,G.needsUpdate=!0,Ne(G,oe,be),G.side=Ii):Ne(G,oe,be)}this.compile=function(G,oe,be=null){be===null&&(be=G),z=Fe.get(be),z.init(oe),H.push(z),be.traverseVisible(function(me){me.isLight&&me.layers.test(oe.layers)&&(z.pushLight(me),me.castShadow&&z.pushShadow(me))}),G!==be&&G.traverseVisible(function(me){me.isLight&&me.layers.test(oe.layers)&&(z.pushLight(me),me.castShadow&&z.pushShadow(me))}),z.setupLights();const _e=new Set;return G.traverse(function(me){if(!(me.isMesh||me.isPoints||me.isLine||me.isSprite))return;const et=me.material;if(et)if(Array.isArray(et))for(let mt=0;mt<et.length;mt++){const tt=et[mt];ha(tt,be,me),_e.add(tt)}else ha(et,be,me),_e.add(et)}),z=H.pop(),_e},this.compileAsync=function(G,oe,be=null){const _e=this.compile(G,oe,be);return new Promise(me=>{function et(){if(_e.forEach(function(mt){F.get(mt).currentProgram.isReady()&&_e.delete(mt)}),_e.size===0){me(G);return}setTimeout(et,10)}St.get("KHR_parallel_shader_compile")!==null?et():setTimeout(et,10)})};let Cs=null;function da(G){Cs&&Cs(G)}function Ir(){en.stop()}function us(){en.start()}const en=new Fw;en.setAnimationLoop(da),typeof self<"u"&&en.setContext(self),this.setAnimationLoop=function(G){Cs=G,gt.setAnimationLoop(G),G===null?en.stop():en.start()},gt.addEventListener("sessionstart",Ir),gt.addEventListener("sessionend",us),this.render=function(G,oe){if(oe!==void 0&&oe.isCamera!==!0){Qt("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(B===!0)return;const be=gt.enabled===!0&&gt.isPresenting===!0,_e=V!==null&&(J===null||be)&&V.begin(L,J);if(G.matrixWorldAutoUpdate===!0&&G.updateMatrixWorld(),oe.parent===null&&oe.matrixWorldAutoUpdate===!0&&oe.updateMatrixWorld(),gt.enabled===!0&&gt.isPresenting===!0&&(V===null||V.isCompositing()===!1)&&(gt.cameraAutoUpdate===!0&&gt.updateCamera(oe),oe=gt.getCamera()),G.isScene===!0&&G.onBeforeRender(L,G,oe,J),z=Fe.get(G,H.length),z.init(oe),H.push(z),xe.multiplyMatrices(oe.projectionMatrix,oe.matrixWorldInverse),xt.setFromProjectionMatrix(xe,aa,oe.reversedDepth),Ut=this.localClippingEnabled,dt=Ze.init(this.clippingPlanes,Ut),P=Ce.get(G,U.length),P.init(),U.push(P),gt.enabled===!0&&gt.isPresenting===!0){const mt=L.xr.getDepthSensingMesh();mt!==null&&Tr(mt,oe,-1/0,L.sortObjects)}Tr(G,oe,0,L.sortObjects),P.finish(),L.sortObjects===!0&&P.sort(Ue,lt),qe=gt.enabled===!1||gt.isPresenting===!1||gt.hasDepthSensing()===!1,qe&&Se.addToRenderList(P,G),this.info.render.frame++,dt===!0&&Ze.beginShadows();const me=z.state.shadowsArray;if(ee.render(me,G,oe),dt===!0&&Ze.endShadows(),this.info.autoReset===!0&&this.info.reset(),(_e&&V.hasRenderPass())===!1){const mt=P.opaque,tt=P.transmissive;if(z.setupLights(),oe.isArrayCamera){const It=oe.cameras;if(tt.length>0)for(let Et=0,jt=It.length;Et<jt;Et++){const At=It[Et];k(mt,tt,G,At)}qe&&Se.render(G);for(let Et=0,jt=It.length;Et<jt;Et++){const At=It[Et];ui(P,G,At,At.viewport)}}else tt.length>0&&k(mt,tt,G,oe),qe&&Se.render(G),ui(P,G,oe)}J!==null&&ie===0&&(ge.updateMultisampleRenderTarget(J),ge.updateRenderTargetMipmap(J)),_e&&V.end(L),G.isScene===!0&&G.onAfterRender(L,G,oe),Ct.resetDefaultState(),se=-1,ce=null,H.pop(),H.length>0?(z=H[H.length-1],dt===!0&&Ze.setGlobalState(L.clippingPlanes,z.state.camera)):z=null,U.pop(),U.length>0?P=U[U.length-1]:P=null};function Tr(G,oe,be,_e){if(G.visible===!1)return;if(G.layers.test(oe.layers)){if(G.isGroup)be=G.renderOrder;else if(G.isLOD)G.autoUpdate===!0&&G.update(oe);else if(G.isLight)z.pushLight(G),G.castShadow&&z.pushShadow(G);else if(G.isSprite){if(!G.frustumCulled||xt.intersectsSprite(G)){_e&&Le.setFromMatrixPosition(G.matrixWorld).applyMatrix4(xe);const mt=yt.update(G),tt=G.material;tt.visible&&P.push(G,mt,tt,be,Le.z,null)}}else if((G.isMesh||G.isLine||G.isPoints)&&(!G.frustumCulled||xt.intersectsObject(G))){const mt=yt.update(G),tt=G.material;if(_e&&(G.boundingSphere!==void 0?(G.boundingSphere===null&&G.computeBoundingSphere(),Le.copy(G.boundingSphere.center)):(mt.boundingSphere===null&&mt.computeBoundingSphere(),Le.copy(mt.boundingSphere.center)),Le.applyMatrix4(G.matrixWorld).applyMatrix4(xe)),Array.isArray(tt)){const It=mt.groups;for(let Et=0,jt=It.length;Et<jt;Et++){const At=It[Et],Gt=tt[At.materialIndex];Gt&&Gt.visible&&P.push(G,mt,Gt,be,Le.z,At)}}else tt.visible&&P.push(G,mt,tt,be,Le.z,null)}}const et=G.children;for(let mt=0,tt=et.length;mt<tt;mt++)Tr(et[mt],oe,be,_e)}function ui(G,oe,be,_e){const{opaque:me,transmissive:et,transparent:mt}=G;z.setupLightsView(be),dt===!0&&Ze.setGlobalState(L.clippingPlanes,be),_e&&ht.viewport(Y.copy(_e)),me.length>0&&Z(me,oe,be),et.length>0&&Z(et,oe,be),mt.length>0&&Z(mt,oe,be),ht.buffers.depth.setTest(!0),ht.buffers.depth.setMask(!0),ht.buffers.color.setMask(!0),ht.setPolygonOffset(!1)}function k(G,oe,be,_e){if((be.isScene===!0?be.overrideMaterial:null)!==null)return;if(z.state.transmissionRenderTarget[_e.id]===void 0){const Gt=St.has("EXT_color_buffer_half_float")||St.has("EXT_color_buffer_float");z.state.transmissionRenderTarget[_e.id]=new Ts(1,1,{generateMipmaps:!0,type:Gt?Qi:Dr,minFilter:Qo,samples:Ft.samples,stencilBuffer:o,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:kn.workingColorSpace})}const et=z.state.transmissionRenderTarget[_e.id],mt=_e.viewport||Y;et.setSize(mt.z*L.transmissionResolutionScale,mt.w*L.transmissionResolutionScale);const tt=L.getRenderTarget(),It=L.getActiveCubeFace(),Et=L.getActiveMipmapLevel();L.setRenderTarget(et),L.getClearColor(ae),re=L.getClearAlpha(),re<1&&L.setClearColor(16777215,.5),L.clear(),qe&&Se.render(be);const jt=L.toneMapping;L.toneMapping=ka;const At=_e.viewport;if(_e.viewport!==void 0&&(_e.viewport=void 0),z.setupLightsView(_e),dt===!0&&Ze.setGlobalState(L.clippingPlanes,_e),Z(G,be,_e),ge.updateMultisampleRenderTarget(et),ge.updateRenderTargetMipmap(et),St.has("WEBGL_multisampled_render_to_texture")===!1){let Gt=!1;for(let fn=0,jn=oe.length;fn<jn;fn++){const xn=oe[fn],{object:Vt,geometry:bt,material:Yt,group:Ot}=xn;if(Yt.side===Ii&&Vt.layers.test(_e.layers)){const Vn=Yt.side;Yt.side=ss,Yt.needsUpdate=!0,he(Vt,be,_e,bt,Yt,Ot),Yt.side=Vn,Yt.needsUpdate=!0,Gt=!0}}Gt===!0&&(ge.updateMultisampleRenderTarget(et),ge.updateRenderTargetMipmap(et))}L.setRenderTarget(tt,It,Et),L.setClearColor(ae,re),At!==void 0&&(_e.viewport=At),L.toneMapping=jt}function Z(G,oe,be){const _e=oe.isScene===!0?oe.overrideMaterial:null;for(let me=0,et=G.length;me<et;me++){const mt=G[me],{object:tt,geometry:It,group:Et}=mt;let jt=mt.material;jt.allowOverride===!0&&_e!==null&&(jt=_e),tt.layers.test(be.layers)&&he(tt,oe,be,It,jt,Et)}}function he(G,oe,be,_e,me,et){G.onBeforeRender(L,oe,be,_e,me,et),G.modelViewMatrix.multiplyMatrices(be.matrixWorldInverse,G.matrixWorld),G.normalMatrix.getNormalMatrix(G.modelViewMatrix),me.onBeforeRender(L,oe,be,_e,G,et),me.transparent===!0&&me.side===Ii&&me.forceSinglePass===!1?(me.side=ss,me.needsUpdate=!0,L.renderBufferDirect(be,oe,_e,me,G,et),me.side=Hl,me.needsUpdate=!0,L.renderBufferDirect(be,oe,_e,me,G,et),me.side=Ii):L.renderBufferDirect(be,oe,_e,me,G,et),G.onAfterRender(L,oe,be,_e,me,et)}function Ne(G,oe,be){oe.isScene!==!0&&(oe=Xe);const _e=F.get(G),me=z.state.lights,et=z.state.shadowsArray,mt=me.state.version,tt=kt.getParameters(G,me.state,et,oe,be),It=kt.getProgramCacheKey(tt);let Et=_e.programs;_e.environment=G.isMeshStandardMaterial?oe.environment:null,_e.fog=oe.fog,_e.envMap=(G.isMeshStandardMaterial?Ye:ze).get(G.envMap||_e.environment),_e.envMapRotation=_e.environment!==null&&G.envMap===null?oe.environmentRotation:G.envMapRotation,Et===void 0&&(G.addEventListener("dispose",ci),Et=new Map,_e.programs=Et);let jt=Et.get(It);if(jt!==void 0){if(_e.currentProgram===jt&&_e.lightsStateVersion===mt)return We(G,tt),jt}else tt.uniforms=kt.getUniforms(G),G.onBeforeCompile(tt,L),jt=kt.acquireProgram(tt,It),Et.set(It,jt),_e.uniforms=tt.uniforms;const At=_e.uniforms;return(!G.isShaderMaterial&&!G.isRawShaderMaterial||G.clipping===!0)&&(At.clippingPlanes=Ze.uniform),We(G,tt),_e.needsLights=Tt(G),_e.lightsStateVersion=mt,_e.needsLights&&(At.ambientLightColor.value=me.state.ambient,At.lightProbe.value=me.state.probe,At.directionalLights.value=me.state.directional,At.directionalLightShadows.value=me.state.directionalShadow,At.spotLights.value=me.state.spot,At.spotLightShadows.value=me.state.spotShadow,At.rectAreaLights.value=me.state.rectArea,At.ltc_1.value=me.state.rectAreaLTC1,At.ltc_2.value=me.state.rectAreaLTC2,At.pointLights.value=me.state.point,At.pointLightShadows.value=me.state.pointShadow,At.hemisphereLights.value=me.state.hemi,At.directionalShadowMap.value=me.state.directionalShadowMap,At.directionalShadowMatrix.value=me.state.directionalShadowMatrix,At.spotShadowMap.value=me.state.spotShadowMap,At.spotLightMatrix.value=me.state.spotLightMatrix,At.spotLightMap.value=me.state.spotLightMap,At.pointShadowMap.value=me.state.pointShadowMap,At.pointShadowMatrix.value=me.state.pointShadowMatrix),_e.currentProgram=jt,_e.uniformsList=null,jt}function Ge(G){if(G.uniformsList===null){const oe=G.currentProgram.getUniforms();G.uniformsList=Vv.seqWithValue(oe.seq,G.uniforms)}return G.uniformsList}function We(G,oe){const be=F.get(G);be.outputColorSpace=oe.outputColorSpace,be.batching=oe.batching,be.batchingColor=oe.batchingColor,be.instancing=oe.instancing,be.instancingColor=oe.instancingColor,be.instancingMorph=oe.instancingMorph,be.skinning=oe.skinning,be.morphTargets=oe.morphTargets,be.morphNormals=oe.morphNormals,be.morphColors=oe.morphColors,be.morphTargetsCount=oe.morphTargetsCount,be.numClippingPlanes=oe.numClippingPlanes,be.numIntersection=oe.numClipIntersection,be.vertexAlphas=oe.vertexAlphas,be.vertexTangents=oe.vertexTangents,be.toneMapping=oe.toneMapping}function pt(G,oe,be,_e,me){oe.isScene!==!0&&(oe=Xe),ge.resetTextureUnits();const et=oe.fog,mt=_e.isMeshStandardMaterial?oe.environment:null,tt=J===null?L.outputColorSpace:J.isXRRenderTarget===!0?J.texture.colorSpace:vo,It=(_e.isMeshStandardMaterial?Ye:ze).get(_e.envMap||mt),Et=_e.vertexColors===!0&&!!be.attributes.color&&be.attributes.color.itemSize===4,jt=!!be.attributes.tangent&&(!!_e.normalMap||_e.anisotropy>0),At=!!be.morphAttributes.position,Gt=!!be.morphAttributes.normal,fn=!!be.morphAttributes.color;let jn=ka;_e.toneMapped&&(J===null||J.isXRRenderTarget===!0)&&(jn=L.toneMapping);const xn=be.morphAttributes.position||be.morphAttributes.normal||be.morphAttributes.color,Vt=xn!==void 0?xn.length:0,bt=F.get(_e),Yt=z.state.lights;if(dt===!0&&(Ut===!0||G!==ce)){const lr=G===ce&&_e.id===se;Ze.setState(_e,G,lr)}let Ot=!1;_e.version===bt.__version?(bt.needsLights&&bt.lightsStateVersion!==Yt.state.version||bt.outputColorSpace!==tt||me.isBatchedMesh&&bt.batching===!1||!me.isBatchedMesh&&bt.batching===!0||me.isBatchedMesh&&bt.batchingColor===!0&&me.colorTexture===null||me.isBatchedMesh&&bt.batchingColor===!1&&me.colorTexture!==null||me.isInstancedMesh&&bt.instancing===!1||!me.isInstancedMesh&&bt.instancing===!0||me.isSkinnedMesh&&bt.skinning===!1||!me.isSkinnedMesh&&bt.skinning===!0||me.isInstancedMesh&&bt.instancingColor===!0&&me.instanceColor===null||me.isInstancedMesh&&bt.instancingColor===!1&&me.instanceColor!==null||me.isInstancedMesh&&bt.instancingMorph===!0&&me.morphTexture===null||me.isInstancedMesh&&bt.instancingMorph===!1&&me.morphTexture!==null||bt.envMap!==It||_e.fog===!0&&bt.fog!==et||bt.numClippingPlanes!==void 0&&(bt.numClippingPlanes!==Ze.numPlanes||bt.numIntersection!==Ze.numIntersection)||bt.vertexAlphas!==Et||bt.vertexTangents!==jt||bt.morphTargets!==At||bt.morphNormals!==Gt||bt.morphColors!==fn||bt.toneMapping!==jn||bt.morphTargetsCount!==Vt)&&(Ot=!0):(Ot=!0,bt.__version=_e.version);let Vn=bt.currentProgram;Ot===!0&&(Vn=Ne(_e,oe,me));let Ji=!1,Tn=!1,di=!1;const Xn=Vn.getUniforms(),$i=bt.uniforms;if(ht.useProgram(Vn.program)&&(Ji=!0,Tn=!0,di=!0),_e.id!==se&&(se=_e.id,Tn=!0),Ji||ce!==G){ht.buffers.depth.getReversed()&&G.reversedDepth!==!0&&(G._reversedDepth=!0,G.updateProjectionMatrix()),Xn.setValue($,"projectionMatrix",G.projectionMatrix),Xn.setValue($,"viewMatrix",G.matrixWorldInverse);const cr=Xn.map.cameraPosition;cr!==void 0&&cr.setValue($,rt.setFromMatrixPosition(G.matrixWorld)),Ft.logarithmicDepthBuffer&&Xn.setValue($,"logDepthBufFC",2/(Math.log(G.far+1)/Math.LN2)),(_e.isMeshPhongMaterial||_e.isMeshToonMaterial||_e.isMeshLambertMaterial||_e.isMeshBasicMaterial||_e.isMeshStandardMaterial||_e.isShaderMaterial)&&Xn.setValue($,"isOrthographic",G.isOrthographicCamera===!0),ce!==G&&(ce=G,Tn=!0,di=!0)}if(bt.needsLights&&(Yt.state.directionalShadowMap.length>0&&Xn.setValue($,"directionalShadowMap",Yt.state.directionalShadowMap,ge),Yt.state.spotShadowMap.length>0&&Xn.setValue($,"spotShadowMap",Yt.state.spotShadowMap,ge),Yt.state.pointShadowMap.length>0&&Xn.setValue($,"pointShadowMap",Yt.state.pointShadowMap,ge)),me.isSkinnedMesh){Xn.setOptional($,me,"bindMatrix"),Xn.setOptional($,me,"bindMatrixInverse");const lr=me.skeleton;lr&&(lr.boneTexture===null&&lr.computeBoneTexture(),Xn.setValue($,"boneTexture",lr.boneTexture,ge))}me.isBatchedMesh&&(Xn.setOptional($,me,"batchingTexture"),Xn.setValue($,"batchingTexture",me._matricesTexture,ge),Xn.setOptional($,me,"batchingIdTexture"),Xn.setValue($,"batchingIdTexture",me._indirectTexture,ge),Xn.setOptional($,me,"batchingColorTexture"),me._colorsTexture!==null&&Xn.setValue($,"batchingColorTexture",me._colorsTexture,ge));const ji=be.morphAttributes;if((ji.position!==void 0||ji.normal!==void 0||ji.color!==void 0)&&$e.update(me,be,Vn),(Tn||bt.receiveShadow!==me.receiveShadow)&&(bt.receiveShadow=me.receiveShadow,Xn.setValue($,"receiveShadow",me.receiveShadow)),_e.isMeshGouraudMaterial&&_e.envMap!==null&&($i.envMap.value=It,$i.flipEnvMap.value=It.isCubeTexture&&It.isRenderTargetTexture===!1?-1:1),_e.isMeshStandardMaterial&&_e.envMap===null&&oe.environment!==null&&($i.envMapIntensity.value=oe.environmentIntensity),$i.dfgLUT!==void 0&&($i.dfgLUT.value=WP()),Tn&&(Xn.setValue($,"toneMappingExposure",L.toneMappingExposure),bt.needsLights&&ut($i,di),et&&_e.fog===!0&&ke.refreshFogUniforms($i,et),ke.refreshMaterialUniforms($i,_e,Me,le,z.state.transmissionRenderTarget[G.id]),Vv.upload($,Ge(bt),$i,ge)),_e.isShaderMaterial&&_e.uniformsNeedUpdate===!0&&(Vv.upload($,Ge(bt),$i,ge),_e.uniformsNeedUpdate=!1),_e.isSpriteMaterial&&Xn.setValue($,"center",me.center),Xn.setValue($,"modelViewMatrix",me.modelViewMatrix),Xn.setValue($,"normalMatrix",me.normalMatrix),Xn.setValue($,"modelMatrix",me.matrixWorld),_e.isShaderMaterial||_e.isRawShaderMaterial){const lr=_e.uniformsGroups;for(let cr=0,nl=lr.length;cr<nl;cr++){const Rs=lr[cr];ct.update(Rs,Vn),ct.bind(Rs,Vn)}}return Vn}function ut(G,oe){G.ambientLightColor.needsUpdate=oe,G.lightProbe.needsUpdate=oe,G.directionalLights.needsUpdate=oe,G.directionalLightShadows.needsUpdate=oe,G.pointLights.needsUpdate=oe,G.pointLightShadows.needsUpdate=oe,G.spotLights.needsUpdate=oe,G.spotLightShadows.needsUpdate=oe,G.rectAreaLights.needsUpdate=oe,G.hemisphereLights.needsUpdate=oe}function Tt(G){return G.isMeshLambertMaterial||G.isMeshToonMaterial||G.isMeshPhongMaterial||G.isMeshStandardMaterial||G.isShadowMaterial||G.isShaderMaterial&&G.lights===!0}this.getActiveCubeFace=function(){return W},this.getActiveMipmapLevel=function(){return ie},this.getRenderTarget=function(){return J},this.setRenderTargetTextures=function(G,oe,be){const _e=F.get(G);_e.__autoAllocateDepthBuffer=G.resolveDepthBuffer===!1,_e.__autoAllocateDepthBuffer===!1&&(_e.__useRenderToTexture=!1),F.get(G.texture).__webglTexture=oe,F.get(G.depthTexture).__webglTexture=_e.__autoAllocateDepthBuffer?void 0:be,_e.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(G,oe){const be=F.get(G);be.__webglFramebuffer=oe,be.__useDefaultFramebuffer=oe===void 0};const Mt=$.createFramebuffer();this.setRenderTarget=function(G,oe=0,be=0){J=G,W=oe,ie=be;let _e=null,me=!1,et=!1;if(G){const tt=F.get(G);if(tt.__useDefaultFramebuffer!==void 0){ht.bindFramebuffer($.FRAMEBUFFER,tt.__webglFramebuffer),Y.copy(G.viewport),ne.copy(G.scissor),ve=G.scissorTest,ht.viewport(Y),ht.scissor(ne),ht.setScissorTest(ve),se=-1;return}else if(tt.__webglFramebuffer===void 0)ge.setupRenderTarget(G);else if(tt.__hasExternalTextures)ge.rebindTextures(G,F.get(G.texture).__webglTexture,F.get(G.depthTexture).__webglTexture);else if(G.depthBuffer){const jt=G.depthTexture;if(tt.__boundDepthTexture!==jt){if(jt!==null&&F.has(jt)&&(G.width!==jt.image.width||G.height!==jt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");ge.setupDepthRenderbuffer(G)}}const It=G.texture;(It.isData3DTexture||It.isDataArrayTexture||It.isCompressedArrayTexture)&&(et=!0);const Et=F.get(G).__webglFramebuffer;G.isWebGLCubeRenderTarget?(Array.isArray(Et[oe])?_e=Et[oe][be]:_e=Et[oe],me=!0):G.samples>0&&ge.useMultisampledRTT(G)===!1?_e=F.get(G).__webglMultisampledFramebuffer:Array.isArray(Et)?_e=Et[be]:_e=Et,Y.copy(G.viewport),ne.copy(G.scissor),ve=G.scissorTest}else Y.copy(pe).multiplyScalar(Me).floor(),ne.copy(Re).multiplyScalar(Me).floor(),ve=it;if(be!==0&&(_e=Mt),ht.bindFramebuffer($.FRAMEBUFFER,_e)&&ht.drawBuffers(G,_e),ht.viewport(Y),ht.scissor(ne),ht.setScissorTest(ve),me){const tt=F.get(G.texture);$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,$.TEXTURE_CUBE_MAP_POSITIVE_X+oe,tt.__webglTexture,be)}else if(et){const tt=oe;for(let It=0;It<G.textures.length;It++){const Et=F.get(G.textures[It]);$.framebufferTextureLayer($.FRAMEBUFFER,$.COLOR_ATTACHMENT0+It,Et.__webglTexture,be,tt)}}else if(G!==null&&be!==0){const tt=F.get(G.texture);$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,$.TEXTURE_2D,tt.__webglTexture,be)}se=-1},this.readRenderTargetPixels=function(G,oe,be,_e,me,et,mt,tt=0){if(!(G&&G.isWebGLRenderTarget)){Qt("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let It=F.get(G).__webglFramebuffer;if(G.isWebGLCubeRenderTarget&&mt!==void 0&&(It=It[mt]),It){ht.bindFramebuffer($.FRAMEBUFFER,It);try{const Et=G.textures[tt],jt=Et.format,At=Et.type;if(!Ft.textureFormatReadable(jt)){Qt("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Ft.textureTypeReadable(At)){Qt("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}oe>=0&&oe<=G.width-_e&&be>=0&&be<=G.height-me&&(G.textures.length>1&&$.readBuffer($.COLOR_ATTACHMENT0+tt),$.readPixels(oe,be,_e,me,at.convert(jt),at.convert(At),et))}finally{const Et=J!==null?F.get(J).__webglFramebuffer:null;ht.bindFramebuffer($.FRAMEBUFFER,Et)}}},this.readRenderTargetPixelsAsync=async function(G,oe,be,_e,me,et,mt,tt=0){if(!(G&&G.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let It=F.get(G).__webglFramebuffer;if(G.isWebGLCubeRenderTarget&&mt!==void 0&&(It=It[mt]),It)if(oe>=0&&oe<=G.width-_e&&be>=0&&be<=G.height-me){ht.bindFramebuffer($.FRAMEBUFFER,It);const Et=G.textures[tt],jt=Et.format,At=Et.type;if(!Ft.textureFormatReadable(jt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Ft.textureTypeReadable(At))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Gt=$.createBuffer();$.bindBuffer($.PIXEL_PACK_BUFFER,Gt),$.bufferData($.PIXEL_PACK_BUFFER,et.byteLength,$.STREAM_READ),G.textures.length>1&&$.readBuffer($.COLOR_ATTACHMENT0+tt),$.readPixels(oe,be,_e,me,at.convert(jt),at.convert(At),0);const fn=J!==null?F.get(J).__webglFramebuffer:null;ht.bindFramebuffer($.FRAMEBUFFER,fn);const jn=$.fenceSync($.SYNC_GPU_COMMANDS_COMPLETE,0);return $.flush(),await rC($,jn,4),$.bindBuffer($.PIXEL_PACK_BUFFER,Gt),$.getBufferSubData($.PIXEL_PACK_BUFFER,0,et),$.deleteBuffer(Gt),$.deleteSync(jn),et}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(G,oe=null,be=0){const _e=Math.pow(2,-be),me=Math.floor(G.image.width*_e),et=Math.floor(G.image.height*_e),mt=oe!==null?oe.x:0,tt=oe!==null?oe.y:0;ge.setTexture2D(G,0),$.copyTexSubImage2D($.TEXTURE_2D,be,0,0,mt,tt,me,et),ht.unbindTexture()};const Rt=$.createFramebuffer(),_t=$.createFramebuffer();this.copyTextureToTexture=function(G,oe,be=null,_e=null,me=0,et=null){et===null&&(me!==0?(ud("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),et=me,me=0):et=0);let mt,tt,It,Et,jt,At,Gt,fn,jn;const xn=G.isCompressedTexture?G.mipmaps[et]:G.image;if(be!==null)mt=be.max.x-be.min.x,tt=be.max.y-be.min.y,It=be.isBox3?be.max.z-be.min.z:1,Et=be.min.x,jt=be.min.y,At=be.isBox3?be.min.z:0;else{const ji=Math.pow(2,-me);mt=Math.floor(xn.width*ji),tt=Math.floor(xn.height*ji),G.isDataArrayTexture?It=xn.depth:G.isData3DTexture?It=Math.floor(xn.depth*ji):It=1,Et=0,jt=0,At=0}_e!==null?(Gt=_e.x,fn=_e.y,jn=_e.z):(Gt=0,fn=0,jn=0);const Vt=at.convert(oe.format),bt=at.convert(oe.type);let Yt;oe.isData3DTexture?(ge.setTexture3D(oe,0),Yt=$.TEXTURE_3D):oe.isDataArrayTexture||oe.isCompressedArrayTexture?(ge.setTexture2DArray(oe,0),Yt=$.TEXTURE_2D_ARRAY):(ge.setTexture2D(oe,0),Yt=$.TEXTURE_2D),$.pixelStorei($.UNPACK_FLIP_Y_WEBGL,oe.flipY),$.pixelStorei($.UNPACK_PREMULTIPLY_ALPHA_WEBGL,oe.premultiplyAlpha),$.pixelStorei($.UNPACK_ALIGNMENT,oe.unpackAlignment);const Ot=$.getParameter($.UNPACK_ROW_LENGTH),Vn=$.getParameter($.UNPACK_IMAGE_HEIGHT),Ji=$.getParameter($.UNPACK_SKIP_PIXELS),Tn=$.getParameter($.UNPACK_SKIP_ROWS),di=$.getParameter($.UNPACK_SKIP_IMAGES);$.pixelStorei($.UNPACK_ROW_LENGTH,xn.width),$.pixelStorei($.UNPACK_IMAGE_HEIGHT,xn.height),$.pixelStorei($.UNPACK_SKIP_PIXELS,Et),$.pixelStorei($.UNPACK_SKIP_ROWS,jt),$.pixelStorei($.UNPACK_SKIP_IMAGES,At);const Xn=G.isDataArrayTexture||G.isData3DTexture,$i=oe.isDataArrayTexture||oe.isData3DTexture;if(G.isDepthTexture){const ji=F.get(G),lr=F.get(oe),cr=F.get(ji.__renderTarget),nl=F.get(lr.__renderTarget);ht.bindFramebuffer($.READ_FRAMEBUFFER,cr.__webglFramebuffer),ht.bindFramebuffer($.DRAW_FRAMEBUFFER,nl.__webglFramebuffer);for(let Rs=0;Rs<It;Rs++)Xn&&($.framebufferTextureLayer($.READ_FRAMEBUFFER,$.COLOR_ATTACHMENT0,F.get(G).__webglTexture,me,At+Rs),$.framebufferTextureLayer($.DRAW_FRAMEBUFFER,$.COLOR_ATTACHMENT0,F.get(oe).__webglTexture,et,jn+Rs)),$.blitFramebuffer(Et,jt,mt,tt,Gt,fn,mt,tt,$.DEPTH_BUFFER_BIT,$.NEAREST);ht.bindFramebuffer($.READ_FRAMEBUFFER,null),ht.bindFramebuffer($.DRAW_FRAMEBUFFER,null)}else if(me!==0||G.isRenderTargetTexture||F.has(G)){const ji=F.get(G),lr=F.get(oe);ht.bindFramebuffer($.READ_FRAMEBUFFER,Rt),ht.bindFramebuffer($.DRAW_FRAMEBUFFER,_t);for(let cr=0;cr<It;cr++)Xn?$.framebufferTextureLayer($.READ_FRAMEBUFFER,$.COLOR_ATTACHMENT0,ji.__webglTexture,me,At+cr):$.framebufferTexture2D($.READ_FRAMEBUFFER,$.COLOR_ATTACHMENT0,$.TEXTURE_2D,ji.__webglTexture,me),$i?$.framebufferTextureLayer($.DRAW_FRAMEBUFFER,$.COLOR_ATTACHMENT0,lr.__webglTexture,et,jn+cr):$.framebufferTexture2D($.DRAW_FRAMEBUFFER,$.COLOR_ATTACHMENT0,$.TEXTURE_2D,lr.__webglTexture,et),me!==0?$.blitFramebuffer(Et,jt,mt,tt,Gt,fn,mt,tt,$.COLOR_BUFFER_BIT,$.NEAREST):$i?$.copyTexSubImage3D(Yt,et,Gt,fn,jn+cr,Et,jt,mt,tt):$.copyTexSubImage2D(Yt,et,Gt,fn,Et,jt,mt,tt);ht.bindFramebuffer($.READ_FRAMEBUFFER,null),ht.bindFramebuffer($.DRAW_FRAMEBUFFER,null)}else $i?G.isDataTexture||G.isData3DTexture?$.texSubImage3D(Yt,et,Gt,fn,jn,mt,tt,It,Vt,bt,xn.data):oe.isCompressedArrayTexture?$.compressedTexSubImage3D(Yt,et,Gt,fn,jn,mt,tt,It,Vt,xn.data):$.texSubImage3D(Yt,et,Gt,fn,jn,mt,tt,It,Vt,bt,xn):G.isDataTexture?$.texSubImage2D($.TEXTURE_2D,et,Gt,fn,mt,tt,Vt,bt,xn.data):G.isCompressedTexture?$.compressedTexSubImage2D($.TEXTURE_2D,et,Gt,fn,xn.width,xn.height,Vt,xn.data):$.texSubImage2D($.TEXTURE_2D,et,Gt,fn,mt,tt,Vt,bt,xn);$.pixelStorei($.UNPACK_ROW_LENGTH,Ot),$.pixelStorei($.UNPACK_IMAGE_HEIGHT,Vn),$.pixelStorei($.UNPACK_SKIP_PIXELS,Ji),$.pixelStorei($.UNPACK_SKIP_ROWS,Tn),$.pixelStorei($.UNPACK_SKIP_IMAGES,di),et===0&&oe.generateMipmaps&&$.generateMipmap(Yt),ht.unbindTexture()},this.initRenderTarget=function(G){F.get(G).__webglFramebuffer===void 0&&ge.setupRenderTarget(G)},this.initTexture=function(G){G.isCubeTexture?ge.setTextureCube(G,0):G.isData3DTexture?ge.setTexture3D(G,0):G.isDataArrayTexture||G.isCompressedArrayTexture?ge.setTexture2DArray(G,0):ge.setTexture2D(G,0),ht.unbindTexture()},this.resetState=function(){W=0,ie=0,J=null,ht.reset(),Ct.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return aa}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=kn._getDrawingBufferColorSpace(e),t.unpackColorSpace=kn._getUnpackColorSpace()}}const XP=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:Hx,AddEquation:Vc,AddOperation:TT,AdditiveAnimationBlendMode:s1,AdditiveBlending:y_,AgXToneMapping:J_,AlphaFormat:i1,AlwaysCompare:zT,AlwaysDepth:Xv,AlwaysStencilFunc:E_,AmbientLight:Rw,AnimationAction:zw,AnimationClip:km,AnimationLoader:XR,AnimationMixer:yN,AnimationObjectGroup:vN,AnimationUtils:HR,ArcCurve:nw,ArrayCamera:Pw,ArrowHelper:jN,AttachedBindMode:S_,Audio:Uw,AudioAnalyser:oN,AudioContext:N1,AudioListener:rN,AudioLoader:tN,AxesHelper:WN,BackSide:ss,BasicDepthPacking:NT,BasicShadowMap:sT,BatchedMesh:KT,Bone:h1,BooleanKeyframeTrack:_f,Box2:CN,Box3:os,Box3Helper:HN,BoxGeometry:bf,BoxHelper:VN,BufferAttribute:li,BufferGeometry:vn,BufferGeometryLoader:Lw,ByteType:Gx,Cache:Jo,Camera:ty,CameraHelper:kN,CanvasTexture:fR,CapsuleGeometry:cy,CatmullRomCurve3:iw,CineonToneMapping:K_,CircleGeometry:uy,ClampToEdgeWrapping:Ki,Clock:D1,Color:Lt,ColorKeyframeTrack:w1,ColorManagement:kn,CompressedArrayTexture:cR,CompressedCubeTexture:uR,CompressedTexture:ly,CompressedTextureLoader:qR,ConeGeometry:Jm,ConstantAlphaFactor:ST,ConstantColorFactor:bT,Controls:qN,CubeCamera:jT,CubeDepthTexture:ew,CubeReflectionMapping:go,CubeRefractionMapping:qc,CubeTexture:Zm,CubeTextureLoader:Ew,CubeUVReflectionMapping:bd,CubicBezierCurve:g1,CubicBezierCurve3:rw,CubicInterpolant:bw,CullFaceBack:x_,CullFaceFront:rT,CullFaceFrontBack:m3,CullFaceNone:iT,Curve:xo,CurvePath:aw,CustomBlending:aT,CustomToneMapping:Q_,CylinderGeometry:Qm,Cylindrical:AN,Data3DTexture:ey,DataArrayTexture:$x,DataTexture:Va,DataTextureLoader:A1,DataUtils:of,DecrementStencilOp:I3,DecrementWrapStencilOp:P3,DefaultLoadingManager:Mw,DepthFormat:$o,DepthStencilFormat:Hc,DepthTexture:md,DetachedBindMode:wT,DirectionalLight:Cw,DirectionalLightHelper:FN,DiscreteInterpolant:_w,DodecahedronGeometry:fy,DoubleSide:Ii,DstAlphaFactor:mT,DstColorFactor:vT,DynamicCopyUsage:Z3,DynamicDrawUsage:G3,DynamicReadUsage:X3,EdgesGeometry:tw,EllipseCurve:hy,EqualCompare:PT,EqualDepth:Yv,EqualStencilFunc:B3,EquirectangularReflectionMapping:ad,EquirectangularRefractionMapping:wm,Euler:ua,EventDispatcher:el,ExternalTexture:p1,ExtrudeGeometry:dy,FileLoader:la,Float16BufferAttribute:VC,Float32BufferAttribute:Wt,FloatType:Li,Fog:ry,FogExp2:iy,FramebufferTexture:lR,FrontSide:Hl,Frustum:_d,FrustumArray:oy,GLBufferAttribute:EN,GLSL1:Q3,GLSL3:T_,GreaterCompare:UT,GreaterDepth:Kv,GreaterEqualCompare:Qx,GreaterEqualDepth:Zv,GreaterEqualStencilFunc:H3,GreaterStencilFunc:k3,GridHelper:zN,Group:nd,HalfFloatType:Qi,HemisphereLight:Tw,HemisphereLightHelper:ON,IcosahedronGeometry:$m,ImageBitmapLoader:eN,ImageLoader:Vm,ImageUtils:VT,IncrementStencilOp:D3,IncrementWrapStencilOp:L3,InstancedBufferAttribute:pd,InstancedBufferGeometry:Iw,InstancedInterleavedBuffer:MN,InstancedMesh:ZT,Int16BufferAttribute:FC,Int32BufferAttribute:kC,Int8BufferAttribute:OC,IntType:Xm,InterleavedBuffer:sy,InterleavedBufferAttribute:mf,Interpolant:n0,InterpolateDiscrete:Rm,InterpolateLinear:Nx,InterpolateSmooth:Fv,InterpolationSamplingMode:eC,InterpolationSamplingType:$3,InvertStencilOp:U3,KeepStencilOp:tf,KeyframeTrack:Ga,LOD:qT,LatheGeometry:py,Layers:hd,LessCompare:LT,LessDepth:qv,LessEqualCompare:Kx,LessEqualDepth:df,LessEqualStencilFunc:F3,LessStencilFunc:z3,Light:$c,LightProbe:Dw,Line:Zc,Line3:DN,LineBasicMaterial:ws,LineCurve:v1,LineCurve3:sw,LineDashedMaterial:xw,LineLoop:QT,LineSegments:tl,LinearFilter:Gn,LinearInterpolant:T1,LinearMipMapLinearFilter:M_,LinearMipMapNearestFilter:x3,LinearMipmapLinearFilter:Qo,LinearMipmapNearestFilter:gm,LinearSRGBColorSpace:vo,LinearToneMapping:Y_,LinearTransfer:Dm,Loader:As,LoaderUtils:N_,LoadingManager:Sy,LoopOnce:AT,LoopPingPong:RT,LoopRepeat:CT,MOUSE:$u,Material:cs,MaterialLoader:My,MathUtils:Jx,Matrix2:P1,Matrix3:bn,Matrix4:cn,MaxEquation:uT,Mesh:Gi,MeshBasicMaterial:Gl,MeshDepthMaterial:S1,MeshDistanceMaterial:M1,MeshLambertMaterial:gw,MeshMatcapMaterial:vw,MeshNormalMaterial:mw,MeshPhongMaterial:dw,MeshPhysicalMaterial:Ux,MeshStandardMaterial:_y,MeshToonMaterial:pw,MinEquation:cT,MirroredRepeatWrapping:Cm,MixOperation:ET,MultiplyBlending:__,MultiplyOperation:Wm,NearestFilter:ar,NearestMipMapLinearFilter:v3,NearestMipMapNearestFilter:g3,NearestMipmapLinearFilter:ed,NearestMipmapNearestFilter:e1,NeutralToneMapping:$_,NeverCompare:IT,NeverDepth:Wv,NeverStencilFunc:O3,NoBlending:mo,NoColorSpace:Bl,NoNormalPacking:w3,NoToneMapping:ka,NormalAnimationBlendMode:Zx,NormalBlending:uf,NormalGAPacking:C3,NormalRGPacking:A3,NotEqualCompare:OT,NotEqualDepth:Qv,NotEqualStencilFunc:V3,NumberKeyframeTrack:Bm,Object3D:Nn,ObjectLoader:JR,ObjectSpaceNormalMap:DT,OctahedronGeometry:e0,OneFactor:hT,OneMinusConstantAlphaFactor:MT,OneMinusConstantColorFactor:_T,OneMinusDstAlphaFactor:gT,OneMinusDstColorFactor:xT,OneMinusSrcAlphaFactor:jv,OneMinusSrcColorFactor:pT,OrthographicCamera:Ha,PCFShadowMap:id,PCFSoftShadowMap:mm,PMREMGenerator:P_,Path:Px,PerspectiveCamera:Vi,Plane:sa,PlaneGeometry:Jc,PlaneHelper:GN,PointLight:Aw,PointLightHelper:PN,Points:JT,PointsMaterial:d1,PolarGridHelper:BN,PolyhedronGeometry:Qc,PositionalAudio:aN,PropertyBinding:qn,PropertyMixer:Ow,QuadraticBezierCurve:x1,QuadraticBezierCurve3:y1,Quaternion:as,QuaternionKeyframeTrack:i0,QuaternionLinearInterpolant:Sw,R11_EAC_Format:sx,RED_GREEN_RGTC2_Format:Cx,RED_RGTC1_Format:wx,REVISION:yd,RG11_EAC_Format:ox,RGBADepthPacking:M3,RGBAFormat:or,RGBAIntegerFormat:Yx,RGBA_ASTC_10x10_Format:bx,RGBA_ASTC_10x5_Format:vx,RGBA_ASTC_10x6_Format:xx,RGBA_ASTC_10x8_Format:yx,RGBA_ASTC_12x10_Format:_x,RGBA_ASTC_12x12_Format:Sx,RGBA_ASTC_4x4_Format:cx,RGBA_ASTC_5x4_Format:ux,RGBA_ASTC_5x5_Format:fx,RGBA_ASTC_6x5_Format:hx,RGBA_ASTC_6x6_Format:dx,RGBA_ASTC_8x5_Format:px,RGBA_ASTC_8x6_Format:mx,RGBA_ASTC_8x8_Format:gx,RGBA_BPTC_Format:Mx,RGBA_ETC2_EAC_Format:rx,RGBA_PVRTC_2BPPV1_Format:tx,RGBA_PVRTC_4BPPV1_Format:ex,RGBA_S3TC_DXT1_Format:xm,RGBA_S3TC_DXT3_Format:ym,RGBA_S3TC_DXT5_Format:bm,RGBDepthPacking:E3,RGBFormat:r1,RGBIntegerFormat:y3,RGB_BPTC_SIGNED_Format:Ex,RGB_BPTC_UNSIGNED_Format:Tx,RGB_ETC1_Format:nx,RGB_ETC2_Format:ix,RGB_PVRTC_2BPPV1_Format:$v,RGB_PVRTC_4BPPV1_Format:Jv,RGB_S3TC_DXT1_Format:vm,RGDepthPacking:T3,RGFormat:pf,RGIntegerFormat:qx,RawShaderMaterial:_1,Ray:yf,Raycaster:Sd,RectAreaLight:Nw,RedFormat:qm,RedIntegerFormat:Ym,ReinhardToneMapping:Z_,RenderTarget:o1,RenderTarget3D:bN,RepeatWrapping:Am,ReplaceStencilOp:N3,ReverseSubtractEquation:lT,RingGeometry:my,SIGNED_R11_EAC_Format:ax,SIGNED_RED_GREEN_RGTC2_Format:Rx,SIGNED_RED_RGTC1_Format:Ax,SIGNED_RG11_EAC_Format:lx,SRGBColorSpace:Gr,SRGBTransfer:ti,Scene:Km,ShaderChunk:An,ShaderLib:ho,ShaderMaterial:ls,ShadowMaterial:hw,Shape:hf,ShapeGeometry:gy,ShapePath:XN,ShapeUtils:po,ShortType:jx,Skeleton:ay,SkeletonHelper:LN,SkinnedMesh:YT,Source:Gc,Sphere:jr,SphereGeometry:t0,Spherical:I_,SphericalHarmonics3:R1,SplineCurve:b1,SpotLight:ww,SpotLightHelper:IN,Sprite:XT,SpriteMaterial:f1,SrcAlphaFactor:Gv,SrcAlphaSaturateFactor:yT,SrcColorFactor:dT,StaticCopyUsage:Y3,StaticDrawUsage:Im,StaticReadUsage:W3,StereoCamera:nN,StreamCopyUsage:K3,StreamDrawUsage:j3,StreamReadUsage:q3,StringKeyframeTrack:Sf,SubtractEquation:oT,SubtractiveBlending:b_,TOUCH:ef,TangentSpaceNormalMap:Kc,TetrahedronGeometry:vy,Texture:oi,TextureLoader:YR,TextureUtils:JN,Timer:TN,TimestampQuery:J3,TorusGeometry:xy,TorusKnotGeometry:yy,Triangle:Qs,TriangleFanDrawMode:S3,TriangleStripDrawMode:_3,TrianglesDrawMode:b3,TubeGeometry:by,UVMapping:Xc,Uint16BufferAttribute:l1,Uint32BufferAttribute:c1,Uint8BufferAttribute:zC,Uint8ClampedBufferAttribute:BC,Uniform:Ey,UniformsGroup:SN,UniformsLib:Bt,UniformsUtils:u1,UnsignedByteType:Dr,UnsignedInt101111Type:n1,UnsignedInt248Type:ld,UnsignedInt5999Type:t1,UnsignedIntType:ca,UnsignedShort4444Type:Wx,UnsignedShort5551Type:Xx,UnsignedShortType:od,VSMShadowMap:rf,Vector2:Je,Vector3:Q,Vector4:hi,VectorKeyframeTrack:Fm,VideoFrameTexture:oR,VideoTexture:$T,WebGL3DRenderTarget:TC,WebGLArrayRenderTarget:EC,WebGLCoordinateSystem:aa,WebGLCubeRenderTarget:ny,WebGLRenderTarget:Ts,WebGLRenderer:U1,WebGLUtils:jw,WebGPUCoordinateSystem:cd,WebXRController:kv,WireframeGeometry:fw,WrapAroundEnding:Nm,ZeroCurvatureEnding:sf,ZeroFactor:fT,ZeroSlopeEnding:af,ZeroStencilOp:R3,createCanvasElement:kT,error:Qt,getConsoleFunction:iC,log:Pm,setConsoleFunction:nC,warn:zt,warnOnce:ud},Symbol.toStringTag,{value:"Module"}));var s_={exports:{}},a_={},o_={exports:{}},l_={};var xE;function qP(){if(xE)return l_;xE=1;var s=jm();function e(x,y){return x===y&&(x!==0||1/x===1/y)||x!==x&&y!==y}var t=typeof Object.is=="function"?Object.is:e,n=s.useState,r=s.useEffect,o=s.useLayoutEffect,u=s.useDebugValue;function h(x,y){var _=y(),M=n({inst:{value:_,getSnapshot:y}}),R=M[0].inst,A=M[1];return o(function(){R.value=_,R.getSnapshot=y,d(R)&&A({inst:R})},[x,_,y]),r(function(){return d(R)&&A({inst:R}),x(function(){d(R)&&A({inst:R})})},[x]),u(_),_}function d(x){var y=x.getSnapshot;x=x.value;try{var _=y();return!t(x,_)}catch{return!0}}function m(x,y){return y()}var v=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?m:h;return l_.useSyncExternalStore=s.useSyncExternalStore!==void 0?s.useSyncExternalStore:v,l_}var yE;function YP(){return yE||(yE=1,o_.exports=qP()),o_.exports}var bE;function ZP(){if(bE)return a_;bE=1;var s=jm(),e=YP();function t(m,v){return m===v&&(m!==0||1/m===1/v)||m!==m&&v!==v}var n=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,o=s.useRef,u=s.useEffect,h=s.useMemo,d=s.useDebugValue;return a_.useSyncExternalStoreWithSelector=function(m,v,x,y,_){var M=o(null);if(M.current===null){var R={hasValue:!1,value:null};M.current=R}else R=M.current;M=h(function(){function E(U){if(!N){if(N=!0,I=U,U=y(U),_!==void 0&&R.hasValue){var H=R.value;if(_(H,U))return P=H}return P=U}if(H=P,n(I,U))return H;var V=y(U);return _!==void 0&&_(H,V)?(I=U,H):(I=U,P=V)}var N=!1,I,P,z=x===void 0?null:x;return[function(){return E(v())},z===null?void 0:function(){return E(z())}]},[v,x,y,_]);var A=r(m,M[0],M[1]);return u(function(){R.hasValue=!0,R.value=A},[A]),d(A),A},a_}var _E;function KP(){return _E||(_E=1,s_.exports=ZP()),s_.exports}var QP=KP();const JP=q_(QP),SE=s=>{let e;const t=new Set,n=(m,v)=>{const x=typeof m=="function"?m(e):m;if(!Object.is(x,e)){const y=e;e=v??(typeof x!="object"||x===null)?x:Object.assign({},e,x),t.forEach(_=>_(e,y))}},r=()=>e,h={setState:n,getState:r,getInitialState:()=>d,subscribe:m=>(t.add(m),()=>t.delete(m))},d=e=s(n,r,h);return h},Ww=(s=>s?SE(s):SE),{useSyncExternalStoreWithSelector:$P}=JP,eU=s=>s;function tU(s,e=eU,t){const n=$P(s.subscribe,s.getState,s.getInitialState,e,t);return $h.useDebugValue(n),n}const ME=(s,e)=>{const t=Ww(s),n=(r,o=e)=>tU(t,r,o);return Object.assign(n,t),n},Xw=((s,e)=>s?ME(s,e):ME),nU=s=>typeof s=="object"&&typeof s.then=="function",cf=[];function qw(s,e,t=(n,r)=>n===r){if(s===e)return!0;if(!s||!e)return!1;const n=s.length;if(e.length!==n)return!1;for(let r=0;r<n;r++)if(!t(s[r],e[r]))return!1;return!0}function Yw(s,e=null,t=!1,n={}){e===null&&(e=[s]);for(const o of cf)if(qw(e,o.keys,o.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(o,"error"))throw o.error;if(Object.prototype.hasOwnProperty.call(o,"response"))return n.lifespan&&n.lifespan>0&&(o.timeout&&clearTimeout(o.timeout),o.timeout=setTimeout(o.remove,n.lifespan)),o.response;if(!t)throw o.promise}const r={keys:e,equal:n.equal,remove:()=>{const o=cf.indexOf(r);o!==-1&&cf.splice(o,1)},promise:(nU(s)?s:s(...e)).then(o=>{r.response=o,n.lifespan&&n.lifespan>0&&(r.timeout=setTimeout(r.remove,n.lifespan))}).catch(o=>r.error=o)};if(cf.push(r),!t)throw r.promise}const iU=(s,e,t)=>Yw(s,e,!1,t),rU=(s,e,t)=>{Yw(s,e,!0,t)},sU=s=>{if(s===void 0||s.length===0)cf.splice(0,cf.length);else{const e=cf.find(t=>qw(s,t.keys,t.equal));e&&e.remove()}};var z_=tT();const aU=q_(z_);function O1(s,e,t){if(!s)return;if(t(s)===!0)return s;let n=e?s.return:s.child;for(;n;){const r=O1(n,e,t);if(r)return r;n=e?null:n.sibling}}function Zw(s){try{return Object.defineProperties(s,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return s}}const z1=Zw(te.createContext(null));class Kw extends te.Component{render(){return te.createElement(z1.Provider,{value:this._reactInternals},this.props.children)}}function Qw(){const s=te.useContext(z1);if(s===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=te.useId();return te.useMemo(()=>{for(const t of[s,s?.alternate]){if(!t)continue;const n=O1(t,!1,r=>{let o=r.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(n)return n}},[s,e])}const oU=Symbol.for("react.context"),lU=s=>s!==null&&typeof s=="object"&&"$$typeof"in s&&s.$$typeof===oU;function cU(){const s=Qw(),[e]=te.useState(()=>new Map);e.clear();let t=s;for(;t;){const n=t.type;lU(n)&&n!==z1&&!e.has(n)&&e.set(n,te.use(Zw(n))),t=t.return}return e}function uU(){const s=cU();return te.useMemo(()=>Array.from(s.keys()).reduce((e,t)=>n=>te.createElement(e,null,te.createElement(t.Provider,{...n,value:s.get(t)})),e=>te.createElement(Kw,{...e})),[s])}function Jw(s){let e=s.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const $w=s=>s&&s.isOrthographicCamera,fU=s=>s&&s.hasOwnProperty("current"),hU=s=>s!=null&&(typeof s=="string"||typeof s=="number"||s.isColor),r0=((s,e)=>typeof window<"u"&&(((s=window.document)==null?void 0:s.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?te.useLayoutEffect:te.useEffect;function B1(s){const e=te.useRef(s);return r0(()=>{e.current=s},[s]),e}function dU(){const s=Qw(),e=uU();return te.useMemo(()=>({children:t})=>{const r=!!O1(s,!0,o=>o.type===te.StrictMode)?te.StrictMode:te.Fragment;return w.jsx(r,{children:w.jsx(e,{children:t})})},[s,e])}function pU({set:s}){return r0(()=>(s(new Promise(()=>null)),()=>s(!1)),[s]),null}const mU=(s=>(s=class extends te.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}},s.getDerivedStateFromError=()=>({error:!0}),s))();function eA(s){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(s)?Math.min(Math.max(s[0],t),s[1]):s}function Kh(s){var e;return(e=s.__r3f)==null?void 0:e.root.getState()}const Di={obj:s=>s===Object(s)&&!Di.arr(s)&&typeof s!="function",fun:s=>typeof s=="function",str:s=>typeof s=="string",num:s=>typeof s=="number",boo:s=>typeof s=="boolean",und:s=>s===void 0,nul:s=>s===null,arr:s=>Array.isArray(s),equ(s,e,{arrays:t="shallow",objects:n="reference",strict:r=!0}={}){if(typeof s!=typeof e||!!s!=!!e)return!1;if(Di.str(s)||Di.num(s)||Di.boo(s))return s===e;const o=Di.obj(s);if(o&&n==="reference")return s===e;const u=Di.arr(s);if(u&&t==="reference")return s===e;if((u||o)&&s===e)return!0;let h;for(h in s)if(!(h in e))return!1;if(o&&t==="shallow"&&n==="shallow"){for(h in r?e:s)if(!Di.equ(s[h],e[h],{strict:r,objects:"reference"}))return!1}else for(h in r?e:s)if(s[h]!==e[h])return!1;if(Di.und(h)){if(u&&s.length===0&&e.length===0||o&&Object.keys(s).length===0&&Object.keys(e).length===0)return!0;if(s!==e)return!1}return!0}};function gU(s){const e={nodes:{},materials:{},meshes:{}};return s&&s.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material),t.isMesh&&!e.meshes[t.name]&&(e.meshes[t.name]=t)}),e}function vU(s){s.type!=="Scene"&&(s.dispose==null||s.dispose());for(const e in s){const t=s[e];t?.type!=="Scene"&&(t==null||t.dispose==null||t.dispose())}}const tA=["children","key","ref"];function xU(s){const e={};for(const t in s)tA.includes(t)||(e[t]=s[t]);return e}function Ox(s,e,t,n){const r=s;let o=r?.__r3f;return o||(o={root:e,type:t,parent:null,children:[],props:xU(n),object:r,eventCount:0,handlers:{},isHidden:!1},r&&(r.__r3f=o)),o}function Hm(s,e){if(!e.includes("-"))return{root:s,key:e,target:s[e]};if(e in s)return{root:s,key:e,target:s[e]};let t=s;const n=e.split("-");for(const r of n){if(typeof t!="object"||t===null){if(t!==void 0){const o=n.slice(n.indexOf(r)).join("-");return{root:t,key:o,target:void 0}}return{root:s,key:e,target:void 0}}e=r,s=t,t=t[e]}return{root:s,key:e,target:t}}const EE=/-\d+$/;function zx(s,e){if(Di.str(e.props.attach)){if(EE.test(e.props.attach)){const r=e.props.attach.replace(EE,""),{root:o,key:u}=Hm(s.object,r);Array.isArray(o[u])||(o[u]=[])}const{root:t,key:n}=Hm(s.object,e.props.attach);e.previousAttach=t[n],t[n]=e.object}else Di.fun(e.props.attach)&&(e.previousAttach=e.props.attach(s.object,e.object))}function Bx(s,e){if(Di.str(e.props.attach)){const{root:t,key:n}=Hm(s.object,e.props.attach),r=e.previousAttach;r===void 0?delete t[n]:t[n]=r}else e.previousAttach==null||e.previousAttach(s.object,e.object);delete e.previousAttach}const B_=[...tA,"args","dispose","attach","object","onUpdate","dispose"],TE=new Map;function yU(s){let e=TE.get(s.constructor);try{e||(e=new s.constructor,TE.set(s.constructor,e))}catch{}return e}function bU(s,e){const t={};for(const n in e)if(!B_.includes(n)&&!Di.equ(e[n],s.props[n])){t[n]=e[n];for(const r in e)r.startsWith(`${n}-`)&&(t[r]=e[r])}for(const n in s.props){if(B_.includes(n)||e.hasOwnProperty(n))continue;const{root:r,key:o}=Hm(s.object,n);if(r.constructor&&r.constructor.length===0){const u=yU(r);Di.und(u)||(t[o]=u[o])}else t[o]=0}return t}const _U=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],SU=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function Ko(s,e){var t;const n=s.__r3f,r=n&&Jw(n).getState(),o=n?.eventCount;for(const h in e){let d=e[h];if(B_.includes(h))continue;if(n&&SU.test(h)){typeof d=="function"?n.handlers[h]=d:delete n.handlers[h],n.eventCount=Object.keys(n.handlers).length;continue}if(d===void 0)continue;let{root:m,key:v,target:x}=Hm(s,h);if(x===void 0&&(typeof m!="object"||m===null))throw Error(`R3F: Cannot set "${h}". Ensure it is an object before setting "${v}".`);if(x instanceof hd&&d instanceof hd)x.mask=d.mask;else if(x instanceof Lt&&hU(d))x.set(d);else if(x!==null&&typeof x=="object"&&typeof x.set=="function"&&typeof x.copy=="function"&&d!=null&&d.constructor&&x.constructor===d.constructor)x.copy(d);else if(x!==null&&typeof x=="object"&&typeof x.set=="function"&&Array.isArray(d))typeof x.fromArray=="function"?x.fromArray(d):x.set(...d);else if(x!==null&&typeof x=="object"&&typeof x.set=="function"&&typeof d=="number")typeof x.setScalar=="function"?x.setScalar(d):x.set(d);else{var u;m[v]=d,r&&!r.linear&&_U.includes(v)&&(u=m[v])!=null&&u.isTexture&&m[v].format===or&&m[v].type===Dr&&(m[v].colorSpace=Gr)}}if(n!=null&&n.parent&&r!=null&&r.internal&&(t=n.object)!=null&&t.isObject3D&&o!==n.eventCount){const h=n.object,d=r.internal.interaction.indexOf(h);d>-1&&r.internal.interaction.splice(d,1),n.eventCount&&h.raycast!==null&&r.internal.interaction.push(h)}return n&&n.props.attach===void 0&&(n.object.isBufferGeometry?n.props.attach="geometry":n.object.isMaterial&&(n.props.attach="material")),n&&Ed(n),s}function Ed(s){var e;if(!s.parent)return;s.props.onUpdate==null||s.props.onUpdate(s.object);const t=(e=s.root)==null||e.getState==null?void 0:e.getState();t&&t.internal.frames===0&&t.invalidate()}function nA(s,e){s.manual||($w(s)?(s.left=e.width/-2,s.right=e.width/2,s.top=e.height/2,s.bottom=e.height/-2):s.aspect=e.width/e.height,s.updateProjectionMatrix())}const Ms=s=>s?.isObject3D;function Pv(s){return(s.eventObject||s.object).uuid+"/"+s.index+s.instanceId}function iA(s,e,t,n){const r=t.get(e);r&&(t.delete(e),t.size===0&&(s.delete(n),r.target.releasePointerCapture(n)))}function MU(s,e){const{internal:t}=s.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,r)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(r)}),t.capturedMap.forEach((n,r)=>{iA(t.capturedMap,e,n,r)})}function EU(s){function e(d){const{internal:m}=s.getState(),v=d.offsetX-m.initialClick[0],x=d.offsetY-m.initialClick[1];return Math.round(Math.sqrt(v*v+x*x))}function t(d){return d.filter(m=>["Move","Over","Enter","Out","Leave"].some(v=>{var x;return(x=m.__r3f)==null?void 0:x.handlers["onPointer"+v]}))}function n(d,m){const v=s.getState(),x=new Set,y=[],_=m?m(v.internal.interaction):v.internal.interaction;for(let E=0;E<_.length;E++){const N=Kh(_[E]);N&&(N.raycaster.camera=void 0)}v.previousRoot||v.events.compute==null||v.events.compute(d,v);function M(E){const N=Kh(E);if(!N||!N.events.enabled||N.raycaster.camera===null)return[];if(N.raycaster.camera===void 0){var I;N.events.compute==null||N.events.compute(d,N,(I=N.previousRoot)==null?void 0:I.getState()),N.raycaster.camera===void 0&&(N.raycaster.camera=null)}return N.raycaster.camera?N.raycaster.intersectObject(E,!0):[]}let R=_.flatMap(M).sort((E,N)=>{const I=Kh(E.object),P=Kh(N.object);return!I||!P?E.distance-N.distance:P.events.priority-I.events.priority||E.distance-N.distance}).filter(E=>{const N=Pv(E);return x.has(N)?!1:(x.add(N),!0)});v.events.filter&&(R=v.events.filter(R,v));for(const E of R){let N=E.object;for(;N;){var A;(A=N.__r3f)!=null&&A.eventCount&&y.push({...E,eventObject:N}),N=N.parent}}if("pointerId"in d&&v.internal.capturedMap.has(d.pointerId))for(let E of v.internal.capturedMap.get(d.pointerId).values())x.has(Pv(E.intersection))||y.push(E.intersection);return y}function r(d,m,v,x){if(d.length){const y={stopped:!1};for(const _ of d){let M=Kh(_.object);if(M||_.object.traverseAncestors(R=>{const A=Kh(R);if(A)return M=A,!1}),M){const{raycaster:R,pointer:A,camera:E,internal:N}=M,I=new Q(A.x,A.y,0).unproject(E),P=L=>{var B,W;return(B=(W=N.capturedMap.get(L))==null?void 0:W.has(_.eventObject))!=null?B:!1},z=L=>{const B={intersection:_,target:m.target};N.capturedMap.has(L)?N.capturedMap.get(L).set(_.eventObject,B):N.capturedMap.set(L,new Map([[_.eventObject,B]])),m.target.setPointerCapture(L)},U=L=>{const B=N.capturedMap.get(L);B&&iA(N.capturedMap,_.eventObject,B,L)};let H={};for(let L in m){let B=m[L];typeof B!="function"&&(H[L]=B)}let V={..._,...H,pointer:A,intersections:d,stopped:y.stopped,delta:v,unprojectedPoint:I,ray:R.ray,camera:E,stopPropagation(){const L="pointerId"in m&&N.capturedMap.get(m.pointerId);if((!L||L.has(_.eventObject))&&(V.stopped=y.stopped=!0,N.hovered.size&&Array.from(N.hovered.values()).find(B=>B.eventObject===_.eventObject))){const B=d.slice(0,d.indexOf(_));o([...B,_])}},target:{hasPointerCapture:P,setPointerCapture:z,releasePointerCapture:U},currentTarget:{hasPointerCapture:P,setPointerCapture:z,releasePointerCapture:U},nativeEvent:m};if(x(V),y.stopped===!0)break}}}return d}function o(d){const{internal:m}=s.getState();for(const v of m.hovered.values())if(!d.length||!d.find(x=>x.object===v.object&&x.index===v.index&&x.instanceId===v.instanceId)){const y=v.eventObject.__r3f;if(m.hovered.delete(Pv(v)),y!=null&&y.eventCount){const _=y.handlers,M={...v,intersections:d};_.onPointerOut==null||_.onPointerOut(M),_.onPointerLeave==null||_.onPointerLeave(M)}}}function u(d,m){for(let v=0;v<m.length;v++){const x=m[v].__r3f;x==null||x.handlers.onPointerMissed==null||x.handlers.onPointerMissed(d)}}function h(d){switch(d){case"onPointerLeave":case"onPointerCancel":return()=>o([]);case"onLostPointerCapture":return m=>{const{internal:v}=s.getState();"pointerId"in m&&v.capturedMap.has(m.pointerId)&&requestAnimationFrame(()=>{v.capturedMap.has(m.pointerId)&&(v.capturedMap.delete(m.pointerId),o([]))})}}return function(v){const{onPointerMissed:x,internal:y}=s.getState();y.lastEvent.current=v;const _=d==="onPointerMove",M=d==="onClick"||d==="onContextMenu"||d==="onDoubleClick",A=n(v,_?t:void 0),E=M?e(v):0;d==="onPointerDown"&&(y.initialClick=[v.offsetX,v.offsetY],y.initialHits=A.map(I=>I.eventObject)),M&&!A.length&&E<=2&&(u(v,y.interaction),x&&x(v)),_&&o(A);function N(I){const P=I.eventObject,z=P.__r3f;if(!(z!=null&&z.eventCount))return;const U=z.handlers;if(_){if(U.onPointerOver||U.onPointerEnter||U.onPointerOut||U.onPointerLeave){const H=Pv(I),V=y.hovered.get(H);V?V.stopped&&I.stopPropagation():(y.hovered.set(H,I),U.onPointerOver==null||U.onPointerOver(I),U.onPointerEnter==null||U.onPointerEnter(I))}U.onPointerMove==null||U.onPointerMove(I)}else{const H=U[d];H?(!M||y.initialHits.includes(P))&&(u(v,y.interaction.filter(V=>!y.initialHits.includes(V))),H(I)):M&&y.initialHits.includes(P)&&u(v,y.interaction.filter(V=>!y.initialHits.includes(V)))}}r(A,v,E,N)}}return{handlePointer:h}}const wE=s=>!!(s!=null&&s.render),F1=te.createContext(null),TU=(s,e)=>{const t=Xw((h,d)=>{const m=new Q,v=new Q,x=new Q;function y(E=d().camera,N=v,I=d().size){const{width:P,height:z,top:U,left:H}=I,V=P/z;N.isVector3?x.copy(N):x.set(...N);const L=E.getWorldPosition(m).distanceTo(x);if($w(E))return{width:P/E.zoom,height:z/E.zoom,top:U,left:H,factor:1,distance:L,aspect:V};{const B=E.fov*Math.PI/180,W=2*Math.tan(B/2)*L,ie=W*(P/z);return{width:ie,height:W,top:U,left:H,factor:P/ie,distance:L,aspect:V}}}let _;const M=E=>h(N=>({performance:{...N.performance,current:E}})),R=new Je;return{set:h,get:d,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(E=1)=>s(d(),E),advance:(E,N)=>e(E,N,d()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new D1,pointer:R,mouse:R,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const E=d();_&&clearTimeout(_),E.performance.current!==E.performance.min&&M(E.performance.min),_=setTimeout(()=>M(d().performance.max),E.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:y},setEvents:E=>h(N=>({...N,events:{...N.events,...E}})),setSize:(E,N,I=0,P=0)=>{const z=d().camera,U={width:E,height:N,top:I,left:P};h(H=>({size:U,viewport:{...H.viewport,...y(z,v,U)}}))},setDpr:E=>h(N=>{const I=eA(E);return{viewport:{...N.viewport,dpr:I,initialDpr:N.viewport.initialDpr||I}}}),setFrameloop:(E="always")=>{const N=d().clock;N.stop(),N.elapsedTime=0,E!=="never"&&(N.start(),N.elapsedTime=0),h(()=>({frameloop:E}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:te.createRef(),active:!1,frames:0,priority:0,subscribe:(E,N,I)=>{const P=d().internal;return P.priority=P.priority+(N>0?1:0),P.subscribers.push({ref:E,priority:N,store:I}),P.subscribers=P.subscribers.sort((z,U)=>z.priority-U.priority),()=>{const z=d().internal;z!=null&&z.subscribers&&(z.priority=z.priority-(N>0?1:0),z.subscribers=z.subscribers.filter(U=>U.ref!==E))}}}}}),n=t.getState();let r=n.size,o=n.viewport.dpr,u=n.camera;return t.subscribe(()=>{const{camera:h,size:d,viewport:m,gl:v,set:x}=t.getState();if(d.width!==r.width||d.height!==r.height||m.dpr!==o){r=d,o=m.dpr,nA(h,d),m.dpr>0&&v.setPixelRatio(m.dpr);const y=typeof HTMLCanvasElement<"u"&&v.domElement instanceof HTMLCanvasElement;v.setSize(d.width,d.height,y)}h!==u&&(u=h,x(y=>({viewport:{...y.viewport,...y.viewport.getCurrentViewport(h)}})))}),t.subscribe(h=>s(h)),t};function k1(){const s=te.useContext(F1);if(!s)throw new Error("R3F: Hooks can only be used within the Canvas component!");return s}function Sr(s=t=>t,e){return k1()(s,e)}function xi(s,e=0){const t=k1(),n=t.getState().internal.subscribe,r=B1(s);return r0(()=>n(r,e,t),[e,n,t]),null}const AE=new WeakMap,wU=s=>{var e;return typeof s=="function"&&(s==null||(e=s.prototype)==null?void 0:e.constructor)===s};function rA(s,e){return function(t,...n){let r;return wU(t)?(r=AE.get(t),r||(r=new t,AE.set(t,r))):r=t,s&&s(r),Promise.all(n.map(o=>new Promise((u,h)=>r.load(o,d=>{Ms(d?.scene)&&Object.assign(d,gU(d.scene)),u(d)},e,d=>h(new Error(`Could not load ${o}: ${d?.message}`))))))}}function vd(s,e,t,n){const r=Array.isArray(e)?e:[e],o=iU(rA(t,n),[s,...r],{equal:Di.equ});return Array.isArray(e)?o:o[0]}vd.preload=function(s,e,t){const n=Array.isArray(e)?e:[e];return rU(rA(t),[s,...n])};vd.clear=function(s,e){const t=Array.isArray(e)?e:[e];return sU([s,...t])};const AU=1,CU=8,RU=32,NU=2;var DU={version:"9.5.0"};function IU(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var CE={exports:{}},RE={exports:{}},NE;function LU(){return NE||(NE=1,(function(s){s.exports=function(e){function t(l,c,g,b){return new Zd(l,c,g,b)}function n(){}function r(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)c+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(l){var c=l,g=l;if(l.alternate)for(;c.return;)c=c.return;else{l=c;do c=l,(c.flags&4098)!==0&&(g=c.return),l=c.return;while(l)}return c.tag===3?g:null}function u(l){if(o(l)!==l)throw Error(r(188))}function h(l){var c=l.alternate;if(!c){if(c=o(l),c===null)throw Error(r(188));return c!==l?null:l}for(var g=l,b=c;;){var C=g.return;if(C===null)break;var D=C.alternate;if(D===null){if(b=C.return,b!==null){g=b;continue}break}if(C.child===D.child){for(D=C.child;D;){if(D===g)return u(C),l;if(D===b)return u(C),c;D=D.sibling}throw Error(r(188))}if(g.return!==b.return)g=C,b=D;else{for(var X=!1,de=C.child;de;){if(de===g){X=!0,g=C,b=D;break}if(de===b){X=!0,b=C,g=D;break}de=de.sibling}if(!X){for(de=D.child;de;){if(de===g){X=!0,g=D,b=C;break}if(de===b){X=!0,b=D,g=C;break}de=de.sibling}if(!X)throw Error(r(189))}}if(g.alternate!==b)throw Error(r(190))}if(g.tag!==3)throw Error(r(188));return g.stateNode.current===g?l:c}function d(l){var c=l.tag;if(c===5||c===26||c===27||c===6)return l;for(l=l.child;l!==null;){if(c=d(l),c!==null)return c;l=l.sibling}return null}function m(l){var c=l.tag;if(c===5||c===26||c===27||c===6)return l;for(l=l.child;l!==null;){if(l.tag!==4&&(c=m(l),c!==null))return c;l=l.sibling}return null}function v(l){return l===null||typeof l!="object"?null:(l=Ja&&l[Ja]||l["@@iterator"],typeof l=="function"?l:null)}function x(l){if(l==null)return null;if(typeof l=="function")return l.$$typeof===Do?null:l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case pl:return"Fragment";case gl:return"Profiler";case ml:return"StrictMode";case Qf:return"Suspense";case Qa:return"SuspenseList";case bu:return"Activity"}if(typeof l=="object")switch(l.$$typeof){case dl:return"Portal";case Os:return l.displayName||"Context";case yu:return(l._context.displayName||"Context")+".Consumer";case uc:var c=l.render;return l=l.displayName,l||(l=c.displayName||c.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case Jf:return c=l.displayName||null,c!==null?c:x(l.type)||"Memo";case Or:c=l._payload,l=l._init;try{return x(l(c))}catch{}}return null}function y(l){return{current:l}}function _(l){0>_l||(l.current=fh[_l],fh[_l]=null,_l--)}function M(l,c){_l++,fh[_l]=l.current,l.current=c}function R(l){return l>>>=0,l===0?32:31-(hh(l)/Mg|0)|0}function A(l){var c=l&42;if(c!==0)return c;switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return l&261888;case 262144:case 524288:case 1048576:case 2097152:return l&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return l&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return l}}function E(l,c,g){var b=l.pendingLanes;if(b===0)return 0;var C=0,D=l.suspendedLanes,X=l.pingedLanes;l=l.warmLanes;var de=b&134217727;return de!==0?(b=de&~D,b!==0?C=A(b):(X&=de,X!==0?C=A(X):g||(g=de&~l,g!==0&&(C=A(g))))):(de=b&~D,de!==0?C=A(de):X!==0?C=A(X):g||(g=b&~l,g!==0&&(C=A(g)))),C===0?0:c!==0&&c!==C&&(c&D)===0&&(D=C&-C,g=c&-c,D>=g||D===32&&(g&4194048)!==0)?c:C}function N(l,c){return(l.pendingLanes&~(l.suspendedLanes&~l.pingedLanes)&c)===0}function I(l,c){switch(l){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function P(){var l=vc;return vc<<=1,(vc&62914560)===0&&(vc=4194304),l}function z(l){for(var c=[],g=0;31>g;g++)c.push(l);return c}function U(l,c){l.pendingLanes|=c,c!==268435456&&(l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0)}function H(l,c,g,b,C,D){var X=l.pendingLanes;l.pendingLanes=g,l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0,l.expiredLanes&=g,l.entangledLanes&=g,l.errorRecoveryDisabledLanes&=g,l.shellSuspendCounter=0;var de=l.entanglements,He=l.expirationTimes,ft=l.hiddenUpdates;for(g=X&~g;0<g;){var Nt=31-Kr(g),vt=1<<Nt;de[Nt]=0,He[Nt]=-1;var Ht=ft[Nt];if(Ht!==null)for(ft[Nt]=null,Nt=0;Nt<Ht.length;Nt++){var hn=Ht[Nt];hn!==null&&(hn.lane&=-536870913)}g&=~vt}b!==0&&V(l,b,0),D!==0&&C===0&&l.tag!==0&&(l.suspendedLanes|=D&~(X&~c))}function V(l,c,g){l.pendingLanes|=c,l.suspendedLanes&=~c;var b=31-Kr(c);l.entangledLanes|=c,l.entanglements[b]=l.entanglements[b]|1073741824|g&261930}function L(l,c){var g=l.entangledLanes|=c;for(l=l.entanglements;g;){var b=31-Kr(g),C=1<<b;C&c|l[b]&c&&(l[b]|=c),g&=~C}}function B(l,c){var g=c&-c;return g=(g&42)!==0?1:W(g),(g&(l.suspendedLanes|c))!==0?0:g}function W(l){switch(l){case 2:l=1;break;case 8:l=4;break;case 32:l=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:l=128;break;case 268435456:l=134217728;break;default:l=0}return l}function ie(l){return l&=-l,2<l?8<l?(l&134217727)!==0?32:268435456:8:2}function J(l){if(typeof Pp=="function"&&wg(l),Qr&&typeof Qr.setStrictMode=="function")try{Qr.setStrictMode(Ml,l)}catch{}}function se(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}function ce(l){if(xh===void 0)try{throw Error()}catch(g){var c=g.stack.trim().match(/\n( *(at )?)/);xh=c&&c[1]||"",Ca=-1<g.stack.indexOf(`
    at`)?" (<anonymous>)":-1<g.stack.indexOf("@")?"@unknown:0:0":""}return`
`+xh+l+Ca}function Y(l,c){if(!l||Ru)return"";Ru=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var b={DetermineComponentFrameRoot:function(){try{if(c){var vt=function(){throw Error()};if(Object.defineProperty(vt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(vt,[])}catch(hn){var Ht=hn}Reflect.construct(l,[],vt)}else{try{vt.call()}catch(hn){Ht=hn}l.call(vt.prototype)}}else{try{throw Error()}catch(hn){Ht=hn}(vt=l())&&typeof vt.catch=="function"&&vt.catch(function(){})}}catch(hn){if(hn&&Ht&&typeof hn.stack=="string")return[hn.stack,Ht.stack]}return[null,null]}};b.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var C=Object.getOwnPropertyDescriptor(b.DetermineComponentFrameRoot,"name");C&&C.configurable&&Object.defineProperty(b.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var D=b.DetermineComponentFrameRoot(),X=D[0],de=D[1];if(X&&de){var He=X.split(`
`),ft=de.split(`
`);for(C=b=0;b<He.length&&!He[b].includes("DetermineComponentFrameRoot");)b++;for(;C<ft.length&&!ft[C].includes("DetermineComponentFrameRoot");)C++;if(b===He.length||C===ft.length)for(b=He.length-1,C=ft.length-1;1<=b&&0<=C&&He[b]!==ft[C];)C--;for(;1<=b&&0<=C;b--,C--)if(He[b]!==ft[C]){if(b!==1||C!==1)do if(b--,C--,0>C||He[b]!==ft[C]){var Nt=`
`+He[b].replace(" at new "," at ");return l.displayName&&Nt.includes("<anonymous>")&&(Nt=Nt.replace("<anonymous>",l.displayName)),Nt}while(1<=b&&0<=C);break}}}finally{Ru=!1,Error.prepareStackTrace=g}return(g=l?l.displayName||l.name:"")?ce(g):""}function ne(l,c){switch(l.tag){case 26:case 27:case 5:return ce(l.type);case 16:return ce("Lazy");case 13:return l.child!==c&&c!==null?ce("Suspense Fallback"):ce("Suspense");case 19:return ce("SuspenseList");case 0:case 15:return Y(l.type,!1);case 11:return Y(l.type.render,!1);case 1:return Y(l.type,!0);case 31:return ce("Activity");default:return""}}function ve(l){try{var c="",g=null;do c+=ne(l,g),g=l,l=l.return;while(l);return c}catch(b){return`
Error generating stack: `+b.message+`
`+b.stack}}function ae(l,c){if(typeof l=="object"&&l!==null){var g=Up.get(l);return g!==void 0?g:(c={value:l,source:c,stack:ve(c)},Up.set(l,c),c)}return{value:l,source:c,stack:ve(c)}}function re(l,c){to[Ra++]=Nu,to[Ra++]=ei,ei=l,Nu=c}function j(l,c,g){Fs[gs++]=xr,Fs[gs++]=$s,Fs[gs++]=ks,ks=l;var b=xr;l=$s;var C=32-Kr(b)-1;b&=~(1<<C),g+=1;var D=32-Kr(c)+C;if(30<D){var X=C-C%5;D=(b&(1<<X)-1).toString(32),b>>=X,C-=X,xr=1<<32-Kr(c)+C|g<<C|b,$s=D+l}else xr=1<<D|g<<C|b,$s=l}function le(l){l.return!==null&&(re(l,1),j(l,1,0))}function Me(l){for(;l===ei;)ei=to[--Ra],to[Ra]=null,Nu=to[--Ra],to[Ra]=null;for(;l===ks;)ks=Fs[--gs],Fs[gs]=null,$s=Fs[--gs],Fs[gs]=null,xr=Fs[--gs],Fs[gs]=null}function Ue(l,c){Fs[gs++]=xr,Fs[gs++]=$s,Fs[gs++]=ks,xr=c.id,$s=c.overflow,ks=l}function lt(l,c){M(yr,c),M(no,l),M(dr,null),l=F0(c),_(dr),M(dr,l)}function pe(){_(dr),_(no),_(yr)}function Re(l){l.memoizedState!==null&&M(Du,l);var c=dr.current,g=dc(c,l.type);c!==g&&(M(no,l),M(dr,g))}function it(l){no.current===l&&(_(dr),_(no)),Du.current===l&&(_(Du),Ui?yl._currentValue=xl:yl._currentValue2=xl)}function xt(l){var c=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Xe(ae(c,l)),yh}function dt(l,c){if(!mi)throw Error(r(175));fg(l.stateNode,l.type,l.memoizedProps,c,l)||xt(l,!0)}function Ut(l){for(nr=l.return;nr;)switch(nr.tag){case 5:case 31:case 13:Br=!1;return;case 27:case 3:Br=!0;return;default:nr=nr.return}}function xe(l){if(!mi||l!==nr)return!1;if(!In)return Ut(l),In=!0,!1;var c=l.tag;if(tr?c!==3&&c!==27&&(c!==5||gc(l.type)&&!zr(l.type,l.memoizedProps))&&gi&&xt(l):c!==3&&(c!==5||gc(l.type)&&!zr(l.type,l.memoizedProps))&&gi&&xt(l),Ut(l),c===13){if(!mi)throw Error(r(316));if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(r(317));gi=Mp(l)}else if(c===31){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(r(317));gi=dg(l)}else gi=tr&&c===27?ig(l.type,gi):nr?ng(l.stateNode):null;return!0}function rt(){mi&&(gi=nr=null,In=!1)}function Le(){var l=Na;return l!==null&&(es===null?es=l:es.push.apply(es,l),Na=null),l}function Xe(l){Na===null?Na=[l]:Na.push(l)}function qe(l,c,g){Ui?(M(Vs,c._currentValue),c._currentValue=g):(M(Vs,c._currentValue2),c._currentValue2=g)}function ot(l){var c=Vs.current;Ui?l._currentValue=c:l._currentValue2=c,_(Vs)}function $(l,c,g){for(;l!==null;){var b=l.alternate;if((l.childLanes&c)!==c?(l.childLanes|=c,b!==null&&(b.childLanes|=c)):b!==null&&(b.childLanes&c)!==c&&(b.childLanes|=c),l===g)break;l=l.return}}function Pt(l,c,g,b){var C=l.child;for(C!==null&&(C.return=l);C!==null;){var D=C.dependencies;if(D!==null){var X=C.child;D=D.firstContext;e:for(;D!==null;){var de=D;D=C;for(var He=0;He<c.length;He++)if(de.context===c[He]){D.lanes|=g,de=D.alternate,de!==null&&(de.lanes|=g),$(D.return,g,l),b||(X=null);break e}D=de.next}}else if(C.tag===18){if(X=C.return,X===null)throw Error(r(341));X.lanes|=g,D=X.alternate,D!==null&&(D.lanes|=g),$(X,g,l),X=null}else X=C.child;if(X!==null)X.return=C;else for(X=C;X!==null;){if(X===l){X=null;break}if(C=X.sibling,C!==null){C.return=X.return,X=C;break}X=X.return}C=X}}function St(l,c,g,b){l=null;for(var C=c,D=!1;C!==null;){if(!D){if((C.flags&524288)!==0)D=!0;else if((C.flags&262144)!==0)break}if(C.tag===10){var X=C.alternate;if(X===null)throw Error(r(387));if(X=X.memoizedProps,X!==null){var de=C.type;zi(C.pendingProps.value,X.value)||(l!==null?l.push(de):l=[de])}}else if(C===Du.current){if(X=C.alternate,X===null)throw Error(r(387));X.memoizedState.memoizedState!==C.memoizedState.memoizedState&&(l!==null?l.push(yl):l=[yl])}C=C.return}l!==null&&Pt(c,l,g,b),c.flags|=262144}function Ft(l){for(l=l.firstContext;l!==null;){var c=l.context;if(!zi(Ui?c._currentValue:c._currentValue2,l.memoizedValue))return!0;l=l.next}return!1}function ht(l){ri=l,ea=null,l=l.dependencies,l!==null&&(l.firstContext=null)}function K(l){return ge(ri,l)}function F(l,c){return ri===null&&ht(l),ge(l,c)}function ge(l,c){var g=Ui?c._currentValue:c._currentValue2;if(c={context:c,memoizedValue:g,next:null},ea===null){if(l===null)throw Error(r(308));ea=c,l.dependencies={lanes:0,firstContext:c},l.flags|=524288}else ea=ea.next=c;return g}function ze(){return{controller:new Ag,data:new Map,refCount:0}}function Ye(l){l.refCount--,l.refCount===0&&pr(Vy,function(){l.controller.abort()})}function Be(){}function Dt(l){l!==Kn&&l.next===null&&(Kn===null?Iu=Kn=l:Kn=Kn.next=l),Hs=!0,Cr||(Cr=!0,ee())}function yt(l,c){if(!bh&&Hs){bh=!0;do for(var g=!1,b=Iu;b!==null;){if(l!==0){var C=b.pendingLanes;if(C===0)var D=0;else{var X=b.suspendedLanes,de=b.pingedLanes;D=(1<<31-Kr(42|l)+1)-1,D&=C&~(X&~de),D=D&201326741?D&201326741|1:D?D|2:0}D!==0&&(g=!0,Ze(b,D))}else D=Ln,D=E(b,b===Mn?D:0,b.cancelPendingCommit!==null||b.timeoutHandle!==Zr),(D&3)===0||N(b,D)||(g=!0,Ze(b,D));b=b.next}while(g);bh=!1}}function kt(){ke()}function ke(){Hs=Cr=!1;var l=0;Oo!==0&&vl()&&(l=Oo);for(var c=Ar(),g=null,b=Iu;b!==null;){var C=b.next,D=Ce(b,c);D===0?(b.next=null,g===null?Iu=C:g.next=C,C===null&&(Kn=g)):(g=b,(l!==0||(D&3)!==0)&&(Hs=!0)),b=C}Yi!==0&&Yi!==5||yt(l),Oo!==0&&(Oo=0)}function Ce(l,c){for(var g=l.suspendedLanes,b=l.pingedLanes,C=l.expirationTimes,D=l.pendingLanes&-62914561;0<D;){var X=31-Kr(D),de=1<<X,He=C[X];He===-1?((de&g)===0||(de&b)!==0)&&(C[X]=I(de,c)):He<=c&&(l.expiredLanes|=de),D&=~de}if(c=Mn,g=Ln,g=E(l,l===c?g:0,l.cancelPendingCommit!==null||l.timeoutHandle!==Zr),b=l.callbackNode,g===0||l===c&&(Jn===2||Jn===9)||l.cancelPendingCommit!==null)return b!==null&&b!==null&&ph(b),l.callbackNode=null,l.callbackPriority=0;if((g&3)===0||N(l,g)){if(c=g&-g,c===l.callbackPriority)return c;switch(b!==null&&ph(b),ie(g)){case 2:case 8:g=Tg;break;case 32:g=Cu;break;case 268435456:g=gh;break;default:g=Cu}return b=Fe.bind(null,l),g=Au(g,b),l.callbackPriority=c,l.callbackNode=g,c}return b!==null&&b!==null&&ph(b),l.callbackPriority=2,l.callbackNode=null,2}function Fe(l,c){if(Yi!==0&&Yi!==5)return l.callbackNode=null,l.callbackPriority=0,null;var g=l.callbackNode;if(Ta()&&l.callbackNode!==g)return null;var b=Ln;return b=E(l,l===Mn?b:0,l.cancelPendingCommit!==null||l.timeoutHandle!==Zr),b===0?null:(Js(l,b,c),Ce(l,Ar()),l.callbackNode!=null&&l.callbackNode===g?Fe.bind(null,l):null)}function Ze(l,c){if(Ta())return null;Js(l,c,!0)}function ee(){op?lp(function(){(Cn&6)!==0?Au(mh,kt):ke()}):Au(mh,kt)}function Se(){if(Oo===0){var l=io;l===0&&(l=dh,dh<<=1,(dh&261888)===0&&(dh=256)),Oo=l}return Oo}function $e(l,c){if(xc===null){var g=xc=[];Op=0,io=Se(),ir={status:"pending",value:void 0,then:function(b){g.push(b)}}}return Op++,c.then(ue,ue),c}function ue(){if(--Op===0&&xc!==null){ir!==null&&(ir.status="fulfilled");var l=xc;xc=null,io=0,ir=null;for(var c=0;c<l.length;c++)(0,l[c])()}}function we(l,c){var g=[],b={status:"pending",value:null,reason:null,then:function(C){g.push(C)}};return l.then(function(){b.status="fulfilled",b.value=c;for(var C=0;C<g.length;C++)(0,g[C])(c)},function(C){for(b.status="rejected",b.reason=C,C=0;C<g.length;C++)(0,g[C])(void 0)}),b}function at(){var l=zo.current;return l!==null?l:Mn.pooledCache}function Ct(l,c){c===null?M(zo,zo.current):M(zo,c.pool)}function ct(){var l=at();return l===null?null:{parent:Ui?vi._currentValue:vi._currentValue2,pool:l}}function Qe(l,c){if(zi(l,c))return!0;if(typeof l!="object"||l===null||typeof c!="object"||c===null)return!1;var g=Object.keys(l),b=Object.keys(c);if(g.length!==b.length)return!1;for(b=0;b<g.length;b++){var C=g[b];if(!ky.call(c,C)||!zi(l[C],c[C]))return!1}return!0}function gt(l){return l=l.status,l==="fulfilled"||l==="rejected"}function qt(l,c,g){switch(g=l[g],g===void 0?l.push(c):g!==c&&(c.then(Be,Be),c=g),c.status){case"fulfilled":return c.value;case"rejected":throw l=c.reason,ci(l),l;default:if(typeof c.status=="string")c.then(Be,Be);else{if(l=Mn,l!==null&&100<l.shellSuspendCounter)throw Error(r(482));l=c,l.status="pending",l.then(function(b){if(c.status==="pending"){var C=c;C.status="fulfilled",C.value=b}},function(b){if(c.status==="pending"){var C=c;C.status="rejected",C.reason=b}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw l=c.reason,ci(l),l}throw Fr=c,rr}}function un(l){try{var c=l._init;return c(l._payload)}catch(g){throw g!==null&&typeof g=="object"&&typeof g.then=="function"?(Fr=g,rr):g}}function dn(){if(Fr===null)throw Error(r(459));var l=Fr;return Fr=null,l}function ci(l){if(l===rr||l===js)throw Error(r(483))}function Pi(l){var c=El;return El+=1,Bo===null&&(Bo=[]),qt(Bo,l,c)}function fa(l,c){c=c.props.ref,l.ref=c!==void 0?c:null}function ha(l,c){throw c.$$typeof===hl?Error(r(525)):(l=Object.prototype.toString.call(c),Error(r(31,l==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":l)))}function Cs(l){function c(Pe,Ae){if(l){var Ve=Pe.deletions;Ve===null?(Pe.deletions=[Ae],Pe.flags|=16):Ve.push(Ae)}}function g(Pe,Ae){if(!l)return null;for(;Ae!==null;)c(Pe,Ae),Ae=Ae.sibling;return null}function b(Pe){for(var Ae=new Map;Pe!==null;)Pe.key!==null?Ae.set(Pe.key,Pe):Ae.set(Pe.index,Pe),Pe=Pe.sibling;return Ae}function C(Pe,Ae){return Pe=ps(Pe,Ae),Pe.index=0,Pe.sibling=null,Pe}function D(Pe,Ae,Ve){return Pe.index=Ve,l?(Ve=Pe.alternate,Ve!==null?(Ve=Ve.index,Ve<Ae?(Pe.flags|=67108866,Ae):Ve):(Pe.flags|=67108866,Ae)):(Pe.flags|=1048576,Ae)}function X(Pe){return l&&Pe.alternate===null&&(Pe.flags|=67108866),Pe}function de(Pe,Ae,Ve,wt){return Ae===null||Ae.tag!==6?(Ae=Kd(Ve,Pe.mode,wt),Ae.return=Pe,Ae):(Ae=C(Ae,Ve),Ae.return=Pe,Ae)}function He(Pe,Ae,Ve,wt){var tn=Ve.type;return tn===pl?Nt(Pe,Ae,Ve.props.children,wt,Ve.key):Ae!==null&&(Ae.elementType===tn||typeof tn=="object"&&tn!==null&&tn.$$typeof===Or&&un(tn)===Ae.type)?(Ae=C(Ae,Ve.props),fa(Ae,Ve),Ae.return=Pe,Ae):(Ae=Ka(Ve.type,Ve.key,Ve.props,null,Pe.mode,wt),fa(Ae,Ve),Ae.return=Pe,Ae)}function ft(Pe,Ae,Ve,wt){return Ae===null||Ae.tag!==4||Ae.stateNode.containerInfo!==Ve.containerInfo||Ae.stateNode.implementation!==Ve.implementation?(Ae=Jd(Ve,Pe.mode,wt),Ae.return=Pe,Ae):(Ae=C(Ae,Ve.children||[]),Ae.return=Pe,Ae)}function Nt(Pe,Ae,Ve,wt,tn){return Ae===null||Ae.tag!==7?(Ae=Us(Ve,Pe.mode,wt,tn),Ae.return=Pe,Ae):(Ae=C(Ae,Ve),Ae.return=Pe,Ae)}function vt(Pe,Ae,Ve){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number"||typeof Ae=="bigint")return Ae=Kd(""+Ae,Pe.mode,Ve),Ae.return=Pe,Ae;if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case wa:return Ve=Ka(Ae.type,Ae.key,Ae.props,null,Pe.mode,Ve),fa(Ve,Ae),Ve.return=Pe,Ve;case dl:return Ae=Jd(Ae,Pe.mode,Ve),Ae.return=Pe,Ae;case Or:return Ae=un(Ae),vt(Pe,Ae,Ve)}if(Io(Ae)||v(Ae))return Ae=Us(Ae,Pe.mode,Ve,null),Ae.return=Pe,Ae;if(typeof Ae.then=="function")return vt(Pe,Pi(Ae),Ve);if(Ae.$$typeof===Os)return vt(Pe,F(Pe,Ae),Ve);ha(Pe,Ae)}return null}function Ht(Pe,Ae,Ve,wt){var tn=Ae!==null?Ae.key:null;if(typeof Ve=="string"&&Ve!==""||typeof Ve=="number"||typeof Ve=="bigint")return tn!==null?null:de(Pe,Ae,""+Ve,wt);if(typeof Ve=="object"&&Ve!==null){switch(Ve.$$typeof){case wa:return Ve.key===tn?He(Pe,Ae,Ve,wt):null;case dl:return Ve.key===tn?ft(Pe,Ae,Ve,wt):null;case Or:return Ve=un(Ve),Ht(Pe,Ae,Ve,wt)}if(Io(Ve)||v(Ve))return tn!==null?null:Nt(Pe,Ae,Ve,wt,null);if(typeof Ve.then=="function")return Ht(Pe,Ae,Pi(Ve),wt);if(Ve.$$typeof===Os)return Ht(Pe,Ae,F(Pe,Ve),wt);ha(Pe,Ve)}return null}function hn(Pe,Ae,Ve,wt,tn){if(typeof wt=="string"&&wt!==""||typeof wt=="number"||typeof wt=="bigint")return Pe=Pe.get(Ve)||null,de(Ae,Pe,""+wt,tn);if(typeof wt=="object"&&wt!==null){switch(wt.$$typeof){case wa:return Pe=Pe.get(wt.key===null?Ve:wt.key)||null,He(Ae,Pe,wt,tn);case dl:return Pe=Pe.get(wt.key===null?Ve:wt.key)||null,ft(Ae,Pe,wt,tn);case Or:return wt=un(wt),hn(Pe,Ae,Ve,wt,tn)}if(Io(wt)||v(wt))return Pe=Pe.get(Ve)||null,Nt(Ae,Pe,wt,tn,null);if(typeof wt.then=="function")return hn(Pe,Ae,Ve,Pi(wt),tn);if(wt.$$typeof===Os)return hn(Pe,Ae,Ve,F(Ae,wt),tn);ha(Ae,wt)}return null}function ki(Pe,Ae,Ve,wt){for(var tn=null,Ti=null,nn=Ae,Bn=Ae=0,mr=null;nn!==null&&Bn<Ve.length;Bn++){nn.index>Bn?(mr=nn,nn=null):mr=nn.sibling;var Wn=Ht(Pe,nn,Ve[Bn],wt);if(Wn===null){nn===null&&(nn=mr);break}l&&nn&&Wn.alternate===null&&c(Pe,nn),Ae=D(Wn,Ae,Bn),Ti===null?tn=Wn:Ti.sibling=Wn,Ti=Wn,nn=mr}if(Bn===Ve.length)return g(Pe,nn),In&&re(Pe,Bn),tn;if(nn===null){for(;Bn<Ve.length;Bn++)nn=vt(Pe,Ve[Bn],wt),nn!==null&&(Ae=D(nn,Ae,Bn),Ti===null?tn=nn:Ti.sibling=nn,Ti=nn);return In&&re(Pe,Bn),tn}for(nn=b(nn);Bn<Ve.length;Bn++)mr=hn(nn,Pe,Bn,Ve[Bn],wt),mr!==null&&(l&&mr.alternate!==null&&nn.delete(mr.key===null?Bn:mr.key),Ae=D(mr,Ae,Bn),Ti===null?tn=mr:Ti.sibling=mr,Ti=mr);return l&&nn.forEach(function(qs){return c(Pe,qs)}),In&&re(Pe,Bn),tn}function wc(Pe,Ae,Ve,wt){if(Ve==null)throw Error(r(151));for(var tn=null,Ti=null,nn=Ae,Bn=Ae=0,mr=null,Wn=Ve.next();nn!==null&&!Wn.done;Bn++,Wn=Ve.next()){nn.index>Bn?(mr=nn,nn=null):mr=nn.sibling;var qs=Ht(Pe,nn,Wn.value,wt);if(qs===null){nn===null&&(nn=mr);break}l&&nn&&qs.alternate===null&&c(Pe,nn),Ae=D(qs,Ae,Bn),Ti===null?tn=qs:Ti.sibling=qs,Ti=qs,nn=mr}if(Wn.done)return g(Pe,nn),In&&re(Pe,Bn),tn;if(nn===null){for(;!Wn.done;Bn++,Wn=Ve.next())Wn=vt(Pe,Wn.value,wt),Wn!==null&&(Ae=D(Wn,Ae,Bn),Ti===null?tn=Wn:Ti.sibling=Wn,Ti=Wn);return In&&re(Pe,Bn),tn}for(nn=b(nn);!Wn.done;Bn++,Wn=Ve.next())Wn=hn(nn,Pe,Bn,Wn.value,wt),Wn!==null&&(l&&Wn.alternate!==null&&nn.delete(Wn.key===null?Bn:Wn.key),Ae=D(Wn,Ae,Bn),Ti===null?tn=Wn:Ti.sibling=Wn,Ti=Wn);return l&&nn.forEach(function(Hy){return c(Pe,Hy)}),In&&re(Pe,Bn),tn}function Xo(Pe,Ae,Ve,wt){if(typeof Ve=="object"&&Ve!==null&&Ve.type===pl&&Ve.key===null&&(Ve=Ve.props.children),typeof Ve=="object"&&Ve!==null){switch(Ve.$$typeof){case wa:e:{for(var tn=Ve.key;Ae!==null;){if(Ae.key===tn){if(tn=Ve.type,tn===pl){if(Ae.tag===7){g(Pe,Ae.sibling),wt=C(Ae,Ve.props.children),wt.return=Pe,Pe=wt;break e}}else if(Ae.elementType===tn||typeof tn=="object"&&tn!==null&&tn.$$typeof===Or&&un(tn)===Ae.type){g(Pe,Ae.sibling),wt=C(Ae,Ve.props),fa(wt,Ve),wt.return=Pe,Pe=wt;break e}g(Pe,Ae);break}else c(Pe,Ae);Ae=Ae.sibling}Ve.type===pl?(wt=Us(Ve.props.children,Pe.mode,wt,Ve.key),wt.return=Pe,Pe=wt):(wt=Ka(Ve.type,Ve.key,Ve.props,null,Pe.mode,wt),fa(wt,Ve),wt.return=Pe,Pe=wt)}return X(Pe);case dl:e:{for(tn=Ve.key;Ae!==null;){if(Ae.key===tn)if(Ae.tag===4&&Ae.stateNode.containerInfo===Ve.containerInfo&&Ae.stateNode.implementation===Ve.implementation){g(Pe,Ae.sibling),wt=C(Ae,Ve.children||[]),wt.return=Pe,Pe=wt;break e}else{g(Pe,Ae);break}else c(Pe,Ae);Ae=Ae.sibling}wt=Jd(Ve,Pe.mode,wt),wt.return=Pe,Pe=wt}return X(Pe);case Or:return Ve=un(Ve),Xo(Pe,Ae,Ve,wt)}if(Io(Ve))return ki(Pe,Ae,Ve,wt);if(v(Ve)){if(tn=v(Ve),typeof tn!="function")throw Error(r(150));return Ve=tn.call(Ve),wc(Pe,Ae,Ve,wt)}if(typeof Ve.then=="function")return Xo(Pe,Ae,Pi(Ve),wt);if(Ve.$$typeof===Os)return Xo(Pe,Ae,F(Pe,Ve),wt);ha(Pe,Ve)}return typeof Ve=="string"&&Ve!==""||typeof Ve=="number"||typeof Ve=="bigint"?(Ve=""+Ve,Ae!==null&&Ae.tag===6?(g(Pe,Ae.sibling),wt=C(Ae,Ve),wt.return=Pe,Pe=wt):(g(Pe,Ae),wt=Kd(Ve,Pe.mode,wt),wt.return=Pe,Pe=wt),X(Pe)):g(Pe,Ae)}return function(Pe,Ae,Ve,wt){try{El=0;var tn=Xo(Pe,Ae,Ve,wt);return Bo=null,tn}catch(nn){if(nn===rr||nn===js)throw nn;var Ti=t(29,nn,null,Pe.mode);return Ti.lanes=wt,Ti.return=Pe,Ti}}}function da(){for(var l=Ia,c=Tl=Ia=0;c<l;){var g=_r[c];_r[c++]=null;var b=_r[c];_r[c++]=null;var C=_r[c];_r[c++]=null;var D=_r[c];if(_r[c++]=null,b!==null&&C!==null){var X=b.pending;X===null?C.next=C:(C.next=X.next,X.next=C),b.pending=C}D!==0&&Tr(g,C,D)}}function Ir(l,c,g,b){_r[Ia++]=l,_r[Ia++]=c,_r[Ia++]=g,_r[Ia++]=b,Tl|=b,l.lanes|=b,l=l.alternate,l!==null&&(l.lanes|=b)}function us(l,c,g,b){return Ir(l,c,g,b),ui(l)}function en(l,c){return Ir(l,null,null,c),ui(l)}function Tr(l,c,g){l.lanes|=g;var b=l.alternate;b!==null&&(b.lanes|=g);for(var C=!1,D=l.return;D!==null;)D.childLanes|=g,b=D.alternate,b!==null&&(b.childLanes|=g),D.tag===22&&(l=D.stateNode,l===null||l._visibility&1||(C=!0)),l=D,D=D.return;return l.tag===3?(D=l.stateNode,C&&c!==null&&(C=31-Kr(g),l=D.hiddenUpdates,b=l[C],b===null?l[C]=[c]:b.push(c),c.lane=g|536870912),D):null}function ui(l){if(50<Hn)throw Hn=0,Bu=null,Error(r(185));for(var c=l.return;c!==null;)l=c,c=l.return;return l.tag===3?l.stateNode:null}function k(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Z(l,c){l=l.updateQueue,c.updateQueue===l&&(c.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,callbacks:null})}function he(l){return{lane:l,tag:0,payload:null,callback:null,next:null}}function Ne(l,c,g){var b=l.updateQueue;if(b===null)return null;if(b=b.shared,(Cn&2)!==0){var C=b.pending;return C===null?c.next=c:(c.next=C.next,C.next=c),b.pending=c,c=ui(l),Tr(l,null,g),c}return Ir(l,b,c,g),ui(l)}function Ge(l,c,g){if(c=c.updateQueue,c!==null&&(c=c.shared,(g&4194048)!==0)){var b=c.lanes;b&=l.pendingLanes,g|=b,c.lanes=g,L(l,g)}}function We(l,c){var g=l.updateQueue,b=l.alternate;if(b!==null&&(b=b.updateQueue,g===b)){var C=null,D=null;if(g=g.firstBaseUpdate,g!==null){do{var X={lane:g.lane,tag:g.tag,payload:g.payload,callback:null,next:null};D===null?C=D=X:D=D.next=X,g=g.next}while(g!==null);D===null?C=D=c:D=D.next=c}else C=D=c;g={baseState:b.baseState,firstBaseUpdate:C,lastBaseUpdate:D,shared:b.shared,callbacks:b.callbacks},l.updateQueue=g;return}l=g.lastBaseUpdate,l===null?g.firstBaseUpdate=c:l.next=c,g.lastBaseUpdate=c}function pt(){if(Sh){var l=ir;if(l!==null)throw l}}function ut(l,c,g,b){Sh=!1;var C=l.updateQueue;vs=!1;var D=C.firstBaseUpdate,X=C.lastBaseUpdate,de=C.shared.pending;if(de!==null){C.shared.pending=null;var He=de,ft=He.next;He.next=null,X===null?D=ft:X.next=ft,X=He;var Nt=l.alternate;Nt!==null&&(Nt=Nt.updateQueue,de=Nt.lastBaseUpdate,de!==X&&(de===null?Nt.firstBaseUpdate=ft:de.next=ft,Nt.lastBaseUpdate=He))}if(D!==null){var vt=C.baseState;X=0,Nt=ft=He=null,de=D;do{var Ht=de.lane&-536870913,hn=Ht!==de.lane;if(hn?(Ln&Ht)===Ht:(b&Ht)===Ht){Ht!==0&&Ht===io&&(Sh=!0),Nt!==null&&(Nt=Nt.next={lane:0,tag:de.tag,payload:de.payload,callback:null,next:null});e:{var ki=l,wc=de;Ht=c;var Xo=g;switch(wc.tag){case 1:if(ki=wc.payload,typeof ki=="function"){vt=ki.call(Xo,vt,Ht);break e}vt=ki;break e;case 3:ki.flags=ki.flags&-65537|128;case 0:if(ki=wc.payload,Ht=typeof ki=="function"?ki.call(Xo,vt,Ht):ki,Ht==null)break e;vt=Kf({},vt,Ht);break e;case 2:vs=!0}}Ht=de.callback,Ht!==null&&(l.flags|=64,hn&&(l.flags|=8192),hn=C.callbacks,hn===null?C.callbacks=[Ht]:hn.push(Ht))}else hn={lane:Ht,tag:de.tag,payload:de.payload,callback:de.callback,next:null},Nt===null?(ft=Nt=hn,He=vt):Nt=Nt.next=hn,X|=Ht;if(de=de.next,de===null){if(de=C.shared.pending,de===null)break;hn=de,de=hn.next,hn.next=null,C.lastBaseUpdate=hn,C.shared.pending=null}}while(!0);Nt===null&&(He=vt),C.baseState=He,C.firstBaseUpdate=ft,C.lastBaseUpdate=Nt,D===null&&(C.shared.lanes=0),so|=X,l.lanes=X,l.memoizedState=vt}}function Tt(l,c){if(typeof l!="function")throw Error(r(191,l));l.call(c)}function Mt(l,c){var g=l.callbacks;if(g!==null)for(l.callbacks=null,l=0;l<g.length;l++)Tt(g[l],c)}function Rt(l,c){l=Pa,M(Fo,l),M(wl,c),Pa=l|c.baseLanes}function _t(){M(Fo,Pa),M(wl,wl.current)}function G(){Pa=Fo.current,_(wl),_(Fo)}function oe(l){var c=l.alternate;M(Ci,Ci.current&1),M(Jr,l),$r===null&&(c===null||wl.current!==null||c.memoizedState!==null)&&($r=l)}function be(l){M(Ci,Ci.current),M(Jr,l),$r===null&&($r=l)}function _e(l){l.tag===22?(M(Ci,Ci.current),M(Jr,l),$r===null&&($r=l)):me()}function me(){M(Ci,Ci.current),M(Jr,Jr.current)}function et(l){_(Jr),$r===l&&($r=null),_(Ci)}function mt(l){for(var c=l;c!==null;){if(c.tag===13){var g=c.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||Po(g)||rh(g)))return c}else if(c.tag===19&&(c.memoizedProps.revealOrder==="forwards"||c.memoizedProps.revealOrder==="backwards"||c.memoizedProps.revealOrder==="unstable_legacy-backwards"||c.memoizedProps.revealOrder==="together")){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}function tt(){throw Error(r(321))}function It(l,c){if(c===null)return!1;for(var g=0;g<c.length&&g<l.length;g++)if(!zi(l[g],c[g]))return!1;return!0}function Et(l,c,g,b,C,D){return ro=D,mn=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Jt.H=l===null||l.memoizedState===null?Si:La,On=!1,D=g(b,C),On=!1,yn&&(D=At(c,g,b,C)),jt(l),D}function jt(l){Jt.H=xs;var c=Kt!==null&&Kt.next!==null;if(ro=0,ln=Kt=mn=null,Sn=!1,Ws=0,ta=null,c)throw Error(r(300));l===null||fi||(l=l.dependencies,l!==null&&Ft(l)&&(fi=!0))}function At(l,c,g,b){mn=l;var C=0;do{if(yn&&(ta=null),Ws=0,yn=!1,25<=C)throw Error(r(301));if(C+=1,ln=Kt=null,l.updateQueue!=null){var D=l.updateQueue;D.lastEffect=null,D.events=null,D.stores=null,D.memoCache!=null&&(D.memoCache.index=0)}Jt.H=ko,D=c(g,b)}while(yn);return D}function Gt(){var l=Jt.H,c=l.useState()[0];return c=typeof c.then=="function"?Ot(c):c,l=l.useState()[0],(Kt!==null?Kt.memoizedState:null)!==l&&(mn.flags|=1024),c}function fn(){var l=Rr!==0;return Rr=0,l}function jn(l,c,g){c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~g}function xn(l){if(Sn){for(l=l.memoizedState;l!==null;){var c=l.queue;c!==null&&(c.pending=null),l=l.next}Sn=!1}ro=0,ln=Kt=mn=null,yn=!1,Ws=Rr=0,ta=null}function Vt(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ln===null?mn.memoizedState=ln=l:ln=ln.next=l,ln}function bt(){if(Kt===null){var l=mn.alternate;l=l!==null?l.memoizedState:null}else l=Kt.next;var c=ln===null?mn.memoizedState:ln.next;if(c!==null)ln=c,Kt=l;else{if(l===null)throw mn.alternate===null?Error(r(467)):Error(r(310));Kt=l,l={memoizedState:Kt.memoizedState,baseState:Kt.baseState,baseQueue:Kt.baseQueue,queue:Kt.queue,next:null},ln===null?mn.memoizedState=ln=l:ln=ln.next=l}return ln}function Yt(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ot(l){var c=Ws;return Ws+=1,ta===null&&(ta=[]),l=qt(ta,l,c),c=mn,(ln===null?c.memoizedState:ln.next)===null&&(c=c.alternate,Jt.H=c===null||c.memoizedState===null?Si:La),l}function Vn(l){if(l!==null&&typeof l=="object"){if(typeof l.then=="function")return Ot(l);if(l.$$typeof===Os)return K(l)}throw Error(r(438,String(l)))}function Ji(l){var c=null,g=mn.updateQueue;if(g!==null&&(c=g.memoCache),c==null){var b=mn.alternate;b!==null&&(b=b.updateQueue,b!==null&&(b=b.memoCache,b!=null&&(c={data:b.data.map(function(C){return C.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),g===null&&(g=Yt(),mn.updateQueue=g),g.memoCache=c,g=c.data[c.index],g===void 0)for(g=c.data[c.index]=Array(l),b=0;b<l;b++)g[b]=ep;return c.index++,g}function Tn(l,c){return typeof c=="function"?c(l):c}function di(l){var c=bt();return Xn(c,Kt,l)}function Xn(l,c,g){var b=l.queue;if(b===null)throw Error(r(311));b.lastRenderedReducer=g;var C=l.baseQueue,D=b.pending;if(D!==null){if(C!==null){var X=C.next;C.next=D.next,D.next=X}c.baseQueue=C=D,b.pending=null}if(D=l.baseState,C===null)l.memoizedState=D;else{c=C.next;var de=X=null,He=null,ft=c,Nt=!1;do{var vt=ft.lane&-536870913;if(vt!==ft.lane?(Ln&vt)===vt:(ro&vt)===vt){var Ht=ft.revertLane;if(Ht===0)He!==null&&(He=He.next={lane:0,revertLane:0,gesture:null,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null}),vt===io&&(Nt=!0);else if((ro&Ht)===Ht){ft=ft.next,Ht===io&&(Nt=!0);continue}else vt={lane:0,revertLane:ft.revertLane,gesture:null,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null},He===null?(de=He=vt,X=D):He=He.next=vt,mn.lanes|=Ht,so|=Ht;vt=ft.action,On&&g(D,vt),D=ft.hasEagerState?ft.eagerState:g(D,vt)}else Ht={lane:vt,revertLane:ft.revertLane,gesture:ft.gesture,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null},He===null?(de=He=Ht,X=D):He=He.next=Ht,mn.lanes|=vt,so|=vt;ft=ft.next}while(ft!==null&&ft!==c);if(He===null?X=D:He.next=de,!zi(D,l.memoizedState)&&(fi=!0,Nt&&(g=ir,g!==null)))throw g;l.memoizedState=D,l.baseState=X,l.baseQueue=He,b.lastRenderedState=D}return C===null&&(b.lanes=0),[l.memoizedState,b.dispatch]}function $i(l){var c=bt(),g=c.queue;if(g===null)throw Error(r(311));g.lastRenderedReducer=l;var b=g.dispatch,C=g.pending,D=c.memoizedState;if(C!==null){g.pending=null;var X=C=C.next;do D=l(D,X.action),X=X.next;while(X!==C);zi(D,c.memoizedState)||(fi=!0),c.memoizedState=D,c.baseQueue===null&&(c.baseState=D),g.lastRenderedState=D}return[D,b]}function ji(l,c,g){var b=mn,C=bt(),D=In;if(D){if(g===void 0)throw Error(r(407));g=g()}else g=c();var X=!zi((Kt||C).memoizedState,g);if(X&&(C.memoizedState=g,fi=!0),C=C.queue,Xl(nl.bind(null,b,C,l),[l]),C.getSnapshot!==c||X||ln!==null&&ln.memoizedState.tag&1){if(b.flags|=2048,fs(9,{destroy:void 0},cr.bind(null,b,C,g,c),null),Mn===null)throw Error(r(349));D||(ro&127)!==0||lr(b,c,g)}return g}function lr(l,c,g){l.flags|=16384,l={getSnapshot:c,value:g},c=mn.updateQueue,c===null?(c=Yt(),mn.updateQueue=c,c.stores=[l]):(g=c.stores,g===null?c.stores=[l]:g.push(l))}function cr(l,c,g,b){c.value=g,c.getSnapshot=b,Rs(c)&&o0(l)}function nl(l,c,g){return g(function(){Rs(c)&&o0(l)})}function Rs(l){var c=l.getSnapshot;l=l.value;try{var g=c();return!zi(l,g)}catch{return!0}}function o0(l){var c=en(l,2);c!==null&&bi(c,l,2)}function Td(l){var c=Vt();if(typeof l=="function"){var g=l;if(l=g(),On){J(!0);try{g()}finally{J(!1)}}}return c.memoizedState=c.baseState=l,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Tn,lastRenderedState:l},c}function eu(l,c,g,b){return l.baseState=g,Xn(l,Kt,typeof b=="function"?b:Tn)}function ja(l,c,g,b,C){if(Nf(l))throw Error(r(485));if(l=c.action,l!==null){var D={payload:C,action:l,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(X){D.listeners.push(X)}};Jt.T!==null?g(!0):D.isTransition=!1,b(D),g=c.pending,g===null?(D.next=c.pending=D,Mf(c,D)):(D.next=g.next,c.pending=g.next=D)}}function Mf(l,c){var g=c.action,b=c.payload,C=l.state;if(c.isTransition){var D=Jt.T,X={};Jt.T=X;try{var de=g(C,b),He=Jt.S;He!==null&&He(X,de),Ef(l,c,de)}catch(ft){yo(l,c,ft)}finally{D!==null&&X.types!==null&&(D.types=X.types),Jt.T=D}}else try{D=g(C,b),Ef(l,c,D)}catch(ft){yo(l,c,ft)}}function Ef(l,c,g){g!==null&&typeof g=="object"&&typeof g.then=="function"?g.then(function(b){il(l,c,b)},function(b){return yo(l,c,b)}):il(l,c,g)}function il(l,c,g){c.status="fulfilled",c.value=g,wd(c),l.state=g,c=l.pending,c!==null&&(g=c.next,g===c?l.pending=null:(g=g.next,c.next=g,Mf(l,g)))}function yo(l,c,g){var b=l.pending;if(l.pending=null,b!==null){b=b.next;do c.status="rejected",c.reason=g,wd(c),c=c.next;while(c!==b)}l.action=null}function wd(l){l=l.listeners;for(var c=0;c<l.length;c++)(0,l[c])()}function Tf(l,c){return c}function Ad(l,c){if(In){var g=Mn.formState;if(g!==null){e:{var b=mn;if(In){if(gi){var C=tg(gi,Br);if(C){gi=ng(C),b=yp(C);break e}}xt(b)}b=!1}b&&(c=g[0])}}g=Vt(),g.memoizedState=g.baseState=c,b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Tf,lastRenderedState:c},g.queue=b,g=d0.bind(null,mn,b),b.dispatch=g,b=Td(!1);var D=Rf.bind(null,mn,!1,b.queue);return b=Vt(),C={state:c,dispatch:null,action:l,pending:null},b.queue=C,g=ja.bind(null,mn,C,D,g),C.dispatch=g,b.memoizedState=l,[c,g,!1]}function jl(l){var c=bt();return pa(c,Kt,l)}function pa(l,c,g){if(c=Xn(l,c,Tf)[0],l=di(Tn)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var b=Ot(c)}catch(X){throw X===rr?js:X}else b=c;c=bt();var C=c.queue,D=C.dispatch;return g!==c.memoizedState&&(mn.flags|=2048,fs(9,{destroy:void 0},Cd.bind(null,C,g),null)),[b,D,l]}function Cd(l,c){l.action=c}function Wl(l){var c=bt(),g=Kt;if(g!==null)return pa(c,g,l);bt(),c=c.memoizedState,g=bt();var b=g.queue.dispatch;return g.memoizedState=l,[c,b,!1]}function fs(l,c,g,b){return l={tag:l,create:g,deps:b,inst:c,next:null},c=mn.updateQueue,c===null&&(c=Yt(),mn.updateQueue=c),g=c.lastEffect,g===null?c.lastEffect=l.next=l:(b=g.next,g.next=l,l.next=b,c.lastEffect=l),l}function wf(){return bt().memoizedState}function rl(l,c,g,b){var C=Vt();mn.flags|=l,C.memoizedState=fs(1|c,{destroy:void 0},g,b===void 0?null:b)}function tu(l,c,g,b){var C=bt();b=b===void 0?null:b;var D=C.memoizedState.inst;Kt!==null&&b!==null&&It(b,Kt.memoizedState.deps)?C.memoizedState=fs(c,D,g,b):(mn.flags|=l,C.memoizedState=fs(1|c,D,g,b))}function nu(l,c){rl(8390656,8,l,c)}function Xl(l,c){tu(2048,8,l,c)}function l0(l){mn.flags|=4;var c=mn.updateQueue;if(c===null)c=Yt(),mn.updateQueue=c,c.events=[l];else{var g=c.events;g===null?c.events=[l]:g.push(l)}}function Lr(l){var c=bt().memoizedState;return l0({ref:c,nextImpl:l}),function(){if((Cn&2)!==0)throw Error(r(440));return c.impl.apply(void 0,arguments)}}function bo(l,c){return tu(4,2,l,c)}function iu(l,c){return tu(4,4,l,c)}function ql(l,c){if(typeof c=="function"){l=l();var g=c(l);return function(){typeof g=="function"?g():c(null)}}if(c!=null)return l=l(),c.current=l,function(){c.current=null}}function c0(l,c,g){g=g!=null?g.concat([l]):null,tu(4,4,ql.bind(null,c,l),g)}function ru(){}function Af(l,c){var g=bt();c=c===void 0?null:c;var b=g.memoizedState;return c!==null&&It(c,b[1])?b[0]:(g.memoizedState=[l,c],l)}function Yl(l,c){var g=bt();c=c===void 0?null:c;var b=g.memoizedState;if(c!==null&&It(c,b[1]))return b[0];if(b=l(),On){J(!0);try{l()}finally{J(!1)}}return g.memoizedState=[b,c],b}function Zl(l,c,g){return g===void 0||(ro&1073741824)!==0&&(Ln&261930)===0?l.memoizedState=c:(l.memoizedState=g,l=qa(),mn.lanes|=l,so|=l,g)}function Rd(l,c,g,b){return zi(g,c)?g:wl.current!==null?(l=Zl(l,g,b),zi(l,c)||(fi=!0),l):(ro&42)===0||(ro&1073741824)!==0&&(Ln&261930)===0?(fi=!0,l.memoizedState=g):(l=qa(),mn.lanes|=l,so|=l,c)}function u0(l,c,g,b,C){var D=zs();Dn(D!==0&&8>D?D:8);var X=Jt.T,de={};Jt.T=de,Rf(l,!1,c,g);try{var He=C(),ft=Jt.S;if(ft!==null&&ft(de,He),He!==null&&typeof He=="object"&&typeof He.then=="function"){var Nt=we(He,b);su(l,c,Nt,pi(l))}else su(l,c,b,pi(l))}catch(vt){su(l,c,{then:function(){},status:"rejected",reason:vt},pi())}finally{Dn(D),X!==null&&de.types!==null&&(X.types=de.types),Jt.T=X}}function f0(l){var c=l.memoizedState;if(c!==null)return c;c={memoizedState:xl,baseState:xl,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Tn,lastRenderedState:xl},next:null};var g={};return c.next={memoizedState:g,baseState:g,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Tn,lastRenderedState:g},next:null},l.memoizedState=c,l=l.alternate,l!==null&&(l.memoizedState=c),c}function Nd(){return K(yl)}function Cf(){return bt().memoizedState}function h0(){return bt().memoizedState}function Ny(l){for(var c=l.return;c!==null;){switch(c.tag){case 24:case 3:var g=pi();l=he(g);var b=Ne(c,l,g);b!==null&&(bi(b,c,g),Ge(b,c,g)),c={cache:ze()},l.payload=c;return}c=c.return}}function Dy(l,c,g){var b=pi();g={lane:b,revertLane:0,gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Nf(l)?p0(c,g):(g=us(l,c,g,b),g!==null&&(bi(g,l,b),m0(g,c,b)))}function d0(l,c,g){var b=pi();su(l,c,g,b)}function su(l,c,g,b){var C={lane:b,revertLane:0,gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null};if(Nf(l))p0(c,C);else{var D=l.alternate;if(l.lanes===0&&(D===null||D.lanes===0)&&(D=c.lastRenderedReducer,D!==null))try{var X=c.lastRenderedState,de=D(X,g);if(C.hasEagerState=!0,C.eagerState=de,zi(de,X))return Ir(l,c,C,0),Mn===null&&da(),!1}catch{}if(g=us(l,c,C,b),g!==null)return bi(g,l,b),m0(g,c,b),!0}return!1}function Rf(l,c,g,b){if(b={lane:2,revertLane:Se(),gesture:null,action:b,hasEagerState:!1,eagerState:null,next:null},Nf(l)){if(c)throw Error(r(479))}else c=us(l,g,b,2),c!==null&&bi(c,l,2)}function Nf(l){var c=l.alternate;return l===mn||c!==null&&c===mn}function p0(l,c){yn=Sn=!0;var g=l.pending;g===null?c.next=c:(c.next=g.next,g.next=c),l.pending=c}function m0(l,c,g){if((g&4194048)!==0){var b=c.lanes;b&=l.pendingLanes,g|=b,c.lanes=g,L(l,g)}}function Dd(l,c,g,b){c=l.memoizedState,g=g(b,c),g=g==null?c:Kf({},c,g),l.memoizedState=g,l.lanes===0&&(l.updateQueue.baseState=g)}function Df(l,c,g,b,C,D,X){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(b,D,X):c.prototype&&c.prototype.isPureReactComponent?!Qe(g,b)||!Qe(C,D):!0}function g0(l,c,g,b){l=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(g,b),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(g,b),c.state!==l&&Lu.enqueueReplaceState(c,c.state,null)}function sl(l,c){var g=c;if("ref"in c){g={};for(var b in c)b!=="ref"&&(g[b]=c[b])}if(l=l.defaultProps){g===c&&(g=Kf({},g));for(var C in l)g[C]===void 0&&(g[C]=l[C])}return g}function If(l,c){try{var g=l.onUncaughtError;g(c.value,{componentStack:c.stack})}catch(b){setTimeout(function(){throw b})}}function Id(l,c,g){try{var b=l.onCaughtError;b(g.value,{componentStack:g.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(C){setTimeout(function(){throw C})}}function Ld(l,c,g){return g=he(g),g.tag=3,g.payload={element:null},g.callback=function(){If(l,c)},g}function v0(l){return l=he(l),l.tag=3,l}function x0(l,c,g,b){var C=g.type.getDerivedStateFromError;if(typeof C=="function"){var D=b.value;l.payload=function(){return C(D)},l.callback=function(){Id(c,g,b)}}var X=g.stateNode;X!==null&&typeof X.componentDidCatch=="function"&&(l.callback=function(){Id(c,g,b),typeof C!="function"&&(ao===null?ao=new Set([this]):ao.add(this));var de=b.stack;this.componentDidCatch(b.value,{componentStack:de!==null?de:""})})}function Iy(l,c,g,b,C){if(g.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){if(c=g.alternate,c!==null&&St(c,g,C,!0),g=Jr.current,g!==null){switch(g.tag){case 31:case 13:return $r===null?ac():g.alternate===null&&Ei===0&&(Ei=3),g.flags&=-257,g.flags|=65536,g.lanes=C,b===Da?g.flags|=16384:(c=g.updateQueue,c===null?g.updateQueue=new Set([b]):c.add(b),cc(l,b,C)),!1;case 22:return g.flags|=65536,b===Da?g.flags|=16384:(c=g.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([b])},g.updateQueue=c):(g=c.retryQueue,g===null?c.retryQueue=new Set([b]):g.add(b)),cc(l,b,C)),!1}throw Error(r(435,g.tag))}return cc(l,b,C),ac(),!1}if(In)return c=Jr.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=C,b!==yh&&(l=Error(r(422),{cause:b}),Xe(ae(l,g)))):(b!==yh&&(c=Error(r(423),{cause:b}),Xe(ae(c,g))),l=l.current.alternate,l.flags|=65536,C&=-C,l.lanes|=C,b=ae(b,g),C=Ld(l.stateNode,b,C),We(l,C),Ei!==4&&(Ei=2)),!1;var D=Error(r(520),{cause:b});if(D=ae(D,g),Uu===null?Uu=[D]:Uu.push(D),Ei!==4&&(Ei=2),c===null)return!0;b=ae(b,g),g=c;do{switch(g.tag){case 3:return g.flags|=65536,l=C&-C,g.lanes|=l,l=Ld(g.stateNode,b,l),We(g,l),!1;case 1:if(c=g.type,D=g.stateNode,(g.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(ao===null||!ao.has(D))))return g.flags|=65536,C&=-C,g.lanes|=C,C=v0(C),x0(C,l,g,b),We(g,C),!1}g=g.return}while(g!==null);return!1}function vr(l,c,g,b){c.child=l===null?zp(c,null,g,b):br(c,l.child,g,b)}function y0(l,c,g,b,C){g=g.render;var D=c.ref;if("ref"in b){var X={};for(var de in b)de!=="ref"&&(X[de]=b[de])}else X=b;return ht(c),b=Et(l,c,g,X,D,C),de=fn(),l!==null&&!fi?(jn(l,c,C),ma(l,c,C)):(In&&de&&le(c),c.flags|=1,vr(l,c,b,C),c.child)}function b0(l,c,g,b,C){if(l===null){var D=g.type;return typeof D=="function"&&!ul(D)&&D.defaultProps===void 0&&g.compare===null?(c.tag=15,c.type=D,_0(l,c,D,b,C)):(l=Ka(g.type,null,b,c,c.mode,C),l.ref=c.ref,l.return=c,c.child=l)}if(D=l.child,!ou(l,C)){var X=D.memoizedProps;if(g=g.compare,g=g!==null?g:Qe,g(X,b)&&l.ref===c.ref)return ma(l,c,C)}return c.flags|=1,l=ps(D,b),l.ref=c.ref,l.return=c,c.child=l}function _0(l,c,g,b,C){if(l!==null){var D=l.memoizedProps;if(Qe(D,b)&&l.ref===c.ref)if(fi=!1,c.pendingProps=b=D,ou(l,C))(l.flags&131072)!==0&&(fi=!0);else return c.lanes=l.lanes,ma(l,c,C)}return Pf(l,c,g,b,C)}function S0(l,c,g,b){var C=b.children,D=l!==null?l.memoizedState:null;if(l===null&&c.stateNode===null&&(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),b.mode==="hidden"){if((c.flags&128)!==0){if(D=D!==null?D.baseLanes|g:g,l!==null){for(b=c.child=l.child,C=0;b!==null;)C=C|b.lanes|b.childLanes,b=b.sibling;b=C&~D}else b=0,c.child=null;return Kl(l,c,D,g,b)}if((g&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},l!==null&&Ct(c,D!==null?D.cachePool:null),D!==null?Rt(c,D):_t(),_e(c);else return b=c.lanes=536870912,Kl(l,c,D!==null?D.baseLanes|g:g,g,b)}else D!==null?(Ct(c,D.cachePool),Rt(c,D),me(),c.memoizedState=null):(l!==null&&Ct(c,null),_t(),me());return vr(l,c,C,g),c.child}function al(l,c){return l!==null&&l.tag===22||c.stateNode!==null||(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.sibling}function Kl(l,c,g,b,C){var D=at();return D=D===null?null:{parent:Ui?vi._currentValue:vi._currentValue2,pool:D},c.memoizedState={baseLanes:g,cachePool:D},l!==null&&Ct(c,null),_t(),_e(c),l!==null&&St(l,c,b,!0),c.childLanes=C,null}function Lf(l,c){return c=_o({mode:c.mode,children:c.children},l.mode),c.ref=l.ref,l.child=c,c.return=l,c}function Pd(l,c,g){return br(c,l.child,null,g),l=Lf(c,c.pendingProps),l.flags|=2,et(c),c.memoizedState=null,l}function M0(l,c,g){var b=c.pendingProps,C=(c.flags&128)!==0;if(c.flags&=-129,l===null){if(In){if(b.mode==="hidden")return l=Lf(c,b),c.lanes=536870912,al(null,l);if(be(c),(l=gi)?(l=_p(l,Br),l!==null&&(c.memoizedState={dehydrated:l,treeContext:ks!==null?{id:xr,overflow:$s}:null,retryLane:536870912,hydrationErrors:null},g=Qd(l),g.return=c,c.child=g,nr=c,gi=null)):l=null,l===null)throw xt(c);return c.lanes=536870912,null}return Lf(c,b)}var D=l.memoizedState;if(D!==null){var X=D.dehydrated;if(be(c),C)if(c.flags&256)c.flags&=-257,c=Pd(l,c,g);else if(c.memoizedState!==null)c.child=l.child,c.flags|=128,c=null;else throw Error(r(558));else if(fi||St(l,c,g,!1),C=(g&l.childLanes)!==0,fi||C){if(b=Mn,b!==null&&(X=B(b,g),X!==0&&X!==D.retryLane))throw D.retryLane=X,en(l,X),bi(b,l,X),kr;ac(),c=Pd(l,c,g)}else l=D.treeContext,mi&&(gi=ag(X),nr=c,In=!0,Na=null,Br=!1,l!==null&&Ue(c,l)),c=Lf(c,b),c.flags|=4096;return c}return l=ps(l.child,{mode:b.mode,children:b.children}),l.ref=c.ref,c.child=l,l.return=c,l}function au(l,c){var g=c.ref;if(g===null)l!==null&&l.ref!==null&&(c.flags|=4194816);else{if(typeof g!="function"&&typeof g!="object")throw Error(r(284));(l===null||l.ref!==g)&&(c.flags|=4194816)}}function Pf(l,c,g,b,C){return ht(c),g=Et(l,c,g,b,void 0,C),b=fn(),l!==null&&!fi?(jn(l,c,C),ma(l,c,C)):(In&&b&&le(c),c.flags|=1,vr(l,c,g,C),c.child)}function Ud(l,c,g,b,C,D){return ht(c),c.updateQueue=null,g=At(c,b,g,C),jt(l),b=fn(),l!==null&&!fi?(jn(l,c,D),ma(l,c,D)):(In&&b&&le(c),c.flags|=1,vr(l,c,g,D),c.child)}function ol(l,c,g,b,C){if(ht(c),c.stateNode===null){var D=Aa,X=g.contextType;typeof X=="object"&&X!==null&&(D=K(X)),D=new g(b,D),c.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,D.updater=Lu,c.stateNode=D,D._reactInternals=c,D=c.stateNode,D.props=b,D.state=c.memoizedState,D.refs={},k(c),X=g.contextType,D.context=typeof X=="object"&&X!==null?K(X):Aa,D.state=c.memoizedState,X=g.getDerivedStateFromProps,typeof X=="function"&&(Dd(c,g,X,b),D.state=c.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(X=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),X!==D.state&&Lu.enqueueReplaceState(D,D.state,null),ut(c,b,D,C),pt(),D.state=c.memoizedState),typeof D.componentDidMount=="function"&&(c.flags|=4194308),b=!0}else if(l===null){D=c.stateNode;var de=c.memoizedProps,He=sl(g,de);D.props=He;var ft=D.context,Nt=g.contextType;X=Aa,typeof Nt=="object"&&Nt!==null&&(X=K(Nt));var vt=g.getDerivedStateFromProps;Nt=typeof vt=="function"||typeof D.getSnapshotBeforeUpdate=="function",de=c.pendingProps!==de,Nt||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(de||ft!==X)&&g0(c,D,b,X),vs=!1;var Ht=c.memoizedState;D.state=Ht,ut(c,b,D,C),pt(),ft=c.memoizedState,de||Ht!==ft||vs?(typeof vt=="function"&&(Dd(c,g,vt,b),ft=c.memoizedState),(He=vs||Df(c,g,He,b,Ht,ft,X))?(Nt||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(c.flags|=4194308)):(typeof D.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=b,c.memoizedState=ft),D.props=b,D.state=ft,D.context=X,b=He):(typeof D.componentDidMount=="function"&&(c.flags|=4194308),b=!1)}else{D=c.stateNode,Z(l,c),X=c.memoizedProps,Nt=sl(g,X),D.props=Nt,vt=c.pendingProps,Ht=D.context,ft=g.contextType,He=Aa,typeof ft=="object"&&ft!==null&&(He=K(ft)),de=g.getDerivedStateFromProps,(ft=typeof de=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(X!==vt||Ht!==He)&&g0(c,D,b,He),vs=!1,Ht=c.memoizedState,D.state=Ht,ut(c,b,D,C),pt();var hn=c.memoizedState;X!==vt||Ht!==hn||vs||l!==null&&l.dependencies!==null&&Ft(l.dependencies)?(typeof de=="function"&&(Dd(c,g,de,b),hn=c.memoizedState),(Nt=vs||Df(c,g,Nt,b,Ht,hn,He)||l!==null&&l.dependencies!==null&&Ft(l.dependencies))?(ft||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(b,hn,He),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(b,hn,He)),typeof D.componentDidUpdate=="function"&&(c.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof D.componentDidUpdate!="function"||X===l.memoizedProps&&Ht===l.memoizedState||(c.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||X===l.memoizedProps&&Ht===l.memoizedState||(c.flags|=1024),c.memoizedProps=b,c.memoizedState=hn),D.props=b,D.state=hn,D.context=He,b=Nt):(typeof D.componentDidUpdate!="function"||X===l.memoizedProps&&Ht===l.memoizedState||(c.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||X===l.memoizedProps&&Ht===l.memoizedState||(c.flags|=1024),b=!1)}return D=b,au(l,c),b=(c.flags&128)!==0,D||b?(D=c.stateNode,g=b&&typeof g.getDerivedStateFromError!="function"?null:D.render(),c.flags|=1,l!==null&&b?(c.child=br(c,l.child,null,C),c.child=br(c,null,g,C)):vr(l,c,g,C),c.memoizedState=D.state,l=c.child):l=ma(l,c,C),l}function E0(l,c,g,b){return rt(),c.flags|=256,vr(l,c,g,b),c.child}function Od(l){return{baseLanes:l,cachePool:ct()}}function zd(l,c,g){return l=l!==null?l.childLanes&~g:0,c&&(l|=Vr),l}function Bd(l,c,g){var b=c.pendingProps,C=!1,D=(c.flags&128)!==0,X;if((X=D)||(X=l!==null&&l.memoizedState===null?!1:(Ci.current&2)!==0),X&&(C=!0,c.flags&=-129),X=(c.flags&32)!==0,c.flags&=-33,l===null){if(In){if(C?oe(c):me(),(l=gi)?(l=ug(l,Br),l!==null&&(c.memoizedState={dehydrated:l,treeContext:ks!==null?{id:xr,overflow:$s}:null,retryLane:536870912,hydrationErrors:null},g=Qd(l),g.return=c,c.child=g,nr=c,gi=null)):l=null,l===null)throw xt(c);return rh(l)?c.lanes=32:c.lanes=536870912,null}var de=b.children;return b=b.fallback,C?(me(),C=c.mode,de=_o({mode:"hidden",children:de},C),b=Us(b,C,g,null),de.return=c,b.return=c,de.sibling=b,c.child=de,b=c.child,b.memoizedState=Od(g),b.childLanes=zd(l,X,g),c.memoizedState=Al,al(null,b)):(oe(c),Uf(c,de))}var He=l.memoizedState;if(He!==null&&(de=He.dehydrated,de!==null)){if(D)c.flags&256?(oe(c),c.flags&=-257,c=ll(l,c,g)):c.memoizedState!==null?(me(),c.child=l.child,c.flags|=128,c=null):(me(),de=b.fallback,C=c.mode,b=_o({mode:"visible",children:b.children},C),de=Us(de,C,g,null),de.flags|=2,b.return=c,de.return=c,b.sibling=de,c.child=b,br(c,l.child,null,g),b=c.child,b.memoizedState=Od(g),b.childLanes=zd(l,X,g),c.memoizedState=Al,c=al(null,b));else if(oe(c),rh(de))X=sh(de).digest,b=Error(r(419)),b.stack="",b.digest=X,Xe({value:b,source:null,stack:null}),c=ll(l,c,g);else if(fi||St(l,c,g,!1),X=(g&l.childLanes)!==0,fi||X){if(X=Mn,X!==null&&(b=B(X,g),b!==0&&b!==He.retryLane))throw He.retryLane=b,en(l,b),bi(X,l,b),kr;Po(de)||ac(),c=ll(l,c,g)}else Po(de)?(c.flags|=192,c.child=l.child,c=null):(l=He.treeContext,mi&&(gi=og(de),nr=c,In=!0,Na=null,Br=!1,l!==null&&Ue(c,l)),c=Uf(c,b.children),c.flags|=4096);return c}return C?(me(),de=b.fallback,C=c.mode,He=l.child,D=He.sibling,b=ps(He,{mode:"hidden",children:b.children}),b.subtreeFlags=He.subtreeFlags&65011712,D!==null?de=ps(D,de):(de=Us(de,C,g,null),de.flags|=2),de.return=c,b.return=c,b.sibling=de,c.child=b,al(null,b),b=c.child,de=l.child.memoizedState,de===null?de=Od(g):(C=de.cachePool,C!==null?(He=Ui?vi._currentValue:vi._currentValue2,C=C.parent!==He?{parent:He,pool:He}:C):C=ct(),de={baseLanes:de.baseLanes|g,cachePool:C}),b.memoizedState=de,b.childLanes=zd(l,X,g),c.memoizedState=Al,al(l.child,b)):(oe(c),g=l.child,l=g.sibling,g=ps(g,{mode:"visible",children:b.children}),g.return=c,g.sibling=null,l!==null&&(X=c.deletions,X===null?(c.deletions=[l],c.flags|=16):X.push(l)),c.child=g,c.memoizedState=null,g)}function Uf(l,c){return c=_o({mode:"visible",children:c},l.mode),c.return=l,l.child=c}function _o(l,c){return l=t(22,l,null,c),l.lanes=0,l}function ll(l,c,g){return br(c,l.child,null,g),l=Uf(c,c.pendingProps.children),l.flags|=2,c.memoizedState=null,l}function T0(l,c,g){l.lanes|=c;var b=l.alternate;b!==null&&(b.lanes|=c),$(l.return,c,g)}function Ql(l,c,g,b,C,D){var X=l.memoizedState;X===null?l.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:b,tail:g,tailMode:C,treeForkCount:D}:(X.isBackwards=c,X.rendering=null,X.renderingStartTime=0,X.last=b,X.tail=g,X.tailMode=C,X.treeForkCount=D)}function Fd(l,c,g){var b=c.pendingProps,C=b.revealOrder,D=b.tail;b=b.children;var X=Ci.current,de=(X&2)!==0;if(de?(X=X&1|2,c.flags|=128):X&=1,M(Ci,X),vr(l,c,b,g),b=In?Nu:0,!de&&l!==null&&(l.flags&128)!==0)e:for(l=c.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&T0(l,g,c);else if(l.tag===19)T0(l,g,c);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===c)break e;for(;l.sibling===null;){if(l.return===null||l.return===c)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}switch(C){case"forwards":for(g=c.child,C=null;g!==null;)l=g.alternate,l!==null&&mt(l)===null&&(C=g),g=g.sibling;g=C,g===null?(C=c.child,c.child=null):(C=g.sibling,g.sibling=null),Ql(c,!1,C,g,D,b);break;case"backwards":case"unstable_legacy-backwards":for(g=null,C=c.child,c.child=null;C!==null;){if(l=C.alternate,l!==null&&mt(l)===null){c.child=C;break}l=C.sibling,C.sibling=g,g=C,C=l}Ql(c,!0,g,null,D,b);break;case"together":Ql(c,!1,null,null,void 0,b);break;default:c.memoizedState=null}return c.child}function ma(l,c,g){if(l!==null&&(c.dependencies=l.dependencies),so|=c.lanes,(g&c.childLanes)===0)if(l!==null){if(St(l,c,g,!1),(g&c.childLanes)===0)return null}else return null;if(l!==null&&c.child!==l.child)throw Error(r(153));if(c.child!==null){for(l=c.child,g=ps(l,l.pendingProps),c.child=g,g.return=c;l.sibling!==null;)l=l.sibling,g=g.sibling=ps(l,l.pendingProps),g.return=c;g.sibling=null}return c.child}function ou(l,c){return(l.lanes&c)!==0?!0:(l=l.dependencies,!!(l!==null&&Ft(l)))}function kd(l,c,g){switch(c.tag){case 3:lt(c,c.stateNode.containerInfo),qe(c,vi,l.memoizedState.cache),rt();break;case 27:case 5:Re(c);break;case 4:lt(c,c.stateNode.containerInfo);break;case 10:qe(c,c.type,c.memoizedProps.value);break;case 31:if(c.memoizedState!==null)return c.flags|=128,be(c),null;break;case 13:var b=c.memoizedState;if(b!==null)return b.dehydrated!==null?(oe(c),c.flags|=128,null):(g&c.child.childLanes)!==0?Bd(l,c,g):(oe(c),l=ma(l,c,g),l!==null?l.sibling:null);oe(c);break;case 19:var C=(l.flags&128)!==0;if(b=(g&c.childLanes)!==0,b||(St(l,c,g,!1),b=(g&c.childLanes)!==0),C){if(b)return Fd(l,c,g);c.flags|=128}if(C=c.memoizedState,C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),M(Ci,Ci.current),b)break;return null;case 22:return c.lanes=0,S0(l,c,g,c.pendingProps);case 24:qe(c,vi,l.memoizedState.cache)}return ma(l,c,g)}function Vd(l,c,g){if(l!==null)if(l.memoizedProps!==c.pendingProps)fi=!0;else{if(!ou(l,g)&&(c.flags&128)===0)return fi=!1,kd(l,c,g);fi=(l.flags&131072)!==0}else fi=!1,In&&(c.flags&1048576)!==0&&j(c,Nu,c.index);switch(c.lanes=0,c.tag){case 16:e:{var b=c.pendingProps;if(l=un(c.elementType),c.type=l,typeof l=="function")ul(l)?(b=sl(l,b),c.tag=1,c=ol(null,c,l,b,g)):(c.tag=0,c=Pf(null,c,l,b,g));else{if(l!=null){var C=l.$$typeof;if(C===uc){c.tag=11,c=y0(null,c,l,b,g);break e}else if(C===Jf){c.tag=14,c=b0(null,c,l,b,g);break e}}throw c=x(l)||l,Error(r(306,c,""))}}return c;case 0:return Pf(l,c,c.type,c.pendingProps,g);case 1:return b=c.type,C=sl(b,c.pendingProps),ol(l,c,b,C,g);case 3:e:{if(lt(c,c.stateNode.containerInfo),l===null)throw Error(r(387));var D=c.pendingProps;C=c.memoizedState,b=C.element,Z(l,c),ut(c,D,null,g);var X=c.memoizedState;if(D=X.cache,qe(c,vi,D),D!==C.cache&&Pt(c,[vi],g,!0),pt(),D=X.element,mi&&C.isDehydrated)if(C={element:D,isDehydrated:!1,cache:X.cache},c.updateQueue.baseState=C,c.memoizedState=C,c.flags&256){c=E0(l,c,D,g);break e}else if(D!==b){b=ae(Error(r(424)),c),Xe(b),c=E0(l,c,D,g);break e}else for(mi&&(gi=sg(c.stateNode.containerInfo),nr=c,In=!0,Na=null,Br=!0),g=zp(c,null,D,g),c.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling;else{if(rt(),D===b){c=ma(l,c,g);break e}vr(l,c,D,g)}c=c.child}return c;case 26:if(Bs)return au(l,c),l===null?(g=wp(c.type,null,c.pendingProps,null))?c.memoizedState=g:In||(c.stateNode=ch(c.type,c.pendingProps,yr.current,c)):c.memoizedState=wp(c.type,l.memoizedProps,c.pendingProps,l.memoizedState),null;case 27:if(tr)return Re(c),l===null&&tr&&In&&(b=c.stateNode=uh(c.type,c.pendingProps,yr.current,dr.current,!1),nr=c,Br=!0,gi=bp(c.type,b,gi)),vr(l,c,c.pendingProps.children,g),au(l,c),l===null&&(c.flags|=4194304),c.child;case 5:return l===null&&In&&(yg(c.type,c.pendingProps,dr.current),(C=b=gi)&&(b=lg(b,c.type,c.pendingProps,Br),b!==null?(c.stateNode=b,nr=c,gi=rg(b),Br=!1,C=!0):C=!1),C||xt(c)),Re(c),C=c.type,D=c.pendingProps,X=l!==null?l.memoizedProps:null,b=D.children,zr(C,D)?b=null:X!==null&&zr(C,X)&&(c.flags|=32),c.memoizedState!==null&&(C=Et(l,c,Gt,null,null,g),Ui?yl._currentValue=C:yl._currentValue2=C),au(l,c),vr(l,c,b,g),c.child;case 6:return l===null&&In&&(Tp(c.pendingProps,dr.current),(l=g=gi)&&(g=cg(g,c.pendingProps,Br),g!==null?(c.stateNode=g,nr=c,gi=null,l=!0):l=!1),l||xt(c)),null;case 13:return Bd(l,c,g);case 4:return lt(c,c.stateNode.containerInfo),b=c.pendingProps,l===null?c.child=br(c,null,b,g):vr(l,c,b,g),c.child;case 11:return y0(l,c,c.type,c.pendingProps,g);case 7:return vr(l,c,c.pendingProps,g),c.child;case 8:return vr(l,c,c.pendingProps.children,g),c.child;case 12:return vr(l,c,c.pendingProps.children,g),c.child;case 10:return b=c.pendingProps,qe(c,c.type,b.value),vr(l,c,b.children,g),c.child;case 9:return C=c.type._context,b=c.pendingProps.children,ht(c),C=K(C),b=b(C),c.flags|=1,vr(l,c,b,g),c.child;case 14:return b0(l,c,c.type,c.pendingProps,g);case 15:return _0(l,c,c.type,c.pendingProps,g);case 19:return Fd(l,c,g);case 31:return M0(l,c,g);case 22:return S0(l,c,g,c.pendingProps);case 24:return ht(c),b=K(vi),l===null?(C=at(),C===null&&(C=Mn,D=ze(),C.pooledCache=D,D.refCount++,D!==null&&(C.pooledCacheLanes|=g),C=D),c.memoizedState={parent:b,cache:C},k(c),qe(c,vi,C)):((l.lanes&g)!==0&&(Z(l,c),ut(c,null,null,g),pt()),C=l.memoizedState,D=c.memoizedState,C.parent!==b?(C={parent:b,cache:b},c.memoizedState=C,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=C),qe(c,vi,b)):(b=D.cache,qe(c,vi,b),b!==C.cache&&Pt(c,[vi],g,!0))),vr(l,c,c.pendingProps.children,g),c.child;case 29:throw c.pendingProps}throw Error(r(156,c.tag))}function Ns(l){l.flags|=4}function lu(l){ms&&(l.flags|=8)}function w0(l,c){if(l!==null&&l.child===c.child)return!1;if((c.flags&16)!==0)return!0;for(l=c.child;l!==null;){if((l.flags&8218)!==0||(l.subtreeFlags&8218)!==0)return!0;l=l.sibling}return!1}function Hd(l,c,g,b){if(Un)for(g=c.child;g!==null;){if(g.tag===5||g.tag===6)Su(l,g.stateNode);else if(!(g.tag===4||tr&&g.tag===27)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===c)break;for(;g.sibling===null;){if(g.return===null||g.return===c)return;g=g.return}g.sibling.return=g.return,g=g.sibling}else if(ms)for(var C=c.child;C!==null;){if(C.tag===5){var D=C.stateNode;g&&b&&(D=eg(D,C.type,C.memoizedProps)),Su(l,D)}else if(C.tag===6)D=C.stateNode,g&&b&&(D=xp(D,C.memoizedProps)),Su(l,D);else if(C.tag!==4){if(C.tag===22&&C.memoizedState!==null)D=C.child,D!==null&&(D.return=C),Hd(l,C,!0,!0);else if(C.child!==null){C.child.return=C,C=C.child;continue}}if(C===c)break;for(;C.sibling===null;){if(C.return===null||C.return===c)return;C=C.return}C.sibling.return=C.return,C=C.sibling}}function A0(l,c,g,b){var C=!1;if(ms)for(var D=c.child;D!==null;){if(D.tag===5){var X=D.stateNode;g&&b&&(X=eg(X,D.type,D.memoizedProps)),gp(l,X)}else if(D.tag===6)X=D.stateNode,g&&b&&(X=xp(X,D.memoizedProps)),gp(l,X);else if(D.tag!==4){if(D.tag===22&&D.memoizedState!==null)C=D.child,C!==null&&(C.return=D),A0(l,D,!0,!0),C=!0;else if(D.child!==null){D.child.return=D,D=D.child;continue}}if(D===c)break;for(;D.sibling===null;){if(D.return===null||D.return===c)return C;D=D.return}D.sibling.return=D.return,D=D.sibling}return C}function C0(l,c){if(ms&&w0(l,c)){l=c.stateNode;var g=l.containerInfo,b=mp();A0(b,c,!1,!1),l.pendingChildren=b,Ns(c),$0(g,b)}}function Gd(l,c,g,b){if(Un)l.memoizedProps!==b&&Ns(c);else if(ms){var C=l.stateNode,D=l.memoizedProps;if((l=w0(l,c))||D!==b){var X=dr.current;D=J0(C,g,D,b,!l,null),D===C?c.stateNode=C:(lu(c),Yr(D,g,b,X)&&Ns(c),c.stateNode=D,l&&Hd(D,c,!1,!1))}else c.stateNode=C}}function Pr(l,c,g,b,C){if((l.mode&32)!==0&&(g===null?Mu(c,b):mc(c,g,b))){if(l.flags|=16777216,(C&335544128)===C||rp(c,b))if(_i(l.stateNode,c,b))l.flags|=8192;else if(Pn())l.flags|=8192;else throw Fr=Da,_h}else l.flags&=-16777217}function Jl(l,c){if(Np(c)){if(l.flags|=16777216,!Dp(c))if(Pn())l.flags|=8192;else throw Fr=Da,_h}else l.flags&=-16777217}function cu(l,c){c!==null&&(l.flags|=4),l.flags&16384&&(c=l.tag!==22?P():536870912,l.lanes|=c,Ec|=c)}function $l(l,c){if(!In)switch(l.tailMode){case"hidden":c=l.tail;for(var g=null;c!==null;)c.alternate!==null&&(g=c),c=c.sibling;g===null?l.tail=null:g.sibling=null;break;case"collapsed":g=l.tail;for(var b=null;g!==null;)g.alternate!==null&&(b=g),g=g.sibling;b===null?c||l.tail===null?l.tail=null:l.tail.sibling=null:b.sibling=null}}function ni(l){var c=l.alternate!==null&&l.alternate.child===l.child,g=0,b=0;if(c)for(var C=l.child;C!==null;)g|=C.lanes|C.childLanes,b|=C.subtreeFlags&65011712,b|=C.flags&65011712,C.return=l,C=C.sibling;else for(C=l.child;C!==null;)g|=C.lanes|C.childLanes,b|=C.subtreeFlags,b|=C.flags,C.return=l,C=C.sibling;return l.subtreeFlags|=b,l.childLanes=g,c}function R0(l,c,g){var b=c.pendingProps;switch(Me(c),c.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ni(c),null;case 1:return ni(c),null;case 3:return g=c.stateNode,b=null,l!==null&&(b=l.memoizedState.cache),c.memoizedState.cache!==b&&(c.flags|=2048),ot(vi),pe(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(l===null||l.child===null)&&(xe(c)?Ns(c):l===null||l.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Le())),C0(l,c),ni(c),null;case 26:if(Bs){var C=c.type,D=c.memoizedState;return l===null?(Ns(c),D!==null?(ni(c),Jl(c,D)):(ni(c),Pr(c,C,null,b,g))):D?D!==l.memoizedState?(Ns(c),ni(c),Jl(c,D)):(ni(c),c.flags&=-16777217):(D=l.memoizedProps,Un?D!==b&&Ns(c):Gd(l,c,C,b),ni(c),Pr(c,C,D,b,g)),null}case 27:if(tr){if(it(c),g=yr.current,C=c.type,l!==null&&c.stateNode!=null)Un?l.memoizedProps!==b&&Ns(c):Gd(l,c,C,b);else{if(!b){if(c.stateNode===null)throw Error(r(166));return ni(c),null}l=dr.current,xe(c)?dt(c,l):(l=uh(C,b,g,l,!0),c.stateNode=l,Ns(c))}return ni(c),null}case 5:if(it(c),C=c.type,l!==null&&c.stateNode!=null)Gd(l,c,C,b);else{if(!b){if(c.stateNode===null)throw Error(r(166));return ni(c),null}if(D=dr.current,xe(c))dt(c,D),gg(c.stateNode,C,b,D)&&(c.flags|=64);else{var X=np(C,b,yr.current,D,c);lu(c),Hd(X,c,!1,!1),c.stateNode=X,Yr(X,C,b,D)&&Ns(c)}}return ni(c),Pr(c,c.type,l===null?null:l.memoizedProps,c.pendingProps,g),null;case 6:if(l&&c.stateNode!=null)g=l.memoizedProps,Un?g!==b&&Ns(c):ms&&(g!==b?(l=yr.current,g=dr.current,lu(c),c.stateNode=$a(b,l,g,c)):c.stateNode=l.stateNode);else{if(typeof b!="string"&&c.stateNode===null)throw Error(r(166));if(l=yr.current,g=dr.current,xe(c)){if(!mi)throw Error(r(176));if(l=c.stateNode,g=c.memoizedProps,b=null,C=nr,C!==null)switch(C.tag){case 27:case 5:b=C.memoizedProps}zy(l,g,c,b)||xt(c,!0)}else lu(c),c.stateNode=$a(b,l,g,c)}return ni(c),null;case 31:if(g=c.memoizedState,l===null||l.memoizedState!==null){if(b=xe(c),g!==null){if(l===null){if(!b)throw Error(r(318));if(!mi)throw Error(r(556));if(l=c.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(r(557));Sp(l,c)}else rt(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;ni(c),l=!1}else g=Le(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=g),l=!0;if(!l)return c.flags&256?(et(c),c):(et(c),null);if((c.flags&128)!==0)throw Error(r(558))}return ni(c),null;case 13:if(b=c.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(C=xe(c),b!==null&&b.dehydrated!==null){if(l===null){if(!C)throw Error(r(318));if(!mi)throw Error(r(344));if(C=c.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(r(317));hg(C,c)}else rt(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;ni(c),C=!1}else C=Le(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=C),C=!0;if(!C)return c.flags&256?(et(c),c):(et(c),null)}return et(c),(c.flags&128)!==0?(c.lanes=g,c):(g=b!==null,l=l!==null&&l.memoizedState!==null,g&&(b=c.child,C=null,b.alternate!==null&&b.alternate.memoizedState!==null&&b.alternate.memoizedState.cachePool!==null&&(C=b.alternate.memoizedState.cachePool.pool),D=null,b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(D=b.memoizedState.cachePool.pool),D!==C&&(b.flags|=2048)),g!==l&&g&&(c.child.flags|=8192),cu(c,c.updateQueue),ni(c),null);case 4:return pe(),C0(l,c),l===null&&$n(c.stateNode.containerInfo),ni(c),null;case 10:return ot(c.type),ni(c),null;case 19:if(_(Ci),b=c.memoizedState,b===null)return ni(c),null;if(C=(c.flags&128)!==0,D=b.rendering,D===null)if(C)$l(b,!1);else{if(Ei!==0||l!==null&&(l.flags&128)!==0)for(l=c.child;l!==null;){if(D=mt(l),D!==null){for(c.flags|=128,$l(b,!1),l=D.updateQueue,c.updateQueue=l,cu(c,l),c.subtreeFlags=0,l=g,g=c.child;g!==null;)qf(g,l),g=g.sibling;return M(Ci,Ci.current&1|2),In&&re(c,b.treeForkCount),c.child}l=l.sibling}b.tail!==null&&Ar()>Wo&&(c.flags|=128,C=!0,$l(b,!1),c.lanes=4194304)}else{if(!C)if(l=mt(D),l!==null){if(c.flags|=128,C=!0,l=l.updateQueue,c.updateQueue=l,cu(c,l),$l(b,!0),b.tail===null&&b.tailMode==="hidden"&&!D.alternate&&!In)return ni(c),null}else 2*Ar()-b.renderingStartTime>Wo&&g!==536870912&&(c.flags|=128,C=!0,$l(b,!1),c.lanes=4194304);b.isBackwards?(D.sibling=c.child,c.child=D):(l=b.last,l!==null?l.sibling=D:c.child=D,b.last=D)}return b.tail!==null?(l=b.tail,b.rendering=l,b.tail=l.sibling,b.renderingStartTime=Ar(),l.sibling=null,g=Ci.current,M(Ci,C?g&1|2:g&1),In&&re(c,b.treeForkCount),l):(ni(c),null);case 22:case 23:return et(c),G(),b=c.memoizedState!==null,l!==null?l.memoizedState!==null!==b&&(c.flags|=8192):b&&(c.flags|=8192),b?(g&536870912)!==0&&(c.flags&128)===0&&(ni(c),c.subtreeFlags&6&&(c.flags|=8192)):ni(c),g=c.updateQueue,g!==null&&cu(c,g.retryQueue),g=null,l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),b=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(b=c.memoizedState.cachePool.pool),b!==g&&(c.flags|=2048),l!==null&&_(zo),null;case 24:return g=null,l!==null&&(g=l.memoizedState.cache),c.memoizedState.cache!==g&&(c.flags|=2048),ot(vi),ni(c),null;case 25:return null;case 30:return null}throw Error(r(156,c.tag))}function jd(l,c){switch(Me(c),c.tag){case 1:return l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 3:return ot(vi),pe(),l=c.flags,(l&65536)!==0&&(l&128)===0?(c.flags=l&-65537|128,c):null;case 26:case 27:case 5:return it(c),null;case 31:if(c.memoizedState!==null){if(et(c),c.alternate===null)throw Error(r(340));rt()}return l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 13:if(et(c),l=c.memoizedState,l!==null&&l.dehydrated!==null){if(c.alternate===null)throw Error(r(340));rt()}return l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 19:return _(Ci),null;case 4:return pe(),null;case 10:return ot(c.type),null;case 22:case 23:return et(c),G(),l!==null&&_(zo),l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 24:return ot(vi),null;case 25:return null;default:return null}}function N0(l,c){switch(Me(c),c.tag){case 3:ot(vi),pe();break;case 26:case 27:case 5:it(c);break;case 4:pe();break;case 31:c.memoizedState!==null&&et(c);break;case 13:et(c);break;case 19:_(Ci);break;case 10:ot(c.type);break;case 22:case 23:et(c),G(),l!==null&&_(zo);break;case 24:ot(vi)}}function ga(l,c){try{var g=c.updateQueue,b=g!==null?g.lastEffect:null;if(b!==null){var C=b.next;g=C;do{if((g.tag&l)===l){b=void 0;var D=g.create,X=g.inst;b=D(),X.destroy=b}g=g.next}while(g!==C)}}catch(de){an(c,c.return,de)}}function va(l,c,g){try{var b=c.updateQueue,C=b!==null?b.lastEffect:null;if(C!==null){var D=C.next;b=D;do{if((b.tag&l)===l){var X=b.inst,de=X.destroy;if(de!==void 0){X.destroy=void 0,C=c;var He=g,ft=de;try{ft()}catch(Nt){an(C,He,Nt)}}}b=b.next}while(b!==D)}}catch(Nt){an(c,c.return,Nt)}}function ec(l){var c=l.updateQueue;if(c!==null){var g=l.stateNode;try{Mt(c,g)}catch(b){an(l,l.return,b)}}}function Of(l,c,g){g.props=sl(l.type,l.memoizedProps),g.state=l.memoizedState;try{g.componentWillUnmount()}catch(b){an(l,c,b)}}function tc(l,c){try{var g=l.ref;if(g!==null){switch(l.tag){case 26:case 27:case 5:var b=hc(l.stateNode);break;case 30:b=l.stateNode;break;default:b=l.stateNode}typeof g=="function"?l.refCleanup=g(b):g.current=b}}catch(C){an(l,c,C)}}function wr(l,c){var g=l.ref,b=l.refCleanup;if(g!==null)if(typeof b=="function")try{b()}catch(C){an(l,c,C)}finally{l.refCleanup=null,l=l.alternate,l!=null&&(l.refCleanup=null)}else if(typeof g=="function")try{g(null)}catch(C){an(l,c,C)}else g.current=null}function cl(l){var c=l.type,g=l.memoizedProps,b=l.stateNode;try{j0(b,c,g,l)}catch(C){an(l,l.return,C)}}function uu(l,c,g){try{W0(l.stateNode,l.type,g,c,l)}catch(b){an(l,l.return,b)}}function Wd(l){return l.tag===5||l.tag===3||(Bs?l.tag===26:!1)||(tr?l.tag===27&&bl(l.type):!1)||l.tag===4}function Wa(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||Wd(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(tr&&l.tag===27&&bl(l.type)||l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function zf(l,c,g){var b=l.tag;if(b===5||b===6)l=l.stateNode,c?q0(g,l,c):fp(g,l);else if(b!==4&&(tr&&b===27&&bl(l.type)&&(g=l.stateNode,c=null),l=l.child,l!==null))for(zf(l,c,g),l=l.sibling;l!==null;)zf(l,c,g),l=l.sibling}function fu(l,c,g){var b=l.tag;if(b===5||b===6)l=l.stateNode,c?X0(g,l,c):up(g,l);else if(b!==4&&(tr&&b===27&&bl(l.type)&&(g=l.stateNode),l=l.child,l!==null))for(fu(l,c,g),l=l.sibling;l!==null;)fu(l,c,g),l=l.sibling}function Xd(l,c,g){l=l.containerInfo;try{vp(l,g)}catch(b){an(c,c.return,b)}}function D0(l){var c=l.stateNode,g=l.memoizedProps;try{Xi(l.type,g,c,l)}catch(b){an(l,l.return,b)}}function Ly(l,c){for($f(l.containerInfo),Bi=c;Bi!==null;)if(l=Bi,c=l.child,(l.subtreeFlags&1028)!==0&&c!==null)c.return=l,Bi=c;else for(;Bi!==null;){l=Bi;var g=l.alternate;switch(c=l.flags,l.tag){case 0:if((c&4)!==0&&(c=l.updateQueue,c=c!==null?c.events:null,c!==null))for(var b=0;b<c.length;b++){var C=c[b];C.ref.impl=C.nextImpl}break;case 11:case 15:break;case 1:if((c&1024)!==0&&g!==null){c=void 0,b=l,C=g.memoizedProps,g=g.memoizedState;var D=b.stateNode;try{var X=sl(b.type,C);c=D.getSnapshotBeforeUpdate(X,g),D.__reactInternalSnapshotBeforeUpdate=c}catch(de){an(b,b.return,de)}}break;case 3:(c&1024)!==0&&Un&&pp(l.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((c&1024)!==0)throw Error(r(163))}if(c=l.sibling,c!==null){c.return=l.return,Bi=c;break}Bi=l.return}}function I0(l,c,g){var b=g.flags;switch(g.tag){case 0:case 11:case 15:Ur(l,g),b&4&&ga(5,g);break;case 1:if(Ur(l,g),b&4)if(l=g.stateNode,c===null)try{l.componentDidMount()}catch(X){an(g,g.return,X)}else{var C=sl(g.type,c.memoizedProps);c=c.memoizedState;try{l.componentDidUpdate(C,c,l.__reactInternalSnapshotBeforeUpdate)}catch(X){an(g,g.return,X)}}b&64&&ec(g),b&512&&tc(g,g.return);break;case 3:if(Ur(l,g),b&64&&(b=g.updateQueue,b!==null)){if(l=null,g.child!==null)switch(g.child.tag){case 27:case 5:l=hc(g.child.stateNode);break;case 1:l=g.child.stateNode}try{Mt(b,l)}catch(X){an(g,g.return,X)}}break;case 27:tr&&c===null&&b&4&&D0(g);case 26:case 5:if(Ur(l,g),c===null){if(b&4)cl(g);else if(b&64){l=g.type,c=g.memoizedProps,C=g.stateNode;try{pg(C,l,c,g)}catch(X){an(g,g.return,X)}}}b&512&&tc(g,g.return);break;case 12:Ur(l,g);break;case 31:Ur(l,g),b&4&&Is(l,g);break;case 13:Ur(l,g),b&4&&du(l,g),b&64&&(b=g.memoizedState,b!==null&&(b=b.dehydrated,b!==null&&(g=Py.bind(null,g),ah(b,g))));break;case 22:if(b=g.memoizedState!==null||Ri,!b){c=c!==null&&c.memoizedState!==null||Ni,C=Ri;var D=Ni;Ri=b,(Ni=c)&&!D?Ps(l,g,(g.subtreeFlags&8772)!==0):Ur(l,g),Ri=C,Ni=D}break;case 30:break;default:Ur(l,g)}}function qd(l){var c=l.alternate;c!==null&&(l.alternate=null,qd(c)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(c=l.stateNode,c!==null&&eh(c)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function Ds(l,c,g){for(g=g.child;g!==null;)hu(l,c,g),g=g.sibling}function hu(l,c,g){if(Qr&&typeof Qr.onCommitFiberUnmount=="function")try{Qr.onCommitFiberUnmount(Ml,g)}catch{}switch(g.tag){case 26:if(Bs){Ni||wr(g,c),Ds(l,c,g),g.memoizedState?Uo(g.memoizedState):g.stateNode&&Rp(g.stateNode);break}case 27:if(tr){Ni||wr(g,c);var b=Mi,C=Fi;bl(g.type)&&(Mi=g.stateNode,Fi=!1),Ds(l,c,g),hr(g.stateNode),Mi=b,Fi=C;break}case 5:Ni||wr(g,c);case 6:if(Un){if(b=Mi,C=Fi,Mi=null,Ds(l,c,g),Mi=b,Fi=C,Mi!==null)if(Fi)try{hp(Mi,g.stateNode)}catch(D){an(g,c,D)}else try{Y0(Mi,g.stateNode)}catch(D){an(g,c,D)}}else Ds(l,c,g);break;case 18:Un&&Mi!==null&&(Fi?oh(Mi,g.stateNode):Ep(Mi,g.stateNode));break;case 4:Un?(b=Mi,C=Fi,Mi=g.stateNode.containerInfo,Fi=!0,Ds(l,c,g),Mi=b,Fi=C):(ms&&Xd(g.stateNode,g,mp()),Ds(l,c,g));break;case 0:case 11:case 14:case 15:va(2,g,c),Ni||va(4,g,c),Ds(l,c,g);break;case 1:Ni||(wr(g,c),b=g.stateNode,typeof b.componentWillUnmount=="function"&&Of(g,c,b)),Ds(l,c,g);break;case 21:Ds(l,c,g);break;case 22:Ni=(b=Ni)||g.memoizedState!==null,Ds(l,c,g),Ni=b;break;default:Ds(l,c,g)}}function Is(l,c){if(mi&&c.memoizedState===null&&(l=c.alternate,l!==null&&(l=l.memoizedState,l!==null))){l=l.dehydrated;try{By(l)}catch(g){an(c,c.return,g)}}}function du(l,c){if(mi&&c.memoizedState===null&&(l=c.alternate,l!==null&&(l=l.memoizedState,l!==null&&(l=l.dehydrated,l!==null))))try{Fy(l)}catch(g){an(c,c.return,g)}}function Ls(l){switch(l.tag){case 31:case 13:case 19:var c=l.stateNode;return c===null&&(c=l.stateNode=new Fp),c;case 22:return l=l.stateNode,c=l._retryCache,c===null&&(c=l._retryCache=new Fp),c;default:throw Error(r(435,l.tag))}}function Xa(l,c){var g=Ls(l);c.forEach(function(b){if(!g.has(b)){g.add(b);var C=Uy.bind(null,l,b);b.then(C,C)}})}function ur(l,c){var g=c.deletions;if(g!==null)for(var b=0;b<g.length;b++){var C=g[b],D=l,X=c;if(Un){var de=X;e:for(;de!==null;){switch(de.tag){case 27:if(tr){if(bl(de.type)){Mi=de.stateNode,Fi=!1;break e}break}case 5:Mi=de.stateNode,Fi=!1;break e;case 3:case 4:Mi=de.stateNode.containerInfo,Fi=!0;break e}de=de.return}if(Mi===null)throw Error(r(160));hu(D,X,C),Mi=null,Fi=!1}else hu(D,X,C);D=C.alternate,D!==null&&(D.return=null),C.return=null}if(c.subtreeFlags&13886)for(c=c.child;c!==null;)pu(c,l),c=c.sibling}function pu(l,c){var g=l.alternate,b=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:ur(c,l),fr(l),b&4&&(va(3,l,l.return),ga(3,l),va(5,l,l.return));break;case 1:ur(c,l),fr(l),b&512&&(Ni||g===null||wr(g,g.return)),b&64&&Ri&&(l=l.updateQueue,l!==null&&(b=l.callbacks,b!==null&&(g=l.shared.hiddenCallbacks,l.shared.hiddenCallbacks=g===null?b:g.concat(b))));break;case 26:if(Bs){var C=Qn;if(ur(c,l),fr(l),b&512&&(Ni||g===null||wr(g,g.return)),b&4){b=g!==null?g.memoizedState:null;var D=l.memoizedState;g===null?D===null?l.stateNode===null?l.stateNode=bg(C,l.type,l.memoizedProps,l):Cp(C,l.type,l.stateNode):l.stateNode=Ap(C,D,l.memoizedProps):b!==D?(b===null?g.stateNode!==null&&Rp(g.stateNode):Uo(b),D===null?Cp(C,l.type,l.stateNode):Ap(C,D,l.memoizedProps)):D===null&&l.stateNode!==null&&uu(l,l.memoizedProps,g.memoizedProps)}break}case 27:if(tr){ur(c,l),fr(l),b&512&&(Ni||g===null||wr(g,g.return)),g!==null&&b&4&&uu(l,l.memoizedProps,g.memoizedProps);break}case 5:if(ur(c,l),fr(l),b&512&&(Ni||g===null||wr(g,g.return)),Un){if(l.flags&32){C=l.stateNode;try{dp(C)}catch(vt){an(l,l.return,vt)}}b&4&&l.stateNode!=null&&(C=l.memoizedProps,uu(l,C,g!==null?g.memoizedProps:C)),b&1024&&(yc=!0)}else ms&&l.alternate!==null&&(l.alternate.stateNode=l.stateNode);break;case 6:if(ur(c,l),fr(l),b&4&&Un){if(l.stateNode===null)throw Error(r(162));b=l.memoizedProps,g=g!==null?g.memoizedProps:b,C=l.stateNode;try{G0(C,g,b)}catch(vt){an(l,l.return,vt)}}break;case 3:if(Bs?(_g(),C=Qn,Qn=wu(c.containerInfo),ur(c,l),Qn=C):ur(c,l),fr(l),b&4){if(Un&&mi&&g!==null&&g.memoizedState.isDehydrated)try{mg(c.containerInfo)}catch(vt){an(l,l.return,vt)}if(ms){b=c.containerInfo,g=c.pendingChildren;try{vp(b,g)}catch(vt){an(l,l.return,vt)}}}yc&&(yc=!1,Bf(l));break;case 4:Bs?(g=Qn,Qn=wu(l.stateNode.containerInfo),ur(c,l),fr(l),Qn=g):(ur(c,l),fr(l)),b&4&&ms&&Xd(l.stateNode,l,l.stateNode.pendingChildren);break;case 12:ur(c,l),fr(l);break;case 31:ur(c,l),fr(l),b&4&&(b=l.updateQueue,b!==null&&(l.updateQueue=null,Xa(l,b)));break;case 13:ur(c,l),fr(l),l.child.flags&8192&&l.memoizedState!==null!=(g!==null&&g.memoizedState!==null)&&(Ou=Ar()),b&4&&(b=l.updateQueue,b!==null&&(l.updateQueue=null,Xa(l,b)));break;case 22:C=l.memoizedState!==null;var X=g!==null&&g.memoizedState!==null,de=Ri,He=Ni;if(Ri=de||C,Ni=He||X,ur(c,l),Ni=He,Ri=de,fr(l),b&8192&&(c=l.stateNode,c._visibility=C?c._visibility&-2:c._visibility|1,C&&(g===null||X||Ri||Ni||So(l)),Un)){e:if(g=null,Un)for(c=l;;){if(c.tag===5||Bs&&c.tag===26){if(g===null){X=g=c;try{D=X.stateNode,C?Oy(D):K0(X.stateNode,X.memoizedProps)}catch(vt){an(X,X.return,vt)}}}else if(c.tag===6){if(g===null){X=c;try{var ft=X.stateNode;C?Z0(ft):Q0(ft,X.memoizedProps)}catch(vt){an(X,X.return,vt)}}}else if(c.tag===18){if(g===null){X=c;try{var Nt=X.stateNode;C?vg(Nt):xg(X.stateNode)}catch(vt){an(X,X.return,vt)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===l)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break e;for(;c.sibling===null;){if(c.return===null||c.return===l)break e;g===c&&(g=null),c=c.return}g===c&&(g=null),c.sibling.return=c.return,c=c.sibling}}b&4&&(b=l.updateQueue,b!==null&&(g=b.retryQueue,g!==null&&(b.retryQueue=null,Xa(l,g))));break;case 19:ur(c,l),fr(l),b&4&&(b=l.updateQueue,b!==null&&(l.updateQueue=null,Xa(l,b)));break;case 30:break;case 21:break;default:ur(c,l),fr(l)}}function fr(l){var c=l.flags;if(c&2){try{for(var g,b=l.return;b!==null;){if(Wd(b)){g=b;break}b=b.return}if(Un){if(g==null)throw Error(r(160));switch(g.tag){case 27:if(tr){var C=g.stateNode,D=Wa(l);fu(l,D,C);break}case 5:var X=g.stateNode;g.flags&32&&(dp(X),g.flags&=-33);var de=Wa(l);fu(l,de,X);break;case 3:case 4:var He=g.stateNode.containerInfo,ft=Wa(l);zf(l,ft,He);break;default:throw Error(r(161))}}}catch(Nt){an(l,l.return,Nt)}l.flags&=-3}c&4096&&(l.flags&=-4097)}function Bf(l){if(l.subtreeFlags&1024)for(l=l.child;l!==null;){var c=l;Bf(c),c.tag===5&&c.flags&1024&&ap(c.stateNode),l=l.sibling}}function Ur(l,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)I0(l,c.alternate,c),c=c.sibling}function So(l){for(l=l.child;l!==null;){var c=l;switch(c.tag){case 0:case 11:case 14:case 15:va(4,c,c.return),So(c);break;case 1:wr(c,c.return);var g=c.stateNode;typeof g.componentWillUnmount=="function"&&Of(c,c.return,g),So(c);break;case 27:tr&&hr(c.stateNode);case 26:case 5:wr(c,c.return),So(c);break;case 22:c.memoizedState===null&&So(c);break;case 30:So(c);break;default:So(c)}l=l.sibling}}function Ps(l,c,g){for(g=g&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var b=c.alternate,C=l,D=c,X=D.flags;switch(D.tag){case 0:case 11:case 15:Ps(C,D,g),ga(4,D);break;case 1:if(Ps(C,D,g),b=D,C=b.stateNode,typeof C.componentDidMount=="function")try{C.componentDidMount()}catch(ft){an(b,b.return,ft)}if(b=D,C=b.updateQueue,C!==null){var de=b.stateNode;try{var He=C.shared.hiddenCallbacks;if(He!==null)for(C.shared.hiddenCallbacks=null,C=0;C<He.length;C++)Tt(He[C],de)}catch(ft){an(b,b.return,ft)}}g&&X&64&&ec(D),tc(D,D.return);break;case 27:tr&&D0(D);case 26:case 5:Ps(C,D,g),g&&b===null&&X&4&&cl(D),tc(D,D.return);break;case 12:Ps(C,D,g);break;case 31:Ps(C,D,g),g&&X&4&&Is(C,D);break;case 13:Ps(C,D,g),g&&X&4&&du(C,D);break;case 22:D.memoizedState===null&&Ps(C,D,g),tc(D,D.return);break;case 30:break;default:Ps(C,D,g)}c=c.sibling}}function Mo(l,c){var g=null;l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),l=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(l=c.memoizedState.cachePool.pool),l!==g&&(l!=null&&l.refCount++,g!=null&&Ye(g))}function Yd(l,c){l=null,c.alternate!==null&&(l=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==l&&(c.refCount++,l!=null&&Ye(l))}function yi(l,c,g,b){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)Ff(l,c,g,b),c=c.sibling}function Ff(l,c,g,b){var C=c.flags;switch(c.tag){case 0:case 11:case 15:yi(l,c,g,b),C&2048&&ga(9,c);break;case 1:yi(l,c,g,b);break;case 3:yi(l,c,g,b),C&2048&&(l=null,c.alternate!==null&&(l=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==l&&(c.refCount++,l!=null&&Ye(l)));break;case 12:if(C&2048){yi(l,c,g,b),l=c.stateNode;try{var D=c.memoizedProps,X=D.id,de=D.onPostCommit;typeof de=="function"&&de(X,c.alternate===null?"mount":"update",l.passiveEffectDuration,-0)}catch(He){an(c,c.return,He)}}else yi(l,c,g,b);break;case 31:yi(l,c,g,b);break;case 13:yi(l,c,g,b);break;case 23:break;case 22:D=c.stateNode,X=c.alternate,c.memoizedState!==null?D._visibility&2?yi(l,c,g,b):nc(l,c):D._visibility&2?yi(l,c,g,b):(D._visibility|=2,Wr(l,c,g,b,(c.subtreeFlags&10256)!==0||!1)),C&2048&&Mo(X,c);break;case 24:yi(l,c,g,b),C&2048&&Yd(c.alternate,c);break;default:yi(l,c,g,b)}}function Wr(l,c,g,b,C){for(C=C&&((c.subtreeFlags&10256)!==0||!1),c=c.child;c!==null;){var D=l,X=c,de=g,He=b,ft=X.flags;switch(X.tag){case 0:case 11:case 15:Wr(D,X,de,He,C),ga(8,X);break;case 23:break;case 22:var Nt=X.stateNode;X.memoizedState!==null?Nt._visibility&2?Wr(D,X,de,He,C):nc(D,X):(Nt._visibility|=2,Wr(D,X,de,He,C)),C&&ft&2048&&Mo(X.alternate,X);break;case 24:Wr(D,X,de,He,C),C&&ft&2048&&Yd(X.alternate,X);break;default:Wr(D,X,de,He,C)}c=c.sibling}}function nc(l,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var g=l,b=c,C=b.flags;switch(b.tag){case 22:nc(g,b),C&2048&&Mo(b.alternate,b);break;case 24:nc(g,b),C&2048&&Yd(b.alternate,b);break;default:nc(g,b)}c=c.sibling}}function xa(l,c,g){if(l.subtreeFlags&ys)for(l=l.child;l!==null;)Eo(l,c,g),l=l.sibling}function Eo(l,c,g){switch(l.tag){case 26:if(xa(l,c,g),l.flags&ys)if(l.memoizedState!==null)Sg(g,Qn,l.memoizedState,l.memoizedProps);else{var b=l.stateNode,C=l.type;l=l.memoizedProps,((c&335544128)===c||rp(C,l))&&th(g,b,C,l)}break;case 5:xa(l,c,g),l.flags&ys&&(b=l.stateNode,C=l.type,l=l.memoizedProps,((c&335544128)===c||rp(C,l))&&th(g,b,C,l));break;case 3:case 4:Bs?(b=Qn,Qn=wu(l.stateNode.containerInfo),xa(l,c,g),Qn=b):xa(l,c,g);break;case 22:l.memoizedState===null&&(b=l.alternate,b!==null&&b.memoizedState!==null?(b=ys,ys=16777216,xa(l,c,g),ys=b):xa(l,c,g));break;default:xa(l,c,g)}}function kf(l){var c=l.alternate;if(c!==null&&(l=c.child,l!==null)){c.child=null;do c=l.sibling,l.sibling=null,l=c;while(l!==null)}}function ic(l){var c=l.deletions;if((l.flags&16)!==0){if(c!==null)for(var g=0;g<c.length;g++){var b=c[g];Bi=b,hs(b,l)}kf(l)}if(l.subtreeFlags&10256)for(l=l.child;l!==null;)Vf(l),l=l.sibling}function Vf(l){switch(l.tag){case 0:case 11:case 15:ic(l),l.flags&2048&&va(9,l,l.return);break;case 3:ic(l);break;case 12:ic(l);break;case 22:var c=l.stateNode;l.memoizedState!==null&&c._visibility&2&&(l.return===null||l.return.tag!==13)?(c._visibility&=-3,mu(l)):ic(l);break;default:ic(l)}}function mu(l){var c=l.deletions;if((l.flags&16)!==0){if(c!==null)for(var g=0;g<c.length;g++){var b=c[g];Bi=b,hs(b,l)}kf(l)}for(l=l.child;l!==null;){switch(c=l,c.tag){case 0:case 11:case 15:va(8,c,c.return),mu(c);break;case 22:g=c.stateNode,g._visibility&2&&(g._visibility&=-3,mu(c));break;default:mu(c)}l=l.sibling}}function hs(l,c){for(;Bi!==null;){var g=Bi;switch(g.tag){case 0:case 11:case 15:va(8,g,c);break;case 23:case 22:if(g.memoizedState!==null&&g.memoizedState.cachePool!==null){var b=g.memoizedState.cachePool.pool;b!=null&&b.refCount++}break;case 24:Ye(g.memoizedState.cache)}if(b=g.child,b!==null)b.return=g,Bi=b;else e:for(g=l;Bi!==null;){b=Bi;var C=b.sibling,D=b.return;if(qd(b),b===g){Bi=null;break e}if(C!==null){C.return=D,Bi=C;break e}Bi=D}}}function To(l){var c=pn(l);if(c!=null){if(typeof c.memoizedProps["data-testname"]!="string")throw Error(r(364));return c}if(l=Oi(l),l===null)throw Error(r(362));return l.stateNode.current}function wo(l,c){var g=l.tag;switch(c.$$typeof){case Xs:if(l.type===c.value)return!0;break;case _c:e:{for(c=c.value,l=[l,0],g=0;g<l.length;){var b=l[g++],C=b.tag,D=l[g++],X=c[D];if(C!==5&&C!==26&&C!==27||!Lo(b)){for(;X!=null&&wo(b,X);)D++,X=c[D];if(D===c.length){c=!0;break e}else for(b=b.child;b!==null;)l.push(b,D),b=b.sibling}}c=!1}return c;case Sc:if((g===5||g===26||g===27)&&cp(l.stateNode,c.value))return!0;break;case Vo:if((g===5||g===6||g===26||g===27)&&(l=Eu(l),l!==null&&0<=l.indexOf(c.value)))return!0;break;case Pu:if((g===5||g===26||g===27)&&(l=l.memoizedProps["data-testname"],typeof l=="string"&&l.toLowerCase()===c.value.toLowerCase()))return!0;break;default:throw Error(r(365))}return!1}function rc(l){switch(l.$$typeof){case Xs:return"<"+(x(l.value)||"Unknown")+">";case _c:return":has("+(rc(l)||"")+")";case Sc:return'[role="'+l.value+'"]';case Vo:return'"'+l.value+'"';case Pu:return'[data-testname="'+l.value+'"]';default:throw Error(r(365))}}function sc(l,c){var g=[];l=[l,0];for(var b=0;b<l.length;){var C=l[b++],D=C.tag,X=l[b++],de=c[X];if(D!==5&&D!==26&&D!==27||!Lo(C)){for(;de!=null&&wo(C,de);)X++,de=c[X];if(X===c.length)g.push(C);else for(C=C.child;C!==null;)l.push(C,X),C=C.sibling}}return g}function Xr(l,c){if(!er)throw Error(r(363));l=To(l),l=sc(l,c),c=[],l=Array.from(l);for(var g=0;g<l.length;){var b=l[g++],C=b.tag;if(C===5||C===26||C===27)Lo(b)||c.push(b.stateNode);else for(b=b.child;b!==null;)l.push(b),b=b.sibling}return c}function pi(){return(Cn&2)!==0&&Ln!==0?Ln&-Ln:Jt.T!==null?Se():pc()}function qa(){if(Vr===0)if((Ln&536870912)===0||In){var l=Sl;Sl<<=1,(Sl&3932160)===0&&(Sl=262144),Vr=l}else Vr=536870912;return l=Jr.current,l!==null&&(l.flags|=32),Vr}function bi(l,c,g){(l===Mn&&(Jn===2||Jn===9)||l.cancelPendingCommit!==null)&&(Ai(l,0),ba(l,Ln,Vr,!1)),U(l,g),((Cn&2)===0||l!==Mn)&&(l===Mn&&((Cn&2)===0&&(jo|=g),Ei===4&&ba(l,Ln,Vr,!1)),Dt(l))}function Js(l,c,g){if((Cn&6)!==0)throw Error(r(327));var b=!g&&(c&127)===0&&(c&l.expiredLanes)===0||N(l,c),C=b?U0(l,c):_a(l,c,!0),D=b;do{if(C===0){Ho&&!b&&ba(l,c,0,!1);break}else{if(g=l.current.alternate,D&&!L0(g)){C=_a(l,c,!1),D=!1;continue}if(C===2){if(D=c,l.errorRecoveryDisabledLanes&D)var X=0;else X=l.pendingLanes&-536870913,X=X!==0?X:X&536870912?536870912:0;if(X!==0){c=X;e:{var de=l;C=Uu;var He=mi&&de.current.memoizedState.isDehydrated;if(He&&(Ai(de,X).flags|=256),X=_a(de,X,!1),X!==2){if(Go&&!He){de.errorRecoveryDisabledLanes|=D,jo|=D,C=4;break e}D=es,es=C,D!==null&&(es===null?es=D:es.push.apply(es,D))}C=X}if(D=!1,C!==2)continue}}if(C===1){Ai(l,0),ba(l,c,0,!0);break}e:{switch(b=l,D=C,D){case 0:case 1:throw Error(r(345));case 4:if((c&4194048)!==c)break;case 6:ba(b,c,Vr,!na);break e;case 2:es=null;break;case 3:case 5:break;default:throw Error(r(329))}if((c&62914560)===c&&(C=Ou+300-Ar(),10<C)){if(ba(b,c,Vr,!na),E(b,0,!0)!==0)break e;Ua=c,b.timeoutHandle=ip(ya.bind(null,b,g,es,zu,Mh,c,Vr,jo,Ec,na,D,"Throttled",-0,0),C);break e}ya(b,g,es,zu,Mh,c,Vr,jo,Ec,na,D,null,-0,0)}}break}while(!0);Dt(l)}function ya(l,c,g,b,C,D,X,de,He,ft,Nt,vt,Ht,hn){if(l.timeoutHandle=Zr,vt=c.subtreeFlags,vt&8192||(vt&16785408)===16785408){vt=sp(),Eo(c,D,vt);var ki=(D&62914560)===D?Ou-Ar():(D&4194048)===D?Rl-Ar():0;if(ki=H0(vt,ki),ki!==null){Ua=D,l.cancelPendingCommit=ki(Ma.bind(null,l,c,D,g,b,C,X,de,He,Nt,vt,null,Ht,hn)),ba(l,D,X,!ft);return}}Ma(l,c,D,g,b,C,X,de,He)}function L0(l){for(var c=l;;){var g=c.tag;if((g===0||g===11||g===15)&&c.flags&16384&&(g=c.updateQueue,g!==null&&(g=g.stores,g!==null)))for(var b=0;b<g.length;b++){var C=g[b],D=C.getSnapshot;C=C.value;try{if(!zi(D(),C))return!1}catch{return!1}}if(g=c.child,c.subtreeFlags&16384&&g!==null)g.return=c,c=g;else{if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function ba(l,c,g,b){c&=~Mc,c&=~jo,l.suspendedLanes|=c,l.pingedLanes&=~c,b&&(l.warmLanes|=c),b=l.expirationTimes;for(var C=c;0<C;){var D=31-Kr(C),X=1<<D;b[D]=-1,C&=~X}g!==0&&V(l,g,c)}function Hf(){return(Cn&6)===0?(yt(0),!1):!0}function Gf(){if(Rn!==null){if(Jn===0)var l=Rn.return;else l=Rn,ea=ri=null,xn(l),Bo=null,El=0,l=Rn;for(;l!==null;)N0(l.alternate,l),l=l.return;Rn=null}}function Ai(l,c){var g=l.timeoutHandle;g!==Zr&&(l.timeoutHandle=Zr,V0(g)),g=l.cancelPendingCommit,g!==null&&(l.cancelPendingCommit=null,g()),Ua=0,Gf(),Mn=l,Rn=g=ps(l.current,null),Ln=c,Jn=0,qi=null,na=!1,Ho=N(l,c),Go=!1,Ec=Vr=Mc=jo=so=Ei=0,es=Uu=null,Mh=!1,(c&8)!==0&&(c|=c&32);var b=l.entangledLanes;if(b!==0)for(l=l.entanglements,b&=c;0<b;){var C=31-Kr(b),D=1<<C;c|=l[C],b&=~D}return Pa=c,da(),g}function ii(l,c){mn=null,Jt.H=xs,c===rr||c===js?(c=dn(),Jn=3):c===_h?(c=dn(),Jn=4):Jn=c===kr?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,qi=c,Rn===null&&(Ei=1,If(l,ae(c,l.current)))}function Pn(){var l=Jr.current;return l===null?!0:(Ln&4194048)===Ln?$r===null:(Ln&62914560)===Ln||(Ln&536870912)!==0?l===$r:!1}function Ya(){var l=Jt.H;return Jt.H=xs,l===null?xs:l}function ds(){var l=Jt.A;return Jt.A=bc,l}function ac(){Ei=4,na||(Ln&4194048)!==Ln&&Jr.current!==null||(Ho=!0),(so&134217727)===0&&(jo&134217727)===0||Mn===null||ba(Mn,Ln,Vr,!1)}function _a(l,c,g){var b=Cn;Cn|=2;var C=Ya(),D=ds();(Mn!==l||Ln!==c)&&(zu=null,Ai(l,c)),c=!1;var X=Ei;e:do try{if(Jn!==0&&Rn!==null){var de=Rn,He=qi;switch(Jn){case 8:Gf(),X=6;break e;case 3:case 2:case 9:case 6:Jr.current===null&&(c=!0);var ft=Jn;if(Jn=0,qi=null,Sa(l,de,He,ft),g&&Ho){X=0;break e}break;default:ft=Jn,Jn=0,qi=null,Sa(l,de,He,ft)}}P0(),X=Ei;break}catch(Nt){ii(l,Nt)}while(!0);return c&&l.shellSuspendCounter++,ea=ri=null,Cn=b,Jt.H=C,Jt.A=D,Rn===null&&(Mn=null,Ln=0,da()),X}function P0(){for(;Rn!==null;)Ao(Rn)}function U0(l,c){var g=Cn;Cn|=2;var b=Ya(),C=ds();Mn!==l||Ln!==c?(zu=null,Wo=Ar()+500,Ai(l,c)):Ho=N(l,c);e:do try{if(Jn!==0&&Rn!==null){c=Rn;var D=qi;t:switch(Jn){case 1:Jn=0,qi=null,Sa(l,c,D,1);break;case 2:case 9:if(gt(D)){Jn=0,qi=null,jf(c);break}c=function(){Jn!==2&&Jn!==9||Mn!==l||(Jn=7),Dt(l)},D.then(c,c);break e;case 3:Jn=7;break e;case 4:Jn=5;break e;case 7:gt(D)?(Jn=0,qi=null,jf(c)):(Jn=0,qi=null,Sa(l,c,D,7));break;case 5:var X=null;switch(Rn.tag){case 26:X=Rn.memoizedState;case 5:case 27:var de=Rn,He=de.type,ft=de.pendingProps;if(X?Dp(X):_i(de.stateNode,He,ft)){Jn=0,qi=null;var Nt=de.sibling;if(Nt!==null)Rn=Nt;else{var vt=de.return;vt!==null?(Rn=vt,lc(vt)):Rn=null}break t}}Jn=0,qi=null,Sa(l,c,D,5);break;case 6:Jn=0,qi=null,Sa(l,c,D,6);break;case 8:Gf(),Ei=6;break e;default:throw Error(r(462))}}oc();break}catch(Ht){ii(l,Ht)}while(!0);return ea=ri=null,Jt.H=b,Jt.A=C,Cn=g,Rn!==null?0:(Mn=null,Ln=0,da(),Ei)}function oc(){for(;Rn!==null&&!Eg();)Ao(Rn)}function Ao(l){var c=Vd(l.alternate,l,Pa);l.memoizedProps=l.pendingProps,c===null?lc(l):Rn=c}function jf(l){var c=l,g=c.alternate;switch(c.tag){case 15:case 0:c=Ud(g,c,c.pendingProps,c.type,void 0,Ln);break;case 11:c=Ud(g,c,c.pendingProps,c.type.render,c.ref,Ln);break;case 5:xn(c);default:N0(g,c),c=Rn=qf(c,Pa),c=Vd(g,c,Pa)}l.memoizedProps=l.pendingProps,c===null?lc(l):Rn=c}function Sa(l,c,g,b){ea=ri=null,xn(c),Bo=null,El=0;var C=c.return;try{if(Iy(l,C,c,g,Ln)){Ei=1,If(l,ae(g,l.current)),Rn=null;return}}catch(D){if(C!==null)throw Rn=C,D;Ei=1,If(l,ae(g,l.current)),Rn=null;return}c.flags&32768?(In||b===1?l=!0:Ho||(Ln&536870912)!==0?l=!1:(na=l=!0,(b===2||b===9||b===3||b===6)&&(b=Jr.current,b!==null&&b.tag===13&&(b.flags|=16384))),Co(c,l)):lc(c)}function lc(l){var c=l;do{if((c.flags&32768)!==0){Co(c,na);return}l=c.return;var g=R0(c.alternate,c,Pa);if(g!==null){Rn=g;return}if(c=c.sibling,c!==null){Rn=c;return}Rn=c=l}while(c!==null);Ei===0&&(Ei=5)}function Co(l,c){do{var g=jd(l.alternate,l);if(g!==null){g.flags&=32767,Rn=g;return}if(g=l.return,g!==null&&(g.flags|=32768,g.subtreeFlags=0,g.deletions=null),!c&&(l=l.sibling,l!==null)){Rn=l;return}Rn=l=g}while(l!==null);Ei=6,Rn=null}function Ma(l,c,g,b,C,D,X,de,He){l.cancelPendingCommit=null;do Ta();while(Yi!==0);if((Cn&6)!==0)throw Error(r(327));if(c!==null){if(c===l.current)throw Error(r(177));if(D=c.lanes|c.childLanes,D|=Tl,H(l,g,D,X,de,He),l===Mn&&(Rn=Mn=null,Ln=0),Nl=c,oo=l,Ua=g,Tc=D,Eh=C,kp=b,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(l.callbackNode=null,l.callbackPriority=0,Wi(Cu,function(){return gu(),null})):(l.callbackNode=null,l.callbackPriority=0),b=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||b){b=Jt.T,Jt.T=null,C=zs(),Dn(2),X=Cn,Cn|=4;try{Ly(l,c,g)}finally{Cn=X,Dn(C),Jt.T=b}}Yi=1,Za(),Ea(),Wf()}}function Za(){if(Yi===1){Yi=0;var l=oo,c=Nl,g=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||g){g=Jt.T,Jt.T=null;var b=zs();Dn(2);var C=Cn;Cn|=4;try{pu(c,l),k0(l.containerInfo)}finally{Cn=C,Dn(b),Jt.T=g}}l.current=c,Yi=2}}function Ea(){if(Yi===2){Yi=0;var l=oo,c=Nl,g=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||g){g=Jt.T,Jt.T=null;var b=zs();Dn(2);var C=Cn;Cn|=4;try{I0(l,c.alternate,c)}finally{Cn=C,Dn(b),Jt.T=g}}Yi=3}}function Wf(){if(Yi===4||Yi===3){Yi=0,Lp();var l=oo,c=Nl,g=Ua,b=kp;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Yi=5:(Yi=0,Nl=oo=null,Xf(l,l.pendingLanes));var C=l.pendingLanes;if(C===0&&(ao=null),ie(g),c=c.stateNode,Qr&&typeof Qr.onCommitFiberRoot=="function")try{Qr.onCommitFiberRoot(Ml,c,void 0,(c.current.flags&128)===128)}catch{}if(b!==null){c=Jt.T,C=zs(),Dn(2),Jt.T=null;try{for(var D=l.onRecoverableError,X=0;X<b.length;X++){var de=b[X];D(de.value,{componentStack:de.stack})}}finally{Jt.T=c,Dn(C)}}(Ua&3)!==0&&Ta(),Dt(l),C=l.pendingLanes,(g&261930)!==0&&(C&42)!==0?l===Bu?Hn++:(Hn=0,Bu=l):Hn=0,mi&&Tu(),yt(0)}}function Xf(l,c){(l.pooledCacheLanes&=c)===0&&(c=l.pooledCache,c!=null&&(l.pooledCache=null,Ye(c)))}function Ta(){return Za(),Ea(),Wf(),gu()}function gu(){if(Yi!==5)return!1;var l=oo,c=Tc;Tc=0;var g=ie(Ua),b=32>g?32:g;g=Jt.T;var C=zs();try{Dn(b),Jt.T=null,b=Eh,Eh=null;var D=oo,X=Ua;if(Yi=0,Nl=oo=null,Ua=0,(Cn&6)!==0)throw Error(r(331));var de=Cn;if(Cn|=4,Vf(D.current),Ff(D,D.current,X,b),Cn=de,yt(0,!1),Qr&&typeof Qr.onPostCommitFiberRoot=="function")try{Qr.onPostCommitFiberRoot(Ml,D)}catch{}return!0}finally{Dn(C),Jt.T=g,Xf(l,c)}}function Ro(l,c,g){c=ae(g,c),c=Ld(l.stateNode,c,2),l=Ne(l,c,2),l!==null&&(U(l,2),Dt(l))}function an(l,c,g){if(l.tag===3)Ro(l,l,g);else for(;c!==null;){if(c.tag===3){Ro(c,l,g);break}else if(c.tag===1){var b=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(ao===null||!ao.has(b))){l=ae(g,l),g=v0(2),b=Ne(c,g,2),b!==null&&(x0(g,b,c,l),U(b,2),Dt(b));break}}c=c.return}}function cc(l,c,g){var b=l.pingCache;if(b===null){b=l.pingCache=new bs;var C=new Set;b.set(c,C)}else C=b.get(c),C===void 0&&(C=new Set,b.set(c,C));C.has(g)||(Go=!0,C.add(g),l=O0.bind(null,l,c,g),c.then(l,l))}function O0(l,c,g){var b=l.pingCache;b!==null&&b.delete(c),l.pingedLanes|=l.suspendedLanes&g,l.warmLanes&=~g,Mn===l&&(Ln&g)===g&&(Ei===4||Ei===3&&(Ln&62914560)===Ln&&300>Ar()-Ou?(Cn&2)===0&&Ai(l,0):Mc|=g,Ec===Ln&&(Ec=0)),Dt(l)}function z0(l,c){c===0&&(c=P()),l=en(l,c),l!==null&&(U(l,c),Dt(l))}function Py(l){var c=l.memoizedState,g=0;c!==null&&(g=c.retryLane),z0(l,g)}function Uy(l,c){var g=0;switch(l.tag){case 31:case 13:var b=l.stateNode,C=l.memoizedState;C!==null&&(g=C.retryLane);break;case 19:b=l.stateNode;break;case 22:b=l.stateNode._retryCache;break;default:throw Error(r(314))}b!==null&&b.delete(c),z0(l,g)}function Wi(l,c){return Au(l,c)}function Zd(l,c,g,b){this.tag=l,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ul(l){return l=l.prototype,!(!l||!l.isReactComponent)}function ps(l,c){var g=l.alternate;return g===null?(g=t(l.tag,c,l.key,l.mode),g.elementType=l.elementType,g.type=l.type,g.stateNode=l.stateNode,g.alternate=l,l.alternate=g):(g.pendingProps=c,g.type=l.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=l.flags&65011712,g.childLanes=l.childLanes,g.lanes=l.lanes,g.child=l.child,g.memoizedProps=l.memoizedProps,g.memoizedState=l.memoizedState,g.updateQueue=l.updateQueue,c=l.dependencies,g.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},g.sibling=l.sibling,g.index=l.index,g.ref=l.ref,g.refCleanup=l.refCleanup,g}function qf(l,c){l.flags&=65011714;var g=l.alternate;return g===null?(l.childLanes=0,l.lanes=c,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=g.childLanes,l.lanes=g.lanes,l.child=g.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=g.memoizedProps,l.memoizedState=g.memoizedState,l.updateQueue=g.updateQueue,l.type=g.type,c=g.dependencies,l.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),l}function Ka(l,c,g,b,C,D){var X=0;if(b=l,typeof l=="function")ul(l)&&(X=1);else if(typeof l=="string")X=Bs&&tr?lh(l,g,dr.current)?26:Ip(l)?27:5:Bs?lh(l,g,dr.current)?26:5:tr&&Ip(l)?27:5;else e:switch(l){case bu:return l=t(31,g,c,C),l.elementType=bu,l.lanes=D,l;case pl:return Us(g.children,C,D,c);case ml:X=8,C|=24;break;case gl:return l=t(12,g,c,C|2),l.elementType=gl,l.lanes=D,l;case Qf:return l=t(13,g,c,C),l.elementType=Qf,l.lanes=D,l;case Qa:return l=t(19,g,c,C),l.elementType=Qa,l.lanes=D,l;default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case Os:X=10;break e;case yu:X=9;break e;case uc:X=11;break e;case Jf:X=14;break e;case Or:X=16,b=null;break e}X=29,g=Error(r(130,l===null?"null":typeof l,"")),b=null}return c=t(X,g,c,C),c.elementType=l,c.type=b,c.lanes=D,c}function Us(l,c,g,b){return l=t(7,l,b,c),l.lanes=g,l}function Kd(l,c,g){return l=t(6,l,null,c),l.lanes=g,l}function Qd(l){var c=t(18,null,null,0);return c.stateNode=l,c}function Jd(l,c,g){return c=t(4,l.children!==null?l.children:[],l.key,c),c.lanes=g,c.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},c}function B0(l,c,g,b,C,D,X,de,He){this.tag=1,this.containerInfo=l,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Zr,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=z(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=z(0),this.hiddenUpdates=z(null),this.identifierPrefix=b,this.onUncaughtError=C,this.onCaughtError=D,this.onRecoverableError=X,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=He,this.incompleteTransitions=new Map}function No(l,c,g,b,C,D,X,de,He,ft,Nt,vt){return l=new B0(l,c,g,X,He,ft,Nt,vt,de),c=1,D===!0&&(c|=24),D=t(3,null,null,c),l.current=D,D.stateNode=l,c=ze(),c.refCount++,l.pooledCache=c,c.refCount++,D.memoizedState={element:b,isDehydrated:g,cache:c},k(D),l}function Yf(l){return l?(l=Aa,l):Aa}function vu(l){var c=l._reactInternals;if(c===void 0)throw typeof l.render=="function"?Error(r(188)):(l=Object.keys(l).join(","),Error(r(268,l)));return l=h(c),l=l!==null?d(l):null,l===null?null:hc(l.stateNode)}function $d(l,c,g,b,C,D){C=Yf(C),b.context===null?b.context=C:b.pendingContext=C,b=he(c),b.payload={element:g},D=D===void 0?null:D,D!==null&&(b.callback=D),g=Ne(l,b,c),g!==null&&(bi(g,l,c),Ge(g,l,c))}function fl(l,c){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var g=l.retryLane;l.retryLane=g!==0&&g<c?g:c}}function xu(l,c){fl(l,c),(l=l.alternate)&&fl(l,c)}var _n={},Zf=$h,qr=aU,Kf=Object.assign,hl=Symbol.for("react.element"),wa=Symbol.for("react.transitional.element"),dl=Symbol.for("react.portal"),pl=Symbol.for("react.fragment"),ml=Symbol.for("react.strict_mode"),gl=Symbol.for("react.profiler"),yu=Symbol.for("react.consumer"),Os=Symbol.for("react.context"),uc=Symbol.for("react.forward_ref"),Qf=Symbol.for("react.suspense"),Qa=Symbol.for("react.suspense_list"),Jf=Symbol.for("react.memo"),Or=Symbol.for("react.lazy"),bu=Symbol.for("react.activity"),ep=Symbol.for("react.memo_cache_sentinel"),Ja=Symbol.iterator,Do=Symbol.for("react.client.reference"),Io=Array.isArray,Jt=Zf.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,tp=e.rendererVersion,_u=e.rendererPackageName,fc=e.extraDevToolsConfig,hc=e.getPublicInstance,F0=e.getRootHostContext,dc=e.getChildHostContext,$f=e.prepareForCommit,k0=e.resetAfterCommit,np=e.createInstance;e.cloneMutableInstance;var Su=e.appendInitialChild,Yr=e.finalizeInitialChildren,zr=e.shouldSetTextContent,$a=e.createTextInstance;e.cloneMutableTextInstance;var ip=e.scheduleTimeout,V0=e.cancelTimeout,Zr=e.noTimeout,Ui=e.isPrimaryRenderer;e.warnsIfNotActing;var Un=e.supportsMutation,ms=e.supportsPersistence,mi=e.supportsHydration,pn=e.getInstanceFromNode;e.beforeActiveInstanceBlur;var $n=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var Dn=e.setCurrentUpdatePriority,zs=e.getCurrentUpdatePriority,pc=e.resolveUpdatePriority;e.trackSchedulerEvent,e.resolveEventType,e.resolveEventTimeStamp;var vl=e.shouldAttemptEagerTransition,eh=e.detachDeletedInstance;e.requestPostPaintCallback;var Mu=e.maySuspendCommit,mc=e.maySuspendCommitOnUpdate,rp=e.maySuspendCommitInSyncRender,_i=e.preloadInstance,sp=e.startSuspendingCommit,th=e.suspendInstance;e.suspendOnActiveViewTransition;var H0=e.waitForCommitToBeReady;e.getSuspendedCommitReason;var xl=e.NotPendingTransition,yl=e.HostTransitionContext,ap=e.resetFormInstance;e.bindToConsole;var op=e.supportsMicrotasks,lp=e.scheduleMicrotask,er=e.supportsTestSelectors,Oi=e.findFiberRoot,nh=e.getBoundingRect,Eu=e.getTextContent,Lo=e.isHiddenSubtree,cp=e.matchAccessibilityRole,eo=e.setFocusIfFocusable,ih=e.setupIntersectionObserver,up=e.appendChild,fp=e.appendChildToContainer,G0=e.commitTextUpdate,j0=e.commitMount,W0=e.commitUpdate,X0=e.insertBefore,q0=e.insertInContainerBefore,Y0=e.removeChild,hp=e.removeChildFromContainer,dp=e.resetTextContent,Oy=e.hideInstance,Z0=e.hideTextInstance,K0=e.unhideInstance,Q0=e.unhideTextInstance;e.cancelViewTransitionName,e.cancelRootViewTransitionName,e.restoreRootViewTransitionName,e.cloneRootViewTransitionContainer,e.removeRootViewTransitionClone,e.measureClonedInstance,e.hasInstanceChanged,e.hasInstanceAffectedParent,e.startViewTransition,e.startGestureTransition,e.stopViewTransition,e.getCurrentGestureOffset,e.createViewTransitionInstance;var pp=e.clearContainer;e.createFragmentInstance,e.updateFragmentInstanceFiber,e.commitNewChildToFragmentInstance,e.deleteChildFromFragmentInstance;var J0=e.cloneInstance,mp=e.createContainerChildSet,gp=e.appendChildToContainerChildSet,$0=e.finalizeContainerChildren,vp=e.replaceContainerChildren,eg=e.cloneHiddenInstance,xp=e.cloneHiddenTextInstance,Po=e.isSuspenseInstancePending,rh=e.isSuspenseInstanceFallback,sh=e.getSuspenseInstanceFallbackErrorDetails,ah=e.registerSuspenseInstanceRetry,tg=e.canHydrateFormStateMarker,yp=e.isFormStateMarkerMatching,ng=e.getNextHydratableSibling,ig=e.getNextHydratableSiblingAfterSingleton,rg=e.getFirstHydratableChild,sg=e.getFirstHydratableChildWithinContainer,ag=e.getFirstHydratableChildWithinActivityInstance,og=e.getFirstHydratableChildWithinSuspenseInstance,bp=e.getFirstHydratableChildWithinSingleton,lg=e.canHydrateInstance,cg=e.canHydrateTextInstance,_p=e.canHydrateActivityInstance,ug=e.canHydrateSuspenseInstance,fg=e.hydrateInstance,zy=e.hydrateTextInstance,Sp=e.hydrateActivityInstance,hg=e.hydrateSuspenseInstance,dg=e.getNextHydratableInstanceAfterActivityInstance,Mp=e.getNextHydratableInstanceAfterSuspenseInstance,pg=e.commitHydratedInstance,mg=e.commitHydratedContainer,By=e.commitHydratedActivityInstance,Fy=e.commitHydratedSuspenseInstance,gg=e.finalizeHydratedChildren,Tu=e.flushHydrationEvents;e.clearActivityBoundary;var Ep=e.clearSuspenseBoundary;e.clearActivityBoundaryFromContainer;var oh=e.clearSuspenseBoundaryFromContainer,vg=e.hideDehydratedBoundary,xg=e.unhideDehydratedBoundary,gc=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var yg=e.validateHydratableInstance,Tp=e.validateHydratableTextInstance,Bs=e.supportsResources,lh=e.isHostHoistableType,wu=e.getHoistableRoot,wp=e.getResource,Ap=e.acquireResource,Uo=e.releaseResource,bg=e.hydrateHoistable,Cp=e.mountHoistable,Rp=e.unmountHoistable,ch=e.createHoistableInstance,_g=e.prepareToCommitHoistables,Np=e.mayResourceSuspendCommit,Dp=e.preloadResource,Sg=e.suspendResource,tr=e.supportsSingletons,uh=e.resolveSingletonInstance,Xi=e.acquireSingletonInstance,hr=e.releaseSingletonInstance,Ip=e.isHostSingletonType,bl=e.isSingletonScope,fh=[],_l=-1,Aa={},Kr=Math.clz32?Math.clz32:R,hh=Math.log,Mg=Math.LN2,dh=256,Sl=262144,vc=4194304,Au=qr.unstable_scheduleCallback,ph=qr.unstable_cancelCallback,Eg=qr.unstable_shouldYield,Lp=qr.unstable_requestPaint,Ar=qr.unstable_now,mh=qr.unstable_ImmediatePriority,Tg=qr.unstable_UserBlockingPriority,Cu=qr.unstable_NormalPriority,gh=qr.unstable_IdlePriority,Pp=qr.log,wg=qr.unstable_setDisableYieldValue,Ml=null,Qr=null,zi=typeof Object.is=="function"?Object.is:se,vh=typeof reportError=="function"?reportError:function(l){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof l=="object"&&l!==null&&typeof l.message=="string"?String(l.message):String(l),error:l});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",l);return}console.error(l)},ky=Object.prototype.hasOwnProperty,xh,Ca,Ru=!1,Up=new WeakMap,to=[],Ra=0,ei=null,Nu=0,Fs=[],gs=0,ks=null,xr=1,$s="",dr=y(null),no=y(null),yr=y(null),Du=y(null),nr=null,gi=null,In=!1,Na=null,Br=!1,yh=Error(r(519)),Vs=y(null),ri=null,ea=null,Ag=typeof AbortController<"u"?AbortController:function(){var l=[],c=this.signal={aborted:!1,addEventListener:function(g,b){l.push(b)}};this.abort=function(){c.aborted=!0,l.forEach(function(g){return g()})}},pr=qr.unstable_scheduleCallback,Vy=qr.unstable_NormalPriority,vi={$$typeof:Os,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},Iu=null,Kn=null,Cr=!1,Hs=!1,bh=!1,Oo=0,xc=null,Op=0,io=0,ir=null,Gs=Jt.S;Jt.S=function(l,c){Rl=Ar(),typeof c=="object"&&c!==null&&typeof c.then=="function"&&$e(l,c),Gs!==null&&Gs(l,c)};var zo=y(null),rr=Error(r(460)),_h=Error(r(474)),js=Error(r(542)),Da={then:function(){}},Fr=null,Bo=null,El=0,br=Cs(!0),zp=Cs(!1),_r=[],Ia=0,Tl=0,vs=!1,Sh=!1,wl=y(null),Fo=y(0),Jr=y(null),$r=null,Ci=y(0),ro=0,mn=null,Kt=null,ln=null,Sn=!1,yn=!1,On=!1,Rr=0,Ws=0,ta=null,Bp=0,xs={readContext:K,use:Vn,useCallback:tt,useContext:tt,useEffect:tt,useImperativeHandle:tt,useLayoutEffect:tt,useInsertionEffect:tt,useMemo:tt,useReducer:tt,useRef:tt,useState:tt,useDebugValue:tt,useDeferredValue:tt,useTransition:tt,useSyncExternalStore:tt,useId:tt,useHostTransitionStatus:tt,useFormState:tt,useActionState:tt,useOptimistic:tt,useMemoCache:tt,useCacheRefresh:tt};xs.useEffectEvent=tt;var Si={readContext:K,use:Vn,useCallback:function(l,c){return Vt().memoizedState=[l,c===void 0?null:c],l},useContext:K,useEffect:nu,useImperativeHandle:function(l,c,g){g=g!=null?g.concat([l]):null,rl(4194308,4,ql.bind(null,c,l),g)},useLayoutEffect:function(l,c){return rl(4194308,4,l,c)},useInsertionEffect:function(l,c){rl(4,2,l,c)},useMemo:function(l,c){var g=Vt();c=c===void 0?null:c;var b=l();if(On){J(!0);try{l()}finally{J(!1)}}return g.memoizedState=[b,c],b},useReducer:function(l,c,g){var b=Vt();if(g!==void 0){var C=g(c);if(On){J(!0);try{g(c)}finally{J(!1)}}}else C=c;return b.memoizedState=b.baseState=C,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:C},b.queue=l,l=l.dispatch=Dy.bind(null,mn,l),[b.memoizedState,l]},useRef:function(l){var c=Vt();return l={current:l},c.memoizedState=l},useState:function(l){l=Td(l);var c=l.queue,g=d0.bind(null,mn,c);return c.dispatch=g,[l.memoizedState,g]},useDebugValue:ru,useDeferredValue:function(l,c){var g=Vt();return Zl(g,l,c)},useTransition:function(){var l=Td(!1);return l=u0.bind(null,mn,l.queue,!0,!1),Vt().memoizedState=l,[!1,l]},useSyncExternalStore:function(l,c,g){var b=mn,C=Vt();if(In){if(g===void 0)throw Error(r(407));g=g()}else{if(g=c(),Mn===null)throw Error(r(349));(Ln&127)!==0||lr(b,c,g)}C.memoizedState=g;var D={value:g,getSnapshot:c};return C.queue=D,nu(nl.bind(null,b,D,l),[l]),b.flags|=2048,fs(9,{destroy:void 0},cr.bind(null,b,D,g,c),null),g},useId:function(){var l=Vt(),c=Mn.identifierPrefix;if(In){var g=$s,b=xr;g=(b&~(1<<32-Kr(b)-1)).toString(32)+g,c="_"+c+"R_"+g,g=Rr++,0<g&&(c+="H"+g.toString(32)),c+="_"}else g=Bp++,c="_"+c+"r_"+g.toString(32)+"_";return l.memoizedState=c},useHostTransitionStatus:Nd,useFormState:Ad,useActionState:Ad,useOptimistic:function(l){var c=Vt();c.memoizedState=c.baseState=l;var g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=g,c=Rf.bind(null,mn,!0,g),g.dispatch=c,[l,c]},useMemoCache:Ji,useCacheRefresh:function(){return Vt().memoizedState=Ny.bind(null,mn)},useEffectEvent:function(l){var c=Vt(),g={impl:l};return c.memoizedState=g,function(){if((Cn&2)!==0)throw Error(r(440));return g.impl.apply(void 0,arguments)}}},La={readContext:K,use:Vn,useCallback:Af,useContext:K,useEffect:Xl,useImperativeHandle:c0,useInsertionEffect:bo,useLayoutEffect:iu,useMemo:Yl,useReducer:di,useRef:wf,useState:function(){return di(Tn)},useDebugValue:ru,useDeferredValue:function(l,c){var g=bt();return Rd(g,Kt.memoizedState,l,c)},useTransition:function(){var l=di(Tn)[0],c=bt().memoizedState;return[typeof l=="boolean"?l:Ot(l),c]},useSyncExternalStore:ji,useId:Cf,useHostTransitionStatus:Nd,useFormState:jl,useActionState:jl,useOptimistic:function(l,c){var g=bt();return eu(g,Kt,l,c)},useMemoCache:Ji,useCacheRefresh:h0};La.useEffectEvent=Lr;var ko={readContext:K,use:Vn,useCallback:Af,useContext:K,useEffect:Xl,useImperativeHandle:c0,useInsertionEffect:bo,useLayoutEffect:iu,useMemo:Yl,useReducer:$i,useRef:wf,useState:function(){return $i(Tn)},useDebugValue:ru,useDeferredValue:function(l,c){var g=bt();return Kt===null?Zl(g,l,c):Rd(g,Kt.memoizedState,l,c)},useTransition:function(){var l=$i(Tn)[0],c=bt().memoizedState;return[typeof l=="boolean"?l:Ot(l),c]},useSyncExternalStore:ji,useId:Cf,useHostTransitionStatus:Nd,useFormState:Wl,useActionState:Wl,useOptimistic:function(l,c){var g=bt();return Kt!==null?eu(g,Kt,l,c):(g.baseState=l,[l,g.queue.dispatch])},useMemoCache:Ji,useCacheRefresh:h0};ko.useEffectEvent=Lr;var Lu={enqueueSetState:function(l,c,g){l=l._reactInternals;var b=pi(),C=he(b);C.payload=c,g!=null&&(C.callback=g),c=Ne(l,C,b),c!==null&&(bi(c,l,b),Ge(c,l,b))},enqueueReplaceState:function(l,c,g){l=l._reactInternals;var b=pi(),C=he(b);C.tag=1,C.payload=c,g!=null&&(C.callback=g),c=Ne(l,C,b),c!==null&&(bi(c,l,b),Ge(c,l,b))},enqueueForceUpdate:function(l,c){l=l._reactInternals;var g=pi(),b=he(g);b.tag=2,c!=null&&(b.callback=c),c=Ne(l,b,g),c!==null&&(bi(c,l,g),Ge(c,l,g))}},kr=Error(r(461)),fi=!1,Al={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},Ri=!1,Ni=!1,yc=!1,Fp=typeof WeakSet=="function"?WeakSet:Set,Bi=null,Mi=null,Fi=!1,Qn=null,ys=8192,bc={getCacheForType:function(l){var c=K(vi),g=c.data.get(l);return g===void 0&&(g=l(),c.data.set(l,g)),g},cacheSignal:function(){return K(vi).controller.signal}},Xs=0,_c=1,Sc=2,Pu=3,Vo=4;if(typeof Symbol=="function"&&Symbol.for){var Cl=Symbol.for;Xs=Cl("selector.component"),_c=Cl("selector.has_pseudo_class"),Sc=Cl("selector.role"),Pu=Cl("selector.test_id"),Vo=Cl("selector.text")}var bs=typeof WeakMap=="function"?WeakMap:Map,Cn=0,Mn=null,Rn=null,Ln=0,Jn=0,qi=null,na=!1,Ho=!1,Go=!1,Pa=0,Ei=0,so=0,jo=0,Mc=0,Vr=0,Ec=0,Uu=null,es=null,Mh=!1,Ou=0,Rl=0,Wo=1/0,zu=null,ao=null,Yi=0,oo=null,Nl=null,Ua=0,Tc=0,Eh=null,kp=null,Hn=0,Bu=null;return _n.attemptContinuousHydration=function(l){if(l.tag===13||l.tag===31){var c=en(l,67108864);c!==null&&bi(c,l,67108864),xu(l,67108864)}},_n.attemptHydrationAtCurrentPriority=function(l){if(l.tag===13||l.tag===31){var c=pi();c=W(c);var g=en(l,c);g!==null&&bi(g,l,c),xu(l,c)}},_n.attemptSynchronousHydration=function(l){switch(l.tag){case 3:if(l=l.stateNode,l.current.memoizedState.isDehydrated){var c=A(l.pendingLanes);if(c!==0){for(l.pendingLanes|=2,l.entangledLanes|=2;c;){var g=1<<31-Kr(c);l.entanglements[1]|=g,c&=~g}Dt(l),(Cn&6)===0&&(Wo=Ar()+500,yt(0))}}break;case 31:case 13:c=en(l,2),c!==null&&bi(c,l,2),Hf(),xu(l,2)}},_n.batchedUpdates=function(l,c){return l(c)},_n.createComponentSelector=function(l){return{$$typeof:Xs,value:l}},_n.createContainer=function(l,c,g,b,C,D,X,de,He,ft){return No(l,c,!1,null,g,b,D,null,X,de,He,ft)},_n.createHasPseudoClassSelector=function(l){return{$$typeof:_c,value:l}},_n.createHydrationContainer=function(l,c,g,b,C,D,X,de,He,ft,Nt,vt,Ht,hn){var ki;return l=No(g,b,!0,l,C,D,de,hn,He,ft,Nt,vt),l.context=Yf(null),g=l.current,b=pi(),b=W(b),C=he(b),C.callback=(ki=c)!=null?ki:null,Ne(g,C,b),c=b,l.current.lanes=c,U(l,c),Dt(l),l},_n.createPortal=function(l,c,g){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:dl,key:b==null?null:""+b,children:l,containerInfo:c,implementation:g}},_n.createRoleSelector=function(l){return{$$typeof:Sc,value:l}},_n.createTestNameSelector=function(l){return{$$typeof:Pu,value:l}},_n.createTextSelector=function(l){return{$$typeof:Vo,value:l}},_n.defaultOnCaughtError=function(l){console.error(l)},_n.defaultOnRecoverableError=function(l){vh(l)},_n.defaultOnUncaughtError=function(l){vh(l)},_n.deferredUpdates=function(l){var c=Jt.T,g=zs();try{return Dn(32),Jt.T=null,l()}finally{Dn(g),Jt.T=c}},_n.discreteUpdates=function(l,c,g,b,C){var D=Jt.T,X=zs();try{return Dn(2),Jt.T=null,l(c,g,b,C)}finally{Dn(X),Jt.T=D,Cn===0&&(Wo=Ar()+500)}},_n.findAllNodes=Xr,_n.findBoundingRects=function(l,c){if(!er)throw Error(r(363));c=Xr(l,c),l=[];for(var g=0;g<c.length;g++)l.push(nh(c[g]));for(c=l.length-1;0<c;c--){g=l[c];for(var b=g.x,C=b+g.width,D=g.y,X=D+g.height,de=c-1;0<=de;de--)if(c!==de){var He=l[de],ft=He.x,Nt=ft+He.width,vt=He.y,Ht=vt+He.height;if(b>=ft&&D>=vt&&C<=Nt&&X<=Ht){l.splice(c,1);break}else if(b!==ft||g.width!==He.width||Ht<D||vt>X){if(!(D!==vt||g.height!==He.height||Nt<b||ft>C)){ft>b&&(He.width+=ft-b,He.x=b),Nt<C&&(He.width=C-ft),l.splice(c,1);break}}else{vt>D&&(He.height+=vt-D,He.y=D),Ht<X&&(He.height=X-vt),l.splice(c,1);break}}}return l},_n.findHostInstance=vu,_n.findHostInstanceWithNoPortals=function(l){return l=h(l),l=l!==null?m(l):null,l===null?null:hc(l.stateNode)},_n.findHostInstanceWithWarning=function(l){return vu(l)},_n.flushPassiveEffects=Ta,_n.flushSyncFromReconciler=function(l){var c=Cn;Cn|=1;var g=Jt.T,b=zs();try{if(Dn(2),Jt.T=null,l)return l()}finally{Dn(b),Jt.T=g,Cn=c,(Cn&6)===0&&yt(0)}},_n.flushSyncWork=Hf,_n.focusWithin=function(l,c){if(!er)throw Error(r(363));for(l=To(l),c=sc(l,c),c=Array.from(c),l=0;l<c.length;){var g=c[l++],b=g.tag;if(!Lo(g)){if((b===5||b===26||b===27)&&eo(g.stateNode))return!0;for(g=g.child;g!==null;)c.push(g),g=g.sibling}}return!1},_n.getFindAllNodesFailureDescription=function(l,c){if(!er)throw Error(r(363));var g=0,b=[];l=[To(l),0];for(var C=0;C<l.length;){var D=l[C++],X=D.tag,de=l[C++],He=c[de];if((X!==5&&X!==26&&X!==27||!Lo(D))&&(wo(D,He)&&(b.push(rc(He)),de++,de>g&&(g=de)),de<c.length))for(D=D.child;D!==null;)l.push(D,de),D=D.sibling}if(g<c.length){for(l=[];g<c.length;g++)l.push(rc(c[g]));return`findAllNodes was able to match part of the selector:
  `+(b.join(" > ")+`

No matching component was found for:
  `)+l.join(" > ")}return null},_n.getPublicRootInstance=function(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 27:case 5:return hc(l.child.stateNode);default:return l.child.stateNode}},_n.injectIntoDevTools=function(){var l={bundleType:0,version:tp,rendererPackageName:_u,currentDispatcherRef:Jt,reconcilerVersion:"19.2.0"};if(fc!==null&&(l.rendererConfig=fc),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")l=!1;else{var c=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(c.isDisabled||!c.supportsFiber)l=!0;else{try{Ml=c.inject(l),Qr=c}catch{}l=!!c.checkDCE}}return l},_n.isAlreadyRendering=function(){return(Cn&6)!==0},_n.observeVisibleRects=function(l,c,g,b){if(!er)throw Error(r(363));l=Xr(l,c);var C=ih(l,g,b).disconnect;return{disconnect:function(){C()}}},_n.shouldError=function(){return null},_n.shouldSuspend=function(){return!1},_n.startHostTransition=function(l,c,g,b){if(l.tag!==5)throw Error(r(476));var C=f0(l).queue;u0(l,C,c,xl,g===null?n:function(){var D=f0(l);return D.next===null&&(D=l.alternate.memoizedState),su(l,D.next.queue,{},pi()),g(b)})},_n.updateContainer=function(l,c,g,b){var C=c.current,D=pi();return $d(C,D,l,c,g,b),D},_n.updateContainerSync=function(l,c,g,b){return $d(c.current,2,l,c,g,b),2},_n},s.exports.default=s.exports,Object.defineProperty(s.exports,"__esModule",{value:!0})})(RE)),RE.exports}var DE;function PU(){return DE||(DE=1,CE.exports=LU()),CE.exports}var UU=PU();const OU=IU(UU);function zU(s){const e=OU(s);return e.injectIntoDevTools(),e}const sA=0,xd={},BU=/^three(?=[A-Z])/,Ay=s=>`${s[0].toUpperCase()}${s.slice(1)}`;let FU=0;const kU=s=>typeof s=="function";function V1(s){if(kU(s)){const e=`${FU++}`;return xd[e]=s,e}else Object.assign(xd,s)}function aA(s,e){const t=Ay(s),n=xd[t];if(s!=="primitive"&&!n)throw new Error(`R3F: ${t} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(s==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function VU(s,e,t){var n;return s=Ay(s)in xd?s:s.replace(BU,""),aA(s,e),s==="primitive"&&(n=e.object)!=null&&n.__r3f&&delete e.object.__r3f,Ox(e.object,t,s,e)}function HU(s){if(!s.isHidden){var e;s.props.attach&&(e=s.parent)!=null&&e.object?Bx(s.parent,s):Ms(s.object)&&(s.object.visible=!1),s.isHidden=!0,Ed(s)}}function oA(s){if(s.isHidden){var e;s.props.attach&&(e=s.parent)!=null&&e.object?zx(s.parent,s):Ms(s.object)&&s.props.visible!==!1&&(s.object.visible=!0),s.isHidden=!1,Ed(s)}}function H1(s,e,t){const n=e.root.getState();if(!(!s.parent&&s.object!==n.scene)){if(!e.object){var r,o;const u=xd[Ay(e.type)];e.object=(r=e.props.object)!=null?r:new u(...(o=e.props.args)!=null?o:[]),e.object.__r3f=e}if(Ko(e.object,e.props),e.props.attach)zx(s,e);else if(Ms(e.object)&&Ms(s.object)){const u=s.object.children.indexOf(t?.object);if(t&&u!==-1){const h=s.object.children.indexOf(e.object);if(h!==-1){s.object.children.splice(h,1);const d=h<u?u-1:u;s.object.children.splice(d,0,e.object)}else e.object.parent=s.object,s.object.children.splice(u,0,e.object),e.object.dispatchEvent({type:"added"}),s.object.dispatchEvent({type:"childadded",child:e.object})}else s.object.add(e.object)}for(const u of e.children)H1(e,u);Ed(e)}}function c_(s,e){e&&(e.parent=s,s.children.push(e),H1(s,e))}function IE(s,e,t){if(!e||!t)return;e.parent=s;const n=s.children.indexOf(t);n!==-1?s.children.splice(n,0,e):s.children.push(e),H1(s,e,t)}function lA(s){if(typeof s.dispose=="function"){const e=()=>{try{s.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():z_.unstable_scheduleCallback(z_.unstable_IdlePriority,e)}}function F_(s,e,t){if(!e)return;e.parent=null;const n=s.children.indexOf(e);n!==-1&&s.children.splice(n,1),e.props.attach?Bx(s,e):Ms(e.object)&&Ms(s.object)&&(s.object.remove(e.object),MU(Jw(e),e.object));const r=e.props.dispose!==null&&t!==!1;for(let o=e.children.length-1;o>=0;o--){const u=e.children[o];F_(e,u,r)}e.children.length=0,delete e.object.__r3f,r&&e.type!=="primitive"&&e.object.type!=="Scene"&&lA(e.object),t===void 0&&Ed(e)}function GU(s,e){for(const t of[s,s.alternate])if(t!==null)if(typeof t.ref=="function"){t.refCleanup==null||t.refCleanup();const n=t.ref(e);typeof n=="function"&&(t.refCleanup=n)}else t.ref&&(t.ref.current=e)}const Hv=[];function jU(){for(const[t]of Hv){const n=t.parent;if(n){t.props.attach?Bx(n,t):Ms(t.object)&&Ms(n.object)&&n.object.remove(t.object);for(const r of t.children)r.props.attach?Bx(t,r):Ms(r.object)&&Ms(t.object)&&t.object.remove(r.object)}t.isHidden&&oA(t),t.object.__r3f&&delete t.object.__r3f,t.type!=="primitive"&&lA(t.object)}for(const[t,n,r]of Hv){t.props=n;const o=t.parent;if(o){var s,e;const u=xd[Ay(t.type)];t.object=(s=t.props.object)!=null?s:new u(...(e=t.props.args)!=null?e:[]),t.object.__r3f=t,GU(r,t.object),Ko(t.object,t.props),t.props.attach?zx(o,t):Ms(t.object)&&Ms(o.object)&&o.object.add(t.object);for(const h of t.children)h.props.attach?zx(t,h):Ms(h.object)&&Ms(t.object)&&t.object.add(h.object);Ed(t)}}Hv.length=0}const u_=()=>{},LE={};let Uv=sA;const WU=0,XU=4,Fx=zU({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:VU,removeChild:F_,appendChild:c_,appendInitialChild:c_,insertBefore:IE,appendChildToContainer(s,e){const t=s.getState().scene.__r3f;!e||!t||c_(t,e)},removeChildFromContainer(s,e){const t=s.getState().scene.__r3f;!e||!t||F_(t,e)},insertInContainerBefore(s,e,t){const n=s.getState().scene.__r3f;!e||!t||!n||IE(n,e,t)},getRootHostContext:()=>LE,getChildHostContext:()=>LE,commitUpdate(s,e,t,n,r){var o,u,h;aA(e,n);let d=!1;if((s.type==="primitive"&&t.object!==n.object||((o=n.args)==null?void 0:o.length)!==((u=t.args)==null?void 0:u.length)||(h=n.args)!=null&&h.some((v,x)=>{var y;return v!==((y=t.args)==null?void 0:y[x])}))&&(d=!0),d)Hv.push([s,{...n},r]);else{const v=bU(s,n);Object.keys(v).length&&(Object.assign(s.props,v),Ko(s.object,v))}(r.sibling===null||(r.flags&XU)===WU)&&jU()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:s=>s?.object,prepareForCommit:()=>null,preparePortalMount:s=>Ox(s.getState().scene,s,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:HU,unhideInstance:oA,createTextInstance:u_,hideTextInstance:u_,unhideTextInstance:u_,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:te.createContext(null),setCurrentUpdatePriority(s){Uv=s},getCurrentUpdatePriority(){return Uv},resolveUpdatePriority(){var s;if(Uv!==sA)return Uv;switch(typeof window<"u"&&((s=window.event)==null?void 0:s.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return NU;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return CU;default:return RU}},resetFormInstance(){},rendererPackageName:"@react-three/fiber",rendererVersion:DU.version,applyViewTransitionName(s,e,t){},restoreViewTransitionName(s,e){},cancelViewTransitionName(s,e,t){},cancelRootViewTransitionName(s){},restoreRootViewTransitionName(s){},InstanceMeasurement:null,measureInstance:s=>null,wasInstanceInViewport:s=>!0,hasInstanceChanged:(s,e)=>!1,hasInstanceAffectedParent:(s,e)=>!1,suspendOnActiveViewTransition(s,e){},startGestureTransition:()=>null,startViewTransition:()=>null,stopViewTransition(s){},createViewTransitionInstance:s=>null,getCurrentGestureOffset(s){throw new Error("startGestureTransition is not yet supported in react-three-fiber.")},cloneMutableInstance(s,e){return s},cloneMutableTextInstance(s){return s},cloneRootViewTransitionContainer(s){throw new Error("Not implemented.")},removeRootViewTransitionClone(s,e){throw new Error("Not implemented.")},createFragmentInstance:s=>null,updateFragmentInstanceFiber(s,e){},commitNewChildToFragmentInstance(s,e){},deleteChildFromFragmentInstance(s,e){},measureClonedInstance:s=>null,maySuspendCommitOnUpdate:(s,e,t)=>!1,maySuspendCommitInSyncRender:(s,e)=>!1,startSuspendingCommit:()=>null,getSuspendedCommitReason:(s,e)=>null}),vf=new Map,Qh={objects:"shallow",strict:!1};function qU(s,e){if(!e&&typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement&&s.parentElement){const{width:t,height:n,top:r,left:o}=s.parentElement.getBoundingClientRect();return{width:t,height:n,top:r,left:o}}else if(!e&&typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas)return{width:s.width,height:s.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function YU(s){const e=vf.get(s),t=e?.fiber,n=e?.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,o=n||TU(H_,UE),u=t||Fx.createContainer(o,AU,null,!1,null,"",r,r,r,null);e||vf.set(s,{fiber:u,store:o});let h,d,m=!1,v=null;return{async configure(x={}){let y;v=new Promise(j=>y=j);let{gl:_,size:M,scene:R,events:A,onCreated:E,shadows:N=!1,linear:I=!1,flat:P=!1,legacy:z=!1,orthographic:U=!1,frameloop:H="always",dpr:V=[1,2],performance:L,raycaster:B,camera:W,onPointerMissed:ie}=x,J=o.getState(),se=J.gl;if(!J.gl){const j={canvas:s,powerPreference:"high-performance",antialias:!0,alpha:!0},le=typeof _=="function"?await _(j):_;wE(le)?se=le:se=new U1({...j,..._}),J.set({gl:se})}let ce=J.raycaster;ce||J.set({raycaster:ce=new Sd});const{params:Y,...ne}=B||{};if(Di.equ(ne,ce,Qh)||Ko(ce,{...ne}),Di.equ(Y,ce.params,Qh)||Ko(ce,{params:{...ce.params,...Y}}),!J.camera||J.camera===d&&!Di.equ(d,W,Qh)){d=W;const j=W?.isCamera,le=j?W:U?new Ha(0,0,0,0,.1,1e3):new Vi(75,0,.1,1e3);j||(le.position.z=5,W&&(Ko(le,W),le.manual||("aspect"in W||"left"in W||"right"in W||"bottom"in W||"top"in W)&&(le.manual=!0,le.updateProjectionMatrix())),!J.camera&&!(W!=null&&W.rotation)&&le.lookAt(0,0,0)),J.set({camera:le}),ce.camera=le}if(!J.scene){let j;R!=null&&R.isScene?(j=R,Ox(j,o,"",{})):(j=new Km,Ox(j,o,"",{}),R&&Ko(j,R)),J.set({scene:j})}A&&!J.events.handlers&&J.set({events:A(o)});const ve=qU(s,M);if(Di.equ(ve,J.size,Qh)||J.setSize(ve.width,ve.height,ve.top,ve.left),V&&J.viewport.dpr!==eA(V)&&J.setDpr(V),J.frameloop!==H&&J.setFrameloop(H),J.onPointerMissed||J.set({onPointerMissed:ie}),L&&!Di.equ(L,J.performance,Qh)&&J.set(j=>({performance:{...j.performance,...L}})),!J.xr){var ae;const j=(Ue,lt)=>{const pe=o.getState();pe.frameloop!=="never"&&UE(Ue,!0,pe,lt)},le=()=>{const Ue=o.getState();Ue.gl.xr.enabled=Ue.gl.xr.isPresenting,Ue.gl.xr.setAnimationLoop(Ue.gl.xr.isPresenting?j:null),Ue.gl.xr.isPresenting||H_(Ue)},Me={connect(){const Ue=o.getState().gl;Ue.xr.addEventListener("sessionstart",le),Ue.xr.addEventListener("sessionend",le)},disconnect(){const Ue=o.getState().gl;Ue.xr.removeEventListener("sessionstart",le),Ue.xr.removeEventListener("sessionend",le)}};typeof((ae=se.xr)==null?void 0:ae.addEventListener)=="function"&&Me.connect(),J.set({xr:Me})}if(se.shadowMap){const j=se.shadowMap.enabled,le=se.shadowMap.type;if(se.shadowMap.enabled=!!N,Di.boo(N))se.shadowMap.type=mm;else if(Di.str(N)){var re;const Me={basic:sT,percentage:id,soft:mm,variance:rf};se.shadowMap.type=(re=Me[N])!=null?re:mm}else Di.obj(N)&&Object.assign(se.shadowMap,N);(j!==se.shadowMap.enabled||le!==se.shadowMap.type)&&(se.shadowMap.needsUpdate=!0)}return kn.enabled=!z,m||(se.outputColorSpace=I?vo:Gr,se.toneMapping=P?ka:Hx),J.legacy!==z&&J.set(()=>({legacy:z})),J.linear!==I&&J.set(()=>({linear:I})),J.flat!==P&&J.set(()=>({flat:P})),_&&!Di.fun(_)&&!wE(_)&&!Di.equ(_,se,Qh)&&Ko(se,_),h=E,m=!0,y(),this},render(x){return!m&&!v&&this.configure(),v.then(()=>{Fx.updateContainer(w.jsx(ZU,{store:o,children:x,onCreated:h,rootElement:s}),u,null,()=>{})}),o},unmount(){cA(s)}}}function ZU({store:s,children:e,onCreated:t,rootElement:n}){return r0(()=>{const r=s.getState();r.set(o=>({internal:{...o.internal,active:!0}})),t&&t(r),s.getState().events.connected||r.events.connect==null||r.events.connect(n)},[]),w.jsx(F1.Provider,{value:s,children:e})}function cA(s,e){const t=vf.get(s),n=t?.fiber;if(n){const r=t?.store.getState();r&&(r.internal.active=!1),Fx.updateContainer(null,n,null,()=>{r&&setTimeout(()=>{try{var o,u,h,d;r.events.disconnect==null||r.events.disconnect(),(o=r.gl)==null||(u=o.renderLists)==null||u.dispose==null||u.dispose(),(h=r.gl)==null||h.forceContextLoss==null||h.forceContextLoss(),(d=r.gl)!=null&&d.xr&&r.xr.disconnect(),vU(r.scene),vf.delete(s)}catch{}},500)})}}function KU(s,e,t){return w.jsx(QU,{children:s,container:e,state:t})}function QU({state:s={},children:e,container:t}){const{events:n,size:r,...o}=s,u=k1(),[h]=te.useState(()=>new Sd),[d]=te.useState(()=>new Je),m=B1((x,y)=>{let _;if(y.camera&&r){const M=y.camera;_=x.viewport.getCurrentViewport(M,new Q,r),M!==x.camera&&nA(M,r)}return{...x,...y,scene:t,raycaster:h,pointer:d,mouse:d,previousRoot:u,events:{...x.events,...y.events,...n},size:{...x.size,...r},viewport:{...x.viewport,..._},setEvents:M=>y.set(R=>({...R,events:{...R.events,...M}}))}}),v=te.useMemo(()=>{const x=Xw((_,M)=>({...o,set:_,get:M})),y=_=>x.setState(M=>m.current(_,M));return y(u.getState()),u.subscribe(y),x},[u,t]);return w.jsx(w.Fragment,{children:Fx.createPortal(w.jsx(F1.Provider,{value:v,children:e}),v,null)})}const JU=new Set,$U=new Set,eO=new Set;function f_(s,e){if(s.size)for(const{callback:t}of s.values())t(e)}function Em(s,e){switch(s){case"before":return f_(JU,e);case"after":return f_($U,e);case"tail":return f_(eO,e)}}let h_,d_;function k_(s,e,t){let n=e.clock.getDelta();e.frameloop==="never"&&typeof s=="number"&&(n=s-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=s),h_=e.internal.subscribers;for(let r=0;r<h_.length;r++)d_=h_[r],d_.ref.current(d_.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let kx=!1,V_=!1,p_,PE,Jh;function uA(s){PE=requestAnimationFrame(uA),kx=!0,p_=0,Em("before",s),V_=!0;for(const t of vf.values()){var e;Jh=t.store.getState(),Jh.internal.active&&(Jh.frameloop==="always"||Jh.internal.frames>0)&&!((e=Jh.gl.xr)!=null&&e.isPresenting)&&(p_+=k_(s,Jh))}if(V_=!1,Em("after",s),p_===0)return Em("tail",s),kx=!1,cancelAnimationFrame(PE)}function H_(s,e=1){var t;if(!s)return vf.forEach(n=>H_(n.store.getState(),e));(t=s.gl.xr)!=null&&t.isPresenting||!s.internal.active||s.frameloop==="never"||(e>1?s.internal.frames=Math.min(60,s.internal.frames+e):V_?s.internal.frames=2:s.internal.frames=1,kx||(kx=!0,requestAnimationFrame(uA)))}function UE(s,e=!0,t,n){if(e&&Em("before",s),t)k_(s,t,n);else for(const r of vf.values())k_(s,r.store.getState());e&&Em("after",s)}const m_={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function tO(s){const{handlePointer:e}=EU(s);return{priority:1,enabled:!0,compute(t,n,r){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(m_).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:r}=s.getState();(t=r.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{const{set:n,events:r}=s.getState();if(r.disconnect==null||r.disconnect(),n(o=>({events:{...o.events,connected:t}})),r.handlers)for(const o in r.handlers){const u=r.handlers[o],[h,d]=m_[o];t.addEventListener(h,u,{passive:d})}},disconnect:()=>{const{set:t,events:n}=s.getState();if(n.connected){if(n.handlers)for(const r in n.handlers){const o=n.handlers[r],[u]=m_[r];n.connected.removeEventListener(u,o)}t(r=>({events:{...r.events,connected:void 0}}))}}}}function OE(s,e){let t;return(...n)=>{window.clearTimeout(t),t=window.setTimeout(()=>s(...n),e)}}function nO({debounce:s,scroll:e,polyfill:t,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){const r=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!r)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[o,u]=te.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),h=te.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o,orientationHandler:null}),d=s?typeof s=="number"?s:s.scroll:null,m=s?typeof s=="number"?s:s.resize:null,v=te.useRef(!1);te.useEffect(()=>(v.current=!0,()=>{v.current=!1}));const[x,y,_]=te.useMemo(()=>{const E=()=>{if(!h.current.element)return;const{left:N,top:I,width:P,height:z,bottom:U,right:H,x:V,y:L}=h.current.element.getBoundingClientRect(),B={left:N,top:I,width:P,height:z,bottom:U,right:H,x:V,y:L};h.current.element instanceof HTMLElement&&n&&(B.height=h.current.element.offsetHeight,B.width=h.current.element.offsetWidth),Object.freeze(B),v.current&&!aO(h.current.lastBounds,B)&&u(h.current.lastBounds=B)};return[E,m?OE(E,m):E,d?OE(E,d):E]},[u,n,d,m]);function M(){h.current.scrollContainers&&(h.current.scrollContainers.forEach(E=>E.removeEventListener("scroll",_,!0)),h.current.scrollContainers=null),h.current.resizeObserver&&(h.current.resizeObserver.disconnect(),h.current.resizeObserver=null),h.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",h.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",h.current.orientationHandler))}function R(){h.current.element&&(h.current.resizeObserver=new r(_),h.current.resizeObserver.observe(h.current.element),e&&h.current.scrollContainers&&h.current.scrollContainers.forEach(E=>E.addEventListener("scroll",_,{capture:!0,passive:!0})),h.current.orientationHandler=()=>{_()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",h.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",h.current.orientationHandler))}const A=E=>{!E||E===h.current.element||(M(),h.current.element=E,h.current.scrollContainers=fA(E),R())};return rO(_,!!e),iO(y),te.useEffect(()=>{M(),R()},[e,_,y]),te.useEffect(()=>M,[]),[A,o,x]}function iO(s){te.useEffect(()=>{const e=s;return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[s])}function rO(s,e){te.useEffect(()=>{if(e){const t=s;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",t,!0)}}},[s,e])}function fA(s){const e=[];if(!s||s===document.body)return e;const{overflow:t,overflowX:n,overflowY:r}=window.getComputedStyle(s);return[t,n,r].some(o=>o==="auto"||o==="scroll")&&e.push(s),[...e,...fA(s.parentElement)]}const sO=["x","y","top","bottom","left","right","width","height"],aO=(s,e)=>sO.every(t=>s[t]===e[t]);function oO({ref:s,children:e,fallback:t,resize:n,style:r,gl:o,events:u=tO,eventSource:h,eventPrefix:d,shadows:m,linear:v,flat:x,legacy:y,orthographic:_,frameloop:M,dpr:R,performance:A,raycaster:E,camera:N,scene:I,onPointerMissed:P,onCreated:z,...U}){te.useMemo(()=>V1(XP),[]);const H=dU(),[V,L]=nO({scroll:!0,debounce:{scroll:50,resize:0},...n}),B=te.useRef(null),W=te.useRef(null);te.useImperativeHandle(s,()=>B.current);const ie=B1(P),[J,se]=te.useState(!1),[ce,Y]=te.useState(!1);if(J)throw J;if(ce)throw ce;const ne=te.useRef(null);r0(()=>{const ae=B.current;if(L.width>0&&L.height>0&&ae){ne.current||(ne.current=YU(ae));async function re(){await ne.current.configure({gl:o,scene:I,events:u,shadows:m,linear:v,flat:x,legacy:y,orthographic:_,frameloop:M,dpr:R,performance:A,raycaster:E,camera:N,size:L,onPointerMissed:(...j)=>ie.current==null?void 0:ie.current(...j),onCreated:j=>{j.events.connect==null||j.events.connect(h?fU(h)?h.current:h:W.current),d&&j.setEvents({compute:(le,Me)=>{const Ue=le[d+"X"],lt=le[d+"Y"];Me.pointer.set(Ue/Me.size.width*2-1,-(lt/Me.size.height)*2+1),Me.raycaster.setFromCamera(Me.pointer,Me.camera)}}),z?.(j)}}),ne.current.render(w.jsx(H,{children:w.jsx(mU,{set:Y,children:w.jsx(te.Suspense,{fallback:w.jsx(pU,{set:se}),children:e??null})})}))}re()}}),te.useEffect(()=>{const ae=B.current;if(ae)return()=>cA(ae)},[]);const ve=h?"none":"auto";return w.jsx("div",{ref:W,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:ve,...r},...U,children:w.jsx("div",{ref:V,style:{width:"100%",height:"100%"},children:w.jsx("canvas",{ref:B,style:{display:"block"},children:t})})})}function lO(s){return w.jsx(Kw,{children:w.jsx(oO,{...s})})}function xf(){return xf=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},xf.apply(null,arguments)}const s0=new Q,G1=new Q,cO=new Q,zE=new Je;function uO(s,e,t){const n=s0.setFromMatrixPosition(s.matrixWorld);n.project(e);const r=t.width/2,o=t.height/2;return[n.x*r+r,-(n.y*o)+o]}function fO(s,e){const t=s0.setFromMatrixPosition(s.matrixWorld),n=G1.setFromMatrixPosition(e.matrixWorld),r=t.sub(n),o=e.getWorldDirection(cO);return r.angleTo(o)>Math.PI/2}function hO(s,e,t,n){const r=s0.setFromMatrixPosition(s.matrixWorld),o=r.clone();o.project(e),zE.set(o.x,o.y),t.setFromCamera(zE,e);const u=t.intersectObjects(n,!0);if(u.length){const h=u[0].distance;return r.distanceTo(t.ray.origin)<h}return!0}function dO(s,e){if(e instanceof Ha)return e.zoom;if(e instanceof Vi){const t=s0.setFromMatrixPosition(s.matrixWorld),n=G1.setFromMatrixPosition(e.matrixWorld),r=e.fov*Math.PI/180,o=t.distanceTo(n);return 1/(2*Math.tan(r/2)*o)}else return 1}function pO(s,e,t){if(e instanceof Vi||e instanceof Ha){const n=s0.setFromMatrixPosition(s.matrixWorld),r=G1.setFromMatrixPosition(e.matrixWorld),o=n.distanceTo(r),u=(t[1]-t[0])/(e.far-e.near),h=t[1]-u*e.far;return Math.round(u*o+h)}}const G_=s=>Math.abs(s)<1e-10?0:s;function hA(s,e,t=""){let n="matrix3d(";for(let r=0;r!==16;r++)n+=G_(e[r]*s.elements[r])+(r!==15?",":")");return t+n}const mO=(s=>e=>hA(e,s))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),gO=(s=>(e,t)=>hA(e,s(t),"translate(-50%,-50%)"))(s=>[1/s,1/s,1/s,1,-1/s,-1/s,-1/s,-1,1/s,1/s,1/s,1,1,1,1,1]);function vO(s){return s&&typeof s=="object"&&"current"in s}const BE=te.forwardRef(({children:s,eps:e=.001,style:t,className:n,prepend:r,center:o,fullscreen:u,portal:h,distanceFactor:d,sprite:m=!1,transform:v=!1,occlude:x,onOcclude:y,castShadow:_,receiveShadow:M,material:R,geometry:A,zIndexRange:E=[16777271,0],calculatePosition:N=uO,as:I="div",wrapperClass:P,pointerEvents:z="auto",...U},H)=>{const{gl:V,camera:L,scene:B,size:W,raycaster:ie,events:J,viewport:se}=Sr(),[ce]=te.useState(()=>document.createElement(I)),Y=te.useRef(null),ne=te.useRef(null),ve=te.useRef(0),ae=te.useRef([0,0]),re=te.useRef(null),j=te.useRef(null),le=h?.current||J.connected||V.domElement.parentNode,Me=te.useRef(null),Ue=te.useRef(!1),lt=te.useMemo(()=>x&&x!=="blending"||Array.isArray(x)&&x.length&&vO(x[0]),[x]);te.useLayoutEffect(()=>{const dt=V.domElement;x&&x==="blending"?(dt.style.zIndex=`${Math.floor(E[0]/2)}`,dt.style.position="absolute",dt.style.pointerEvents="none"):(dt.style.zIndex=null,dt.style.position=null,dt.style.pointerEvents=null)},[x]),te.useLayoutEffect(()=>{if(ne.current){const dt=Y.current=nT.createRoot(ce);if(B.updateMatrixWorld(),v)ce.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const Ut=N(ne.current,L,W);ce.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${Ut[0]}px,${Ut[1]}px,0);transform-origin:0 0;`}return le&&(r?le.prepend(ce):le.appendChild(ce)),()=>{le&&le.removeChild(ce),dt.unmount()}}},[le,v]),te.useLayoutEffect(()=>{P&&(ce.className=P)},[P]);const pe=te.useMemo(()=>v?{position:"absolute",top:0,left:0,width:W.width,height:W.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:o?"translate3d(-50%,-50%,0)":"none",...u&&{top:-W.height/2,left:-W.width/2,width:W.width,height:W.height},...t},[t,o,u,W,v]),Re=te.useMemo(()=>({position:"absolute",pointerEvents:z}),[z]);te.useLayoutEffect(()=>{if(Ue.current=!1,v){var dt;(dt=Y.current)==null||dt.render(te.createElement("div",{ref:re,style:pe},te.createElement("div",{ref:j,style:Re},te.createElement("div",{ref:H,className:n,style:t,children:s}))))}else{var Ut;(Ut=Y.current)==null||Ut.render(te.createElement("div",{ref:H,style:pe,className:n,children:s}))}});const it=te.useRef(!0);xi(dt=>{if(ne.current){L.updateMatrixWorld(),ne.current.updateWorldMatrix(!0,!1);const Ut=v?ae.current:N(ne.current,L,W);if(v||Math.abs(ve.current-L.zoom)>e||Math.abs(ae.current[0]-Ut[0])>e||Math.abs(ae.current[1]-Ut[1])>e){const xe=fO(ne.current,L);let rt=!1;lt&&(Array.isArray(x)?rt=x.map(ot=>ot.current):x!=="blending"&&(rt=[B]));const Le=it.current;if(rt){const ot=hO(ne.current,L,ie,rt);it.current=ot&&!xe}else it.current=!xe;Le!==it.current&&(y?y(!it.current):ce.style.display=it.current?"block":"none");const Xe=Math.floor(E[0]/2),qe=x?lt?[E[0],Xe]:[Xe-1,0]:E;if(ce.style.zIndex=`${pO(ne.current,L,qe)}`,v){const[ot,$]=[W.width/2,W.height/2],Pt=L.projectionMatrix.elements[5]*$,{isOrthographicCamera:St,top:Ft,left:ht,bottom:K,right:F}=L,ge=mO(L.matrixWorldInverse),ze=St?`scale(${Pt})translate(${G_(-(F+ht)/2)}px,${G_((Ft+K)/2)}px)`:`translateZ(${Pt}px)`;let Ye=ne.current.matrixWorld;m&&(Ye=L.matrixWorldInverse.clone().transpose().copyPosition(Ye).scale(ne.current.scale),Ye.elements[3]=Ye.elements[7]=Ye.elements[11]=0,Ye.elements[15]=1),ce.style.width=W.width+"px",ce.style.height=W.height+"px",ce.style.perspective=St?"":`${Pt}px`,re.current&&j.current&&(re.current.style.transform=`${ze}${ge}translate(${ot}px,${$}px)`,j.current.style.transform=gO(Ye,1/((d||10)/400)))}else{const ot=d===void 0?1:dO(ne.current,L)*d;ce.style.transform=`translate3d(${Ut[0]}px,${Ut[1]}px,0) scale(${ot})`}ae.current=Ut,ve.current=L.zoom}}if(!lt&&Me.current&&!Ue.current)if(v){if(re.current){const Ut=re.current.children[0];if(Ut!=null&&Ut.clientWidth&&Ut!=null&&Ut.clientHeight){const{isOrthographicCamera:xe}=L;if(xe||A)U.scale&&(Array.isArray(U.scale)?U.scale instanceof Q?Me.current.scale.copy(U.scale.clone().divideScalar(1)):Me.current.scale.set(1/U.scale[0],1/U.scale[1],1/U.scale[2]):Me.current.scale.setScalar(1/U.scale));else{const rt=(d||10)/400,Le=Ut.clientWidth*rt,Xe=Ut.clientHeight*rt;Me.current.scale.set(Le,Xe,1)}Ue.current=!0}}}else{const Ut=ce.children[0];if(Ut!=null&&Ut.clientWidth&&Ut!=null&&Ut.clientHeight){const xe=1/se.factor,rt=Ut.clientWidth*xe,Le=Ut.clientHeight*xe;Me.current.scale.set(rt,Le,1),Ue.current=!0}Me.current.lookAt(dt.camera.position)}});const xt=te.useMemo(()=>({vertexShader:v?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[v]);return te.createElement("group",xf({},U,{ref:ne}),x&&!lt&&te.createElement("mesh",{castShadow:_,receiveShadow:M,ref:Me},A||te.createElement("planeGeometry",null),R||te.createElement("shaderMaterial",{side:Ii,vertexShader:xt.vertexShader,fragmentShader:xt.fragmentShader})))}),xO=s=>s;function yO(s,e=xO){const t=$h.useSyncExternalStore(s.subscribe,$h.useCallback(()=>e(s.getState()),[s,e]),$h.useCallback(()=>e(s.getInitialState()),[s,e]));return $h.useDebugValue(t),t}const FE=s=>{const e=Ww(s),t=n=>yO(e,n);return Object.assign(t,e),t},bO=(s=>s?FE(s):FE),dA=parseInt(yd.replace(/\D+/g,""));var Fa=Uint8Array,Wc=Uint16Array,j_=Uint32Array,pA=new Fa([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),mA=new Fa([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),_O=new Fa([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),gA=function(s,e){for(var t=new Wc(31),n=0;n<31;++n)t[n]=e+=1<<s[n-1];for(var r=new j_(t[30]),n=1;n<30;++n)for(var o=t[n];o<t[n+1];++o)r[o]=o-t[n]<<5|n;return[t,r]},vA=gA(pA,2),xA=vA[0],SO=vA[1];xA[28]=258,SO[258]=28;var MO=gA(mA,0),EO=MO[0],W_=new Wc(32768);for(var wi=0;wi<32768;++wi){var kc=(wi&43690)>>>1|(wi&21845)<<1;kc=(kc&52428)>>>2|(kc&13107)<<2,kc=(kc&61680)>>>4|(kc&3855)<<4,W_[wi]=((kc&65280)>>>8|(kc&255)<<8)>>>1}var Tm=(function(s,e,t){for(var n=s.length,r=0,o=new Wc(e);r<n;++r)++o[s[r]-1];var u=new Wc(e);for(r=0;r<e;++r)u[r]=u[r-1]+o[r-1]<<1;var h;if(t){h=new Wc(1<<e);var d=15-e;for(r=0;r<n;++r)if(s[r])for(var m=r<<4|s[r],v=e-s[r],x=u[s[r]-1]++<<v,y=x|(1<<v)-1;x<=y;++x)h[W_[x]>>>d]=m}else for(h=new Wc(n),r=0;r<n;++r)s[r]&&(h[r]=W_[u[s[r]-1]++]>>>15-s[r]);return h}),a0=new Fa(288);for(var wi=0;wi<144;++wi)a0[wi]=8;for(var wi=144;wi<256;++wi)a0[wi]=9;for(var wi=256;wi<280;++wi)a0[wi]=7;for(var wi=280;wi<288;++wi)a0[wi]=8;var yA=new Fa(32);for(var wi=0;wi<32;++wi)yA[wi]=5;var TO=Tm(a0,9,1),wO=Tm(yA,5,1),g_=function(s){for(var e=s[0],t=1;t<s.length;++t)s[t]>e&&(e=s[t]);return e},fo=function(s,e,t){var n=e/8|0;return(s[n]|s[n+1]<<8)>>(e&7)&t},v_=function(s,e){var t=e/8|0;return(s[t]|s[t+1]<<8|s[t+2]<<16)>>(e&7)},AO=function(s){return(s/8|0)+(s&7&&1)},CO=function(s,e,t){(t==null||t>s.length)&&(t=s.length);var n=new(s instanceof Wc?Wc:s instanceof j_?j_:Fa)(t-e);return n.set(s.subarray(e,t)),n},RO=function(s,e,t){var n=s.length;if(!n||t&&!t.l&&n<5)return e||new Fa(0);var r=!e||t,o=!t||t.i;t||(t={}),e||(e=new Fa(n*3));var u=function(pe){var Re=e.length;if(pe>Re){var it=new Fa(Math.max(Re*2,pe));it.set(e),e=it}},h=t.f||0,d=t.p||0,m=t.b||0,v=t.l,x=t.d,y=t.m,_=t.n,M=n*8;do{if(!v){t.f=h=fo(s,d,1);var R=fo(s,d+1,3);if(d+=3,R)if(R==1)v=TO,x=wO,y=9,_=5;else if(R==2){var I=fo(s,d,31)+257,P=fo(s,d+10,15)+4,z=I+fo(s,d+5,31)+1;d+=14;for(var U=new Fa(z),H=new Fa(19),V=0;V<P;++V)H[_O[V]]=fo(s,d+V*3,7);d+=P*3;for(var L=g_(H),B=(1<<L)-1,W=Tm(H,L,1),V=0;V<z;){var ie=W[fo(s,d,B)];d+=ie&15;var A=ie>>>4;if(A<16)U[V++]=A;else{var J=0,se=0;for(A==16?(se=3+fo(s,d,3),d+=2,J=U[V-1]):A==17?(se=3+fo(s,d,7),d+=3):A==18&&(se=11+fo(s,d,127),d+=7);se--;)U[V++]=J}}var ce=U.subarray(0,I),Y=U.subarray(I);y=g_(ce),_=g_(Y),v=Tm(ce,y,1),x=Tm(Y,_,1)}else throw"invalid block type";else{var A=AO(d)+4,E=s[A-4]|s[A-3]<<8,N=A+E;if(N>n){if(o)throw"unexpected EOF";break}r&&u(m+E),e.set(s.subarray(A,N),m),t.b=m+=E,t.p=d=N*8;continue}if(d>M){if(o)throw"unexpected EOF";break}}r&&u(m+131072);for(var ne=(1<<y)-1,ve=(1<<_)-1,ae=d;;ae=d){var J=v[v_(s,d)&ne],re=J>>>4;if(d+=J&15,d>M){if(o)throw"unexpected EOF";break}if(!J)throw"invalid length/literal";if(re<256)e[m++]=re;else if(re==256){ae=d,v=null;break}else{var j=re-254;if(re>264){var V=re-257,le=pA[V];j=fo(s,d,(1<<le)-1)+xA[V],d+=le}var Me=x[v_(s,d)&ve],Ue=Me>>>4;if(!Me)throw"invalid distance";d+=Me&15;var Y=EO[Ue];if(Ue>3){var le=mA[Ue];Y+=v_(s,d)&(1<<le)-1,d+=le}if(d>M){if(o)throw"unexpected EOF";break}r&&u(m+131072);for(var lt=m+j;m<lt;m+=4)e[m]=e[m-Y],e[m+1]=e[m+1-Y],e[m+2]=e[m+2-Y],e[m+3]=e[m+3-Y];m=lt}}t.l=v,t.p=ae,t.b=m,v&&(h=1,t.m=y,t.d=x,t.n=_)}while(!h);return m==e.length?e:CO(e,0,m)},NO=new Fa(0),DO=function(s){if((s[0]&15)!=8||s[0]>>>4>7||(s[0]<<8|s[1])%31)throw"invalid zlib data";if(s[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function Ov(s,e){return RO((DO(s),s.subarray(2,-4)),e)}var IO=typeof TextDecoder<"u"&&new TextDecoder,LO=0;try{IO.decode(NO,{stream:!0}),LO=1}catch{}const PO=s=>s&&s.isCubeTexture;class UO extends Gi{constructor(e,t){var n,r;const o=PO(e),h=((r=o?(n=e.image[0])==null?void 0:n.width:e.image.width)!=null?r:1024)/4,d=Math.floor(Math.log2(h)),m=Math.pow(2,d),v=3*Math.max(m,112),x=4*m,y=[o?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/v}`,`#define CUBEUV_TEXEL_HEIGHT ${1/x}`,`#define CUBEUV_MAX_MIP ${d}.0`],_=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,M=y.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${dA>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,R={map:{value:e},height:{value:t?.height||15},radius:{value:t?.radius||100}},A=new $m(1,16),E=new ls({uniforms:R,fragmentShader:M,vertexShader:_,side:Ii});super(A,E)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}var OO=Object.defineProperty,zO=(s,e,t)=>e in s?OO(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,BO=(s,e,t)=>(zO(s,e+"",t),t);class FO{constructor(){BO(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const o=r.indexOf(t);o!==-1&&r.splice(o,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let o=0,u=r.length;o<u;o++)r[o].call(this,e);e.target=null}}}var kO=Object.defineProperty,VO=(s,e,t)=>e in s?kO(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,rn=(s,e,t)=>(VO(s,typeof e!="symbol"?e+"":e,t),t);const zv=new yf,kE=new sa,HO=Math.cos(70*(Math.PI/180)),VE=(s,e)=>(s%e+e)%e;let GO=class extends FO{constructor(e,t){super(),rn(this,"object"),rn(this,"domElement"),rn(this,"enabled",!0),rn(this,"target",new Q),rn(this,"minDistance",0),rn(this,"maxDistance",1/0),rn(this,"minZoom",0),rn(this,"maxZoom",1/0),rn(this,"minPolarAngle",0),rn(this,"maxPolarAngle",Math.PI),rn(this,"minAzimuthAngle",-1/0),rn(this,"maxAzimuthAngle",1/0),rn(this,"enableDamping",!1),rn(this,"dampingFactor",.05),rn(this,"enableZoom",!0),rn(this,"zoomSpeed",1),rn(this,"enableRotate",!0),rn(this,"rotateSpeed",1),rn(this,"enablePan",!0),rn(this,"panSpeed",1),rn(this,"screenSpacePanning",!0),rn(this,"keyPanSpeed",7),rn(this,"zoomToCursor",!1),rn(this,"autoRotate",!1),rn(this,"autoRotateSpeed",2),rn(this,"reverseOrbit",!1),rn(this,"reverseHorizontalOrbit",!1),rn(this,"reverseVerticalOrbit",!1),rn(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),rn(this,"mouseButtons",{LEFT:$u.ROTATE,MIDDLE:$u.DOLLY,RIGHT:$u.PAN}),rn(this,"touches",{ONE:ef.ROTATE,TWO:ef.DOLLY_PAN}),rn(this,"target0"),rn(this,"position0"),rn(this,"zoom0"),rn(this,"_domElementKeyEvents",null),rn(this,"getPolarAngle"),rn(this,"getAzimuthalAngle"),rn(this,"setPolarAngle"),rn(this,"setAzimuthalAngle"),rn(this,"getDistance"),rn(this,"getZoomScale"),rn(this,"listenToKeyEvents"),rn(this,"stopListenToKeyEvents"),rn(this,"saveState"),rn(this,"reset"),rn(this,"update"),rn(this,"connect"),rn(this,"dispose"),rn(this,"dollyIn"),rn(this,"dollyOut"),rn(this,"getScale"),rn(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>v.phi,this.getAzimuthalAngle=()=>v.theta,this.setPolarAngle=ee=>{let Se=VE(ee,2*Math.PI),$e=v.phi;$e<0&&($e+=2*Math.PI),Se<0&&(Se+=2*Math.PI);let ue=Math.abs(Se-$e);2*Math.PI-ue<ue&&(Se<$e?Se+=2*Math.PI:$e+=2*Math.PI),x.phi=Se-$e,n.update()},this.setAzimuthalAngle=ee=>{let Se=VE(ee,2*Math.PI),$e=v.theta;$e<0&&($e+=2*Math.PI),Se<0&&(Se+=2*Math.PI);let ue=Math.abs(Se-$e);2*Math.PI-ue<ue&&(Se<$e?Se+=2*Math.PI:$e+=2*Math.PI),x.theta=Se-$e,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=ee=>{ee.addEventListener("keydown",Be),this._domElementKeyEvents=ee},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Be),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(r),n.update(),d=h.NONE},this.update=(()=>{const ee=new Q,Se=new Q(0,1,0),$e=new as().setFromUnitVectors(e.up,Se),ue=$e.clone().invert(),we=new Q,at=new as,Ct=2*Math.PI;return function(){const Qe=n.object.position;$e.setFromUnitVectors(e.up,Se),ue.copy($e).invert(),ee.copy(Qe).sub(n.target),ee.applyQuaternion($e),v.setFromVector3(ee),n.autoRotate&&d===h.NONE&&se(ie()),n.enableDamping?(v.theta+=x.theta*n.dampingFactor,v.phi+=x.phi*n.dampingFactor):(v.theta+=x.theta,v.phi+=x.phi);let gt=n.minAzimuthAngle,qt=n.maxAzimuthAngle;isFinite(gt)&&isFinite(qt)&&(gt<-Math.PI?gt+=Ct:gt>Math.PI&&(gt-=Ct),qt<-Math.PI?qt+=Ct:qt>Math.PI&&(qt-=Ct),gt<=qt?v.theta=Math.max(gt,Math.min(qt,v.theta)):v.theta=v.theta>(gt+qt)/2?Math.max(gt,v.theta):Math.min(qt,v.theta)),v.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,v.phi)),v.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(_,n.dampingFactor):n.target.add(_),n.zoomToCursor&&L||n.object.isOrthographicCamera?v.radius=Me(v.radius):v.radius=Me(v.radius*y),ee.setFromSpherical(v),ee.applyQuaternion(ue),Qe.copy(n.target).add(ee),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),n.enableDamping===!0?(x.theta*=1-n.dampingFactor,x.phi*=1-n.dampingFactor,_.multiplyScalar(1-n.dampingFactor)):(x.set(0,0,0),_.set(0,0,0));let un=!1;if(n.zoomToCursor&&L){let dn=null;if(n.object instanceof Vi&&n.object.isPerspectiveCamera){const ci=ee.length();dn=Me(ci*y);const Pi=ci-dn;n.object.position.addScaledVector(H,Pi),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const ci=new Q(V.x,V.y,0);ci.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/y)),n.object.updateProjectionMatrix(),un=!0;const Pi=new Q(V.x,V.y,0);Pi.unproject(n.object),n.object.position.sub(Pi).add(ci),n.object.updateMatrixWorld(),dn=ee.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;dn!==null&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(dn).add(n.object.position):(zv.origin.copy(n.object.position),zv.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(zv.direction))<HO?e.lookAt(n.target):(kE.setFromNormalAndCoplanarPoint(n.object.up,n.target),zv.intersectPlane(kE,n.target))))}else n.object instanceof Ha&&n.object.isOrthographicCamera&&(un=y!==1,un&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/y)),n.object.updateProjectionMatrix()));return y=1,L=!1,un||we.distanceToSquared(n.object.position)>m||8*(1-at.dot(n.object.quaternion))>m?(n.dispatchEvent(r),we.copy(n.object.position),at.copy(n.object.quaternion),un=!1,!0):!1}})(),this.connect=ee=>{n.domElement=ee,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",kt),n.domElement.addEventListener("pointerdown",ht),n.domElement.addEventListener("pointercancel",F),n.domElement.addEventListener("wheel",Ye)},this.dispose=()=>{var ee,Se,$e,ue,we,at;n.domElement&&(n.domElement.style.touchAction="auto"),(ee=n.domElement)==null||ee.removeEventListener("contextmenu",kt),(Se=n.domElement)==null||Se.removeEventListener("pointerdown",ht),($e=n.domElement)==null||$e.removeEventListener("pointercancel",F),(ue=n.domElement)==null||ue.removeEventListener("wheel",Ye),(we=n.domElement)==null||we.ownerDocument.removeEventListener("pointermove",K),(at=n.domElement)==null||at.ownerDocument.removeEventListener("pointerup",F),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",Be)};const n=this,r={type:"change"},o={type:"start"},u={type:"end"},h={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let d=h.NONE;const m=1e-6,v=new I_,x=new I_;let y=1;const _=new Q,M=new Je,R=new Je,A=new Je,E=new Je,N=new Je,I=new Je,P=new Je,z=new Je,U=new Je,H=new Q,V=new Je;let L=!1;const B=[],W={};function ie(){return 2*Math.PI/60/60*n.autoRotateSpeed}function J(){return Math.pow(.95,n.zoomSpeed)}function se(ee){n.reverseOrbit||n.reverseHorizontalOrbit?x.theta+=ee:x.theta-=ee}function ce(ee){n.reverseOrbit||n.reverseVerticalOrbit?x.phi+=ee:x.phi-=ee}const Y=(()=>{const ee=new Q;return function($e,ue){ee.setFromMatrixColumn(ue,0),ee.multiplyScalar(-$e),_.add(ee)}})(),ne=(()=>{const ee=new Q;return function($e,ue){n.screenSpacePanning===!0?ee.setFromMatrixColumn(ue,1):(ee.setFromMatrixColumn(ue,0),ee.crossVectors(n.object.up,ee)),ee.multiplyScalar($e),_.add(ee)}})(),ve=(()=>{const ee=new Q;return function($e,ue){const we=n.domElement;if(we&&n.object instanceof Vi&&n.object.isPerspectiveCamera){const at=n.object.position;ee.copy(at).sub(n.target);let Ct=ee.length();Ct*=Math.tan(n.object.fov/2*Math.PI/180),Y(2*$e*Ct/we.clientHeight,n.object.matrix),ne(2*ue*Ct/we.clientHeight,n.object.matrix)}else we&&n.object instanceof Ha&&n.object.isOrthographicCamera?(Y($e*(n.object.right-n.object.left)/n.object.zoom/we.clientWidth,n.object.matrix),ne(ue*(n.object.top-n.object.bottom)/n.object.zoom/we.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function ae(ee){n.object instanceof Vi&&n.object.isPerspectiveCamera||n.object instanceof Ha&&n.object.isOrthographicCamera?y=ee:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function re(ee){ae(y/ee)}function j(ee){ae(y*ee)}function le(ee){if(!n.zoomToCursor||!n.domElement)return;L=!0;const Se=n.domElement.getBoundingClientRect(),$e=ee.clientX-Se.left,ue=ee.clientY-Se.top,we=Se.width,at=Se.height;V.x=$e/we*2-1,V.y=-(ue/at)*2+1,H.set(V.x,V.y,1).unproject(n.object).sub(n.object.position).normalize()}function Me(ee){return Math.max(n.minDistance,Math.min(n.maxDistance,ee))}function Ue(ee){M.set(ee.clientX,ee.clientY)}function lt(ee){le(ee),P.set(ee.clientX,ee.clientY)}function pe(ee){E.set(ee.clientX,ee.clientY)}function Re(ee){R.set(ee.clientX,ee.clientY),A.subVectors(R,M).multiplyScalar(n.rotateSpeed);const Se=n.domElement;Se&&(se(2*Math.PI*A.x/Se.clientHeight),ce(2*Math.PI*A.y/Se.clientHeight)),M.copy(R),n.update()}function it(ee){z.set(ee.clientX,ee.clientY),U.subVectors(z,P),U.y>0?re(J()):U.y<0&&j(J()),P.copy(z),n.update()}function xt(ee){N.set(ee.clientX,ee.clientY),I.subVectors(N,E).multiplyScalar(n.panSpeed),ve(I.x,I.y),E.copy(N),n.update()}function dt(ee){le(ee),ee.deltaY<0?j(J()):ee.deltaY>0&&re(J()),n.update()}function Ut(ee){let Se=!1;switch(ee.code){case n.keys.UP:ve(0,n.keyPanSpeed),Se=!0;break;case n.keys.BOTTOM:ve(0,-n.keyPanSpeed),Se=!0;break;case n.keys.LEFT:ve(n.keyPanSpeed,0),Se=!0;break;case n.keys.RIGHT:ve(-n.keyPanSpeed,0),Se=!0;break}Se&&(ee.preventDefault(),n.update())}function xe(){if(B.length==1)M.set(B[0].pageX,B[0].pageY);else{const ee=.5*(B[0].pageX+B[1].pageX),Se=.5*(B[0].pageY+B[1].pageY);M.set(ee,Se)}}function rt(){if(B.length==1)E.set(B[0].pageX,B[0].pageY);else{const ee=.5*(B[0].pageX+B[1].pageX),Se=.5*(B[0].pageY+B[1].pageY);E.set(ee,Se)}}function Le(){const ee=B[0].pageX-B[1].pageX,Se=B[0].pageY-B[1].pageY,$e=Math.sqrt(ee*ee+Se*Se);P.set(0,$e)}function Xe(){n.enableZoom&&Le(),n.enablePan&&rt()}function qe(){n.enableZoom&&Le(),n.enableRotate&&xe()}function ot(ee){if(B.length==1)R.set(ee.pageX,ee.pageY);else{const $e=Ze(ee),ue=.5*(ee.pageX+$e.x),we=.5*(ee.pageY+$e.y);R.set(ue,we)}A.subVectors(R,M).multiplyScalar(n.rotateSpeed);const Se=n.domElement;Se&&(se(2*Math.PI*A.x/Se.clientHeight),ce(2*Math.PI*A.y/Se.clientHeight)),M.copy(R)}function $(ee){if(B.length==1)N.set(ee.pageX,ee.pageY);else{const Se=Ze(ee),$e=.5*(ee.pageX+Se.x),ue=.5*(ee.pageY+Se.y);N.set($e,ue)}I.subVectors(N,E).multiplyScalar(n.panSpeed),ve(I.x,I.y),E.copy(N)}function Pt(ee){const Se=Ze(ee),$e=ee.pageX-Se.x,ue=ee.pageY-Se.y,we=Math.sqrt($e*$e+ue*ue);z.set(0,we),U.set(0,Math.pow(z.y/P.y,n.zoomSpeed)),re(U.y),P.copy(z)}function St(ee){n.enableZoom&&Pt(ee),n.enablePan&&$(ee)}function Ft(ee){n.enableZoom&&Pt(ee),n.enableRotate&&ot(ee)}function ht(ee){var Se,$e;n.enabled!==!1&&(B.length===0&&((Se=n.domElement)==null||Se.ownerDocument.addEventListener("pointermove",K),($e=n.domElement)==null||$e.ownerDocument.addEventListener("pointerup",F)),ke(ee),ee.pointerType==="touch"?Dt(ee):ge(ee))}function K(ee){n.enabled!==!1&&(ee.pointerType==="touch"?yt(ee):ze(ee))}function F(ee){var Se,$e,ue;Ce(ee),B.length===0&&((Se=n.domElement)==null||Se.releasePointerCapture(ee.pointerId),($e=n.domElement)==null||$e.ownerDocument.removeEventListener("pointermove",K),(ue=n.domElement)==null||ue.ownerDocument.removeEventListener("pointerup",F)),n.dispatchEvent(u),d=h.NONE}function ge(ee){let Se;switch(ee.button){case 0:Se=n.mouseButtons.LEFT;break;case 1:Se=n.mouseButtons.MIDDLE;break;case 2:Se=n.mouseButtons.RIGHT;break;default:Se=-1}switch(Se){case $u.DOLLY:if(n.enableZoom===!1)return;lt(ee),d=h.DOLLY;break;case $u.ROTATE:if(ee.ctrlKey||ee.metaKey||ee.shiftKey){if(n.enablePan===!1)return;pe(ee),d=h.PAN}else{if(n.enableRotate===!1)return;Ue(ee),d=h.ROTATE}break;case $u.PAN:if(ee.ctrlKey||ee.metaKey||ee.shiftKey){if(n.enableRotate===!1)return;Ue(ee),d=h.ROTATE}else{if(n.enablePan===!1)return;pe(ee),d=h.PAN}break;default:d=h.NONE}d!==h.NONE&&n.dispatchEvent(o)}function ze(ee){if(n.enabled!==!1)switch(d){case h.ROTATE:if(n.enableRotate===!1)return;Re(ee);break;case h.DOLLY:if(n.enableZoom===!1)return;it(ee);break;case h.PAN:if(n.enablePan===!1)return;xt(ee);break}}function Ye(ee){n.enabled===!1||n.enableZoom===!1||d!==h.NONE&&d!==h.ROTATE||(ee.preventDefault(),n.dispatchEvent(o),dt(ee),n.dispatchEvent(u))}function Be(ee){n.enabled===!1||n.enablePan===!1||Ut(ee)}function Dt(ee){switch(Fe(ee),B.length){case 1:switch(n.touches.ONE){case ef.ROTATE:if(n.enableRotate===!1)return;xe(),d=h.TOUCH_ROTATE;break;case ef.PAN:if(n.enablePan===!1)return;rt(),d=h.TOUCH_PAN;break;default:d=h.NONE}break;case 2:switch(n.touches.TWO){case ef.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Xe(),d=h.TOUCH_DOLLY_PAN;break;case ef.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;qe(),d=h.TOUCH_DOLLY_ROTATE;break;default:d=h.NONE}break;default:d=h.NONE}d!==h.NONE&&n.dispatchEvent(o)}function yt(ee){switch(Fe(ee),d){case h.TOUCH_ROTATE:if(n.enableRotate===!1)return;ot(ee),n.update();break;case h.TOUCH_PAN:if(n.enablePan===!1)return;$(ee),n.update();break;case h.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;St(ee),n.update();break;case h.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Ft(ee),n.update();break;default:d=h.NONE}}function kt(ee){n.enabled!==!1&&ee.preventDefault()}function ke(ee){B.push(ee)}function Ce(ee){delete W[ee.pointerId];for(let Se=0;Se<B.length;Se++)if(B[Se].pointerId==ee.pointerId){B.splice(Se,1);return}}function Fe(ee){let Se=W[ee.pointerId];Se===void 0&&(Se=new Je,W[ee.pointerId]=Se),Se.set(ee.pageX,ee.pageY)}function Ze(ee){const Se=ee.pointerId===B[0].pointerId?B[1]:B[0];return W[Se.pointerId]}this.dollyIn=(ee=J())=>{j(ee),n.update()},this.dollyOut=(ee=J())=>{re(ee),n.update()},this.getScale=()=>y,this.setScale=ee=>{ae(ee),n.update()},this.getZoomScale=()=>J(),t!==void 0&&this.connect(t),this.update()}};class jO extends A1{constructor(e){super(e),this.type=Qi}parse(e){const u=function(V,L){switch(V){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(L||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(L||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(L||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(L||""))}},x=function(V,L,B){L=L||1024;let ie=V.pos,J=-1,se=0,ce="",Y=String.fromCharCode.apply(null,new Uint16Array(V.subarray(ie,ie+128)));for(;0>(J=Y.indexOf(`
`))&&se<L&&ie<V.byteLength;)ce+=Y,se+=Y.length,ie+=128,Y+=String.fromCharCode.apply(null,new Uint16Array(V.subarray(ie,ie+128)));return-1<J?(V.pos+=se+J+1,ce+Y.slice(0,J)):!1},y=function(V){const L=/^#\?(\S+)/,B=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,W=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,ie=/^\s*FORMAT=(\S+)\s*$/,J=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,se={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let ce,Y;for((V.pos>=V.byteLength||!(ce=x(V)))&&u(1,"no header found"),(Y=ce.match(L))||u(3,"bad initial token"),se.valid|=1,se.programtype=Y[1],se.string+=ce+`
`;ce=x(V),ce!==!1;){if(se.string+=ce+`
`,ce.charAt(0)==="#"){se.comments+=ce+`
`;continue}if((Y=ce.match(B))&&(se.gamma=parseFloat(Y[1])),(Y=ce.match(W))&&(se.exposure=parseFloat(Y[1])),(Y=ce.match(ie))&&(se.valid|=2,se.format=Y[1]),(Y=ce.match(J))&&(se.valid|=4,se.height=parseInt(Y[1],10),se.width=parseInt(Y[2],10)),se.valid&2&&se.valid&4)break}return se.valid&2||u(3,"missing format specifier"),se.valid&4||u(3,"missing image size specifier"),se},_=function(V,L,B){const W=L;if(W<8||W>32767||V[0]!==2||V[1]!==2||V[2]&128)return new Uint8Array(V);W!==(V[2]<<8|V[3])&&u(3,"wrong scanline width");const ie=new Uint8Array(4*L*B);ie.length||u(4,"unable to allocate buffer space");let J=0,se=0;const ce=4*W,Y=new Uint8Array(4),ne=new Uint8Array(ce);let ve=B;for(;ve>0&&se<V.byteLength;){se+4>V.byteLength&&u(1),Y[0]=V[se++],Y[1]=V[se++],Y[2]=V[se++],Y[3]=V[se++],(Y[0]!=2||Y[1]!=2||(Y[2]<<8|Y[3])!=W)&&u(3,"bad rgbe scanline format");let ae=0,re;for(;ae<ce&&se<V.byteLength;){re=V[se++];const le=re>128;if(le&&(re-=128),(re===0||ae+re>ce)&&u(3,"bad scanline data"),le){const Me=V[se++];for(let Ue=0;Ue<re;Ue++)ne[ae++]=Me}else ne.set(V.subarray(se,se+re),ae),ae+=re,se+=re}const j=W;for(let le=0;le<j;le++){let Me=0;ie[J]=ne[le+Me],Me+=W,ie[J+1]=ne[le+Me],Me+=W,ie[J+2]=ne[le+Me],Me+=W,ie[J+3]=ne[le+Me],J+=4}ve--}return ie},M=function(V,L,B,W){const ie=V[L+3],J=Math.pow(2,ie-128)/255;B[W+0]=V[L+0]*J,B[W+1]=V[L+1]*J,B[W+2]=V[L+2]*J,B[W+3]=1},R=function(V,L,B,W){const ie=V[L+3],J=Math.pow(2,ie-128)/255;B[W+0]=of.toHalfFloat(Math.min(V[L+0]*J,65504)),B[W+1]=of.toHalfFloat(Math.min(V[L+1]*J,65504)),B[W+2]=of.toHalfFloat(Math.min(V[L+2]*J,65504)),B[W+3]=of.toHalfFloat(1)},A=new Uint8Array(e);A.pos=0;const E=y(A),N=E.width,I=E.height,P=_(A.subarray(A.pos),N,I);let z,U,H;switch(this.type){case Li:H=P.length/4;const V=new Float32Array(H*4);for(let B=0;B<H;B++)M(P,B*4,V,B*4);z=V,U=Li;break;case Qi:H=P.length/4;const L=new Uint16Array(H*4);for(let B=0;B<H;B++)R(P,B*4,L,B*4);z=L,U=Qi;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:N,height:I,data:z,header:E.string,gamma:E.gamma,exposure:E.exposure,type:U}}setDataType(e){return this.type=e,this}load(e,t,n,r){function o(u,h){switch(u.type){case Li:case Qi:"colorSpace"in u?u.colorSpace="srgb-linear":u.encoding=3e3,u.minFilter=Gn,u.magFilter=Gn,u.generateMipmaps=!1,u.flipY=!0;break}t&&t(u,h)}return super.load(e,o,n,r)}}const um=dA>=152;class WO extends A1{constructor(e){super(e),this.type=Qi}parse(e){const L=Math.pow(2.7182818,2.2);function B(k,Z){for(var he=0,Ne=0;Ne<65536;++Ne)(Ne==0||k[Ne>>3]&1<<(Ne&7))&&(Z[he++]=Ne);for(var Ge=he-1;he<65536;)Z[he++]=0;return Ge}function W(k){for(var Z=0;Z<16384;Z++)k[Z]={},k[Z].len=0,k[Z].lit=0,k[Z].p=null}const ie={l:0,c:0,lc:0};function J(k,Z,he,Ne,Ge){for(;he<k;)Z=Z<<8|Ze(Ne,Ge),he+=8;he-=k,ie.l=Z>>he&(1<<k)-1,ie.c=Z,ie.lc=he}const se=new Array(59);function ce(k){for(var Z=0;Z<=58;++Z)se[Z]=0;for(var Z=0;Z<65537;++Z)se[k[Z]]+=1;for(var he=0,Z=58;Z>0;--Z){var Ne=he+se[Z]>>1;se[Z]=he,he=Ne}for(var Z=0;Z<65537;++Z){var Ge=k[Z];Ge>0&&(k[Z]=Ge|se[Ge]++<<6)}}function Y(k,Z,he,Ne,Ge,We,pt){for(var ut=he,Tt=0,Mt=0;Ge<=We;Ge++){if(ut.value-he.value>Ne)return!1;J(6,Tt,Mt,k,ut);var Rt=ie.l;if(Tt=ie.c,Mt=ie.lc,pt[Ge]=Rt,Rt==63){if(ut.value-he.value>Ne)throw"Something wrong with hufUnpackEncTable";J(8,Tt,Mt,k,ut);var _t=ie.l+6;if(Tt=ie.c,Mt=ie.lc,Ge+_t>We+1)throw"Something wrong with hufUnpackEncTable";for(;_t--;)pt[Ge++]=0;Ge--}else if(Rt>=59){var _t=Rt-59+2;if(Ge+_t>We+1)throw"Something wrong with hufUnpackEncTable";for(;_t--;)pt[Ge++]=0;Ge--}}ce(pt)}function ne(k){return k&63}function ve(k){return k>>6}function ae(k,Z,he,Ne){for(;Z<=he;Z++){var Ge=ve(k[Z]),We=ne(k[Z]);if(Ge>>We)throw"Invalid table entry";if(We>14){var pt=Ne[Ge>>We-14];if(pt.len)throw"Invalid table entry";if(pt.lit++,pt.p){var ut=pt.p;pt.p=new Array(pt.lit);for(var Tt=0;Tt<pt.lit-1;++Tt)pt.p[Tt]=ut[Tt]}else pt.p=new Array(1);pt.p[pt.lit-1]=Z}else if(We)for(var Mt=0,Tt=1<<14-We;Tt>0;Tt--){var pt=Ne[(Ge<<14-We)+Mt];if(pt.len||pt.p)throw"Invalid table entry";pt.len=We,pt.lit=Z,Mt++}}return!0}const re={c:0,lc:0};function j(k,Z,he,Ne){k=k<<8|Ze(he,Ne),Z+=8,re.c=k,re.lc=Z}const le={c:0,lc:0};function Me(k,Z,he,Ne,Ge,We,pt,ut,Tt,Mt){if(k==Z){Ne<8&&(j(he,Ne,Ge,pt),he=re.c,Ne=re.lc),Ne-=8;var Rt=he>>Ne,Rt=new Uint8Array([Rt])[0];if(Tt.value+Rt>Mt)return!1;for(var _t=ut[Tt.value-1];Rt-- >0;)ut[Tt.value++]=_t}else if(Tt.value<Mt)ut[Tt.value++]=k;else return!1;le.c=he,le.lc=Ne}function Ue(k){return k&65535}function lt(k){var Z=Ue(k);return Z>32767?Z-65536:Z}const pe={a:0,b:0};function Re(k,Z){var he=lt(k),Ne=lt(Z),Ge=Ne,We=he+(Ge&1)+(Ge>>1),pt=We,ut=We-Ge;pe.a=pt,pe.b=ut}function it(k,Z){var he=Ue(k),Ne=Ue(Z),Ge=he-(Ne>>1)&65535,We=Ne+Ge-32768&65535;pe.a=We,pe.b=Ge}function xt(k,Z,he,Ne,Ge,We,pt){for(var ut=pt<16384,Tt=he>Ge?Ge:he,Mt=1,Rt;Mt<=Tt;)Mt<<=1;for(Mt>>=1,Rt=Mt,Mt>>=1;Mt>=1;){for(var _t=0,G=_t+We*(Ge-Rt),oe=We*Mt,be=We*Rt,_e=Ne*Mt,me=Ne*Rt,et,mt,tt,It;_t<=G;_t+=be){for(var Et=_t,jt=_t+Ne*(he-Rt);Et<=jt;Et+=me){var At=Et+_e,Gt=Et+oe,fn=Gt+_e;ut?(Re(k[Et+Z],k[Gt+Z]),et=pe.a,tt=pe.b,Re(k[At+Z],k[fn+Z]),mt=pe.a,It=pe.b,Re(et,mt),k[Et+Z]=pe.a,k[At+Z]=pe.b,Re(tt,It),k[Gt+Z]=pe.a,k[fn+Z]=pe.b):(it(k[Et+Z],k[Gt+Z]),et=pe.a,tt=pe.b,it(k[At+Z],k[fn+Z]),mt=pe.a,It=pe.b,it(et,mt),k[Et+Z]=pe.a,k[At+Z]=pe.b,it(tt,It),k[Gt+Z]=pe.a,k[fn+Z]=pe.b)}if(he&Mt){var Gt=Et+oe;ut?Re(k[Et+Z],k[Gt+Z]):it(k[Et+Z],k[Gt+Z]),et=pe.a,k[Gt+Z]=pe.b,k[Et+Z]=et}}if(Ge&Mt)for(var Et=_t,jt=_t+Ne*(he-Rt);Et<=jt;Et+=me){var At=Et+_e;ut?Re(k[Et+Z],k[At+Z]):it(k[Et+Z],k[At+Z]),et=pe.a,k[At+Z]=pe.b,k[Et+Z]=et}Rt=Mt,Mt>>=1}return _t}function dt(k,Z,he,Ne,Ge,We,pt,ut,Tt,Mt){for(var Rt=0,_t=0,G=ut,oe=Math.trunc(Ge.value+(We+7)/8);Ge.value<oe;)for(j(Rt,_t,he,Ge),Rt=re.c,_t=re.lc;_t>=14;){var be=Rt>>_t-14&16383,_e=Z[be];if(_e.len)_t-=_e.len,Me(_e.lit,pt,Rt,_t,he,Ne,Ge,Tt,Mt,G),Rt=le.c,_t=le.lc;else{if(!_e.p)throw"hufDecode issues";var me;for(me=0;me<_e.lit;me++){for(var et=ne(k[_e.p[me]]);_t<et&&Ge.value<oe;)j(Rt,_t,he,Ge),Rt=re.c,_t=re.lc;if(_t>=et&&ve(k[_e.p[me]])==(Rt>>_t-et&(1<<et)-1)){_t-=et,Me(_e.p[me],pt,Rt,_t,he,Ne,Ge,Tt,Mt,G),Rt=le.c,_t=le.lc;break}}if(me==_e.lit)throw"hufDecode issues"}}var mt=8-We&7;for(Rt>>=mt,_t-=mt;_t>0;){var _e=Z[Rt<<14-_t&16383];if(_e.len)_t-=_e.len,Me(_e.lit,pt,Rt,_t,he,Ne,Ge,Tt,Mt,G),Rt=le.c,_t=le.lc;else throw"hufDecode issues"}return!0}function Ut(k,Z,he,Ne,Ge,We){var pt={value:0},ut=he.value,Tt=Fe(Z,he),Mt=Fe(Z,he);he.value+=4;var Rt=Fe(Z,he);if(he.value+=4,Tt<0||Tt>=65537||Mt<0||Mt>=65537)throw"Something wrong with HUF_ENCSIZE";var _t=new Array(65537),G=new Array(16384);W(G);var oe=Ne-(he.value-ut);if(Y(k,Z,he,oe,Tt,Mt,_t),Rt>8*(Ne-(he.value-ut)))throw"Something wrong with hufUncompress";ae(_t,Tt,Mt,G),dt(_t,G,k,Z,he,Rt,Mt,We,Ge,pt)}function xe(k,Z,he){for(var Ne=0;Ne<he;++Ne)Z[Ne]=k[Z[Ne]]}function rt(k){for(var Z=1;Z<k.length;Z++){var he=k[Z-1]+k[Z]-128;k[Z]=he}}function Le(k,Z){for(var he=0,Ne=Math.floor((k.length+1)/2),Ge=0,We=k.length-1;!(Ge>We||(Z[Ge++]=k[he++],Ge>We));)Z[Ge++]=k[Ne++]}function Xe(k){for(var Z=k.byteLength,he=new Array,Ne=0,Ge=new DataView(k);Z>0;){var We=Ge.getInt8(Ne++);if(We<0){var pt=-We;Z-=pt+1;for(var ut=0;ut<pt;ut++)he.push(Ge.getUint8(Ne++))}else{var pt=We;Z-=2;for(var Tt=Ge.getUint8(Ne++),ut=0;ut<pt+1;ut++)he.push(Tt)}}return he}function qe(k,Z,he,Ne,Ge,We){var At=new DataView(We.buffer),pt=he[k.idx[0]].width,ut=he[k.idx[0]].height,Tt=3,Mt=Math.floor(pt/8),Rt=Math.ceil(pt/8),_t=Math.ceil(ut/8),G=pt-(Rt-1)*8,oe=ut-(_t-1)*8,be={value:0},_e=new Array(Tt),me=new Array(Tt),et=new Array(Tt),mt=new Array(Tt),tt=new Array(Tt);for(let Vt=0;Vt<Tt;++Vt)tt[Vt]=Z[k.idx[Vt]],_e[Vt]=Vt<1?0:_e[Vt-1]+Rt*_t,me[Vt]=new Float32Array(64),et[Vt]=new Uint16Array(64),mt[Vt]=new Uint16Array(Rt*64);for(let Vt=0;Vt<_t;++Vt){var It=8;Vt==_t-1&&(It=oe);var Et=8;for(let Yt=0;Yt<Rt;++Yt){Yt==Rt-1&&(Et=G);for(let Ot=0;Ot<Tt;++Ot)et[Ot].fill(0),et[Ot][0]=Ge[_e[Ot]++],ot(be,Ne,et[Ot]),$(et[Ot],me[Ot]),Pt(me[Ot]);St(me);for(let Ot=0;Ot<Tt;++Ot)Ft(me[Ot],mt[Ot],Yt*64)}let bt=0;for(let Yt=0;Yt<Tt;++Yt){const Ot=he[k.idx[Yt]].type;for(let Vn=8*Vt;Vn<8*Vt+It;++Vn){bt=tt[Yt][Vn];for(let Ji=0;Ji<Mt;++Ji){const Tn=Ji*64+(Vn&7)*8;At.setUint16(bt+0*Ot,mt[Yt][Tn+0],!0),At.setUint16(bt+2*Ot,mt[Yt][Tn+1],!0),At.setUint16(bt+4*Ot,mt[Yt][Tn+2],!0),At.setUint16(bt+6*Ot,mt[Yt][Tn+3],!0),At.setUint16(bt+8*Ot,mt[Yt][Tn+4],!0),At.setUint16(bt+10*Ot,mt[Yt][Tn+5],!0),At.setUint16(bt+12*Ot,mt[Yt][Tn+6],!0),At.setUint16(bt+14*Ot,mt[Yt][Tn+7],!0),bt+=16*Ot}}if(Mt!=Rt)for(let Vn=8*Vt;Vn<8*Vt+It;++Vn){const Ji=tt[Yt][Vn]+8*Mt*2*Ot,Tn=Mt*64+(Vn&7)*8;for(let di=0;di<Et;++di)At.setUint16(Ji+di*2*Ot,mt[Yt][Tn+di],!0)}}}for(var jt=new Uint16Array(pt),At=new DataView(We.buffer),Gt=0;Gt<Tt;++Gt){he[k.idx[Gt]].decoded=!0;var fn=he[k.idx[Gt]].type;if(he[Gt].type==2)for(var jn=0;jn<ut;++jn){const Vt=tt[Gt][jn];for(var xn=0;xn<pt;++xn)jt[xn]=At.getUint16(Vt+xn*2*fn,!0);for(var xn=0;xn<pt;++xn)At.setFloat32(Vt+xn*2*fn,we(jt[xn]),!0)}}}function ot(k,Z,he){for(var Ne,Ge=1;Ge<64;)Ne=Z[k.value],Ne==65280?Ge=64:Ne>>8==255?Ge+=Ne&255:(he[Ge]=Ne,Ge++),k.value++}function $(k,Z){Z[0]=we(k[0]),Z[1]=we(k[1]),Z[2]=we(k[5]),Z[3]=we(k[6]),Z[4]=we(k[14]),Z[5]=we(k[15]),Z[6]=we(k[27]),Z[7]=we(k[28]),Z[8]=we(k[2]),Z[9]=we(k[4]),Z[10]=we(k[7]),Z[11]=we(k[13]),Z[12]=we(k[16]),Z[13]=we(k[26]),Z[14]=we(k[29]),Z[15]=we(k[42]),Z[16]=we(k[3]),Z[17]=we(k[8]),Z[18]=we(k[12]),Z[19]=we(k[17]),Z[20]=we(k[25]),Z[21]=we(k[30]),Z[22]=we(k[41]),Z[23]=we(k[43]),Z[24]=we(k[9]),Z[25]=we(k[11]),Z[26]=we(k[18]),Z[27]=we(k[24]),Z[28]=we(k[31]),Z[29]=we(k[40]),Z[30]=we(k[44]),Z[31]=we(k[53]),Z[32]=we(k[10]),Z[33]=we(k[19]),Z[34]=we(k[23]),Z[35]=we(k[32]),Z[36]=we(k[39]),Z[37]=we(k[45]),Z[38]=we(k[52]),Z[39]=we(k[54]),Z[40]=we(k[20]),Z[41]=we(k[22]),Z[42]=we(k[33]),Z[43]=we(k[38]),Z[44]=we(k[46]),Z[45]=we(k[51]),Z[46]=we(k[55]),Z[47]=we(k[60]),Z[48]=we(k[21]),Z[49]=we(k[34]),Z[50]=we(k[37]),Z[51]=we(k[47]),Z[52]=we(k[50]),Z[53]=we(k[56]),Z[54]=we(k[59]),Z[55]=we(k[61]),Z[56]=we(k[35]),Z[57]=we(k[36]),Z[58]=we(k[48]),Z[59]=we(k[49]),Z[60]=we(k[57]),Z[61]=we(k[58]),Z[62]=we(k[62]),Z[63]=we(k[63])}function Pt(k){const Z=.5*Math.cos(.7853975),he=.5*Math.cos(3.14159/16),Ne=.5*Math.cos(3.14159/8),Ge=.5*Math.cos(3*3.14159/16),We=.5*Math.cos(5*3.14159/16),pt=.5*Math.cos(3*3.14159/8),ut=.5*Math.cos(7*3.14159/16);for(var Tt=new Array(4),Mt=new Array(4),Rt=new Array(4),_t=new Array(4),G=0;G<8;++G){var oe=G*8;Tt[0]=Ne*k[oe+2],Tt[1]=pt*k[oe+2],Tt[2]=Ne*k[oe+6],Tt[3]=pt*k[oe+6],Mt[0]=he*k[oe+1]+Ge*k[oe+3]+We*k[oe+5]+ut*k[oe+7],Mt[1]=Ge*k[oe+1]-ut*k[oe+3]-he*k[oe+5]-We*k[oe+7],Mt[2]=We*k[oe+1]-he*k[oe+3]+ut*k[oe+5]+Ge*k[oe+7],Mt[3]=ut*k[oe+1]-We*k[oe+3]+Ge*k[oe+5]-he*k[oe+7],Rt[0]=Z*(k[oe+0]+k[oe+4]),Rt[3]=Z*(k[oe+0]-k[oe+4]),Rt[1]=Tt[0]+Tt[3],Rt[2]=Tt[1]-Tt[2],_t[0]=Rt[0]+Rt[1],_t[1]=Rt[3]+Rt[2],_t[2]=Rt[3]-Rt[2],_t[3]=Rt[0]-Rt[1],k[oe+0]=_t[0]+Mt[0],k[oe+1]=_t[1]+Mt[1],k[oe+2]=_t[2]+Mt[2],k[oe+3]=_t[3]+Mt[3],k[oe+4]=_t[3]-Mt[3],k[oe+5]=_t[2]-Mt[2],k[oe+6]=_t[1]-Mt[1],k[oe+7]=_t[0]-Mt[0]}for(var be=0;be<8;++be)Tt[0]=Ne*k[16+be],Tt[1]=pt*k[16+be],Tt[2]=Ne*k[48+be],Tt[3]=pt*k[48+be],Mt[0]=he*k[8+be]+Ge*k[24+be]+We*k[40+be]+ut*k[56+be],Mt[1]=Ge*k[8+be]-ut*k[24+be]-he*k[40+be]-We*k[56+be],Mt[2]=We*k[8+be]-he*k[24+be]+ut*k[40+be]+Ge*k[56+be],Mt[3]=ut*k[8+be]-We*k[24+be]+Ge*k[40+be]-he*k[56+be],Rt[0]=Z*(k[be]+k[32+be]),Rt[3]=Z*(k[be]-k[32+be]),Rt[1]=Tt[0]+Tt[3],Rt[2]=Tt[1]-Tt[2],_t[0]=Rt[0]+Rt[1],_t[1]=Rt[3]+Rt[2],_t[2]=Rt[3]-Rt[2],_t[3]=Rt[0]-Rt[1],k[0+be]=_t[0]+Mt[0],k[8+be]=_t[1]+Mt[1],k[16+be]=_t[2]+Mt[2],k[24+be]=_t[3]+Mt[3],k[32+be]=_t[3]-Mt[3],k[40+be]=_t[2]-Mt[2],k[48+be]=_t[1]-Mt[1],k[56+be]=_t[0]-Mt[0]}function St(k){for(var Z=0;Z<64;++Z){var he=k[0][Z],Ne=k[1][Z],Ge=k[2][Z];k[0][Z]=he+1.5747*Ge,k[1][Z]=he-.1873*Ne-.4682*Ge,k[2][Z]=he+1.8556*Ne}}function Ft(k,Z,he){for(var Ne=0;Ne<64;++Ne)Z[he+Ne]=of.toHalfFloat(ht(k[Ne]))}function ht(k){return k<=1?Math.sign(k)*Math.pow(Math.abs(k),2.2):Math.sign(k)*Math.pow(L,Math.abs(k)-1)}function K(k){return new DataView(k.array.buffer,k.offset.value,k.size)}function F(k){var Z=k.viewer.buffer.slice(k.offset.value,k.offset.value+k.size),he=new Uint8Array(Xe(Z)),Ne=new Uint8Array(he.length);return rt(he),Le(he,Ne),new DataView(Ne.buffer)}function ge(k){var Z=k.array.slice(k.offset.value,k.offset.value+k.size),he=Ov(Z),Ne=new Uint8Array(he.length);return rt(he),Le(he,Ne),new DataView(Ne.buffer)}function ze(k){for(var Z=k.viewer,he={value:k.offset.value},Ne=new Uint16Array(k.width*k.scanlineBlockSize*(k.channels*k.type)),Ge=new Uint8Array(8192),We=0,pt=new Array(k.channels),ut=0;ut<k.channels;ut++)pt[ut]={},pt[ut].start=We,pt[ut].end=pt[ut].start,pt[ut].nx=k.width,pt[ut].ny=k.lines,pt[ut].size=k.type,We+=pt[ut].nx*pt[ut].ny*pt[ut].size;var Tt=at(Z,he),Mt=at(Z,he);if(Mt>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(Tt<=Mt)for(var ut=0;ut<Mt-Tt+1;ut++)Ge[ut+Tt]=ee(Z,he);var Rt=new Uint16Array(65536),_t=B(Ge,Rt),G=Fe(Z,he);Ut(k.array,Z,he,G,Ne,We);for(var ut=0;ut<k.channels;++ut)for(var oe=pt[ut],be=0;be<pt[ut].size;++be)xt(Ne,oe.start+be,oe.nx,oe.size,oe.ny,oe.nx*oe.size,_t);xe(Rt,Ne,We);for(var _e=0,me=new Uint8Array(Ne.buffer.byteLength),et=0;et<k.lines;et++)for(var mt=0;mt<k.channels;mt++){var oe=pt[mt],tt=oe.nx*oe.size,It=new Uint8Array(Ne.buffer,oe.end*2,tt*2);me.set(It,_e),_e+=tt*2,oe.end+=tt}return new DataView(me.buffer)}function Ye(k){var Z=k.array.slice(k.offset.value,k.offset.value+k.size),he=Ov(Z);const Ne=k.lines*k.channels*k.width,Ge=k.type==1?new Uint16Array(Ne):new Uint32Array(Ne);let We=0,pt=0;const ut=new Array(4);for(let Tt=0;Tt<k.lines;Tt++)for(let Mt=0;Mt<k.channels;Mt++){let Rt=0;switch(k.type){case 1:ut[0]=We,ut[1]=ut[0]+k.width,We=ut[1]+k.width;for(let _t=0;_t<k.width;++_t){const G=he[ut[0]++]<<8|he[ut[1]++];Rt+=G,Ge[pt]=Rt,pt++}break;case 2:ut[0]=We,ut[1]=ut[0]+k.width,ut[2]=ut[1]+k.width,We=ut[2]+k.width;for(let _t=0;_t<k.width;++_t){const G=he[ut[0]++]<<24|he[ut[1]++]<<16|he[ut[2]++]<<8;Rt+=G,Ge[pt]=Rt,pt++}break}}return new DataView(Ge.buffer)}function Be(k){var Z=k.viewer,he={value:k.offset.value},Ne=new Uint8Array(k.width*k.lines*(k.channels*k.type*2)),Ge={version:Se(Z,he),unknownUncompressedSize:Se(Z,he),unknownCompressedSize:Se(Z,he),acCompressedSize:Se(Z,he),dcCompressedSize:Se(Z,he),rleCompressedSize:Se(Z,he),rleUncompressedSize:Se(Z,he),rleRawSize:Se(Z,he),totalAcUncompressedCount:Se(Z,he),totalDcUncompressedCount:Se(Z,he),acCompression:Se(Z,he)};if(Ge.version<2)throw"EXRLoader.parse: "+us.compression+" version "+Ge.version+" is unsupported";for(var We=new Array,pt=at(Z,he)-2;pt>0;){var ut=Dt(Z.buffer,he),Tt=ee(Z,he),Mt=Tt>>2&3,Rt=(Tt>>4)-1,_t=new Int8Array([Rt])[0],G=ee(Z,he);We.push({name:ut,index:_t,type:G,compression:Mt}),pt-=ut.length+3}for(var oe=us.channels,be=new Array(k.channels),_e=0;_e<k.channels;++_e){var me=be[_e]={},et=oe[_e];me.name=et.name,me.compression=0,me.decoded=!1,me.type=et.pixelType,me.pLinear=et.pLinear,me.width=k.width,me.height=k.lines}for(var mt={idx:new Array(3)},tt=0;tt<k.channels;++tt)for(var me=be[tt],_e=0;_e<We.length;++_e){var It=We[_e];me.name==It.name&&(me.compression=It.compression,It.index>=0&&(mt.idx[It.index]=tt),me.offset=tt)}if(Ge.acCompressedSize>0)switch(Ge.acCompression){case 0:var At=new Uint16Array(Ge.totalAcUncompressedCount);Ut(k.array,Z,he,Ge.acCompressedSize,At,Ge.totalAcUncompressedCount);break;case 1:var Et=k.array.slice(he.value,he.value+Ge.totalAcUncompressedCount),jt=Ov(Et),At=new Uint16Array(jt.buffer);he.value+=Ge.totalAcUncompressedCount;break}if(Ge.dcCompressedSize>0){var Gt={array:k.array,offset:he,size:Ge.dcCompressedSize},fn=new Uint16Array(ge(Gt).buffer);he.value+=Ge.dcCompressedSize}if(Ge.rleRawSize>0){var Et=k.array.slice(he.value,he.value+Ge.rleCompressedSize),jt=Ov(Et),jn=Xe(jt.buffer);he.value+=Ge.rleCompressedSize}for(var xn=0,Vt=new Array(be.length),_e=0;_e<Vt.length;++_e)Vt[_e]=new Array;for(var bt=0;bt<k.lines;++bt)for(var Yt=0;Yt<be.length;++Yt)Vt[Yt].push(xn),xn+=be[Yt].width*k.type*2;qe(mt,Vt,be,At,fn,Ne);for(var _e=0;_e<be.length;++_e){var me=be[_e];if(!me.decoded)switch(me.compression){case 2:for(var Ot=0,Vn=0,bt=0;bt<k.lines;++bt){for(var Ji=Vt[_e][Ot],Tn=0;Tn<me.width;++Tn){for(var di=0;di<2*me.type;++di)Ne[Ji++]=jn[Vn+di*me.width*me.height];Vn++}Ot++}break;default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(Ne.buffer)}function Dt(k,Z){for(var he=new Uint8Array(k),Ne=0;he[Z.value+Ne]!=0;)Ne+=1;var Ge=new TextDecoder().decode(he.slice(Z.value,Z.value+Ne));return Z.value=Z.value+Ne+1,Ge}function yt(k,Z,he){var Ne=new TextDecoder().decode(new Uint8Array(k).slice(Z.value,Z.value+he));return Z.value=Z.value+he,Ne}function kt(k,Z){var he=Ce(k,Z),Ne=Fe(k,Z);return[he,Ne]}function ke(k,Z){var he=Fe(k,Z),Ne=Fe(k,Z);return[he,Ne]}function Ce(k,Z){var he=k.getInt32(Z.value,!0);return Z.value=Z.value+4,he}function Fe(k,Z){var he=k.getUint32(Z.value,!0);return Z.value=Z.value+4,he}function Ze(k,Z){var he=k[Z.value];return Z.value=Z.value+1,he}function ee(k,Z){var he=k.getUint8(Z.value);return Z.value=Z.value+1,he}const Se=function(k,Z){let he;return"getBigInt64"in DataView.prototype?he=Number(k.getBigInt64(Z.value,!0)):he=k.getUint32(Z.value+4,!0)+Number(k.getUint32(Z.value,!0)<<32),Z.value+=8,he};function $e(k,Z){var he=k.getFloat32(Z.value,!0);return Z.value+=4,he}function ue(k,Z){return of.toHalfFloat($e(k,Z))}function we(k){var Z=(k&31744)>>10,he=k&1023;return(k>>15?-1:1)*(Z?Z===31?he?NaN:1/0:Math.pow(2,Z-15)*(1+he/1024):6103515625e-14*(he/1024))}function at(k,Z){var he=k.getUint16(Z.value,!0);return Z.value+=2,he}function Ct(k,Z){return we(at(k,Z))}function ct(k,Z,he,Ne){for(var Ge=he.value,We=[];he.value<Ge+Ne-1;){var pt=Dt(Z,he),ut=Ce(k,he),Tt=ee(k,he);he.value+=3;var Mt=Ce(k,he),Rt=Ce(k,he);We.push({name:pt,pixelType:ut,pLinear:Tt,xSampling:Mt,ySampling:Rt})}return he.value+=1,We}function Qe(k,Z){var he=$e(k,Z),Ne=$e(k,Z),Ge=$e(k,Z),We=$e(k,Z),pt=$e(k,Z),ut=$e(k,Z),Tt=$e(k,Z),Mt=$e(k,Z);return{redX:he,redY:Ne,greenX:Ge,greenY:We,blueX:pt,blueY:ut,whiteX:Tt,whiteY:Mt}}function gt(k,Z){var he=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],Ne=ee(k,Z);return he[Ne]}function qt(k,Z){var he=Fe(k,Z),Ne=Fe(k,Z),Ge=Fe(k,Z),We=Fe(k,Z);return{xMin:he,yMin:Ne,xMax:Ge,yMax:We}}function un(k,Z){var he=["INCREASING_Y"],Ne=ee(k,Z);return he[Ne]}function dn(k,Z){var he=$e(k,Z),Ne=$e(k,Z);return[he,Ne]}function ci(k,Z){var he=$e(k,Z),Ne=$e(k,Z),Ge=$e(k,Z);return[he,Ne,Ge]}function Pi(k,Z,he,Ne,Ge){if(Ne==="string"||Ne==="stringvector"||Ne==="iccProfile")return yt(Z,he,Ge);if(Ne==="chlist")return ct(k,Z,he,Ge);if(Ne==="chromaticities")return Qe(k,he);if(Ne==="compression")return gt(k,he);if(Ne==="box2i")return qt(k,he);if(Ne==="lineOrder")return un(k,he);if(Ne==="float")return $e(k,he);if(Ne==="v2f")return dn(k,he);if(Ne==="v3f")return ci(k,he);if(Ne==="int")return Ce(k,he);if(Ne==="rational")return kt(k,he);if(Ne==="timecode")return ke(k,he);if(Ne==="preview")return he.value+=Ge,"skipped";he.value+=Ge}function fa(k,Z,he){const Ne={};if(k.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";Ne.version=k.getUint8(4);const Ge=k.getUint8(5);Ne.spec={singleTile:!!(Ge&2),longName:!!(Ge&4),deepFormat:!!(Ge&8),multiPart:!!(Ge&16)},he.value=8;for(var We=!0;We;){var pt=Dt(Z,he);if(pt==0)We=!1;else{var ut=Dt(Z,he),Tt=Fe(k,he),Mt=Pi(k,Z,he,ut,Tt);Mt===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${ut}'.`):Ne[pt]=Mt}}if((Ge&-5)!=0)throw console.error("EXRHeader:",Ne),"THREE.EXRLoader: provided file is currently unsupported.";return Ne}function ha(k,Z,he,Ne,Ge){const We={size:0,viewer:Z,array:he,offset:Ne,width:k.dataWindow.xMax-k.dataWindow.xMin+1,height:k.dataWindow.yMax-k.dataWindow.yMin+1,channels:k.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:k.channels[0].pixelType,uncompress:null,getter:null,format:null,[um?"colorSpace":"encoding"]:null};switch(k.compression){case"NO_COMPRESSION":We.lines=1,We.uncompress=K;break;case"RLE_COMPRESSION":We.lines=1,We.uncompress=F;break;case"ZIPS_COMPRESSION":We.lines=1,We.uncompress=ge;break;case"ZIP_COMPRESSION":We.lines=16,We.uncompress=ge;break;case"PIZ_COMPRESSION":We.lines=32,We.uncompress=ze;break;case"PXR24_COMPRESSION":We.lines=16,We.uncompress=Ye;break;case"DWAA_COMPRESSION":We.lines=32,We.uncompress=Be;break;case"DWAB_COMPRESSION":We.lines=256,We.uncompress=Be;break;default:throw"EXRLoader.parse: "+k.compression+" is unsupported"}if(We.scanlineBlockSize=We.lines,We.type==1)switch(Ge){case Li:We.getter=Ct,We.inputSize=2;break;case Qi:We.getter=at,We.inputSize=2;break}else if(We.type==2)switch(Ge){case Li:We.getter=$e,We.inputSize=4;break;case Qi:We.getter=ue,We.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+We.type+" for "+k.compression+".";We.blockCount=(k.dataWindow.yMax+1)/We.scanlineBlockSize;for(var pt=0;pt<We.blockCount;pt++)Se(Z,Ne);We.outputChannels=We.channels==3?4:We.channels;const ut=We.width*We.height*We.outputChannels;switch(Ge){case Li:We.byteArray=new Float32Array(ut),We.channels<We.outputChannels&&We.byteArray.fill(1,0,ut);break;case Qi:We.byteArray=new Uint16Array(ut),We.channels<We.outputChannels&&We.byteArray.fill(15360,0,ut);break;default:console.error("THREE.EXRLoader: unsupported type: ",Ge);break}return We.bytesPerLine=We.width*We.inputSize*We.channels,We.outputChannels==4?We.format=or:We.format=qm,um?We.colorSpace="srgb-linear":We.encoding=3e3,We}const Cs=new DataView(e),da=new Uint8Array(e),Ir={value:0},us=fa(Cs,e,Ir),en=ha(us,Cs,da,Ir,this.type),Tr={value:0},ui={R:0,G:1,B:2,A:3,Y:0};for(let k=0;k<en.height/en.scanlineBlockSize;k++){const Z=Fe(Cs,Ir);en.size=Fe(Cs,Ir),en.lines=Z+en.scanlineBlockSize>en.height?en.height-Z:en.scanlineBlockSize;const Ne=en.size<en.lines*en.bytesPerLine?en.uncompress(en):K(en);Ir.value+=en.size;for(let Ge=0;Ge<en.scanlineBlockSize;Ge++){const We=Ge+k*en.scanlineBlockSize;if(We>=en.height)break;for(let pt=0;pt<en.channels;pt++){const ut=ui[us.channels[pt].name];for(let Tt=0;Tt<en.width;Tt++){Tr.value=(Ge*(en.channels*en.width)+pt*en.width+Tt)*en.inputSize;const Mt=(en.height-1-We)*(en.width*en.outputChannels)+Tt*en.outputChannels+ut;en.byteArray[Mt]=en.getter(Ne,Tr)}}}}return{header:us,width:en.width,height:en.height,data:en.byteArray,format:en.format,[um?"colorSpace":"encoding"]:en[um?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,n,r){function o(u,h){um?u.colorSpace=h.colorSpace:u.encoding=h.encoding,u.minFilter=Gn,u.magFilter=Gn,u.generateMipmaps=!1,u.flipY=!1,t&&t(u,h)}return super.load(e,o,n,r)}}function XO(s,e,t,n){var r;return r=class extends ls{constructor(o){super({vertexShader:e,fragmentShader:t,...o});for(const u in s)this.uniforms[u]=new Ey(s[u]),Object.defineProperty(this,u,{get(){return this.uniforms[u].value},set(h){this.uniforms[u].value=h}});this.uniforms=u1.clone(this.uniforms)}},r.key=Jx.generateUUID(),r}const qO=()=>parseInt(yd.replace(/\D+/g,"")),YO=qO(),ZO=te.forwardRef(({makeDefault:s,camera:e,regress:t,domElement:n,enableDamping:r=!0,keyEvents:o=!1,onChange:u,onStart:h,onEnd:d,...m},v)=>{const x=Sr(U=>U.invalidate),y=Sr(U=>U.camera),_=Sr(U=>U.gl),M=Sr(U=>U.events),R=Sr(U=>U.setEvents),A=Sr(U=>U.set),E=Sr(U=>U.get),N=Sr(U=>U.performance),I=e||y,P=n||M.connected||_.domElement,z=te.useMemo(()=>new GO(I),[I]);return xi(()=>{z.enabled&&z.update()},-1),te.useEffect(()=>(o&&z.connect(o===!0?P:o),z.connect(P),()=>{z.dispose()}),[o,P,t,z,x]),te.useEffect(()=>{const U=L=>{x(),t&&N.regress(),u&&u(L)},H=L=>{h&&h(L)},V=L=>{d&&d(L)};return z.addEventListener("change",U),z.addEventListener("start",H),z.addEventListener("end",V),()=>{z.removeEventListener("start",H),z.removeEventListener("end",V),z.removeEventListener("change",U)}},[u,h,d,z,x,R]),te.useEffect(()=>{if(s){const U=E().controls;return A({controls:z}),()=>A({controls:U})}},[s,z]),te.createElement("primitive",xf({ref:v,object:z,enableDamping:r},m))}),KO=XO({cellSize:.5,sectionSize:1,fadeDistance:100,fadeStrength:1,fadeFrom:1,cellThickness:.5,sectionThickness:1,cellColor:new Lt,sectionColor:new Lt,infiniteGrid:!1,followCamera:!1,worldCamProjPosition:new Q,worldPlanePosition:new Q},`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform vec3 worldPlanePosition;
    uniform float fadeDistance;
    uniform bool infiniteGrid;
    uniform bool followCamera;

    void main() {
      localPosition = position.xzy;
      if (infiniteGrid) localPosition *= 1.0 + fadeDistance;
      
      worldPosition = modelMatrix * vec4(localPosition, 1.0);
      if (followCamera) {
        worldPosition.xyz += (worldCamProjPosition - worldPlanePosition);
        localPosition = (inverse(modelMatrix) * worldPosition).xyz;
      }

      gl_Position = projectionMatrix * viewMatrix * worldPosition;
    }
  `,`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform float cellSize;
    uniform float sectionSize;
    uniform vec3 cellColor;
    uniform vec3 sectionColor;
    uniform float fadeDistance;
    uniform float fadeStrength;
    uniform float fadeFrom;
    uniform float cellThickness;
    uniform float sectionThickness;

    float getGrid(float size, float thickness) {
      vec2 r = localPosition.xz / size;
      vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);
      float line = min(grid.x, grid.y) + 1.0 - thickness;
      return 1.0 - min(line, 1.0);
    }

    void main() {
      float g1 = getGrid(cellSize, cellThickness);
      float g2 = getGrid(sectionSize, sectionThickness);

      vec3 from = worldCamProjPosition*vec3(fadeFrom);
      float dist = distance(from, worldPosition.xyz);
      float d = 1.0 - min(dist / fadeDistance, 1.0);
      vec3 color = mix(cellColor, sectionColor, min(1.0, sectionThickness * g2));

      gl_FragColor = vec4(color, (g1 + g2) * pow(d, fadeStrength));
      gl_FragColor.a = mix(0.75 * gl_FragColor.a, gl_FragColor.a, g2);
      if (gl_FragColor.a <= 0.0) discard;

      #include <tonemapping_fragment>
      #include <${YO>=154?"colorspace_fragment":"encodings_fragment"}>
    }
  `),QO=te.forwardRef(({args:s,cellColor:e="#000000",sectionColor:t="#2080ff",cellSize:n=.5,sectionSize:r=1,followCamera:o=!1,infiniteGrid:u=!1,fadeDistance:h=100,fadeStrength:d=1,fadeFrom:m=1,cellThickness:v=.5,sectionThickness:x=1,side:y=ss,..._},M)=>{V1({GridMaterial:KO});const R=te.useRef(null);te.useImperativeHandle(M,()=>R.current,[]);const A=new sa,E=new Q(0,1,0),N=new Q(0,0,0);xi(z=>{A.setFromNormalAndCoplanarPoint(E,N).applyMatrix4(R.current.matrixWorld);const U=R.current.material,H=U.uniforms.worldCamProjPosition,V=U.uniforms.worldPlanePosition;A.projectPoint(z.camera.position,H.value),V.value.set(0,0,0).applyMatrix4(R.current.matrixWorld)});const I={cellSize:n,sectionSize:r,cellColor:e,sectionColor:t,cellThickness:v,sectionThickness:x},P={fadeDistance:h,fadeStrength:d,fadeFrom:m,infiniteGrid:u,followCamera:o};return te.createElement("mesh",xf({ref:R,frustumCulled:!1},_),te.createElement("gridMaterial",xf({transparent:!0,"extensions-derivatives":!0,side:y},I,P)),te.createElement("planeGeometry",{args:s}))}),JO="modulepreload",$O=function(s){return"/chemlabdemo/"+s},HE={},X_=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),h=u?.nonce||u?.getAttribute("nonce");r=d(t.map(m=>{if(m=$O(m),m in HE)return;HE[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${x}`))return;const y=document.createElement("link");if(y.rel=v?"stylesheet":JO,v||(y.as="script"),y.crossOrigin="",y.href=m,h&&y.setAttribute("nonce",h),document.head.appendChild(y),v)return new Promise((_,M)=>{y.addEventListener("load",_),y.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${m}`)))})}))}function o(u){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=u,window.dispatchEvent(h),!h.defaultPrevented)throw u}return r.then(u=>{for(const h of u||[])h.status==="rejected"&&o(h.reason);return e().catch(o)})},bA=(s,e,t)=>{let n;switch(s){case Dr:n=new Uint8ClampedArray(e*t*4);break;case Qi:n=new Uint16Array(e*t*4);break;case ca:n=new Uint32Array(e*t*4);break;case Gx:n=new Int8Array(e*t*4);break;case jx:n=new Int16Array(e*t*4);break;case Xm:n=new Int32Array(e*t*4);break;case Li:n=new Float32Array(e*t*4);break;default:throw new Error("Unsupported data type")}return n};let Bv;const e4=(s,e,t,n)=>{if(Bv!==void 0)return Bv;const r=new Ts(1,1,n);e.setRenderTarget(r);const o=new Gi(new Jc,new Gl({color:16777215}));e.render(o,t),e.setRenderTarget(null);const u=bA(s,r.width,r.height);return e.readRenderTargetPixels(r,0,0,r.width,r.height,u),r.dispose(),o.geometry.dispose(),o.material.dispose(),Bv=u[0]!==0,Bv};class j1{_renderer;_rendererIsDisposable=!1;_material;_scene;_camera;_quad;_renderTarget;_width;_height;_type;_colorSpace;_supportsReadPixels=!0;constructor(e){this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const t={format:or,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:e.renderTargetOptions?.anisotropy!==void 0?e.renderTargetOptions?.anisotropy:1,generateMipmaps:e.renderTargetOptions?.generateMipmaps!==void 0?e.renderTargetOptions?.generateMipmaps:!1,magFilter:e.renderTargetOptions?.magFilter!==void 0?e.renderTargetOptions?.magFilter:Gn,minFilter:e.renderTargetOptions?.minFilter!==void 0?e.renderTargetOptions?.minFilter:Gn,samples:e.renderTargetOptions?.samples!==void 0?e.renderTargetOptions?.samples:void 0,wrapS:e.renderTargetOptions?.wrapS!==void 0?e.renderTargetOptions?.wrapS:Ki,wrapT:e.renderTargetOptions?.wrapT!==void 0?e.renderTargetOptions?.wrapT:Ki};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=j1.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new Km,this._camera=new Ha,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!e4(this._type,this._renderer,this._camera,t)){let n;this._type===Qi&&(n=this._renderer.extensions.has("EXT_color_buffer_float")?Li:void 0),n!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${Li}`),this._type=n):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new Gi(new Jc,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new Ts(this.width,this.height,t),this._renderTarget.texture.mapping=e.renderTargetOptions?.mapping!==void 0?e.renderTargetOptions?.mapping:Xc}static instantiateRenderer(){const e=new U1;return e.setSize(128,128),e}render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(e){throw this._renderer.setRenderTarget(null),e}this._renderer.setRenderTarget(null)};toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=bA(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new Va(this.toArray(),this.width,this.height,or,this._type,e?.mapping||Xc,e?.wrapS||Ki,e?.wrapT||Ki,e?.magFilter||Gn,e?.minFilter||Gn,e?.anisotropy||1,vo);return t.generateMipmaps=e?.generateMipmaps!==void 0?e?.generateMipmaps:!1,t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof ls&&Object.values(this.material.uniforms).forEach(t=>{t.value instanceof oi&&t.value.dispose()}),Object.values(this.material).forEach(t=>{t instanceof oi&&t.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}class _A extends Error{}class SA extends Error{}const fm=(s,e,t)=>{const n=new RegExp(`${e}="([^"]*)"`,"i").exec(s);if(n)return n[1];const r=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(s);if(r){const o=r[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return o&&o.length===3?o.map(u=>u.replace(/<\/?rdf:li>/g,"")):r[1].trim()}if(t!==void 0)return t;throw new Error(`Can't find ${e} in gainmap metadata`)},t4=s=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(s):e=s.toString();let t=e.indexOf("<x:xmpmeta");for(;t!==-1;){const n=e.indexOf("x:xmpmeta>",t),r=e.slice(t,n+10);try{const o=fm(r,"hdrgm:GainMapMin","0"),u=fm(r,"hdrgm:GainMapMax"),h=fm(r,"hdrgm:Gamma","1"),d=fm(r,"hdrgm:OffsetSDR","0.015625"),m=fm(r,"hdrgm:OffsetHDR","0.015625"),v=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(r),x=v?v[1]:"0",y=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(r);if(!y)throw new Error("Incomplete gainmap metadata");const _=y[1];return{gainMapMin:Array.isArray(o)?o.map(M=>parseFloat(M)):[parseFloat(o),parseFloat(o),parseFloat(o)],gainMapMax:Array.isArray(u)?u.map(M=>parseFloat(M)):[parseFloat(u),parseFloat(u),parseFloat(u)],gamma:Array.isArray(h)?h.map(M=>parseFloat(M)):[parseFloat(h),parseFloat(h),parseFloat(h)],offsetSdr:Array.isArray(d)?d.map(M=>parseFloat(M)):[parseFloat(d),parseFloat(d),parseFloat(d)],offsetHdr:Array.isArray(m)?m.map(M=>parseFloat(M)):[parseFloat(m),parseFloat(m),parseFloat(m)],hdrCapacityMin:parseFloat(x),hdrCapacityMax:parseFloat(_)}}catch{}t=e.indexOf("<x:xmpmeta",n)}};class n4{options;constructor(e){this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((t,n)=>{const r=this.options.debug,o=new DataView(e.buffer);if(o.getUint16(0)!==65496){n(new Error("Not a valid jpeg"));return}const u=o.byteLength;let h=2,d=0,m;for(;h<u;){if(++d>250){n(new Error(`Found no marker after ${d} loops `));return}if(o.getUint8(h)!==255){n(new Error(`Not a valid marker at offset 0x${h.toString(16)}, found: 0x${o.getUint8(h).toString(16)}`));return}if(m=o.getUint8(h+1),r&&console.log(`Marker: ${m.toString(16)}`),m===226){r&&console.log("Found APP2 marker (0xffe2)");const v=h+4;if(o.getUint32(v)===1297106432){const x=v+4;let y;if(o.getUint16(x)===18761)y=!1;else if(o.getUint16(x)===19789)y=!0;else{n(new Error("No valid endianness marker found in TIFF header"));return}if(o.getUint16(x+2,!y)!==42){n(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const _=o.getUint32(x+4,!y);if(_<8){n(new Error("Not valid TIFF data! (First offset less than 8)"));return}const M=x+_,R=o.getUint16(M,!y),A=M+2;let E=0;for(let z=A;z<A+12*R;z+=12)o.getUint16(z,!y)===45057&&(E=o.getUint32(z+8,!y));const I=M+2+R*12+4,P=[];for(let z=I;z<I+E*16;z+=16){const U={MPType:o.getUint32(z,!y),size:o.getUint32(z+4,!y),dataOffset:o.getUint32(z+8,!y),dependantImages:o.getUint32(z+12,!y),start:-1,end:-1,isFII:!1};U.dataOffset?(U.start=x+U.dataOffset,U.isFII=!1):(U.start=0,U.isFII=!0),U.end=U.start+U.size,P.push(U)}if(this.options.extractNonFII&&P.length){const z=new Blob([o]),U=[];for(const H of P){if(H.isFII&&!this.options.extractFII)continue;const V=z.slice(H.start,H.end+1,"image/jpeg");U.push(V)}t(U)}}}h+=2+o.getUint16(h+2)}})}}const i4=async s=>{const e=t4(s);if(!e)throw new SA("Gain map XMP metadata not found");const n=await new n4({extractFII:!0,extractNonFII:!0}).extract(s);if(n.length!==2)throw new _A("Gain map recovery image not found");return{sdr:new Uint8Array(await n[0].arrayBuffer()),gainMap:new Uint8Array(await n[1].arrayBuffer()),metadata:e}},GE=s=>new Promise((e,t)=>{const n=document.createElement("img");n.onload=()=>{e(n)},n.onerror=r=>{t(r)},n.src=URL.createObjectURL(s)});class r4 extends As{_renderer;_renderTargetOptions;_internalLoadingManager;_config;constructor(e,t){super(t),this._config=e,e.renderer&&(this._renderer=e.renderer),this._internalLoadingManager=new Sy}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: A Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const e=this._config.createMaterial({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new oi,sdr:new oi});return this._config.createQuadRenderer({width:16,height:16,type:Qi,colorSpace:vo,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async processImages(e,t,n){const r=t?new Blob([t],{type:"image/jpeg"}):void 0,o=new Blob([e],{type:"image/jpeg"});let u,h,d=!1;if(typeof createImageBitmap>"u"){const m=await Promise.all([r?GE(r):Promise.resolve(void 0),GE(o)]);h=m[0],u=m[1],d=n==="flipY"}else{const m=await Promise.all([r?createImageBitmap(r,{imageOrientation:n||"flipY"}):Promise.resolve(void 0),createImageBitmap(o,{imageOrientation:n||"flipY"})]);h=m[0],u=m[1]}return{sdrImage:u,gainMapImage:h,needsFlip:d}}createTextures(e,t,n){const r=new oi(t||new ImageData(2,2),Xc,Ki,Ki,Gn,M_,or,Dr,1,vo);r.flipY=n,r.needsUpdate=!0;const o=new oi(e,Xc,Ki,Ki,Gn,M_,or,Dr,1,Gr);return o.flipY=n,o.needsUpdate=!0,{gainMap:r,sdr:o}}updateQuadRenderer(e,t,n,r,o){e.width=t.width,e.height=t.height,e.material.gainMap=n,e.material.sdr=r,e.material.gainMapMin=o.gainMapMin,e.material.gainMapMax=o.gainMapMax,e.material.offsetHdr=o.offsetHdr,e.material.offsetSdr=o.offsetSdr,e.material.gamma=o.gamma,e.material.hdrCapacityMin=o.hdrCapacityMin,e.material.hdrCapacityMax=o.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,o.hdrCapacityMax),e.material.needsUpdate=!0}}const s4=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,a4=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class o4 extends ls{_maxDisplayBoost;_hdrCapacityMin;_hdrCapacityMax;constructor({gamma:e,offsetHdr:t,offsetSdr:n,gainMapMin:r,gainMapMax:o,maxDisplayBoost:u,hdrCapacityMin:h,hdrCapacityMax:d,sdr:m,gainMap:v}){super({name:"GainMapDecoderMaterial",vertexShader:s4,fragmentShader:a4,uniforms:{sdr:{value:m},gainMap:{value:v},gamma:{value:new Q(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:new Q().fromArray(t)},offsetSdr:{value:new Q().fromArray(n)},gainMapMin:{value:new Q().fromArray(r)},gainMapMax:{value:new Q().fromArray(o)},weightFactor:{value:(Math.log2(u)-h)/(d-h)}},blending:mo,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=u,this._hdrCapacityMin=h,this._hdrCapacityMax=d,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){const e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){const t=this.uniforms.gamma.value;t.x=1/e[0],t.y=1/e[1],t.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){const e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class MA extends r4{constructor(e,t){super({renderer:e,createMaterial:n=>new o4(n),createQuadRenderer:n=>new j1(n)},t)}async render(e,t,n,r){const{sdrImage:o,gainMapImage:u,needsFlip:h}=await this.processImages(n,r,"flipY"),{gainMap:d,sdr:m}=this.createTextures(o,u,h);this.updateQuadRenderer(e,o,d,m,t),e.render()}}class l4 extends MA{load([e,t,n],r,o,u){const h=this.prepareQuadRenderer();let d,m,v;const x=async()=>{if(d&&m&&v){try{await this.render(h,v,d,m)}catch(L){this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(n),typeof u=="function"&&u(L),h.disposeOnDemandRenderer();return}typeof r=="function"&&r(h),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(n),h.disposeOnDemandRenderer()}};let y=!0,_=0,M=0,R=!0,A=0,E=0,N=!0,I=0,P=0;const z=()=>{if(typeof o=="function"){const L=_+A+I,B=M+E+P,W=y&&R&&N;o(new ProgressEvent("progress",{lengthComputable:W,loaded:B,total:L}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(n);const U=new la(this._internalLoadingManager);U.setResponseType("arraybuffer"),U.setRequestHeader(this.requestHeader),U.setPath(this.path),U.setWithCredentials(this.withCredentials),U.load(e,async L=>{if(typeof L=="string")throw new Error("Invalid sdr buffer");d=L,await x()},L=>{y=L.lengthComputable,M=L.loaded,_=L.total,z()},L=>{this.manager.itemError(e),typeof u=="function"&&u(L)});const H=new la(this._internalLoadingManager);H.setResponseType("arraybuffer"),H.setRequestHeader(this.requestHeader),H.setPath(this.path),H.setWithCredentials(this.withCredentials),H.load(t,async L=>{if(typeof L=="string")throw new Error("Invalid gainmap buffer");m=L,await x()},L=>{R=L.lengthComputable,E=L.loaded,A=L.total,z()},L=>{this.manager.itemError(t),typeof u=="function"&&u(L)});const V=new la(this._internalLoadingManager);return V.setRequestHeader(this.requestHeader),V.setPath(this.path),V.setWithCredentials(this.withCredentials),V.load(n,async L=>{if(typeof L!="string")throw new Error("Invalid metadata string");v=JSON.parse(L),await x()},L=>{N=L.lengthComputable,P=L.loaded,I=L.total,z()},L=>{this.manager.itemError(n),typeof u=="function"&&u(L)}),h}}class c4 extends MA{load(e,t,n,r){const o=this.prepareQuadRenderer(),u=new la(this._internalLoadingManager);return u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setPath(this.path),u.setWithCredentials(this.withCredentials),this.manager.itemStart(e),u.load(e,async h=>{if(typeof h=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const d=new Uint8Array(h);let m,v,x;try{const y=await i4(d);m=y.sdr,v=y.gainMap,x=y.metadata}catch(y){if(y instanceof SA||y instanceof _A)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),x={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},m=d;else throw y}try{await this.render(o,x,m.buffer,v?.buffer)}catch(y){this.manager.itemError(e),typeof r=="function"&&r(y),o.disposeOnDemandRenderer();return}typeof t=="function"&&t(o),this.manager.itemEnd(e),o.disposeOnDemandRenderer()},n,h=>{this.manager.itemError(e),typeof r=="function"&&r(h)}),o}}const Gm={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},EA="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",sd=s=>Array.isArray(s),W1=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function Cy({files:s=W1,path:e="",preset:t=void 0,colorSpace:n=void 0,extensions:r}={}){t&&(X1(t),s=Gm[t],e=EA);const o=sd(s),{extension:u,isCubemap:h}=q1(s),d=Y1(u);if(!d)throw new Error("useEnvironment: Unrecognized file extension: "+s);const m=Sr(_=>_.gl);te.useLayoutEffect(()=>{if(u!=="webp"&&u!=="jpg"&&u!=="jpeg")return;function _(){vd.clear(d,o?[s]:s)}m.domElement.addEventListener("webglcontextlost",_,{once:!0})},[s,m.domElement]);const v=vd(d,o?[s]:s,_=>{(u==="webp"||u==="jpg"||u==="jpeg")&&_.setRenderer(m),_.setPath==null||_.setPath(e),r&&r(_)});let x=o?v[0]:v;if(u==="jpg"||u==="jpeg"||u==="webp"){var y;x=(y=x.renderTarget)==null?void 0:y.texture}return x.mapping=h?go:ad,x.colorSpace=n??(h?"srgb":"srgb-linear"),x}const u4={files:W1,path:"",preset:void 0,extensions:void 0};Cy.preload=s=>{const e={...u4,...s};let{files:t,path:n=""}=e;const{preset:r,extensions:o}=e;r&&(X1(r),t=Gm[r],n=EA);const{extension:u}=q1(t);if(u==="webp"||u==="jpg"||u==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const h=Y1(u);if(!h)throw new Error("useEnvironment: Unrecognized file extension: "+t);vd.preload(h,sd(t)?[t]:t,d=>{d.setPath==null||d.setPath(n),o&&o(d)})};const f4={files:W1,preset:void 0};Cy.clear=s=>{const e={...f4,...s};let{files:t}=e;const{preset:n}=e;n&&(X1(n),t=Gm[n]);const{extension:r}=q1(t),o=Y1(r);if(!o)throw new Error("useEnvironment: Unrecognized file extension: "+t);vd.clear(o,sd(t)?[t]:t)};function X1(s){if(!(s in Gm))throw new Error("Preset must be one of: "+Object.keys(Gm).join(", "))}function q1(s){var e;const t=sd(s)&&s.length===6,n=sd(s)&&s.length===3&&s.some(u=>u.endsWith("json")),r=sd(s)?s[0]:s;return{extension:t?"cube":n?"webp":r.startsWith("data:application/exr")?"exr":r.startsWith("data:application/hdr")?"hdr":r.startsWith("data:image/jpeg")?"jpg":(e=r.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:t,isGainmap:n}}function Y1(s){return s==="cube"?Ew:s==="hdr"?jO:s==="exr"?WO:s==="jpg"||s==="jpeg"?c4:s==="webp"?l4:null}const h4=s=>s.current&&s.current.isScene,d4=s=>h4(s)?s.current:s;function Z1(s,e,t,n,r={}){var o,u,h,d;r={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...r};const m=d4(e||t),v=m.background,x=m.environment,y={backgroundBlurriness:m.backgroundBlurriness,backgroundIntensity:m.backgroundIntensity,backgroundRotation:(o=(u=m.backgroundRotation)==null||u.clone==null?void 0:u.clone())!==null&&o!==void 0?o:[0,0,0],environmentIntensity:m.environmentIntensity,environmentRotation:(h=(d=m.environmentRotation)==null||d.clone==null?void 0:d.clone())!==null&&h!==void 0?h:[0,0,0]};return s!=="only"&&(m.environment=n),s&&(m.background=n),Ko(m,r),()=>{s!=="only"&&(m.environment=x),s&&(m.background=v),Ko(m,y)}}function K1({scene:s,background:e=!1,map:t,...n}){const r=Sr(o=>o.scene);return te.useLayoutEffect(()=>{if(t)return Z1(e,s,r,t,n)}),null}function TA({background:s=!1,scene:e,blur:t,backgroundBlurriness:n,backgroundIntensity:r,backgroundRotation:o,environmentIntensity:u,environmentRotation:h,...d}){const m=Cy(d),v=Sr(x=>x.scene);return te.useLayoutEffect(()=>Z1(s,e,v,m,{backgroundBlurriness:t??n,backgroundIntensity:r,backgroundRotation:o,environmentIntensity:u,environmentRotation:h})),te.useEffect(()=>()=>{m.dispose()},[m]),null}function p4({children:s,near:e=.1,far:t=1e3,resolution:n=256,frames:r=1,map:o,background:u=!1,blur:h,backgroundBlurriness:d,backgroundIntensity:m,backgroundRotation:v,environmentIntensity:x,environmentRotation:y,scene:_,files:M,path:R,preset:A=void 0,extensions:E}){const N=Sr(V=>V.gl),I=Sr(V=>V.scene),P=te.useRef(null),[z]=te.useState(()=>new Km),U=te.useMemo(()=>{const V=new ny(n);return V.texture.type=Qi,V},[n]);te.useEffect(()=>()=>{U.dispose()},[U]),te.useLayoutEffect(()=>{if(r===1){const V=N.autoClear;N.autoClear=!0,P.current.update(N,z),N.autoClear=V}return Z1(u,_,I,U.texture,{backgroundBlurriness:h??d,backgroundIntensity:m,backgroundRotation:v,environmentIntensity:x,environmentRotation:y})},[s,z,U.texture,_,I,u,r,N]);let H=1;return xi(()=>{if(r===1/0||H<r){const V=N.autoClear;N.autoClear=!0,P.current.update(N,z),N.autoClear=V,H++}}),te.createElement(te.Fragment,null,KU(te.createElement(te.Fragment,null,s,te.createElement("cubeCamera",{ref:P,args:[e,t,U]}),M||A?te.createElement(TA,{background:!0,files:M,preset:A,path:R,extensions:E}):o?te.createElement(K1,{background:!0,map:o,extensions:E}):null),z))}function m4(s){var e,t,n,r;const o=Cy(s),u=s.map||o;te.useMemo(()=>V1({GroundProjectedEnvImpl:UO}),[]),te.useEffect(()=>()=>{o.dispose()},[o]);const h=te.useMemo(()=>[u],[u]),d=(e=s.ground)==null?void 0:e.height,m=(t=s.ground)==null?void 0:t.radius,v=(n=(r=s.ground)==null?void 0:r.scale)!==null&&n!==void 0?n:1e3;return te.createElement(te.Fragment,null,te.createElement(K1,xf({},s,{map:u})),te.createElement("groundProjectedEnvImpl",{args:h,scale:v,height:d,radius:m}))}function g4(s){return s.ground?te.createElement(m4,s):s.map?te.createElement(K1,s):s.children?te.createElement(p4,s):te.createElement(TA,s)}const v4=[{id:"salt-dissolution",title:"Dissolving Salt vs Sand in Water",chapter:"Separation of Substances",classLevel:6,aim:"To study the solubility of salt and sand in water.",apparatus:["beaker","glass-rod"],chemicals:[{id:"water",name:"Water",color:"#a8d4ff"},{id:"salt",name:"Common Salt",color:"#d0e8ff"},{id:"sand",name:"Sand",color:"#c4a465"}],procedureSteps:["Place the beaker on the lab bench","Add water to the beaker","Add salt to the water","Place the glass rod","Stir the mixture with glass rod","Observe - then Reset and repeat with sand"],reactions:{"water+salt+stir":{observation:"The salt crystals gradually disappear as you stir. The solution becomes slightly milky.",explanation:"Salt (sodium chloride) is soluble in water. Water molecules surround the salt ions (Na and Cl) and pull them apart, distributing them evenly throughout the solution. This is called dissolution.",visual:{liquidColor:"#e8f4ff",particles:!1},success:!0},"water+sand+stir":{observation:"The sand particles swirl around but settle at the bottom when stirring stops. The water becomes slightly cloudy.",explanation:"Sand (silicon dioxide) is insoluble in water. The water molecules cannot break apart the strong bonds in sand particles. Sand is denser than water, so it sinks and settles at the bottom.",visual:{liquidColor:"#d4c4a8",particles:!0,settled:!0},success:!0},"water+salt":{observation:"Salt crystals are sitting in the water. Nothing much is happening yet.",explanation:"Try stirring the mixture to help the salt dissolve faster. Stirring increases the contact between water molecules and salt crystals.",visual:{liquidColor:"#a8d4ff",particles:!0},success:!1},"water+sand":{observation:"Sand has sunk to the bottom of the beaker. The water above is clear.",explanation:"Sand is denser than water and insoluble, so it naturally settles at the bottom.",visual:{liquidColor:"#a8d4ff",particles:!0,settled:!0},success:!1}},conclusion:"Salt is soluble in water and forms a clear solution. Sand is insoluble in water and settles at the bottom. This difference in solubility can be used to separate mixtures of salt and sand."},{id:"filtration",title:"Separation by Filtration",chapter:"Separation of Substances",classLevel:6,aim:"To separate insoluble impurities from water using filtration.",apparatus:["beaker","funnel","filter-paper"],chemicals:[{id:"muddy-water",name:"Muddy Water",color:"#8b7355"}],procedureSteps:["Place a beaker on the lab bench","Place the funnel on the lab bench","Place the filter paper in the funnel","Add muddy water to the beaker","Pour the muddy water through the funnel","Observe the transparent water collected below"],reactions:{"muddy-water":{observation:"Muddy water is in the beaker. The water appears brown and cloudy with suspended mud particles.",explanation:"Muddy water is a mixture of water and insoluble mud particles. To separate them, you need to set up a filtration apparatus.",visual:{liquidColor:"#8b7355",particles:!0},success:!1},"muddy-water+pour":{observation:"You are pouring the muddy water into the funnel... Watch as the filter paper separates the mud from the water!",explanation:"The muddy water passes through the filter paper. Water molecules are small enough to pass through the tiny pores, but mud particles are too large and get trapped.",visual:{pouring:!0},success:!1},"muddy-water+pour+filter":{observation:"Filtration complete! Clear water has collected in the beaker below. The brown mud residue is trapped on the filter paper.",explanation:"Filtration separates insoluble solid particles from a liquid. The filter paper acts as a barrier - it allows water molecules to pass through but traps the larger mud particles.",visual:{liquidColor:"#c8e0ff",particles:!1,filtered:!0},success:!0}},conclusion:"Filtration is used to separate insoluble solids from liquids. The filter paper traps solid particles while allowing the liquid to pass through. This method is used to purify drinking water and in many industrial processes."},{id:"evaporation",title:"Separation by Evaporation",chapter:"Separation of Substances",classLevel:6,aim:"To obtain salt from salt solution by evaporation.",apparatus:["tripod-stand","burner","china-dish"],chemicals:[{id:"salt-solution",name:"Salt Solution",color:"#e8f4ff"}],procedureSteps:["Place the tripod stand on the lab bench","Place the burner under the tripod stand","Place the china dish on the tripod stand","Add salt solution to the china dish","Heat the solution and observe evaporation","Observe the salt crystals left behind"],reactions:{"salt-solution":{observation:"Clear salt solution is in the china dish. The solution looks like plain water but contains dissolved salt.",explanation:"Salt solution is a homogeneous mixture where salt is completely dissolved in water. To recover the salt, you need to evaporate the water.",visual:{liquidColor:"#e8f4ff",particles:!1},success:!1},"salt-solution+heat":{observation:"As you heat the solution, you can see steam rising. The water level is decreasing gradually.",explanation:"Heat provides energy for water molecules to escape as water vapor (steam). Keep heating to evaporate all the water.",visual:{liquidColor:"#e8f4ff",steam:!0},success:!1},"salt-solution+heat+evaporate":{observation:"All the water has evaporated! White salt crystals are left behind at the bottom of the china dish.",explanation:"When water evaporates, the dissolved salt cannot escape with it because salt has a much higher boiling point. The salt crystallizes and remains in the dish. This is how sea salt is obtained from sea water!",visual:{liquidColor:"transparent",crystals:!0},success:!0}},conclusion:"Evaporation is used to separate a dissolved solid from a liquid. When the liquid evaporates, the solid is left behind. This method is used to obtain salt from sea water and in sugar production."},{id:"physical-chemical",title:"Physical vs Chemical Change",chapter:"Changes Around Us",classLevel:6,aim:"To distinguish between physical and chemical changes.",apparatus:["burner","tripod-stand","beaker","tongs"],chemicals:[{id:"ice",name:"Ice Cubes",color:"#e0f4ff"},{id:"paper",name:"Paper Strip",color:"#f5f5dc"},{id:"magnesium",name:"Magnesium Ribbon",color:"#d4d4d4"}],procedureSteps:["Click 'Tripod Stand' to place it on the bench","Click 'Burner' to place it under the stand","Click 'Beaker' to place it on the stand","Click 'Ice Cubes' to add them to the beaker","Click the Burner to turn it ON (Observe Melting)","Click the 'Reset' button to clear the workspace","Click 'Burner' to place it on the bench","Click 'Tongs' to place them","Click 'Paper Strip' to hold it with tongs","Click the Burner to turn it ON (Observe Burning)","Click the 'Reset' button to clear the workspace","Click 'Burner' to place it on the bench","Click 'Tongs' to place them","Click 'Magnesium Ribbon' to hold it","Click the Burner to turn it ON (Observe White Flash)"],reactions:{"ice+heat":{observation:"The ice is melting! It is turning into liquid water. If you cool it again, it will become ice.",explanation:"Melting of ice is a PHYSICAL CHANGE. Only the state changes (solid to liquid), but the substance remains water (HO). This change is reversible.",visual:{liquidColor:"#e0f4ff",melting:!0},success:!0},"paper+heat":{observation:"The paper catches fire and burns! It turns into ash and smoke. You cannot get the paper back from ash.",explanation:"Burning of paper is a CHEMICAL CHANGE. The paper reacts with oxygen to form new substances (ash, carbon dioxide, water vapor). This change is irreversible.",visual:{burning:!0,ash:!0},success:!0},"magnesium+heat":{observation:"The magnesium ribbon burns with a bright white flame! A white powder (magnesium oxide) is formed.",explanation:"Burning of magnesium is a CHEMICAL CHANGE. Magnesium reacts with oxygen: 2Mg + O  2MgO. The white powder formed is magnesium oxide, a completely new substance.",visual:{burning:!0,brightFlame:!0},success:!0}},conclusion:"Physical changes are reversible and do not form new substances (melting, freezing, dissolving). Chemical changes are usually irreversible and form new substances (burning, rusting, cooking)."}],x4=[{id:"acids-bases",title:"Testing Acids and Bases",chapter:"Acids, Bases and Salts",classLevel:7,aim:"To test the nature of substances using litmus indicators and observe color changes.",apparatus:["test-tube-stand","test-tube","dropper"],chemicals:[{id:"vinegar",name:"Vinegar (Acid)",color:"#fff8e0"},{id:"lemon-juice",name:"Lemon Juice (Acid)",color:"#fffacd"},{id:"soap-solution",name:"Soap Solution (Base)",color:"#e8f0ff"},{id:"baking-soda",name:"Baking Soda Soln (Base)",color:"#f8f8ff"},{id:"blue-litmus",name:"Blue Litmus",color:"#4169e1"},{id:"red-litmus",name:"Red Litmus",color:"#dc143c"}],procedureSteps:["Add vinegar to test tube","Add blue litmus using dropper - observe color change","Reset & add red litmus - observe","Repeat for other substances"],reactions:{"vinegar+blue-litmus":{observation:" The BLUE litmus turned RED! This confirms vinegar is an ACID.",explanation:"Acids turn blue litmus paper/solution RED. Vinegar contains acetic acid which releases H ions in water.",visual:{liquidColor:"#ff6b6b",indicatorChange:!0},success:!0,resultType:"acid"},"vinegar+red-litmus":{observation:"The red litmus remains RED. No color change with red litmus in acid.",explanation:"Red litmus does not change color in acidic solutions. To identify an acid, test with blue litmus.",visual:{liquidColor:"#ffb3b3"},success:!0,resultType:"acid-no-change"},"lemon-juice+blue-litmus":{observation:" The BLUE litmus turned RED! This confirms lemon juice is an ACID.",explanation:"Lemon juice contains citric acid. Like all acids, it releases H ions which turn blue litmus red.",visual:{liquidColor:"#ff7777",indicatorChange:!0},success:!0,resultType:"acid"},"lemon-juice+red-litmus":{observation:"The red litmus remains RED. No color change with red litmus in acid.",explanation:"Red litmus does not change color in acidic solutions.",visual:{liquidColor:"#ffb3b3"},success:!0,resultType:"acid-no-change"},"soap-solution+blue-litmus":{observation:"The blue litmus remains BLUE. No color change with blue litmus in base.",explanation:"Blue litmus does not change color in basic solutions.",visual:{liquidColor:"#87ceeb"},success:!0,resultType:"base-no-change"},"soap-solution+red-litmus":{observation:" The RED litmus turned BLUE! This confirms soap solution is a BASE.",explanation:"Bases turn red litmus paper/solution BLUE. Soap solution releases OH ions in water.",visual:{liquidColor:"#6495ed",indicatorChange:!0},success:!0,resultType:"base"},"baking-soda+blue-litmus":{observation:"The blue litmus remains BLUE. No color change with blue litmus in base.",explanation:"Blue litmus does not change color in basic solutions.",visual:{liquidColor:"#b0c4de"},success:!0,resultType:"base-no-change"},"baking-soda+red-litmus":{observation:" The RED litmus turned BLUE! This confirms baking soda solution is a BASE.",explanation:"Baking soda (NaHCO) is a weak base that releases OH ions in water.",visual:{liquidColor:"#6495ed",indicatorChange:!0},success:!0,resultType:"base"}},conclusion:"Acids turn blue litmus red (due to H ions). Bases turn red litmus blue (due to OH ions). Common acids: vinegar, lemon juice. Common bases: soap, baking soda."}],y4=[{id:"neutralization",title:"Neutralization Reaction",chapter:"Acids, Bases and Salts",classLevel:8,aim:"To study the reaction between an acid and a base using phenolphthalein indicator.",apparatus:["beaker","dropper"],chemicals:[{id:"naoh",name:"NaOH Solution",color:"#e0e0ff"},{id:"phenolphthalein",name:"Phenolphthalein",color:"#ffb6c1"},{id:"hcl",name:"Dilute HCl",color:"#ffe0e0"}],procedureSteps:["Place the beaker on the lab bench","Add NaOH solution to the beaker","Add Phenolphthalein indicator","Select the dropper from apparatus shelf","Slowly add 5 drops of HCl to neutralize"],reactions:{naoh:{observation:"Sodium hydroxide (NaOH) solution is in the beaker. It is a clear, colorless basic solution.",explanation:"NaOH is a strong base that completely dissociates in water to form Na and OH ions.",visual:{liquidColor:"#e8e8ff"},success:!1},"naoh+phenolphthalein":{observation:" The solution turned PINK! Phenolphthalein indicates the presence of a base. Now add HCl to neutralize.",explanation:"Phenolphthalein is colorless in acidic/neutral solutions but turns pink/magenta in basic solutions (pH > 8.2).",visual:{liquidColor:"#ff69b4",indicatorAdded:!0},success:!1},"naoh+phenolphthalein+hcl":{observation:" NEUTRALIZATION COMPLETE! The solution is now colorless - the acid has neutralized the base!",explanation:"Complete neutralization: HCl + NaOH  NaCl + HO. The phenolphthalein turned colorless because the solution is no longer basic.",visual:{liquidColor:"#f5f5f5",neutralized:!0},success:!0}},conclusion:"When an acid (HCl) reacts with a base (NaOH), they neutralize each other to form salt (NaCl) and water. Reaction: HCl + NaOH  NaCl + HO"}],Vx={6:v4,7:x4,8:y4};function b4(s){for(const e in Vx){const t=Vx[Number(e)].find(n=>n.id===s);if(t)return t}}function jE(s){return Vx[s]||[]}function Ry(){return Object.values(Vx).flat()}function wA(){return Ry().length}const Ks={water:{id:"water",name:"Water",formula:"HO",color:"#4fc3f7",type:"water"},hydrochloric_acid:{id:"hydrochloric_acid",name:"Hydrochloric Acid",formula:"HCl",color:"#c8e6c9",type:"acid",concentration:1},sodium_hydroxide:{id:"sodium_hydroxide",name:"Sodium Hydroxide",formula:"NaOH",color:"#e1bee7",type:"base",concentration:1},zinc:{id:"zinc",name:"Zinc Metal",formula:"Zn",color:"#b0bec5",type:"metal"},sodium_chloride:{id:"sodium_chloride",name:"Sodium Chloride (Salt)",formula:"NaCl",color:"#ffffff",type:"salt"},phenolphthalein:{id:"phenolphthalein",name:"Phenolphthalein",formula:"CHO",color:"#ffccff",type:"indicator"},sulfuric_acid:{id:"sulfuric_acid",name:"Sulfuric Acid",formula:"HSO",color:"#e8f5e9",type:"acid",concentration:1},barium_chloride:{id:"barium_chloride",name:"Barium Chloride",formula:"BaCl",color:"#e3f2fd",type:"salt"},silver_nitrate:{id:"silver_nitrate",name:"Silver Nitrate",formula:"AgNO",color:"#f5f5f5",type:"salt"},barium_sulfate:{id:"barium_sulfate",name:"Barium Sulfate",formula:"BaSO",color:"#ffffff",type:"salt"},silver_chloride:{id:"silver_chloride",name:"Silver Chloride",formula:"AgCl",color:"#f5f5f5",type:"salt"}},_4=[{id:"acid_base_neutralization",name:"Acid-Base Neutralization",description:"When an acid reacts with a base, they neutralize each other to form water and a salt.",reactants:{chemicalType1:"acid",chemicalType2:"base"},products:[Ks.water,Ks.sodium_chloride],resultColor:"#e0f7fa",effects:["color_change","heat"],isExothermic:!0},{id:"acid_metal_reaction",name:"Acid-Metal Reaction",description:"When an acid reacts with a reactive metal, it produces hydrogen gas and a salt.",reactants:{chemicalType1:"acid",chemicalType2:"metal"},products:[{id:"hydrogen_gas",name:"Hydrogen Gas",formula:"H",color:"transparent",type:"neutral"},{id:"zinc_chloride",name:"Zinc Chloride",formula:"ZnCl",color:"#f5f5f5",type:"salt"}],resultColor:"#f5f5f5",effects:["bubbles","heat"],isExothermic:!0},{id:"indicator_base",name:"Indicator Color Change",description:"Phenolphthalein turns pink in basic solutions!",reactants:{chemicalType1:"indicator",chemicalType2:"base"},products:[Ks.sodium_hydroxide],resultColor:"#ff66b2",effects:["color_change"],isExothermic:!1},{id:"barium_sulfate_precipitation",name:"Precipitation Reaction",description:"Barium chloride reacts with sulfuric acid to form white barium sulfate precipitate!",reactants:{chemicalType1:"salt",chemicalType2:"acid"},products:[Ks.barium_sulfate],resultColor:"#ffffff",effects:["precipitate"],isExothermic:!1}];class S4{reactions;constructor(){this.reactions=_4}findReaction(e,t){return this.reactions.find(n=>{const{chemicalType1:r,chemicalType2:o}=n.reactants;return r===e&&o===t||r===t&&o===e})||null}checkReaction(e){if(e.length<2)return{occurred:!1,message:"Not enough chemicals to react."};for(let t=0;t<e.length;t++)for(let n=t+1;n<e.length;n++){const r=e[t].chemical,o=e[n].chemical,u=this.findReaction(r.type,o.type);if(u)return{occurred:!0,reaction:u,products:u.products,message:`Reaction! ${u.name}: ${u.description}`}}return{occurred:!1,message:"No reaction occurred."}}getAllReactions(){return[...this.reactions]}getChemical(e){return Ks[e]}}const WE=new S4;class M4{audioContext=null;isInitialized=!1;activeSounds=new Map;getContext(){return this.audioContext||(this.audioContext=new AudioContext),this.audioContext}async initialize(){if(this.isInitialized)return;const e=this.getContext();e.state==="suspended"&&await e.resume(),this.isInitialized=!0}playBubbles(e,t=4e3){this.initialize();const n=this.getContext(),r=[],o=[],u=n.sampleRate*(t/1e3),h=n.createBuffer(1,u,n.sampleRate),d=h.getChannelData(0);for(let M=0;M<u;M++)d[M]=(Math.random()*2-1)*.3;const m=n.createBufferSource();m.buffer=h;const v=n.createBiquadFilter();v.type="highpass",v.frequency.value=4e3;const x=n.createGain();x.gain.setValueAtTime(0,n.currentTime),x.gain.linearRampToValueAtTime(.04,n.currentTime+.3),x.gain.setValueAtTime(.04,n.currentTime+t/1e3-.5),x.gain.linearRampToValueAtTime(0,n.currentTime+t/1e3),m.connect(v),v.connect(x),x.connect(n.destination),m.start(),o.push(x),this.activeSounds.set(e,{oscillators:r,gains:o}),this.activeSounds.get(e).fizzNoise=m;const y=Math.floor(t/60);for(let M=0;M<y;M++){const R=Math.random()*t*.9,A=Math.random();let E,N,I;A<.5?(E=400+Math.random()*300,N=.03+Math.random()*.02,I=.04+Math.random()*.03):A<.85?(E=200+Math.random()*200,N=.05+Math.random()*.03,I=.06+Math.random()*.04):(E=80+Math.random()*100,N=.08+Math.random()*.04,I=.1+Math.random()*.06),setTimeout(()=>{if(!this.activeSounds.has(e))return;const P=n.createOscillator(),z=n.createGain(),U=n.createBiquadFilter();U.type="lowpass",U.frequency.value=1200+Math.random()*800,P.type="sine",P.frequency.setValueAtTime(E,n.currentTime),P.frequency.exponentialRampToValueAtTime(E*2.5,n.currentTime+I*.7),P.frequency.exponentialRampToValueAtTime(E*.5,n.currentTime+I),z.gain.setValueAtTime(0,n.currentTime),z.gain.linearRampToValueAtTime(N,n.currentTime+.005),z.gain.exponentialRampToValueAtTime(.001,n.currentTime+I),P.connect(U),U.connect(z),z.connect(n.destination),P.start(n.currentTime),P.stop(n.currentTime+I+.01)},R)}const _=Math.floor(t/800);for(let M=0;M<_;M++){const R=200+Math.random()*(t-500);setTimeout(()=>{if(!this.activeSounds.has(e))return;const A=n.createOscillator(),E=n.createGain();A.type="sine",A.frequency.setValueAtTime(40+Math.random()*30,n.currentTime),A.frequency.exponentialRampToValueAtTime(60+Math.random()*40,n.currentTime+.15),E.gain.setValueAtTime(0,n.currentTime),E.gain.linearRampToValueAtTime(.06,n.currentTime+.02),E.gain.exponentialRampToValueAtTime(.001,n.currentTime+.2),A.connect(E),E.connect(n.destination),A.start(n.currentTime),A.stop(n.currentTime+.25)},R)}setTimeout(()=>this.stopSound(e),t)}playSizzle(e,t=3e3){this.initialize();const n=this.getContext(),r=[],o=[],u=n.sampleRate*(t/1e3),h=n.createBuffer(1,u,n.sampleRate),d=h.getChannelData(0);for(let U=0;U<u;U++)d[U]=Math.random()*2-1;const m=n.createBufferSource();m.buffer=h;const v=n.createBiquadFilter();v.type="bandpass",v.frequency.value=2500,v.Q.value=1.5;const x=n.createGain();x.gain.setValueAtTime(0,n.currentTime),x.gain.linearRampToValueAtTime(.08,n.currentTime+.15),x.gain.setValueAtTime(.08,n.currentTime+t/1e3-.4),x.gain.exponentialRampToValueAtTime(.001,n.currentTime+t/1e3);const y=n.createOscillator(),_=n.createGain();y.frequency.value=12+Math.random()*6,_.gain.value=800,y.connect(_),_.connect(v.frequency),m.connect(v),v.connect(x),x.connect(n.destination),y.start(),m.start(),o.push(x),r.push(y),this.activeSounds.set(e,{oscillators:r,gains:o}),this.activeSounds.get(e).steamNoise=m;const M=Math.floor(t/50);for(let U=0;U<M;U++){const H=Math.random()*t*.85;setTimeout(()=>{if(!this.activeSounds.has(e))return;const V=n.createOscillator(),L=n.createGain(),B=n.createBiquadFilter();B.type="highpass",B.frequency.value=2e3+Math.random()*2e3,V.type="sawtooth",V.frequency.setValueAtTime(800+Math.random()*1200,n.currentTime),V.frequency.exponentialRampToValueAtTime(200,n.currentTime+.02),L.gain.setValueAtTime(0,n.currentTime),L.gain.linearRampToValueAtTime(.02+Math.random()*.02,n.currentTime+.002),L.gain.exponentialRampToValueAtTime(.001,n.currentTime+.02+Math.random()*.02),V.connect(B),B.connect(L),L.connect(n.destination),V.start(n.currentTime),V.stop(n.currentTime+.05)},H)}const R=n.createOscillator(),A=n.createGain(),E=n.createBiquadFilter();R.type="sine",R.frequency.setValueAtTime(80,n.currentTime),R.frequency.exponentialRampToValueAtTime(200,n.currentTime+t/3e3),R.frequency.exponentialRampToValueAtTime(60,n.currentTime+t/1e3),E.type="lowpass",E.frequency.value=300,A.gain.setValueAtTime(0,n.currentTime),A.gain.linearRampToValueAtTime(.1,n.currentTime+.1),A.gain.setValueAtTime(.1,n.currentTime+t/1e3-.3),A.gain.exponentialRampToValueAtTime(.001,n.currentTime+t/1e3),R.connect(E),E.connect(A),A.connect(n.destination),R.start(),R.stop(n.currentTime+t/1e3+.1),r.push(R);const N=n.createOscillator(),I=n.createGain();N.type="sine",N.frequency.setValueAtTime(55,n.currentTime);const P=n.createOscillator(),z=n.createGain();P.frequency.value=4,z.gain.value=3,P.connect(z),z.connect(N.frequency),I.gain.setValueAtTime(0,n.currentTime),I.gain.linearRampToValueAtTime(.06,n.currentTime+.3),I.gain.setValueAtTime(.06,n.currentTime+t/1e3-.5),I.gain.exponentialRampToValueAtTime(.001,n.currentTime+t/1e3),N.connect(I),I.connect(n.destination),P.start(),N.start(),N.stop(n.currentTime+t/1e3+.1),P.stop(n.currentTime+t/1e3+.1),r.push(N,P),setTimeout(()=>{this.stopSound(e)},t)}playPour(e){this.initialize();const t=this.getContext(),n=t.sampleRate*2,r=t.createBuffer(1,n,t.sampleRate),o=r.getChannelData(0);let u=0;for(let y=0;y<n;y++){const _=Math.random()*2-1;o[y]=(u+.02*_)/1.02,u=o[y],o[y]*=3.5}const h=t.createBufferSource();h.buffer=r,h.loop=!0;const d=t.createBiquadFilter();d.type="lowpass",d.frequency.value=600;const m=t.createGain();m.gain.setValueAtTime(0,t.currentTime),m.gain.linearRampToValueAtTime(.12,t.currentTime+.1);const v=t.createOscillator(),x=t.createGain();v.frequency.value=3,x.gain.value=.03,v.connect(x),x.connect(m.gain),h.connect(d),d.connect(m),m.connect(t.destination),v.start(),h.start(),this.activeSounds.set(e,{oscillators:[v],gains:[m]}),this.activeSounds.get(e).noise=h}stopSound(e){const t=this.activeSounds.get(e);if(!t)return;const n=this.getContext();this.activeSounds.delete(e),t.gains.forEach(r=>{try{r.gain.cancelScheduledValues(n.currentTime),r.gain.setValueAtTime(r.gain.value,n.currentTime),r.gain.linearRampToValueAtTime(0,n.currentTime+.05)}catch{}}),setTimeout(()=>{if(t.oscillators.forEach(r=>{try{r.stop()}catch{}}),t.noise)try{t.noise.stop()}catch{}if(t.fizzNoise)try{t.fizzNoise.stop()}catch{}if(t.steamNoise)try{t.steamNoise.stop()}catch{}if(t.flameNoise)try{t.flameNoise.stop()}catch{}if(t.rumbleNoise)try{t.rumbleNoise.stop()}catch{}},60)}playReactionSound(e,t,n){switch(e){case"bubbles":this.playBubbles(t,n);break;case"heat":this.playSizzle(t,n);break;case"boiling":this.playBoiling(t,n);break}}playFlame(e){this.initialize();const t=this.getContext(),n=t.sampleRate*4,r=t.createBuffer(1,n,t.sampleRate),o=r.getChannelData(0);let u=0;for(let y=0;y<n;y++){const _=Math.random()*2-1;o[y]=(u+.02*_)/1.02,u=o[y],o[y]*=3.5}const h=t.createBufferSource();h.buffer=r,h.loop=!0;const d=t.createBiquadFilter();d.type="bandpass",d.frequency.value=400,d.Q.value=.8;const m=t.createGain();m.gain.setValueAtTime(0,t.currentTime),m.gain.linearRampToValueAtTime(.08,t.currentTime+.3);const v=t.createOscillator(),x=t.createGain();v.frequency.value=8+Math.random()*4,x.gain.value=.02,v.connect(x),x.connect(m.gain),h.connect(d),d.connect(m),m.connect(t.destination),v.start(),h.start(),this.activeSounds.set(e,{oscillators:[v],gains:[m]}),this.activeSounds.get(e).flameNoise=h}playBoiling(e,t=5e3){this.initialize();const n=this.getContext(),r=[],o=[],u=n.sampleRate*(t/1e3),h=n.createBuffer(1,u,n.sampleRate),d=h.getChannelData(0);let m=0;for(let M=0;M<u;M++){const R=Math.random()*2-1;d[M]=(m+.02*R)/1.02,m=d[M],d[M]*=2}const v=n.createBufferSource();v.buffer=h;const x=n.createBiquadFilter();x.type="lowpass",x.frequency.value=200;const y=n.createGain();y.gain.setValueAtTime(0,n.currentTime),y.gain.linearRampToValueAtTime(.06,n.currentTime+.2),y.gain.setValueAtTime(.06,n.currentTime+t/1e3-.3),y.gain.linearRampToValueAtTime(0,n.currentTime+t/1e3),v.connect(x),x.connect(y),y.connect(n.destination),v.start(),o.push(y),this.activeSounds.set(e,{oscillators:r,gains:o}),this.activeSounds.get(e).rumbleNoise=v;const _=Math.floor(t/40);for(let M=0;M<_;M++){const R=Math.random()*t*.9;setTimeout(()=>{if(!this.activeSounds.has(e))return;const A=n.createOscillator(),E=n.createGain(),N=150+Math.random()*250;A.type="sine",A.frequency.setValueAtTime(N,n.currentTime),A.frequency.exponentialRampToValueAtTime(N*1.8,n.currentTime+.03),E.gain.setValueAtTime(0,n.currentTime),E.gain.linearRampToValueAtTime(.04+Math.random()*.03,n.currentTime+.005),E.gain.exponentialRampToValueAtTime(.001,n.currentTime+.04),A.connect(E),E.connect(n.destination),A.start(n.currentTime),A.stop(n.currentTime+.06)},R)}setTimeout(()=>this.stopSound(e),t)}playWarning(e="warning"){this.initialize();const t=this.getContext(),n=t.createOscillator(),r=t.createGain();n.type="sawtooth",n.frequency.setValueAtTime(440,t.currentTime),n.frequency.exponentialRampToValueAtTime(110,t.currentTime+.4),r.gain.setValueAtTime(0,t.currentTime),r.gain.linearRampToValueAtTime(.4,t.currentTime+.05),r.gain.exponentialRampToValueAtTime(.001,t.currentTime+.4),n.connect(r),r.connect(t.destination),n.start(t.currentTime),n.stop(t.currentTime+.5);const o=t.createOscillator(),u=t.createGain();o.type="square",o.frequency.setValueAtTime(430,t.currentTime),o.frequency.exponentialRampToValueAtTime(100,t.currentTime+.4),u.gain.setValueAtTime(0,t.currentTime),u.gain.linearRampToValueAtTime(.2,t.currentTime+.05),u.gain.exponentialRampToValueAtTime(.001,t.currentTime+.4),o.connect(u),u.connect(t.destination),o.start(t.currentTime),o.stop(t.currentTime+.5)}playDropSound(){this.initialize();const e=this.getContext(),t=e.createOscillator(),n=e.createGain(),r=1100+Math.random()*200;t.type="sine",t.frequency.setValueAtTime(r,e.currentTime),t.frequency.exponentialRampToValueAtTime(r*1.5,e.currentTime+.05),n.gain.setValueAtTime(0,e.currentTime),n.gain.linearRampToValueAtTime(.08,e.currentTime+.005),n.gain.exponentialRampToValueAtTime(.001,e.currentTime+.2),t.connect(n),n.connect(e.destination),t.start(e.currentTime),t.stop(e.currentTime+.25)}stopAll(){this.activeSounds.forEach((e,t)=>this.stopSound(t))}}const Vl=new M4,E4=Object.freeze(Object.defineProperty({__proto__:null,SoundManager:Vl},Symbol.toStringTag,{value:"Module"}));let XE=0;const Ee=bO((s,e)=>({vessels:new Map([["beaker_1",{id:"beaker_1",type:"beaker",capacity:500,currentVolume:0,tiltAngle:0,temperature:25,contents:[],position:[-1.2,0,0]}],["beaker_2",{id:"beaker_2",type:"beaker",capacity:500,currentVolume:0,tiltAngle:0,temperature:25,contents:[],position:[1.2,0,0]}],["tube_1",{id:"tube_1",type:"test_tube",capacity:50,currentVolume:0,tiltAngle:0,temperature:25,contents:[],position:[-2.5,0,-1]}],["tube_2",{id:"tube_2",type:"test_tube",capacity:50,currentVolume:0,tiltAngle:0,temperature:25,contents:[],position:[-2.1,0,-1]}],["tube_3",{id:"tube_3",type:"test_tube",capacity:50,currentVolume:0,tiltAngle:0,temperature:25,contents:[],position:[-1.7,0,-1]}],["tube_4",{id:"tube_4",type:"test_tube",capacity:50,currentVolume:0,tiltAngle:0,temperature:25,contents:[],position:[-1.3,0,-1]}],["flask_1",{id:"flask_1",type:"flask",capacity:250,currentVolume:0,tiltAngle:0,temperature:25,contents:[],position:[2.8,0,.5]}]]),selectedVesselId:"beaker_1",isPouringActive:!1,pouringSourceId:null,pouringTargetId:null,pendingFiltrationVolume:0,isAutoPouring:!1,activeEffects:[],reactionNotification:null,safetyWarning:null,bunsenBurnerOn:!1,heatingVesselId:null,experimentMode:"sandbox",showLab:!1,currentExperiment:null,placedApparatus:[],addedChemicals:[],experimentActions:[],currentObservation:"Welcome to the Virtual Chemistry Lab! Select an experiment to begin.",currentExplanation:"",showExplanation:!1,experimentHeatLevel:0,experimentStirCount:0,isStirring:!1,completedExperiments:JSON.parse(localStorage.getItem("completedExperiments")||"[]"),saltTested:!1,sandTested:!1,resetAfterSaltTest:!1,showResetPrompt:!1,resetPromptMessage:"",showCompletionPopup:!1,dishCracked:!1,iceTested:!1,paperTested:!1,magnesiumTested:!1,neutralizationAnimating:!1,neutralizationDropCount:0,neutralizationComplete:!1,addVessel:t=>s(n=>{const r=new Map(n.vessels);r.set(t.id,t);let o=n.placedApparatus;if(n.currentExperiment?.id==="filtration"&&t.type==="beaker"){const u=r.get(t.id);u&&!u.name&&r.set(t.id,{...u,name:"Muddy Water Beaker"}),r.has("collection_beaker")||r.set("collection_beaker",{id:"collection_beaker",name:"Collection Beaker",type:"beaker",capacity:250,currentVolume:0,tiltAngle:0,temperature:25,contents:[],position:[3.5,0,0]}),o.includes("beaker")||(o=[...o,"beaker"])}return{vessels:r,placedApparatus:o}}),removeVessel:t=>s(n=>{const r=new Map(n.vessels);return r.delete(t),{vessels:r}}),selectVessel:t=>s({selectedVesselId:t}),fillVessel:(t,n,r)=>s(o=>{const u=o.vessels.get(t);if(!u)return o;const h=Math.min(u.currentVolume+r,u.capacity),d=h-u.currentVolume;if(d<=0)return o;const m=u.contents.findIndex(M=>M.chemical.id===n.id);let v;m>=0?v=u.contents.map((M,R)=>R===m?{...M,volume:M.volume+d}:M):v=[...u.contents,{chemical:n,volume:d}];const x=new Map(o.vessels);x.set(t,{...u,currentVolume:h,contents:v});const y=x.get(t),_=WE.checkReaction(y.contents);return _.occurred&&_.reaction&&setTimeout(()=>{e().applyReaction(t,_.reaction)},100),{vessels:x}}),updateVesselTilt:(t,n)=>s(r=>{const o=r.vessels.get(t);if(!o)return r;const u=new Map(r.vessels);return u.set(t,{...o,tiltAngle:n}),{vessels:u}}),updateVesselPosition:(t,n)=>s(r=>{const o=r.vessels.get(t);if(!o)return r;const u=new Map(r.vessels);return u.set(t,{...o,position:n}),{vessels:u}}),clearVessel:t=>s(n=>{const r=n.vessels.get(t);if(!r)return n;const o=new Map(n.vessels);return o.set(t,{...r,currentVolume:0,contents:[],tiltAngle:0}),{vessels:o}}),getVessel:t=>e().vessels.get(t),transferLiquid:(t,n,r)=>s(o=>{const u=o.vessels.get(t),h=o.vessels.get(n);if(!u||!h||u.currentVolume<=0)return o;const d=u.currentVolume,m=h.capacity-h.currentVolume,v=Math.min(r,d,m);if(v<=0)return o;const x=v/u.currentVolume,y=[],_=[];u.contents.forEach(P=>{const z=P.volume*x,U=P.volume-z;U>.01&&y.push({...P,volume:U}),z>.01&&_.push({chemical:P.chemical,volume:z})});let M=[...h.contents];_.forEach(P=>{const z=M.findIndex(U=>U.chemical.id===P.chemical.id);z>=0?M[z]={...M[z],volume:M[z].volume+P.volume}:M.push(P)});const R=new Map(o.vessels);R.set(t,{...u,currentVolume:u.currentVolume-v,contents:y}),R.set(n,{...h,currentVolume:h.currentVolume+v,contents:M});const A=R.get(n),E=WE.checkReaction(A.contents);E.occurred&&E.reaction&&setTimeout(()=>{e().applyReaction(n,E.reaction)},100);let N=o.pendingFiltrationVolume||0,I=o.experimentActions;if(n==="collection_beaker"){v>0&&!I.includes("pour")&&(I=[...I,"pour"]),N+=v;const P=o.vessels.get(n);P&&R.set(n,P)}return{vessels:R,experimentActions:I,pendingFiltrationVolume:N}}),setPouringState:(t,n=null,r=null)=>s({isPouringActive:t,pouringSourceId:n,pouringTargetId:r}),addFiltrate:t=>s(n=>{const r=n.vessels.get("collection_beaker");if(!r||n.pendingFiltrationVolume<=0)return{};const o=Math.min(t,n.pendingFiltrationVolume);if(o<=0)return{};const u={id:"water",name:"Water",color:"#c8e0ff",type:"water"},h=new Map(n.vessels),d=r.contents.find(v=>v.chemical.id==="water");let m=[...r.contents];return d?m=r.contents.map(v=>v.chemical.id==="water"?{...v,volume:v.volume+o}:v):m.push({chemical:u,volume:o}),h.set("collection_beaker",{...r,currentVolume:r.currentVolume+o,contents:m}),{vessels:h,pendingFiltrationVolume:n.pendingFiltrationVolume-o}}),setAutoPouring:t=>s({isAutoPouring:t}),addEffect:t=>s(n=>({activeEffects:[...n.activeEffects,{...t,id:`effect_${++XE}`,startTime:Date.now()}]})),removeEffect:t=>s(n=>({activeEffects:n.activeEffects.filter(r=>r.id!==t)})),clearExpiredEffects:()=>s(t=>{const n=Date.now();return{activeEffects:t.activeEffects.filter(r=>n-r.startTime<r.duration)}}),dismissNotification:()=>s({reactionNotification:null}),showSafetyWarning:(t,n)=>s({safetyWarning:{title:t,message:n}}),dismissSafetyWarning:()=>s({safetyWarning:null}),setDishCracked:t=>s({dishCracked:t}),resetPhysicalChemicalState:()=>{s({iceTested:!1,paperTested:!1,magnesiumTested:!1,showResetPrompt:!1,resetPromptMessage:"",placedApparatus:[],addedChemicals:[],experimentActions:[],currentObservation:"",currentExplanation:"",showExplanation:!1,vessels:new Map,activeEffects:[]})},startNeutralizationAnimation:()=>{s({neutralizationAnimating:!0,neutralizationDropCount:0,showResetPrompt:!1})},incrementNeutralizationDrops:()=>{const{neutralizationDropCount:t}=e(),n=t+1;s({neutralizationDropCount:n}),n>=5&&e().completeNeutralization()},completeNeutralization:()=>{s({neutralizationAnimating:!1,neutralizationComplete:!0,addedChemicals:[...e().addedChemicals.filter(t=>t!=="hcl"),"hcl"]}),e().checkExperimentReaction()},resetNeutralizationState:()=>{s({neutralizationAnimating:!1,neutralizationDropCount:0,neutralizationComplete:!1})},applyReaction:(t,n)=>s(r=>{const o=r.vessels.get(t);if(!o)return r;const u=n.products.map(v=>({chemical:v,volume:o.currentVolume/n.products.length})),h=new Map(r.vessels);h.set(t,{...o,contents:u});const d=n.effects.map(v=>{const x=v==="bubbles"?4e3:3e3,y=`effect_${++XE}`;return Vl.playReactionSound(v,y,x),{id:y,type:v,vesselId:t,startTime:Date.now(),duration:x}}),m={reaction:n,products:n.products,vesselId:t,timestamp:Date.now()};return{vessels:h,activeEffects:[...r.activeEffects,...d],reactionNotification:m}}),toggleBunsenBurner:()=>s(t=>{const n=!t.bunsenBurnerOn;let r=t.experimentActions;return n?(Vl.playFlame("bunsen_burner"),r.includes("heat")||(r=[...r,"heat"])):Vl.stopSound("bunsen_burner"),{bunsenBurnerOn:n,experimentActions:r}}),setHeatingVessel:t=>s({heatingVesselId:t}),updateVesselTemperature:(t,n)=>s(r=>{const o=r.vessels.get(t);if(!o)return r;const u=new Map(r.vessels);return u.set(t,{...o,temperature:n}),{vessels:u}}),setExperimentMode:t=>s({experimentMode:t,showLab:!0}),loadExperiment:t=>s(()=>{const n=b4(t);return n?{experimentMode:"guided",showLab:!0,currentExperiment:n,vessels:new Map,selectedVesselId:"beaker_1",placedApparatus:[],addedChemicals:[],experimentActions:[],currentObservation:` ${n.aim}`,currentExplanation:"",showExplanation:!1,experimentHeatLevel:0,experimentStirCount:0}:{}}),addApparatusToExperiment:t=>s(n=>n.placedApparatus.includes(t)?n:{placedApparatus:[...n.placedApparatus,t],currentObservation:`Added ${t.replace(/-/g," ")} to the lab bench.`}),addChemicalToExperiment:t=>s(n=>{if(n.addedChemicals.includes(t))return n;const r=[...n.addedChemicals,t],u=n.currentExperiment?.chemicals.find(h=>h.id===t)?.name||t.replace(/-/g," ");return{addedChemicals:r,currentObservation:`Added ${u} to the apparatus.`}}),performExperimentAction:t=>s(n=>{if(n.experimentActions.includes(t))return n;const r=[...n.experimentActions,t];let o=n.experimentHeatLevel,u=n.experimentStirCount,h=n.isStirring;return t==="heat"?(o=Math.min(100,n.experimentHeatLevel+30),n.currentExperiment?.id==="evaporation"&&setTimeout(()=>{Ee.getState().performExperimentAction("evaporate"),Ee.getState().checkExperimentReaction()},5e3)):t==="stir"&&(u=n.experimentStirCount+1,h=!0,setTimeout(()=>{Ee.setState({isStirring:!1}),Ee.getState().checkExperimentReaction()},4e3)),{experimentActions:r,experimentHeatLevel:o,experimentStirCount:u,isStirring:h}}),checkExperimentReaction:()=>s(t=>{if(!t.currentExperiment)return t;const n=[...t.addedChemicals],r=[...t.experimentActions],u=(()=>{const v=[];r.length>0&&(v.push([...n,...r].join("+")),v.push([...n].sort().concat([...r].sort()).join("+")));for(const x of r)v.push([...n,x].join("+")),v.push([...n].sort().concat(x).join("+"));return n.length>0&&(v.push(n.join("+")),v.push([...n].sort().join("+"))),v})(),h=Object.keys(t.currentExperiment.reactions);let d=null,m="";for(const v of u)if(t.currentExperiment.reactions[v]){d=t.currentExperiment.reactions[v],m=v;break}if(!d)for(const v of h){const x=v.split("+"),y=x.filter(A=>!["stir","heat","filter","evaporate","pour"].includes(A)),_=x.filter(A=>["stir","heat","filter","evaporate","pour"].includes(A)),M=y.every(A=>n.includes(A)),R=_.every(A=>r.includes(A));if(M&&R){d=t.currentExperiment.reactions[v],m=v;break}}if(d){if(t.currentExperiment.id==="salt-dissolution"&&d.success){let v=t.saltTested,x=t.sandTested,y=!1,_="";if(m.includes("salt")&&m.includes("stir")&&!t.saltTested?(v=!0,y=!0,_=" Salt test complete! Click RESET to test with Sand."):m.includes("sand")&&m.includes("stir")&&!t.sandTested&&(x=!0),v&&x){y=!1;const M=t.currentExperiment.id;if(!t.completedExperiments.includes(M)){const R=[...t.completedExperiments,M];return localStorage.setItem("completedExperiments",JSON.stringify(R)),setTimeout(()=>{Ee.setState({showCompletionPopup:!0})},3e3),{currentObservation:" Experiment Complete! You tested both salt and sand.",currentExplanation:t.currentExperiment.conclusion,showExplanation:!0,saltTested:v,sandTested:x,showResetPrompt:!1,resetPromptMessage:"",completedExperiments:R}}}return{currentObservation:d.observation,currentExplanation:d.explanation,showExplanation:!0,saltTested:v,sandTested:x,showResetPrompt:y,resetPromptMessage:_}}else if(t.currentExperiment.id==="physical-chemical"){let v=!1,x="";const y=new Map(t.vessels);if(m==="ice+heat"){v=!0,x=" Ice melted! Click RESET to test with Paper.";for(const[_,M]of y.entries()){const R=M.contents.find(A=>A.chemical.id==="ice");if(R){const E={id:"water",name:"Water",color:"#a8d4ff",type:"water",...t.currentExperiment.chemicals.find(z=>z.id==="water")},I=R.volume*.4,P=[{chemical:E,volume:I}];y.set(_,{...M,contents:P,currentVolume:I})}}return{vessels:y,currentObservation:d.observation,currentExplanation:d.explanation,showExplanation:!0,showResetPrompt:v,resetPromptMessage:x,iceTested:!0}}else if(m==="paper+heat"){v=!0,x=" Paper burnt! Click RESET to test with Magnesium.";for(const[_,M]of y.entries())if(M.type==="tongs"&&M.contents.some(R=>R.chemical.id==="paper")){const A=[{chemical:{id:"ash",name:"Ash",color:"#333",type:"neutral"},volume:1}];y.set(_,{...M,contents:A})}return{vessels:y,currentObservation:d.observation,currentExplanation:d.explanation,showExplanation:!0,showResetPrompt:v,resetPromptMessage:x,paperTested:!0,bunsenBurnerOn:!1}}else if(m==="magnesium+heat"){for(const[_,M]of y.entries())if(M.type==="tongs"&&M.contents.some(R=>R.chemical.id==="magnesium")){const A=[{chemical:{id:"magnesium-oxide",name:"Magnesium Oxide",color:"#fff",type:"base"},volume:1}];y.set(_,{...M,contents:A})}if(!t.completedExperiments.includes(t.currentExperiment.id)){const _=[...t.completedExperiments,t.currentExperiment.id];return localStorage.setItem("completedExperiments",JSON.stringify(_)),setTimeout(()=>{Ee.setState({showCompletionPopup:!0})},3e3),{vessels:y,currentObservation:d.observation,currentExplanation:d.explanation,showExplanation:!0,completedExperiments:_,magnesiumTested:!0,bunsenBurnerOn:!1}}return{vessels:y,currentObservation:d.observation,currentExplanation:d.explanation,showExplanation:!0,magnesiumTested:!0,bunsenBurnerOn:!1}}return{vessels:y,currentObservation:d.observation,currentExplanation:d.explanation,showExplanation:!0,showResetPrompt:v,resetPromptMessage:x}}else if(d.success&&!t.completedExperiments.includes(t.currentExperiment.id)){const v=t.currentExperiment.id,x=[...t.completedExperiments,v];return localStorage.setItem("completedExperiments",JSON.stringify(x)),setTimeout(()=>{Ee.setState({showCompletionPopup:!0})},3e3),{currentObservation:d.observation||"Experiment Complete!",currentExplanation:d.explanation||t.currentExperiment.conclusion,showExplanation:!0,completedExperiments:x}}return{currentObservation:d.observation,currentExplanation:d.explanation,showExplanation:d.success||!!d.explanation&&d.explanation.length>0}}return t}),resetExperiment:()=>s(t=>{if(!t.currentExperiment)return t;let n=t.resetAfterSaltTest,r=` ${t.currentExperiment.aim}`,o=[];t.currentExperiment.id==="salt-dissolution"&&(t.saltTested&&!t.sandTested?(n=!0,o=["Add water to the beaker","Add salt to the water","Stir the mixture","Observe: Salt disappears"],r=" Now test with SAND. Add water, then add sand, and stir."):t.saltTested&&t.sandTested&&(n=!1));let u=t.iceTested,h=t.paperTested,d=t.magnesiumTested;return t.currentExperiment.id==="physical-chemical"&&(t.iceTested&&!t.paperTested?r=" Round 2: Now test with PAPER. Place burner and tongs, then add paper strip and heat.":t.iceTested&&t.paperTested&&!t.magnesiumTested?r=" Round 3: Now test with MAGNESIUM. Place burner and tongs, then add magnesium ribbon and heat.":t.iceTested&&t.paperTested&&t.magnesiumTested&&(u=!1,h=!1,d=!1,r=` ${t.currentExperiment.aim}`)),{...t,currentExperiment:{...t.currentExperiment,procedureSteps:o.length>0?o:t.currentExperiment.procedureSteps},vessels:new Map,placedApparatus:[],addedChemicals:[],experimentActions:[],experimentRunning:!1,timer:0,currentObservation:r,currentExplanation:"",showExplanation:!1,experimentHeatLevel:0,experimentStirCount:0,isStirring:!1,resetAfterSaltTest:n,saltTested:t.saltTested&&t.sandTested?!1:t.saltTested,sandTested:t.saltTested&&t.sandTested?!1:t.sandTested,iceTested:u,paperTested:h,magnesiumTested:d,showResetPrompt:!1,resetPromptMessage:"",showCompletionPopup:!1,dishCracked:!1,safetyWarning:null,bunsenBurnerOn:!1}}),markExperimentComplete:t=>s(n=>{if(n.completedExperiments.includes(t))return n;const r=[...n.completedExperiments,t];return localStorage.setItem("completedExperiments",JSON.stringify(r)),{completedExperiments:r}}),goToHomeScreen:()=>s({experimentMode:"sandbox",showLab:!1,currentExperiment:null,placedApparatus:[],addedChemicals:[],experimentActions:[],currentObservation:"Welcome to the Virtual Chemistry Lab! Select an experiment to begin.",currentExplanation:"",showExplanation:!1,experimentHeatLevel:0,experimentStirCount:0})}));function T4({startPos:s,delay:e}){const t=te.useRef(null),[n,r]=te.useState(!1),o=te.useRef(0),u=te.useRef([...s]);return te.useEffect(()=>{const h=setTimeout(()=>r(!0),e*1e3);return()=>clearTimeout(h)},[e]),xi((h,d)=>{if(!n||!t.current)return;o.current+=d*2,u.current[1]-=o.current*d,t.current.position.y=u.current[1];const m=t.current.material;m.opacity>0&&(m.opacity-=d*.5)}),n?w.jsxs("mesh",{ref:t,position:s,children:[w.jsx("sphereGeometry",{args:[.03,8,8]}),w.jsx("meshStandardMaterial",{color:"#a8e4ff",transparent:!0,opacity:.8,roughness:.1,metalness:.2})]}):null}function w4({initialPos:s,initialRot:e,melting:t,meltProgress:n,baseScale:r}){const o=te.useRef(null),u=te.useMemo(()=>1+s[1]*.5+Math.random()*.3,[s]),h=te.useMemo(()=>Math.random()*Math.PI*2,[]),d=Math.min(1,n*u),m=Math.max(0,1-d*.95),v=Jx.lerp(.85,.2,d),x=d*s[1]*.8,y=te.useMemo(()=>{const _=new Lt("#e0f6ff"),M=new Lt("#a8e4ff");return _.lerp(M,d)},[d]);return xi(_=>{if(!o.current||!t)return;const M=Math.sin(_.clock.elapsedTime*3+h)*.02*(1-d);o.current.rotation.z=e[2]+M,o.current.rotation.x=e[0]+M*.5}),m<=.05?null:w.jsxs("mesh",{ref:o,position:[s[0],s[1]-x,s[2]],rotation:e,scale:m*r,children:[w.jsx("boxGeometry",{args:[.37,.37,.37]}),w.jsx("meshStandardMaterial",{color:y,transparent:!0,opacity:v,roughness:.05,metalness:.15,envMapIntensity:1.5}),w.jsxs("mesh",{scale:.85,children:[w.jsx("boxGeometry",{args:[.37,.37,.37]}),w.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:v*.3})]})]})}function A4({scale:s=1,melting:e=!1,onMeltComplete:t}){const n=te.useRef(null),[r,o]=te.useState(0),u=te.useRef(!1),h=te.useMemo(()=>[{pos:[.25,.16,.15],rot:[.1,.2,0]},{pos:[-.25,.16,-.15],rot:[0,.5,.1]},{pos:[.25,.16,-.25],rot:[.2,0,.2]},{pos:[-.22,.16,.25],rot:[0,.3,0]},{pos:[0,.16,0],rot:[.1,.1,.1]},{pos:[.35,.16,0],rot:[.05,.4,0]},{pos:[-.35,.16,.1],rot:[.1,.1,.2]},{pos:[0,.16,.35],rot:[.2,.2,0]},{pos:[.1,.16,-.35],rot:[0,.3,.1]},{pos:[.15,.45,.15],rot:[.5,.2,.1]},{pos:[-.15,.45,-.1],rot:[.2,.5,.3]},{pos:[.1,.45,-.2],rot:[.1,.1,.4]},{pos:[-.1,.45,.2],rot:[.3,.2,.1]},{pos:[.2,.45,-.1],rot:[.4,.1,.2]},{pos:[0,.65,0],rot:[.6,.4,.2]}],[]),d=te.useMemo(()=>e?h.flatMap((m,v)=>Array.from({length:3},(x,y)=>({pos:[m.pos[0]*s+(Math.random()-.5)*.1,m.pos[1]*s,m.pos[2]*s+(Math.random()-.5)*.1],delay:v*.3+y*.5+Math.random()*.5}))):[],[e,h,s]);return xi((m,v)=>{e&&r<1&&o(x=>Math.min(1,x+v*.125)),e&&r>=.95&&!u.current&&(u.current=!0,t?.())}),te.useEffect(()=>{e||(o(0),u.current=!1)},[e]),w.jsxs("group",{ref:n,scale:s,children:[h.map((m,v)=>w.jsx(w4,{initialPos:m.pos,initialRot:m.rot,melting:e,meltProgress:r,baseScale:1},v)),e&&r>.1&&r<.9&&d.map((m,v)=>w.jsx(T4,{startPos:m.pos,delay:m.delay},v)),e&&r>.2&&w.jsxs("mesh",{position:[0,.02,0],rotation:[-Math.PI/2,0,0],children:[w.jsx("circleGeometry",{args:[.5*Math.min(1,r*1.5),32]}),w.jsx("meshStandardMaterial",{color:"#a8e4ff",transparent:!0,opacity:Math.min(.6,r*.8),roughness:.1,metalness:.1})]})]})}function C4({burning:s=!1,onBurnComplete:e}){const t=te.useRef(null),[n,r]=te.useState(0),o=te.useRef(!1),u=te.useRef(0);xi((m,v)=>{if(u.current+=v,s&&n<1&&r(x=>Math.min(1,x+v*.25)),s&&n>=.9&&!o.current&&(o.current=!0,e?.()),t.current){const x=Math.max(.05,1-n*.9);t.current.scale.set(1-n*.4,x,1),s&&n<.9&&(t.current.rotation.x=Math.sin(u.current*3)*.15*n,t.current.rotation.z=Math.sin(u.current*5)*.1*(1-n),t.current.position.y=-.15+n*.1)}}),te.useEffect(()=>{s||(r(0),o.current=!1,u.current=0)},[s]);const h=te.useMemo(()=>n<.2?new Lt("#f5f5dc").lerp(new Lt("#d4a574"),n/.2):n<.5?new Lt("#d4a574").lerp(new Lt("#5c3d2e"),(n-.2)/.3):n<.8?new Lt("#5c3d2e").lerp(new Lt("#2a2a2a"),(n-.5)/.3):new Lt("#111111"),[n]),d=s?Math.sin(u.current*8)*.3+.7:0;return n>=.95?null:w.jsxs("group",{children:[w.jsxs("mesh",{ref:t,position:[0,-.15,0],children:[w.jsx("boxGeometry",{args:[.45,.35,.015]}),w.jsx("meshStandardMaterial",{color:h,roughness:.9,emissive:s&&n>.1?"#ff4400":"#000000",emissiveIntensity:s?n*.3:0})]}),s&&n>.05&&n<.85&&w.jsxs("mesh",{position:[0,-.15-.35*(1-n)*.5,0],children:[w.jsx("boxGeometry",{args:[.48*(1-n*.4),.04,.02]}),w.jsx("meshBasicMaterial",{color:"#ff6600",transparent:!0,opacity:d*.8})]}),s&&n>.08&&n<.88&&w.jsxs("group",{position:[0,-.15,0],children:[w.jsxs("mesh",{position:[0,.05,0],children:[w.jsx("sphereGeometry",{args:[.06*(1-n*.5),12,12]}),w.jsx("meshBasicMaterial",{color:"#ffffcc",transparent:!0,opacity:.9*(1-n)})]}),w.jsxs("mesh",{position:[Math.sin(u.current*12)*.02,.08,0],children:[w.jsx("sphereGeometry",{args:[.1*(1-n*.4),10,10]}),w.jsx("meshBasicMaterial",{color:"#ffcc00",transparent:!0,opacity:.75*(1-n)})]}),w.jsxs("mesh",{position:[Math.sin(u.current*8)*.03,.12+Math.sin(u.current*10)*.02,0],children:[w.jsx("sphereGeometry",{args:[.14*(1-n*.3),10,10]}),w.jsx("meshBasicMaterial",{color:"#ff6600",transparent:!0,opacity:.6*(1-n)})]}),w.jsxs("mesh",{position:[0,.15,0],children:[w.jsx("sphereGeometry",{args:[.18*(1-n*.3),8,8]}),w.jsx("meshBasicMaterial",{color:"#ff3300",transparent:!0,opacity:.35*(1-n)})]}),w.jsx("pointLight",{color:"#ff6600",intensity:3*d*(1-n),distance:2.5,decay:2}),w.jsx("pointLight",{color:"#ffcc00",intensity:1.5*d*(1-n),distance:1.5,position:[0,.1,0]})]}),s&&n>.15&&n<.9&&w.jsx("group",{position:[0,.1,0],children:[0,.3,.6,.9].map((m,v)=>{const x=(u.current+m)%1.5,y=x*.4,_=Math.max(0,.4-x*.3)*(1-n),M=Math.sin(u.current*2+m*5)*.05;return w.jsxs("mesh",{position:[M,y,0],children:[w.jsx("sphereGeometry",{args:[.04+x*.03,8,8]}),w.jsx("meshBasicMaterial",{color:"#444444",transparent:!0,opacity:_})]},v)})}),s&&n>.1&&n<.85&&w.jsx("group",{position:[0,-.1,0],children:[0,1.2,2.4,3.6,4.8].map((m,v)=>{const x=(u.current*1.5+m)%2,y=x*.3,_=Math.sin(m*3)*.15+Math.sin(u.current*4+m)*.05,M=Math.cos(m*2)*.08,R=Math.max(0,1-x*.6)*(1-n)*.8;return w.jsxs("mesh",{position:[_,y,M],children:[w.jsx("sphereGeometry",{args:[.012,6,6]}),w.jsx("meshBasicMaterial",{color:v%2===0?"#ff8800":"#ffaa00",transparent:!0,opacity:R})]},v)})}),s&&n>.4&&n<.95&&w.jsx("group",{position:[0,-.2,0],children:[0,.5,1].map((m,v)=>{const x=(u.current*.8+m)%1.2,y=-x*.15,_=Math.sin(m*4+u.current)*.08,M=Math.max(0,.5-x*.4)*n;return w.jsxs("mesh",{position:[_,y,0],rotation:[0,0,u.current+m],children:[w.jsx("boxGeometry",{args:[.025,.015,.002]}),w.jsx("meshBasicMaterial",{color:"#222222",transparent:!0,opacity:M})]},v)})})]})}function R4({burning:s=!1,onBurnComplete:e}){const t=te.useRef(null),[n,r]=te.useState(0),o=te.useRef(!1),u=te.useRef(0);xi((v,x)=>{if(u.current+=x,s&&n<1&&r(y=>Math.min(1,y+x*.2)),s&&n>=.9&&!o.current&&(o.current=!0,e?.()),t.current&&s){const y=Math.max(.05,1-n*.95);t.current.scale.set(1,y,1);const _=.15-.3*y;t.current.position.y=_,t.current.position.x=Math.sin(u.current*15)*.005,t.current.position.z=Math.cos(u.current*12)*.003}}),te.useEffect(()=>{s||(r(0),o.current=!1,u.current=0,t.current&&(t.current.scale.set(1,1,1),t.current.position.y=-.15))},[s]);const h=te.useMemo(()=>n<.15?n/.15:n<.75?1:Math.max(0,(1-n)/.25),[n]),d=s?Math.sin(u.current*20)*.15+.85:0,m=-.45+.6*n;return n>=.95?null:w.jsxs("group",{children:[w.jsxs("group",{position:[0,0,0],rotation:[-.2,0,0],children:[w.jsxs("mesh",{ref:t,position:[0,-.15,0],children:[w.jsx("boxGeometry",{args:[.08,.6,.015]}),w.jsx("meshStandardMaterial",{color:s?"#ffffff":"#b8b8b8",metalness:.95,roughness:.15,emissive:s?"#ffffff":"#000000",emissiveIntensity:s?h*4:0})]}),s&&n>.05&&n<.9&&w.jsxs("mesh",{position:[0,m+.02,0],children:[w.jsx("sphereGeometry",{args:[.04,10,10]}),w.jsx("meshBasicMaterial",{color:"#ffffff"})]})]}),s&&n>.05&&n<.88&&w.jsxs("group",{position:[0,m+.05,0],children:[w.jsxs("mesh",{position:[0,0,0],children:[w.jsx("sphereGeometry",{args:[.08*h*d,16,16]}),w.jsx("meshBasicMaterial",{color:"#e0e8ff",transparent:!0,opacity:.95*h})]}),w.jsxs("mesh",{position:[Math.sin(u.current*18)*.01,.02,0],children:[w.jsx("sphereGeometry",{args:[.12*h,16,16]}),w.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:.9*h*d})]}),w.jsxs("mesh",{position:[0,.03,0],children:[w.jsx("sphereGeometry",{args:[.2*h,16,16]}),w.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:.7*h})]}),w.jsxs("mesh",{position:[0,.05,0],children:[w.jsx("sphereGeometry",{args:[.3*h,12,12]}),w.jsx("meshBasicMaterial",{color:"#fffaf0",transparent:!0,opacity:.5*h})]}),w.jsxs("mesh",{position:[0,0,0],children:[w.jsx("sphereGeometry",{args:[.5*h,12,12]}),w.jsx("meshBasicMaterial",{color:"#ffffee",transparent:!0,opacity:.25*h})]}),w.jsx("pointLight",{color:"#ffffff",intensity:15*h*d,distance:6,decay:2}),w.jsx("pointLight",{color:"#e8f0ff",intensity:8*h,distance:4,position:[0,.1,0]}),w.jsx("pointLight",{color:"#ccddff",intensity:3*h,distance:3,position:[0,-.1,0]})]}),s&&n>.08&&n<.85&&w.jsx("group",{position:[0,-.2,0],children:[0,.8,1.6,2.4,3.2,4,4.8,5.6].map((v,x)=>{const y=(u.current*2+v)%1.5,_=y*.5,M=Math.sin(v*2.5)*.2+Math.sin(u.current*6+v)*.08,R=Math.cos(v*1.8)*.15,A=Math.max(0,1-y*.8)*h,E=.015+Math.random()*.005;return w.jsxs("mesh",{position:[M,_,R],children:[w.jsx("sphereGeometry",{args:[E,6,6]}),w.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:A})]},x)})}),s&&n>.15&&n<.9&&w.jsx("group",{position:[0,.1,0],children:[0,.4,.8,1.2].map((v,x)=>{const y=(u.current*.8+v)%2,_=y*.5,M=Math.sin(u.current*1.5+v*3)*.1,R=Math.max(0,.5-y*.25)*h*.6;return w.jsxs("mesh",{position:[M,_,0],children:[w.jsx("sphereGeometry",{args:[.05+y*.04,8,8]}),w.jsx("meshBasicMaterial",{color:"#f8f8f8",transparent:!0,opacity:R})]},x)})}),s&&n>.3&&n<.95&&w.jsx("group",{position:[0,-.3,0],children:[0,.6,1.2].map((v,x)=>{const y=(u.current*.6+v)%1.5,_=-y*.2,M=Math.sin(v*3+u.current*.8)*.1,R=Math.max(0,.7-y*.5)*n;return w.jsxs("mesh",{position:[M,_,0],rotation:[u.current+v,0,u.current*.5],children:[w.jsx("boxGeometry",{args:[.02,.01,.015]}),w.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:R})]},x)})})]})}function N4(){return w.jsxs("group",{children:[w.jsxs("mesh",{position:[0,-.1,0],children:[w.jsx("boxGeometry",{args:[.15,.08,.01]}),w.jsx("meshStandardMaterial",{color:"#1a1a1a",roughness:1})]}),w.jsxs("mesh",{position:[.05,-.12,0],children:[w.jsx("boxGeometry",{args:[.06,.04,.01]}),w.jsx("meshStandardMaterial",{color:"#333",roughness:1})]}),w.jsxs("mesh",{position:[-.04,-.13,0],children:[w.jsx("boxGeometry",{args:[.05,.03,.01]}),w.jsx("meshStandardMaterial",{color:"#2a2a2a",roughness:1})]})]})}function D4({vesselId:s}){const e=te.useRef(null),t=te.useRef(null),n=te.useRef(null),[r,o]=te.useState(!1),[u,h]=te.useState(!1),[d,m]=te.useState(0),{camera:v,gl:x}=Sr(),y=Ee(ke=>ke.vessels.get(s)),_=Ee(ke=>ke.vessels.get(s)?.contents??[]),M=Ee(ke=>ke.selectedVesselId),R=Ee(ke=>ke.selectVessel),A=Ee(ke=>ke.updateVesselTilt),E=Ee(ke=>ke.updateVesselPosition),N=Ee(ke=>ke.isStirring),I=Ee(ke=>ke.experimentActions),P=Ee(ke=>ke.currentExperiment),z=Ee(ke=>ke.bunsenBurnerOn),U=Ee(ke=>ke.checkExperimentReaction),H=Ee(ke=>ke.neutralizationDropCount),V=I.includes("stir")&&!N,[L,B]=te.useState(0),[W,ie]=te.useState(0),[J,se]=te.useState(!1),[ce,Y]=te.useState(0),[ne,ve]=te.useState(!1),[ae,re]=te.useState([]),[j,le]=te.useState([]),Me=te.useRef(0);te.useEffect(()=>{if(P?.id==="neutralization"&&H>Me.current){const ke=_.some(Fe=>Fe.chemical.id==="naoh"),Ce=_.some(Fe=>Fe.chemical.id==="phenolphthalein");if(ke&&Ce){const Fe=Date.now();re(Ze=>[...Ze.slice(-10),{id:Fe,time:Fe}]),le(Ze=>[...Ze.slice(-5),{id:Fe,time:Fe,x:(Math.random()-.5)*.1,z:(Math.random()-.5)*.1}]),X_(async()=>{const{SoundManager:Ze}=await Promise.resolve().then(()=>E4);return{SoundManager:Ze}},void 0).then(({SoundManager:Ze})=>{Ze.playDropSound()})}Me.current=H}},[H,P?.id,_]),xi(()=>{const ke=Date.now();re(Ce=>Ce.filter(Fe=>ke-Fe.id<600)),le(Ce=>Ce.filter(Fe=>ke-Fe.time<800))});const Ue=M===s;xi((ke,Ce)=>{N&&n.current?(n.current.rotation.y-=Ce*5,B(ee=>Math.min(ee+Ce/4,1)),se(!0),ie(0)):J&&!N&&W<1&&ie(ee=>Math.min(ee+Ce/2,1));const Fe=y?.temperature||25,Ze=_.some(ee=>ee.chemical.id==="ice");if(Fe>50&&Ze&&ce<1){const ee=Math.min(ce+Ce*.125,1);Y(ee),ee>=.95&&!ne&&(ve(!0),z&&Ee.getState().toggleBunsenBurner(),P?.id==="physical-chemical"&&setTimeout(()=>U(),500))}ae.length>0&&re(ee=>ee.map(Se=>({...Se,time:Se.time+Ce})).filter(Se=>Se.time<1.5))});const lt=2,pe=.8,Re=y?.position||[0,0,0],it=y?.capacity||500,xt=y?.temperature||25,dt=te.useMemo(()=>_.reduce((ke,Ce)=>Ce.chemical.id==="ice"?ke+Ce.volume:ke,0),[_]),Ut=te.useMemo(()=>{const ke=_.reduce((Ze,ee)=>ee.chemical.id==="ice"?Ze:Ze+ee.volume,0),Fe=dt*.4*ce;return ke+Fe},[_,dt,ce]),xe=te.useMemo(()=>Ut===0?0:Ut/it*(lt-.2),[Ut,it,lt]),rt=te.useMemo(()=>{if(dt>0&&ce>0)return"#a8e4ff";if(_.length===0)return"#4fc3f7";if(P?.id==="neutralization"){if(Ee.getState().neutralizationComplete)return"#f5f5f5";const ee=_.some($e=>$e.chemical.id==="naoh"),Se=_.some($e=>$e.chemical.id==="phenolphthalein");if(ee&&Se){const $e=new Lt("#ff69b4"),ue=new Lt("#f5f5f5");let we=0;return H>=5?we=1:we=H*.08,"#"+$e.clone().lerp(ue,we).getHexString()}}const ke=_.reduce((Ze,ee)=>ee.volume>Ze.volume?ee:Ze),Ce=_.some(Ze=>(Ze.chemical.name?.toLowerCase().includes("salt")||Ze.chemical.id==="salt")&&!Ze.chemical.name?.toLowerCase().includes("solution"));return I.includes("stir")&&!N&&Ce?"#e0f0ff":ke.chemical.color},[_,I,N,dt,ce,P,H]),Le=te.useMemo(()=>_.some(ke=>{const Ce=ke.chemical.name?.toLowerCase()||"",Fe=ke.chemical.id?.toLowerCase()||"";return(Ce.includes("salt")||Fe==="salt")&&!Ce.includes("solution")}),[_]),Xe=te.useMemo(()=>_.some(ke=>{const Ce=ke.chemical.name?.toLowerCase()||"",Fe=ke.chemical.id?.toLowerCase()||"";return Ce.includes("sand")||Fe==="sand"}),[_]),qe=te.useMemo(()=>_.some(ke=>ke.chemical.id==="ice"),[_]),ot=Le||Xe,$=te.useMemo(()=>Xe?"#c4a465":"#ffffff",[Le,Xe]),Pt=te.useMemo(()=>{if(!ot||xe===0)return[];const ke=[],Ce=Fe=>{const Ze=Math.sin(Fe*9999)*1e4;return Ze-Math.floor(Ze)};if(Le&&!Xe){if(V)return[];const Fe=100;for(let Ze=0;Ze<Fe;Ze++){const ee=Ze/Fe*Math.PI*2+Ce(Ze*7)*.5,Se=.15+Ce(Ze*13)*.35,$e=N?.15+Ce(Ze*17)*(xe*.6):.05+Ce(Ze*17)*.1;ke.push([Math.cos(ee)*Se,$e,Math.sin(ee)*Se])}}else if(Xe)for(let Ze=0;Ze<200;Ze++){const ee=Ze/200*Math.PI*2+Ce(Ze*7)*.5,Se=.15+Ce(Ze*13)*.4,$e=.2+Ce(Ze*17)*(xe*.5),ue=.05+Ce(Ze*17)*.1;let we;N?we=$e:we=$e+(ue-$e)*W,ke.push([Math.cos(ee)*Se,we,Math.sin(ee)*Se])}return ke},[ot,Le,Xe,xe,N,V,L,W]),St=te.useMemo(()=>Le&&!Xe&&N?.06*(1-L):Le?.06:.03,[Le,Xe,N,L]),Ft=y?.tiltAngle||0,ht=Ft*Math.PI/180,K=te.useCallback(ke=>{ke.stopPropagation(),R(s)},[s,R]),F=te.useCallback(ke=>{if(ke.stopPropagation(),!Ue){R(s);return}if(P?.id==="salt-dissolution"||P?.id==="filtration"||P?.id==="physical-chemical")return;const Ce=ke.shiftKey||ke.nativeEvent?.shiftKey;h(Ce),o(!0),m(ke.clientY||ke.nativeEvent?.clientY||0),ke.target?.setPointerCapture&&ke.pointerId!==void 0&&ke.target.setPointerCapture(ke.pointerId)},[Ue,s,R,P]),ge=te.useMemo(()=>new Sd,[]),ze=te.useMemo(()=>new sa(new Q(0,1,0),0),[]),Ye=te.useCallback(ke=>{if(!(!r||!Ue))if(ke.stopPropagation(),u){const Ce=x.domElement.getBoundingClientRect(),Fe=(ke.clientX-Ce.left)/Ce.width*2-1,Ze=-((ke.clientY-Ce.top)/Ce.height)*2+1;ge.setFromCamera(new Je(Fe,Ze),v);const ee=new Q;if(ge.ray.intersectPlane(ze,ee),ee){const Se=Math.max(-4,Math.min(4,ee.x)),$e=Math.max(-4,Math.min(4,ee.z)),ue=0,we=2;Math.sqrt(Math.pow(Se-ue,2)+Math.pow($e-we,2))<.8?E(s,[ue,1,we]):E(s,[Se,0,$e])}}else{const Ce=ke.clientY||ke.nativeEvent?.clientY||0,Fe=d-Ce,ee=Math.max(0,Math.min(70,Ft+Fe*.5));A(s,ee),m(Ce)}},[r,Ue,u,s,Ft,A,E,d,v,x,ge,ze]),Be=te.useCallback(ke=>{r&&(ke.stopPropagation(),o(!1),h(!1),ke.target?.releasePointerCapture&&ke.pointerId!==void 0&&ke.target.releasePointerCapture(ke.pointerId))},[r]);if(!y)return null;const Dt=xt>50,yt=xt>=100,kt=Ee(ke=>ke.isAutoPouring);return xi((ke,Ce)=>{if(!t.current)return;const Fe=_.some(Ze=>Ze.chemical.id==="muddy-water");if(kt&&Fe){const Ze=new Q(1,2.6,0),ee=-Math.PI/2.2;t.current.position.lerp(Ze,Ce*4),t.current.rotation.z+=(ee-t.current.rotation.z)*Ce*4}else if(!r&&!u){Math.abs(t.current.rotation.z)>.01&&(t.current.rotation.z+=(0-t.current.rotation.z)*Ce*4);const Ze=new Q(Re[0],Re[1],Re[2]);t.current.position.distanceTo(Ze)>.1&&t.current.position.lerp(Ze,Ce*4)}}),w.jsx("group",{ref:t,name:s,position:Re,children:w.jsxs("group",{rotation:[0,0,-ht],children:[Ue&&w.jsxs("mesh",{position:[0,.01,0],rotation:[-Math.PI/2,0,0],children:[w.jsx("ringGeometry",{args:[pe+.1,pe+.25,32]}),w.jsx("meshBasicMaterial",{color:u?"#ffaa00":"#00ff88",transparent:!0,opacity:.9})]}),Dt&&w.jsxs("mesh",{position:[0,.02,0],rotation:[-Math.PI/2,0,0],children:[w.jsx("circleGeometry",{args:[pe*1.2,32]}),w.jsx("meshBasicMaterial",{color:yt?"#ff4400":"#ff8800",transparent:!0,opacity:.3})]}),w.jsxs("mesh",{ref:e,position:[0,lt/2,0],onClick:K,onPointerDown:F,onPointerMove:Ye,onPointerUp:Be,onPointerLeave:Be,children:[w.jsx("cylinderGeometry",{args:[pe,pe*.9,lt,32,1,!0]}),w.jsx("meshBasicMaterial",{color:Ue?"#aaffcc":Dt?"#ffccaa":"#c8e6f8",transparent:!0,opacity:Ue?.3:.2,side:Ii,depthWrite:!1})]}),w.jsxs("mesh",{position:[0,.02,0],rotation:[-Math.PI/2,0,0],children:[w.jsx("circleGeometry",{args:[pe*.9,32]}),w.jsx("meshBasicMaterial",{color:"#c8e6f8",transparent:!0,opacity:.25,depthWrite:!1})]}),w.jsxs("mesh",{position:[0,lt,0],rotation:[-Math.PI/2,0,0],children:[w.jsx("ringGeometry",{args:[pe-.05,pe+.02,32]}),w.jsx("meshBasicMaterial",{color:"#e0e0e0"})]}),Ft>30&&w.jsxs("mesh",{position:[-pe*.8,lt+.1,0],children:[w.jsx("sphereGeometry",{args:[.1,12,12]}),w.jsx("meshBasicMaterial",{color:Ft>45?"#ff4444":"#ffaa00"})]}),[.25,.5,.75].map((ke,Ce)=>w.jsxs("mesh",{position:[pe-.02,ke*lt+.1,0],children:[w.jsx("boxGeometry",{args:[.15,.02,.01]}),w.jsx("meshBasicMaterial",{color:"#888888"})]},Ce)),qe&&ce<.95&&w.jsx("group",{position:[0,.05,0],children:w.jsx(A4,{scale:.8,melting:Dt})}),xe>0&&w.jsxs("group",{ref:n,children:[w.jsxs("mesh",{position:[0,xe/2+.05,0],renderOrder:1,children:[w.jsx("cylinderGeometry",{args:[pe*.82,pe*.8,xe,32]}),w.jsx("meshBasicMaterial",{color:rt,transparent:!0,opacity:.85})]}),w.jsxs("mesh",{position:[0,xe+.05,0],rotation:[-Math.PI/2,0,0],renderOrder:2,children:[w.jsx("circleGeometry",{args:[pe*.82,32]}),w.jsx("meshBasicMaterial",{color:rt,transparent:!0,opacity:.95})]}),ae.map(ke=>{const Ce=(Date.now()-ke.id)/1e3;return w.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,xe+.052,0],renderOrder:3,children:[w.jsx("ringGeometry",{args:[.05+Ce*1.6,.15+Ce*1.6,32]}),w.jsx("meshBasicMaterial",{color:"white",transparent:!0,opacity:Math.max(0,.4-Ce*.3),side:Ii})]},ke.id)}),j.map(ke=>{const Ce=(Date.now()-ke.id)/1e3;return[0,1,2,3,4].map(Fe=>{const Ze=Fe/5*Math.PI*2,ee=Ce*.8,Se=Math.sin(Ce*Math.PI)*.4;return w.jsxs("mesh",{position:[ke.x+Math.cos(Ze)*ee,xe+Se+.06,ke.z+Math.sin(Ze)*ee],children:[w.jsx("sphereGeometry",{args:[.02*(1-Ce),8,8]}),w.jsx("meshBasicMaterial",{color:"white",transparent:!0,opacity:1-Ce})]},`${ke.id}_${Fe}`)})}),Pt.map((ke,Ce)=>w.jsxs("mesh",{position:ke,renderOrder:10,children:[w.jsx("boxGeometry",{args:[St,St,St]}),w.jsx("meshBasicMaterial",{color:$,transparent:!0,opacity:1,depthTest:!1,depthWrite:!1})]},Ce))]})]})})}function I4({vesselId:s,rackSlot:e=0}){const t=te.useRef(null),n=te.useRef(null),[r,o]=te.useState(!1),[u,h]=te.useState(!1),[d,m]=te.useState(0),{camera:v,gl:x}=Sr(),y=Ee(re=>re.vessels.get(s)),_=Ee(re=>re.vessels.get(s)?.currentVolume??0),M=Ee(re=>re.vessels.get(s)?.contents??[]),R=Ee(re=>re.selectedVesselId),A=Ee(re=>re.selectVessel),E=Ee(re=>re.updateVesselTilt),N=Ee(re=>re.updateVesselPosition),I=R===s,P=1.8,z=.2,U=y?.position||[0,0,0],H=y?.capacity||50,V=y?.temperature||25,L=te.useMemo(()=>_===0?0:_/H*(P-.3),[_,H,P]),B=te.useMemo(()=>M.length===0?"#4fc3f7":M.reduce((j,le)=>le.volume>j.volume?le:j).chemical.color,[M]),W=y?.tiltAngle||0,ie=W*Math.PI/180,J=te.useCallback(re=>{re.stopPropagation(),A(s)},[s,A]),se=te.useCallback(re=>{if(re.stopPropagation(),!I){A(s);return}const j=re.shiftKey||re.nativeEvent?.shiftKey;h(j),o(!0),m(re.clientY||re.nativeEvent?.clientY||0),re.target?.setPointerCapture&&re.pointerId!==void 0&&re.target.setPointerCapture(re.pointerId)},[I,s,A]),ce=te.useMemo(()=>new Sd,[]),Y=te.useMemo(()=>new sa(new Q(0,1,0),0),[]),ne=te.useCallback(re=>{if(!(!r||!I))if(re.stopPropagation(),u){const j=x.domElement.getBoundingClientRect(),le=(re.clientX-j.left)/j.width*2-1,Me=-((re.clientY-j.top)/j.height)*2+1;ce.setFromCamera(new Je(le,Me),v);const Ue=new Q;if(ce.ray.intersectPlane(Y,Ue),Ue){const lt=Math.max(-4,Math.min(4,Ue.x)),pe=Math.max(-4,Math.min(4,Ue.z)),Re=0,it=2;Math.sqrt(Math.pow(lt-Re,2)+Math.pow(pe-it,2))<.8?N(s,[Re,1,it]):N(s,[lt,0,pe])}}else{const j=re.clientY||re.nativeEvent?.clientY||0,le=d-j,Ue=Math.max(0,Math.min(70,W+le*.5));E(s,Ue),m(j)}},[r,I,u,s,W,E,N,d,v,x,ce,Y]),ve=te.useCallback(re=>{r&&(re.stopPropagation(),o(!1),h(!1),re.target?.releasePointerCapture&&re.pointerId!==void 0&&re.target.releasePointerCapture(re.pointerId))},[r]);if(!y)return null;const ae=V>50;return w.jsx("group",{ref:n,position:U,children:w.jsxs("group",{rotation:[0,0,-ie],children:[I&&w.jsxs("mesh",{position:[0,.01,0],rotation:[-Math.PI/2,0,0],children:[w.jsx("ringGeometry",{args:[z+.05,z+.12,16]}),w.jsx("meshBasicMaterial",{color:u?"#ffaa00":"#00ff88",transparent:!0,opacity:.9})]}),w.jsxs("mesh",{ref:t,position:[0,P/2,0],onClick:J,onPointerDown:se,onPointerMove:ne,onPointerUp:ve,onPointerLeave:ve,children:[w.jsx("cylinderGeometry",{args:[z,z,P,16,1,!0]}),w.jsx("meshBasicMaterial",{color:I?"#aaffcc":ae?"#ffccaa":"#c8e6f8",transparent:!0,opacity:I?.35:.25,side:Ii,depthWrite:!1})]}),w.jsxs("mesh",{position:[0,.05,0],children:[w.jsx("sphereGeometry",{args:[z,16,8,0,Math.PI*2,0,Math.PI/2]}),w.jsx("meshBasicMaterial",{color:"#c8e6f8",transparent:!0,opacity:.25,side:Ii,depthWrite:!1})]}),w.jsxs("mesh",{position:[0,P,0],rotation:[-Math.PI/2,0,0],children:[w.jsx("ringGeometry",{args:[z-.02,z+.03,16]}),w.jsx("meshBasicMaterial",{color:"#ffffff"})]}),L>0&&w.jsxs("mesh",{position:[0,L/2+.1,0],renderOrder:1,children:[w.jsx("cylinderGeometry",{args:[z*.85,z*.85,L,16]}),w.jsx("meshBasicMaterial",{color:B,transparent:!0,opacity:.85})]}),L>0&&w.jsxs("mesh",{position:[0,L+.1,0],rotation:[-Math.PI/2,0,0],renderOrder:2,children:[w.jsx("circleGeometry",{args:[z*.85,16]}),w.jsx("meshBasicMaterial",{color:B,transparent:!0,opacity:.95})]})]})})}function L4({position:s}){return w.jsxs("group",{position:s,children:[w.jsxs("mesh",{position:[0,.3/2,0],children:[w.jsx("boxGeometry",{args:[1.2,.3,.4]}),w.jsx("meshStandardMaterial",{color:"#8B4513",roughness:.8})]}),w.jsxs("mesh",{position:[0,.3+.05,0],children:[w.jsx("boxGeometry",{args:[1.2,.1,.4]}),w.jsx("meshStandardMaterial",{color:"#A0522D",roughness:.7})]}),[-1.5,-.5,.5,1.5].map((o,u)=>w.jsxs("mesh",{position:[o*.25,.3+.11,0],rotation:[-Math.PI/2,0,0],children:[w.jsx("ringGeometry",{args:[.08,.12,16]}),w.jsx("meshBasicMaterial",{color:"#333333"})]},u)),w.jsxs("mesh",{position:[0,.3+.2,.4/2-.03],children:[w.jsx("boxGeometry",{args:[1.2,.08,.06]}),w.jsx("meshStandardMaterial",{color:"#8B4513",roughness:.8})]}),w.jsxs("mesh",{position:[0,.3+.2,-.4/2+.03],children:[w.jsx("boxGeometry",{args:[1.2,.08,.06]}),w.jsx("meshStandardMaterial",{color:"#8B4513",roughness:.8})]})]})}function P4({position:s}){const[e,t]=te.useState(!1),[n]=te.useState("phenolphthalein"),r=te.useRef(null),o=te.useRef(0),u=Ee(x=>x.selectedVesselId),h=Ee(x=>x.fillVessel),d=Ee(x=>x.vessels);u&&d.get(u),xi((x,y)=>{if(!(!e||!r.current))if(o.current+=y*3,o.current<1)r.current.position.y=1.5-o.current*2,r.current.scale.setScalar(1-o.current*.5);else{if(u){const _=Ks[n];_&&h(u,_,10)}t(!1),o.current=0}});const m=()=>{!e&&u&&(t(!0),o.current=0)},v=Ks[n]?.color||"#ffccff";return w.jsxs("group",{position:s,children:[w.jsxs("mesh",{position:[0,2.2,0],onClick:m,children:[w.jsx("sphereGeometry",{args:[.15,16,16]}),w.jsx("meshStandardMaterial",{color:"#333333",roughness:.3})]}),w.jsxs("mesh",{position:[0,2.45,0],onClick:m,children:[w.jsx("sphereGeometry",{args:[.12,16,16]}),w.jsx("meshStandardMaterial",{color:"#8B0000",roughness:.8})]}),w.jsxs("mesh",{position:[0,1.7,0],onClick:m,children:[w.jsx("cylinderGeometry",{args:[.03,.02,1,8]}),w.jsx("meshBasicMaterial",{color:"#e8e8ff",transparent:!0,opacity:.5})]}),w.jsxs("mesh",{position:[0,1.75,0],children:[w.jsx("cylinderGeometry",{args:[.025,.015,.8,8]}),w.jsx("meshBasicMaterial",{color:v,transparent:!0,opacity:.8})]}),w.jsxs("mesh",{position:[0,1.15,0],children:[w.jsx("coneGeometry",{args:[.025,.1,8]}),w.jsx("meshBasicMaterial",{color:"#e8e8ff",transparent:!0,opacity:.6})]}),e&&w.jsxs("mesh",{ref:r,position:[0,1.5,0],children:[w.jsx("sphereGeometry",{args:[.04,8,8]}),w.jsx("meshBasicMaterial",{color:v})]}),w.jsxs("mesh",{position:[0,.1,0],children:[w.jsx("cylinderGeometry",{args:[.2,.25,.2,16]}),w.jsx("meshStandardMaterial",{color:"#555555",metalness:.8,roughness:.3})]}),w.jsxs("mesh",{position:[0,.3,0],children:[w.jsx("cylinderGeometry",{args:[.05,.05,.4,8]}),w.jsx("meshStandardMaterial",{color:"#555555",metalness:.8,roughness:.3})]}),u&&w.jsxs("mesh",{position:[0,2.7,0],children:[w.jsx("sphereGeometry",{args:[.06,8,8]}),w.jsx("meshBasicMaterial",{color:"#00ff00",transparent:!0,opacity:.6})]})]})}function U4({position:s}){const e=Ee(y=>y.placedApparatus),t=e.includes("funnel"),n=e.includes("filter-paper"),r=Ee(y=>y.experimentActions.includes("pour")),o=te.useRef(null),u=te.useRef(null),h=te.useRef(null),d=te.useRef(!1),m=te.useRef(0),v=te.useRef(null),x=120;return xi((y,_)=>{const M=Ee.getState().pendingFiltrationVolume||0,R=Ee.getState().addFiltrate,A=Ee.getState().performExperimentAction,E=Ee.getState().checkExperimentReaction;if(M>.1){d.current=!0;const P=(Ee.getState().isPouringActive?12:20)*_;R(P);const z=Math.min(M/x,1);if(z>m.current&&(m.current=z),o.current){o.current.visible=!0;const U=Math.max(z,.2);o.current.scale.set(.9*U,U,.9*U),o.current.position.y=-.51+.6*U}}if(u.current&&v.current&&m.current>0){M>.1&&(u.current.opacity=Math.min(u.current.opacity+_*.2,.9));const N=Math.max(m.current,.15);v.current.scale.set(.88*N,N,.88*N),v.current.position.y=-.51+.6*N,v.current.visible=!0}if(M>.1)h.current&&(h.current.visible=!0,h.current.children.forEach((N,I)=>{const P=N;P.position.y-=_*3,P.position.y<-2.5&&(P.position.y=-.9-Math.random()*.2,P.visible=!0)}));else if(o.current&&o.current.visible&&(o.current.visible=!1),h.current&&h.current.visible&&(h.current.visible=!1),d.current){d.current=!1;const N=Ee.getState().vessels,I=Array.from(N.values()).filter(z=>z.type==="beaker"&&z.id!=="collection_beaker");let P=0;I.forEach(z=>P+=z.currentVolume),P<5&&(A("filter"),E())}}),t?w.jsxs("group",{position:s,children:[w.jsxs("group",{position:[0,1.5,0],children:[w.jsxs("mesh",{rotation:[Math.PI,0,0],children:[w.jsx("coneGeometry",{args:[1,1.2,32,1,!0]}),w.jsx("meshBasicMaterial",{color:"#c8e6f8",transparent:!0,opacity:.6,side:Ii,depthWrite:!1})]}),w.jsxs("mesh",{position:[0,.6,0],rotation:[-Math.PI/2,0,0],children:[w.jsx("ringGeometry",{args:[.95,1.05,32]}),w.jsx("meshBasicMaterial",{color:"#e0e0e0",side:Ii})]}),w.jsxs("mesh",{position:[0,-.9,0],children:[w.jsx("cylinderGeometry",{args:[.08,.08,1,16]}),w.jsx("meshBasicMaterial",{color:"#c8e6f8",transparent:!0,opacity:.4,depthWrite:!1})]}),n&&w.jsxs("group",{children:[w.jsxs("mesh",{position:[0,.05,0],scale:[.95,.95,.95],rotation:[Math.PI,0,0],children:[w.jsx("coneGeometry",{args:[1,1.2,32,1,!0]}),w.jsx("meshBasicMaterial",{color:"#ffffff",side:Ii,transparent:!0,opacity:.4,depthWrite:!1})]}),w.jsxs("mesh",{ref:o,position:[0,0,0],rotation:[Math.PI,0,0],visible:!1,children:[w.jsx("coneGeometry",{args:[.92,1.12,32,1]}),w.jsx("meshBasicMaterial",{color:"#8b7355"})]}),w.jsx("group",{children:w.jsxs("mesh",{ref:v,position:[0,.06,0],scale:[0,0,0],rotation:[Math.PI,0,0],visible:!1,children:[w.jsx("coneGeometry",{args:[.96,1.18,32,1,!0]}),w.jsx("meshBasicMaterial",{ref:u,color:"#5d4037",side:Ii})]})})]}),w.jsx("group",{ref:h,visible:!1,children:[...Array(8)].map((y,_)=>w.jsxs("mesh",{position:[0,-.9-_*.4,0],scale:[.8,.8,.8],children:[w.jsx("sphereGeometry",{args:[.05,8,8]}),w.jsx("meshBasicMaterial",{color:"#c8e0ff"})]},_))})]}),t&&!n&&w.jsx(BE,{position:[0,2,0],center:!0,children:w.jsx("div",{className:"text-xs text-white bg-black/60 px-2 py-1 rounded backdrop-blur-sm whitespace-nowrap border border-white/20 select-none pointer-events-none",children:"Add Filter Paper"})}),n&&!r&&w.jsx(BE,{position:[0,2,0],center:!0,children:w.jsx("div",{className:"text-xs text-white bg-black/60 px-2 py-1 rounded backdrop-blur-sm whitespace-nowrap border border-white/20 select-none pointer-events-none",children:"Pour from Beaker"})})]}):null}function O4({vesselId:s}){const e=te.useRef(null),t=te.useRef(null),[n,r]=te.useState(!1),[o,u]=te.useState(!1),[h,d]=te.useState(0),{camera:m,gl:v}=Sr(),x=Ee(re=>re.vessels.get(s)),y=Ee(re=>re.vessels.get(s)?.currentVolume??0),_=Ee(re=>re.vessels.get(s)?.contents??[]),M=Ee(re=>re.selectedVesselId),R=Ee(re=>re.selectVessel),A=Ee(re=>re.updateVesselTilt),E=Ee(re=>re.updateVesselPosition),N=M===s,I=1.8,P=.6,z=.15,U=x?.position||[0,0,0],H=x?.capacity||250,V=x?.temperature||25,L=te.useMemo(()=>y===0?0:y/H*(I*.6),[y,H,I]),B=te.useMemo(()=>_.length===0?"#4fc3f7":_.reduce((j,le)=>le.volume>j.volume?le:j).chemical.color,[_]),W=x?.tiltAngle||0,ie=W*Math.PI/180,J=te.useCallback(re=>{re.stopPropagation(),R(s)},[s,R]),se=te.useCallback(re=>{if(re.stopPropagation(),!N){R(s);return}const j=re.shiftKey||re.nativeEvent?.shiftKey;u(j),r(!0),d(re.clientY||re.nativeEvent?.clientY||0),re.target?.setPointerCapture&&re.pointerId!==void 0&&re.target.setPointerCapture(re.pointerId)},[N,s,R]),ce=te.useMemo(()=>new Sd,[]),Y=te.useMemo(()=>new sa(new Q(0,1,0),0),[]),ne=te.useCallback(re=>{if(!(!n||!N))if(re.stopPropagation(),o){const j=v.domElement.getBoundingClientRect(),le=(re.clientX-j.left)/j.width*2-1,Me=-((re.clientY-j.top)/j.height)*2+1;ce.setFromCamera(new Je(le,Me),m);const Ue=new Q;if(ce.ray.intersectPlane(Y,Ue),Ue){const lt=Math.max(-4,Math.min(4,Ue.x)),pe=Math.max(-4,Math.min(4,Ue.z)),Re=0,it=2;Math.sqrt(Math.pow(lt-Re,2)+Math.pow(pe-it,2))<.8?E(s,[Re,1,it]):E(s,[lt,0,pe])}}else{const j=re.clientY||re.nativeEvent?.clientY||0,le=h-j,Ue=Math.max(0,Math.min(70,W+le*.5));A(s,Ue),d(j)}},[n,N,o,s,W,A,E,h,m,v,ce,Y]),ve=te.useCallback(re=>{n&&(re.stopPropagation(),r(!1),u(!1),re.target?.releasePointerCapture&&re.pointerId!==void 0&&re.target.releasePointerCapture(re.pointerId))},[n]);if(!x)return null;const ae=V>50;return w.jsx("group",{ref:t,position:U,children:w.jsxs("group",{rotation:[0,0,-ie],children:[N&&w.jsxs("mesh",{position:[0,.01,0],rotation:[-Math.PI/2,0,0],children:[w.jsx("ringGeometry",{args:[P+.05,P+.15,24]}),w.jsx("meshBasicMaterial",{color:o?"#ffaa00":"#00ff88",transparent:!0,opacity:.9})]}),w.jsxs("mesh",{ref:e,position:[0,I*.35,0],onClick:J,onPointerDown:se,onPointerMove:ne,onPointerUp:ve,onPointerLeave:ve,children:[w.jsx("cylinderGeometry",{args:[z,P,I*.7,24,1,!0]}),w.jsx("meshBasicMaterial",{color:N?"#aaffcc":ae?"#ffccaa":"#c8e6f8",transparent:!0,opacity:N?.3:.2,side:Ii,depthWrite:!1})]}),w.jsxs("mesh",{position:[0,I*.8,0],children:[w.jsx("cylinderGeometry",{args:[z,z,I*.25,16,1,!0]}),w.jsx("meshBasicMaterial",{color:"#c8e6f8",transparent:!0,opacity:.25,side:Ii,depthWrite:!1})]}),w.jsxs("mesh",{position:[0,.02,0],rotation:[-Math.PI/2,0,0],children:[w.jsx("circleGeometry",{args:[P,24]}),w.jsx("meshBasicMaterial",{color:"#c8e6f8",transparent:!0,opacity:.2,depthWrite:!1})]}),w.jsxs("mesh",{position:[0,I*.92,0],rotation:[-Math.PI/2,0,0],children:[w.jsx("ringGeometry",{args:[z-.02,z+.02,16]}),w.jsx("meshBasicMaterial",{color:"#ffffff"})]}),L>0&&w.jsxs(w.Fragment,{children:[w.jsxs("mesh",{position:[0,L/2+.05,0],renderOrder:1,children:[w.jsx("cylinderGeometry",{args:[P*.5*(1-L/I),P*.85,L,24]}),w.jsx("meshBasicMaterial",{color:B,transparent:!0,opacity:.85})]}),w.jsxs("mesh",{position:[0,L+.05,0],rotation:[-Math.PI/2,0,0],renderOrder:2,children:[w.jsx("circleGeometry",{args:[P*.85*(1-L/I/2),24]}),w.jsx("meshBasicMaterial",{color:B,transparent:!0,opacity:.95})]})]})]})})}const qE=45,z4=5,B4=.825;function F4(){const{scene:s}=Sr(),e=te.useRef(0),t=Ee(d=>d.vessels),n=Ee(d=>d.transferLiquid),r=Ee(d=>d.setPouringState),o=Ee(d=>d.isPouringActive),u=Ee(d=>d.pouringSourceId),h=Ee(d=>d.pouringTargetId);return xi((d,m)=>{const v=performance.now();if(v-e.current<16)return;e.current=v;const x=Array.from(t.values());let y=!1;for(const _ of x){const M=s.getObjectByName(_.id);if(!M)continue;const R=Math.abs(M.rotation.z*(180/Math.PI));if(R<qE||_.currentVolume<=0)continue;const A=M.position;for(const E of x){if(E.id===_.id)continue;const N=s.getObjectByName(E.id),I=N?N.position:new Q(...E.position);if(A.distanceTo(I)<z4){if(E.currentVolume>=E.capacity)continue;const z=I.x-A.x;if(z>-3&&z<3){(!o||u!==_.id||h!==E.id)&&(r(!0,_.id,E.id),Vl.playPour("pouring"));const U=Math.min((R-qE)/45,1),H=B4*U*m*60;n(_.id,E.id,H),y=!0;break}}}if(y)break}!y&&o&&(r(!1),Vl.stopSound("pouring"))}),null}function k4({vesselId:s,startTime:e,duration:t}){const n=Ee(m=>m.vessels.get(s)),r=te.useRef([]),o=te.useRef(null),u=te.useRef(0),h=50;te.useMemo(()=>{r.current=Array.from({length:h},()=>({position:new Q((Math.random()-.5)*1.2,Math.random()*.3,(Math.random()-.5)*1.2),velocity:new Q((Math.random()-.5)*.008,.015+Math.random()*.025,(Math.random()-.5)*.008),baseSize:.02+Math.random()*.06,phase:Math.random()*Math.PI*2,wobbleSpeed:2+Math.random()*3,wobbleAmount:.01+Math.random()*.02}))},[s]);const d=te.useMemo(()=>new Nn,[]);return xi((m,v)=>{if(!o.current||!n)return;u.current+=v;const y=(Date.now()-e)/t;let _=1;y<.1?_=y/.1:y>.8&&(_=1-(y-.8)/.2),r.current.forEach((M,R)=>{M.position.add(M.velocity);const A=Math.sin(u.current*M.wobbleSpeed+M.phase)*M.wobbleAmount,E=Math.cos(u.current*M.wobbleSpeed+M.phase+1)*M.wobbleAmount;M.position.x+=A,M.position.z+=E,M.position.y>2.5&&(M.position.set((Math.random()-.5)*1,.1+Math.random()*.2,(Math.random()-.5)*1),M.velocity.y=.015+Math.random()*.025,M.baseSize=.02+Math.random()*.06);const N=M.position.y/2.5,I=N<.7?1+N*.3:1.3-(N-.7)*2,P=M.baseSize*I*_;d.position.set(M.position.x,M.position.y,M.position.z),d.scale.setScalar(Math.max(.001,P)),d.updateMatrix(),o.current.setMatrixAt(R,d.matrix)}),o.current.instanceMatrix.needsUpdate=!0}),n?w.jsx("group",{position:n.position,children:w.jsxs("instancedMesh",{ref:o,args:[void 0,void 0,h],children:[w.jsx("sphereGeometry",{args:[1,12,12]}),w.jsx("meshPhysicalMaterial",{color:"#ffffff",transparent:!0,opacity:.5,roughness:0,metalness:0,transmission:.9,thickness:.5,ior:1.33})]})}):null}function V4({vesselId:s,startTime:e,duration:t}){const n=Ee(v=>v.vessels.get(s)),r=te.useRef([]),o=te.useRef(null),u=te.useRef(null),h=te.useRef(0),d=35;te.useMemo(()=>{r.current=Array.from({length:d},()=>({position:new Q((Math.random()-.5)*.8,Math.random()*.5,(Math.random()-.5)*.8),velocity:new Q(0,.02+Math.random()*.03,0),life:Math.random(),maxLife:.8+Math.random()*.4,rotationSpeed:(Math.random()-.5)*4,spiralRadius:.1+Math.random()*.3}))},[s]);const m=te.useMemo(()=>new Nn,[]);return xi((v,x)=>{if(!o.current||!n)return;h.current+=x;const _=(Date.now()-e)/t;let M=1;if(_<.1?M=_/.1:_>.75&&(M=1-(_-.75)/.25),u.current){const R=Math.sin(h.current*8)*.3+.7;u.current.intensity=3*R*M}r.current.forEach((R,A)=>{R.life+=x/R.maxLife;const E=h.current*R.rotationSpeed+A,N=Math.cos(E)*R.spiralRadius*(1-R.life*.5),I=Math.sin(E)*R.spiralRadius*(1-R.life*.5);R.position.y+=R.velocity.y,(R.life>=1||R.position.y>3)&&(R.position.set((Math.random()-.5)*.6,.2+Math.random()*.3,(Math.random()-.5)*.6),R.life=0,R.velocity.y=.02+Math.random()*.03,R.spiralRadius=.1+Math.random()*.3);const z=.06*(R.life<.3?R.life/.3:1-(R.life-.3)/.7)*M;m.position.set(R.position.x+N,R.position.y,R.position.z+I),m.scale.setScalar(Math.max(.001,z)),m.updateMatrix(),o.current.setMatrixAt(A,m.matrix)}),o.current.instanceMatrix.needsUpdate=!0}),n?w.jsxs("group",{position:n.position,children:[w.jsxs("instancedMesh",{ref:o,args:[void 0,void 0,d],children:[w.jsx("sphereGeometry",{args:[1,8,8]}),w.jsx("meshBasicMaterial",{color:"#ff6b35",transparent:!0,opacity:.85})]}),w.jsxs("instancedMesh",{args:[void 0,void 0,15],children:[w.jsx("sphereGeometry",{args:[.03,6,6]}),w.jsx("meshBasicMaterial",{color:"#ffcc00",transparent:!0,opacity:.9})]}),w.jsx("pointLight",{ref:u,position:[0,1,0],color:"#ff4400",intensity:3,distance:4,decay:2}),w.jsx("pointLight",{position:[0,.5,0],color:"#ff8800",intensity:1.5,distance:2,decay:2})]}):null}function H4({vesselId:s,startTime:e,duration:t}){const n=Ee(m=>m.vessels.get(s)),r=te.useRef([]),o=te.useRef(null),u=te.useRef(0),h=25;te.useMemo(()=>{r.current=Array.from({length:h},()=>({position:new Q((Math.random()-.5)*.6,1.5+Math.random()*.5,(Math.random()-.5)*.6),velocity:new Q((Math.random()-.5)*.005,.01+Math.random()*.01,(Math.random()-.5)*.005),life:Math.random(),size:.05+Math.random()*.08}))},[s]);const d=te.useMemo(()=>new Nn,[]);return xi((m,v)=>{if(!o.current||!n)return;u.current+=v;const y=(Date.now()-e)/t,_=y>.8?1-(y-.8)/.2:1;r.current.forEach((M,R)=>{M.position.add(M.velocity),M.life+=.008,M.position.x+=Math.sin(u.current+R)*.002,(M.life>=1||M.position.y>4)&&(M.position.set((Math.random()-.5)*.5,1.5,(Math.random()-.5)*.5),M.life=0);const A=M.size*(1-M.life*.5)*_;d.position.copy(M.position),d.scale.setScalar(Math.max(.001,A)),d.updateMatrix(),o.current.setMatrixAt(R,d.matrix)}),o.current.instanceMatrix.needsUpdate=!0}),n?w.jsx("group",{position:n.position,children:w.jsxs("instancedMesh",{ref:o,args:[void 0,void 0,h],children:[w.jsx("sphereGeometry",{args:[1,8,8]}),w.jsx("meshBasicMaterial",{color:"#dddddd",transparent:!0,opacity:.3})]})}):null}function G4({vesselId:s,startTime:e,duration:t}){const n=Ee(d=>d.vessels.get(s)),r=te.useRef([]),o=te.useRef(null),u=30;te.useMemo(()=>{r.current=Array.from({length:u},()=>({position:new Q((Math.random()-.5)*.6,.1+Math.random()*.5,(Math.random()-.5)*.6),velocity:new Q((Math.random()-.5)*.01,.02+Math.random()*.03,(Math.random()-.5)*.01),size:.02+Math.random()*.04}))},[s]);const h=te.useMemo(()=>new Nn,[]);return xi(()=>{if(!o.current||!n)return;const m=(Date.now()-e)/t,v=m>.8?1-(m-.8)/.2:1,x=n.currentVolume/n.capacity*1.8;r.current.forEach((y,_)=>{y.position.add(y.velocity),y.position.y>x&&(y.position.set((Math.random()-.5)*.5,.1,(Math.random()-.5)*.5),y.velocity.y=.02+Math.random()*.03);const M=y.size*v;h.position.copy(y.position),h.scale.setScalar(Math.max(.001,M)),h.updateMatrix(),o.current.setMatrixAt(_,h.matrix)}),o.current.instanceMatrix.needsUpdate=!0}),n?w.jsx("group",{position:n.position,children:w.jsxs("instancedMesh",{ref:o,args:[void 0,void 0,u],children:[w.jsx("sphereGeometry",{args:[1,6,6]}),w.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:.6})]})}):null}function j4({vesselId:s,startTime:e,duration:t}){const n=Ee(d=>d.vessels.get(s)),r=te.useRef([]),o=te.useRef(null),u=40;te.useMemo(()=>{r.current=Array.from({length:u},()=>({position:new Q((Math.random()-.5)*.8,.5+Math.random()*1,(Math.random()-.5)*.8),velocity:new Q((Math.random()-.5)*.002,-.005-Math.random()*.01,(Math.random()-.5)*.002),size:.02+Math.random()*.03,settled:!1}))},[s]);const h=te.useMemo(()=>new Nn,[]);return xi(()=>{if(!o.current||!n)return;const m=(Date.now()-e)/t,v=Math.min(1,m*3);r.current.forEach((x,y)=>{x.settled||(x.position.add(x.velocity),x.position.x+=Math.sin(Date.now()*.002+y)*.001,x.position.y<=.15&&(x.position.y=.1+Math.random()*.1,x.settled=!0));const _=x.size*v;h.position.copy(x.position),h.scale.setScalar(Math.max(.001,_)),h.updateMatrix(),o.current.setMatrixAt(y,h.matrix)}),o.current.instanceMatrix.needsUpdate=!0}),n?w.jsx("group",{position:n.position,children:w.jsxs("instancedMesh",{ref:o,args:[void 0,void 0,u],children:[w.jsx("sphereGeometry",{args:[1,6,6]}),w.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:.9})]})}):null}function W4({effect:s}){if(Date.now()-s.startTime>=s.duration)return null;switch(s.type){case"bubbles":return w.jsx(k4,{vesselId:s.vesselId,startTime:s.startTime,duration:s.duration});case"heat":return w.jsx(V4,{vesselId:s.vesselId,startTime:s.startTime,duration:s.duration});case"steam":return w.jsx(H4,{vesselId:s.vesselId,startTime:s.startTime,duration:s.duration});case"boiling":return w.jsx(G4,{vesselId:s.vesselId,startTime:s.startTime,duration:s.duration});case"precipitate":return w.jsx(j4,{vesselId:s.vesselId,startTime:s.startTime,duration:s.duration});default:return null}}function X4(){const s=Ee(t=>t.activeEffects),e=Ee(t=>t.clearExpiredEffects);return xi(()=>{e()}),w.jsx(w.Fragment,{children:s.map(t=>w.jsx(W4,{effect:t},t.id))})}function q4(){const s=te.useRef(null),e=Ee(m=>m.isStirring),t=Ee(m=>m.placedApparatus),n=Ee(m=>m.vessels),r=t.includes("glass-rod"),u=Array.from(n.values()).find(m=>m.type==="beaker"&&m.id!=="collection_beaker")?.position||[0,0,0];if(xi(m=>{if(s.current&&e){const v=m.clock.elapsedTime,x=.2,y=4;s.current.position.x=u[0]+Math.cos(v*y)*x,s.current.position.y=u[1]+.8,s.current.position.z=u[2]+Math.sin(v*y)*x,s.current.rotation.x=Math.sin(v*y)*.15,s.current.rotation.z=Math.cos(v*y)*.15}else s.current&&r&&(s.current.position.x=u[0]+.25,s.current.position.y=u[1]+.6,s.current.position.z=u[2],s.current.rotation.x=0,s.current.rotation.z=.4)}),!r&&!e)return null;const h=2.5,d=.04;return w.jsxs("group",{ref:s,position:[u[0]+.25,u[1]+.6,u[2]],rotation:[0,0,.4],children:[w.jsxs("mesh",{position:[0,h/2-.5,0],children:[w.jsx("cylinderGeometry",{args:[d,d,h,16]}),w.jsx("meshStandardMaterial",{color:"#e8e8e8",transparent:!0,opacity:.7,roughness:.1,metalness:.3})]}),w.jsxs("mesh",{position:[0,-.5,0],children:[w.jsx("sphereGeometry",{args:[d*1.3,12,12]}),w.jsx("meshStandardMaterial",{color:"#d0d0d0",transparent:!0,opacity:.8,roughness:.1})]}),w.jsxs("mesh",{position:[0,h-.5,0],children:[w.jsx("sphereGeometry",{args:[d*1.2,12,12]}),w.jsx("meshStandardMaterial",{color:"#f0f0f0",transparent:!0,opacity:.9})]})]})}function Y4({position:s=[0,1.1,2]}){const e=Ee(W=>W.addedChemicals),t=Ee(W=>W.bunsenBurnerOn),n=Ee(W=>W.setDishCracked),r=te.useRef(null),[o,u]=te.useState(0),h=e.includes("salt-solution"),d=t&&h,[m,v]=te.useState(!1),[x,y]=te.useState(!1),_=te.useRef(0),M=5,R=Ee(W=>W.performExperimentAction),A=Ee(W=>W.checkExperimentReaction),E=30,N=4,I=te.useRef([]),P=te.useRef(0),[z]=te.useState(()=>{const W=Array.from({length:N},()=>.5+Math.random()),ie=W.reduce((se,ce)=>se+ce,0);let J=0;return W.map(se=>{const ce=se/ie*Math.PI*2,Y=J,ne=Y+ce/2;return J+=ce,{startOffset:Y,arcLength:ce,midAngle:ne}})}),U=te.useRef([]);te.useMemo(()=>{U.current=Array.from({length:E},()=>({position:new Q((Math.random()-.5)*.4,.1+Math.random()*.3,(Math.random()-.5)*.4),velocity:new Q((Math.random()-.5)*.02,.04+Math.random()*.03,(Math.random()-.5)*.02),life:Math.random()}))},[]);const H=te.useMemo(()=>new Nn,[]),V=()=>{try{const W=window.AudioContext||window.webkitAudioContext;if(!W)return;const ie=new W,J=ie.sampleRate*.4,se=ie.createBuffer(1,J,ie.sampleRate),ce=se.getChannelData(0);for(let ae=0;ae<J;ae++)ce[ae]=Math.random()*2-1;const Y=ie.createBufferSource();Y.buffer=se;const ne=ie.createBiquadFilter();ne.type="highpass",ne.frequency.value=1500;const ve=ie.createGain();ve.gain.setValueAtTime(.8,ie.currentTime),ve.gain.exponentialRampToValueAtTime(.01,ie.currentTime+.3),Y.connect(ne),ne.connect(ve),ve.connect(ie.destination),Y.start()}catch(W){console.error("Audio playback failed",W)}},L=Ee(W=>W.toggleBunsenBurner);xi((W,ie)=>{if(t&&!x&&(!h||m?(_.current+=ie,_.current>M&&(y(!0),n(!0),V(),setTimeout(()=>{Vl.playWarning(),Ee.getState().showSafetyWarning("Oops! Thermal Shock! ",`The dish got too hot and CRACKED! 

Always keep some liquid inside to keep it safe. `)},2500),Ee.getState().bunsenBurnerOn&&L())):_.current=0),x&&(P.current=Jx.lerp(P.current,.03,ie*5),I.current.forEach((J,se)=>{if(J){const ce=z[se];J.position.set(Math.cos(ce.midAngle)*P.current,0,Math.sin(ce.midAngle)*P.current)}})),d&&!m&&!x&&u(J=>{const se=Math.min(J+ie/8,1);return se>=1&&!m&&(v(!0),_.current=0,setTimeout(()=>{R("heat"),R("evaporate"),Ee.getState().bunsenBurnerOn&&L(),setTimeout(()=>A(),100)},2e3)),se}),r.current)if(!d||m||B<=.05||x){r.current.visible=!1;return}else r.current.visible=!0;!r.current||!d||m||x||(U.current.forEach((J,se)=>{J.life+=ie*.5,J.position.add(J.velocity.clone().multiplyScalar(ie*20)),J.life>=1&&(J.position.set((Math.random()-.5)*.4,.2,(Math.random()-.5)*.4),J.life=0);const ce=.06*(1-J.life*.5);H.position.copy(J.position),H.scale.setScalar(Math.max(.001,ce)),H.updateMatrix(),r.current.setMatrixAt(se,H.matrix)}),r.current.instanceMatrix.needsUpdate=!0)});const B=1-o;return w.jsxs("group",{position:s,children:[!x&&w.jsxs(w.Fragment,{children:[w.jsxs("mesh",{position:[0,.025,0],children:[w.jsx("cylinderGeometry",{args:[.5,.42,.05,32]}),w.jsx("meshStandardMaterial",{color:"#5d4037",roughness:.4,metalness:.1})]}),w.jsxs("mesh",{position:[0,.05,0],rotation:[Math.PI/2,0,0],children:[w.jsx("torusGeometry",{args:[.5,.025,16,50]}),w.jsx("meshStandardMaterial",{color:"#5d4037",roughness:.4})]})]}),!x&&w.jsxs("mesh",{position:[0,.051,0],rotation:[-Math.PI/2,0,0],children:[w.jsx("circleGeometry",{args:[.5,32]}),w.jsx("meshStandardMaterial",{color:"#5d4037",roughness:.4,metalness:.1})]}),!x&&h&&B>.01&&w.jsxs("mesh",{position:[0,.05+.005*B,0],scale:[1,B,1],children:[w.jsx("cylinderGeometry",{args:[.47,.47,.01,32]}),w.jsx("meshStandardMaterial",{color:"#aaddff",transparent:!0,opacity:.1+.5*B,roughness:.02,metalness:.1})]}),!x&&(h||m)&&w.jsx("group",{position:[0,.052,0],children:Array.from({length:150}).map((W,ie)=>{const J=Math.sin(ie*12.9898)*43758.5453,se=Math.cos(ie*78.233)*43758.5453,ce=Math.sin(ie*37.719)*43758.5453,Y=Math.abs(J-Math.floor(J)),ne=Math.abs(se-Math.floor(se)),ve=Math.abs(ce-Math.floor(ce)),ae=Y*.45,re=ne*Math.PI*2,j=.01+ve*.02,le=ie%3,Me=m?1:Math.max(0,(o-.6)*2.5);return Me<=0?null:w.jsxs("mesh",{position:[ae*Math.cos(re),j/2,ae*Math.sin(re)],rotation:[ve*Math.PI,Y*Math.PI,ne*Math.PI],scale:[Me,Me,Me],children:[le===0&&w.jsx("boxGeometry",{args:[j,j,j]}),le===1&&w.jsx("tetrahedronGeometry",{args:[j*.8]}),le===2&&w.jsx("dodecahedronGeometry",{args:[j*.6]}),w.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.2,metalness:.1,emissive:"#eeeeee",emissiveIntensity:.1*Me,transparent:!0,opacity:Me})]},ie)})}),d&&!m&&B>.05&&w.jsx("group",{position:[0,.15,0],children:w.jsxs("instancedMesh",{ref:r,args:[void 0,void 0,E],children:[w.jsx("sphereGeometry",{args:[1,8,8]}),w.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:.4})]})}),x&&z.map((W,ie)=>w.jsx("group",{ref:J=>{J&&(I.current[ie]=J)},rotation:[0,W.startOffset,0],children:w.jsxs("group",{position:[0,0,0],children:[w.jsxs("mesh",{position:[0,.025,0],children:[w.jsx("cylinderGeometry",{args:[.5,.42,.05,16,1,!1,0,W.arcLength]}),w.jsx("meshStandardMaterial",{color:"#5d4037",roughness:.4,metalness:.1,side:Ii})]}),w.jsxs("mesh",{position:[0,.05,0],rotation:[Math.PI/2,0,0],children:[w.jsx("torusGeometry",{args:[.5,.025,8,W.arcLength]}),w.jsx("meshStandardMaterial",{color:"#5d4037",roughness:.4,side:Ii})]})]})},`shard-${ie}`))]})}function Z4({position:s=[0,0,2]}){return w.jsxs("group",{position:s,children:[[0,1,2].map(e=>{const t=e*Math.PI*2/3+Math.PI/6,n=1,r=.6,o=Math.cos(t)*r,u=Math.sin(t)*r,h=0,d=0,m=(o+h)/2,v=(u+d)/2,x=.5,y=Math.atan2(r,n);return w.jsxs("mesh",{position:[m,x,v],rotation:[0,-t,y],children:[w.jsx("cylinderGeometry",{args:[.03,.03,n,8]}),w.jsx("meshStandardMaterial",{color:"#333333",metalness:.8,roughness:.3})]},e)}),w.jsxs("group",{position:[0,1,0],children:[w.jsxs("mesh",{rotation:[-Math.PI/2,0,0],children:[w.jsx("ringGeometry",{args:[.6,.75,32]}),w.jsx("meshStandardMaterial",{color:"#555555",metalness:.8,roughness:.4})]}),w.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,.01,0],children:[w.jsx("circleGeometry",{args:[.6,32]}),w.jsx("meshStandardMaterial",{color:"#666666",metalness:.7,roughness:.5,wireframe:!0})]}),w.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,-.02,0],children:[w.jsx("ringGeometry",{args:[.1,.15,16]}),w.jsx("meshStandardMaterial",{color:"#444444",metalness:.8,roughness:.3})]})]})]})}function K4({position:s=[0,0,2]}){const e=Ee(d=>d.bunsenBurnerOn),t=Ee(d=>d.toggleBunsenBurner),n=te.useRef(null),r=te.useRef([]),o=te.useRef(0),u=40;te.useMemo(()=>{r.current=Array.from({length:u},()=>({position:new Q((Math.random()-.5)*.12,Math.random()*.3,(Math.random()-.5)*.12),velocity:new Q((Math.random()-.5)*.008,.025+Math.random()*.02,(Math.random()-.5)*.008),life:Math.random(),maxLife:.4+Math.random()*.3,size:.025+Math.random()*.035}))},[]);const h=te.useMemo(()=>new Nn,[]);return xi((d,m)=>{!n.current||!e||(o.current+=m,r.current.forEach((v,x)=>{v.life+=m/v.maxLife,v.position.add(v.velocity),v.position.x+=Math.sin(o.current*12+x)*.002,v.position.z+=Math.cos(o.current*10+x*.5)*.002,v.life>=1&&(v.position.set((Math.random()-.5)*.1,.02,(Math.random()-.5)*.1),v.life=0,v.velocity.y=.025+Math.random()*.02);const y=v.life<.3?v.life/.3:1-(v.life-.3)/.7,_=v.size*y;h.position.copy(v.position),h.scale.setScalar(Math.max(.001,_)),h.updateMatrix(),n.current.setMatrixAt(x,h.matrix)}),n.current.instanceMatrix.needsUpdate=!0)}),w.jsxs("group",{position:s,children:[w.jsxs("mesh",{position:[0,.02,0],rotation:[-Math.PI/2,0,0],children:[w.jsx("ringGeometry",{args:[.9,1.1,32]}),w.jsx("meshBasicMaterial",{color:e?"#ff4400":"#555555",transparent:!0,opacity:e?.3:.15})]}),w.jsxs("mesh",{position:[0,.12,0],onClick:()=>t(),children:[w.jsx("cylinderGeometry",{args:[.18,.22,.24,16]}),w.jsx("meshStandardMaterial",{color:"#222222",metalness:.9,roughness:.3})]}),w.jsxs("mesh",{position:[0,.42,0],onClick:()=>t(),children:[w.jsx("cylinderGeometry",{args:[.07,.09,.36,16]}),w.jsx("meshStandardMaterial",{color:"#1a1a1a",metalness:.9,roughness:.2})]}),w.jsxs("mesh",{position:[0,.62,0],onClick:()=>t(),children:[w.jsx("cylinderGeometry",{args:[.1,.07,.04,16]}),w.jsx("meshStandardMaterial",{color:"#111111",metalness:.9,roughness:.2})]}),e&&w.jsxs("group",{position:[0,.65,0],children:[w.jsxs("instancedMesh",{ref:n,args:[void 0,void 0,u],children:[w.jsx("sphereGeometry",{args:[1,8,8]}),w.jsx("meshBasicMaterial",{color:"#3399ff",transparent:!0,opacity:.85})]}),w.jsxs("mesh",{position:[0,.18,0],children:[w.jsx("coneGeometry",{args:[.06,.35,8]}),w.jsx("meshBasicMaterial",{color:"#66ccff",transparent:!0,opacity:.9})]}),w.jsxs("mesh",{position:[0,.22,0],children:[w.jsx("coneGeometry",{args:[.1,.45,8]}),w.jsx("meshBasicMaterial",{color:"#0066cc",transparent:!0,opacity:.4})]}),w.jsx("pointLight",{position:[0,.25,0],color:"#4488ff",intensity:2.5,distance:3,decay:2})]}),!e&&w.jsxs("mesh",{position:[0,.8,0],children:[w.jsx("sphereGeometry",{args:[.08,12,12]}),w.jsx("meshBasicMaterial",{color:"#66ff66",transparent:!0,opacity:.5})]})]})}function Q4(){const s=te.useRef(null),e=Ee(x=>x.vessels),t=Ee(x=>x.bunsenBurnerOn),n=Ee(x=>x.checkExperimentReaction),r=Array.from(e.values()).find(x=>x.type==="tongs"),o=r?.contents.some(x=>x.chemical.id==="paper"),u=r?.contents.some(x=>x.chemical.id==="magnesium"),h=r?.contents.some(x=>x.chemical.id==="ash"||x.chemical.id==="magnesium-oxide"),m=t&&(o||u||h),v=te.useRef(!1);return te.useEffect(()=>{if(m&&!v.current){v.current=!0;const x=setTimeout(()=>{n()},3e3);return()=>clearTimeout(x)}m||(v.current=!1)},[m,n]),w.jsxs("group",{ref:s,position:[0,1.5,2],children:[w.jsxs("mesh",{position:[-.3,.075,0],rotation:[0,0,Math.atan2(.15,.6)],children:[w.jsx("boxGeometry",{args:[.62,.025,.025]}),w.jsx("meshStandardMaterial",{color:"#5a5a5a",metalness:.9,roughness:.2})]}),w.jsxs("mesh",{position:[-.3,-.075,0],rotation:[0,0,-Math.atan2(.15,.6)],children:[w.jsx("boxGeometry",{args:[.62,.025,.025]}),w.jsx("meshStandardMaterial",{color:"#5a5a5a",metalness:.9,roughness:.2})]}),w.jsxs("mesh",{position:[-.45,0,0],rotation:[Math.PI/2,0,0],children:[w.jsx("cylinderGeometry",{args:[.025,.025,.04,12]}),w.jsx("meshStandardMaterial",{color:"#333",metalness:.95,roughness:.15})]}),w.jsxs("group",{position:[0,0,0],children:[o&&w.jsx(C4,{burning:m}),u&&w.jsx(R4,{burning:m}),h&&w.jsx(N4,{})]})]})}function J4(){const s=te.useRef(null),e=te.useRef(null),t=te.useRef(0),n=te.useRef(0),r=te.useRef(0),o=Ee(P=>P.neutralizationAnimating),u=Ee(P=>P.neutralizationDropCount),h=Ee(P=>P.incrementNeutralizationDrops),d=Ee(P=>P.placedApparatus),m=Ee(P=>P.currentExperiment),v=1200,x=5,y=te.useMemo(()=>new Ux({color:"#ffffff",metalness:0,roughness:.1,transmission:.9,thickness:.1,transparent:!0,opacity:.3}),[]),_=te.useMemo(()=>new _y({color:"#222222",roughness:.9,metalness:.1}),[]),M=te.useMemo(()=>new Ux({color:"#e8f4fc",transmission:.8,thickness:.2,roughness:.1,transparent:!0,opacity:.7}),[]);xi((P,z)=>{if(!o||u>=x)return;const H=P.clock.elapsedTime*1e3-n.current;if(t.current===0)H>v&&(t.current=.01),r.current>0&&(r.current=Math.max(0,r.current-z*3)),s.current&&(s.current.visible=!1);else if(s.current&&(s.current.visible=!0),t.current<.2?r.current=Math.min(1,r.current+z*5):r.current=Math.max(0,r.current-z*2),t.current+=z*1.8,s.current){if(t.current<.25){const V=t.current/.25;s.current.position.y=2.15,s.current.scale.set(.7*(1+Math.sin(V*Math.PI)*.1),.8*V,.7*(1+Math.sin(V*Math.PI)*.1))}else{const V=(t.current-.25)/.75,L=2.15,W=L-(L-.5)*(V*V);s.current.position.y=W;const ie=1+V*1.2;s.current.scale.set(.6/ie,.8*ie,.6/ie)}t.current>=1&&(h(),n.current=P.clock.elapsedTime*1e3,t.current=0)}if(e.current){const V=r.current*.22,L=Math.max(0,Math.sin(P.clock.elapsedTime*15)*.03*(1-r.current));e.current.scale.set(1+V+L,1-V+L,1+V+L)}});const R=Ee(P=>P.vessels),A=Array.from(R.values()).find(P=>P.type==="beaker"),E=A?A.position:[0,0,0],N=[E[0],E[1],E[2]];return o||d.includes("dropper")&&m?.id==="neutralization"?w.jsxs("group",{position:N,children:[w.jsxs("group",{position:[0,2.8,0],children:[w.jsxs("mesh",{ref:e,position:[0,.65,0],children:[w.jsx("sphereGeometry",{args:[.16,24,24]}),w.jsx("primitive",{object:_})]}),w.jsxs("mesh",{position:[0,.48,0],children:[w.jsx("cylinderGeometry",{args:[.07,.07,.15,16]}),w.jsx("meshStandardMaterial",{color:"#cccccc",metalness:.8,roughness:.2})]}),w.jsxs("mesh",{position:[0,0,0],children:[w.jsx("cylinderGeometry",{args:[.05,.04,.9,16]}),w.jsx("primitive",{object:y})]}),w.jsxs("mesh",{position:[0,-.6,0],children:[w.jsx("cylinderGeometry",{args:[.04,.015,.3,16]}),w.jsx("primitive",{object:y})]}),w.jsxs("group",{children:[w.jsxs("mesh",{position:[0,0,0],children:[w.jsx("cylinderGeometry",{args:[.04,.03,.85,12]}),w.jsx("primitive",{object:M})]}),w.jsxs("mesh",{position:[0,-.58,0],children:[w.jsx("cylinderGeometry",{args:[.03,.005,.25,12]}),w.jsx("primitive",{object:M})]})]})]}),s.current?.visible&&w.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,1.45,0],children:[w.jsx("circleGeometry",{args:[.06,16]}),w.jsx("meshBasicMaterial",{color:"black",transparent:!0,opacity:s.current.position.y>.6?.3*(1-(s.current.position.y-.6)/2):0})]}),w.jsxs("mesh",{ref:s,position:[0,1.35,0],visible:!1,children:[w.jsx("sphereGeometry",{args:[.08,16,16]}),w.jsx("primitive",{object:M})]})]}):null}function $4({position:s,target:e}){const{camera:t,controls:n}=Sr();return te.useEffect(()=>{t.position.set(...s)},[t,s]),te.useEffect(()=>{n&&(n.target.set(...e),n.update())},[n,e]),null}function ez(){return w.jsxs("group",{children:[w.jsxs("mesh",{position:[0,-.1,0],rotation:[-Math.PI/2,0,0],children:[w.jsx("planeGeometry",{args:[10,10]}),w.jsx("meshStandardMaterial",{color:"#8d6e63",roughness:.8})]}),w.jsx(QO,{position:[0,.01,0],args:[10,10],cellSize:.5,cellThickness:.5,cellColor:"#a1887f",sectionSize:2,sectionThickness:1,sectionColor:"#6d4c41",fadeDistance:15,fadeStrength:1,followCamera:!1,infiniteGrid:!1})]})}function tz(){return w.jsxs(w.Fragment,{children:[w.jsx("ambientLight",{intensity:.5}),w.jsx("directionalLight",{position:[5,10,5],intensity:1,castShadow:!0,"shadow-mapSize":[1024,1024]}),w.jsx("directionalLight",{position:[-5,5,-5],intensity:.3}),w.jsx("pointLight",{position:[0,5,-5],intensity:.5,color:"#ffffff"})]})}function nz({isGuidedMode:s}){const e=Ee(o=>o.vessels),t=Array.from(e.values()).filter(o=>o.type==="beaker"),n=Array.from(e.values()).filter(o=>o.type==="test_tube"),r=Array.from(e.values()).filter(o=>o.type==="flask");return w.jsxs(w.Fragment,{children:[t.map(o=>w.jsx(D4,{vesselId:o.id},o.id)),n.map(o=>w.jsx(I4,{vesselId:o.id},o.id)),!s&&w.jsx(L4,{position:[-1.9,0,-1]}),r.map(o=>w.jsx(O4,{vesselId:o.id},o.id))]})}function iz(){const s=Ee(d=>d.vessels),e=Ee(d=>d.bunsenBurnerOn),t=Ee(d=>d.updateVesselTemperature),n=Ee(d=>d.addEffect),r=Ee(d=>d.activeEffects),o=te.useRef(0),u=[0,0,2],h=.7;return xi((d,m)=>{if(!e){s.forEach(v=>{if(v.temperature>25){const x=Math.max(25,v.temperature-m*5);t(v.id,x)}});return}s.forEach(v=>{const x=v.position[0]-u[0],y=v.position[2]-u[2],_=Math.sqrt(x*x+y*y);if(_<h){const M=15*(1-_/h),R=Math.min(120,v.temperature+m*M);t(v.id,R);const A=v.contents.some(E=>E.chemical.id==="ice");if(v.temperature>=100&&v.currentVolume>0&&!A){const E=Date.now();E-o.current>5e3&&(r.some(I=>I.vesselId===v.id&&(I.type==="boiling"||I.type==="steam"))||(n({type:"boiling",vesselId:v.id,duration:5e3}),n({type:"steam",vesselId:v.id,duration:5e3}),Vl.playBoiling(`boiling_${v.id}`,5e3),o.current=E))}}else if(v.temperature>25){const M=Math.max(25,v.temperature-m*3);t(v.id,M)}})}),null}function YE({className:s,isMobile:e=!1}){const t=Ee(v=>v.experimentMode),n=Ee(v=>v.currentExperiment),r=t==="guided"&&n!==null,o=Ee(v=>v.placedApparatus),u=te.useMemo(()=>n?.id==="neutralization"?[0,1.5,0]:e&&n?.id==="filtration"?[1.75,0,0]:[0,0,0],[e,n?.id]),h=te.useMemo(()=>e?n?.id==="evaporation"||n?.id==="salt-dissolution"?[2.6,3.6,3.6]:n?.id==="filtration"?[4.5,4,4.5]:n?.id==="neutralization"?[6,7,9]:[4,5,6]:n?.id==="neutralization"?[5,6,8]:[4,5,6],[e,n?.id]),d=!r||o.includes("funnel"),m=(!r||o.includes("dropper"))&&n?.id!=="neutralization";return w.jsx("div",{className:s,children:w.jsxs(lO,{camera:{position:h,fov:50},shadows:!0,style:{background:"linear-gradient(to bottom, #1a1a2e 0%, #16213e 50%, #1a1a2e 100%)",touchAction:"none"},children:[w.jsx($4,{position:h,target:u}),w.jsx(g4,{preset:"studio"}),w.jsx(tz,{}),w.jsx(ez,{}),(!r||o.includes("tripod-stand"))&&w.jsx(Z4,{}),(!r||o.includes("burner"))&&w.jsx(K4,{}),w.jsx(iz,{}),w.jsx(nz,{isGuidedMode:r}),w.jsx(F4,{}),w.jsx(X4,{}),r&&w.jsx(q4,{}),m&&w.jsx(P4,{position:[2.5,0,-1]}),d&&w.jsx(U4,{position:[3.5,0,0]}),o.includes("china-dish")&&w.jsx(Y4,{}),o.includes("tongs")&&w.jsx(Q4,{}),w.jsx(J4,{}),w.jsx(ZO,{makeDefault:!0,minPolarAngle:.1,maxPolarAngle:Math.PI/2-.1,minDistance:3,maxDistance:15,enablePan:!0,panSpeed:.5})]})})}function ZE(){const s=Ee(xe=>xe.selectedVesselId),e=Ee(xe=>xe.fillVessel),t=Ee(xe=>xe.selectVessel),n=Ee(xe=>xe.vessels),r=Ee(xe=>xe.experimentMode),o=Ee(xe=>xe.currentExperiment),u=Ee(xe=>xe.addChemicalToExperiment),h=Ee(xe=>xe.checkExperimentReaction),d=Ee(xe=>xe.addedChemicals),m=Ee(xe=>xe.addApparatusToExperiment),v=Ee(xe=>xe.addVessel),x=Ee(xe=>xe.placedApparatus),y=Ee(xe=>xe.saltTested),_=Ee(xe=>xe.sandTested),M=Ee(xe=>xe.resetAfterSaltTest),R=Ee(xe=>xe.iceTested),A=Ee(xe=>xe.paperTested),E=Ee(xe=>xe.magnesiumTested),N=Ee(xe=>xe.experimentActions),I=Ee(xe=>xe.performExperimentAction),P=Ee(xe=>xe.isAutoPouring),z=Ee(xe=>xe.setAutoPouring),U=Ee(xe=>xe.bunsenBurnerOn),H=Ee(xe=>xe.toggleBunsenBurner),V=Ee(xe=>xe.startNeutralizationAnimation),L=Ee(xe=>xe.neutralizationAnimating),B=Ee(xe=>xe.neutralizationComplete),W=Ee(xe=>xe.showResetPrompt),ie=Ee(xe=>xe.resetExperiment),J=Ee(xe=>xe.dishCracked),se=o?.apparatus?.includes("burner")||o?.id==="evaporation"||o?.id==="physical-chemical",ce=s?n.get(s):null,Y=ce?.currentVolume??0,ve=(ce?.capacity??500)-Y,ae=r==="guided"&&o!==null,re=xe=>({water:"",salt:"",sand:"","muddy-water":"","salt-solution":"",ice:"",paper:"",magnesium:"",hcl:"",hydrochloric_acid:"",naoh:"",sodium_hydroxide:"",phenolphthalein:"",h2so4:"",sulfuric_acid:"",barium_chloride:"",vinegar:"","lemon-juice":"","soap-solution":"","baking-soda":"","blue-litmus":"","red-litmus":"",zinc:""})[xe]||"",j=xe=>({water:"water",salt:"salt",sand:"neutral",hcl:"acid",naoh:"base",h2so4:"acid",phenolphthalein:"indicator",barium_chloride:"salt",zinc:"metal",vinegar:"acid","lemon-juice":"acid","soap-solution":"base","baking-soda":"base"})[xe]||"neutral",le=xe=>{if(!ae||o?.id!=="salt-dissolution")return!1;const rt=d.includes("water"),Le=d.includes("salt")||d.includes("sand");return xe==="water"?!1:xe==="salt"?!!(!rt||y||Le):xe==="sand"?!!(!rt||!y||_||!M||Le):!1},Me=xe=>{if(!ae||o?.id!=="physical-chemical")return!1;const rt=x.includes("beaker"),Le=x.includes("tongs"),Xe=d.includes("ice"),qe=d.includes("paper"),ot=d.includes("magnesium");return xe==="ice"?!!(R||!rt||Xe):xe==="paper"?!!(!R||A||Xe||!Le||qe):xe==="magnesium"?!!(!R||!A||E||qe||!Le||ot):!1},Ue=xe=>{if(!ae||o?.id!=="neutralization")return!1;if(L||B)return!0;const rt=d.includes("naoh"),Le=d.includes("phenolphthalein");if(xe==="phenolphthalein"&&!rt)return!0;const Xe=x.includes("dropper");return xe==="hcl"&&(!Le||!Xe)},pe=ae&&o?o.chemicals.map(xe=>({id:xe.id,name:xe.name,color:xe.color,type:j(xe.id),emoji:re(xe.id),label:xe.name})):[{...Ks.water,emoji:"",label:"Water"},{...Ks.hydrochloric_acid,emoji:"",label:"HCl (Acid)"},{...Ks.sodium_hydroxide,emoji:"",label:"NaOH (Base)"},{...Ks.zinc,emoji:"",label:"Zinc (Metal)"},{...Ks.phenolphthalein,emoji:"",label:"Indicator"},{...Ks.sulfuric_acid,emoji:"",label:"HSO (Acid)"},{...Ks.barium_chloride,emoji:"",label:"BaCl (Salt)"}],Re=xe=>({id:`${xe}_${Date.now()}`,type:xe,capacity:250,currentVolume:0,tiltAngle:0,temperature:25,contents:[],position:[Math.random()*.5-.25,0,Math.random()*.5+.5]}),it=xe=>{if(xe==="beaker"){const rt=Re("beaker");o?.id==="physical-chemical"&&x.includes("tripod-stand")?rt.position=[0,1,2]:o?.id==="evaporation"&&x.includes("tripod-stand")&&(rt.position=[0,1,2]),v(rt),t(rt.id),m("beaker")}else if(xe==="tongs"){const rt={id:`tongs_${Date.now()}`,type:"tongs",capacity:10,currentVolume:0,tiltAngle:0,temperature:25,contents:[],position:[0,1.8,2]};v(rt),t(rt.id),m("tongs")}else m(xe)},xt=xe=>({beaker:"",funnel:"","filter-paper":"",burner:"","tripod-stand":"","china-dish":"","test-tube":"","glass-rod":"",dropper:"",tongs:""})[xe]||"",dt=xe=>xe.split("-").map(rt=>rt.charAt(0).toUpperCase()+rt.slice(1)).join(" "),Ut=xe=>{if(ae&&o?.id==="neutralization"&&xe.id==="hcl"){V();return}if(ae&&o?.id==="evaporation"){u(xe.id),setTimeout(()=>h(),100);return}let rt=s;if(rt==="collection_beaker"&&(rt=null),!rt){if(xe.id==="paper"||xe.id==="magnesium"){const $=Array.from(n.values()).find(Pt=>Pt.type==="tongs");$&&($.contents.length>0||(rt=$.id))}if(!rt){const $=Array.from(n.values()).filter(Pt=>Pt.type==="beaker"&&Pt.id!=="collection_beaker");$.length>0&&(rt=$[0].id)}}if(!rt)return;const Le=n.get(rt);if(!Le)return;const Xe=Le.capacity-Le.currentVolume;if(Xe<=0)return;const qe=xe.id==="muddy-water"?112.5:100,ot=Math.min(qe,Xe);e(rt,xe,ot),ae&&(u(xe.id),setTimeout(()=>h(),100))};return w.jsxs("div",{className:"glass-panel p-4",children:[w.jsx("h3",{className:"text-lg font-semibold text-purple-300 mb-3",children:" Laboratory Shelf"}),!s&&w.jsx("p",{className:"text-xs text-yellow-500/80 mb-3 bg-yellow-500/10 p-2 rounded border border-yellow-500/20",children:" Click a chemical to auto-fill first available beaker"}),w.jsxs("div",{className:`transition-opacity ${s?"opacity-100":"opacity-90"}`,children:[w.jsx("p",{className:"text-xs text-gray-400 mb-3",children:"Select Apparatus & Chemicals"}),ae&&o?.apparatus&&w.jsxs("div",{className:"mb-4",children:[w.jsxs("h4",{className:"text-sm font-bold text-cyan-400 mb-3 uppercase tracking-wider flex items-center gap-2",children:[w.jsx("span",{children:""})," Apparatus"]}),w.jsx("div",{className:"grid grid-cols-2 gap-2",children:o.apparatus.map(xe=>{const rt=x.includes(xe),Le=["funnel","filter-paper","tripod-stand","burner","beaker","glass-rod","china-dish","tongs"].includes(xe),Xe=x.includes("beaker")&&(d.includes("salt")||d.includes("sand")),qe=o.id==="physical-chemical",ot=d.includes("ice"),$=qe&&(!R||ot),Pt=qe&&R&&!ot,St=$&&!x.includes("tripod-stand"),Ft=$&&!x.includes("burner"),ht=$&&xe==="tongs",K=Pt&&xe==="tripod-stand",F=Pt&&xe==="beaker",ge=Pt&&!x.includes("burner"),ze=o.id==="neutralization"&&xe==="dropper"&&!d.includes("phenolphthalein"),Ye=Le&&rt||xe==="funnel"&&!x.includes("beaker")||xe==="filter-paper"&&!x.includes("funnel")||xe==="glass-rod"&&!Xe||xe==="burner"&&!Pt&&!x.includes("tripod-stand")||xe==="china-dish"&&!x.includes("burner")||xe==="beaker"&&(St||Ft||F)||xe==="tongs"&&(ht||ge)||K||ze;return w.jsxs("button",{onClick:()=>it(xe),disabled:Ye,className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all
                                            ${rt?"bg-green-800/30 border-2 border-green-500/50 text-green-300":"bg-blue-900/40 border-2 border-blue-400/50 text-blue-200 hover:bg-blue-800/60 hover:border-blue-400"}
                                            active:scale-95 disabled:opacity-40 disabled:cursor-not-allowed`,children:[w.jsx("span",{className:"text-lg",children:xt(xe)}),w.jsx("span",{children:dt(xe)}),rt&&w.jsx("span",{className:"ml-auto text-green-400",children:""})]},xe)})})]}),w.jsxs("h4",{className:"text-sm font-bold text-purple-400 mb-3 uppercase tracking-wider flex items-center gap-2",children:[w.jsx("span",{children:""})," Chemicals"]}),!x.includes("beaker")&&o?.id!=="evaporation"&&w.jsx("p",{className:"text-xs text-yellow-400/80 mb-3 bg-yellow-500/10 p-2 rounded border border-yellow-500/20",children:" Place a beaker first before adding chemicals"}),!x.includes("china-dish")&&o?.id==="evaporation"&&w.jsx("p",{className:"text-xs text-yellow-400/80 mb-3 bg-yellow-500/10 p-2 rounded border border-yellow-500/20",children:" Set up the heating apparatus first (Tripod  Burner  China Dish)"}),w.jsxs("p",{className:"text-xs text-gray-400 mb-3",children:["Add to selected vessel (",Math.round(ve)," ml available)"]}),w.jsx("div",{className:"grid grid-cols-2 gap-2",children:pe.map(xe=>{let rt=!1;if(o?.id==="evaporation")rt=x.includes("china-dish");else if(o?.id==="physical-chemical"){const Xe=d.includes("ice");R&&!Xe?rt=x.includes("tongs"):rt=x.includes("beaker")}else rt=x.includes("beaker");const Le=!rt||ve<=0||d.includes(xe.id)||le(xe.id)||le(xe.id)||Me(xe.id)||Ue(xe.id)||!!J;return w.jsxs("button",{onClick:()=>Ut(xe),disabled:Le,className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all\r
                                        disabled:opacity-50 disabled:cursor-not-allowed\r
                                        hover:scale-105 active:scale-95`,style:{backgroundColor:`${xe.color}20`,borderColor:`${xe.color}50`,borderWidth:"1px",color:xe.color==="#ffffff"?"#cccccc":xe.color},children:[w.jsx("span",{className:"text-lg",children:xe.emoji}),w.jsx("span",{children:xe.label})]},xe.id)})}),w.jsx("p",{className:"text-xs text-gray-500 mt-3 text-center",children:"+100ml per click"}),(d.length>0||se&&x.includes("burner"))&&w.jsxs("div",{className:"mt-4 pt-4 border-t border-white/10",children:[w.jsxs("h4",{className:"text-sm font-bold text-orange-400 mb-3 uppercase tracking-wider flex items-center gap-2",children:[w.jsx("span",{children:""})," Actions"]}),w.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o?.reactions&&Object.keys(o.reactions).some(xe=>xe.includes("stir"))&&!N.includes("stir")&&(o.id!=="salt-dissolution"||x.includes("glass-rod"))&&w.jsxs("button",{onClick:()=>{I("stir")},className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all\r
                                            bg-orange-500/20 border border-orange-400/50 text-orange-300\r
                                            hover:bg-orange-500/30 active:scale-95`,children:[w.jsx("span",{className:"text-lg",children:""}),w.jsx("span",{children:"Stir"})]}),o?.reactions&&Object.keys(o.reactions).some(xe=>xe.includes("filter"))&&!N.includes("filter")&&o.id!=="filtration"&&w.jsxs("button",{onClick:()=>{I("filter"),setTimeout(()=>h(),100)},className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all\r
                                            bg-purple-500/20 border border-purple-400/50 text-purple-300\r
                                            hover:bg-purple-500/30 active:scale-95`,children:[w.jsx("span",{className:"text-lg",children:""}),w.jsx("span",{children:"Filter"})]}),o?.reactions&&Object.keys(o.reactions).some(xe=>xe.includes("evaporate"))&&!N.includes("evaporate")&&o.id!=="evaporation"&&w.jsxs("button",{onClick:()=>{I("evaporate"),setTimeout(()=>h(),100)},className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all\r
                                            bg-cyan-500/20 border border-cyan-400/50 text-cyan-300\r
                                            hover:bg-cyan-500/30 active:scale-95`,children:[w.jsx("span",{className:"text-lg",children:""}),w.jsx("span",{children:"Evaporate"})]}),se&&x.includes("burner")&&!J&&w.jsxs("button",{onClick:H,className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all
                                        ${U?"bg-orange-500 text-white border border-orange-400":"bg-gray-700/50 border border-gray-600 text-gray-300 hover:bg-gray-600/50"}`,children:[w.jsx("span",{className:"text-lg",children:U?"":""}),w.jsx("span",{children:U?"Burner ON":"Burner OFF"})]})]}),o?.id==="filtration"&&x.includes("beaker")&&x.includes("funnel")&&x.includes("filter-paper")&&d.includes("muddy-water")&&w.jsxs("button",{className:`w-full mt-3 flex items-center justify-center gap-2 px-4 py-3 rounded-lg text-base font-bold transition-all
                                    ${P?"bg-blue-600 scale-95":"bg-blue-500 hover:bg-blue-400"}`,onPointerDown:()=>z(!0),onPointerUp:()=>z(!1),onPointerLeave:()=>z(!1),children:[w.jsx("span",{className:"text-xl",children:""}),w.jsx("span",{children:"Hold to Pour"})]}),(W||J)&&w.jsxs("button",{onClick:ie,className:`w-full mt-3 flex items-center justify-center gap-2 px-4 py-3 rounded-lg text-base font-bold transition-all\r
                                    bg-yellow-500 hover:bg-yellow-400 text-black`,children:[w.jsx("span",{className:"text-xl",children:""}),w.jsx("span",{children:"RESET"})]})]})]})]})}function KE(){const s=Ee(v=>v.reactionNotification),e=Ee(v=>v.dismissNotification),[t,n]=te.useState(!1),[r,o]=te.useState(!1);te.useEffect(()=>{if(s){n(!0),o(!1);const v=setTimeout(()=>{o(!0),setTimeout(()=>{e(),n(!1)},300)},6e3);return()=>clearTimeout(v)}},[s,e]);const u=()=>{o(!0),setTimeout(()=>{e(),n(!1)},300)};if(!s||!t)return null;const{reaction:h,products:d}=s,m={bubbles:"",heat:"",color_change:"",precipitate:"",smoke:"",explosion:""};return w.jsx("div",{className:`fixed bottom-24 left-1/2 -translate-x-1/2 z-50 transition-all duration-300 ${r?"opacity-0 translate-y-4":"opacity-100 translate-y-0"}`,children:w.jsxs("div",{className:"glass-panel p-5 max-w-md shadow-2xl border border-cyan-400/30",children:[w.jsxs("div",{className:"flex items-start justify-between gap-4 mb-3",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-cyan-400 to-purple-500 flex items-center justify-center text-xl",children:""}),w.jsxs("div",{children:[w.jsx("h3",{className:"font-bold text-lg text-white",children:h.name}),w.jsx("p",{className:"text-xs text-gray-400",children:"Reaction Occurred!"})]})]}),w.jsx("button",{onClick:u,className:"text-gray-400 hover:text-white transition-colors p-1",children:""})]}),w.jsx("p",{className:"text-sm text-gray-300 mb-4 leading-relaxed",children:h.description}),w.jsxs("div",{className:"mb-3",children:[w.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wide",children:"Products Formed:"}),w.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:d.map(v=>w.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium",style:{backgroundColor:`${v.color}30`,color:v.color==="#ffffff"?"#cccccc":v.color,border:`1px solid ${v.color}50`},children:v.formula||v.name},v.id))})]}),w.jsxs("div",{className:"flex items-center gap-2 pt-3 border-t border-white/10",children:[w.jsx("span",{className:"text-xs text-gray-400",children:"Effects:"}),w.jsx("div",{className:"flex gap-1",children:h.effects.map(v=>w.jsx("span",{className:"text-lg",title:v,children:m[v]||""},v))}),h.isExothermic&&w.jsxs("span",{className:"ml-auto text-xs text-orange-400 flex items-center gap-1",children:[w.jsx("span",{children:""})," Exothermic"]})]})]})})}function rz(){const[s,e]=te.useState(6),t=Ee(v=>v.loadExperiment),n=Ee(v=>v.completedExperiments),r=Ee(v=>v.setExperimentMode),o=jE(s),u=wA(),h=n.length,d=v=>{t(v)},m=()=>{r("sandbox")};return w.jsxs("div",{className:"home-screen",children:[w.jsx("div",{className:"home-bg-effects"}),w.jsxs("header",{className:"home-header",children:[w.jsx("h1",{className:"text-5xl md:text-7xl font-bold mb-6 bg-clip-text text-transparent bg-gradient-to-r from-cyan-400 via-blue-500 to-purple-600 drop-shadow-2xl",children:"3D Chemistry Lab"}),w.jsx("p",{className:"home-subtitle",children:"NCERT Curriculum  Classes 6-8"}),h>0&&w.jsxs("div",{className:"progress-badge",children:[w.jsx("span",{className:"progress-icon",children:""}),h,"/",u," Completed"]})]}),w.jsx("div",{className:"class-selector",children:[6,7,8].map(v=>{const x=jE(v),y=x.filter(_=>n.includes(_.id)).length;return w.jsxs("button",{className:`class-btn ${s===v?"active":""}`,onClick:()=>e(v),children:[w.jsx("span",{className:"class-number",children:v}),w.jsxs("span",{className:"class-label",children:["Class ",v]}),y>0&&w.jsxs("span",{className:"class-progress",children:[y,"/",x.length," "]})]},v)})}),w.jsxs("div",{className:"experiment-list",children:[w.jsxs("h2",{className:"list-title",children:["Class ",s," Experiments"]}),w.jsx("div",{className:"experiment-cards",children:o.map((v,x)=>{const y=n.includes(v.id);return w.jsxs("div",{className:`experiment-card ${y?"completed":""}`,onClick:()=>d(v.id),children:[w.jsx("div",{className:"card-icon",children:y?"":`${x+1}`}),w.jsxs("div",{className:"card-content",children:[w.jsx("h3",{className:"card-title",children:v.title}),w.jsx("p",{className:"card-chapter",children:v.chapter})]}),w.jsx("div",{className:"card-arrow",children:""})]},v.id)})})]}),w.jsx("div",{className:"sandbox-option",children:w.jsxs("button",{className:"sandbox-btn",onClick:m,children:[w.jsx("span",{className:"sandbox-icon",children:""}),w.jsx("span",{className:"sandbox-text",children:"Free Exploration Mode"}),w.jsx("span",{className:"sandbox-desc",children:"Open sandbox without guided steps"})]})}),w.jsx("style",{children:`
                .home-screen {
                    min-height: 100vh;
                    padding: 2rem;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
                    position: relative;
                    overflow: hidden;
                }

                .home-bg-effects {
                    position: absolute;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background:
                        radial-gradient(ellipse at 20% 0%, rgba(124, 58, 237, 0.15) 0%, transparent 50%),
                        radial-gradient(ellipse at 80% 100%, rgba(0, 212, 255, 0.1) 0%, transparent 50%);
                    pointer-events: none;
                    animation: bgFloat 20s ease-in-out infinite;
                }

                @keyframes bgFloat {
                    0%, 100% { transform: translate(0, 0); }
                    50% { transform: translate(-1%, 1%); }
                }

                .home-header {
                    text-align: center;
                    margin-bottom: 2.5rem;
                    position: relative;
                    z-index: 1;
                }

                .home-title {
                    font-size: 2.5rem;
                    font-weight: 700;
                    background: linear-gradient(135deg, #00d4ff 0%, #7c3aed 100%);
                    -webkit-background-clip: text;
                    -webkit-text-fill-color: transparent;
                    background-clip: text;
                    margin-bottom: 0.5rem;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 0.5rem;
                }

                .title-icon {
                    -webkit-text-fill-color: initial;
                    filter: drop-shadow(0 0 10px rgba(0, 212, 255, 0.5));
                }

                .home-subtitle {
                    font-size: 1.1rem;
                    color: #a0a0c0;
                    font-weight: 500;
                }

                .progress-badge {
                    display: inline-flex;
                    align-items: center;
                    gap: 0.5rem;
                    margin-top: 1rem;
                    padding: 0.5rem 1rem;
                    background: rgba(16, 185, 129, 0.15);
                    border: 1px solid rgba(16, 185, 129, 0.3);
                    border-radius: 20px;
                    color: #10b981;
                    font-weight: 600;
                    font-size: 0.9rem;
                }

                .progress-icon {
                    font-size: 1rem;
                }

                .class-selector {
                    display: flex;
                    gap: 1.5rem;
                    margin-bottom: 2.5rem;
                    position: relative;
                    z-index: 1;
                }

                .class-btn {
                    width: 130px;
                    height: 130px;
                    border: 2px solid rgba(255, 255, 255, 0.1);
                    border-radius: 20px;
                    background: rgba(26, 26, 46, 0.8);
                    backdrop-filter: blur(10px);
                    cursor: pointer;
                    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    justify-content: center;
                    gap: 0.25rem;
                    color: white;
                    font-family: inherit;
                }

                .class-btn:hover {
                    border-color: #00d4ff;
                    transform: translateY(-4px);
                    box-shadow: 0 8px 24px rgba(0, 212, 255, 0.25);
                }

                .class-btn.active {
                    border-color: #00d4ff;
                    background: linear-gradient(135deg, rgba(0, 212, 255, 0.15) 0%, rgba(124, 58, 237, 0.15) 100%);
                    box-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
                }

                .class-number {
                    font-size: 2.5rem;
                    font-weight: 700;
                    background: linear-gradient(135deg, #00d4ff 0%, #7c3aed 100%);
                    -webkit-background-clip: text;
                    -webkit-text-fill-color: transparent;
                    background-clip: text;
                }

                .class-label {
                    font-size: 0.85rem;
                    color: #a0a0c0;
                    font-weight: 500;
                }

                .class-progress {
                    font-size: 0.7rem;
                    color: #10b981;
                    font-weight: 600;
                    margin-top: 0.25rem;
                }

                .experiment-list {
                    width: 100%;
                    max-width: 700px;
                    position: relative;
                    z-index: 1;
                }

                .list-title {
                    font-size: 1.1rem;
                    color: #a0a0c0;
                    font-weight: 600;
                    margin-bottom: 1rem;
                }

                .experiment-cards {
                    display: flex;
                    flex-direction: column;
                    gap: 0.75rem;
                }

                .experiment-card {
                    background: rgba(26, 26, 46, 0.8);
                    backdrop-filter: blur(10px);
                    border: 1px solid rgba(255, 255, 255, 0.1);
                    border-left: 4px solid #00d4ff;
                    border-radius: 12px;
                    padding: 1rem 1.25rem;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    display: flex;
                    align-items: center;
                    gap: 1rem;
                }

                .experiment-card:hover {
                    border-color: #00d4ff;
                    transform: translateX(8px);
                    box-shadow: 0 4px 20px rgba(0, 212, 255, 0.15);
                }

                .experiment-card.completed {
                    border-left-color: #10b981;
                }

                .experiment-card.completed:hover {
                    border-color: #10b981;
                }

                .card-icon {
                    width: 44px;
                    height: 44px;
                    background: linear-gradient(135deg, #00d4ff 0%, #7c3aed 100%);
                    border-radius: 12px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: 700;
                    font-size: 1rem;
                    color: white;
                    flex-shrink: 0;
                }

                .experiment-card.completed .card-icon {
                    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
                }

                .card-content {
                    flex: 1;
                }

                .card-title {
                    font-size: 1rem;
                    font-weight: 600;
                    color: white;
                    margin-bottom: 0.25rem;
                }

                .card-chapter {
                    font-size: 0.85rem;
                    color: #a0a0c0;
                }

                .card-arrow {
                    font-size: 1.5rem;
                    color: #00d4ff;
                    transition: transform 0.3s ease;
                }

                .experiment-card:hover .card-arrow {
                    transform: translateX(4px);
                }

                .sandbox-option {
                    margin-top: 2rem;
                    position: relative;
                    z-index: 1;
                }

                .sandbox-btn {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    gap: 0.25rem;
                    padding: 1rem 2rem;
                    background: rgba(255, 255, 255, 0.05);
                    border: 1px dashed rgba(255, 255, 255, 0.2);
                    border-radius: 12px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    color: white;
                    font-family: inherit;
                }

                .sandbox-btn:hover {
                    background: rgba(255, 255, 255, 0.1);
                    border-color: rgba(255, 255, 255, 0.4);
                }

                .sandbox-icon {
                    font-size: 1.5rem;
                }

                .sandbox-text {
                    font-size: 0.95rem;
                    font-weight: 600;
                }

                .sandbox-desc {
                    font-size: 0.75rem;
                    color: #a0a0c0;
                }

                @media (max-width: 600px) {
                    .home-screen {
                        padding: 1rem;
                    }

                    .home-title {
                        font-size: 1.75rem;
                    }

                    .class-selector {
                        gap: 0.75rem;
                    }

                    .class-btn {
                        width: 90px;
                        height: 90px;
                    }

                    .class-number {
                        font-size: 1.75rem;
                    }

                    .experiment-card {
                        padding: 0.75rem 1rem;
                    }

                    .card-icon {
                        width: 36px;
                        height: 36px;
                        font-size: 0.85rem;
                    }

                    .card-title {
                        font-size: 0.9rem;
                    }
                }
            `})]})}function QE({onMarkComplete:s,layout:e="desktop"}){const t=Ee(ae=>ae.currentExperiment),n=Ee(ae=>ae.currentObservation),r=Ee(ae=>ae.currentExplanation),o=Ee(ae=>ae.showExplanation),u=Ee(ae=>ae.experimentActions),h=Ee(ae=>ae.addedChemicals),d=Ee(ae=>ae.placedApparatus),m=Ee(ae=>ae.resetExperiment),v=Ee(ae=>ae.completedExperiments),x=Ee(ae=>ae.performExperimentAction),y=Ee(ae=>ae.checkExperimentReaction),_=Ee(ae=>ae.showResetPrompt),M=Ee(ae=>ae.resetPromptMessage),R=Ee(ae=>ae.isAutoPouring),A=Ee(ae=>ae.bunsenBurnerOn),E=Ee(ae=>ae.saltTested),N=Ee(ae=>ae.resetAfterSaltTest),I=Ee(ae=>ae.iceTested),P=Ee(ae=>ae.paperTested),z=Ee(ae=>ae.neutralizationDropCount),U=Ee(ae=>ae.neutralizationComplete),H=t?v.includes(t.id):!1,V=t?.id==="salt-dissolution",[L,B]=te.useState(!1);if(!t)return null;let W=t.procedureSteps||[];t.id==="salt-dissolution"&&E&&N&&(W=["Place the beaker on the lab bench","Add water to the beaker","Add sand to the water","Place the glass rod","Stir the mixture with glass rod","Observe what happens to the sand"]);let ie=d.length+h.length+u.length,J=0;t.id==="physical-chemical"&&(P?J=_?6:11:I&&(J=_?0:6));let se=Math.min(J+ie,W.length);if(t.id==="neutralization"){let ae=0;d.includes("beaker")&&(ae=1),ae===1&&h.includes("naoh")&&(ae=2),ae===2&&h.includes("phenolphthalein")&&(ae=3),ae===3&&d.includes("dropper")&&(ae=4),ae===4&&(z>=5||U)&&(ae=5),se=ae}t.id==="physical-chemical"&&console.log(`Step Reset Debug [${e.toUpperCase()}]:`,{iceTested:I,paperTested:P,showResetPrompt:_,stepOffset:J,currentPhaseActions:ie,totalSteps:W.length,completedStepsCount:se}),te.useEffect(()=>{se===W.length&&W.length>0&&B(!0)},[se,W.length]);const Y=(()=>{const ae=[];if(h.length===0)return ae;const re=Object.keys(t.reactions);return re.some(j=>j.includes("stir"))&&!u.includes("stir")&&(t.id!=="salt-dissolution"||d.includes("glass-rod"))&&ae.push({id:"stir",label:"Stir",emoji:""}),re.some(j=>j.includes("heat"))&&!u.includes("heat")&&t.id!=="evaporation"&&ae.push({id:"heat",label:"Heat",emoji:""}),re.some(j=>j.includes("filter"))&&!u.includes("filter")&&t.id!=="filtration"&&ae.push({id:"filter",label:"Filter",emoji:""}),re.some(j=>j.includes("evaporate"))&&!u.includes("evaporate")&&t.id!=="evaporation"&&ae.push({id:"evaporate",label:"Evaporate",emoji:""}),ae})(),ne=ae=>{x(ae),ae!=="stir"&&setTimeout(()=>y(),100)},ve=()=>{if(t.id!=="neutralization")return null;const ae=[];if(h.includes("naoh")&&ae.push({step:"Initial Solution",observation:"Clear, colorless NaOH solution",inference:"Sodium Hydroxide is a strong BASE"}),h.includes("phenolphthalein")&&ae.push({step:"+ Phenolphthalein",observation:"Solution turns PINK ",inference:"Indicates presence of base"}),z>0){const re=z>=5||U;ae.push({step:`+ Dilute HCl (${z} drops)`,observation:re?"Solution turns colorless ":"Pink color is fading",inference:re?"NEUTRALIZED (Salt + Water formed)":"Neutralization process"})}return ae.length===0?null:w.jsx("div",{className:"observation-table-container",children:w.jsxs("table",{className:"observation-table",children:[w.jsx("thead",{children:w.jsxs("tr",{children:[w.jsx("th",{children:"Step"}),w.jsx("th",{children:"Observation"}),w.jsx("th",{children:"Inference"})]})}),w.jsx("tbody",{children:ae.map((re,j)=>w.jsxs("tr",{children:[w.jsx("td",{children:re.step}),w.jsx("td",{children:re.observation}),w.jsx("td",{children:re.inference})]},j))})]})})};return w.jsxs("div",{className:"observation-panel",children:[w.jsxs("h3",{className:"panel-title",children:[w.jsx("span",{className:"title-icon",children:""}),"Observation"]}),_&&w.jsxs("div",{className:"reset-banner",onClick:()=>m(),children:[w.jsx("span",{className:"reset-icon",children:""}),w.jsx("span",{children:M}),w.jsx("span",{className:"arrow-icon",children:""})]}),ve(),w.jsx("p",{className:`observation-text ${o?"success":"hint"}`,children:n}),W.length>0&&w.jsxs("div",{className:"procedure-steps",children:[w.jsxs("div",{className:"steps-header",onClick:()=>B(!L),role:"button",tabIndex:0,children:[w.jsxs("h4",{className:"steps-title",children:[" Procedure (",se,"/",W.length,")"]}),w.jsx("span",{className:"steps-toggle-icon",style:{transform:L?"rotate(0deg)":"rotate(180deg)",display:"inline-block"},children:""})]}),!L&&w.jsx("div",{className:"steps-list",children:W.map((ae,re)=>{let j=re<se;const le=re===se,Me=t.id==="evaporation"&&re===3&&A&&!h.includes("salt-solution");return Me&&(j=!1),w.jsxs("div",{className:`step-item 
                                            ${j?"completed":""} 
                                            ${le&&!Me?"current":""}
                                            ${Me?"error":""}
                                        `,children:[w.jsx("div",{className:"step-marker",children:j?"":Me?"!":re+1}),w.jsx("p",{className:"step-text",children:ae})]},re)})})]}),t?.id==="filtration"&&d.includes("beaker")&&d.includes("funnel")&&d.includes("filter-paper")&&h.includes("muddy-water")&&w.jsxs("div",{className:"action-buttons",style:{marginTop:"0.5rem"},children:[w.jsxs("button",{className:`action-btn w-full justify-center transition-all duration-200 
                            ${R?"bg-blue-600 scale-95":"bg-blue-500 hover:bg-blue-400"}`,style:{background:R?"#2563eb":"#3b82f6",height:"50px"},onPointerDown:()=>Ee.getState().setAutoPouring(!0),onPointerUp:()=>Ee.getState().setAutoPouring(!1),onPointerLeave:()=>Ee.getState().setAutoPouring(!1),children:[w.jsx("span",{className:"action-emoji",style:{fontSize:"1.5rem",marginRight:"0.5rem"},children:""}),w.jsx("span",{style:{fontSize:"1.1rem",fontWeight:"bold"},children:"Hold to Pour"})]}),w.jsx("p",{className:"text-xs text-center text-gray-400 mt-2 italic",children:"Keep pressed to pour muddy water"})]}),Y.length>0&&w.jsxs("div",{className:"action-buttons",children:[w.jsx("p",{className:"action-hint",children:"Next step:"}),w.jsx("div",{className:"actions-row",children:Y.map(ae=>w.jsxs("button",{className:"action-btn",onClick:()=>ne(ae.id),children:[w.jsx("span",{className:"action-emoji",children:ae.emoji}),w.jsx("span",{children:ae.label})]},ae.id))})]}),o&&r&&w.jsxs("div",{className:"explanation-box",children:[w.jsxs("h4",{className:"explanation-title",children:[w.jsx("span",{className:"explanation-icon",children:""}),"What happened?"]}),w.jsx("p",{className:"explanation-text",children:r})]}),o&&!H&&s&&!V&&w.jsxs("button",{className:"complete-btn",onClick:s,children:[w.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",children:w.jsx("path",{fill:"currentColor",d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})}),"Mark Experiment Complete"]}),H&&w.jsx("div",{className:"completed-badge",children:w.jsx("span",{children:" Completed"})}),w.jsxs("button",{className:`reset-btn ${_?"highlight":""}`,onClick:()=>m(),children:[w.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",children:w.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})}),"Reset Experiment"]}),w.jsx("button",{className:"clear-progress-btn",onClick:()=>{localStorage.removeItem("completedExperiments"),window.location.reload()},title:"Clear all progress (for testing)",children:" Clear Progress"}),w.jsx("style",{children:`
                .observation-panel {
                    background: linear-gradient(180deg, rgba(26, 26, 46, 0.98) 0%, rgba(22, 33, 62, 0.95) 100%);
                    border: 1px solid rgba(0, 212, 255, 0.15);
                    border-radius: 16px;
                    padding: 1.25rem;
                    backdrop-filter: blur(10px);
                    max-height: 400px;
                    overflow-y: auto;
                }

                .panel-title {
                    font-size: 0.85rem;
                    font-weight: 600;
                    color: #00d4ff;
                    text-transform: uppercase;
                    letter-spacing: 1.5px;
                    margin-bottom: 1rem;
                    display: flex;
                    align-items: center;
                    gap: 0.5rem;
                }

                .title-icon {
                    font-size: 1.1rem;
                    filter: drop-shadow(0 0 8px rgba(0, 212, 255, 0.5));
                }

                .observation-table-container {
                    margin-bottom: 1rem;
                    border-radius: 12px;
                    overflow: hidden;
                    border: 1px solid rgba(0, 212, 255, 0.2);
                    background: rgba(0, 0, 0, 0.2);
                }

                .observation-table {
                    width: 100%;
                    border-collapse: collapse;
                    font-size: 0.85rem;
                    color: #fff;
                }

                .observation-table th {
                    background: rgba(0, 212, 255, 0.1);
                    color: #00d4ff;
                    text-align: left;
                    padding: 0.75rem;
                    font-weight: 600;
                    border-bottom: 1px solid rgba(0, 212, 255, 0.2);
                }

                .observation-table td {
                    padding: 0.75rem;
                    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
                    line-height: 1.4;
                }

                .observation-table tr:last-child td {
                    border-bottom: none;
                }

                .observation-table tr:nth-child(even) {
                    background: rgba(255, 255, 255, 0.02);
                }

                .observation-text {
                    font-size: 1rem;
                    line-height: 1.7;
                    color: #e0e0e0;
                    font-weight: 500;
                    margin-bottom: 1rem;
                }

                .observation-text.hint {
                    color: #a0a0c0;
                    font-style: italic;
                }

                .observation-text.success {
                    color: #10b981;
                    text-shadow: 0 0 10px rgba(16, 185, 129, 0.3);
                }

                .procedure-steps {
                    margin-top: 1rem;
                    padding: 1rem;
                    background: linear-gradient(135deg, rgba(0, 212, 255, 0.08) 0%, rgba(124, 58, 237, 0.06) 100%);
                    border-radius: 12px;
                    border: 1px solid rgba(255, 255, 255, 0.05);
                    transition: all 0.3s ease;
                }

                .steps-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    cursor: pointer;
                    padding-bottom: 0.5rem;
                }
                
                .steps-toggle-icon {
                    transition: transform 0.3s ease;
                    opacity: 0.7;
                    font-size: 0.8rem;
                    color: #00d4ff;
                }

                .steps-title {
                    font-size: 0.8rem;
                    font-weight: 700;
                    color: #a0a0c0;
                    text-transform: uppercase;
                    letter-spacing: 1px;
                    margin: 0;
                }

                .steps-list {
                    margin-top: 0.5rem;
                    display: flex;
                    flex-direction: column;
                    gap: 0.5rem;
                    animation: slideDown 0.3s ease-out;
                }

                @keyframes slideDown {
                    from { opacity: 0; transform: translateY(-10px); }
                    to { opacity: 1; transform: translateY(0); }
                }

                .step-item {
                    display: flex;
                    align-items: flex-start;
                    gap: 0.8rem;
                    padding: 0.5rem;
                    border-radius: 8px;
                    background: rgba(255, 255, 255, 0.03);
                    border: 1px solid transparent;
                    transition: all 0.2s;
                }

                .step-item.current {
                    background: rgba(0, 212, 255, 0.1);
                    border-color: rgba(0, 212, 255, 0.3);
                }

                .step-item.completed {
                    opacity: 0.6;
                }

                .step-marker {
                    min-width: 20px;
                    height: 20px;
                    border-radius: 50%;
                    background: rgba(255, 255, 255, 0.1);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 0.7rem;
                    font-weight: bold;
                    color: #fff;
                }

                .step-item.current .step-marker {
                    background: #00d4ff;
                    color: #000;
                    box-shadow: 0 0 10px rgba(0, 212, 255, 0.4);
                }
                
                .step-item.completed .step-marker {
                    background: #10b981;
                    color: #fff;
                }

                /* Error State for Missed Steps */
                .step-item.error {
                    border: 1px solid #ef4444;
                    background: rgba(239, 68, 68, 0.1);
                    box-shadow: 0 0 10px rgba(239, 68, 68, 0.3);
                    animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
                }
                .step-item.error .step-marker {
                    background: #ef4444;
                    color: white;
                }
                @keyframes shake {
                    10%, 90% { transform: translate3d(-1px, 0, 0); }
                    20%, 80% { transform: translate3d(2px, 0, 0); }
                    30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
                    40%, 60% { transform: translate3d(4px, 0, 0); }
                }

                .step-text {
                    font-size: 0.9rem;
                    line-height: 1.4;
                    color: #d0d0d0;
                    margin: 0;
                }

                .explanation-box {
                    margin-top: 1rem;
                    padding: 1rem;
                    background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(0, 212, 255, 0.05) 100%);
                    border-radius: 12px;
                    border: 1px solid rgba(16, 185, 129, 0.2);
                    border-left: 4px solid #10b981;
                    animation: slideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
                }

                @keyframes slideIn {
                    from {
                        opacity: 0;
                        transform: translateY(10px);
                    }
                    to {
                        opacity: 1;
                        transform: translateY(0);
                    }
                }

                .explanation-title {
                    font-size: 0.9rem;
                    font-weight: 600;
                    color: #10b981;
                    margin-bottom: 0.5rem;
                    display: flex;
                    align-items: center;
                    gap: 0.5rem;
                }

                .explanation-icon {
                    font-size: 1rem;
                }

                .explanation-text {
                    color: #e0e0e0;
                    font-size: 0.9rem;
                    line-height: 1.7;
                }

                .reset-btn {
                    width: 100%;
                    margin-top: 1rem;
                    padding: 0.75rem;
                    background: rgba(255, 255, 255, 0.05);
                    border: 1px solid rgba(255, 255, 255, 0.1);
                    border-radius: 10px;
                    color: #a0a0c0;
                    font-size: 0.85rem;
                    font-weight: 600;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 0.5rem;
                    font-family: inherit;
                }

                .reset-btn:hover {
                    background: rgba(0, 212, 255, 0.1);
                    border-color: rgba(0, 212, 255, 0.3);
                    color: #00d4ff;
                }

                .reset-btn svg {
                    transition: transform 0.3s ease;
                }

                .reset-btn:hover svg {
                    transform: rotate(-180deg);
                }

                .clear-progress-btn {
                    width: 100%;
                    margin-top: 0.5rem;
                    padding: 0.5rem;
                    background: rgba(239, 68, 68, 0.1);
                    border: 1px solid rgba(239, 68, 68, 0.3);
                    border-radius: 8px;
                    color: #ef4444;
                    font-size: 0.75rem;
                    font-weight: 500;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    font-family: inherit;
                }

                .clear-progress-btn:hover {
                    background: rgba(239, 68, 68, 0.2);
                    border-color: rgba(239, 68, 68, 0.5);
                }

                .complete-btn {
                    width: 100%;
                    margin-top: 1rem;
                    padding: 0.875rem;
                    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
                    border: none;
                    border-radius: 10px;
                    color: white;
                    font-size: 0.9rem;
                    font-weight: 600;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 0.5rem;
                    font-family: inherit;
                }

                .complete-btn:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
                }

                .completed-badge {
                    margin-top: 1rem;
                    padding: 0.75rem;
                    background: rgba(16, 185, 129, 0.15);
                    border: 1px solid rgba(16, 185, 129, 0.3);
                    border-radius: 10px;
                    text-align: center;
                    color: #10b981;
                    font-weight: 600;
                    font-size: 0.9rem;
                }

                .action-buttons {
                    margin-top: 1rem;
                    padding: 0.75rem;
                    background: linear-gradient(135deg, rgba(255, 165, 0, 0.1) 0%, rgba(255, 100, 0, 0.05) 100%);
                    border: 1px solid rgba(255, 165, 0, 0.3);
                    border-radius: 10px;
                }

                .action-hint {
                    margin: 0 0 0.5rem 0;
                    font-size: 0.75rem;
                    color: #ffa500;
                    font-weight: 600;
                    text-transform: uppercase;
                    letter-spacing: 0.5px;
                }

                .actions-row {
                    display: flex;
                    gap: 0.5rem;
                    flex-wrap: wrap;
                }

                .action-btn {
                    display: flex;
                    align-items: center;
                    gap: 0.4rem;
                    padding: 0.5rem 0.75rem;
                    background: linear-gradient(135deg, #ff8c00 0%, #ff6b00 100%);
                    border: none;
                    border-radius: 8px;
                    color: white;
                    font-size: 0.85rem;
                    font-weight: 600;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    font-family: inherit;
                }

                .action-btn:hover {
                    transform: scale(1.05);
                    box-shadow: 0 4px 15px rgba(255, 140, 0, 0.4);
                }

                .action-emoji {
                    font-size: 1rem;
                }

                /* Reset Banner for multi-phase experiments */
                .reset-banner {
                    background: linear-gradient(135deg, #f59e0b 0%, #ef4444 100%);
                    color: white;
                    padding: 12px 16px;
                    border-radius: 12px;
                    font-weight: 700;
                    text-align: center;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 10px;
                    margin-bottom: 1rem;
                    box-shadow: 0 4px 20px rgba(245, 158, 11, 0.4), 0 0 30px rgba(239, 68, 68, 0.2);
                    animation: resetBannerPulse 1.5s ease-in-out infinite;
                    font-size: 0.9rem;
                }

                .reset-banner:hover {
                    transform: scale(1.02);
                    box-shadow: 0 6px 25px rgba(245, 158, 11, 0.6), 0 0 40px rgba(239, 68, 68, 0.4);
                }

                .reset-icon {
                    font-size: 1.2rem;
                }

                .arrow-icon {
                    font-size: 1rem;
                    animation: pointUp 1s ease-in-out infinite;
                }

                @keyframes resetBannerPulse {
                    0%, 100% {
                        transform: scale(1);
                    }
                    50% {
                        transform: scale(1.02);
                    }
                }

                @keyframes pointUp {
                    0%, 100% {
                        transform: translateY(0);
                    }
                    50% {
                        transform: translateY(-4px);
                    }
                }

                .reset-btn.highlight {
                    background: linear-gradient(135deg, #f59e0b 0%, #ff6b00 100%) !important;
                    animation: resetBtnPulse 1.5s ease-in-out infinite;
                    box-shadow: 0 4px 15px rgba(245, 158, 11, 0.4);
                }

                @keyframes resetBtnPulse {
                    0%, 100% {
                        box-shadow: 0 4px 15px rgba(245, 158, 11, 0.4);
                    }
                    50% {
                        box-shadow: 0 6px 20px rgba(245, 158, 11, 0.6);
                    }
                }
            `})]})}function JE(){const s=Ee(t=>t.safetyWarning),e=Ee(t=>t.dismissSafetyWarning);return s?w.jsxs("div",{className:"safety-overlay",children:[w.jsxs("div",{className:"safety-popup",children:[w.jsx("div",{className:"warning-icon",children:""}),w.jsx("h2",{className:"safety-title",children:s.title}),w.jsx("p",{className:"safety-message",children:s.message}),w.jsx("button",{className:"btn-caution",onClick:e,children:"Got it!"})]}),w.jsx("style",{children:`
                /* Styles adapted for Safety-Themed (Amber/Red) Warning */
                .safety-overlay {
                    position: fixed; top: 0; left: 0; right: 0; bottom: 0;
                    background: rgba(0, 0, 0, 0.6);
                    backdrop-filter: blur(4px);
                    display: flex; align-items: center; justify-content: center;
                    z-index: 2000; /* Higher than normal UI */
                    animation: fadeIn 0.2s ease;
                }
                .safety-popup {
                    background: linear-gradient(135deg, #2e1a1a 0%, #3e1616 100%);
                    border: 1px solid rgba(255, 69, 0, 0.4);
                    border-radius: 16px;
                    padding: 2rem;
                    text-align: center;
                    max-width: 380px;
                    width: 90%;
                    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.6), 0 0 30px rgba(255, 69, 0, 0.1);
                    animation: popupSlide 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
                }
                @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
                @keyframes popupSlide {
                    0% { transform: scale(0.8) translateY(20px); opacity: 0; }
                    100% { transform: scale(1) translateY(0); opacity: 1; }
                }
                .warning-icon {
                    font-size: 3.5rem; margin-bottom: 0.5rem;
                    animation: wobble 1s ease-in-out infinite;
                }
                @keyframes wobble {
                    0%, 100% { transform: rotate(0deg); }
                    25% { transform: rotate(-10deg); }
                    75% { transform: rotate(10deg); }
                }
                .safety-title {
                    font-size: 1.5rem; font-weight: 700;
                    color: #ff6b6b; margin-bottom: 0.5rem;
                }
                .safety-message {
                    color: #d0d0d0; font-size: 1rem; line-height: 1.5;
                    margin-bottom: 1.5rem;
                }
                .btn-caution {
                    background: linear-gradient(to right, #ff416c, #ff4b2b);
                    border: none; border-radius: 8px;
                    padding: 0.8rem 1.5rem; color: white;
                    font-weight: 600; cursor: pointer;
                    transition: transform 0.2s;
                    box-shadow: 0 4px 15px rgba(255, 75, 43, 0.4);
                }
                .btn-caution:hover { transform: scale(1.05); }
            `})]}):null}function $E({isOpen:s,onClose:e,onViewLabRecord:t,onNextExperiment:n}){const r=Ee(M=>M.currentExperiment),o=Ee(M=>M.completedExperiments),u=Ee(M=>M.resetExperiment);if(!s||!r)return null;const h=Ry(),d=h.length,v=o.length>=d,y=h.findIndex(M=>M.id===r.id)<h.length-1,_=()=>{u(),e()};return w.jsxs("div",{className:"completion-overlay",children:[w.jsx("div",{className:`completion-popup ${v?"all-complete":""}`,children:v?w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:"stars",children:[w.jsx("span",{className:"star",children:""}),w.jsx("span",{className:"star",children:""}),w.jsx("span",{className:"star",children:""})]}),w.jsx("div",{className:"trophy-icon all",children:""}),w.jsx("h2",{className:"completion-title grand",children:"CONGRATULATIONS!"}),w.jsx("p",{className:"completion-message",children:"Amazing! You've completed ALL experiments in the Virtual Chemistry Lab! You're now a certified young scientist!"}),w.jsxs("button",{className:"btn-certificate",onClick:t,children:[w.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",children:w.jsx("path",{fill:"currentColor",d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-2 16l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z"})}),"View Lab Record"]}),w.jsx("div",{className:"secondary-actions",children:w.jsx("button",{className:"btn-secondary",onClick:e,children:"Close"})}),w.jsx("div",{className:"confetti-container",children:[...Array(30)].map((M,R)=>w.jsx("div",{className:"confetti",style:{left:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`,animationDuration:`${2+Math.random()*2}s`,backgroundColor:["#ff0000","#00ff00","#0000ff","#ffff00","#ff00ff","#00ffff","#ffd700"][Math.floor(Math.random()*7)]}},R))})]}):w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"trophy-icon",children:""}),w.jsx("h2",{className:"completion-title",children:"Experiment Complete!"}),w.jsxs("p",{className:"completion-message",children:[`Great job! You've successfully completed "`,r.title,'"']}),w.jsxs("button",{className:"btn-primary",onClick:t,children:[w.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",children:w.jsx("path",{fill:"currentColor",d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"})}),"View Lab Record"]}),w.jsxs("div",{className:"secondary-actions",children:[w.jsxs("button",{className:"btn-secondary",onClick:_,children:[w.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",children:w.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})}),"Rerun"]}),y&&n&&w.jsxs("button",{className:"btn-secondary",onClick:n,children:[w.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",children:w.jsx("path",{fill:"currentColor",d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})}),"Next Experiment"]})]})]})}),w.jsx("style",{children:`
                .completion-overlay {
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: rgba(0, 0, 0, 0.8);
                    backdrop-filter: blur(8px);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 1000;
                    animation: fadeIn 0.3s ease;
                }

                @keyframes fadeIn {
                    from { opacity: 0; }
                    to { opacity: 1; }
                }

                .completion-popup {
                    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
                    border: 1px solid rgba(0, 212, 255, 0.2);
                    border-radius: 24px;
                    padding: 2.5rem;
                    text-align: center;
                    max-width: 420px;
                    width: 90%;
                    box-shadow: 0 25px 60px rgba(0, 0, 0, 0.5), 0 0 40px rgba(0, 212, 255, 0.1);
                    animation: popupBounce 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
                    position: relative;
                    overflow: hidden;
                }

                .completion-popup.all-complete {
                    border-color: rgba(255, 215, 0, 0.4);
                    box-shadow: 0 25px 60px rgba(0, 0, 0, 0.5), 0 0 60px rgba(255, 215, 0, 0.2);
                }

                @keyframes popupBounce {
                    0% { transform: scale(0.5); opacity: 0; }
                    50% { transform: scale(1.05); }
                    100% { transform: scale(1); opacity: 1; }
                }

                .stars {
                    margin-bottom: 1rem;
                    display: flex;
                    justify-content: center;
                    gap: 0.5rem;
                }

                .star {
                    font-size: 2rem;
                    animation: starPulse 1s ease-in-out infinite;
                }

                .star:nth-child(2) { animation-delay: 0.2s; }
                .star:nth-child(3) { animation-delay: 0.4s; }

                @keyframes starPulse {
                    0%, 100% { transform: scale(1); opacity: 1; }
                    50% { transform: scale(1.2); opacity: 0.8; }
                }

                .trophy-icon {
                    font-size: 4rem;
                    margin-bottom: 1rem;
                    animation: trophyBounce 0.6s ease-in-out;
                }

                .trophy-icon.all {
                    font-size: 5rem;
                    filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.5));
                }

                @keyframes trophyBounce {
                    0% { transform: scale(0) rotate(-10deg); }
                    50% { transform: scale(1.2) rotate(5deg); }
                    70% { transform: scale(0.9) rotate(-3deg); }
                    100% { transform: scale(1) rotate(0); }
                }

                .completion-title {
                    font-size: 1.75rem;
                    font-weight: 700;
                    background: linear-gradient(135deg, #00d4ff 0%, #7c3aed 100%);
                    -webkit-background-clip: text;
                    -webkit-text-fill-color: transparent;
                    background-clip: text;
                    margin-bottom: 0.75rem;
                }

                .completion-title.grand {
                    font-size: 2rem;
                    background: linear-gradient(135deg, #ffd700 0%, #ff6b6b 50%, #ffd700 100%);
                    -webkit-background-clip: text;
                    background-clip: text;
                }

                .completion-message {
                    color: #a0a0c0;
                    font-size: 1rem;
                    line-height: 1.6;
                    margin-bottom: 1.5rem;
                }

                .btn-primary, .btn-certificate {
                    display: inline-flex;
                    align-items: center;
                    justify-content: center;
                    gap: 0.5rem;
                    padding: 0.875rem 1.5rem;
                    background: linear-gradient(135deg, #00d4ff 0%, #7c3aed 100%);
                    border: none;
                    border-radius: 12px;
                    color: white;
                    font-size: 1rem;
                    font-weight: 600;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    font-family: inherit;
                    width: 100%;
                }

                .btn-certificate {
                    background: linear-gradient(135deg, #ffd700 0%, #ff6b6b 100%);
                }

                .btn-primary:hover, .btn-certificate:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 8px 20px rgba(0, 212, 255, 0.3);
                }

                .secondary-actions {
                    display: flex;
                    gap: 0.75rem;
                    margin-top: 1rem;
                }

                .btn-secondary {
                    flex: 1;
                    display: inline-flex;
                    align-items: center;
                    justify-content: center;
                    gap: 0.5rem;
                    padding: 0.75rem 1rem;
                    background: rgba(255, 255, 255, 0.05);
                    border: 1px solid rgba(255, 255, 255, 0.1);
                    border-radius: 10px;
                    color: #a0a0c0;
                    font-size: 0.9rem;
                    font-weight: 600;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    font-family: inherit;
                }

                .btn-secondary:hover {
                    background: rgba(255, 255, 255, 0.1);
                    border-color: rgba(255, 255, 255, 0.2);
                    color: white;
                }

                .confetti-container {
                    position: absolute;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    pointer-events: none;
                    overflow: hidden;
                }

                .confetti {
                    position: absolute;
                    width: 10px;
                    height: 10px;
                    top: -10px;
                    animation: confettiFall 3s linear infinite;
                }

                @keyframes confettiFall {
                    0% { transform: translateY(0) rotate(0deg); opacity: 1; }
                    100% { transform: translateY(500px) rotate(720deg); opacity: 0; }
                }
            `})]})}function eT({isOpen:s,onClose:e}){const t=Ee(v=>v.currentExperiment),n=Ee(v=>v.completedExperiments),[r,o]=te.useState(!1);if(!s||!t)return null;const u=n.length>=wA(),h=v=>v.replace(//g,"+").replace(//g,"-").replace(//g,"2").replace(//g,"->").replace(/|||||||||/g,"").replace(/[\u2018\u2019]/g,"'").replace(/[\u201C\u201D]/g,'"'),d=async v=>{o(!0);try{const{jsPDF:x}=await X_(async()=>{const{jsPDF:U}=await import("./jspdf.es.min-2851m7I4.js").then(H=>H.j);return{jsPDF:U}},[]),y=new x;y.setFontSize(18),y.setTextColor(0,100,150),y.text("Virtual Chemistry Lab - Lab Record",105,20,{align:"center"}),y.setFontSize(14),y.setTextColor(0,0,0),y.text(h(t.title),105,35,{align:"center"}),y.setFontSize(10),y.setTextColor(100,100,100),y.text(`Class ${t.classLevel} | ${t.chapter}`,105,42,{align:"center"});let _=55;y.setFontSize(12),y.setTextColor(0,80,120),y.text("AIM:",20,_),y.setTextColor(0,0,0),y.setFontSize(11);const M=y.splitTextToSize(h(t.aim),170);y.text(M,20,_+7),_+=7+M.length*6+5,y.setFontSize(12),y.setTextColor(0,80,120),y.text("APPARATUS REQUIRED:",20,_),y.setTextColor(0,0,0),y.setFontSize(11);const R=t.apparatus.map(U=>U.replace(/-/g," ")).join(", "),A=y.splitTextToSize(R,170);y.text(A,20,_+7),_+=7+A.length*6+5,y.setFontSize(12),y.setTextColor(0,80,120),y.text("CHEMICALS USED:",20,_),y.setTextColor(0,0,0),y.setFontSize(11);const E=t.chemicals.map(U=>U.name).join(", "),N=y.splitTextToSize(E,170);y.text(N,20,_+7),_+=7+N.length*6+5,t.procedureSteps&&t.procedureSteps.length>0&&(y.setFontSize(12),y.setTextColor(0,80,120),y.text("PROCEDURE:",20,_),_+=7,y.setTextColor(0,0,0),y.setFontSize(11),t.procedureSteps.forEach((U,H)=>{const V=`${H+1}. ${h(U)}`,L=y.splitTextToSize(V,165);y.text(L,25,_),_+=L.length*6}),_+=5),y.setFontSize(12),y.setTextColor(0,80,120),y.text("OBSERVATIONS:",20,_),_+=7,y.setTextColor(0,0,0),y.setFontSize(11),Object.values(t.reactions).forEach(U=>{if(U.success){const H=h(` ${U.observation}`),V=y.splitTextToSize(H,165);_+V.length*6>270&&(y.addPage(),_=20),y.text(V,25,_),_+=V.length*6+2}}),_+=5,_>240&&(y.addPage(),_=20),y.setFontSize(12),y.setTextColor(0,80,120),y.text("CONCLUSION:",20,_),y.setTextColor(0,0,0),y.setFontSize(11);const I=y.splitTextToSize(h(t.conclusion),170);y.text(I,20,_+7),y.setFontSize(8),y.setTextColor(150,150,150),y.text(`Generated by Virtual Chemistry Lab on ${new Date().toLocaleDateString()}`,105,290,{align:"center"});const z=`${t.title.replace(/[^a-z0-9]/gi,"_")}_Lab_Report.pdf`;if(v==="download")y.save(z);else{const U=y.output("blob"),H=URL.createObjectURL(U);window.open(H,"_blank")}}catch(x){console.error("PDF generation failed:",x),alert("Failed to generate PDF. Please try again.")}finally{o(!1)}},m=async()=>{if(u){o(!0);try{const{jsPDF:v}=await X_(async()=>{const{jsPDF:_}=await import("./jspdf.es.min-2851m7I4.js").then(M=>M.j);return{jsPDF:_}},[]),x=new v("landscape");x.setFillColor(15,15,35),x.rect(0,0,297,210,"F"),x.setDrawColor(0,212,255),x.setLineWidth(3),x.rect(10,10,277,190,"S"),x.setDrawColor(124,58,237),x.setLineWidth(1),x.rect(15,15,267,180,"S"),x.setFontSize(36),x.setTextColor(0,212,255),x.text("CERTIFICATE OF COMPLETION",148.5,50,{align:"center"}),x.setFontSize(14),x.setTextColor(160,160,192),x.text("This is to certify that",148.5,75,{align:"center"}),x.setFontSize(24),x.setTextColor(255,255,255),x.text("________________________",148.5,95,{align:"center"}),x.setFontSize(14),x.setTextColor(160,160,192),x.text("has successfully completed all experiments in the",148.5,115,{align:"center"}),x.setFontSize(20),x.setTextColor(124,58,237),x.text("Virtual Chemistry Lab",148.5,130,{align:"center"}),x.setFontSize(12),x.setTextColor(160,160,192);const y=Ry();x.text(`Completed ${y.length} experiments across NCERT Classes 6-8`,148.5,145,{align:"center"}),x.setFontSize(10),x.text(`Date: ${new Date().toLocaleDateString()}`,148.5,165,{align:"center"}),x.setFontSize(40),x.setTextColor(255,215,0),x.text("*",148.5,185,{align:"center"}),x.save("chemistry-lab-certificate.pdf")}catch(v){console.error("Certificate export failed:",v),alert("Failed to export certificate. Please try again.")}finally{o(!1)}}};return w.jsxs("div",{className:"lab-record-overlay",onClick:e,children:[w.jsxs("div",{className:"lab-record-modal",onClick:v=>v.stopPropagation(),children:[w.jsx("button",{className:"close-btn",onClick:e,children:""}),w.jsxs("div",{className:"modal-header",children:[w.jsx("h2",{className:"modal-title",children:" Lab Record"}),w.jsx("p",{className:"modal-subtitle",children:t.title})]}),w.jsxs("div",{className:"modal-content",children:[w.jsxs("section",{className:"record-section",children:[w.jsx("h3",{className:"section-title",children:" Aim"}),w.jsx("p",{className:"section-text",children:t.aim})]}),w.jsxs("section",{className:"record-section",children:[w.jsx("h3",{className:"section-title",children:" Apparatus Required"}),w.jsx("ul",{className:"item-list",children:t.apparatus.map((v,x)=>w.jsx("li",{children:v.replace(/-/g," ")},x))})]}),w.jsxs("section",{className:"record-section",children:[w.jsx("h3",{className:"section-title",children:" Chemicals Used"}),w.jsx("ul",{className:"item-list",children:t.chemicals.map((v,x)=>w.jsxs("li",{children:[w.jsx("span",{className:"chem-color",style:{background:v.color}}),v.name]},x))})]}),t.procedureSteps&&w.jsxs("section",{className:"record-section",children:[w.jsx("h3",{className:"section-title",children:" Procedure"}),w.jsx("ol",{className:"procedure-list",children:t.procedureSteps.map((v,x)=>w.jsx("li",{children:v},x))})]}),w.jsxs("section",{className:"record-section",children:[w.jsx("h3",{className:"section-title",children:" Observations"}),Object.entries(t.reactions).map(([v,x])=>x.success?w.jsx("div",{className:"observation-item",children:w.jsx("p",{children:x.observation})},v):null)]}),w.jsxs("section",{className:"record-section",children:[w.jsx("h3",{className:"section-title",children:" Conclusion"}),w.jsx("p",{className:"section-text conclusion",children:t.conclusion})]})]}),w.jsxs("div",{className:"modal-footer",children:[w.jsx("button",{className:"btn-preview",onClick:()=>d("preview"),disabled:r,children:" Preview"}),w.jsx("button",{className:"btn-export",onClick:()=>d("download"),disabled:r,children:r?"Generating...":" Download PDF"}),u&&w.jsx("button",{className:"btn-certificate",onClick:m,disabled:r,children:" Download Certificate"})]})]}),w.jsx("style",{children:`
                .lab-record-overlay {
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: rgba(0, 0, 0, 0.85);
                    backdrop-filter: blur(10px);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 1000;
                    padding: 1rem;
                    animation: fadeIn 0.3s ease;
                }

                @keyframes fadeIn {
                    from { opacity: 0; }
                    to { opacity: 1; }
                }

                .lab-record-modal {
                    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
                    border: 1px solid rgba(0, 212, 255, 0.2);
                    border-radius: 20px;
                    max-width: 600px;
                    width: 100%;
                    max-height: 85vh;
                    display: flex;
                    flex-direction: column;
                    box-shadow: 0 25px 60px rgba(0, 0, 0, 0.5);
                    animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
                    position: relative;
                }

                @keyframes slideUp {
                    from { opacity: 0; transform: translateY(20px); }
                    to { opacity: 1; transform: translateY(0); }
                }

                .close-btn {
                    position: absolute;
                    top: 1rem;
                    right: 1rem;
                    width: 32px;
                    height: 32px;
                    border: 1px solid rgba(255, 255, 255, 0.1);
                    border-radius: 8px;
                    background: rgba(255, 255, 255, 0.05);
                    color: #a0a0c0;
                    font-size: 1rem;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }

                .close-btn:hover {
                    background: rgba(255, 255, 255, 0.1);
                    color: white;
                }

                .modal-header {
                    padding: 1.5rem 2rem 1rem;
                    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
                }

                .modal-title {
                    font-size: 1.5rem;
                    font-weight: 700;
                    background: linear-gradient(135deg, #00d4ff 0%, #7c3aed 100%);
                    -webkit-background-clip: text;
                    -webkit-text-fill-color: transparent;
                    background-clip: text;
                    margin-bottom: 0.25rem;
                }

                .modal-subtitle {
                    color: #a0a0c0;
                    font-size: 0.9rem;
                }

                .modal-content {
                    padding: 1.5rem 2rem;
                    overflow-y: auto;
                    flex: 1;
                }

                .record-section {
                    margin-bottom: 1.5rem;
                }

                .record-section:last-child {
                    margin-bottom: 0;
                }

                .section-title {
                    font-size: 0.9rem;
                    font-weight: 600;
                    color: #00d4ff;
                    margin-bottom: 0.5rem;
                    text-transform: uppercase;
                    letter-spacing: 0.5px;
                }

                .section-text {
                    color: #e0e0e0;
                    font-size: 0.95rem;
                    line-height: 1.6;
                }

                .section-text.conclusion {
                    background: rgba(16, 185, 129, 0.1);
                    padding: 1rem;
                    border-radius: 10px;
                    border-left: 3px solid #10b981;
                }

                .item-list {
                    list-style: none;
                    padding: 0;
                    margin: 0;
                    display: flex;
                    flex-wrap: wrap;
                    gap: 0.5rem;
                }

                .item-list li {
                    display: inline-flex;
                    align-items: center;
                    gap: 0.5rem;
                    background: rgba(255, 255, 255, 0.05);
                    padding: 0.4rem 0.8rem;
                    border-radius: 6px;
                    color: #e0e0e0;
                    font-size: 0.85rem;
                    text-transform: capitalize;
                }

                .chem-color {
                    width: 12px;
                    height: 12px;
                    border-radius: 3px;
                    border: 1px solid rgba(255, 255, 255, 0.2);
                }

                .procedure-list {
                    margin: 0;
                    padding-left: 1.25rem;
                    color: #e0e0e0;
                    font-size: 0.9rem;
                    line-height: 1.8;
                }

                .observation-item {
                    background: rgba(255, 255, 255, 0.03);
                    padding: 0.75rem 1rem;
                    border-radius: 8px;
                    margin-bottom: 0.5rem;
                    border-left: 3px solid #7c3aed;
                }

                .observation-item p {
                    margin: 0;
                    color: #e0e0e0;
                    font-size: 0.9rem;
                    line-height: 1.5;
                }

                .modal-footer {
                    padding: 1rem 2rem 1.5rem;
                    border-top: 1px solid rgba(255, 255, 255, 0.1);
                    display: flex;
                    gap: 0.75rem;
                }

                .btn-export, .btn-certificate, .btn-preview {
                    flex: 1;
                    padding: 0.75rem 1rem;
                    border: none;
                    border-radius: 10px;
                    font-size: 0.9rem;
                    font-weight: 600;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    font-family: inherit;
                }

                .btn-preview {
                    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
                    color: white;
                }

                .btn-export {
                    background: linear-gradient(135deg, #00d4ff 0%, #7c3aed 100%);
                    color: white;
                }

                .btn-certificate {
                    background: linear-gradient(135deg, #ffd700 0%, #ff6b6b 100%);
                    color: white;
                }

                .btn-export:hover, .btn-certificate:hover, .btn-preview:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 4px 15px rgba(0, 212, 255, 0.3);
                }

                .btn-export:disabled, .btn-certificate:disabled, .btn-preview:disabled {
                    opacity: 0.6;
                    cursor: not-allowed;
                    transform: none;
                }

                @media (max-width: 600px) {
                    .modal-header, .modal-content, .modal-footer {
                        padding-left: 1.25rem;
                        padding-right: 1.25rem;
                    }

                    .modal-footer {
                        flex-direction: column;
                    }
                }
            `})]})}function sz(){const s=Ee(I=>I.currentExperiment),e=Ee(I=>I.placedApparatus),t=Ee(I=>I.addedChemicals),n=Ee(I=>I.experimentActions),r=Ee(I=>I.bunsenBurnerOn),o=Ee(I=>I.saltTested),u=Ee(I=>I.resetAfterSaltTest),h=Ee(I=>I.neutralizationDropCount),d=Ee(I=>I.neutralizationComplete);if(!s)return null;let m=s.procedureSteps||[];s.id==="salt-dissolution"&&o&&u&&(m=["Place the beaker on the lab bench","Add water to the beaker","Add sand to the water","Place the glass rod","Stir the mixture with glass rod","Observe what happens to the sand"]);const v=Ee(I=>I.iceTested),x=Ee(I=>I.paperTested),y=Ee(I=>I.showResetPrompt);let _=e.length+t.length+n.length,M=0;s.id==="physical-chemical"&&(x?M=y?6:11:v&&(M=y?0:6));let R=Math.min(M+_,m.length);if(s.id==="neutralization"){let I=0;e.includes("beaker")&&(I=1),I===1&&t.includes("naoh")&&(I=2),I===2&&t.includes("phenolphthalein")&&(I=3),I===3&&e.includes("dropper")&&(I=4),I===4&&(h>=5||d)&&(I=5),R=I}const A=R>=m.length,E=A?" Experiment interactions complete! Check observations.":m[R],N=s.id==="evaporation"&&r&&!t.includes("salt-solution");return w.jsx("div",{className:`absolute top-0 left-0 right-0 z-30 px-3 py-2 border-b backdrop-blur-md transition-colors duration-300
            ${N?"bg-red-500/90 border-red-400 text-white animate-pulse":"bg-slate-900/80 border-cyan-500/30 text-cyan-100"}`,children:w.jsxs("div",{className:"flex items-start gap-2 max-w-lg mx-auto",children:[w.jsx("span",{className:"text-lg mt-0.5",children:N?"":A?"":""}),w.jsxs("div",{className:"flex-1",children:[N?w.jsx("p",{className:"font-bold text-sm leading-tight",children:"Wait! You missed adding the Salt Solution!"}):w.jsx("p",{className:`text-sm font-medium leading-tight ${A?"text-green-300":"text-cyan-200"}`,children:E}),!A&&!N&&w.jsxs("p",{className:"text-[10px] text-cyan-400/70 uppercase tracking-wider mt-0.5",children:["Step ",R+1," of ",m.length]})]})]})})}function az(){const s=Ee(r=>r.vessels),e=Ee(r=>r.selectedVesselId),t=Ee(r=>r.selectVessel),n=Ee(r=>r.clearVessel);return w.jsxs("div",{className:"glass-panel p-4 min-w-[280px] max-h-[400px] overflow-y-auto",children:[w.jsx("h3",{className:"text-lg font-semibold text-cyan-300 mb-3",children:" Vessels"}),w.jsx("div",{className:"space-y-4",children:Array.from(s.values()).map(r=>{const o=r.id===e;return w.jsxs("div",{className:`p-3 rounded-lg cursor-pointer transition-all ${o?"bg-cyan-500/20 border border-cyan-400/50":"bg-white/5 border border-transparent hover:bg-white/10"}`,onClick:()=>t(r.id),children:[w.jsxs("div",{className:"flex justify-between items-center mb-2",children:[w.jsx("span",{className:"font-medium capitalize",children:r.name||`${r.type} ${r.id.split("_")[1]||""}`}),o&&w.jsx("span",{className:"text-xs bg-cyan-500 text-black px-2 py-0.5 rounded",children:"Selected"})]}),w.jsxs("div",{className:"mb-2",children:[w.jsxs("div",{className:"flex justify-between text-sm text-gray-400 mb-1",children:[w.jsx("span",{children:"Volume"}),w.jsxs("span",{className:"font-mono",children:[Math.round(r.currentVolume)," / ",r.capacity," ml"]})]}),w.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2 overflow-hidden",children:w.jsx("div",{className:"h-full bg-gradient-to-r from-cyan-400 to-blue-500 transition-all duration-300",style:{width:`${r.currentVolume/r.capacity*100}%`}})})]}),w.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[w.jsx("span",{className:"text-gray-400",children:"Tilt"}),w.jsxs("span",{className:`font-mono ${r.tiltAngle>45?"text-orange-400":"text-gray-300"}`,children:[Math.round(r.tiltAngle),"",r.tiltAngle>45&&"  Pouring"]})]}),w.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[w.jsx("span",{className:"text-gray-400",children:"Temp"}),w.jsxs("span",{className:`font-mono ${r.temperature>80?"text-red-400":r.temperature>50?"text-orange-400":"text-gray-300"}`,children:[Math.round(r.temperature),"C",r.temperature>=100&&"  Boiling!"]})]}),w.jsxs("div",{className:"text-sm",children:[w.jsx("span",{className:"text-gray-400",children:"Contents: "}),w.jsx("span",{className:"text-gray-200",children:r.contents.length>0?r.contents.map(u=>u.chemical.name).join(", "):"Empty"})]}),o&&w.jsx("div",{className:"flex gap-2 mt-3",children:w.jsx("button",{onClick:u=>{u.stopPropagation(),n(r.id)},className:"flex-1 text-xs bg-red-500/20 hover:bg-red-500/30 text-red-300 py-1.5 px-2 rounded transition-all",children:" Empty"})})]},r.id)})})]})}function oz(){const s=Ee(L=>L.isPouringActive),e=Ee(L=>L.activeEffects),t=Ee(L=>L.bunsenBurnerOn),n=Ee(L=>L.toggleBunsenBurner),r=Ee(L=>L.experimentMode),o=Ee(L=>L.showLab),u=Ee(L=>L.currentExperiment),h=Ee(L=>L.goToHomeScreen),d=Ee(L=>L.loadExperiment),m=Ee(L=>L.markExperimentComplete),v=Ee(L=>L.showCompletionPopup),x=Ee(L=>L.dishCracked),[y,_]=te.useState(!1),[M,R]=te.useState(!1),[A,E]=te.useState(!1),[N,I]=te.useState("chemicals"),[P,z]=te.useState(!0);te.useEffect(()=>{const L=()=>E(window.innerWidth<768);return L(),window.addEventListener("resize",L),()=>window.removeEventListener("resize",L)},[]),te.useEffect(()=>{console.log("deployment-version-check: v4.9-mobile-fix-"+Date.now())},[]),te.useEffect(()=>{if(v){const L=setTimeout(()=>{_(!0),Ee.setState({showCompletionPopup:!1})},3e3);return()=>clearTimeout(L)}},[v]),te.useEffect(()=>{const L=()=>{Vl.initialize(),document.removeEventListener("click",L),document.removeEventListener("keydown",L)};return document.addEventListener("click",L),document.addEventListener("keydown",L),()=>{document.removeEventListener("click",L),document.removeEventListener("keydown",L)}},[]);const U=()=>{u&&(m(u.id),_(!0))},H=()=>{if(u){const L=Ry(),B=L.findIndex(W=>W.id===u.id);B<L.length-1&&(_(!1),d(L[B+1].id))}};if(!o)return w.jsx(rz,{});const V=r==="guided"&&u!==null;return A?w.jsxs("div",{className:"w-full h-full relative flex flex-col",children:[w.jsxs("div",{className:"glass-panel p-2 flex items-center justify-between z-10",style:{minHeight:"44px"},children:[w.jsx("button",{onClick:h,className:"text-gray-400 hover:text-white transition-colors text-sm px-2",children:" Back"}),w.jsx("h1",{className:"text-sm font-bold text-cyan-400 truncate flex-1 text-center px-2",children:V?u?.title:" 3D Chemistry Lab"}),w.jsx("button",{onClick:()=>z(!P),className:"text-cyan-400 text-lg px-2",children:P?"":""})]}),w.jsxs("div",{className:"flex-1 relative",style:{minHeight:"200px"},children:[V&&w.jsx(sz,{}),w.jsx(YE,{className:"w-full h-full",isMobile:!0}),w.jsx(KE,{}),s&&w.jsx("div",{className:"absolute top-2 left-2 bg-orange-500/80 text-white text-xs px-2 py-1 rounded-full",children:" Pouring..."}),e.length>0&&w.jsx("div",{className:"absolute top-2 right-2 bg-purple-500/80 text-white text-xs px-2 py-1 rounded-full",children:" Reacting!"})]}),P&&w.jsxs("div",{className:"glass-panel z-20",style:{maxHeight:"60vh",display:"flex",flexDirection:"column"},children:[w.jsxs("div",{className:"flex border-b border-white/10",children:[w.jsx("button",{onClick:()=>I("chemicals"),className:`flex-1 py-2 text-xs font-medium transition-colors ${N==="chemicals"?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400"}`,children:" Chemicals"}),w.jsx("button",{onClick:()=>I("steps"),className:`flex-1 py-2 text-xs font-medium transition-colors ${N==="steps"?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400"}`,children:" Steps"}),(r==="sandbox"||u?.apparatus?.includes("burner"))&&!x&&w.jsx("button",{onClick:()=>I("burner"),className:`flex-1 py-2 text-xs font-medium transition-colors ${N==="burner"?"text-orange-400 border-b-2 border-orange-400":"text-gray-400"}`,children:" Burner"})]}),w.jsxs("div",{className:"flex-1 overflow-y-auto p-2",children:[N==="chemicals"&&w.jsx("div",{className:"mobile-shelf",children:w.jsx(ZE,{})}),N==="steps"&&w.jsx("div",{className:"mobile-steps",children:V?w.jsx(QE,{onMarkComplete:U,layout:"mobile"}):w.jsxs("div",{className:"text-sm text-gray-400 p-2",children:[w.jsx("p",{className:"mb-2",children:" Free Mode - Mix chemicals to see reactions!"}),w.jsxs("ul",{className:"text-xs space-y-1",children:[w.jsx("li",{children:" Tap beaker  Add chemicals"}),w.jsx("li",{children:" Drag to tilt & pour"}),w.jsx("li",{children:" Use burner to heat"})]})]})}),N==="burner"&&w.jsxs("div",{className:"p-2",children:[w.jsx("button",{onClick:n,className:`w-full py-3 px-4 rounded-lg font-medium text-lg transition-all ${t?"bg-orange-500 text-white":"bg-gray-700 text-gray-300"}`,children:t?" Burner ON":" Burner OFF"}),w.jsx("p",{className:"text-xs text-gray-400 mt-2 text-center",children:"Tap to toggle heat"})]})]})]}),w.jsx($E,{isOpen:y,onClose:()=>_(!1),onViewLabRecord:()=>{_(!1),R(!0)},onNextExperiment:H}),w.jsx(JE,{}),w.jsx(eT,{isOpen:M,onClose:()=>R(!1)})]}):w.jsxs("div",{className:"w-full h-full relative",children:[w.jsx(YE,{className:"w-full h-full"}),w.jsx(KE,{}),w.jsx("div",{className:"absolute top-0 left-0 right-0 p-6 pointer-events-none",children:w.jsxs("div",{className:"flex justify-between items-start gap-4",children:[w.jsxs("div",{className:"glass-panel p-4 pointer-events-auto",children:[V?w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"flex items-center gap-3 mb-2",children:w.jsx("button",{onClick:h,className:"text-gray-400 hover:text-white transition-colors",title:"Back to experiments",children:" Back"})}),w.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-cyan-400 to-purple-500 bg-clip-text text-transparent",children:u?.title}),w.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Class ",u?.classLevel,"  ",u?.chapter]})]}):w.jsxs(w.Fragment,{children:[w.jsx("h1",{className:"text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-cyan-400 to-blue-500",children:" 3D Chemistry Lab"}),w.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Free Exploration Mode"}),w.jsx("button",{onClick:h,className:"mt-2 text-sm text-cyan-400 hover:text-cyan-300 transition-colors",children:" Back to Experiments"})]}),s&&w.jsxs("div",{className:"mt-2 text-orange-400 text-sm flex items-center gap-2",children:[w.jsx("span",{className:"animate-pulse",children:""}),"Pouring in progress..."]}),e.length>0&&w.jsxs("div",{className:"mt-2 text-purple-400 text-sm flex items-center gap-2",children:[w.jsx("span",{className:"animate-pulse",children:""}),"Reaction in progress!"]})]}),w.jsxs("div",{className:"pointer-events-auto space-y-4",children:[w.jsx(az,{}),w.jsx(ZE,{})]})]})}),w.jsx("div",{className:"absolute bottom-6 left-6 pointer-events-none",children:w.jsx("div",{className:"pointer-events-auto max-w-[360px]",children:V?w.jsx(QE,{onMarkComplete:U}):w.jsxs("div",{className:"glass-panel p-4",children:[w.jsx("h3",{className:"text-sm font-semibold text-cyan-300 mb-2",children:" How to Use"}),w.jsxs("ol",{className:"text-sm text-gray-300 space-y-1.5 list-decimal list-inside",children:[w.jsxs("li",{children:["Click a beaker to ",w.jsx("strong",{children:"select"})," it"]}),w.jsxs("li",{children:["Use the ",w.jsx("strong",{children:"Chemical Shelf"})," to add chemicals"]}),w.jsxs("li",{children:[w.jsx("strong",{children:"Drag up/down"})," on beaker to tilt"]}),w.jsxs("li",{children:[w.jsx("strong",{children:"Shift+drag"})," to move beaker around!"]}),w.jsxs("li",{children:["Pour into another beaker to ",w.jsx("strong",{children:"mix chemicals"})]})]}),w.jsxs("div",{className:"mt-3 pt-3 border-t border-white/10",children:[w.jsx("h4",{className:"text-xs font-semibold text-purple-300 mb-1",children:" Try These Reactions:"}),w.jsxs("ul",{className:"text-xs text-gray-400 space-y-1",children:[w.jsxs("li",{children:[" ",w.jsx("strong",{children:"HCl + NaOH"}),"  Neutralization (heat! )"]}),w.jsxs("li",{children:[" ",w.jsx("strong",{children:"HCl + Zinc"}),"  Bubbles! "]}),w.jsxs("li",{children:[" ",w.jsx("strong",{children:"Indicator + NaOH"}),"  Pink color! "]}),w.jsxs("li",{children:[" ",w.jsx("strong",{children:"BaCl + HSO"}),"  White precipitate! "]})]})]}),w.jsxs("div",{className:"mt-3 pt-3 border-t border-white/10",children:[w.jsx("h4",{className:"text-xs font-semibold text-orange-300 mb-1",children:" Heating:"}),w.jsxs("ul",{className:"text-xs text-gray-400 space-y-1",children:[w.jsxs("li",{children:[" Add ",w.jsx("strong",{children:"Water"})," to a beaker"]}),w.jsxs("li",{children:[" Turn on the ",w.jsx("strong",{children:"Bunsen burner"})]}),w.jsx("li",{children:" Drag beaker near the flame to heat!"})]})]}),w.jsxs("div",{className:"mt-3 pt-3 border-t border-white/10",children:[w.jsx("h4",{className:"text-xs font-semibold text-gray-400 mb-1",children:"Camera Controls"}),w.jsx("ul",{className:"text-xs text-gray-400 space-y-0.5",children:w.jsx("li",{children:" Drag to rotate  Scroll to zoom"})})]})]})})}),w.jsx($E,{isOpen:y,onClose:()=>_(!1),onViewLabRecord:()=>{_(!1),R(!0)},onNextExperiment:H}),w.jsx(JE,{}),w.jsx(eT,{isOpen:M,onClose:()=>R(!1)})]})}nT.createRoot(document.getElementById("root")).render(w.jsx(te.StrictMode,{children:w.jsx(oz,{})}));export{X_ as _,lz as c,q_ as g};
